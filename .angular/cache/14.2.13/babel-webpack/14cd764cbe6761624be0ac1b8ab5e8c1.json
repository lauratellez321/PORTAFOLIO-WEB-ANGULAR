{"ast":null,"code":"import _asyncToGenerator from \"/Users/valentina/Documents/DEVELOP/ANGULAR/PORTAFOLIO-WEB-ANGULAR/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/**\n * @licstart The following is the entire license notice for the\n * JavaScript code in this page\n *\n * Copyright 2024 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * @licend The above is the entire license notice for the\n * JavaScript code in this page\n */\n\n/******/\n// The require scope\n\n/******/\nvar __webpack_require__ = {};\n/******/\n\n/************************************************************************/\n\n/******/\n\n/* webpack/runtime/define property getters */\n\n/******/\n\n(() => {\n  /******/\n  // define getter functions for harmony exports\n\n  /******/\n  __webpack_require__.d = (exports, definition) => {\n    /******/\n    for (var key in definition) {\n      /******/\n      if (__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n        /******/\n        Object.defineProperty(exports, key, {\n          enumerable: true,\n          get: definition[key]\n        });\n        /******/\n      }\n      /******/\n\n    }\n    /******/\n\n  };\n  /******/\n\n})();\n/******/\n\n/******/\n\n/* webpack/runtime/hasOwnProperty shorthand */\n\n/******/\n\n\n(() => {\n  /******/\n  __webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n  /******/\n\n})();\n/******/\n\n/************************************************************************/\n\n\nvar __webpack_exports__ = globalThis.pdfjsLib = {}; // EXPORTS\n\n\n__webpack_require__.d(__webpack_exports__, {\n  AbortException: () =>\n  /* reexport */\n  AbortException,\n  AnnotationEditorLayer: () =>\n  /* reexport */\n  AnnotationEditorLayer,\n  AnnotationEditorParamsType: () =>\n  /* reexport */\n  AnnotationEditorParamsType,\n  AnnotationEditorType: () =>\n  /* reexport */\n  AnnotationEditorType,\n  AnnotationEditorUIManager: () =>\n  /* reexport */\n  AnnotationEditorUIManager,\n  AnnotationLayer: () =>\n  /* reexport */\n  AnnotationLayer,\n  AnnotationMode: () =>\n  /* reexport */\n  AnnotationMode,\n  CMapCompressionType: () =>\n  /* reexport */\n  CMapCompressionType,\n  ColorPicker: () =>\n  /* reexport */\n  ColorPicker,\n  DOMSVGFactory: () =>\n  /* reexport */\n  DOMSVGFactory,\n  DrawLayer: () =>\n  /* reexport */\n  DrawLayer,\n  FeatureTest: () =>\n  /* reexport */\n  util_FeatureTest,\n  GlobalWorkerOptions: () =>\n  /* reexport */\n  GlobalWorkerOptions,\n  ImageKind: () =>\n  /* reexport */\n  util_ImageKind,\n  InvalidPDFException: () =>\n  /* reexport */\n  InvalidPDFException,\n  MissingPDFException: () =>\n  /* reexport */\n  MissingPDFException,\n  OPS: () =>\n  /* reexport */\n  OPS,\n  PDFDataRangeTransport: () =>\n  /* reexport */\n  PDFDataRangeTransport,\n  PDFDateString: () =>\n  /* reexport */\n  PDFDateString,\n  PDFWorker: () =>\n  /* reexport */\n  PDFWorker,\n  PasswordResponses: () =>\n  /* reexport */\n  PasswordResponses,\n  PermissionFlag: () =>\n  /* reexport */\n  PermissionFlag,\n  PixelsPerInch: () =>\n  /* reexport */\n  PixelsPerInch,\n  RenderingCancelledException: () =>\n  /* reexport */\n  RenderingCancelledException,\n  TextLayer: () =>\n  /* reexport */\n  TextLayer,\n  UnexpectedResponseException: () =>\n  /* reexport */\n  UnexpectedResponseException,\n  Util: () =>\n  /* reexport */\n  Util,\n  VerbosityLevel: () =>\n  /* reexport */\n  VerbosityLevel,\n  XfaLayer: () =>\n  /* reexport */\n  XfaLayer,\n  build: () =>\n  /* reexport */\n  build,\n  createValidAbsoluteUrl: () =>\n  /* reexport */\n  createValidAbsoluteUrl,\n  fetchData: () =>\n  /* reexport */\n  fetchData,\n  getDocument: () =>\n  /* reexport */\n  getDocument,\n  getFilenameFromUrl: () =>\n  /* reexport */\n  getFilenameFromUrl,\n  getPdfFilenameFromUrl: () =>\n  /* reexport */\n  getPdfFilenameFromUrl,\n  getXfaPageViewport: () =>\n  /* reexport */\n  getXfaPageViewport,\n  isDataScheme: () =>\n  /* reexport */\n  isDataScheme,\n  isPdfFile: () =>\n  /* reexport */\n  isPdfFile,\n  noContextMenu: () =>\n  /* reexport */\n  noContextMenu,\n  normalizeUnicode: () =>\n  /* reexport */\n  normalizeUnicode,\n  setLayerDimensions: () =>\n  /* reexport */\n  setLayerDimensions,\n  shadow: () =>\n  /* reexport */\n  shadow,\n  version: () =>\n  /* reexport */\n  version\n});\n\n; // CONCATENATED MODULE: ./src/shared/util.js\n\nconst isNodeJS = typeof process === \"object\" && process + \"\" === \"[object process]\" && !process.versions.nw && !(process.versions.electron && process.type && process.type !== \"browser\");\nconst IDENTITY_MATRIX = [1, 0, 0, 1, 0, 0];\nconst FONT_IDENTITY_MATRIX = [0.001, 0, 0, 0.001, 0, 0];\nconst MAX_IMAGE_SIZE_TO_CACHE = 10e6;\nconst LINE_FACTOR = 1.35;\nconst LINE_DESCENT_FACTOR = 0.35;\nconst BASELINE_FACTOR = LINE_DESCENT_FACTOR / LINE_FACTOR;\nconst RenderingIntentFlag = {\n  ANY: 0x01,\n  DISPLAY: 0x02,\n  PRINT: 0x04,\n  SAVE: 0x08,\n  ANNOTATIONS_FORMS: 0x10,\n  ANNOTATIONS_STORAGE: 0x20,\n  ANNOTATIONS_DISABLE: 0x40,\n  IS_EDITING: 0x80,\n  OPLIST: 0x100\n};\nconst AnnotationMode = {\n  DISABLE: 0,\n  ENABLE: 1,\n  ENABLE_FORMS: 2,\n  ENABLE_STORAGE: 3\n};\nconst AnnotationEditorPrefix = \"pdfjs_internal_editor_\";\nconst AnnotationEditorType = {\n  DISABLE: -1,\n  NONE: 0,\n  FREETEXT: 3,\n  HIGHLIGHT: 9,\n  STAMP: 13,\n  INK: 15\n};\nconst AnnotationEditorParamsType = {\n  RESIZE: 1,\n  CREATE: 2,\n  FREETEXT_SIZE: 11,\n  FREETEXT_COLOR: 12,\n  FREETEXT_OPACITY: 13,\n  INK_COLOR: 21,\n  INK_THICKNESS: 22,\n  INK_OPACITY: 23,\n  HIGHLIGHT_COLOR: 31,\n  HIGHLIGHT_DEFAULT_COLOR: 32,\n  HIGHLIGHT_THICKNESS: 33,\n  HIGHLIGHT_FREE: 34,\n  HIGHLIGHT_SHOW_ALL: 35\n};\nconst PermissionFlag = {\n  PRINT: 0x04,\n  MODIFY_CONTENTS: 0x08,\n  COPY: 0x10,\n  MODIFY_ANNOTATIONS: 0x20,\n  FILL_INTERACTIVE_FORMS: 0x100,\n  COPY_FOR_ACCESSIBILITY: 0x200,\n  ASSEMBLE: 0x400,\n  PRINT_HIGH_QUALITY: 0x800\n};\nconst TextRenderingMode = {\n  FILL: 0,\n  STROKE: 1,\n  FILL_STROKE: 2,\n  INVISIBLE: 3,\n  FILL_ADD_TO_PATH: 4,\n  STROKE_ADD_TO_PATH: 5,\n  FILL_STROKE_ADD_TO_PATH: 6,\n  ADD_TO_PATH: 7,\n  FILL_STROKE_MASK: 3,\n  ADD_TO_PATH_FLAG: 4\n};\nconst util_ImageKind = {\n  GRAYSCALE_1BPP: 1,\n  RGB_24BPP: 2,\n  RGBA_32BPP: 3\n};\nconst AnnotationType = {\n  TEXT: 1,\n  LINK: 2,\n  FREETEXT: 3,\n  LINE: 4,\n  SQUARE: 5,\n  CIRCLE: 6,\n  POLYGON: 7,\n  POLYLINE: 8,\n  HIGHLIGHT: 9,\n  UNDERLINE: 10,\n  SQUIGGLY: 11,\n  STRIKEOUT: 12,\n  STAMP: 13,\n  CARET: 14,\n  INK: 15,\n  POPUP: 16,\n  FILEATTACHMENT: 17,\n  SOUND: 18,\n  MOVIE: 19,\n  WIDGET: 20,\n  SCREEN: 21,\n  PRINTERMARK: 22,\n  TRAPNET: 23,\n  WATERMARK: 24,\n  THREED: 25,\n  REDACT: 26\n};\nconst AnnotationReplyType = {\n  GROUP: \"Group\",\n  REPLY: \"R\"\n};\nconst AnnotationFlag = {\n  INVISIBLE: 0x01,\n  HIDDEN: 0x02,\n  PRINT: 0x04,\n  NOZOOM: 0x08,\n  NOROTATE: 0x10,\n  NOVIEW: 0x20,\n  READONLY: 0x40,\n  LOCKED: 0x80,\n  TOGGLENOVIEW: 0x100,\n  LOCKEDCONTENTS: 0x200\n};\nconst AnnotationFieldFlag = {\n  READONLY: 0x0000001,\n  REQUIRED: 0x0000002,\n  NOEXPORT: 0x0000004,\n  MULTILINE: 0x0001000,\n  PASSWORD: 0x0002000,\n  NOTOGGLETOOFF: 0x0004000,\n  RADIO: 0x0008000,\n  PUSHBUTTON: 0x0010000,\n  COMBO: 0x0020000,\n  EDIT: 0x0040000,\n  SORT: 0x0080000,\n  FILESELECT: 0x0100000,\n  MULTISELECT: 0x0200000,\n  DONOTSPELLCHECK: 0x0400000,\n  DONOTSCROLL: 0x0800000,\n  COMB: 0x1000000,\n  RICHTEXT: 0x2000000,\n  RADIOSINUNISON: 0x2000000,\n  COMMITONSELCHANGE: 0x4000000\n};\nconst AnnotationBorderStyleType = {\n  SOLID: 1,\n  DASHED: 2,\n  BEVELED: 3,\n  INSET: 4,\n  UNDERLINE: 5\n};\nconst AnnotationActionEventType = {\n  E: \"Mouse Enter\",\n  X: \"Mouse Exit\",\n  D: \"Mouse Down\",\n  U: \"Mouse Up\",\n  Fo: \"Focus\",\n  Bl: \"Blur\",\n  PO: \"PageOpen\",\n  PC: \"PageClose\",\n  PV: \"PageVisible\",\n  PI: \"PageInvisible\",\n  K: \"Keystroke\",\n  F: \"Format\",\n  V: \"Validate\",\n  C: \"Calculate\"\n};\nconst DocumentActionEventType = {\n  WC: \"WillClose\",\n  WS: \"WillSave\",\n  DS: \"DidSave\",\n  WP: \"WillPrint\",\n  DP: \"DidPrint\"\n};\nconst PageActionEventType = {\n  O: \"PageOpen\",\n  C: \"PageClose\"\n};\nconst VerbosityLevel = {\n  ERRORS: 0,\n  WARNINGS: 1,\n  INFOS: 5\n};\nconst CMapCompressionType = {\n  NONE: 0,\n  BINARY: 1\n};\nconst OPS = {\n  dependency: 1,\n  setLineWidth: 2,\n  setLineCap: 3,\n  setLineJoin: 4,\n  setMiterLimit: 5,\n  setDash: 6,\n  setRenderingIntent: 7,\n  setFlatness: 8,\n  setGState: 9,\n  save: 10,\n  restore: 11,\n  transform: 12,\n  moveTo: 13,\n  lineTo: 14,\n  curveTo: 15,\n  curveTo2: 16,\n  curveTo3: 17,\n  closePath: 18,\n  rectangle: 19,\n  stroke: 20,\n  closeStroke: 21,\n  fill: 22,\n  eoFill: 23,\n  fillStroke: 24,\n  eoFillStroke: 25,\n  closeFillStroke: 26,\n  closeEOFillStroke: 27,\n  endPath: 28,\n  clip: 29,\n  eoClip: 30,\n  beginText: 31,\n  endText: 32,\n  setCharSpacing: 33,\n  setWordSpacing: 34,\n  setHScale: 35,\n  setLeading: 36,\n  setFont: 37,\n  setTextRenderingMode: 38,\n  setTextRise: 39,\n  moveText: 40,\n  setLeadingMoveText: 41,\n  setTextMatrix: 42,\n  nextLine: 43,\n  showText: 44,\n  showSpacedText: 45,\n  nextLineShowText: 46,\n  nextLineSetSpacingShowText: 47,\n  setCharWidth: 48,\n  setCharWidthAndBounds: 49,\n  setStrokeColorSpace: 50,\n  setFillColorSpace: 51,\n  setStrokeColor: 52,\n  setStrokeColorN: 53,\n  setFillColor: 54,\n  setFillColorN: 55,\n  setStrokeGray: 56,\n  setFillGray: 57,\n  setStrokeRGBColor: 58,\n  setFillRGBColor: 59,\n  setStrokeCMYKColor: 60,\n  setFillCMYKColor: 61,\n  shadingFill: 62,\n  beginInlineImage: 63,\n  beginImageData: 64,\n  endInlineImage: 65,\n  paintXObject: 66,\n  markPoint: 67,\n  markPointProps: 68,\n  beginMarkedContent: 69,\n  beginMarkedContentProps: 70,\n  endMarkedContent: 71,\n  beginCompat: 72,\n  endCompat: 73,\n  paintFormXObjectBegin: 74,\n  paintFormXObjectEnd: 75,\n  beginGroup: 76,\n  endGroup: 77,\n  beginAnnotation: 80,\n  endAnnotation: 81,\n  paintImageMaskXObject: 83,\n  paintImageMaskXObjectGroup: 84,\n  paintImageXObject: 85,\n  paintInlineImageXObject: 86,\n  paintInlineImageXObjectGroup: 87,\n  paintImageXObjectRepeat: 88,\n  paintImageMaskXObjectRepeat: 89,\n  paintSolidColorImageMask: 90,\n  constructPath: 91,\n  setStrokeTransparent: 92,\n  setFillTransparent: 93\n};\nconst PasswordResponses = {\n  NEED_PASSWORD: 1,\n  INCORRECT_PASSWORD: 2\n};\nlet verbosity = VerbosityLevel.WARNINGS;\n\nfunction setVerbosityLevel(level) {\n  if (Number.isInteger(level)) {\n    verbosity = level;\n  }\n}\n\nfunction getVerbosityLevel() {\n  return verbosity;\n}\n\nfunction info(msg) {\n  if (verbosity >= VerbosityLevel.INFOS) {\n    console.log(`Info: ${msg}`);\n  }\n}\n\nfunction warn(msg) {\n  if (verbosity >= VerbosityLevel.WARNINGS) {\n    console.log(`Warning: ${msg}`);\n  }\n}\n\nfunction unreachable(msg) {\n  throw new Error(msg);\n}\n\nfunction assert(cond, msg) {\n  if (!cond) {\n    unreachable(msg);\n  }\n}\n\nfunction _isValidProtocol(url) {\n  switch (url?.protocol) {\n    case \"http:\":\n    case \"https:\":\n    case \"ftp:\":\n    case \"mailto:\":\n    case \"tel:\":\n      return true;\n\n    default:\n      return false;\n  }\n}\n\nfunction createValidAbsoluteUrl(url, baseUrl = null, options = null) {\n  if (!url) {\n    return null;\n  }\n\n  try {\n    if (options && typeof url === \"string\") {\n      if (options.addDefaultProtocol && url.startsWith(\"www.\")) {\n        const dots = url.match(/\\./g);\n\n        if (dots?.length >= 2) {\n          url = `http://${url}`;\n        }\n      }\n\n      if (options.tryConvertEncoding) {\n        try {\n          url = stringToUTF8String(url);\n        } catch {}\n      }\n    }\n\n    const absoluteUrl = baseUrl ? new URL(url, baseUrl) : new URL(url);\n\n    if (_isValidProtocol(absoluteUrl)) {\n      return absoluteUrl;\n    }\n  } catch {}\n\n  return null;\n}\n\nfunction shadow(obj, prop, value, nonSerializable = false) {\n  Object.defineProperty(obj, prop, {\n    value,\n    enumerable: !nonSerializable,\n    configurable: true,\n    writable: false\n  });\n  return value;\n}\n\nconst BaseException = function BaseExceptionClosure() {\n  function BaseException(message, name) {\n    this.message = message;\n    this.name = name;\n  }\n\n  BaseException.prototype = new Error();\n  BaseException.constructor = BaseException;\n  return BaseException;\n}();\n\nclass PasswordException extends BaseException {\n  constructor(msg, code) {\n    super(msg, \"PasswordException\");\n    this.code = code;\n  }\n\n}\n\nclass UnknownErrorException extends BaseException {\n  constructor(msg, details) {\n    super(msg, \"UnknownErrorException\");\n    this.details = details;\n  }\n\n}\n\nclass InvalidPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"InvalidPDFException\");\n  }\n\n}\n\nclass MissingPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"MissingPDFException\");\n  }\n\n}\n\nclass UnexpectedResponseException extends BaseException {\n  constructor(msg, status) {\n    super(msg, \"UnexpectedResponseException\");\n    this.status = status;\n  }\n\n}\n\nclass FormatError extends BaseException {\n  constructor(msg) {\n    super(msg, \"FormatError\");\n  }\n\n}\n\nclass AbortException extends BaseException {\n  constructor(msg) {\n    super(msg, \"AbortException\");\n  }\n\n}\n\nfunction bytesToString(bytes) {\n  if (typeof bytes !== \"object\" || bytes?.length === undefined) {\n    unreachable(\"Invalid argument for bytesToString\");\n  }\n\n  const length = bytes.length;\n  const MAX_ARGUMENT_COUNT = 8192;\n\n  if (length < MAX_ARGUMENT_COUNT) {\n    return String.fromCharCode.apply(null, bytes);\n  }\n\n  const strBuf = [];\n\n  for (let i = 0; i < length; i += MAX_ARGUMENT_COUNT) {\n    const chunkEnd = Math.min(i + MAX_ARGUMENT_COUNT, length);\n    const chunk = bytes.subarray(i, chunkEnd);\n    strBuf.push(String.fromCharCode.apply(null, chunk));\n  }\n\n  return strBuf.join(\"\");\n}\n\nfunction stringToBytes(str) {\n  if (typeof str !== \"string\") {\n    unreachable(\"Invalid argument for stringToBytes\");\n  }\n\n  const length = str.length;\n  const bytes = new Uint8Array(length);\n\n  for (let i = 0; i < length; ++i) {\n    bytes[i] = str.charCodeAt(i) & 0xff;\n  }\n\n  return bytes;\n}\n\nfunction string32(value) {\n  return String.fromCharCode(value >> 24 & 0xff, value >> 16 & 0xff, value >> 8 & 0xff, value & 0xff);\n}\n\nfunction objectSize(obj) {\n  return Object.keys(obj).length;\n}\n\nfunction objectFromMap(map) {\n  const obj = Object.create(null);\n\n  for (const [key, value] of map) {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction isLittleEndian() {\n  const buffer8 = new Uint8Array(4);\n  buffer8[0] = 1;\n  const view32 = new Uint32Array(buffer8.buffer, 0, 1);\n  return view32[0] === 1;\n}\n\nfunction isEvalSupported() {\n  try {\n    new Function(\"\");\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nclass util_FeatureTest {\n  static get isLittleEndian() {\n    return shadow(this, \"isLittleEndian\", isLittleEndian());\n  }\n\n  static get isEvalSupported() {\n    return shadow(this, \"isEvalSupported\", isEvalSupported());\n  }\n\n  static get isOffscreenCanvasSupported() {\n    return shadow(this, \"isOffscreenCanvasSupported\", typeof OffscreenCanvas !== \"undefined\");\n  }\n\n  static get platform() {\n    if (typeof navigator !== \"undefined\" && typeof navigator?.platform === \"string\") {\n      return shadow(this, \"platform\", {\n        isMac: navigator.platform.includes(\"Mac\")\n      });\n    }\n\n    return shadow(this, \"platform\", {\n      isMac: false\n    });\n  }\n\n  static get isCSSRoundSupported() {\n    return shadow(this, \"isCSSRoundSupported\", globalThis.CSS?.supports?.(\"width: round(1.5px, 1px)\"));\n  }\n\n}\n\nconst hexNumbers = Array.from(Array(256).keys(), n => n.toString(16).padStart(2, \"0\"));\n\nclass Util {\n  static makeHexColor(r, g, b) {\n    return `#${hexNumbers[r]}${hexNumbers[g]}${hexNumbers[b]}`;\n  }\n\n  static scaleMinMax(transform, minMax) {\n    let temp;\n\n    if (transform[0]) {\n      if (transform[0] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[2];\n        minMax[2] = temp;\n      }\n\n      minMax[0] *= transform[0];\n      minMax[2] *= transform[0];\n\n      if (transform[3] < 0) {\n        temp = minMax[1];\n        minMax[1] = minMax[3];\n        minMax[3] = temp;\n      }\n\n      minMax[1] *= transform[3];\n      minMax[3] *= transform[3];\n    } else {\n      temp = minMax[0];\n      minMax[0] = minMax[1];\n      minMax[1] = temp;\n      temp = minMax[2];\n      minMax[2] = minMax[3];\n      minMax[3] = temp;\n\n      if (transform[1] < 0) {\n        temp = minMax[1];\n        minMax[1] = minMax[3];\n        minMax[3] = temp;\n      }\n\n      minMax[1] *= transform[1];\n      minMax[3] *= transform[1];\n\n      if (transform[2] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[2];\n        minMax[2] = temp;\n      }\n\n      minMax[0] *= transform[2];\n      minMax[2] *= transform[2];\n    }\n\n    minMax[0] += transform[4];\n    minMax[1] += transform[5];\n    minMax[2] += transform[4];\n    minMax[3] += transform[5];\n  }\n\n  static transform(m1, m2) {\n    return [m1[0] * m2[0] + m1[2] * m2[1], m1[1] * m2[0] + m1[3] * m2[1], m1[0] * m2[2] + m1[2] * m2[3], m1[1] * m2[2] + m1[3] * m2[3], m1[0] * m2[4] + m1[2] * m2[5] + m1[4], m1[1] * m2[4] + m1[3] * m2[5] + m1[5]];\n  }\n\n  static applyTransform(p, m) {\n    const xt = p[0] * m[0] + p[1] * m[2] + m[4];\n    const yt = p[0] * m[1] + p[1] * m[3] + m[5];\n    return [xt, yt];\n  }\n\n  static applyInverseTransform(p, m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    const xt = (p[0] * m[3] - p[1] * m[2] + m[2] * m[5] - m[4] * m[3]) / d;\n    const yt = (-p[0] * m[1] + p[1] * m[0] + m[4] * m[1] - m[5] * m[0]) / d;\n    return [xt, yt];\n  }\n\n  static getAxialAlignedBoundingBox(r, m) {\n    const p1 = this.applyTransform(r, m);\n    const p2 = this.applyTransform(r.slice(2, 4), m);\n    const p3 = this.applyTransform([r[0], r[3]], m);\n    const p4 = this.applyTransform([r[2], r[1]], m);\n    return [Math.min(p1[0], p2[0], p3[0], p4[0]), Math.min(p1[1], p2[1], p3[1], p4[1]), Math.max(p1[0], p2[0], p3[0], p4[0]), Math.max(p1[1], p2[1], p3[1], p4[1])];\n  }\n\n  static inverseTransform(m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    return [m[3] / d, -m[1] / d, -m[2] / d, m[0] / d, (m[2] * m[5] - m[4] * m[3]) / d, (m[4] * m[1] - m[5] * m[0]) / d];\n  }\n\n  static singularValueDecompose2dScale(m) {\n    const transpose = [m[0], m[2], m[1], m[3]];\n    const a = m[0] * transpose[0] + m[1] * transpose[2];\n    const b = m[0] * transpose[1] + m[1] * transpose[3];\n    const c = m[2] * transpose[0] + m[3] * transpose[2];\n    const d = m[2] * transpose[1] + m[3] * transpose[3];\n    const first = (a + d) / 2;\n    const second = Math.sqrt((a + d) ** 2 - 4 * (a * d - c * b)) / 2;\n    const sx = first + second || 1;\n    const sy = first - second || 1;\n    return [Math.sqrt(sx), Math.sqrt(sy)];\n  }\n\n  static normalizeRect(rect) {\n    const r = rect.slice(0);\n\n    if (rect[0] > rect[2]) {\n      r[0] = rect[2];\n      r[2] = rect[0];\n    }\n\n    if (rect[1] > rect[3]) {\n      r[1] = rect[3];\n      r[3] = rect[1];\n    }\n\n    return r;\n  }\n\n  static intersect(rect1, rect2) {\n    const xLow = Math.max(Math.min(rect1[0], rect1[2]), Math.min(rect2[0], rect2[2]));\n    const xHigh = Math.min(Math.max(rect1[0], rect1[2]), Math.max(rect2[0], rect2[2]));\n\n    if (xLow > xHigh) {\n      return null;\n    }\n\n    const yLow = Math.max(Math.min(rect1[1], rect1[3]), Math.min(rect2[1], rect2[3]));\n    const yHigh = Math.min(Math.max(rect1[1], rect1[3]), Math.max(rect2[1], rect2[3]));\n\n    if (yLow > yHigh) {\n      return null;\n    }\n\n    return [xLow, yLow, xHigh, yHigh];\n  }\n\n  static #getExtremumOnCurve(x0, x1, x2, x3, y0, y1, y2, y3, t, minMax) {\n    if (t <= 0 || t >= 1) {\n      return;\n    }\n\n    const mt = 1 - t;\n    const tt = t * t;\n    const ttt = tt * t;\n    const x = mt * (mt * (mt * x0 + 3 * t * x1) + 3 * tt * x2) + ttt * x3;\n    const y = mt * (mt * (mt * y0 + 3 * t * y1) + 3 * tt * y2) + ttt * y3;\n    minMax[0] = Math.min(minMax[0], x);\n    minMax[1] = Math.min(minMax[1], y);\n    minMax[2] = Math.max(minMax[2], x);\n    minMax[3] = Math.max(minMax[3], y);\n  }\n\n  static #getExtremum(x0, x1, x2, x3, y0, y1, y2, y3, a, b, c, minMax) {\n    if (Math.abs(a) < 1e-12) {\n      if (Math.abs(b) >= 1e-12) {\n        this.#getExtremumOnCurve(x0, x1, x2, x3, y0, y1, y2, y3, -c / b, minMax);\n      }\n\n      return;\n    }\n\n    const delta = b ** 2 - 4 * c * a;\n\n    if (delta < 0) {\n      return;\n    }\n\n    const sqrtDelta = Math.sqrt(delta);\n    const a2 = 2 * a;\n    this.#getExtremumOnCurve(x0, x1, x2, x3, y0, y1, y2, y3, (-b + sqrtDelta) / a2, minMax);\n    this.#getExtremumOnCurve(x0, x1, x2, x3, y0, y1, y2, y3, (-b - sqrtDelta) / a2, minMax);\n  }\n\n  static bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3, minMax) {\n    if (minMax) {\n      minMax[0] = Math.min(minMax[0], x0, x3);\n      minMax[1] = Math.min(minMax[1], y0, y3);\n      minMax[2] = Math.max(minMax[2], x0, x3);\n      minMax[3] = Math.max(minMax[3], y0, y3);\n    } else {\n      minMax = [Math.min(x0, x3), Math.min(y0, y3), Math.max(x0, x3), Math.max(y0, y3)];\n    }\n\n    this.#getExtremum(x0, x1, x2, x3, y0, y1, y2, y3, 3 * (-x0 + 3 * (x1 - x2) + x3), 6 * (x0 - 2 * x1 + x2), 3 * (x1 - x0), minMax);\n    this.#getExtremum(x0, x1, x2, x3, y0, y1, y2, y3, 3 * (-y0 + 3 * (y1 - y2) + y3), 6 * (y0 - 2 * y1 + y2), 3 * (y1 - y0), minMax);\n    return minMax;\n  }\n\n}\n\nconst PDFStringTranslateTable =\n/* unused pure expression or super */\nnull && [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2d8, 0x2c7, 0x2c6, 0x2d9, 0x2dd, 0x2db, 0x2da, 0x2dc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2022, 0x2020, 0x2021, 0x2026, 0x2014, 0x2013, 0x192, 0x2044, 0x2039, 0x203a, 0x2212, 0x2030, 0x201e, 0x201c, 0x201d, 0x2018, 0x2019, 0x201a, 0x2122, 0xfb01, 0xfb02, 0x141, 0x152, 0x160, 0x178, 0x17d, 0x131, 0x142, 0x153, 0x161, 0x17e, 0, 0x20ac];\n\nfunction stringToPDFString(str) {\n  if (str[0] >= \"\\xEF\") {\n    let encoding;\n\n    if (str[0] === \"\\xFE\" && str[1] === \"\\xFF\") {\n      encoding = \"utf-16be\";\n\n      if (str.length % 2 === 1) {\n        str = str.slice(0, -1);\n      }\n    } else if (str[0] === \"\\xFF\" && str[1] === \"\\xFE\") {\n      encoding = \"utf-16le\";\n\n      if (str.length % 2 === 1) {\n        str = str.slice(0, -1);\n      }\n    } else if (str[0] === \"\\xEF\" && str[1] === \"\\xBB\" && str[2] === \"\\xBF\") {\n      encoding = \"utf-8\";\n    }\n\n    if (encoding) {\n      try {\n        const decoder = new TextDecoder(encoding, {\n          fatal: true\n        });\n        const buffer = stringToBytes(str);\n        const decoded = decoder.decode(buffer);\n\n        if (!decoded.includes(\"\\x1b\")) {\n          return decoded;\n        }\n\n        return decoded.replaceAll(/\\x1b[^\\x1b]*(?:\\x1b|$)/g, \"\");\n      } catch (ex) {\n        warn(`stringToPDFString: \"${ex}\".`);\n      }\n    }\n  }\n\n  const strBuf = [];\n\n  for (let i = 0, ii = str.length; i < ii; i++) {\n    const charCode = str.charCodeAt(i);\n\n    if (charCode === 0x1b) {\n      while (++i < ii && str.charCodeAt(i) !== 0x1b) {}\n\n      continue;\n    }\n\n    const code = PDFStringTranslateTable[charCode];\n    strBuf.push(code ? String.fromCharCode(code) : str.charAt(i));\n  }\n\n  return strBuf.join(\"\");\n}\n\nfunction stringToUTF8String(str) {\n  return decodeURIComponent(escape(str));\n}\n\nfunction utf8StringToString(str) {\n  return unescape(encodeURIComponent(str));\n}\n\nfunction isArrayEqual(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n\n  for (let i = 0, ii = arr1.length; i < ii; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction getModificationDate(date = new Date()) {\n  const buffer = [date.getUTCFullYear().toString(), (date.getUTCMonth() + 1).toString().padStart(2, \"0\"), date.getUTCDate().toString().padStart(2, \"0\"), date.getUTCHours().toString().padStart(2, \"0\"), date.getUTCMinutes().toString().padStart(2, \"0\"), date.getUTCSeconds().toString().padStart(2, \"0\")];\n  return buffer.join(\"\");\n}\n\nlet NormalizeRegex = null;\nlet NormalizationMap = null;\n\nfunction normalizeUnicode(str) {\n  if (!NormalizeRegex) {\n    NormalizeRegex = /([\\u00a0\\u00b5\\u037e\\u0eb3\\u2000-\\u200a\\u202f\\u2126\\ufb00-\\ufb04\\ufb06\\ufb20-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufba1\\ufba4-\\ufba9\\ufbae-\\ufbb1\\ufbd3-\\ufbdc\\ufbde-\\ufbe7\\ufbea-\\ufbf8\\ufbfc-\\ufbfd\\ufc00-\\ufc5d\\ufc64-\\ufcf1\\ufcf5-\\ufd3d\\ufd88\\ufdf4\\ufdfa-\\ufdfb\\ufe71\\ufe77\\ufe79\\ufe7b\\ufe7d]+)|(\\ufb05+)/gu;\n    NormalizationMap = new Map([[\"ﬅ\", \"ſt\"]]);\n  }\n\n  return str.replaceAll(NormalizeRegex, (_, p1, p2) => p1 ? p1.normalize(\"NFKC\") : NormalizationMap.get(p2));\n}\n\nfunction getUuid() {\n  if (typeof crypto !== \"undefined\" && typeof crypto?.randomUUID === \"function\") {\n    return crypto.randomUUID();\n  }\n\n  const buf = new Uint8Array(32);\n\n  if (typeof crypto !== \"undefined\" && typeof crypto?.getRandomValues === \"function\") {\n    crypto.getRandomValues(buf);\n  } else {\n    for (let i = 0; i < 32; i++) {\n      buf[i] = Math.floor(Math.random() * 255);\n    }\n  }\n\n  return bytesToString(buf);\n}\n\nconst AnnotationPrefix = \"pdfjs_internal_id_\";\nconst FontRenderOps = {\n  BEZIER_CURVE_TO: 0,\n  MOVE_TO: 1,\n  LINE_TO: 2,\n  QUADRATIC_CURVE_TO: 3,\n  RESTORE: 4,\n  SAVE: 5,\n  SCALE: 6,\n  TRANSFORM: 7,\n  TRANSLATE: 8\n};\n; // CONCATENATED MODULE: ./src/display/base_factory.js\n\nclass BaseFilterFactory {\n  addFilter(maps) {\n    return \"none\";\n  }\n\n  addHCMFilter(fgColor, bgColor) {\n    return \"none\";\n  }\n\n  addAlphaFilter(map) {\n    return \"none\";\n  }\n\n  addLuminosityFilter(map) {\n    return \"none\";\n  }\n\n  addHighlightHCMFilter(filterName, fgColor, bgColor, newFgColor, newBgColor) {\n    return \"none\";\n  }\n\n  destroy(keepHCM = false) {}\n\n}\n\nclass BaseCanvasFactory {\n  #enableHWA = false;\n\n  constructor({\n    enableHWA = false\n  } = {}) {\n    this.#enableHWA = enableHWA;\n  }\n\n  create(width, height) {\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid canvas size\");\n    }\n\n    const canvas = this._createCanvas(width, height);\n\n    return {\n      canvas,\n      context: canvas.getContext(\"2d\", {\n        willReadFrequently: !this.#enableHWA\n      })\n    };\n  }\n\n  reset(canvasAndContext, width, height) {\n    if (!canvasAndContext.canvas) {\n      throw new Error(\"Canvas is not specified\");\n    }\n\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid canvas size\");\n    }\n\n    canvasAndContext.canvas.width = width;\n    canvasAndContext.canvas.height = height;\n  }\n\n  destroy(canvasAndContext) {\n    if (!canvasAndContext.canvas) {\n      throw new Error(\"Canvas is not specified\");\n    }\n\n    canvasAndContext.canvas.width = 0;\n    canvasAndContext.canvas.height = 0;\n    canvasAndContext.canvas = null;\n    canvasAndContext.context = null;\n  }\n\n  _createCanvas(width, height) {\n    unreachable(\"Abstract method `_createCanvas` called.\");\n  }\n\n}\n\nclass BaseCMapReaderFactory {\n  constructor({\n    baseUrl = null,\n    isCompressed = true\n  }) {\n    this.baseUrl = baseUrl;\n    this.isCompressed = isCompressed;\n  }\n\n  fetch({\n    name\n  }) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (!_this.baseUrl) {\n        throw new Error(\"Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.\");\n      }\n\n      if (!name) {\n        throw new Error(\"CMap name must be specified.\");\n      }\n\n      const url = _this.baseUrl + name + (_this.isCompressed ? \".bcmap\" : \"\");\n      const compressionType = _this.isCompressed ? CMapCompressionType.BINARY : CMapCompressionType.NONE;\n      return _this._fetchData(url, compressionType).catch(reason => {\n        throw new Error(`Unable to load ${_this.isCompressed ? \"binary \" : \"\"}CMap at: ${url}`);\n      });\n    })();\n  }\n\n  _fetchData(url, compressionType) {\n    unreachable(\"Abstract method `_fetchData` called.\");\n  }\n\n}\n\nclass BaseStandardFontDataFactory {\n  constructor({\n    baseUrl = null\n  }) {\n    this.baseUrl = baseUrl;\n  }\n\n  fetch({\n    filename\n  }) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!_this2.baseUrl) {\n        throw new Error(\"Ensure that the `standardFontDataUrl` API parameter is provided.\");\n      }\n\n      if (!filename) {\n        throw new Error(\"Font filename must be specified.\");\n      }\n\n      const url = `${_this2.baseUrl}${filename}`;\n      return _this2._fetchData(url).catch(reason => {\n        throw new Error(`Unable to load font data at: ${url}`);\n      });\n    })();\n  }\n\n  _fetchData(url) {\n    unreachable(\"Abstract method `_fetchData` called.\");\n  }\n\n}\n\nclass BaseSVGFactory {\n  create(width, height, skipDimensions = false) {\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid SVG dimensions\");\n    }\n\n    const svg = this._createSVG(\"svg:svg\");\n\n    svg.setAttribute(\"version\", \"1.1\");\n\n    if (!skipDimensions) {\n      svg.setAttribute(\"width\", `${width}px`);\n      svg.setAttribute(\"height\", `${height}px`);\n    }\n\n    svg.setAttribute(\"preserveAspectRatio\", \"none\");\n    svg.setAttribute(\"viewBox\", `0 0 ${width} ${height}`);\n    return svg;\n  }\n\n  createElement(type) {\n    if (typeof type !== \"string\") {\n      throw new Error(\"Invalid SVG element type\");\n    }\n\n    return this._createSVG(type);\n  }\n\n  _createSVG(type) {\n    unreachable(\"Abstract method `_createSVG` called.\");\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/display_utils.js\n\nconst SVG_NS = \"http://www.w3.org/2000/svg\";\n\nclass PixelsPerInch {\n  static CSS = 96.0;\n  static PDF = 72.0;\n  static PDF_TO_CSS_UNITS = this.CSS / this.PDF;\n}\n\nclass DOMFilterFactory extends BaseFilterFactory {\n  #baseUrl;\n  #_cache;\n  #_defs;\n  #docId;\n  #document;\n  #_hcmCache;\n  #id = 0;\n\n  constructor({\n    docId,\n    ownerDocument = globalThis.document\n  } = {}) {\n    super();\n    this.#docId = docId;\n    this.#document = ownerDocument;\n  }\n\n  get #cache() {\n    return this.#_cache ||= new Map();\n  }\n\n  get #hcmCache() {\n    return this.#_hcmCache ||= new Map();\n  }\n\n  get #defs() {\n    if (!this.#_defs) {\n      const div = this.#document.createElement(\"div\");\n      const {\n        style\n      } = div;\n      style.visibility = \"hidden\";\n      style.contain = \"strict\";\n      style.width = style.height = 0;\n      style.position = \"absolute\";\n      style.top = style.left = 0;\n      style.zIndex = -1;\n      const svg = this.#document.createElementNS(SVG_NS, \"svg\");\n      svg.setAttribute(\"width\", 0);\n      svg.setAttribute(\"height\", 0);\n      this.#_defs = this.#document.createElementNS(SVG_NS, \"defs\");\n      div.append(svg);\n      svg.append(this.#_defs);\n      this.#document.body.append(div);\n    }\n\n    return this.#_defs;\n  }\n\n  #createTables(maps) {\n    if (maps.length === 1) {\n      const mapR = maps[0];\n      const buffer = new Array(256);\n\n      for (let i = 0; i < 256; i++) {\n        buffer[i] = mapR[i] / 255;\n      }\n\n      const table = buffer.join(\",\");\n      return [table, table, table];\n    }\n\n    const [mapR, mapG, mapB] = maps;\n    const bufferR = new Array(256);\n    const bufferG = new Array(256);\n    const bufferB = new Array(256);\n\n    for (let i = 0; i < 256; i++) {\n      bufferR[i] = mapR[i] / 255;\n      bufferG[i] = mapG[i] / 255;\n      bufferB[i] = mapB[i] / 255;\n    }\n\n    return [bufferR.join(\",\"), bufferG.join(\",\"), bufferB.join(\",\")];\n  }\n\n  #createUrl(id) {\n    if (this.#baseUrl === undefined) {\n      this.#baseUrl = \"\";\n      const url = this.#document.URL;\n\n      if (url !== this.#document.baseURI) {\n        if (isDataScheme(url)) {\n          warn('#createUrl: ignore \"data:\"-URL for performance reasons.');\n        } else {\n          this.#baseUrl = url.split(\"#\", 1)[0];\n        }\n      }\n    }\n\n    return `url(${this.#baseUrl}#${id})`;\n  }\n\n  addFilter(maps) {\n    if (!maps) {\n      return \"none\";\n    }\n\n    let value = this.#cache.get(maps);\n\n    if (value) {\n      return value;\n    }\n\n    const [tableR, tableG, tableB] = this.#createTables(maps);\n    const key = maps.length === 1 ? tableR : `${tableR}${tableG}${tableB}`;\n    value = this.#cache.get(key);\n\n    if (value) {\n      this.#cache.set(maps, value);\n      return value;\n    }\n\n    const id = `g_${this.#docId}_transfer_map_${this.#id++}`;\n    const url = this.#createUrl(id);\n    this.#cache.set(maps, url);\n    this.#cache.set(key, url);\n    const filter = this.#createFilter(id);\n    this.#addTransferMapConversion(tableR, tableG, tableB, filter);\n    return url;\n  }\n\n  addHCMFilter(fgColor, bgColor) {\n    const key = `${fgColor}-${bgColor}`;\n    const filterName = \"base\";\n    let info = this.#hcmCache.get(filterName);\n\n    if (info?.key === key) {\n      return info.url;\n    }\n\n    if (info) {\n      info.filter?.remove();\n      info.key = key;\n      info.url = \"none\";\n      info.filter = null;\n    } else {\n      info = {\n        key,\n        url: \"none\",\n        filter: null\n      };\n      this.#hcmCache.set(filterName, info);\n    }\n\n    if (!fgColor || !bgColor) {\n      return info.url;\n    }\n\n    const fgRGB = this.#getRGB(fgColor);\n    fgColor = Util.makeHexColor(...fgRGB);\n    const bgRGB = this.#getRGB(bgColor);\n    bgColor = Util.makeHexColor(...bgRGB);\n    this.#defs.style.color = \"\";\n\n    if (fgColor === \"#000000\" && bgColor === \"#ffffff\" || fgColor === bgColor) {\n      return info.url;\n    }\n\n    const map = new Array(256);\n\n    for (let i = 0; i <= 255; i++) {\n      const x = i / 255;\n      map[i] = x <= 0.03928 ? x / 12.92 : ((x + 0.055) / 1.055) ** 2.4;\n    }\n\n    const table = map.join(\",\");\n    const id = `g_${this.#docId}_hcm_filter`;\n    const filter = info.filter = this.#createFilter(id);\n    this.#addTransferMapConversion(table, table, table, filter);\n    this.#addGrayConversion(filter);\n\n    const getSteps = (c, n) => {\n      const start = fgRGB[c] / 255;\n      const end = bgRGB[c] / 255;\n      const arr = new Array(n + 1);\n\n      for (let i = 0; i <= n; i++) {\n        arr[i] = start + i / n * (end - start);\n      }\n\n      return arr.join(\",\");\n    };\n\n    this.#addTransferMapConversion(getSteps(0, 5), getSteps(1, 5), getSteps(2, 5), filter);\n    info.url = this.#createUrl(id);\n    return info.url;\n  }\n\n  addAlphaFilter(map) {\n    let value = this.#cache.get(map);\n\n    if (value) {\n      return value;\n    }\n\n    const [tableA] = this.#createTables([map]);\n    const key = `alpha_${tableA}`;\n    value = this.#cache.get(key);\n\n    if (value) {\n      this.#cache.set(map, value);\n      return value;\n    }\n\n    const id = `g_${this.#docId}_alpha_map_${this.#id++}`;\n    const url = this.#createUrl(id);\n    this.#cache.set(map, url);\n    this.#cache.set(key, url);\n    const filter = this.#createFilter(id);\n    this.#addTransferMapAlphaConversion(tableA, filter);\n    return url;\n  }\n\n  addLuminosityFilter(map) {\n    let value = this.#cache.get(map || \"luminosity\");\n\n    if (value) {\n      return value;\n    }\n\n    let tableA, key;\n\n    if (map) {\n      [tableA] = this.#createTables([map]);\n      key = `luminosity_${tableA}`;\n    } else {\n      key = \"luminosity\";\n    }\n\n    value = this.#cache.get(key);\n\n    if (value) {\n      this.#cache.set(map, value);\n      return value;\n    }\n\n    const id = `g_${this.#docId}_luminosity_map_${this.#id++}`;\n    const url = this.#createUrl(id);\n    this.#cache.set(map, url);\n    this.#cache.set(key, url);\n    const filter = this.#createFilter(id);\n    this.#addLuminosityConversion(filter);\n\n    if (map) {\n      this.#addTransferMapAlphaConversion(tableA, filter);\n    }\n\n    return url;\n  }\n\n  addHighlightHCMFilter(filterName, fgColor, bgColor, newFgColor, newBgColor) {\n    const key = `${fgColor}-${bgColor}-${newFgColor}-${newBgColor}`;\n    let info = this.#hcmCache.get(filterName);\n\n    if (info?.key === key) {\n      return info.url;\n    }\n\n    if (info) {\n      info.filter?.remove();\n      info.key = key;\n      info.url = \"none\";\n      info.filter = null;\n    } else {\n      info = {\n        key,\n        url: \"none\",\n        filter: null\n      };\n      this.#hcmCache.set(filterName, info);\n    }\n\n    if (!fgColor || !bgColor) {\n      return info.url;\n    }\n\n    const [fgRGB, bgRGB] = [fgColor, bgColor].map(this.#getRGB.bind(this));\n    let fgGray = Math.round(0.2126 * fgRGB[0] + 0.7152 * fgRGB[1] + 0.0722 * fgRGB[2]);\n    let bgGray = Math.round(0.2126 * bgRGB[0] + 0.7152 * bgRGB[1] + 0.0722 * bgRGB[2]);\n    let [newFgRGB, newBgRGB] = [newFgColor, newBgColor].map(this.#getRGB.bind(this));\n\n    if (bgGray < fgGray) {\n      [fgGray, bgGray, newFgRGB, newBgRGB] = [bgGray, fgGray, newBgRGB, newFgRGB];\n    }\n\n    this.#defs.style.color = \"\";\n\n    const getSteps = (fg, bg, n) => {\n      const arr = new Array(256);\n      const step = (bgGray - fgGray) / n;\n      const newStart = fg / 255;\n      const newStep = (bg - fg) / (255 * n);\n      let prev = 0;\n\n      for (let i = 0; i <= n; i++) {\n        const k = Math.round(fgGray + i * step);\n        const value = newStart + i * newStep;\n\n        for (let j = prev; j <= k; j++) {\n          arr[j] = value;\n        }\n\n        prev = k + 1;\n      }\n\n      for (let i = prev; i < 256; i++) {\n        arr[i] = arr[prev - 1];\n      }\n\n      return arr.join(\",\");\n    };\n\n    const id = `g_${this.#docId}_hcm_${filterName}_filter`;\n    const filter = info.filter = this.#createFilter(id);\n    this.#addGrayConversion(filter);\n    this.#addTransferMapConversion(getSteps(newFgRGB[0], newBgRGB[0], 5), getSteps(newFgRGB[1], newBgRGB[1], 5), getSteps(newFgRGB[2], newBgRGB[2], 5), filter);\n    info.url = this.#createUrl(id);\n    return info.url;\n  }\n\n  destroy(keepHCM = false) {\n    if (keepHCM && this.#hcmCache.size !== 0) {\n      return;\n    }\n\n    if (this.#_defs) {\n      this.#_defs.parentNode.parentNode.remove();\n      this.#_defs = null;\n    }\n\n    if (this.#_cache) {\n      this.#_cache.clear();\n      this.#_cache = null;\n    }\n\n    this.#id = 0;\n  }\n\n  #addLuminosityConversion(filter) {\n    const feColorMatrix = this.#document.createElementNS(SVG_NS, \"feColorMatrix\");\n    feColorMatrix.setAttribute(\"type\", \"matrix\");\n    feColorMatrix.setAttribute(\"values\", \"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0\");\n    filter.append(feColorMatrix);\n  }\n\n  #addGrayConversion(filter) {\n    const feColorMatrix = this.#document.createElementNS(SVG_NS, \"feColorMatrix\");\n    feColorMatrix.setAttribute(\"type\", \"matrix\");\n    feColorMatrix.setAttribute(\"values\", \"0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0\");\n    filter.append(feColorMatrix);\n  }\n\n  #createFilter(id) {\n    const filter = this.#document.createElementNS(SVG_NS, \"filter\");\n    filter.setAttribute(\"color-interpolation-filters\", \"sRGB\");\n    filter.setAttribute(\"id\", id);\n    this.#defs.append(filter);\n    return filter;\n  }\n\n  #appendFeFunc(feComponentTransfer, func, table) {\n    const feFunc = this.#document.createElementNS(SVG_NS, func);\n    feFunc.setAttribute(\"type\", \"discrete\");\n    feFunc.setAttribute(\"tableValues\", table);\n    feComponentTransfer.append(feFunc);\n  }\n\n  #addTransferMapConversion(rTable, gTable, bTable, filter) {\n    const feComponentTransfer = this.#document.createElementNS(SVG_NS, \"feComponentTransfer\");\n    filter.append(feComponentTransfer);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncR\", rTable);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncG\", gTable);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncB\", bTable);\n  }\n\n  #addTransferMapAlphaConversion(aTable, filter) {\n    const feComponentTransfer = this.#document.createElementNS(SVG_NS, \"feComponentTransfer\");\n    filter.append(feComponentTransfer);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncA\", aTable);\n  }\n\n  #getRGB(color) {\n    this.#defs.style.color = color;\n    return getRGB(getComputedStyle(this.#defs).getPropertyValue(\"color\"));\n  }\n\n}\n\nclass DOMCanvasFactory extends BaseCanvasFactory {\n  constructor({\n    ownerDocument = globalThis.document,\n    enableHWA = false\n  } = {}) {\n    super({\n      enableHWA\n    });\n    this._document = ownerDocument;\n  }\n\n  _createCanvas(width, height) {\n    const canvas = this._document.createElement(\"canvas\");\n\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  }\n\n}\n\nfunction fetchData(_x) {\n  return _fetchData.apply(this, arguments);\n}\n\nfunction _fetchData() {\n  _fetchData = _asyncToGenerator(function* (url, type = \"text\") {\n    if (isValidFetchUrl(url, document.baseURI)) {\n      const response = yield fetch(url);\n\n      if (!response.ok) {\n        throw new Error(response.statusText);\n      }\n\n      switch (type) {\n        case \"arraybuffer\":\n          return response.arrayBuffer();\n\n        case \"blob\":\n          return response.blob();\n\n        case \"json\":\n          return response.json();\n      }\n\n      return response.text();\n    }\n\n    return new Promise((resolve, reject) => {\n      const request = new XMLHttpRequest();\n      request.open(\"GET\", url, true);\n      request.responseType = type;\n\n      request.onreadystatechange = () => {\n        if (request.readyState !== XMLHttpRequest.DONE) {\n          return;\n        }\n\n        if (request.status === 200 || request.status === 0) {\n          switch (type) {\n            case \"arraybuffer\":\n            case \"blob\":\n            case \"json\":\n              resolve(request.response);\n              return;\n          }\n\n          resolve(request.responseText);\n          return;\n        }\n\n        reject(new Error(request.statusText));\n      };\n\n      request.send(null);\n    });\n  });\n  return _fetchData.apply(this, arguments);\n}\n\nclass DOMCMapReaderFactory extends BaseCMapReaderFactory {\n  _fetchData(url, compressionType) {\n    return fetchData(url, this.isCompressed ? \"arraybuffer\" : \"text\").then(data => ({\n      cMapData: data instanceof ArrayBuffer ? new Uint8Array(data) : stringToBytes(data),\n      compressionType\n    }));\n  }\n\n}\n\nclass DOMStandardFontDataFactory extends BaseStandardFontDataFactory {\n  _fetchData(url) {\n    return fetchData(url, \"arraybuffer\").then(data => new Uint8Array(data));\n  }\n\n}\n\nclass DOMSVGFactory extends BaseSVGFactory {\n  _createSVG(type) {\n    return document.createElementNS(SVG_NS, type);\n  }\n\n}\n\nclass PageViewport {\n  constructor({\n    viewBox,\n    scale,\n    rotation,\n    offsetX = 0,\n    offsetY = 0,\n    dontFlip = false\n  }) {\n    this.viewBox = viewBox;\n    this.scale = scale;\n    this.rotation = rotation;\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    const centerX = (viewBox[2] + viewBox[0]) / 2;\n    const centerY = (viewBox[3] + viewBox[1]) / 2;\n    let rotateA, rotateB, rotateC, rotateD;\n    rotation %= 360;\n\n    if (rotation < 0) {\n      rotation += 360;\n    }\n\n    switch (rotation) {\n      case 180:\n        rotateA = -1;\n        rotateB = 0;\n        rotateC = 0;\n        rotateD = 1;\n        break;\n\n      case 90:\n        rotateA = 0;\n        rotateB = 1;\n        rotateC = 1;\n        rotateD = 0;\n        break;\n\n      case 270:\n        rotateA = 0;\n        rotateB = -1;\n        rotateC = -1;\n        rotateD = 0;\n        break;\n\n      case 0:\n        rotateA = 1;\n        rotateB = 0;\n        rotateC = 0;\n        rotateD = -1;\n        break;\n\n      default:\n        throw new Error(\"PageViewport: Invalid rotation, must be a multiple of 90 degrees.\");\n    }\n\n    if (dontFlip) {\n      rotateC = -rotateC;\n      rotateD = -rotateD;\n    }\n\n    let offsetCanvasX, offsetCanvasY;\n    let width, height;\n\n    if (rotateA === 0) {\n      offsetCanvasX = Math.abs(centerY - viewBox[1]) * scale + offsetX;\n      offsetCanvasY = Math.abs(centerX - viewBox[0]) * scale + offsetY;\n      width = (viewBox[3] - viewBox[1]) * scale;\n      height = (viewBox[2] - viewBox[0]) * scale;\n    } else {\n      offsetCanvasX = Math.abs(centerX - viewBox[0]) * scale + offsetX;\n      offsetCanvasY = Math.abs(centerY - viewBox[1]) * scale + offsetY;\n      width = (viewBox[2] - viewBox[0]) * scale;\n      height = (viewBox[3] - viewBox[1]) * scale;\n    }\n\n    this.transform = [rotateA * scale, rotateB * scale, rotateC * scale, rotateD * scale, offsetCanvasX - rotateA * scale * centerX - rotateC * scale * centerY, offsetCanvasY - rotateB * scale * centerX - rotateD * scale * centerY];\n    this.width = width;\n    this.height = height;\n  }\n\n  get rawDims() {\n    const {\n      viewBox\n    } = this;\n    return shadow(this, \"rawDims\", {\n      pageWidth: viewBox[2] - viewBox[0],\n      pageHeight: viewBox[3] - viewBox[1],\n      pageX: viewBox[0],\n      pageY: viewBox[1]\n    });\n  }\n\n  clone({\n    scale = this.scale,\n    rotation = this.rotation,\n    offsetX = this.offsetX,\n    offsetY = this.offsetY,\n    dontFlip = false\n  } = {}) {\n    return new PageViewport({\n      viewBox: this.viewBox.slice(),\n      scale,\n      rotation,\n      offsetX,\n      offsetY,\n      dontFlip\n    });\n  }\n\n  convertToViewportPoint(x, y) {\n    return Util.applyTransform([x, y], this.transform);\n  }\n\n  convertToViewportRectangle(rect) {\n    const topLeft = Util.applyTransform([rect[0], rect[1]], this.transform);\n    const bottomRight = Util.applyTransform([rect[2], rect[3]], this.transform);\n    return [topLeft[0], topLeft[1], bottomRight[0], bottomRight[1]];\n  }\n\n  convertToPdfPoint(x, y) {\n    return Util.applyInverseTransform([x, y], this.transform);\n  }\n\n}\n\nclass RenderingCancelledException extends BaseException {\n  constructor(msg, extraDelay = 0) {\n    super(msg, \"RenderingCancelledException\");\n    this.extraDelay = extraDelay;\n  }\n\n}\n\nfunction isDataScheme(url) {\n  const ii = url.length;\n  let i = 0;\n\n  while (i < ii && url[i].trim() === \"\") {\n    i++;\n  }\n\n  return url.substring(i, i + 5).toLowerCase() === \"data:\";\n}\n\nfunction isPdfFile(filename) {\n  return typeof filename === \"string\" && /\\.pdf$/i.test(filename);\n}\n\nfunction getFilenameFromUrl(url) {\n  [url] = url.split(/[#?]/, 1);\n  return url.substring(url.lastIndexOf(\"/\") + 1);\n}\n\nfunction getPdfFilenameFromUrl(url, defaultFilename = \"document.pdf\") {\n  if (typeof url !== \"string\") {\n    return defaultFilename;\n  }\n\n  if (isDataScheme(url)) {\n    warn('getPdfFilenameFromUrl: ignore \"data:\"-URL for performance reasons.');\n    return defaultFilename;\n  }\n\n  const reURI = /^(?:(?:[^:]+:)?\\/\\/[^/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n  const reFilename = /[^/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n  const splitURI = reURI.exec(url);\n  let suggestedFilename = reFilename.exec(splitURI[1]) || reFilename.exec(splitURI[2]) || reFilename.exec(splitURI[3]);\n\n  if (suggestedFilename) {\n    suggestedFilename = suggestedFilename[0];\n\n    if (suggestedFilename.includes(\"%\")) {\n      try {\n        suggestedFilename = reFilename.exec(decodeURIComponent(suggestedFilename))[0];\n      } catch {}\n    }\n  }\n\n  return suggestedFilename || defaultFilename;\n}\n\nclass StatTimer {\n  started = Object.create(null);\n  times = [];\n\n  time(name) {\n    if (name in this.started) {\n      warn(`Timer is already running for ${name}`);\n    }\n\n    this.started[name] = Date.now();\n  }\n\n  timeEnd(name) {\n    if (!(name in this.started)) {\n      warn(`Timer has not been started for ${name}`);\n    }\n\n    this.times.push({\n      name,\n      start: this.started[name],\n      end: Date.now()\n    });\n    delete this.started[name];\n  }\n\n  toString() {\n    const outBuf = [];\n    let longest = 0;\n\n    for (const {\n      name\n    } of this.times) {\n      longest = Math.max(name.length, longest);\n    }\n\n    for (const {\n      name,\n      start,\n      end\n    } of this.times) {\n      outBuf.push(`${name.padEnd(longest)} ${end - start}ms\\n`);\n    }\n\n    return outBuf.join(\"\");\n  }\n\n}\n\nfunction isValidFetchUrl(url, baseUrl) {\n  try {\n    const {\n      protocol\n    } = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    return protocol === \"http:\" || protocol === \"https:\";\n  } catch {\n    return false;\n  }\n}\n\nfunction noContextMenu(e) {\n  e.preventDefault();\n}\n\nfunction deprecated(details) {\n  console.log(\"Deprecated API usage: \" + details);\n}\n\nlet pdfDateStringRegex;\n\nclass PDFDateString {\n  static toDateObject(input) {\n    if (!input || typeof input !== \"string\") {\n      return null;\n    }\n\n    pdfDateStringRegex ||= new RegExp(\"^D:\" + \"(\\\\d{4})\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"([Z|+|-])?\" + \"(\\\\d{2})?\" + \"'?\" + \"(\\\\d{2})?\" + \"'?\");\n    const matches = pdfDateStringRegex.exec(input);\n\n    if (!matches) {\n      return null;\n    }\n\n    const year = parseInt(matches[1], 10);\n    let month = parseInt(matches[2], 10);\n    month = month >= 1 && month <= 12 ? month - 1 : 0;\n    let day = parseInt(matches[3], 10);\n    day = day >= 1 && day <= 31 ? day : 1;\n    let hour = parseInt(matches[4], 10);\n    hour = hour >= 0 && hour <= 23 ? hour : 0;\n    let minute = parseInt(matches[5], 10);\n    minute = minute >= 0 && minute <= 59 ? minute : 0;\n    let second = parseInt(matches[6], 10);\n    second = second >= 0 && second <= 59 ? second : 0;\n    const universalTimeRelation = matches[7] || \"Z\";\n    let offsetHour = parseInt(matches[8], 10);\n    offsetHour = offsetHour >= 0 && offsetHour <= 23 ? offsetHour : 0;\n    let offsetMinute = parseInt(matches[9], 10) || 0;\n    offsetMinute = offsetMinute >= 0 && offsetMinute <= 59 ? offsetMinute : 0;\n\n    if (universalTimeRelation === \"-\") {\n      hour += offsetHour;\n      minute += offsetMinute;\n    } else if (universalTimeRelation === \"+\") {\n      hour -= offsetHour;\n      minute -= offsetMinute;\n    }\n\n    return new Date(Date.UTC(year, month, day, hour, minute, second));\n  }\n\n}\n\nfunction getXfaPageViewport(xfaPage, {\n  scale = 1,\n  rotation = 0\n}) {\n  const {\n    width,\n    height\n  } = xfaPage.attributes.style;\n  const viewBox = [0, 0, parseInt(width), parseInt(height)];\n  return new PageViewport({\n    viewBox,\n    scale,\n    rotation\n  });\n}\n\nfunction getRGB(color) {\n  if (color.startsWith(\"#\")) {\n    const colorRGB = parseInt(color.slice(1), 16);\n    return [(colorRGB & 0xff0000) >> 16, (colorRGB & 0x00ff00) >> 8, colorRGB & 0x0000ff];\n  }\n\n  if (color.startsWith(\"rgb(\")) {\n    return color.slice(4, -1).split(\",\").map(x => parseInt(x));\n  }\n\n  if (color.startsWith(\"rgba(\")) {\n    return color.slice(5, -1).split(\",\").map(x => parseInt(x)).slice(0, 3);\n  }\n\n  warn(`Not a valid color format: \"${color}\"`);\n  return [0, 0, 0];\n}\n\nfunction getColorValues(colors) {\n  const span = document.createElement(\"span\");\n  span.style.visibility = \"hidden\";\n  document.body.append(span);\n\n  for (const name of colors.keys()) {\n    span.style.color = name;\n    const computedColor = window.getComputedStyle(span).color;\n    colors.set(name, getRGB(computedColor));\n  }\n\n  span.remove();\n}\n\nfunction getCurrentTransform(ctx) {\n  const {\n    a,\n    b,\n    c,\n    d,\n    e,\n    f\n  } = ctx.getTransform();\n  return [a, b, c, d, e, f];\n}\n\nfunction getCurrentTransformInverse(ctx) {\n  const {\n    a,\n    b,\n    c,\n    d,\n    e,\n    f\n  } = ctx.getTransform().invertSelf();\n  return [a, b, c, d, e, f];\n}\n\nfunction setLayerDimensions(div, viewport, mustFlip = false, mustRotate = true) {\n  if (viewport instanceof PageViewport) {\n    const {\n      pageWidth,\n      pageHeight\n    } = viewport.rawDims;\n    const {\n      style\n    } = div;\n    const useRound = util_FeatureTest.isCSSRoundSupported;\n    const w = `var(--scale-factor) * ${pageWidth}px`,\n          h = `var(--scale-factor) * ${pageHeight}px`;\n    const widthStr = useRound ? `round(${w}, 1px)` : `calc(${w})`,\n          heightStr = useRound ? `round(${h}, 1px)` : `calc(${h})`;\n\n    if (!mustFlip || viewport.rotation % 180 === 0) {\n      style.width = widthStr;\n      style.height = heightStr;\n    } else {\n      style.width = heightStr;\n      style.height = widthStr;\n    }\n  }\n\n  if (mustRotate) {\n    div.setAttribute(\"data-main-rotation\", viewport.rotation);\n  }\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/toolbar.js\n\nclass EditorToolbar {\n  #toolbar = null;\n  #colorPicker = null;\n  #editor;\n  #buttons = null;\n  #altText = null;\n  static #l10nRemove = null;\n\n  constructor(editor) {\n    this.#editor = editor;\n    EditorToolbar.#l10nRemove ||= Object.freeze({\n      freetext: \"pdfjs-editor-remove-freetext-button\",\n      highlight: \"pdfjs-editor-remove-highlight-button\",\n      ink: \"pdfjs-editor-remove-ink-button\",\n      stamp: \"pdfjs-editor-remove-stamp-button\"\n    });\n  }\n\n  render() {\n    const editToolbar = this.#toolbar = document.createElement(\"div\");\n    editToolbar.className = \"editToolbar\";\n    editToolbar.setAttribute(\"role\", \"toolbar\");\n    const signal = this.#editor._uiManager._signal;\n    editToolbar.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    editToolbar.addEventListener(\"pointerdown\", EditorToolbar.#pointerDown, {\n      signal\n    });\n    const buttons = this.#buttons = document.createElement(\"div\");\n    buttons.className = \"buttons\";\n    editToolbar.append(buttons);\n    const position = this.#editor.toolbarPosition;\n\n    if (position) {\n      const {\n        style\n      } = editToolbar;\n      const x = this.#editor._uiManager.direction === \"ltr\" ? 1 - position[0] : position[0];\n      style.insetInlineEnd = `${100 * x}%`;\n      style.top = `calc(${100 * position[1]}% + var(--editor-toolbar-vert-offset))`;\n    }\n\n    this.#addDeleteButton();\n    return editToolbar;\n  }\n\n  static #pointerDown(e) {\n    e.stopPropagation();\n  }\n\n  #focusIn(e) {\n    this.#editor._focusEventsAllowed = false;\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  #focusOut(e) {\n    this.#editor._focusEventsAllowed = true;\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  #addListenersToElement(element) {\n    const signal = this.#editor._uiManager._signal;\n    element.addEventListener(\"focusin\", this.#focusIn.bind(this), {\n      capture: true,\n      signal\n    });\n    element.addEventListener(\"focusout\", this.#focusOut.bind(this), {\n      capture: true,\n      signal\n    });\n    element.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n  }\n\n  hide() {\n    this.#toolbar.classList.add(\"hidden\");\n    this.#colorPicker?.hideDropdown();\n  }\n\n  show() {\n    this.#toolbar.classList.remove(\"hidden\");\n    this.#altText?.shown();\n  }\n\n  #addDeleteButton() {\n    const {\n      editorType,\n      _uiManager\n    } = this.#editor;\n    const button = document.createElement(\"button\");\n    button.className = \"delete\";\n    button.tabIndex = 0;\n    button.setAttribute(\"data-l10n-id\", EditorToolbar.#l10nRemove[editorType]);\n    this.#addListenersToElement(button);\n    button.addEventListener(\"click\", e => {\n      _uiManager.delete();\n    }, {\n      signal: _uiManager._signal\n    });\n    this.#buttons.append(button);\n  }\n\n  get #divider() {\n    const divider = document.createElement(\"div\");\n    divider.className = \"divider\";\n    return divider;\n  }\n\n  addAltText(altText) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      const button = yield altText.render();\n\n      _this3.#addListenersToElement(button);\n\n      _this3.#buttons.prepend(button, _this3.#divider);\n\n      _this3.#altText = altText;\n    })();\n  }\n\n  addColorPicker(colorPicker) {\n    this.#colorPicker = colorPicker;\n    const button = colorPicker.renderButton();\n    this.#addListenersToElement(button);\n    this.#buttons.prepend(button, this.#divider);\n  }\n\n  remove() {\n    this.#toolbar.remove();\n    this.#colorPicker?.destroy();\n    this.#colorPicker = null;\n  }\n\n}\n\nclass HighlightToolbar {\n  #buttons = null;\n  #toolbar = null;\n  #uiManager;\n\n  constructor(uiManager) {\n    this.#uiManager = uiManager;\n  }\n\n  #render() {\n    const editToolbar = this.#toolbar = document.createElement(\"div\");\n    editToolbar.className = \"editToolbar\";\n    editToolbar.setAttribute(\"role\", \"toolbar\");\n    editToolbar.addEventListener(\"contextmenu\", noContextMenu, {\n      signal: this.#uiManager._signal\n    });\n    const buttons = this.#buttons = document.createElement(\"div\");\n    buttons.className = \"buttons\";\n    editToolbar.append(buttons);\n    this.#addHighlightButton();\n    return editToolbar;\n  }\n\n  #getLastPoint(boxes, isLTR) {\n    let lastY = 0;\n    let lastX = 0;\n\n    for (const box of boxes) {\n      const y = box.y + box.height;\n\n      if (y < lastY) {\n        continue;\n      }\n\n      const x = box.x + (isLTR ? box.width : 0);\n\n      if (y > lastY) {\n        lastX = x;\n        lastY = y;\n        continue;\n      }\n\n      if (isLTR) {\n        if (x > lastX) {\n          lastX = x;\n        }\n      } else if (x < lastX) {\n        lastX = x;\n      }\n    }\n\n    return [isLTR ? 1 - lastX : lastX, lastY];\n  }\n\n  show(parent, boxes, isLTR) {\n    const [x, y] = this.#getLastPoint(boxes, isLTR);\n    const {\n      style\n    } = this.#toolbar ||= this.#render();\n    parent.append(this.#toolbar);\n    style.insetInlineEnd = `${100 * x}%`;\n    style.top = `calc(${100 * y}% + var(--editor-toolbar-vert-offset))`;\n  }\n\n  hide() {\n    this.#toolbar.remove();\n  }\n\n  #addHighlightButton() {\n    const button = document.createElement(\"button\");\n    button.className = \"highlightButton\";\n    button.tabIndex = 0;\n    button.setAttribute(\"data-l10n-id\", `pdfjs-highlight-floating-button1`);\n    const span = document.createElement(\"span\");\n    button.append(span);\n    span.className = \"visuallyHidden\";\n    span.setAttribute(\"data-l10n-id\", \"pdfjs-highlight-floating-button-label\");\n    const signal = this.#uiManager._signal;\n    button.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    button.addEventListener(\"click\", () => {\n      this.#uiManager.highlightSelection(\"floating_button\");\n    }, {\n      signal\n    });\n    this.#buttons.append(button);\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/tools.js\n\nfunction bindEvents(obj, element, names) {\n  for (const name of names) {\n    element.addEventListener(name, obj[name].bind(obj));\n  }\n}\n\nfunction opacityToHex(opacity) {\n  return Math.round(Math.min(255, Math.max(1, 255 * opacity))).toString(16).padStart(2, \"0\");\n}\n\nclass IdManager {\n  #id = 0;\n\n  get id() {\n    return `${AnnotationEditorPrefix}${this.#id++}`;\n  }\n\n}\n\nclass ImageManager {\n  #baseId = getUuid();\n  #id = 0;\n  #cache = null;\n\n  static get _isSVGFittingCanvas() {\n    const svg = `data:image/svg+xml;charset=UTF-8,<svg viewBox=\"0 0 1 1\" width=\"1\" height=\"1\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"1\" height=\"1\" style=\"fill:red;\"/></svg>`;\n    const canvas = new OffscreenCanvas(1, 3);\n    const ctx = canvas.getContext(\"2d\", {\n      willReadFrequently: true\n    });\n    const image = new Image();\n    image.src = svg;\n    const promise = image.decode().then(() => {\n      ctx.drawImage(image, 0, 0, 1, 1, 0, 0, 1, 3);\n      return new Uint32Array(ctx.getImageData(0, 0, 1, 1).data.buffer)[0] === 0;\n    });\n    return shadow(this, \"_isSVGFittingCanvas\", promise);\n  }\n\n  #get(key, rawData) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      _this4.#cache ||= new Map();\n\n      let data = _this4.#cache.get(key);\n\n      if (data === null) {\n        return null;\n      }\n\n      if (data?.bitmap) {\n        data.refCounter += 1;\n        return data;\n      }\n\n      try {\n        data ||= {\n          bitmap: null,\n          id: `image_${_this4.#baseId}_${_this4.#id++}`,\n          refCounter: 0,\n          isSvg: false\n        };\n        let image;\n\n        if (typeof rawData === \"string\") {\n          data.url = rawData;\n          image = yield fetchData(rawData, \"blob\");\n        } else {\n          image = data.file = rawData;\n        }\n\n        if (image.type === \"image/svg+xml\") {\n          const mustRemoveAspectRatioPromise = ImageManager._isSVGFittingCanvas;\n          const fileReader = new FileReader();\n          const imageElement = new Image();\n          const imagePromise = new Promise((resolve, reject) => {\n            imageElement.onload = () => {\n              data.bitmap = imageElement;\n              data.isSvg = true;\n              resolve();\n            };\n\n            fileReader.onload = /*#__PURE__*/_asyncToGenerator(function* () {\n              const url = data.svgUrl = fileReader.result;\n              imageElement.src = (yield mustRemoveAspectRatioPromise) ? `${url}#svgView(preserveAspectRatio(none))` : url;\n            });\n            imageElement.onerror = fileReader.onerror = reject;\n          });\n          fileReader.readAsDataURL(image);\n          yield imagePromise;\n        } else {\n          data.bitmap = yield createImageBitmap(image);\n        }\n\n        data.refCounter = 1;\n      } catch (e) {\n        console.error(e);\n        data = null;\n      }\n\n      _this4.#cache.set(key, data);\n\n      if (data) {\n        _this4.#cache.set(data.id, data);\n      }\n\n      return data;\n    })();\n  }\n\n  getFromFile(file) {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        lastModified,\n        name,\n        size,\n        type\n      } = file;\n      return _this5.#get(`${lastModified}_${name}_${size}_${type}`, file);\n    })();\n  }\n\n  getFromUrl(url) {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      return _this6.#get(url, url);\n    })();\n  }\n\n  getFromId(id) {\n    var _this7 = this;\n\n    return _asyncToGenerator(function* () {\n      _this7.#cache ||= new Map();\n\n      const data = _this7.#cache.get(id);\n\n      if (!data) {\n        return null;\n      }\n\n      if (data.bitmap) {\n        data.refCounter += 1;\n        return data;\n      }\n\n      if (data.file) {\n        return _this7.getFromFile(data.file);\n      }\n\n      return _this7.getFromUrl(data.url);\n    })();\n  }\n\n  getSvgUrl(id) {\n    const data = this.#cache.get(id);\n\n    if (!data?.isSvg) {\n      return null;\n    }\n\n    return data.svgUrl;\n  }\n\n  deleteId(id) {\n    this.#cache ||= new Map();\n    const data = this.#cache.get(id);\n\n    if (!data) {\n      return;\n    }\n\n    data.refCounter -= 1;\n\n    if (data.refCounter !== 0) {\n      return;\n    }\n\n    data.bitmap = null;\n  }\n\n  isValidId(id) {\n    return id.startsWith(`image_${this.#baseId}_`);\n  }\n\n}\n\nclass CommandManager {\n  #commands = [];\n  #locked = false;\n  #maxSize;\n  #position = -1;\n\n  constructor(maxSize = 128) {\n    this.#maxSize = maxSize;\n  }\n\n  add({\n    cmd,\n    undo,\n    post,\n    mustExec,\n    type = NaN,\n    overwriteIfSameType = false,\n    keepUndo = false\n  }) {\n    if (mustExec) {\n      cmd();\n    }\n\n    if (this.#locked) {\n      return;\n    }\n\n    const save = {\n      cmd,\n      undo,\n      post,\n      type\n    };\n\n    if (this.#position === -1) {\n      if (this.#commands.length > 0) {\n        this.#commands.length = 0;\n      }\n\n      this.#position = 0;\n      this.#commands.push(save);\n      return;\n    }\n\n    if (overwriteIfSameType && this.#commands[this.#position].type === type) {\n      if (keepUndo) {\n        save.undo = this.#commands[this.#position].undo;\n      }\n\n      this.#commands[this.#position] = save;\n      return;\n    }\n\n    const next = this.#position + 1;\n\n    if (next === this.#maxSize) {\n      this.#commands.splice(0, 1);\n    } else {\n      this.#position = next;\n\n      if (next < this.#commands.length) {\n        this.#commands.splice(next);\n      }\n    }\n\n    this.#commands.push(save);\n  }\n\n  undo() {\n    if (this.#position === -1) {\n      return;\n    }\n\n    this.#locked = true;\n    const {\n      undo,\n      post\n    } = this.#commands[this.#position];\n    undo();\n    post?.();\n    this.#locked = false;\n    this.#position -= 1;\n  }\n\n  redo() {\n    if (this.#position < this.#commands.length - 1) {\n      this.#position += 1;\n      this.#locked = true;\n      const {\n        cmd,\n        post\n      } = this.#commands[this.#position];\n      cmd();\n      post?.();\n      this.#locked = false;\n    }\n  }\n\n  hasSomethingToUndo() {\n    return this.#position !== -1;\n  }\n\n  hasSomethingToRedo() {\n    return this.#position < this.#commands.length - 1;\n  }\n\n  destroy() {\n    this.#commands = null;\n  }\n\n}\n\nclass KeyboardManager {\n  constructor(callbacks) {\n    this.buffer = [];\n    this.callbacks = new Map();\n    this.allKeys = new Set();\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n\n    for (const [keys, callback, options = {}] of callbacks) {\n      for (const key of keys) {\n        const isMacKey = key.startsWith(\"mac+\");\n\n        if (isMac && isMacKey) {\n          this.callbacks.set(key.slice(4), {\n            callback,\n            options\n          });\n          this.allKeys.add(key.split(\"+\").at(-1));\n        } else if (!isMac && !isMacKey) {\n          this.callbacks.set(key, {\n            callback,\n            options\n          });\n          this.allKeys.add(key.split(\"+\").at(-1));\n        }\n      }\n    }\n  }\n\n  #serialize(event) {\n    if (event.altKey) {\n      this.buffer.push(\"alt\");\n    }\n\n    if (event.ctrlKey) {\n      this.buffer.push(\"ctrl\");\n    }\n\n    if (event.metaKey) {\n      this.buffer.push(\"meta\");\n    }\n\n    if (event.shiftKey) {\n      this.buffer.push(\"shift\");\n    }\n\n    this.buffer.push(event.key);\n    const str = this.buffer.join(\"+\");\n    this.buffer.length = 0;\n    return str;\n  }\n\n  exec(self, event) {\n    if (!this.allKeys.has(event.key)) {\n      return;\n    }\n\n    const info = this.callbacks.get(this.#serialize(event));\n\n    if (!info) {\n      return;\n    }\n\n    const {\n      callback,\n      options: {\n        bubbles = false,\n        args = [],\n        checker = null\n      }\n    } = info;\n\n    if (checker && !checker(self, event)) {\n      return;\n    }\n\n    callback.bind(self, ...args, event)();\n\n    if (!bubbles) {\n      event.stopPropagation();\n      event.preventDefault();\n    }\n  }\n\n}\n\nclass ColorManager {\n  static _colorsMapping = new Map([[\"CanvasText\", [0, 0, 0]], [\"Canvas\", [255, 255, 255]]]);\n\n  get _colors() {\n    const colors = new Map([[\"CanvasText\", null], [\"Canvas\", null]]);\n    getColorValues(colors);\n    return shadow(this, \"_colors\", colors);\n  }\n\n  convert(color) {\n    const rgb = getRGB(color);\n\n    if (!window.matchMedia(\"(forced-colors: active)\").matches) {\n      return rgb;\n    }\n\n    for (const [name, RGB] of this._colors) {\n      if (RGB.every((x, i) => x === rgb[i])) {\n        return ColorManager._colorsMapping.get(name);\n      }\n    }\n\n    return rgb;\n  }\n\n  getHexCode(name) {\n    const rgb = this._colors.get(name);\n\n    if (!rgb) {\n      return name;\n    }\n\n    return Util.makeHexColor(...rgb);\n  }\n\n}\n\nclass AnnotationEditorUIManager {\n  #abortController = new AbortController();\n  #activeEditor = null;\n  #allEditors = new Map();\n  #allLayers = new Map();\n  #altTextManager = null;\n  #annotationStorage = null;\n  #changedExistingAnnotations = null;\n  #commandManager = new CommandManager();\n  #copyPasteAC = null;\n  #currentPageIndex = 0;\n  #deletedAnnotationsElementIds = new Set();\n  #draggingEditors = null;\n  #editorTypes = null;\n  #editorsToRescale = new Set();\n  #enableHighlightFloatingButton = false;\n  #enableUpdatedAddImage = false;\n  #enableNewAltTextWhenAddingImage = false;\n  #filterFactory = null;\n  #focusMainContainerTimeoutId = null;\n  #focusManagerAC = null;\n  #highlightColors = null;\n  #highlightWhenShiftUp = false;\n  #highlightToolbar = null;\n  #idManager = new IdManager();\n  #isEnabled = false;\n  #isWaiting = false;\n  #keyboardManagerAC = null;\n  #lastActiveElement = null;\n  #mainHighlightColorPicker = null;\n  #mlManager = null;\n  #mode = AnnotationEditorType.NONE;\n  #selectedEditors = new Set();\n  #selectedTextNode = null;\n  #pageColors = null;\n  #showAllStates = null;\n  #previousStates = {\n    isEditing: false,\n    isEmpty: true,\n    hasSomethingToUndo: false,\n    hasSomethingToRedo: false,\n    hasSelectedEditor: false,\n    hasSelectedText: false\n  };\n  #translation = [0, 0];\n  #translationTimeoutId = null;\n  #container = null;\n  #viewer = null;\n  static TRANSLATE_SMALL = 1;\n  static TRANSLATE_BIG = 10;\n\n  static get _keyboardManager() {\n    const proto = AnnotationEditorUIManager.prototype;\n\n    const arrowChecker = self => self.#container.contains(document.activeElement) && document.activeElement.tagName !== \"BUTTON\" && self.hasSomethingToControl();\n\n    const textInputChecker = (_self, {\n      target: el\n    }) => {\n      if (el instanceof HTMLInputElement) {\n        const {\n          type\n        } = el;\n        return type !== \"text\" && type !== \"number\";\n      }\n\n      return true;\n    };\n\n    const small = this.TRANSLATE_SMALL;\n    const big = this.TRANSLATE_BIG;\n    return shadow(this, \"_keyboardManager\", new KeyboardManager([[[\"ctrl+a\", \"mac+meta+a\"], proto.selectAll, {\n      checker: textInputChecker\n    }], [[\"ctrl+z\", \"mac+meta+z\"], proto.undo, {\n      checker: textInputChecker\n    }], [[\"ctrl+y\", \"ctrl+shift+z\", \"mac+meta+shift+z\", \"ctrl+shift+Z\", \"mac+meta+shift+Z\"], proto.redo, {\n      checker: textInputChecker\n    }], [[\"Backspace\", \"alt+Backspace\", \"ctrl+Backspace\", \"shift+Backspace\", \"mac+Backspace\", \"mac+alt+Backspace\", \"mac+ctrl+Backspace\", \"Delete\", \"ctrl+Delete\", \"shift+Delete\", \"mac+Delete\"], proto.delete, {\n      checker: textInputChecker\n    }], [[\"Enter\", \"mac+Enter\"], proto.addNewEditorFromKeyboard, {\n      checker: (self, {\n        target: el\n      }) => !(el instanceof HTMLButtonElement) && self.#container.contains(el) && !self.isEnterHandled\n    }], [[\" \", \"mac+ \"], proto.addNewEditorFromKeyboard, {\n      checker: (self, {\n        target: el\n      }) => !(el instanceof HTMLButtonElement) && self.#container.contains(document.activeElement)\n    }], [[\"Escape\", \"mac+Escape\"], proto.unselectAll], [[\"ArrowLeft\", \"mac+ArrowLeft\"], proto.translateSelectedEditors, {\n      args: [-small, 0],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"], proto.translateSelectedEditors, {\n      args: [-big, 0],\n      checker: arrowChecker\n    }], [[\"ArrowRight\", \"mac+ArrowRight\"], proto.translateSelectedEditors, {\n      args: [small, 0],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"], proto.translateSelectedEditors, {\n      args: [big, 0],\n      checker: arrowChecker\n    }], [[\"ArrowUp\", \"mac+ArrowUp\"], proto.translateSelectedEditors, {\n      args: [0, -small],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], proto.translateSelectedEditors, {\n      args: [0, -big],\n      checker: arrowChecker\n    }], [[\"ArrowDown\", \"mac+ArrowDown\"], proto.translateSelectedEditors, {\n      args: [0, small],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], proto.translateSelectedEditors, {\n      args: [0, big],\n      checker: arrowChecker\n    }]]));\n  }\n\n  constructor(container, viewer, altTextManager, eventBus, pdfDocument, pageColors, highlightColors, enableHighlightFloatingButton, enableUpdatedAddImage, enableNewAltTextWhenAddingImage, mlManager) {\n    const signal = this._signal = this.#abortController.signal;\n    this.#container = container;\n    this.#viewer = viewer;\n    this.#altTextManager = altTextManager;\n    this._eventBus = eventBus;\n\n    eventBus._on(\"editingaction\", this.onEditingAction.bind(this), {\n      signal\n    });\n\n    eventBus._on(\"pagechanging\", this.onPageChanging.bind(this), {\n      signal\n    });\n\n    eventBus._on(\"scalechanging\", this.onScaleChanging.bind(this), {\n      signal\n    });\n\n    eventBus._on(\"rotationchanging\", this.onRotationChanging.bind(this), {\n      signal\n    });\n\n    eventBus._on(\"setpreference\", this.onSetPreference.bind(this), {\n      signal\n    });\n\n    eventBus._on(\"switchannotationeditorparams\", evt => this.updateParams(evt.type, evt.value), {\n      signal\n    });\n\n    this.#addSelectionListener();\n    this.#addDragAndDropListeners();\n    this.#addKeyboardManager();\n    this.#annotationStorage = pdfDocument.annotationStorage;\n    this.#filterFactory = pdfDocument.filterFactory;\n    this.#pageColors = pageColors;\n    this.#highlightColors = highlightColors || null;\n    this.#enableHighlightFloatingButton = enableHighlightFloatingButton;\n    this.#enableUpdatedAddImage = enableUpdatedAddImage;\n    this.#enableNewAltTextWhenAddingImage = enableNewAltTextWhenAddingImage;\n    this.#mlManager = mlManager || null;\n    this.viewParameters = {\n      realScale: PixelsPerInch.PDF_TO_CSS_UNITS,\n      rotation: 0\n    };\n    this.isShiftKeyDown = false;\n  }\n\n  destroy() {\n    this.#abortController?.abort();\n    this.#abortController = null;\n    this._signal = null;\n\n    for (const layer of this.#allLayers.values()) {\n      layer.destroy();\n    }\n\n    this.#allLayers.clear();\n    this.#allEditors.clear();\n    this.#editorsToRescale.clear();\n    this.#activeEditor = null;\n    this.#selectedEditors.clear();\n    this.#commandManager.destroy();\n    this.#altTextManager?.destroy();\n    this.#highlightToolbar?.hide();\n    this.#highlightToolbar = null;\n\n    if (this.#focusMainContainerTimeoutId) {\n      clearTimeout(this.#focusMainContainerTimeoutId);\n      this.#focusMainContainerTimeoutId = null;\n    }\n\n    if (this.#translationTimeoutId) {\n      clearTimeout(this.#translationTimeoutId);\n      this.#translationTimeoutId = null;\n    }\n  }\n\n  combinedSignal(ac) {\n    return AbortSignal.any([this._signal, ac.signal]);\n  }\n\n  get mlManager() {\n    return this.#mlManager;\n  }\n\n  get useNewAltTextFlow() {\n    return this.#enableUpdatedAddImage;\n  }\n\n  get useNewAltTextWhenAddingImage() {\n    return this.#enableNewAltTextWhenAddingImage;\n  }\n\n  get hcmFilter() {\n    return shadow(this, \"hcmFilter\", this.#pageColors ? this.#filterFactory.addHCMFilter(this.#pageColors.foreground, this.#pageColors.background) : \"none\");\n  }\n\n  get direction() {\n    return shadow(this, \"direction\", getComputedStyle(this.#container).direction);\n  }\n\n  get highlightColors() {\n    return shadow(this, \"highlightColors\", this.#highlightColors ? new Map(this.#highlightColors.split(\",\").map(pair => pair.split(\"=\").map(x => x.trim()))) : null);\n  }\n\n  get highlightColorNames() {\n    return shadow(this, \"highlightColorNames\", this.highlightColors ? new Map(Array.from(this.highlightColors, e => e.reverse())) : null);\n  }\n\n  setMainHighlightColorPicker(colorPicker) {\n    this.#mainHighlightColorPicker = colorPicker;\n  }\n\n  editAltText(editor, firstTime = false) {\n    this.#altTextManager?.editAltText(this, editor, firstTime);\n  }\n\n  switchToMode(mode, callback) {\n    this._eventBus.on(\"annotationeditormodechanged\", callback, {\n      once: true,\n      signal: this._signal\n    });\n\n    this._eventBus.dispatch(\"showannotationeditorui\", {\n      source: this,\n      mode\n    });\n  }\n\n  setPreference(name, value) {\n    this._eventBus.dispatch(\"setpreference\", {\n      source: this,\n      name,\n      value\n    });\n  }\n\n  onSetPreference({\n    name,\n    value\n  }) {\n    switch (name) {\n      case \"enableNewAltTextWhenAddingImage\":\n        this.#enableNewAltTextWhenAddingImage = value;\n        break;\n    }\n  }\n\n  onPageChanging({\n    pageNumber\n  }) {\n    this.#currentPageIndex = pageNumber - 1;\n  }\n\n  focusMainContainer() {\n    this.#container.focus();\n  }\n\n  findParent(x, y) {\n    for (const layer of this.#allLayers.values()) {\n      const {\n        x: layerX,\n        y: layerY,\n        width,\n        height\n      } = layer.div.getBoundingClientRect();\n\n      if (x >= layerX && x <= layerX + width && y >= layerY && y <= layerY + height) {\n        return layer;\n      }\n    }\n\n    return null;\n  }\n\n  disableUserSelect(value = false) {\n    this.#viewer.classList.toggle(\"noUserSelect\", value);\n  }\n\n  addShouldRescale(editor) {\n    this.#editorsToRescale.add(editor);\n  }\n\n  removeShouldRescale(editor) {\n    this.#editorsToRescale.delete(editor);\n  }\n\n  onScaleChanging({\n    scale\n  }) {\n    this.commitOrRemove();\n    this.viewParameters.realScale = scale * PixelsPerInch.PDF_TO_CSS_UNITS;\n\n    for (const editor of this.#editorsToRescale) {\n      editor.onScaleChanging();\n    }\n  }\n\n  onRotationChanging({\n    pagesRotation\n  }) {\n    this.commitOrRemove();\n    this.viewParameters.rotation = pagesRotation;\n  }\n\n  #getAnchorElementForSelection({\n    anchorNode\n  }) {\n    return anchorNode.nodeType === Node.TEXT_NODE ? anchorNode.parentElement : anchorNode;\n  }\n\n  #getLayerForTextLayer(textLayer) {\n    const {\n      currentLayer\n    } = this;\n\n    if (currentLayer.hasTextLayer(textLayer)) {\n      return currentLayer;\n    }\n\n    for (const layer of this.#allLayers.values()) {\n      if (layer.hasTextLayer(textLayer)) {\n        return layer;\n      }\n    }\n\n    return null;\n  }\n\n  highlightSelection(methodOfCreation = \"\") {\n    const selection = document.getSelection();\n\n    if (!selection || selection.isCollapsed) {\n      return;\n    }\n\n    const {\n      anchorNode,\n      anchorOffset,\n      focusNode,\n      focusOffset\n    } = selection;\n    const text = selection.toString();\n    const anchorElement = this.#getAnchorElementForSelection(selection);\n    const textLayer = anchorElement.closest(\".textLayer\");\n    const boxes = this.getSelectionBoxes(textLayer);\n\n    if (!boxes) {\n      return;\n    }\n\n    selection.empty();\n    const layer = this.#getLayerForTextLayer(textLayer);\n    const isNoneMode = this.#mode === AnnotationEditorType.NONE;\n\n    const callback = () => {\n      layer?.createAndAddNewEditor({\n        x: 0,\n        y: 0\n      }, false, {\n        methodOfCreation,\n        boxes,\n        anchorNode,\n        anchorOffset,\n        focusNode,\n        focusOffset,\n        text\n      });\n\n      if (isNoneMode) {\n        this.showAllEditors(\"highlight\", true, true);\n      }\n    };\n\n    if (isNoneMode) {\n      this.switchToMode(AnnotationEditorType.HIGHLIGHT, callback);\n      return;\n    }\n\n    callback();\n  }\n\n  #displayHighlightToolbar() {\n    const selection = document.getSelection();\n\n    if (!selection || selection.isCollapsed) {\n      return;\n    }\n\n    const anchorElement = this.#getAnchorElementForSelection(selection);\n    const textLayer = anchorElement.closest(\".textLayer\");\n    const boxes = this.getSelectionBoxes(textLayer);\n\n    if (!boxes) {\n      return;\n    }\n\n    this.#highlightToolbar ||= new HighlightToolbar(this);\n    this.#highlightToolbar.show(textLayer, boxes, this.direction === \"ltr\");\n  }\n\n  addToAnnotationStorage(editor) {\n    if (!editor.isEmpty() && this.#annotationStorage && !this.#annotationStorage.has(editor.id)) {\n      this.#annotationStorage.setValue(editor.id, editor);\n    }\n  }\n\n  #selectionChange() {\n    const selection = document.getSelection();\n\n    if (!selection || selection.isCollapsed) {\n      if (this.#selectedTextNode) {\n        this.#highlightToolbar?.hide();\n        this.#selectedTextNode = null;\n        this.#dispatchUpdateStates({\n          hasSelectedText: false\n        });\n      }\n\n      return;\n    }\n\n    const {\n      anchorNode\n    } = selection;\n\n    if (anchorNode === this.#selectedTextNode) {\n      return;\n    }\n\n    const anchorElement = this.#getAnchorElementForSelection(selection);\n    const textLayer = anchorElement.closest(\".textLayer\");\n\n    if (!textLayer) {\n      if (this.#selectedTextNode) {\n        this.#highlightToolbar?.hide();\n        this.#selectedTextNode = null;\n        this.#dispatchUpdateStates({\n          hasSelectedText: false\n        });\n      }\n\n      return;\n    }\n\n    this.#highlightToolbar?.hide();\n    this.#selectedTextNode = anchorNode;\n    this.#dispatchUpdateStates({\n      hasSelectedText: true\n    });\n\n    if (this.#mode !== AnnotationEditorType.HIGHLIGHT && this.#mode !== AnnotationEditorType.NONE) {\n      return;\n    }\n\n    if (this.#mode === AnnotationEditorType.HIGHLIGHT) {\n      this.showAllEditors(\"highlight\", true, true);\n    }\n\n    this.#highlightWhenShiftUp = this.isShiftKeyDown;\n\n    if (!this.isShiftKeyDown) {\n      const activeLayer = this.#mode === AnnotationEditorType.HIGHLIGHT ? this.#getLayerForTextLayer(textLayer) : null;\n      activeLayer?.toggleDrawing();\n      const ac = new AbortController();\n      const signal = this.combinedSignal(ac);\n\n      const pointerup = e => {\n        if (e.type === \"pointerup\" && e.button !== 0) {\n          return;\n        }\n\n        ac.abort();\n        activeLayer?.toggleDrawing(true);\n\n        if (e.type === \"pointerup\") {\n          this.#onSelectEnd(\"main_toolbar\");\n        }\n      };\n\n      window.addEventListener(\"pointerup\", pointerup, {\n        signal\n      });\n      window.addEventListener(\"blur\", pointerup, {\n        signal\n      });\n    }\n  }\n\n  #onSelectEnd(methodOfCreation = \"\") {\n    if (this.#mode === AnnotationEditorType.HIGHLIGHT) {\n      this.highlightSelection(methodOfCreation);\n    } else if (this.#enableHighlightFloatingButton) {\n      this.#displayHighlightToolbar();\n    }\n  }\n\n  #addSelectionListener() {\n    document.addEventListener(\"selectionchange\", this.#selectionChange.bind(this), {\n      signal: this._signal\n    });\n  }\n\n  #addFocusManager() {\n    if (this.#focusManagerAC) {\n      return;\n    }\n\n    this.#focusManagerAC = new AbortController();\n    const signal = this.combinedSignal(this.#focusManagerAC);\n    window.addEventListener(\"focus\", this.focus.bind(this), {\n      signal\n    });\n    window.addEventListener(\"blur\", this.blur.bind(this), {\n      signal\n    });\n  }\n\n  #removeFocusManager() {\n    this.#focusManagerAC?.abort();\n    this.#focusManagerAC = null;\n  }\n\n  blur() {\n    this.isShiftKeyDown = false;\n\n    if (this.#highlightWhenShiftUp) {\n      this.#highlightWhenShiftUp = false;\n      this.#onSelectEnd(\"main_toolbar\");\n    }\n\n    if (!this.hasSelection) {\n      return;\n    }\n\n    const {\n      activeElement\n    } = document;\n\n    for (const editor of this.#selectedEditors) {\n      if (editor.div.contains(activeElement)) {\n        this.#lastActiveElement = [editor, activeElement];\n        editor._focusEventsAllowed = false;\n        break;\n      }\n    }\n  }\n\n  focus() {\n    if (!this.#lastActiveElement) {\n      return;\n    }\n\n    const [lastEditor, lastActiveElement] = this.#lastActiveElement;\n    this.#lastActiveElement = null;\n    lastActiveElement.addEventListener(\"focusin\", () => {\n      lastEditor._focusEventsAllowed = true;\n    }, {\n      once: true,\n      signal: this._signal\n    });\n    lastActiveElement.focus();\n  }\n\n  #addKeyboardManager() {\n    if (this.#keyboardManagerAC) {\n      return;\n    }\n\n    this.#keyboardManagerAC = new AbortController();\n    const signal = this.combinedSignal(this.#keyboardManagerAC);\n    window.addEventListener(\"keydown\", this.keydown.bind(this), {\n      signal\n    });\n    window.addEventListener(\"keyup\", this.keyup.bind(this), {\n      signal\n    });\n  }\n\n  #removeKeyboardManager() {\n    this.#keyboardManagerAC?.abort();\n    this.#keyboardManagerAC = null;\n  }\n\n  #addCopyPasteListeners() {\n    if (this.#copyPasteAC) {\n      return;\n    }\n\n    this.#copyPasteAC = new AbortController();\n    const signal = this.combinedSignal(this.#copyPasteAC);\n    document.addEventListener(\"copy\", this.copy.bind(this), {\n      signal\n    });\n    document.addEventListener(\"cut\", this.cut.bind(this), {\n      signal\n    });\n    document.addEventListener(\"paste\", this.paste.bind(this), {\n      signal\n    });\n  }\n\n  #removeCopyPasteListeners() {\n    this.#copyPasteAC?.abort();\n    this.#copyPasteAC = null;\n  }\n\n  #addDragAndDropListeners() {\n    const signal = this._signal;\n    document.addEventListener(\"dragover\", this.dragOver.bind(this), {\n      signal\n    });\n    document.addEventListener(\"drop\", this.drop.bind(this), {\n      signal\n    });\n  }\n\n  addEditListeners() {\n    this.#addKeyboardManager();\n    this.#addCopyPasteListeners();\n  }\n\n  removeEditListeners() {\n    this.#removeKeyboardManager();\n    this.#removeCopyPasteListeners();\n  }\n\n  dragOver(event) {\n    for (const {\n      type\n    } of event.dataTransfer.items) {\n      for (const editorType of this.#editorTypes) {\n        if (editorType.isHandlingMimeForPasting(type)) {\n          event.dataTransfer.dropEffect = \"copy\";\n          event.preventDefault();\n          return;\n        }\n      }\n    }\n  }\n\n  drop(event) {\n    for (const item of event.dataTransfer.items) {\n      for (const editorType of this.#editorTypes) {\n        if (editorType.isHandlingMimeForPasting(item.type)) {\n          editorType.paste(item, this.currentLayer);\n          event.preventDefault();\n          return;\n        }\n      }\n    }\n  }\n\n  copy(event) {\n    event.preventDefault();\n    this.#activeEditor?.commitOrRemove();\n\n    if (!this.hasSelection) {\n      return;\n    }\n\n    const editors = [];\n\n    for (const editor of this.#selectedEditors) {\n      const serialized = editor.serialize(true);\n\n      if (serialized) {\n        editors.push(serialized);\n      }\n    }\n\n    if (editors.length === 0) {\n      return;\n    }\n\n    event.clipboardData.setData(\"application/pdfjs\", JSON.stringify(editors));\n  }\n\n  cut(event) {\n    this.copy(event);\n    this.delete();\n  }\n\n  paste(event) {\n    event.preventDefault();\n    const {\n      clipboardData\n    } = event;\n\n    for (const item of clipboardData.items) {\n      for (const editorType of this.#editorTypes) {\n        if (editorType.isHandlingMimeForPasting(item.type)) {\n          editorType.paste(item, this.currentLayer);\n          return;\n        }\n      }\n    }\n\n    let data = clipboardData.getData(\"application/pdfjs\");\n\n    if (!data) {\n      return;\n    }\n\n    try {\n      data = JSON.parse(data);\n    } catch (ex) {\n      warn(`paste: \"${ex.message}\".`);\n      return;\n    }\n\n    if (!Array.isArray(data)) {\n      return;\n    }\n\n    this.unselectAll();\n    const layer = this.currentLayer;\n\n    try {\n      const newEditors = [];\n\n      for (const editor of data) {\n        const deserializedEditor = layer.deserialize(editor);\n\n        if (!deserializedEditor) {\n          return;\n        }\n\n        newEditors.push(deserializedEditor);\n      }\n\n      const cmd = () => {\n        for (const editor of newEditors) {\n          this.#addEditorToLayer(editor);\n        }\n\n        this.#selectEditors(newEditors);\n      };\n\n      const undo = () => {\n        for (const editor of newEditors) {\n          editor.remove();\n        }\n      };\n\n      this.addCommands({\n        cmd,\n        undo,\n        mustExec: true\n      });\n    } catch (ex) {\n      warn(`paste: \"${ex.message}\".`);\n    }\n  }\n\n  keydown(event) {\n    if (!this.isShiftKeyDown && event.key === \"Shift\") {\n      this.isShiftKeyDown = true;\n    }\n\n    if (this.#mode !== AnnotationEditorType.NONE && !this.isEditorHandlingKeyboard) {\n      AnnotationEditorUIManager._keyboardManager.exec(this, event);\n    }\n  }\n\n  keyup(event) {\n    if (this.isShiftKeyDown && event.key === \"Shift\") {\n      this.isShiftKeyDown = false;\n\n      if (this.#highlightWhenShiftUp) {\n        this.#highlightWhenShiftUp = false;\n        this.#onSelectEnd(\"main_toolbar\");\n      }\n    }\n  }\n\n  onEditingAction({\n    name\n  }) {\n    switch (name) {\n      case \"undo\":\n      case \"redo\":\n      case \"delete\":\n      case \"selectAll\":\n        this[name]();\n        break;\n\n      case \"highlightSelection\":\n        this.highlightSelection(\"context_menu\");\n        break;\n    }\n  }\n\n  #dispatchUpdateStates(details) {\n    const hasChanged = Object.entries(details).some(([key, value]) => this.#previousStates[key] !== value);\n\n    if (hasChanged) {\n      this._eventBus.dispatch(\"annotationeditorstateschanged\", {\n        source: this,\n        details: Object.assign(this.#previousStates, details)\n      });\n\n      if (this.#mode === AnnotationEditorType.HIGHLIGHT && details.hasSelectedEditor === false) {\n        this.#dispatchUpdateUI([[AnnotationEditorParamsType.HIGHLIGHT_FREE, true]]);\n      }\n    }\n  }\n\n  #dispatchUpdateUI(details) {\n    this._eventBus.dispatch(\"annotationeditorparamschanged\", {\n      source: this,\n      details\n    });\n  }\n\n  setEditingState(isEditing) {\n    if (isEditing) {\n      this.#addFocusManager();\n      this.#addCopyPasteListeners();\n      this.#dispatchUpdateStates({\n        isEditing: this.#mode !== AnnotationEditorType.NONE,\n        isEmpty: this.#isEmpty(),\n        hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n        hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n        hasSelectedEditor: false\n      });\n    } else {\n      this.#removeFocusManager();\n      this.#removeCopyPasteListeners();\n      this.#dispatchUpdateStates({\n        isEditing: false\n      });\n      this.disableUserSelect(false);\n    }\n  }\n\n  registerEditorTypes(types) {\n    if (this.#editorTypes) {\n      return;\n    }\n\n    this.#editorTypes = types;\n\n    for (const editorType of this.#editorTypes) {\n      this.#dispatchUpdateUI(editorType.defaultPropertiesToUpdate);\n    }\n  }\n\n  getId() {\n    return this.#idManager.id;\n  }\n\n  get currentLayer() {\n    return this.#allLayers.get(this.#currentPageIndex);\n  }\n\n  getLayer(pageIndex) {\n    return this.#allLayers.get(pageIndex);\n  }\n\n  get currentPageIndex() {\n    return this.#currentPageIndex;\n  }\n\n  addLayer(layer) {\n    this.#allLayers.set(layer.pageIndex, layer);\n\n    if (this.#isEnabled) {\n      layer.enable();\n    } else {\n      layer.disable();\n    }\n  }\n\n  removeLayer(layer) {\n    this.#allLayers.delete(layer.pageIndex);\n  }\n\n  updateMode(mode, editId = null, isFromKeyboard = false) {\n    if (this.#mode === mode) {\n      return;\n    }\n\n    this.#mode = mode;\n\n    if (mode === AnnotationEditorType.NONE) {\n      this.setEditingState(false);\n      this.#disableAll();\n      return;\n    }\n\n    this.setEditingState(true);\n    this.#enableAll();\n    this.unselectAll();\n\n    for (const layer of this.#allLayers.values()) {\n      layer.updateMode(mode);\n    }\n\n    if (!editId && isFromKeyboard) {\n      this.addNewEditorFromKeyboard();\n      return;\n    }\n\n    if (!editId) {\n      return;\n    }\n\n    for (const editor of this.#allEditors.values()) {\n      if (editor.annotationElementId === editId) {\n        this.setSelected(editor);\n        editor.enterInEditMode();\n        break;\n      }\n    }\n  }\n\n  addNewEditorFromKeyboard() {\n    if (this.currentLayer.canCreateNewEmptyEditor()) {\n      this.currentLayer.addNewEditor();\n    }\n  }\n\n  updateToolbar(mode) {\n    if (mode === this.#mode) {\n      return;\n    }\n\n    this._eventBus.dispatch(\"switchannotationeditormode\", {\n      source: this,\n      mode\n    });\n  }\n\n  updateParams(type, value) {\n    if (!this.#editorTypes) {\n      return;\n    }\n\n    switch (type) {\n      case AnnotationEditorParamsType.CREATE:\n        this.currentLayer.addNewEditor();\n        return;\n\n      case AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:\n        this.#mainHighlightColorPicker?.updateColor(value);\n        break;\n\n      case AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:\n        this._eventBus.dispatch(\"reporttelemetry\", {\n          source: this,\n          details: {\n            type: \"editing\",\n            data: {\n              type: \"highlight\",\n              action: \"toggle_visibility\"\n            }\n          }\n        });\n\n        (this.#showAllStates ||= new Map()).set(type, value);\n        this.showAllEditors(\"highlight\", value);\n        break;\n    }\n\n    for (const editor of this.#selectedEditors) {\n      editor.updateParams(type, value);\n    }\n\n    for (const editorType of this.#editorTypes) {\n      editorType.updateDefaultParams(type, value);\n    }\n  }\n\n  showAllEditors(type, visible, updateButton = false) {\n    for (const editor of this.#allEditors.values()) {\n      if (editor.editorType === type) {\n        editor.show(visible);\n      }\n    }\n\n    const state = this.#showAllStates?.get(AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL) ?? true;\n\n    if (state !== visible) {\n      this.#dispatchUpdateUI([[AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL, visible]]);\n    }\n  }\n\n  enableWaiting(mustWait = false) {\n    if (this.#isWaiting === mustWait) {\n      return;\n    }\n\n    this.#isWaiting = mustWait;\n\n    for (const layer of this.#allLayers.values()) {\n      if (mustWait) {\n        layer.disableClick();\n      } else {\n        layer.enableClick();\n      }\n\n      layer.div.classList.toggle(\"waiting\", mustWait);\n    }\n  }\n\n  #enableAll() {\n    if (!this.#isEnabled) {\n      this.#isEnabled = true;\n\n      for (const layer of this.#allLayers.values()) {\n        layer.enable();\n      }\n\n      for (const editor of this.#allEditors.values()) {\n        editor.enable();\n      }\n    }\n  }\n\n  #disableAll() {\n    this.unselectAll();\n\n    if (this.#isEnabled) {\n      this.#isEnabled = false;\n\n      for (const layer of this.#allLayers.values()) {\n        layer.disable();\n      }\n\n      for (const editor of this.#allEditors.values()) {\n        editor.disable();\n      }\n    }\n  }\n\n  getEditors(pageIndex) {\n    const editors = [];\n\n    for (const editor of this.#allEditors.values()) {\n      if (editor.pageIndex === pageIndex) {\n        editors.push(editor);\n      }\n    }\n\n    return editors;\n  }\n\n  getEditor(id) {\n    return this.#allEditors.get(id);\n  }\n\n  addEditor(editor) {\n    this.#allEditors.set(editor.id, editor);\n  }\n\n  removeEditor(editor) {\n    if (editor.div.contains(document.activeElement)) {\n      if (this.#focusMainContainerTimeoutId) {\n        clearTimeout(this.#focusMainContainerTimeoutId);\n      }\n\n      this.#focusMainContainerTimeoutId = setTimeout(() => {\n        this.focusMainContainer();\n        this.#focusMainContainerTimeoutId = null;\n      }, 0);\n    }\n\n    this.#allEditors.delete(editor.id);\n    this.unselect(editor);\n\n    if (!editor.annotationElementId || !this.#deletedAnnotationsElementIds.has(editor.annotationElementId)) {\n      this.#annotationStorage?.remove(editor.id);\n    }\n  }\n\n  addDeletedAnnotationElement(editor) {\n    this.#deletedAnnotationsElementIds.add(editor.annotationElementId);\n    this.addChangedExistingAnnotation(editor);\n    editor.deleted = true;\n  }\n\n  isDeletedAnnotationElement(annotationElementId) {\n    return this.#deletedAnnotationsElementIds.has(annotationElementId);\n  }\n\n  removeDeletedAnnotationElement(editor) {\n    this.#deletedAnnotationsElementIds.delete(editor.annotationElementId);\n    this.removeChangedExistingAnnotation(editor);\n    editor.deleted = false;\n  }\n\n  #addEditorToLayer(editor) {\n    const layer = this.#allLayers.get(editor.pageIndex);\n\n    if (layer) {\n      layer.addOrRebuild(editor);\n    } else {\n      this.addEditor(editor);\n      this.addToAnnotationStorage(editor);\n    }\n  }\n\n  setActiveEditor(editor) {\n    if (this.#activeEditor === editor) {\n      return;\n    }\n\n    this.#activeEditor = editor;\n\n    if (editor) {\n      this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    }\n  }\n\n  get #lastSelectedEditor() {\n    let ed = null;\n\n    for (ed of this.#selectedEditors) {}\n\n    return ed;\n  }\n\n  updateUI(editor) {\n    if (this.#lastSelectedEditor === editor) {\n      this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    }\n  }\n\n  toggleSelected(editor) {\n    if (this.#selectedEditors.has(editor)) {\n      this.#selectedEditors.delete(editor);\n      editor.unselect();\n      this.#dispatchUpdateStates({\n        hasSelectedEditor: this.hasSelection\n      });\n      return;\n    }\n\n    this.#selectedEditors.add(editor);\n    editor.select();\n    this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: true\n    });\n  }\n\n  setSelected(editor) {\n    for (const ed of this.#selectedEditors) {\n      if (ed !== editor) {\n        ed.unselect();\n      }\n    }\n\n    this.#selectedEditors.clear();\n    this.#selectedEditors.add(editor);\n    editor.select();\n    this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: true\n    });\n  }\n\n  isSelected(editor) {\n    return this.#selectedEditors.has(editor);\n  }\n\n  get firstSelectedEditor() {\n    return this.#selectedEditors.values().next().value;\n  }\n\n  unselect(editor) {\n    editor.unselect();\n    this.#selectedEditors.delete(editor);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: this.hasSelection\n    });\n  }\n\n  get hasSelection() {\n    return this.#selectedEditors.size !== 0;\n  }\n\n  get isEnterHandled() {\n    return this.#selectedEditors.size === 1 && this.firstSelectedEditor.isEnterHandled;\n  }\n\n  undo() {\n    this.#commandManager.undo();\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n      hasSomethingToRedo: true,\n      isEmpty: this.#isEmpty()\n    });\n  }\n\n  redo() {\n    this.#commandManager.redo();\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: true,\n      hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n      isEmpty: this.#isEmpty()\n    });\n  }\n\n  addCommands(params) {\n    this.#commandManager.add(params);\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: true,\n      hasSomethingToRedo: false,\n      isEmpty: this.#isEmpty()\n    });\n  }\n\n  #isEmpty() {\n    if (this.#allEditors.size === 0) {\n      return true;\n    }\n\n    if (this.#allEditors.size === 1) {\n      for (const editor of this.#allEditors.values()) {\n        return editor.isEmpty();\n      }\n    }\n\n    return false;\n  }\n\n  delete() {\n    this.commitOrRemove();\n\n    if (!this.hasSelection) {\n      return;\n    }\n\n    const editors = [...this.#selectedEditors];\n\n    const cmd = () => {\n      for (const editor of editors) {\n        editor.remove();\n      }\n    };\n\n    const undo = () => {\n      for (const editor of editors) {\n        this.#addEditorToLayer(editor);\n      }\n    };\n\n    this.addCommands({\n      cmd,\n      undo,\n      mustExec: true\n    });\n  }\n\n  commitOrRemove() {\n    this.#activeEditor?.commitOrRemove();\n  }\n\n  hasSomethingToControl() {\n    return this.#activeEditor || this.hasSelection;\n  }\n\n  #selectEditors(editors) {\n    for (const editor of this.#selectedEditors) {\n      editor.unselect();\n    }\n\n    this.#selectedEditors.clear();\n\n    for (const editor of editors) {\n      if (editor.isEmpty()) {\n        continue;\n      }\n\n      this.#selectedEditors.add(editor);\n      editor.select();\n    }\n\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: this.hasSelection\n    });\n  }\n\n  selectAll() {\n    for (const editor of this.#selectedEditors) {\n      editor.commit();\n    }\n\n    this.#selectEditors(this.#allEditors.values());\n  }\n\n  unselectAll() {\n    if (this.#activeEditor) {\n      this.#activeEditor.commitOrRemove();\n\n      if (this.#mode !== AnnotationEditorType.NONE) {\n        return;\n      }\n    }\n\n    if (!this.hasSelection) {\n      return;\n    }\n\n    for (const editor of this.#selectedEditors) {\n      editor.unselect();\n    }\n\n    this.#selectedEditors.clear();\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: false\n    });\n  }\n\n  translateSelectedEditors(x, y, noCommit = false) {\n    if (!noCommit) {\n      this.commitOrRemove();\n    }\n\n    if (!this.hasSelection) {\n      return;\n    }\n\n    this.#translation[0] += x;\n    this.#translation[1] += y;\n    const [totalX, totalY] = this.#translation;\n    const editors = [...this.#selectedEditors];\n    const TIME_TO_WAIT = 1000;\n\n    if (this.#translationTimeoutId) {\n      clearTimeout(this.#translationTimeoutId);\n    }\n\n    this.#translationTimeoutId = setTimeout(() => {\n      this.#translationTimeoutId = null;\n      this.#translation[0] = this.#translation[1] = 0;\n      this.addCommands({\n        cmd: () => {\n          for (const editor of editors) {\n            if (this.#allEditors.has(editor.id)) {\n              editor.translateInPage(totalX, totalY);\n            }\n          }\n        },\n        undo: () => {\n          for (const editor of editors) {\n            if (this.#allEditors.has(editor.id)) {\n              editor.translateInPage(-totalX, -totalY);\n            }\n          }\n        },\n        mustExec: false\n      });\n    }, TIME_TO_WAIT);\n\n    for (const editor of editors) {\n      editor.translateInPage(x, y);\n    }\n  }\n\n  setUpDragSession() {\n    if (!this.hasSelection) {\n      return;\n    }\n\n    this.disableUserSelect(true);\n    this.#draggingEditors = new Map();\n\n    for (const editor of this.#selectedEditors) {\n      this.#draggingEditors.set(editor, {\n        savedX: editor.x,\n        savedY: editor.y,\n        savedPageIndex: editor.pageIndex,\n        newX: 0,\n        newY: 0,\n        newPageIndex: -1\n      });\n    }\n  }\n\n  endDragSession() {\n    if (!this.#draggingEditors) {\n      return false;\n    }\n\n    this.disableUserSelect(false);\n    const map = this.#draggingEditors;\n    this.#draggingEditors = null;\n    let mustBeAddedInUndoStack = false;\n\n    for (const [{\n      x,\n      y,\n      pageIndex\n    }, value] of map) {\n      value.newX = x;\n      value.newY = y;\n      value.newPageIndex = pageIndex;\n      mustBeAddedInUndoStack ||= x !== value.savedX || y !== value.savedY || pageIndex !== value.savedPageIndex;\n    }\n\n    if (!mustBeAddedInUndoStack) {\n      return false;\n    }\n\n    const move = (editor, x, y, pageIndex) => {\n      if (this.#allEditors.has(editor.id)) {\n        const parent = this.#allLayers.get(pageIndex);\n\n        if (parent) {\n          editor._setParentAndPosition(parent, x, y);\n        } else {\n          editor.pageIndex = pageIndex;\n          editor.x = x;\n          editor.y = y;\n        }\n      }\n    };\n\n    this.addCommands({\n      cmd: () => {\n        for (const [editor, {\n          newX,\n          newY,\n          newPageIndex\n        }] of map) {\n          move(editor, newX, newY, newPageIndex);\n        }\n      },\n      undo: () => {\n        for (const [editor, {\n          savedX,\n          savedY,\n          savedPageIndex\n        }] of map) {\n          move(editor, savedX, savedY, savedPageIndex);\n        }\n      },\n      mustExec: true\n    });\n    return true;\n  }\n\n  dragSelectedEditors(tx, ty) {\n    if (!this.#draggingEditors) {\n      return;\n    }\n\n    for (const editor of this.#draggingEditors.keys()) {\n      editor.drag(tx, ty);\n    }\n  }\n\n  rebuild(editor) {\n    if (editor.parent === null) {\n      const parent = this.getLayer(editor.pageIndex);\n\n      if (parent) {\n        parent.changeParent(editor);\n        parent.addOrRebuild(editor);\n      } else {\n        this.addEditor(editor);\n        this.addToAnnotationStorage(editor);\n        editor.rebuild();\n      }\n    } else {\n      editor.parent.addOrRebuild(editor);\n    }\n  }\n\n  get isEditorHandlingKeyboard() {\n    return this.getActive()?.shouldGetKeyboardEvents() || this.#selectedEditors.size === 1 && this.firstSelectedEditor.shouldGetKeyboardEvents();\n  }\n\n  isActive(editor) {\n    return this.#activeEditor === editor;\n  }\n\n  getActive() {\n    return this.#activeEditor;\n  }\n\n  getMode() {\n    return this.#mode;\n  }\n\n  get imageManager() {\n    return shadow(this, \"imageManager\", new ImageManager());\n  }\n\n  getSelectionBoxes(textLayer) {\n    if (!textLayer) {\n      return null;\n    }\n\n    const selection = document.getSelection();\n\n    for (let i = 0, ii = selection.rangeCount; i < ii; i++) {\n      if (!textLayer.contains(selection.getRangeAt(i).commonAncestorContainer)) {\n        return null;\n      }\n    }\n\n    const {\n      x: layerX,\n      y: layerY,\n      width: parentWidth,\n      height: parentHeight\n    } = textLayer.getBoundingClientRect();\n    let rotator;\n\n    switch (textLayer.getAttribute(\"data-main-rotation\")) {\n      case \"90\":\n        rotator = (x, y, w, h) => ({\n          x: (y - layerY) / parentHeight,\n          y: 1 - (x + w - layerX) / parentWidth,\n          width: h / parentHeight,\n          height: w / parentWidth\n        });\n\n        break;\n\n      case \"180\":\n        rotator = (x, y, w, h) => ({\n          x: 1 - (x + w - layerX) / parentWidth,\n          y: 1 - (y + h - layerY) / parentHeight,\n          width: w / parentWidth,\n          height: h / parentHeight\n        });\n\n        break;\n\n      case \"270\":\n        rotator = (x, y, w, h) => ({\n          x: 1 - (y + h - layerY) / parentHeight,\n          y: (x - layerX) / parentWidth,\n          width: h / parentHeight,\n          height: w / parentWidth\n        });\n\n        break;\n\n      default:\n        rotator = (x, y, w, h) => ({\n          x: (x - layerX) / parentWidth,\n          y: (y - layerY) / parentHeight,\n          width: w / parentWidth,\n          height: h / parentHeight\n        });\n\n        break;\n    }\n\n    const boxes = [];\n\n    for (let i = 0, ii = selection.rangeCount; i < ii; i++) {\n      const range = selection.getRangeAt(i);\n\n      if (range.collapsed) {\n        continue;\n      }\n\n      for (const {\n        x,\n        y,\n        width,\n        height\n      } of range.getClientRects()) {\n        if (width === 0 || height === 0) {\n          continue;\n        }\n\n        boxes.push(rotator(x, y, width, height));\n      }\n    }\n\n    return boxes.length === 0 ? null : boxes;\n  }\n\n  addChangedExistingAnnotation({\n    annotationElementId,\n    id\n  }) {\n    (this.#changedExistingAnnotations ||= new Map()).set(annotationElementId, id);\n  }\n\n  removeChangedExistingAnnotation({\n    annotationElementId\n  }) {\n    this.#changedExistingAnnotations?.delete(annotationElementId);\n  }\n\n  renderAnnotationElement(annotation) {\n    const editorId = this.#changedExistingAnnotations?.get(annotation.data.id);\n\n    if (!editorId) {\n      return;\n    }\n\n    const editor = this.#annotationStorage.getRawValue(editorId);\n\n    if (!editor) {\n      return;\n    }\n\n    if (this.#mode === AnnotationEditorType.NONE && !editor.hasBeenModified) {\n      return;\n    }\n\n    editor.renderAnnotationElement(annotation);\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/alt_text.js\n\nclass AltText {\n  #altText = null;\n  #altTextDecorative = false;\n  #altTextButton = null;\n  #altTextTooltip = null;\n  #altTextTooltipTimeout = null;\n  #altTextWasFromKeyBoard = false;\n  #badge = null;\n  #editor = null;\n  #guessedText = null;\n  #textWithDisclaimer = null;\n  #useNewAltTextFlow = false;\n  static _l10nPromise = null;\n\n  constructor(editor) {\n    this.#editor = editor;\n    this.#useNewAltTextFlow = editor._uiManager.useNewAltTextFlow;\n  }\n\n  static initialize(l10nPromise) {\n    AltText._l10nPromise ||= l10nPromise;\n  }\n\n  render() {\n    var _this8 = this;\n\n    return _asyncToGenerator(function* () {\n      const altText = _this8.#altTextButton = document.createElement(\"button\");\n      altText.className = \"altText\";\n      let msg;\n\n      if (_this8.#useNewAltTextFlow) {\n        altText.classList.add(\"new\");\n        msg = yield AltText._l10nPromise.get(\"pdfjs-editor-new-alt-text-missing-button-label\");\n      } else {\n        msg = yield AltText._l10nPromise.get(\"pdfjs-editor-alt-text-button-label\");\n      }\n\n      altText.textContent = msg;\n      altText.setAttribute(\"aria-label\", msg);\n      altText.tabIndex = \"0\";\n      const signal = _this8.#editor._uiManager._signal;\n      altText.addEventListener(\"contextmenu\", noContextMenu, {\n        signal\n      });\n      altText.addEventListener(\"pointerdown\", event => event.stopPropagation(), {\n        signal\n      });\n\n      const onClick = event => {\n        event.preventDefault();\n\n        _this8.#editor._uiManager.editAltText(_this8.#editor);\n\n        if (_this8.#useNewAltTextFlow) {\n          _this8.#editor._reportTelemetry({\n            action: \"pdfjs.image.alt_text.image_status_label_clicked\",\n            data: {\n              label: _this8.#label\n            }\n          });\n        }\n      };\n\n      altText.addEventListener(\"click\", onClick, {\n        capture: true,\n        signal\n      });\n      altText.addEventListener(\"keydown\", event => {\n        if (event.target === altText && event.key === \"Enter\") {\n          _this8.#altTextWasFromKeyBoard = true;\n          onClick(event);\n        }\n      }, {\n        signal\n      });\n      yield _this8.#setState();\n      return altText;\n    })();\n  }\n\n  get #label() {\n    return this.#altText && \"added\" || this.#altText === null && this.guessedText && \"review\" || \"missing\";\n  }\n\n  finish() {\n    if (!this.#altTextButton) {\n      return;\n    }\n\n    this.#altTextButton.focus({\n      focusVisible: this.#altTextWasFromKeyBoard\n    });\n    this.#altTextWasFromKeyBoard = false;\n  }\n\n  isEmpty() {\n    if (this.#useNewAltTextFlow) {\n      return this.#altText === null;\n    }\n\n    return !this.#altText && !this.#altTextDecorative;\n  }\n\n  hasData() {\n    if (this.#useNewAltTextFlow) {\n      return this.#altText !== null || !!this.#guessedText;\n    }\n\n    return this.isEmpty();\n  }\n\n  get guessedText() {\n    return this.#guessedText;\n  }\n\n  setGuessedText(guessedText) {\n    var _this9 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this9.#altText !== null) {\n        return;\n      }\n\n      _this9.#guessedText = guessedText;\n      _this9.#textWithDisclaimer = yield AltText._l10nPromise.get(\"pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer\")({\n        generatedAltText: guessedText\n      });\n\n      _this9.#setState();\n    })();\n  }\n\n  toggleAltTextBadge(visibility = false) {\n    if (!this.#useNewAltTextFlow || this.#altText) {\n      this.#badge?.remove();\n      this.#badge = null;\n      return;\n    }\n\n    if (!this.#badge) {\n      const badge = this.#badge = document.createElement(\"div\");\n      badge.className = \"noAltTextBadge\";\n      this.#editor.div.append(badge);\n    }\n\n    this.#badge.classList.toggle(\"hidden\", !visibility);\n  }\n\n  serialize(isForCopying) {\n    let altText = this.#altText;\n\n    if (!isForCopying && this.#guessedText === altText) {\n      altText = this.#textWithDisclaimer;\n    }\n\n    return {\n      altText,\n      decorative: this.#altTextDecorative,\n      guessedText: this.#guessedText,\n      textWithDisclaimer: this.#textWithDisclaimer\n    };\n  }\n\n  get data() {\n    return {\n      altText: this.#altText,\n      decorative: this.#altTextDecorative\n    };\n  }\n\n  set data({\n    altText,\n    decorative,\n    guessedText,\n    textWithDisclaimer,\n    cancel = false\n  }) {\n    if (guessedText) {\n      this.#guessedText = guessedText;\n      this.#textWithDisclaimer = textWithDisclaimer;\n    }\n\n    if (this.#altText === altText && this.#altTextDecorative === decorative) {\n      return;\n    }\n\n    if (!cancel) {\n      this.#altText = altText;\n      this.#altTextDecorative = decorative;\n    }\n\n    this.#setState();\n  }\n\n  toggle(enabled = false) {\n    if (!this.#altTextButton) {\n      return;\n    }\n\n    if (!enabled && this.#altTextTooltipTimeout) {\n      clearTimeout(this.#altTextTooltipTimeout);\n      this.#altTextTooltipTimeout = null;\n    }\n\n    this.#altTextButton.disabled = !enabled;\n  }\n\n  shown() {\n    this.#editor._reportTelemetry({\n      action: \"pdfjs.image.alt_text.image_status_label_displayed\",\n      data: {\n        label: this.#label\n      }\n    });\n  }\n\n  destroy() {\n    this.#altTextButton?.remove();\n    this.#altTextButton = null;\n    this.#altTextTooltip = null;\n    this.#badge?.remove();\n    this.#badge = null;\n  }\n\n  #setState() {\n    var _this10 = this;\n\n    return _asyncToGenerator(function* () {\n      const button = _this10.#altTextButton;\n\n      if (!button) {\n        return;\n      }\n\n      if (_this10.#useNewAltTextFlow) {\n        const label = _this10.#label;\n        const type = label === \"review\" ? \"to-review\" : label;\n        button.classList.toggle(\"done\", !!_this10.#altText);\n\n        AltText._l10nPromise.get(`pdfjs-editor-new-alt-text-${type}-button-label`).then(msg => {\n          button.setAttribute(\"aria-label\", msg);\n\n          for (const child of button.childNodes) {\n            if (child.nodeType === Node.TEXT_NODE) {\n              child.textContent = msg;\n              break;\n            }\n          }\n        });\n\n        if (!_this10.#altText) {\n          _this10.#altTextTooltip?.remove();\n          return;\n        }\n      } else {\n        if (!_this10.#altText && !_this10.#altTextDecorative) {\n          button.classList.remove(\"done\");\n          _this10.#altTextTooltip?.remove();\n          return;\n        }\n\n        button.classList.add(\"done\");\n\n        AltText._l10nPromise.get(\"pdfjs-editor-alt-text-edit-button-label\").then(msg => {\n          button.setAttribute(\"aria-label\", msg);\n        });\n      }\n\n      let tooltip = _this10.#altTextTooltip;\n\n      if (!tooltip) {\n        _this10.#altTextTooltip = tooltip = document.createElement(\"span\");\n        tooltip.className = \"tooltip\";\n        tooltip.setAttribute(\"role\", \"tooltip\");\n        const id = tooltip.id = `alt-text-tooltip-${_this10.#editor.id}`;\n        button.setAttribute(\"aria-describedby\", id);\n        const DELAY_TO_SHOW_TOOLTIP = 100;\n        const signal = _this10.#editor._uiManager._signal;\n        signal.addEventListener(\"abort\", () => {\n          clearTimeout(_this10.#altTextTooltipTimeout);\n          _this10.#altTextTooltipTimeout = null;\n        }, {\n          once: true\n        });\n        button.addEventListener(\"mouseenter\", () => {\n          _this10.#altTextTooltipTimeout = setTimeout(() => {\n            _this10.#altTextTooltipTimeout = null;\n\n            _this10.#altTextTooltip.classList.add(\"show\");\n\n            _this10.#editor._reportTelemetry({\n              action: \"alt_text_tooltip\"\n            });\n          }, DELAY_TO_SHOW_TOOLTIP);\n        }, {\n          signal\n        });\n        button.addEventListener(\"mouseleave\", () => {\n          if (_this10.#altTextTooltipTimeout) {\n            clearTimeout(_this10.#altTextTooltipTimeout);\n            _this10.#altTextTooltipTimeout = null;\n          }\n\n          _this10.#altTextTooltip?.classList.remove(\"show\");\n        }, {\n          signal\n        });\n      }\n\n      tooltip.innerText = _this10.#altTextDecorative ? yield AltText._l10nPromise.get(\"pdfjs-editor-alt-text-decorative-tooltip\") : _this10.#altText;\n\n      if (!tooltip.parentNode) {\n        button.append(tooltip);\n      }\n\n      const element = _this10.#editor.getImageForAltText();\n\n      element?.setAttribute(\"aria-describedby\", tooltip.id);\n    })();\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/editor.js\n\nclass AnnotationEditor {\n  #accessibilityData = null;\n  #allResizerDivs = null;\n  #altText = null;\n  #disabled = false;\n  #keepAspectRatio = false;\n  #resizersDiv = null;\n  #savedDimensions = null;\n  #focusAC = null;\n  #focusedResizerName = \"\";\n  #hasBeenClicked = false;\n  #initialPosition = null;\n  #isEditing = false;\n  #isInEditMode = false;\n  #isResizerEnabledForKeyboard = false;\n  #moveInDOMTimeout = null;\n  #prevDragX = 0;\n  #prevDragY = 0;\n  #telemetryTimeouts = null;\n  _editToolbar = null;\n  _initialOptions = Object.create(null);\n  _isVisible = true;\n  _uiManager = null;\n  _focusEventsAllowed = true;\n  static _l10nPromise = null;\n  static _l10nResizer = null;\n  #isDraggable = false;\n  #zIndex = AnnotationEditor._zIndex++;\n  static _borderLineWidth = -1;\n  static _colorManager = new ColorManager();\n  static _zIndex = 1;\n  static _telemetryTimeout = 1000;\n\n  static get _resizerKeyboardManager() {\n    const resize = AnnotationEditor.prototype._resizeWithKeyboard;\n    const small = AnnotationEditorUIManager.TRANSLATE_SMALL;\n    const big = AnnotationEditorUIManager.TRANSLATE_BIG;\n    return shadow(this, \"_resizerKeyboardManager\", new KeyboardManager([[[\"ArrowLeft\", \"mac+ArrowLeft\"], resize, {\n      args: [-small, 0]\n    }], [[\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"], resize, {\n      args: [-big, 0]\n    }], [[\"ArrowRight\", \"mac+ArrowRight\"], resize, {\n      args: [small, 0]\n    }], [[\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"], resize, {\n      args: [big, 0]\n    }], [[\"ArrowUp\", \"mac+ArrowUp\"], resize, {\n      args: [0, -small]\n    }], [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], resize, {\n      args: [0, -big]\n    }], [[\"ArrowDown\", \"mac+ArrowDown\"], resize, {\n      args: [0, small]\n    }], [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], resize, {\n      args: [0, big]\n    }], [[\"Escape\", \"mac+Escape\"], AnnotationEditor.prototype._stopResizingWithKeyboard]]));\n  }\n\n  constructor(parameters) {\n    this.parent = parameters.parent;\n    this.id = parameters.id;\n    this.width = this.height = null;\n    this.pageIndex = parameters.parent.pageIndex;\n    this.name = parameters.name;\n    this.div = null;\n    this._uiManager = parameters.uiManager;\n    this.annotationElementId = null;\n    this._willKeepAspectRatio = false;\n    this._initialOptions.isCentered = parameters.isCentered;\n    this._structTreeParentId = null;\n    const {\n      rotation,\n      rawDims: {\n        pageWidth,\n        pageHeight,\n        pageX,\n        pageY\n      }\n    } = this.parent.viewport;\n    this.rotation = rotation;\n    this.pageRotation = (360 + rotation - this._uiManager.viewParameters.rotation) % 360;\n    this.pageDimensions = [pageWidth, pageHeight];\n    this.pageTranslation = [pageX, pageY];\n    const [width, height] = this.parentDimensions;\n    this.x = parameters.x / width;\n    this.y = parameters.y / height;\n    this.isAttachedToDOM = false;\n    this.deleted = false;\n  }\n\n  get editorType() {\n    return Object.getPrototypeOf(this).constructor._type;\n  }\n\n  static get _defaultLineColor() {\n    return shadow(this, \"_defaultLineColor\", this._colorManager.getHexCode(\"CanvasText\"));\n  }\n\n  static deleteAnnotationElement(editor) {\n    const fakeEditor = new FakeEditor({\n      id: editor.parent.getNextId(),\n      parent: editor.parent,\n      uiManager: editor._uiManager\n    });\n    fakeEditor.annotationElementId = editor.annotationElementId;\n    fakeEditor.deleted = true;\n\n    fakeEditor._uiManager.addToAnnotationStorage(fakeEditor);\n  }\n\n  static initialize(l10n, _uiManager, options) {\n    AnnotationEditor._l10nResizer ||= Object.freeze({\n      topLeft: \"pdfjs-editor-resizer-top-left\",\n      topMiddle: \"pdfjs-editor-resizer-top-middle\",\n      topRight: \"pdfjs-editor-resizer-top-right\",\n      middleRight: \"pdfjs-editor-resizer-middle-right\",\n      bottomRight: \"pdfjs-editor-resizer-bottom-right\",\n      bottomMiddle: \"pdfjs-editor-resizer-bottom-middle\",\n      bottomLeft: \"pdfjs-editor-resizer-bottom-left\",\n      middleLeft: \"pdfjs-editor-resizer-middle-left\"\n    });\n    AnnotationEditor._l10nPromise ||= new Map([...[\"pdfjs-editor-alt-text-button-label\", \"pdfjs-editor-alt-text-edit-button-label\", \"pdfjs-editor-alt-text-decorative-tooltip\", \"pdfjs-editor-new-alt-text-added-button-label\", \"pdfjs-editor-new-alt-text-missing-button-label\", \"pdfjs-editor-new-alt-text-to-review-button-label\"].map(str => [str, l10n.get(str)]), ...[\"pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer\"].map(str => [str, l10n.get.bind(l10n, str)])]);\n\n    if (options?.strings) {\n      for (const str of options.strings) {\n        AnnotationEditor._l10nPromise.set(str, l10n.get(str));\n      }\n    }\n\n    if (AnnotationEditor._borderLineWidth !== -1) {\n      return;\n    }\n\n    const style = getComputedStyle(document.documentElement);\n    AnnotationEditor._borderLineWidth = parseFloat(style.getPropertyValue(\"--outline-width\")) || 0;\n  }\n\n  static updateDefaultParams(_type, _value) {}\n\n  static get defaultPropertiesToUpdate() {\n    return [];\n  }\n\n  static isHandlingMimeForPasting(mime) {\n    return false;\n  }\n\n  static paste(item, parent) {\n    unreachable(\"Not implemented\");\n  }\n\n  get propertiesToUpdate() {\n    return [];\n  }\n\n  get _isDraggable() {\n    return this.#isDraggable;\n  }\n\n  set _isDraggable(value) {\n    this.#isDraggable = value;\n    this.div?.classList.toggle(\"draggable\", value);\n  }\n\n  get isEnterHandled() {\n    return true;\n  }\n\n  center() {\n    const [pageWidth, pageHeight] = this.pageDimensions;\n\n    switch (this.parentRotation) {\n      case 90:\n        this.x -= this.height * pageHeight / (pageWidth * 2);\n        this.y += this.width * pageWidth / (pageHeight * 2);\n        break;\n\n      case 180:\n        this.x += this.width / 2;\n        this.y += this.height / 2;\n        break;\n\n      case 270:\n        this.x += this.height * pageHeight / (pageWidth * 2);\n        this.y -= this.width * pageWidth / (pageHeight * 2);\n        break;\n\n      default:\n        this.x -= this.width / 2;\n        this.y -= this.height / 2;\n        break;\n    }\n\n    this.fixAndSetPosition();\n  }\n\n  addCommands(params) {\n    this._uiManager.addCommands(params);\n  }\n\n  get currentLayer() {\n    return this._uiManager.currentLayer;\n  }\n\n  setInBackground() {\n    this.div.style.zIndex = 0;\n  }\n\n  setInForeground() {\n    this.div.style.zIndex = this.#zIndex;\n  }\n\n  setParent(parent) {\n    if (parent !== null) {\n      this.pageIndex = parent.pageIndex;\n      this.pageDimensions = parent.pageDimensions;\n    } else {\n      this.#stopResizing();\n    }\n\n    this.parent = parent;\n  }\n\n  focusin(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n\n    if (!this.#hasBeenClicked) {\n      this.parent.setSelected(this);\n    } else {\n      this.#hasBeenClicked = false;\n    }\n  }\n\n  focusout(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n\n    if (!this.isAttachedToDOM) {\n      return;\n    }\n\n    const target = event.relatedTarget;\n\n    if (target?.closest(`#${this.id}`)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (!this.parent?.isMultipleSelection) {\n      this.commitOrRemove();\n    }\n  }\n\n  commitOrRemove() {\n    if (this.isEmpty()) {\n      this.remove();\n    } else {\n      this.commit();\n    }\n  }\n\n  commit() {\n    this.addToAnnotationStorage();\n  }\n\n  addToAnnotationStorage() {\n    this._uiManager.addToAnnotationStorage(this);\n  }\n\n  setAt(x, y, tx, ty) {\n    const [width, height] = this.parentDimensions;\n    [tx, ty] = this.screenToPageTranslation(tx, ty);\n    this.x = (x + tx) / width;\n    this.y = (y + ty) / height;\n    this.fixAndSetPosition();\n  }\n\n  #translate([width, height], x, y) {\n    [x, y] = this.screenToPageTranslation(x, y);\n    this.x += x / width;\n    this.y += y / height;\n    this.fixAndSetPosition();\n  }\n\n  translate(x, y) {\n    this.#translate(this.parentDimensions, x, y);\n  }\n\n  translateInPage(x, y) {\n    this.#initialPosition ||= [this.x, this.y];\n    this.#translate(this.pageDimensions, x, y);\n    this.div.scrollIntoView({\n      block: \"nearest\"\n    });\n  }\n\n  drag(tx, ty) {\n    this.#initialPosition ||= [this.x, this.y];\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.x += tx / parentWidth;\n    this.y += ty / parentHeight;\n\n    if (this.parent && (this.x < 0 || this.x > 1 || this.y < 0 || this.y > 1)) {\n      const {\n        x,\n        y\n      } = this.div.getBoundingClientRect();\n\n      if (this.parent.findNewParent(this, x, y)) {\n        this.x -= Math.floor(this.x);\n        this.y -= Math.floor(this.y);\n      }\n    }\n\n    let {\n      x,\n      y\n    } = this;\n    const [bx, by] = this.getBaseTranslation();\n    x += bx;\n    y += by;\n    this.div.style.left = `${(100 * x).toFixed(2)}%`;\n    this.div.style.top = `${(100 * y).toFixed(2)}%`;\n    this.div.scrollIntoView({\n      block: \"nearest\"\n    });\n  }\n\n  get _hasBeenMoved() {\n    return !!this.#initialPosition && (this.#initialPosition[0] !== this.x || this.#initialPosition[1] !== this.y);\n  }\n\n  getBaseTranslation() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const {\n      _borderLineWidth\n    } = AnnotationEditor;\n    const x = _borderLineWidth / parentWidth;\n    const y = _borderLineWidth / parentHeight;\n\n    switch (this.rotation) {\n      case 90:\n        return [-x, y];\n\n      case 180:\n        return [x, y];\n\n      case 270:\n        return [x, -y];\n\n      default:\n        return [-x, -y];\n    }\n  }\n\n  get _mustFixPosition() {\n    return true;\n  }\n\n  fixAndSetPosition(rotation = this.rotation) {\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    let {\n      x,\n      y,\n      width,\n      height\n    } = this;\n    width *= pageWidth;\n    height *= pageHeight;\n    x *= pageWidth;\n    y *= pageHeight;\n\n    if (this._mustFixPosition) {\n      switch (rotation) {\n        case 0:\n          x = Math.max(0, Math.min(pageWidth - width, x));\n          y = Math.max(0, Math.min(pageHeight - height, y));\n          break;\n\n        case 90:\n          x = Math.max(0, Math.min(pageWidth - height, x));\n          y = Math.min(pageHeight, Math.max(width, y));\n          break;\n\n        case 180:\n          x = Math.min(pageWidth, Math.max(width, x));\n          y = Math.min(pageHeight, Math.max(height, y));\n          break;\n\n        case 270:\n          x = Math.min(pageWidth, Math.max(height, x));\n          y = Math.max(0, Math.min(pageHeight - width, y));\n          break;\n      }\n    }\n\n    this.x = x /= pageWidth;\n    this.y = y /= pageHeight;\n    const [bx, by] = this.getBaseTranslation();\n    x += bx;\n    y += by;\n    const {\n      style\n    } = this.div;\n    style.left = `${(100 * x).toFixed(2)}%`;\n    style.top = `${(100 * y).toFixed(2)}%`;\n    this.moveInDOM();\n  }\n\n  static #rotatePoint(x, y, angle) {\n    switch (angle) {\n      case 90:\n        return [y, -x];\n\n      case 180:\n        return [-x, -y];\n\n      case 270:\n        return [-y, x];\n\n      default:\n        return [x, y];\n    }\n  }\n\n  screenToPageTranslation(x, y) {\n    return AnnotationEditor.#rotatePoint(x, y, this.parentRotation);\n  }\n\n  pageTranslationToScreen(x, y) {\n    return AnnotationEditor.#rotatePoint(x, y, 360 - this.parentRotation);\n  }\n\n  #getRotationMatrix(rotation) {\n    switch (rotation) {\n      case 90:\n        {\n          const [pageWidth, pageHeight] = this.pageDimensions;\n          return [0, -pageWidth / pageHeight, pageHeight / pageWidth, 0];\n        }\n\n      case 180:\n        return [-1, 0, 0, -1];\n\n      case 270:\n        {\n          const [pageWidth, pageHeight] = this.pageDimensions;\n          return [0, pageWidth / pageHeight, -pageHeight / pageWidth, 0];\n        }\n\n      default:\n        return [1, 0, 0, 1];\n    }\n  }\n\n  get parentScale() {\n    return this._uiManager.viewParameters.realScale;\n  }\n\n  get parentRotation() {\n    return (this._uiManager.viewParameters.rotation + this.pageRotation) % 360;\n  }\n\n  get parentDimensions() {\n    const {\n      parentScale,\n      pageDimensions: [pageWidth, pageHeight]\n    } = this;\n    const scaledWidth = pageWidth * parentScale;\n    const scaledHeight = pageHeight * parentScale;\n    return util_FeatureTest.isCSSRoundSupported ? [Math.round(scaledWidth), Math.round(scaledHeight)] : [scaledWidth, scaledHeight];\n  }\n\n  setDims(width, height) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.div.style.width = `${(100 * width / parentWidth).toFixed(2)}%`;\n\n    if (!this.#keepAspectRatio) {\n      this.div.style.height = `${(100 * height / parentHeight).toFixed(2)}%`;\n    }\n  }\n\n  fixDims() {\n    const {\n      style\n    } = this.div;\n    const {\n      height,\n      width\n    } = style;\n    const widthPercent = width.endsWith(\"%\");\n    const heightPercent = !this.#keepAspectRatio && height.endsWith(\"%\");\n\n    if (widthPercent && heightPercent) {\n      return;\n    }\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n\n    if (!widthPercent) {\n      style.width = `${(100 * parseFloat(width) / parentWidth).toFixed(2)}%`;\n    }\n\n    if (!this.#keepAspectRatio && !heightPercent) {\n      style.height = `${(100 * parseFloat(height) / parentHeight).toFixed(2)}%`;\n    }\n  }\n\n  getInitialTranslation() {\n    return [0, 0];\n  }\n\n  #createResizers() {\n    if (this.#resizersDiv) {\n      return;\n    }\n\n    this.#resizersDiv = document.createElement(\"div\");\n    this.#resizersDiv.classList.add(\"resizers\");\n    const classes = this._willKeepAspectRatio ? [\"topLeft\", \"topRight\", \"bottomRight\", \"bottomLeft\"] : [\"topLeft\", \"topMiddle\", \"topRight\", \"middleRight\", \"bottomRight\", \"bottomMiddle\", \"bottomLeft\", \"middleLeft\"];\n    const signal = this._uiManager._signal;\n\n    for (const name of classes) {\n      const div = document.createElement(\"div\");\n      this.#resizersDiv.append(div);\n      div.classList.add(\"resizer\", name);\n      div.setAttribute(\"data-resizer-name\", name);\n      div.addEventListener(\"pointerdown\", this.#resizerPointerdown.bind(this, name), {\n        signal\n      });\n      div.addEventListener(\"contextmenu\", noContextMenu, {\n        signal\n      });\n      div.tabIndex = -1;\n    }\n\n    this.div.prepend(this.#resizersDiv);\n  }\n\n  #resizerPointerdown(name, event) {\n    event.preventDefault();\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n\n    if (event.button !== 0 || event.ctrlKey && isMac) {\n      return;\n    }\n\n    this.#altText?.toggle(false);\n    const savedDraggable = this._isDraggable;\n    this._isDraggable = false;\n    const ac = new AbortController();\n\n    const signal = this._uiManager.combinedSignal(ac);\n\n    this.parent.togglePointerEvents(false);\n    window.addEventListener(\"pointermove\", this.#resizerPointermove.bind(this, name), {\n      passive: true,\n      capture: true,\n      signal\n    });\n    window.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    const savedX = this.x;\n    const savedY = this.y;\n    const savedWidth = this.width;\n    const savedHeight = this.height;\n    const savedParentCursor = this.parent.div.style.cursor;\n    const savedCursor = this.div.style.cursor;\n    this.div.style.cursor = this.parent.div.style.cursor = window.getComputedStyle(event.target).cursor;\n\n    const pointerUpCallback = () => {\n      ac.abort();\n      this.parent.togglePointerEvents(true);\n      this.#altText?.toggle(true);\n      this._isDraggable = savedDraggable;\n      this.parent.div.style.cursor = savedParentCursor;\n      this.div.style.cursor = savedCursor;\n      this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n    };\n\n    window.addEventListener(\"pointerup\", pointerUpCallback, {\n      signal\n    });\n    window.addEventListener(\"blur\", pointerUpCallback, {\n      signal\n    });\n  }\n\n  #addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight) {\n    const newX = this.x;\n    const newY = this.y;\n    const newWidth = this.width;\n    const newHeight = this.height;\n\n    if (newX === savedX && newY === savedY && newWidth === savedWidth && newHeight === savedHeight) {\n      return;\n    }\n\n    this.addCommands({\n      cmd: () => {\n        this.width = newWidth;\n        this.height = newHeight;\n        this.x = newX;\n        this.y = newY;\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n        this.fixAndSetPosition();\n      },\n      undo: () => {\n        this.width = savedWidth;\n        this.height = savedHeight;\n        this.x = savedX;\n        this.y = savedY;\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.setDims(parentWidth * savedWidth, parentHeight * savedHeight);\n        this.fixAndSetPosition();\n      },\n      mustExec: true\n    });\n  }\n\n  #resizerPointermove(name, event) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const savedX = this.x;\n    const savedY = this.y;\n    const savedWidth = this.width;\n    const savedHeight = this.height;\n    const minWidth = AnnotationEditor.MIN_SIZE / parentWidth;\n    const minHeight = AnnotationEditor.MIN_SIZE / parentHeight;\n\n    const round = x => Math.round(x * 10000) / 10000;\n\n    const rotationMatrix = this.#getRotationMatrix(this.rotation);\n\n    const transf = (x, y) => [rotationMatrix[0] * x + rotationMatrix[2] * y, rotationMatrix[1] * x + rotationMatrix[3] * y];\n\n    const invRotationMatrix = this.#getRotationMatrix(360 - this.rotation);\n\n    const invTransf = (x, y) => [invRotationMatrix[0] * x + invRotationMatrix[2] * y, invRotationMatrix[1] * x + invRotationMatrix[3] * y];\n\n    let getPoint;\n    let getOpposite;\n    let isDiagonal = false;\n    let isHorizontal = false;\n\n    switch (name) {\n      case \"topLeft\":\n        isDiagonal = true;\n\n        getPoint = (w, h) => [0, 0];\n\n        getOpposite = (w, h) => [w, h];\n\n        break;\n\n      case \"topMiddle\":\n        getPoint = (w, h) => [w / 2, 0];\n\n        getOpposite = (w, h) => [w / 2, h];\n\n        break;\n\n      case \"topRight\":\n        isDiagonal = true;\n\n        getPoint = (w, h) => [w, 0];\n\n        getOpposite = (w, h) => [0, h];\n\n        break;\n\n      case \"middleRight\":\n        isHorizontal = true;\n\n        getPoint = (w, h) => [w, h / 2];\n\n        getOpposite = (w, h) => [0, h / 2];\n\n        break;\n\n      case \"bottomRight\":\n        isDiagonal = true;\n\n        getPoint = (w, h) => [w, h];\n\n        getOpposite = (w, h) => [0, 0];\n\n        break;\n\n      case \"bottomMiddle\":\n        getPoint = (w, h) => [w / 2, h];\n\n        getOpposite = (w, h) => [w / 2, 0];\n\n        break;\n\n      case \"bottomLeft\":\n        isDiagonal = true;\n\n        getPoint = (w, h) => [0, h];\n\n        getOpposite = (w, h) => [w, 0];\n\n        break;\n\n      case \"middleLeft\":\n        isHorizontal = true;\n\n        getPoint = (w, h) => [0, h / 2];\n\n        getOpposite = (w, h) => [w, h / 2];\n\n        break;\n    }\n\n    const point = getPoint(savedWidth, savedHeight);\n    const oppositePoint = getOpposite(savedWidth, savedHeight);\n    let transfOppositePoint = transf(...oppositePoint);\n    const oppositeX = round(savedX + transfOppositePoint[0]);\n    const oppositeY = round(savedY + transfOppositePoint[1]);\n    let ratioX = 1;\n    let ratioY = 1;\n    let [deltaX, deltaY] = this.screenToPageTranslation(event.movementX, event.movementY);\n    [deltaX, deltaY] = invTransf(deltaX / parentWidth, deltaY / parentHeight);\n\n    if (isDiagonal) {\n      const oldDiag = Math.hypot(savedWidth, savedHeight);\n      ratioX = ratioY = Math.max(Math.min(Math.hypot(oppositePoint[0] - point[0] - deltaX, oppositePoint[1] - point[1] - deltaY) / oldDiag, 1 / savedWidth, 1 / savedHeight), minWidth / savedWidth, minHeight / savedHeight);\n    } else if (isHorizontal) {\n      ratioX = Math.max(minWidth, Math.min(1, Math.abs(oppositePoint[0] - point[0] - deltaX))) / savedWidth;\n    } else {\n      ratioY = Math.max(minHeight, Math.min(1, Math.abs(oppositePoint[1] - point[1] - deltaY))) / savedHeight;\n    }\n\n    const newWidth = round(savedWidth * ratioX);\n    const newHeight = round(savedHeight * ratioY);\n    transfOppositePoint = transf(...getOpposite(newWidth, newHeight));\n    const newX = oppositeX - transfOppositePoint[0];\n    const newY = oppositeY - transfOppositePoint[1];\n    this.width = newWidth;\n    this.height = newHeight;\n    this.x = newX;\n    this.y = newY;\n    this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n    this.fixAndSetPosition();\n  }\n\n  altTextFinish() {\n    this.#altText?.finish();\n  }\n\n  addEditToolbar() {\n    var _this11 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this11._editToolbar || _this11.#isInEditMode) {\n        return _this11._editToolbar;\n      }\n\n      _this11._editToolbar = new EditorToolbar(_this11);\n\n      _this11.div.append(_this11._editToolbar.render());\n\n      if (_this11.#altText) {\n        yield _this11._editToolbar.addAltText(_this11.#altText);\n      }\n\n      return _this11._editToolbar;\n    })();\n  }\n\n  removeEditToolbar() {\n    if (!this._editToolbar) {\n      return;\n    }\n\n    this._editToolbar.remove();\n\n    this._editToolbar = null;\n    this.#altText?.destroy();\n  }\n\n  getClientDimensions() {\n    return this.div.getBoundingClientRect();\n  }\n\n  addAltTextButton() {\n    var _this12 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this12.#altText) {\n        return;\n      }\n\n      AltText.initialize(AnnotationEditor._l10nPromise);\n      _this12.#altText = new AltText(_this12);\n\n      if (_this12.#accessibilityData) {\n        _this12.#altText.data = _this12.#accessibilityData;\n        _this12.#accessibilityData = null;\n      }\n\n      yield _this12.addEditToolbar();\n    })();\n  }\n\n  get altTextData() {\n    return this.#altText?.data;\n  }\n\n  set altTextData(data) {\n    if (!this.#altText) {\n      return;\n    }\n\n    this.#altText.data = data;\n  }\n\n  get guessedAltText() {\n    return this.#altText?.guessedText;\n  }\n\n  setGuessedAltText(text) {\n    var _this13 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this13.#altText?.setGuessedText(text);\n    })();\n  }\n\n  serializeAltText(isForCopying) {\n    return this.#altText?.serialize(isForCopying);\n  }\n\n  hasAltText() {\n    return !!this.#altText && !this.#altText.isEmpty();\n  }\n\n  hasAltTextData() {\n    return this.#altText?.hasData() ?? false;\n  }\n\n  render() {\n    this.div = document.createElement(\"div\");\n    this.div.setAttribute(\"data-editor-rotation\", (360 - this.rotation) % 360);\n    this.div.className = this.name;\n    this.div.setAttribute(\"id\", this.id);\n    this.div.tabIndex = this.#disabled ? -1 : 0;\n\n    if (!this._isVisible) {\n      this.div.classList.add(\"hidden\");\n    }\n\n    this.setInForeground();\n    this.#addFocusListeners();\n    const [parentWidth, parentHeight] = this.parentDimensions;\n\n    if (this.parentRotation % 180 !== 0) {\n      this.div.style.maxWidth = `${(100 * parentHeight / parentWidth).toFixed(2)}%`;\n      this.div.style.maxHeight = `${(100 * parentWidth / parentHeight).toFixed(2)}%`;\n    }\n\n    const [tx, ty] = this.getInitialTranslation();\n    this.translate(tx, ty);\n    bindEvents(this, this.div, [\"pointerdown\"]);\n    return this.div;\n  }\n\n  pointerdown(event) {\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n\n    if (event.button !== 0 || event.ctrlKey && isMac) {\n      event.preventDefault();\n      return;\n    }\n\n    this.#hasBeenClicked = true;\n\n    if (this._isDraggable) {\n      this.#setUpDragSession(event);\n      return;\n    }\n\n    this.#selectOnPointerEvent(event);\n  }\n\n  #selectOnPointerEvent(event) {\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n\n    if (event.ctrlKey && !isMac || event.shiftKey || event.metaKey && isMac) {\n      this.parent.toggleSelected(this);\n    } else {\n      this.parent.setSelected(this);\n    }\n  }\n\n  #setUpDragSession(event) {\n    const isSelected = this._uiManager.isSelected(this);\n\n    this._uiManager.setUpDragSession();\n\n    const ac = new AbortController();\n\n    const signal = this._uiManager.combinedSignal(ac);\n\n    if (isSelected) {\n      this.div.classList.add(\"moving\");\n      this.#prevDragX = event.clientX;\n      this.#prevDragY = event.clientY;\n\n      const pointerMoveCallback = e => {\n        const {\n          clientX: x,\n          clientY: y\n        } = e;\n        const [tx, ty] = this.screenToPageTranslation(x - this.#prevDragX, y - this.#prevDragY);\n        this.#prevDragX = x;\n        this.#prevDragY = y;\n\n        this._uiManager.dragSelectedEditors(tx, ty);\n      };\n\n      window.addEventListener(\"pointermove\", pointerMoveCallback, {\n        passive: true,\n        capture: true,\n        signal\n      });\n    }\n\n    const pointerUpCallback = () => {\n      ac.abort();\n\n      if (isSelected) {\n        this.div.classList.remove(\"moving\");\n      }\n\n      this.#hasBeenClicked = false;\n\n      if (!this._uiManager.endDragSession()) {\n        this.#selectOnPointerEvent(event);\n      }\n    };\n\n    window.addEventListener(\"pointerup\", pointerUpCallback, {\n      signal\n    });\n    window.addEventListener(\"blur\", pointerUpCallback, {\n      signal\n    });\n  }\n\n  moveInDOM() {\n    if (this.#moveInDOMTimeout) {\n      clearTimeout(this.#moveInDOMTimeout);\n    }\n\n    this.#moveInDOMTimeout = setTimeout(() => {\n      this.#moveInDOMTimeout = null;\n      this.parent?.moveEditorInDOM(this);\n    }, 0);\n  }\n\n  _setParentAndPosition(parent, x, y) {\n    parent.changeParent(this);\n    this.x = x;\n    this.y = y;\n    this.fixAndSetPosition();\n  }\n\n  getRect(tx, ty, rotation = this.rotation) {\n    const scale = this.parentScale;\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    const [pageX, pageY] = this.pageTranslation;\n    const shiftX = tx / scale;\n    const shiftY = ty / scale;\n    const x = this.x * pageWidth;\n    const y = this.y * pageHeight;\n    const width = this.width * pageWidth;\n    const height = this.height * pageHeight;\n\n    switch (rotation) {\n      case 0:\n        return [x + shiftX + pageX, pageHeight - y - shiftY - height + pageY, x + shiftX + width + pageX, pageHeight - y - shiftY + pageY];\n\n      case 90:\n        return [x + shiftY + pageX, pageHeight - y + shiftX + pageY, x + shiftY + height + pageX, pageHeight - y + shiftX + width + pageY];\n\n      case 180:\n        return [x - shiftX - width + pageX, pageHeight - y + shiftY + pageY, x - shiftX + pageX, pageHeight - y + shiftY + height + pageY];\n\n      case 270:\n        return [x - shiftY - height + pageX, pageHeight - y - shiftX - width + pageY, x - shiftY + pageX, pageHeight - y - shiftX + pageY];\n\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n  }\n\n  getRectInCurrentCoords(rect, pageHeight) {\n    const [x1, y1, x2, y2] = rect;\n    const width = x2 - x1;\n    const height = y2 - y1;\n\n    switch (this.rotation) {\n      case 0:\n        return [x1, pageHeight - y2, width, height];\n\n      case 90:\n        return [x1, pageHeight - y1, height, width];\n\n      case 180:\n        return [x2, pageHeight - y1, width, height];\n\n      case 270:\n        return [x2, pageHeight - y2, height, width];\n\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n  }\n\n  onceAdded() {}\n\n  isEmpty() {\n    return false;\n  }\n\n  enableEditMode() {\n    this.#isInEditMode = true;\n  }\n\n  disableEditMode() {\n    this.#isInEditMode = false;\n  }\n\n  isInEditMode() {\n    return this.#isInEditMode;\n  }\n\n  shouldGetKeyboardEvents() {\n    return this.#isResizerEnabledForKeyboard;\n  }\n\n  needsToBeRebuilt() {\n    return this.div && !this.isAttachedToDOM;\n  }\n\n  #addFocusListeners() {\n    if (this.#focusAC || !this.div) {\n      return;\n    }\n\n    this.#focusAC = new AbortController();\n\n    const signal = this._uiManager.combinedSignal(this.#focusAC);\n\n    this.div.addEventListener(\"focusin\", this.focusin.bind(this), {\n      signal\n    });\n    this.div.addEventListener(\"focusout\", this.focusout.bind(this), {\n      signal\n    });\n  }\n\n  rebuild() {\n    this.#addFocusListeners();\n  }\n\n  rotate(_angle) {}\n\n  serialize(isForCopying = false, context = null) {\n    unreachable(\"An editor must be serializable\");\n  }\n\n  static deserialize(data, parent, uiManager) {\n    const editor = new this.prototype.constructor({\n      parent,\n      id: parent.getNextId(),\n      uiManager\n    });\n    editor.rotation = data.rotation;\n    editor.#accessibilityData = data.accessibilityData;\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    const [x, y, width, height] = editor.getRectInCurrentCoords(data.rect, pageHeight);\n    editor.x = x / pageWidth;\n    editor.y = y / pageHeight;\n    editor.width = width / pageWidth;\n    editor.height = height / pageHeight;\n    return editor;\n  }\n\n  get hasBeenModified() {\n    return !!this.annotationElementId && (this.deleted || this.serialize() !== null);\n  }\n\n  remove() {\n    this.#focusAC?.abort();\n    this.#focusAC = null;\n\n    if (!this.isEmpty()) {\n      this.commit();\n    }\n\n    if (this.parent) {\n      this.parent.remove(this);\n    } else {\n      this._uiManager.removeEditor(this);\n    }\n\n    if (this.#moveInDOMTimeout) {\n      clearTimeout(this.#moveInDOMTimeout);\n      this.#moveInDOMTimeout = null;\n    }\n\n    this.#stopResizing();\n    this.removeEditToolbar();\n\n    if (this.#telemetryTimeouts) {\n      for (const timeout of this.#telemetryTimeouts.values()) {\n        clearTimeout(timeout);\n      }\n\n      this.#telemetryTimeouts = null;\n    }\n\n    this.parent = null;\n  }\n\n  get isResizable() {\n    return false;\n  }\n\n  makeResizable() {\n    if (this.isResizable) {\n      this.#createResizers();\n      this.#resizersDiv.classList.remove(\"hidden\");\n      bindEvents(this, this.div, [\"keydown\"]);\n    }\n  }\n\n  get toolbarPosition() {\n    return null;\n  }\n\n  keydown(event) {\n    if (!this.isResizable || event.target !== this.div || event.key !== \"Enter\") {\n      return;\n    }\n\n    this._uiManager.setSelected(this);\n\n    this.#savedDimensions = {\n      savedX: this.x,\n      savedY: this.y,\n      savedWidth: this.width,\n      savedHeight: this.height\n    };\n    const children = this.#resizersDiv.children;\n\n    if (!this.#allResizerDivs) {\n      this.#allResizerDivs = Array.from(children);\n      const boundResizerKeydown = this.#resizerKeydown.bind(this);\n      const boundResizerBlur = this.#resizerBlur.bind(this);\n      const signal = this._uiManager._signal;\n\n      for (const div of this.#allResizerDivs) {\n        const name = div.getAttribute(\"data-resizer-name\");\n        div.setAttribute(\"role\", \"spinbutton\");\n        div.addEventListener(\"keydown\", boundResizerKeydown, {\n          signal\n        });\n        div.addEventListener(\"blur\", boundResizerBlur, {\n          signal\n        });\n        div.addEventListener(\"focus\", this.#resizerFocus.bind(this, name), {\n          signal\n        });\n        div.setAttribute(\"data-l10n-id\", AnnotationEditor._l10nResizer[name]);\n      }\n    }\n\n    const first = this.#allResizerDivs[0];\n    let firstPosition = 0;\n\n    for (const div of children) {\n      if (div === first) {\n        break;\n      }\n\n      firstPosition++;\n    }\n\n    const nextFirstPosition = (360 - this.rotation + this.parentRotation) % 360 / 90 * (this.#allResizerDivs.length / 4);\n\n    if (nextFirstPosition !== firstPosition) {\n      if (nextFirstPosition < firstPosition) {\n        for (let i = 0; i < firstPosition - nextFirstPosition; i++) {\n          this.#resizersDiv.append(this.#resizersDiv.firstChild);\n        }\n      } else if (nextFirstPosition > firstPosition) {\n        for (let i = 0; i < nextFirstPosition - firstPosition; i++) {\n          this.#resizersDiv.firstChild.before(this.#resizersDiv.lastChild);\n        }\n      }\n\n      let i = 0;\n\n      for (const child of children) {\n        const div = this.#allResizerDivs[i++];\n        const name = div.getAttribute(\"data-resizer-name\");\n        child.setAttribute(\"data-l10n-id\", AnnotationEditor._l10nResizer[name]);\n      }\n    }\n\n    this.#setResizerTabIndex(0);\n    this.#isResizerEnabledForKeyboard = true;\n    this.#resizersDiv.firstChild.focus({\n      focusVisible: true\n    });\n    event.preventDefault();\n    event.stopImmediatePropagation();\n  }\n\n  #resizerKeydown(event) {\n    AnnotationEditor._resizerKeyboardManager.exec(this, event);\n  }\n\n  #resizerBlur(event) {\n    if (this.#isResizerEnabledForKeyboard && event.relatedTarget?.parentNode !== this.#resizersDiv) {\n      this.#stopResizing();\n    }\n  }\n\n  #resizerFocus(name) {\n    this.#focusedResizerName = this.#isResizerEnabledForKeyboard ? name : \"\";\n  }\n\n  #setResizerTabIndex(value) {\n    if (!this.#allResizerDivs) {\n      return;\n    }\n\n    for (const div of this.#allResizerDivs) {\n      div.tabIndex = value;\n    }\n  }\n\n  _resizeWithKeyboard(x, y) {\n    if (!this.#isResizerEnabledForKeyboard) {\n      return;\n    }\n\n    this.#resizerPointermove(this.#focusedResizerName, {\n      movementX: x,\n      movementY: y\n    });\n  }\n\n  #stopResizing() {\n    this.#isResizerEnabledForKeyboard = false;\n    this.#setResizerTabIndex(-1);\n\n    if (this.#savedDimensions) {\n      const {\n        savedX,\n        savedY,\n        savedWidth,\n        savedHeight\n      } = this.#savedDimensions;\n      this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n      this.#savedDimensions = null;\n    }\n  }\n\n  _stopResizingWithKeyboard() {\n    this.#stopResizing();\n    this.div.focus();\n  }\n\n  select() {\n    this.makeResizable();\n    this.div?.classList.add(\"selectedEditor\");\n\n    if (!this._editToolbar) {\n      this.addEditToolbar().then(() => {\n        if (this.div?.classList.contains(\"selectedEditor\")) {\n          this._editToolbar?.show();\n        }\n      });\n      return;\n    }\n\n    this._editToolbar?.show();\n    this.#altText?.toggleAltTextBadge(false);\n  }\n\n  unselect() {\n    this.#resizersDiv?.classList.add(\"hidden\");\n    this.div?.classList.remove(\"selectedEditor\");\n\n    if (this.div?.contains(document.activeElement)) {\n      this._uiManager.currentLayer.div.focus({\n        preventScroll: true\n      });\n    }\n\n    this._editToolbar?.hide();\n    this.#altText?.toggleAltTextBadge(true);\n  }\n\n  updateParams(type, value) {}\n\n  disableEditing() {}\n\n  enableEditing() {}\n\n  enterInEditMode() {}\n\n  getImageForAltText() {\n    return null;\n  }\n\n  get contentDiv() {\n    return this.div;\n  }\n\n  get isEditing() {\n    return this.#isEditing;\n  }\n\n  set isEditing(value) {\n    this.#isEditing = value;\n\n    if (!this.parent) {\n      return;\n    }\n\n    if (value) {\n      this.parent.setSelected(this);\n      this.parent.setActiveEditor(this);\n    } else {\n      this.parent.setActiveEditor(null);\n    }\n  }\n\n  setAspectRatio(width, height) {\n    this.#keepAspectRatio = true;\n    const aspectRatio = width / height;\n    const {\n      style\n    } = this.div;\n    style.aspectRatio = aspectRatio;\n    style.height = \"auto\";\n  }\n\n  static get MIN_SIZE() {\n    return 16;\n  }\n\n  static canCreateNewEmptyEditor() {\n    return true;\n  }\n\n  get telemetryInitialData() {\n    return {\n      action: \"added\"\n    };\n  }\n\n  get telemetryFinalData() {\n    return null;\n  }\n\n  _reportTelemetry(data, mustWait = false) {\n    if (mustWait) {\n      this.#telemetryTimeouts ||= new Map();\n      const {\n        action\n      } = data;\n      let timeout = this.#telemetryTimeouts.get(action);\n\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n\n      timeout = setTimeout(() => {\n        this._reportTelemetry(data);\n\n        this.#telemetryTimeouts.delete(action);\n\n        if (this.#telemetryTimeouts.size === 0) {\n          this.#telemetryTimeouts = null;\n        }\n      }, AnnotationEditor._telemetryTimeout);\n      this.#telemetryTimeouts.set(action, timeout);\n      return;\n    }\n\n    data.type ||= this.editorType;\n\n    this._uiManager._eventBus.dispatch(\"reporttelemetry\", {\n      source: this,\n      details: {\n        type: \"editing\",\n        data\n      }\n    });\n  }\n\n  show(visible = this._isVisible) {\n    this.div.classList.toggle(\"hidden\", !visible);\n    this._isVisible = visible;\n  }\n\n  enable() {\n    if (this.div) {\n      this.div.tabIndex = 0;\n    }\n\n    this.#disabled = false;\n  }\n\n  disable() {\n    if (this.div) {\n      this.div.tabIndex = -1;\n    }\n\n    this.#disabled = true;\n  }\n\n  renderAnnotationElement(annotation) {\n    let content = annotation.container.querySelector(\".annotationContent\");\n\n    if (!content) {\n      content = document.createElement(\"div\");\n      content.classList.add(\"annotationContent\", this.editorType);\n      annotation.container.prepend(content);\n    } else if (content.nodeName === \"CANVAS\") {\n      const canvas = content;\n      content = document.createElement(\"div\");\n      content.classList.add(\"annotationContent\", this.editorType);\n      canvas.before(content);\n    }\n\n    return content;\n  }\n\n  resetAnnotationElement(annotation) {\n    const {\n      firstChild\n    } = annotation.container;\n\n    if (firstChild.nodeName === \"DIV\" && firstChild.classList.contains(\"annotationContent\")) {\n      firstChild.remove();\n    }\n  }\n\n}\n\nclass FakeEditor extends AnnotationEditor {\n  constructor(params) {\n    super(params);\n    this.annotationElementId = params.annotationElementId;\n    this.deleted = true;\n  }\n\n  serialize() {\n    return {\n      id: this.annotationElementId,\n      deleted: true,\n      pageIndex: this.pageIndex\n    };\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/shared/murmurhash3.js\n\nconst SEED = 0xc3d2e1f0;\nconst MASK_HIGH = 0xffff0000;\nconst MASK_LOW = 0xffff;\n\nclass MurmurHash3_64 {\n  constructor(seed) {\n    this.h1 = seed ? seed & 0xffffffff : SEED;\n    this.h2 = seed ? seed & 0xffffffff : SEED;\n  }\n\n  update(input) {\n    let data, length;\n\n    if (typeof input === \"string\") {\n      data = new Uint8Array(input.length * 2);\n      length = 0;\n\n      for (let i = 0, ii = input.length; i < ii; i++) {\n        const code = input.charCodeAt(i);\n\n        if (code <= 0xff) {\n          data[length++] = code;\n        } else {\n          data[length++] = code >>> 8;\n          data[length++] = code & 0xff;\n        }\n      }\n    } else if (ArrayBuffer.isView(input)) {\n      data = input.slice();\n      length = data.byteLength;\n    } else {\n      throw new Error(\"Invalid data format, must be a string or TypedArray.\");\n    }\n\n    const blockCounts = length >> 2;\n    const tailLength = length - blockCounts * 4;\n    const dataUint32 = new Uint32Array(data.buffer, 0, blockCounts);\n    let k1 = 0,\n        k2 = 0;\n    let h1 = this.h1,\n        h2 = this.h2;\n    const C1 = 0xcc9e2d51,\n          C2 = 0x1b873593;\n    const C1_LOW = C1 & MASK_LOW,\n          C2_LOW = C2 & MASK_LOW;\n\n    for (let i = 0; i < blockCounts; i++) {\n      if (i & 1) {\n        k1 = dataUint32[i];\n        k1 = k1 * C1 & MASK_HIGH | k1 * C1_LOW & MASK_LOW;\n        k1 = k1 << 15 | k1 >>> 17;\n        k1 = k1 * C2 & MASK_HIGH | k1 * C2_LOW & MASK_LOW;\n        h1 ^= k1;\n        h1 = h1 << 13 | h1 >>> 19;\n        h1 = h1 * 5 + 0xe6546b64;\n      } else {\n        k2 = dataUint32[i];\n        k2 = k2 * C1 & MASK_HIGH | k2 * C1_LOW & MASK_LOW;\n        k2 = k2 << 15 | k2 >>> 17;\n        k2 = k2 * C2 & MASK_HIGH | k2 * C2_LOW & MASK_LOW;\n        h2 ^= k2;\n        h2 = h2 << 13 | h2 >>> 19;\n        h2 = h2 * 5 + 0xe6546b64;\n      }\n    }\n\n    k1 = 0;\n\n    switch (tailLength) {\n      case 3:\n        k1 ^= data[blockCounts * 4 + 2] << 16;\n\n      case 2:\n        k1 ^= data[blockCounts * 4 + 1] << 8;\n\n      case 1:\n        k1 ^= data[blockCounts * 4];\n        k1 = k1 * C1 & MASK_HIGH | k1 * C1_LOW & MASK_LOW;\n        k1 = k1 << 15 | k1 >>> 17;\n        k1 = k1 * C2 & MASK_HIGH | k1 * C2_LOW & MASK_LOW;\n\n        if (blockCounts & 1) {\n          h1 ^= k1;\n        } else {\n          h2 ^= k1;\n        }\n\n    }\n\n    this.h1 = h1;\n    this.h2 = h2;\n  }\n\n  hexdigest() {\n    let h1 = this.h1,\n        h2 = this.h2;\n    h1 ^= h2 >>> 1;\n    h1 = h1 * 0xed558ccd & MASK_HIGH | h1 * 0x8ccd & MASK_LOW;\n    h2 = h2 * 0xff51afd7 & MASK_HIGH | ((h2 << 16 | h1 >>> 16) * 0xafd7ed55 & MASK_HIGH) >>> 16;\n    h1 ^= h2 >>> 1;\n    h1 = h1 * 0x1a85ec53 & MASK_HIGH | h1 * 0xec53 & MASK_LOW;\n    h2 = h2 * 0xc4ceb9fe & MASK_HIGH | ((h2 << 16 | h1 >>> 16) * 0xb9fe1a85 & MASK_HIGH) >>> 16;\n    h1 ^= h2 >>> 1;\n    return (h1 >>> 0).toString(16).padStart(8, \"0\") + (h2 >>> 0).toString(16).padStart(8, \"0\");\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/annotation_storage.js\n\nconst SerializableEmpty = Object.freeze({\n  map: null,\n  hash: \"\",\n  transfer: undefined\n});\n\nclass AnnotationStorage {\n  #modified = false;\n  #modifiedIds = null;\n  #storage = new Map();\n\n  constructor() {\n    this.onSetModified = null;\n    this.onResetModified = null;\n    this.onAnnotationEditor = null;\n  }\n\n  getValue(key, defaultValue) {\n    const value = this.#storage.get(key);\n\n    if (value === undefined) {\n      return defaultValue;\n    }\n\n    return Object.assign(defaultValue, value);\n  }\n\n  getRawValue(key) {\n    return this.#storage.get(key);\n  }\n\n  remove(key) {\n    this.#storage.delete(key);\n\n    if (this.#storage.size === 0) {\n      this.resetModified();\n    }\n\n    if (typeof this.onAnnotationEditor === \"function\") {\n      for (const value of this.#storage.values()) {\n        if (value instanceof AnnotationEditor) {\n          return;\n        }\n      }\n\n      this.onAnnotationEditor(null);\n    }\n  }\n\n  setValue(key, value) {\n    const obj = this.#storage.get(key);\n    let modified = false;\n\n    if (obj !== undefined) {\n      for (const [entry, val] of Object.entries(value)) {\n        if (obj[entry] !== val) {\n          modified = true;\n          obj[entry] = val;\n        }\n      }\n    } else {\n      modified = true;\n      this.#storage.set(key, value);\n    }\n\n    if (modified) {\n      this.#setModified();\n    }\n\n    if (value instanceof AnnotationEditor && typeof this.onAnnotationEditor === \"function\") {\n      this.onAnnotationEditor(value.constructor._type);\n    }\n  }\n\n  has(key) {\n    return this.#storage.has(key);\n  }\n\n  getAll() {\n    return this.#storage.size > 0 ? objectFromMap(this.#storage) : null;\n  }\n\n  setAll(obj) {\n    for (const [key, val] of Object.entries(obj)) {\n      this.setValue(key, val);\n    }\n  }\n\n  get size() {\n    return this.#storage.size;\n  }\n\n  #setModified() {\n    if (!this.#modified) {\n      this.#modified = true;\n\n      if (typeof this.onSetModified === \"function\") {\n        this.onSetModified();\n      }\n    }\n  }\n\n  resetModified() {\n    if (this.#modified) {\n      this.#modified = false;\n\n      if (typeof this.onResetModified === \"function\") {\n        this.onResetModified();\n      }\n    }\n  }\n\n  get print() {\n    return new PrintAnnotationStorage(this);\n  }\n\n  get serializable() {\n    if (this.#storage.size === 0) {\n      return SerializableEmpty;\n    }\n\n    const map = new Map(),\n          hash = new MurmurHash3_64(),\n          transfer = [];\n    const context = Object.create(null);\n    let hasBitmap = false;\n\n    for (const [key, val] of this.#storage) {\n      const serialized = val instanceof AnnotationEditor ? val.serialize(false, context) : val;\n\n      if (serialized) {\n        map.set(key, serialized);\n        hash.update(`${key}:${JSON.stringify(serialized)}`);\n        hasBitmap ||= !!serialized.bitmap;\n      }\n    }\n\n    if (hasBitmap) {\n      for (const value of map.values()) {\n        if (value.bitmap) {\n          transfer.push(value.bitmap);\n        }\n      }\n    }\n\n    return map.size > 0 ? {\n      map,\n      hash: hash.hexdigest(),\n      transfer\n    } : SerializableEmpty;\n  }\n\n  get editorStats() {\n    let stats = null;\n    const typeToEditor = new Map();\n\n    for (const value of this.#storage.values()) {\n      if (!(value instanceof AnnotationEditor)) {\n        continue;\n      }\n\n      const editorStats = value.telemetryFinalData;\n\n      if (!editorStats) {\n        continue;\n      }\n\n      const {\n        type\n      } = editorStats;\n\n      if (!typeToEditor.has(type)) {\n        typeToEditor.set(type, Object.getPrototypeOf(value).constructor);\n      }\n\n      stats ||= Object.create(null);\n      const map = stats[type] ||= new Map();\n\n      for (const [key, val] of Object.entries(editorStats)) {\n        if (key === \"type\") {\n          continue;\n        }\n\n        let counters = map.get(key);\n\n        if (!counters) {\n          counters = new Map();\n          map.set(key, counters);\n        }\n\n        const count = counters.get(val) ?? 0;\n        counters.set(val, count + 1);\n      }\n    }\n\n    for (const [type, editor] of typeToEditor) {\n      stats[type] = editor.computeTelemetryFinalData(stats[type]);\n    }\n\n    return stats;\n  }\n\n  resetModifiedIds() {\n    this.#modifiedIds = null;\n  }\n\n  get modifiedIds() {\n    if (this.#modifiedIds) {\n      return this.#modifiedIds;\n    }\n\n    const ids = [];\n\n    for (const value of this.#storage.values()) {\n      if (!(value instanceof AnnotationEditor) || !value.annotationElementId || !value.serialize()) {\n        continue;\n      }\n\n      ids.push(value.annotationElementId);\n    }\n\n    return this.#modifiedIds = {\n      ids: new Set(ids),\n      hash: ids.join(\",\")\n    };\n  }\n\n}\n\nclass PrintAnnotationStorage extends AnnotationStorage {\n  #serializable;\n\n  constructor(parent) {\n    super();\n    const {\n      map,\n      hash,\n      transfer\n    } = parent.serializable;\n    const clone = structuredClone(map, transfer ? {\n      transfer\n    } : null);\n    this.#serializable = {\n      map: clone,\n      hash,\n      transfer\n    };\n  }\n\n  get print() {\n    unreachable(\"Should not call PrintAnnotationStorage.print\");\n  }\n\n  get serializable() {\n    return this.#serializable;\n  }\n\n  get modifiedIds() {\n    return shadow(this, \"modifiedIds\", {\n      ids: new Set(),\n      hash: \"\"\n    });\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/font_loader.js\n\nclass FontLoader {\n  #systemFonts = new Set();\n\n  constructor({\n    ownerDocument = globalThis.document,\n    styleElement = null\n  }) {\n    this._document = ownerDocument;\n    this.nativeFontFaces = new Set();\n    this.styleElement = null;\n    this.loadingRequests = [];\n    this.loadTestFontId = 0;\n  }\n\n  addNativeFontFace(nativeFontFace) {\n    this.nativeFontFaces.add(nativeFontFace);\n\n    this._document.fonts.add(nativeFontFace);\n  }\n\n  removeNativeFontFace(nativeFontFace) {\n    this.nativeFontFaces.delete(nativeFontFace);\n\n    this._document.fonts.delete(nativeFontFace);\n  }\n\n  insertRule(rule) {\n    if (!this.styleElement) {\n      this.styleElement = this._document.createElement(\"style\");\n\n      this._document.documentElement.getElementsByTagName(\"head\")[0].append(this.styleElement);\n    }\n\n    const styleSheet = this.styleElement.sheet;\n    styleSheet.insertRule(rule, styleSheet.cssRules.length);\n  }\n\n  clear() {\n    for (const nativeFontFace of this.nativeFontFaces) {\n      this._document.fonts.delete(nativeFontFace);\n    }\n\n    this.nativeFontFaces.clear();\n    this.#systemFonts.clear();\n\n    if (this.styleElement) {\n      this.styleElement.remove();\n      this.styleElement = null;\n    }\n  }\n\n  loadSystemFont({\n    systemFontInfo: info,\n    _inspectFont\n  }) {\n    var _this14 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!info || _this14.#systemFonts.has(info.loadedName)) {\n        return;\n      }\n\n      assert(!_this14.disableFontFace, \"loadSystemFont shouldn't be called when `disableFontFace` is set.\");\n\n      if (_this14.isFontLoadingAPISupported) {\n        const {\n          loadedName,\n          src,\n          style\n        } = info;\n        const fontFace = new FontFace(loadedName, src, style);\n\n        _this14.addNativeFontFace(fontFace);\n\n        try {\n          yield fontFace.load();\n\n          _this14.#systemFonts.add(loadedName);\n\n          _inspectFont?.(info);\n        } catch {\n          warn(`Cannot load system font: ${info.baseFontName}, installing it could help to improve PDF rendering.`);\n\n          _this14.removeNativeFontFace(fontFace);\n        }\n\n        return;\n      }\n\n      unreachable(\"Not implemented: loadSystemFont without the Font Loading API.\");\n    })();\n  }\n\n  bind(font) {\n    var _this15 = this;\n\n    return _asyncToGenerator(function* () {\n      if (font.attached || font.missingFile && !font.systemFontInfo) {\n        return;\n      }\n\n      font.attached = true;\n\n      if (font.systemFontInfo) {\n        yield _this15.loadSystemFont(font);\n        return;\n      }\n\n      if (_this15.isFontLoadingAPISupported) {\n        const nativeFontFace = font.createNativeFontFace();\n\n        if (nativeFontFace) {\n          _this15.addNativeFontFace(nativeFontFace);\n\n          try {\n            yield nativeFontFace.loaded;\n          } catch (ex) {\n            warn(`Failed to load font '${nativeFontFace.family}': '${ex}'.`);\n            font.disableFontFace = true;\n            throw ex;\n          }\n        }\n\n        return;\n      }\n\n      const rule = font.createFontFaceRule();\n\n      if (rule) {\n        _this15.insertRule(rule);\n\n        if (_this15.isSyncFontLoadingSupported) {\n          return;\n        }\n\n        yield new Promise(resolve => {\n          const request = _this15._queueLoadingCallback(resolve);\n\n          _this15._prepareFontLoadEvent(font, request);\n        });\n      }\n    })();\n  }\n\n  get isFontLoadingAPISupported() {\n    const hasFonts = !!this._document?.fonts;\n    return shadow(this, \"isFontLoadingAPISupported\", hasFonts);\n  }\n\n  get isSyncFontLoadingSupported() {\n    let supported = false;\n\n    if (isNodeJS) {\n      supported = true;\n    } else if (typeof navigator !== \"undefined\" && typeof navigator?.userAgent === \"string\" && /Mozilla\\/5.0.*?rv:\\d+.*? Gecko/.test(navigator.userAgent)) {\n      supported = true;\n    }\n\n    return shadow(this, \"isSyncFontLoadingSupported\", supported);\n  }\n\n  _queueLoadingCallback(callback) {\n    function completeRequest() {\n      assert(!request.done, \"completeRequest() cannot be called twice.\");\n      request.done = true;\n\n      while (loadingRequests.length > 0 && loadingRequests[0].done) {\n        const otherRequest = loadingRequests.shift();\n        setTimeout(otherRequest.callback, 0);\n      }\n    }\n\n    const {\n      loadingRequests\n    } = this;\n    const request = {\n      done: false,\n      complete: completeRequest,\n      callback\n    };\n    loadingRequests.push(request);\n    return request;\n  }\n\n  get _loadTestFont() {\n    const testFont = atob(\"T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQA\" + \"FQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAA\" + \"ALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgA\" + \"AAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1\" + \"AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD\" + \"6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACM\" + \"AooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4D\" + \"IP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAA\" + \"AAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUA\" + \"AQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgAB\" + \"AAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABY\" + \"AAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAA\" + \"AC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAA\" + \"AAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQAC\" + \"AQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3\" + \"Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTj\" + \"FQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==\");\n    return shadow(this, \"_loadTestFont\", testFont);\n  }\n\n  _prepareFontLoadEvent(font, request) {\n    function int32(data, offset) {\n      return data.charCodeAt(offset) << 24 | data.charCodeAt(offset + 1) << 16 | data.charCodeAt(offset + 2) << 8 | data.charCodeAt(offset + 3) & 0xff;\n    }\n\n    function spliceString(s, offset, remove, insert) {\n      const chunk1 = s.substring(0, offset);\n      const chunk2 = s.substring(offset + remove);\n      return chunk1 + insert + chunk2;\n    }\n\n    let i, ii;\n\n    const canvas = this._document.createElement(\"canvas\");\n\n    canvas.width = 1;\n    canvas.height = 1;\n    const ctx = canvas.getContext(\"2d\");\n    let called = 0;\n\n    function isFontReady(name, callback) {\n      if (++called > 30) {\n        warn(\"Load test font never loaded.\");\n        callback();\n        return;\n      }\n\n      ctx.font = \"30px \" + name;\n      ctx.fillText(\".\", 0, 20);\n      const imageData = ctx.getImageData(0, 0, 1, 1);\n\n      if (imageData.data[3] > 0) {\n        callback();\n        return;\n      }\n\n      setTimeout(isFontReady.bind(null, name, callback));\n    }\n\n    const loadTestFontId = `lt${Date.now()}${this.loadTestFontId++}`;\n    let data = this._loadTestFont;\n    const COMMENT_OFFSET = 976;\n    data = spliceString(data, COMMENT_OFFSET, loadTestFontId.length, loadTestFontId);\n    const CFF_CHECKSUM_OFFSET = 16;\n    const XXXX_VALUE = 0x58585858;\n    let checksum = int32(data, CFF_CHECKSUM_OFFSET);\n\n    for (i = 0, ii = loadTestFontId.length - 3; i < ii; i += 4) {\n      checksum = checksum - XXXX_VALUE + int32(loadTestFontId, i) | 0;\n    }\n\n    if (i < loadTestFontId.length) {\n      checksum = checksum - XXXX_VALUE + int32(loadTestFontId + \"XXX\", i) | 0;\n    }\n\n    data = spliceString(data, CFF_CHECKSUM_OFFSET, 4, string32(checksum));\n    const url = `url(data:font/opentype;base64,${btoa(data)});`;\n    const rule = `@font-face {font-family:\"${loadTestFontId}\";src:${url}}`;\n    this.insertRule(rule);\n\n    const div = this._document.createElement(\"div\");\n\n    div.style.visibility = \"hidden\";\n    div.style.width = div.style.height = \"10px\";\n    div.style.position = \"absolute\";\n    div.style.top = div.style.left = \"0px\";\n\n    for (const name of [font.loadedName, loadTestFontId]) {\n      const span = this._document.createElement(\"span\");\n\n      span.textContent = \"Hi\";\n      span.style.fontFamily = name;\n      div.append(span);\n    }\n\n    this._document.body.append(div);\n\n    isFontReady(loadTestFontId, () => {\n      div.remove();\n      request.complete();\n    });\n  }\n\n}\n\nclass FontFaceObject {\n  constructor(translatedData, {\n    disableFontFace = false,\n    inspectFont = null\n  }) {\n    this.compiledGlyphs = Object.create(null);\n\n    for (const i in translatedData) {\n      this[i] = translatedData[i];\n    }\n\n    this.disableFontFace = disableFontFace === true;\n    this._inspectFont = inspectFont;\n  }\n\n  createNativeFontFace() {\n    if (!this.data || this.disableFontFace) {\n      return null;\n    }\n\n    let nativeFontFace;\n\n    if (!this.cssFontInfo) {\n      nativeFontFace = new FontFace(this.loadedName, this.data, {});\n    } else {\n      const css = {\n        weight: this.cssFontInfo.fontWeight\n      };\n\n      if (this.cssFontInfo.italicAngle) {\n        css.style = `oblique ${this.cssFontInfo.italicAngle}deg`;\n      }\n\n      nativeFontFace = new FontFace(this.cssFontInfo.fontFamily, this.data, css);\n    }\n\n    this._inspectFont?.(this);\n    return nativeFontFace;\n  }\n\n  createFontFaceRule() {\n    if (!this.data || this.disableFontFace) {\n      return null;\n    }\n\n    const data = bytesToString(this.data);\n    const url = `url(data:${this.mimetype};base64,${btoa(data)});`;\n    let rule;\n\n    if (!this.cssFontInfo) {\n      rule = `@font-face {font-family:\"${this.loadedName}\";src:${url}}`;\n    } else {\n      let css = `font-weight: ${this.cssFontInfo.fontWeight};`;\n\n      if (this.cssFontInfo.italicAngle) {\n        css += `font-style: oblique ${this.cssFontInfo.italicAngle}deg;`;\n      }\n\n      rule = `@font-face {font-family:\"${this.cssFontInfo.fontFamily}\";${css}src:${url}}`;\n    }\n\n    this._inspectFont?.(this, url);\n    return rule;\n  }\n\n  getPathGenerator(objs, character) {\n    if (this.compiledGlyphs[character] !== undefined) {\n      return this.compiledGlyphs[character];\n    }\n\n    let cmds;\n\n    try {\n      cmds = objs.get(this.loadedName + \"_path_\" + character);\n    } catch (ex) {\n      warn(`getPathGenerator - ignoring character: \"${ex}\".`);\n    }\n\n    if (!Array.isArray(cmds) || cmds.length === 0) {\n      return this.compiledGlyphs[character] = function (c, size) {};\n    }\n\n    const commands = [];\n\n    for (let i = 0, ii = cmds.length; i < ii;) {\n      switch (cmds[i++]) {\n        case FontRenderOps.BEZIER_CURVE_TO:\n          {\n            const [a, b, c, d, e, f] = cmds.slice(i, i + 6);\n            commands.push(ctx => ctx.bezierCurveTo(a, b, c, d, e, f));\n            i += 6;\n          }\n          break;\n\n        case FontRenderOps.MOVE_TO:\n          {\n            const [a, b] = cmds.slice(i, i + 2);\n            commands.push(ctx => ctx.moveTo(a, b));\n            i += 2;\n          }\n          break;\n\n        case FontRenderOps.LINE_TO:\n          {\n            const [a, b] = cmds.slice(i, i + 2);\n            commands.push(ctx => ctx.lineTo(a, b));\n            i += 2;\n          }\n          break;\n\n        case FontRenderOps.QUADRATIC_CURVE_TO:\n          {\n            const [a, b, c, d] = cmds.slice(i, i + 4);\n            commands.push(ctx => ctx.quadraticCurveTo(a, b, c, d));\n            i += 4;\n          }\n          break;\n\n        case FontRenderOps.RESTORE:\n          commands.push(ctx => ctx.restore());\n          break;\n\n        case FontRenderOps.SAVE:\n          commands.push(ctx => ctx.save());\n          break;\n\n        case FontRenderOps.SCALE:\n          assert(commands.length === 2, \"Scale command is only valid at the third position.\");\n          break;\n\n        case FontRenderOps.TRANSFORM:\n          {\n            const [a, b, c, d, e, f] = cmds.slice(i, i + 6);\n            commands.push(ctx => ctx.transform(a, b, c, d, e, f));\n            i += 6;\n          }\n          break;\n\n        case FontRenderOps.TRANSLATE:\n          {\n            const [a, b] = cmds.slice(i, i + 2);\n            commands.push(ctx => ctx.translate(a, b));\n            i += 2;\n          }\n          break;\n      }\n    }\n\n    return this.compiledGlyphs[character] = function glyphDrawer(ctx, size) {\n      commands[0](ctx);\n      commands[1](ctx);\n      ctx.scale(size, -size);\n\n      for (let i = 2, ii = commands.length; i < ii; i++) {\n        commands[i](ctx);\n      }\n    };\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/node_utils.js\n\nif (isNodeJS) {\n  var packageCapability = Promise.withResolvers();\n  var packageMap = null;\n\n  const loadPackages = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      const fs = yield import(\n      /*webpackIgnore: true*/\n      \"fs\"),\n            http = yield import(\n      /*webpackIgnore: true*/\n      \"http\"),\n            https = yield import(\n      /*webpackIgnore: true*/\n      \"https\"),\n            url = yield import(\n      /*webpackIgnore: true*/\n      \"url\");\n      let canvas, path2d;\n      return new Map(Object.entries({\n        fs,\n        http,\n        https,\n        url,\n        canvas,\n        path2d\n      }));\n    });\n\n    return function loadPackages() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  loadPackages().then(map => {\n    packageMap = map;\n    packageCapability.resolve();\n  }, reason => {\n    warn(`loadPackages: ${reason}`);\n    packageMap = new Map();\n    packageCapability.resolve();\n  });\n}\n\nclass NodePackages {\n  static get promise() {\n    return packageCapability.promise;\n  }\n\n  static get(name) {\n    return packageMap?.get(name);\n  }\n\n}\n\nconst node_utils_fetchData = function (url) {\n  const fs = NodePackages.get(\"fs\");\n  return fs.promises.readFile(url).then(data => new Uint8Array(data));\n};\n\nclass NodeFilterFactory extends BaseFilterFactory {}\n\nclass NodeCanvasFactory extends BaseCanvasFactory {\n  _createCanvas(width, height) {\n    const canvas = NodePackages.get(\"canvas\");\n    return canvas.createCanvas(width, height);\n  }\n\n}\n\nclass NodeCMapReaderFactory extends BaseCMapReaderFactory {\n  _fetchData(url, compressionType) {\n    return node_utils_fetchData(url).then(data => ({\n      cMapData: data,\n      compressionType\n    }));\n  }\n\n}\n\nclass NodeStandardFontDataFactory extends BaseStandardFontDataFactory {\n  _fetchData(url) {\n    return node_utils_fetchData(url);\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/pattern_helper.js\n\nconst PathType = {\n  FILL: \"Fill\",\n  STROKE: \"Stroke\",\n  SHADING: \"Shading\"\n};\n\nfunction applyBoundingBox(ctx, bbox) {\n  if (!bbox) {\n    return;\n  }\n\n  const width = bbox[2] - bbox[0];\n  const height = bbox[3] - bbox[1];\n  const region = new Path2D();\n  region.rect(bbox[0], bbox[1], width, height);\n  ctx.clip(region);\n}\n\nclass BaseShadingPattern {\n  getPattern() {\n    unreachable(\"Abstract method `getPattern` called.\");\n  }\n\n}\n\nclass RadialAxialShadingPattern extends BaseShadingPattern {\n  constructor(IR) {\n    super();\n    this._type = IR[1];\n    this._bbox = IR[2];\n    this._colorStops = IR[3];\n    this._p0 = IR[4];\n    this._p1 = IR[5];\n    this._r0 = IR[6];\n    this._r1 = IR[7];\n    this.matrix = null;\n  }\n\n  _createGradient(ctx) {\n    let grad;\n\n    if (this._type === \"axial\") {\n      grad = ctx.createLinearGradient(this._p0[0], this._p0[1], this._p1[0], this._p1[1]);\n    } else if (this._type === \"radial\") {\n      grad = ctx.createRadialGradient(this._p0[0], this._p0[1], this._r0, this._p1[0], this._p1[1], this._r1);\n    }\n\n    for (const colorStop of this._colorStops) {\n      grad.addColorStop(colorStop[0], colorStop[1]);\n    }\n\n    return grad;\n  }\n\n  getPattern(ctx, owner, inverse, pathType) {\n    let pattern;\n\n    if (pathType === PathType.STROKE || pathType === PathType.FILL) {\n      const ownerBBox = owner.current.getClippedPathBoundingBox(pathType, getCurrentTransform(ctx)) || [0, 0, 0, 0];\n      const width = Math.ceil(ownerBBox[2] - ownerBBox[0]) || 1;\n      const height = Math.ceil(ownerBBox[3] - ownerBBox[1]) || 1;\n      const tmpCanvas = owner.cachedCanvases.getCanvas(\"pattern\", width, height, true);\n      const tmpCtx = tmpCanvas.context;\n      tmpCtx.clearRect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n      tmpCtx.beginPath();\n      tmpCtx.rect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n      tmpCtx.translate(-ownerBBox[0], -ownerBBox[1]);\n      inverse = Util.transform(inverse, [1, 0, 0, 1, ownerBBox[0], ownerBBox[1]]);\n      tmpCtx.transform(...owner.baseTransform);\n\n      if (this.matrix) {\n        tmpCtx.transform(...this.matrix);\n      }\n\n      applyBoundingBox(tmpCtx, this._bbox);\n      tmpCtx.fillStyle = this._createGradient(tmpCtx);\n      tmpCtx.fill();\n      pattern = ctx.createPattern(tmpCanvas.canvas, \"no-repeat\");\n      const domMatrix = new DOMMatrix(inverse);\n      pattern.setTransform(domMatrix);\n    } else {\n      applyBoundingBox(ctx, this._bbox);\n      pattern = this._createGradient(ctx);\n    }\n\n    return pattern;\n  }\n\n}\n\nfunction drawTriangle(data, context, p1, p2, p3, c1, c2, c3) {\n  const coords = context.coords,\n        colors = context.colors;\n  const bytes = data.data,\n        rowSize = data.width * 4;\n  let tmp;\n\n  if (coords[p1 + 1] > coords[p2 + 1]) {\n    tmp = p1;\n    p1 = p2;\n    p2 = tmp;\n    tmp = c1;\n    c1 = c2;\n    c2 = tmp;\n  }\n\n  if (coords[p2 + 1] > coords[p3 + 1]) {\n    tmp = p2;\n    p2 = p3;\n    p3 = tmp;\n    tmp = c2;\n    c2 = c3;\n    c3 = tmp;\n  }\n\n  if (coords[p1 + 1] > coords[p2 + 1]) {\n    tmp = p1;\n    p1 = p2;\n    p2 = tmp;\n    tmp = c1;\n    c1 = c2;\n    c2 = tmp;\n  }\n\n  const x1 = (coords[p1] + context.offsetX) * context.scaleX;\n  const y1 = (coords[p1 + 1] + context.offsetY) * context.scaleY;\n  const x2 = (coords[p2] + context.offsetX) * context.scaleX;\n  const y2 = (coords[p2 + 1] + context.offsetY) * context.scaleY;\n  const x3 = (coords[p3] + context.offsetX) * context.scaleX;\n  const y3 = (coords[p3 + 1] + context.offsetY) * context.scaleY;\n\n  if (y1 >= y3) {\n    return;\n  }\n\n  const c1r = colors[c1],\n        c1g = colors[c1 + 1],\n        c1b = colors[c1 + 2];\n  const c2r = colors[c2],\n        c2g = colors[c2 + 1],\n        c2b = colors[c2 + 2];\n  const c3r = colors[c3],\n        c3g = colors[c3 + 1],\n        c3b = colors[c3 + 2];\n  const minY = Math.round(y1),\n        maxY = Math.round(y3);\n  let xa, car, cag, cab;\n  let xb, cbr, cbg, cbb;\n\n  for (let y = minY; y <= maxY; y++) {\n    if (y < y2) {\n      const k = y < y1 ? 0 : (y1 - y) / (y1 - y2);\n      xa = x1 - (x1 - x2) * k;\n      car = c1r - (c1r - c2r) * k;\n      cag = c1g - (c1g - c2g) * k;\n      cab = c1b - (c1b - c2b) * k;\n    } else {\n      let k;\n\n      if (y > y3) {\n        k = 1;\n      } else if (y2 === y3) {\n        k = 0;\n      } else {\n        k = (y2 - y) / (y2 - y3);\n      }\n\n      xa = x2 - (x2 - x3) * k;\n      car = c2r - (c2r - c3r) * k;\n      cag = c2g - (c2g - c3g) * k;\n      cab = c2b - (c2b - c3b) * k;\n    }\n\n    let k;\n\n    if (y < y1) {\n      k = 0;\n    } else if (y > y3) {\n      k = 1;\n    } else {\n      k = (y1 - y) / (y1 - y3);\n    }\n\n    xb = x1 - (x1 - x3) * k;\n    cbr = c1r - (c1r - c3r) * k;\n    cbg = c1g - (c1g - c3g) * k;\n    cbb = c1b - (c1b - c3b) * k;\n    const x1_ = Math.round(Math.min(xa, xb));\n    const x2_ = Math.round(Math.max(xa, xb));\n    let j = rowSize * y + x1_ * 4;\n\n    for (let x = x1_; x <= x2_; x++) {\n      k = (xa - x) / (xa - xb);\n\n      if (k < 0) {\n        k = 0;\n      } else if (k > 1) {\n        k = 1;\n      }\n\n      bytes[j++] = car - (car - cbr) * k | 0;\n      bytes[j++] = cag - (cag - cbg) * k | 0;\n      bytes[j++] = cab - (cab - cbb) * k | 0;\n      bytes[j++] = 255;\n    }\n  }\n}\n\nfunction drawFigure(data, figure, context) {\n  const ps = figure.coords;\n  const cs = figure.colors;\n  let i, ii;\n\n  switch (figure.type) {\n    case \"lattice\":\n      const verticesPerRow = figure.verticesPerRow;\n      const rows = Math.floor(ps.length / verticesPerRow) - 1;\n      const cols = verticesPerRow - 1;\n\n      for (i = 0; i < rows; i++) {\n        let q = i * verticesPerRow;\n\n        for (let j = 0; j < cols; j++, q++) {\n          drawTriangle(data, context, ps[q], ps[q + 1], ps[q + verticesPerRow], cs[q], cs[q + 1], cs[q + verticesPerRow]);\n          drawTriangle(data, context, ps[q + verticesPerRow + 1], ps[q + 1], ps[q + verticesPerRow], cs[q + verticesPerRow + 1], cs[q + 1], cs[q + verticesPerRow]);\n        }\n      }\n\n      break;\n\n    case \"triangles\":\n      for (i = 0, ii = ps.length; i < ii; i += 3) {\n        drawTriangle(data, context, ps[i], ps[i + 1], ps[i + 2], cs[i], cs[i + 1], cs[i + 2]);\n      }\n\n      break;\n\n    default:\n      throw new Error(\"illegal figure\");\n  }\n}\n\nclass MeshShadingPattern extends BaseShadingPattern {\n  constructor(IR) {\n    super();\n    this._coords = IR[2];\n    this._colors = IR[3];\n    this._figures = IR[4];\n    this._bounds = IR[5];\n    this._bbox = IR[7];\n    this._background = IR[8];\n    this.matrix = null;\n  }\n\n  _createMeshCanvas(combinedScale, backgroundColor, cachedCanvases) {\n    const EXPECTED_SCALE = 1.1;\n    const MAX_PATTERN_SIZE = 3000;\n    const BORDER_SIZE = 2;\n    const offsetX = Math.floor(this._bounds[0]);\n    const offsetY = Math.floor(this._bounds[1]);\n    const boundsWidth = Math.ceil(this._bounds[2]) - offsetX;\n    const boundsHeight = Math.ceil(this._bounds[3]) - offsetY;\n    const width = Math.min(Math.ceil(Math.abs(boundsWidth * combinedScale[0] * EXPECTED_SCALE)), MAX_PATTERN_SIZE);\n    const height = Math.min(Math.ceil(Math.abs(boundsHeight * combinedScale[1] * EXPECTED_SCALE)), MAX_PATTERN_SIZE);\n    const scaleX = boundsWidth / width;\n    const scaleY = boundsHeight / height;\n    const context = {\n      coords: this._coords,\n      colors: this._colors,\n      offsetX: -offsetX,\n      offsetY: -offsetY,\n      scaleX: 1 / scaleX,\n      scaleY: 1 / scaleY\n    };\n    const paddedWidth = width + BORDER_SIZE * 2;\n    const paddedHeight = height + BORDER_SIZE * 2;\n    const tmpCanvas = cachedCanvases.getCanvas(\"mesh\", paddedWidth, paddedHeight, false);\n    const tmpCtx = tmpCanvas.context;\n    const data = tmpCtx.createImageData(width, height);\n\n    if (backgroundColor) {\n      const bytes = data.data;\n\n      for (let i = 0, ii = bytes.length; i < ii; i += 4) {\n        bytes[i] = backgroundColor[0];\n        bytes[i + 1] = backgroundColor[1];\n        bytes[i + 2] = backgroundColor[2];\n        bytes[i + 3] = 255;\n      }\n    }\n\n    for (const figure of this._figures) {\n      drawFigure(data, figure, context);\n    }\n\n    tmpCtx.putImageData(data, BORDER_SIZE, BORDER_SIZE);\n    const canvas = tmpCanvas.canvas;\n    return {\n      canvas,\n      offsetX: offsetX - BORDER_SIZE * scaleX,\n      offsetY: offsetY - BORDER_SIZE * scaleY,\n      scaleX,\n      scaleY\n    };\n  }\n\n  getPattern(ctx, owner, inverse, pathType) {\n    applyBoundingBox(ctx, this._bbox);\n    let scale;\n\n    if (pathType === PathType.SHADING) {\n      scale = Util.singularValueDecompose2dScale(getCurrentTransform(ctx));\n    } else {\n      scale = Util.singularValueDecompose2dScale(owner.baseTransform);\n\n      if (this.matrix) {\n        const matrixScale = Util.singularValueDecompose2dScale(this.matrix);\n        scale = [scale[0] * matrixScale[0], scale[1] * matrixScale[1]];\n      }\n    }\n\n    const temporaryPatternCanvas = this._createMeshCanvas(scale, pathType === PathType.SHADING ? null : this._background, owner.cachedCanvases);\n\n    if (pathType !== PathType.SHADING) {\n      ctx.setTransform(...owner.baseTransform);\n\n      if (this.matrix) {\n        ctx.transform(...this.matrix);\n      }\n    }\n\n    ctx.translate(temporaryPatternCanvas.offsetX, temporaryPatternCanvas.offsetY);\n    ctx.scale(temporaryPatternCanvas.scaleX, temporaryPatternCanvas.scaleY);\n    return ctx.createPattern(temporaryPatternCanvas.canvas, \"no-repeat\");\n  }\n\n}\n\nclass DummyShadingPattern extends BaseShadingPattern {\n  getPattern() {\n    return \"hotpink\";\n  }\n\n}\n\nfunction getShadingPattern(IR) {\n  switch (IR[0]) {\n    case \"RadialAxial\":\n      return new RadialAxialShadingPattern(IR);\n\n    case \"Mesh\":\n      return new MeshShadingPattern(IR);\n\n    case \"Dummy\":\n      return new DummyShadingPattern();\n  }\n\n  throw new Error(`Unknown IR type: ${IR[0]}`);\n}\n\nconst PaintType = {\n  COLORED: 1,\n  UNCOLORED: 2\n};\n\nclass TilingPattern {\n  static MAX_PATTERN_SIZE = 3000;\n\n  constructor(IR, color, ctx, canvasGraphicsFactory, baseTransform) {\n    this.operatorList = IR[2];\n    this.matrix = IR[3];\n    this.bbox = IR[4];\n    this.xstep = IR[5];\n    this.ystep = IR[6];\n    this.paintType = IR[7];\n    this.tilingType = IR[8];\n    this.color = color;\n    this.ctx = ctx;\n    this.canvasGraphicsFactory = canvasGraphicsFactory;\n    this.baseTransform = baseTransform;\n  }\n\n  createPatternCanvas(owner) {\n    const operatorList = this.operatorList;\n    const bbox = this.bbox;\n    const xstep = this.xstep;\n    const ystep = this.ystep;\n    const paintType = this.paintType;\n    const tilingType = this.tilingType;\n    const color = this.color;\n    const canvasGraphicsFactory = this.canvasGraphicsFactory;\n    info(\"TilingType: \" + tilingType);\n    const x0 = bbox[0],\n          y0 = bbox[1],\n          x1 = bbox[2],\n          y1 = bbox[3];\n    const matrixScale = Util.singularValueDecompose2dScale(this.matrix);\n    const curMatrixScale = Util.singularValueDecompose2dScale(this.baseTransform);\n    const combinedScale = [matrixScale[0] * curMatrixScale[0], matrixScale[1] * curMatrixScale[1]];\n    const dimx = this.getSizeAndScale(xstep, this.ctx.canvas.width, combinedScale[0]);\n    const dimy = this.getSizeAndScale(ystep, this.ctx.canvas.height, combinedScale[1]);\n    const tmpCanvas = owner.cachedCanvases.getCanvas(\"pattern\", dimx.size, dimy.size, true);\n    const tmpCtx = tmpCanvas.context;\n    const graphics = canvasGraphicsFactory.createCanvasGraphics(tmpCtx);\n    graphics.groupLevel = owner.groupLevel;\n    this.setFillAndStrokeStyleToContext(graphics, paintType, color);\n    let adjustedX0 = x0;\n    let adjustedY0 = y0;\n    let adjustedX1 = x1;\n    let adjustedY1 = y1;\n\n    if (x0 < 0) {\n      adjustedX0 = 0;\n      adjustedX1 += Math.abs(x0);\n    }\n\n    if (y0 < 0) {\n      adjustedY0 = 0;\n      adjustedY1 += Math.abs(y0);\n    }\n\n    tmpCtx.translate(-(dimx.scale * adjustedX0), -(dimy.scale * adjustedY0));\n    graphics.transform(dimx.scale, 0, 0, dimy.scale, 0, 0);\n    tmpCtx.save();\n    this.clipBbox(graphics, adjustedX0, adjustedY0, adjustedX1, adjustedY1);\n    graphics.baseTransform = getCurrentTransform(graphics.ctx);\n    graphics.executeOperatorList(operatorList);\n    graphics.endDrawing();\n    return {\n      canvas: tmpCanvas.canvas,\n      scaleX: dimx.scale,\n      scaleY: dimy.scale,\n      offsetX: adjustedX0,\n      offsetY: adjustedY0\n    };\n  }\n\n  getSizeAndScale(step, realOutputSize, scale) {\n    step = Math.abs(step);\n    const maxSize = Math.max(TilingPattern.MAX_PATTERN_SIZE, realOutputSize);\n    let size = Math.ceil(step * scale);\n\n    if (size >= maxSize) {\n      size = maxSize;\n    } else {\n      scale = size / step;\n    }\n\n    return {\n      scale,\n      size\n    };\n  }\n\n  clipBbox(graphics, x0, y0, x1, y1) {\n    const bboxWidth = x1 - x0;\n    const bboxHeight = y1 - y0;\n    graphics.ctx.rect(x0, y0, bboxWidth, bboxHeight);\n    graphics.current.updateRectMinMax(getCurrentTransform(graphics.ctx), [x0, y0, x1, y1]);\n    graphics.clip();\n    graphics.endPath();\n  }\n\n  setFillAndStrokeStyleToContext(graphics, paintType, color) {\n    const context = graphics.ctx,\n          current = graphics.current;\n\n    switch (paintType) {\n      case PaintType.COLORED:\n        const ctx = this.ctx;\n        context.fillStyle = ctx.fillStyle;\n        context.strokeStyle = ctx.strokeStyle;\n        current.fillColor = ctx.fillStyle;\n        current.strokeColor = ctx.strokeStyle;\n        break;\n\n      case PaintType.UNCOLORED:\n        const cssColor = Util.makeHexColor(color[0], color[1], color[2]);\n        context.fillStyle = cssColor;\n        context.strokeStyle = cssColor;\n        current.fillColor = cssColor;\n        current.strokeColor = cssColor;\n        break;\n\n      default:\n        throw new FormatError(`Unsupported paint type: ${paintType}`);\n    }\n  }\n\n  getPattern(ctx, owner, inverse, pathType) {\n    let matrix = inverse;\n\n    if (pathType !== PathType.SHADING) {\n      matrix = Util.transform(matrix, owner.baseTransform);\n\n      if (this.matrix) {\n        matrix = Util.transform(matrix, this.matrix);\n      }\n    }\n\n    const temporaryPatternCanvas = this.createPatternCanvas(owner);\n    let domMatrix = new DOMMatrix(matrix);\n    domMatrix = domMatrix.translate(temporaryPatternCanvas.offsetX, temporaryPatternCanvas.offsetY);\n    domMatrix = domMatrix.scale(1 / temporaryPatternCanvas.scaleX, 1 / temporaryPatternCanvas.scaleY);\n    const pattern = ctx.createPattern(temporaryPatternCanvas.canvas, \"repeat\");\n    pattern.setTransform(domMatrix);\n    return pattern;\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/shared/image_utils.js\n\nfunction convertToRGBA(params) {\n  switch (params.kind) {\n    case ImageKind.GRAYSCALE_1BPP:\n      return convertBlackAndWhiteToRGBA(params);\n\n    case ImageKind.RGB_24BPP:\n      return convertRGBToRGBA(params);\n  }\n\n  return null;\n}\n\nfunction convertBlackAndWhiteToRGBA({\n  src,\n  srcPos = 0,\n  dest,\n  width,\n  height,\n  nonBlackColor = 0xffffffff,\n  inverseDecode = false\n}) {\n  const black = util_FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n  const [zeroMapping, oneMapping] = inverseDecode ? [nonBlackColor, black] : [black, nonBlackColor];\n  const widthInSource = width >> 3;\n  const widthRemainder = width & 7;\n  const srcLength = src.length;\n  dest = new Uint32Array(dest.buffer);\n  let destPos = 0;\n\n  for (let i = 0; i < height; i++) {\n    for (const max = srcPos + widthInSource; srcPos < max; srcPos++) {\n      const elem = srcPos < srcLength ? src[srcPos] : 255;\n      dest[destPos++] = elem & 0b10000000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1000000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b100000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b10000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b100 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b10 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1 ? oneMapping : zeroMapping;\n    }\n\n    if (widthRemainder === 0) {\n      continue;\n    }\n\n    const elem = srcPos < srcLength ? src[srcPos++] : 255;\n\n    for (let j = 0; j < widthRemainder; j++) {\n      dest[destPos++] = elem & 1 << 7 - j ? oneMapping : zeroMapping;\n    }\n  }\n\n  return {\n    srcPos,\n    destPos\n  };\n}\n\nfunction convertRGBToRGBA({\n  src,\n  srcPos = 0,\n  dest,\n  destPos = 0,\n  width,\n  height\n}) {\n  let i = 0;\n  const len32 = src.length >> 2;\n  const src32 = new Uint32Array(src.buffer, srcPos, len32);\n\n  if (FeatureTest.isLittleEndian) {\n    for (; i < len32 - 2; i += 3, destPos += 4) {\n      const s1 = src32[i];\n      const s2 = src32[i + 1];\n      const s3 = src32[i + 2];\n      dest[destPos] = s1 | 0xff000000;\n      dest[destPos + 1] = s1 >>> 24 | s2 << 8 | 0xff000000;\n      dest[destPos + 2] = s2 >>> 16 | s3 << 16 | 0xff000000;\n      dest[destPos + 3] = s3 >>> 8 | 0xff000000;\n    }\n\n    for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n      dest[destPos++] = src[j] | src[j + 1] << 8 | src[j + 2] << 16 | 0xff000000;\n    }\n  } else {\n    for (; i < len32 - 2; i += 3, destPos += 4) {\n      const s1 = src32[i];\n      const s2 = src32[i + 1];\n      const s3 = src32[i + 2];\n      dest[destPos] = s1 | 0xff;\n      dest[destPos + 1] = s1 << 24 | s2 >>> 8 | 0xff;\n      dest[destPos + 2] = s2 << 16 | s3 >>> 16 | 0xff;\n      dest[destPos + 3] = s3 << 8 | 0xff;\n    }\n\n    for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n      dest[destPos++] = src[j] << 24 | src[j + 1] << 16 | src[j + 2] << 8 | 0xff;\n    }\n  }\n\n  return {\n    srcPos,\n    destPos\n  };\n}\n\nfunction grayToRGBA(src, dest) {\n  if (FeatureTest.isLittleEndian) {\n    for (let i = 0, ii = src.length; i < ii; i++) {\n      dest[i] = src[i] * 0x10101 | 0xff000000;\n    }\n  } else {\n    for (let i = 0, ii = src.length; i < ii; i++) {\n      dest[i] = src[i] * 0x1010100 | 0x000000ff;\n    }\n  }\n}\n\n; // CONCATENATED MODULE: ./src/display/canvas.js\n\nconst MIN_FONT_SIZE = 16;\nconst MAX_FONT_SIZE = 100;\nconst EXECUTION_TIME = 15;\nconst EXECUTION_STEPS = 10;\nconst MAX_SIZE_TO_COMPILE = 1000;\nconst FULL_CHUNK_HEIGHT = 16;\n\nfunction mirrorContextOperations(ctx, destCtx) {\n  if (ctx._removeMirroring) {\n    throw new Error(\"Context is already forwarding operations.\");\n  }\n\n  ctx.__originalSave = ctx.save;\n  ctx.__originalRestore = ctx.restore;\n  ctx.__originalRotate = ctx.rotate;\n  ctx.__originalScale = ctx.scale;\n  ctx.__originalTranslate = ctx.translate;\n  ctx.__originalTransform = ctx.transform;\n  ctx.__originalSetTransform = ctx.setTransform;\n  ctx.__originalResetTransform = ctx.resetTransform;\n  ctx.__originalClip = ctx.clip;\n  ctx.__originalMoveTo = ctx.moveTo;\n  ctx.__originalLineTo = ctx.lineTo;\n  ctx.__originalBezierCurveTo = ctx.bezierCurveTo;\n  ctx.__originalRect = ctx.rect;\n  ctx.__originalClosePath = ctx.closePath;\n  ctx.__originalBeginPath = ctx.beginPath;\n\n  ctx._removeMirroring = () => {\n    ctx.save = ctx.__originalSave;\n    ctx.restore = ctx.__originalRestore;\n    ctx.rotate = ctx.__originalRotate;\n    ctx.scale = ctx.__originalScale;\n    ctx.translate = ctx.__originalTranslate;\n    ctx.transform = ctx.__originalTransform;\n    ctx.setTransform = ctx.__originalSetTransform;\n    ctx.resetTransform = ctx.__originalResetTransform;\n    ctx.clip = ctx.__originalClip;\n    ctx.moveTo = ctx.__originalMoveTo;\n    ctx.lineTo = ctx.__originalLineTo;\n    ctx.bezierCurveTo = ctx.__originalBezierCurveTo;\n    ctx.rect = ctx.__originalRect;\n    ctx.closePath = ctx.__originalClosePath;\n    ctx.beginPath = ctx.__originalBeginPath;\n    delete ctx._removeMirroring;\n  };\n\n  ctx.save = function ctxSave() {\n    destCtx.save();\n\n    this.__originalSave();\n  };\n\n  ctx.restore = function ctxRestore() {\n    destCtx.restore();\n\n    this.__originalRestore();\n  };\n\n  ctx.translate = function ctxTranslate(x, y) {\n    destCtx.translate(x, y);\n\n    this.__originalTranslate(x, y);\n  };\n\n  ctx.scale = function ctxScale(x, y) {\n    destCtx.scale(x, y);\n\n    this.__originalScale(x, y);\n  };\n\n  ctx.transform = function ctxTransform(a, b, c, d, e, f) {\n    destCtx.transform(a, b, c, d, e, f);\n\n    this.__originalTransform(a, b, c, d, e, f);\n  };\n\n  ctx.setTransform = function ctxSetTransform(a, b, c, d, e, f) {\n    destCtx.setTransform(a, b, c, d, e, f);\n\n    this.__originalSetTransform(a, b, c, d, e, f);\n  };\n\n  ctx.resetTransform = function ctxResetTransform() {\n    destCtx.resetTransform();\n\n    this.__originalResetTransform();\n  };\n\n  ctx.rotate = function ctxRotate(angle) {\n    destCtx.rotate(angle);\n\n    this.__originalRotate(angle);\n  };\n\n  ctx.clip = function ctxRotate(rule) {\n    destCtx.clip(rule);\n\n    this.__originalClip(rule);\n  };\n\n  ctx.moveTo = function (x, y) {\n    destCtx.moveTo(x, y);\n\n    this.__originalMoveTo(x, y);\n  };\n\n  ctx.lineTo = function (x, y) {\n    destCtx.lineTo(x, y);\n\n    this.__originalLineTo(x, y);\n  };\n\n  ctx.bezierCurveTo = function (cp1x, cp1y, cp2x, cp2y, x, y) {\n    destCtx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n\n    this.__originalBezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n  };\n\n  ctx.rect = function (x, y, width, height) {\n    destCtx.rect(x, y, width, height);\n\n    this.__originalRect(x, y, width, height);\n  };\n\n  ctx.closePath = function () {\n    destCtx.closePath();\n\n    this.__originalClosePath();\n  };\n\n  ctx.beginPath = function () {\n    destCtx.beginPath();\n\n    this.__originalBeginPath();\n  };\n}\n\nclass CachedCanvases {\n  constructor(canvasFactory) {\n    this.canvasFactory = canvasFactory;\n    this.cache = Object.create(null);\n  }\n\n  getCanvas(id, width, height) {\n    let canvasEntry;\n\n    if (this.cache[id] !== undefined) {\n      canvasEntry = this.cache[id];\n      this.canvasFactory.reset(canvasEntry, width, height);\n    } else {\n      canvasEntry = this.canvasFactory.create(width, height);\n      this.cache[id] = canvasEntry;\n    }\n\n    return canvasEntry;\n  }\n\n  delete(id) {\n    delete this.cache[id];\n  }\n\n  clear() {\n    for (const id in this.cache) {\n      const canvasEntry = this.cache[id];\n      this.canvasFactory.destroy(canvasEntry);\n      delete this.cache[id];\n    }\n  }\n\n}\n\nfunction drawImageAtIntegerCoords(ctx, srcImg, srcX, srcY, srcW, srcH, destX, destY, destW, destH) {\n  const [a, b, c, d, tx, ty] = getCurrentTransform(ctx);\n\n  if (b === 0 && c === 0) {\n    const tlX = destX * a + tx;\n    const rTlX = Math.round(tlX);\n    const tlY = destY * d + ty;\n    const rTlY = Math.round(tlY);\n    const brX = (destX + destW) * a + tx;\n    const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n    const brY = (destY + destH) * d + ty;\n    const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n    ctx.setTransform(Math.sign(a), 0, 0, Math.sign(d), rTlX, rTlY);\n    ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rWidth, rHeight);\n    ctx.setTransform(a, b, c, d, tx, ty);\n    return [rWidth, rHeight];\n  }\n\n  if (a === 0 && d === 0) {\n    const tlX = destY * c + tx;\n    const rTlX = Math.round(tlX);\n    const tlY = destX * b + ty;\n    const rTlY = Math.round(tlY);\n    const brX = (destY + destH) * c + tx;\n    const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n    const brY = (destX + destW) * b + ty;\n    const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n    ctx.setTransform(0, Math.sign(b), Math.sign(c), 0, rTlX, rTlY);\n    ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rHeight, rWidth);\n    ctx.setTransform(a, b, c, d, tx, ty);\n    return [rHeight, rWidth];\n  }\n\n  ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, destX, destY, destW, destH);\n  const scaleX = Math.hypot(a, b);\n  const scaleY = Math.hypot(c, d);\n  return [scaleX * destW, scaleY * destH];\n}\n\nfunction compileType3Glyph(imgData) {\n  const {\n    width,\n    height\n  } = imgData;\n\n  if (width > MAX_SIZE_TO_COMPILE || height > MAX_SIZE_TO_COMPILE) {\n    return null;\n  }\n\n  const POINT_TO_PROCESS_LIMIT = 1000;\n  const POINT_TYPES = new Uint8Array([0, 2, 4, 0, 1, 0, 5, 4, 8, 10, 0, 8, 0, 2, 1, 0]);\n  const width1 = width + 1;\n  let points = new Uint8Array(width1 * (height + 1));\n  let i, j, j0;\n  const lineSize = width + 7 & ~7;\n  let data = new Uint8Array(lineSize * height),\n      pos = 0;\n\n  for (const elem of imgData.data) {\n    let mask = 128;\n\n    while (mask > 0) {\n      data[pos++] = elem & mask ? 0 : 255;\n      mask >>= 1;\n    }\n  }\n\n  let count = 0;\n  pos = 0;\n\n  if (data[pos] !== 0) {\n    points[0] = 1;\n    ++count;\n  }\n\n  for (j = 1; j < width; j++) {\n    if (data[pos] !== data[pos + 1]) {\n      points[j] = data[pos] ? 2 : 1;\n      ++count;\n    }\n\n    pos++;\n  }\n\n  if (data[pos] !== 0) {\n    points[j] = 2;\n    ++count;\n  }\n\n  for (i = 1; i < height; i++) {\n    pos = i * lineSize;\n    j0 = i * width1;\n\n    if (data[pos - lineSize] !== data[pos]) {\n      points[j0] = data[pos] ? 1 : 8;\n      ++count;\n    }\n\n    let sum = (data[pos] ? 4 : 0) + (data[pos - lineSize] ? 8 : 0);\n\n    for (j = 1; j < width; j++) {\n      sum = (sum >> 2) + (data[pos + 1] ? 4 : 0) + (data[pos - lineSize + 1] ? 8 : 0);\n\n      if (POINT_TYPES[sum]) {\n        points[j0 + j] = POINT_TYPES[sum];\n        ++count;\n      }\n\n      pos++;\n    }\n\n    if (data[pos - lineSize] !== data[pos]) {\n      points[j0 + j] = data[pos] ? 2 : 4;\n      ++count;\n    }\n\n    if (count > POINT_TO_PROCESS_LIMIT) {\n      return null;\n    }\n  }\n\n  pos = lineSize * (height - 1);\n  j0 = i * width1;\n\n  if (data[pos] !== 0) {\n    points[j0] = 8;\n    ++count;\n  }\n\n  for (j = 1; j < width; j++) {\n    if (data[pos] !== data[pos + 1]) {\n      points[j0 + j] = data[pos] ? 4 : 8;\n      ++count;\n    }\n\n    pos++;\n  }\n\n  if (data[pos] !== 0) {\n    points[j0 + j] = 4;\n    ++count;\n  }\n\n  if (count > POINT_TO_PROCESS_LIMIT) {\n    return null;\n  }\n\n  const steps = new Int32Array([0, width1, -1, 0, -width1, 0, 0, 0, 1]);\n  const path = new Path2D();\n\n  for (i = 0; count && i <= height; i++) {\n    let p = i * width1;\n    const end = p + width;\n\n    while (p < end && !points[p]) {\n      p++;\n    }\n\n    if (p === end) {\n      continue;\n    }\n\n    path.moveTo(p % width1, i);\n    const p0 = p;\n    let type = points[p];\n\n    do {\n      const step = steps[type];\n\n      do {\n        p += step;\n      } while (!points[p]);\n\n      const pp = points[p];\n\n      if (pp !== 5 && pp !== 10) {\n        type = pp;\n        points[p] = 0;\n      } else {\n        type = pp & 0x33 * type >> 4;\n        points[p] &= type >> 2 | type << 2;\n      }\n\n      path.lineTo(p % width1, p / width1 | 0);\n\n      if (!points[p]) {\n        --count;\n      }\n    } while (p0 !== p);\n\n    --i;\n  }\n\n  data = null;\n  points = null;\n\n  const drawOutline = function (c) {\n    c.save();\n    c.scale(1 / width, -1 / height);\n    c.translate(0, -height);\n    c.fill(path);\n    c.beginPath();\n    c.restore();\n  };\n\n  return drawOutline;\n}\n\nclass CanvasExtraState {\n  constructor(width, height) {\n    this.alphaIsShape = false;\n    this.fontSize = 0;\n    this.fontSizeScale = 1;\n    this.textMatrix = IDENTITY_MATRIX;\n    this.textMatrixScale = 1;\n    this.fontMatrix = FONT_IDENTITY_MATRIX;\n    this.leading = 0;\n    this.x = 0;\n    this.y = 0;\n    this.lineX = 0;\n    this.lineY = 0;\n    this.charSpacing = 0;\n    this.wordSpacing = 0;\n    this.textHScale = 1;\n    this.textRenderingMode = TextRenderingMode.FILL;\n    this.textRise = 0;\n    this.fillColor = \"#000000\";\n    this.strokeColor = \"#000000\";\n    this.patternFill = false;\n    this.fillAlpha = 1;\n    this.strokeAlpha = 1;\n    this.lineWidth = 1;\n    this.activeSMask = null;\n    this.transferMaps = \"none\";\n    this.startNewPathAndClipBox([0, 0, width, height]);\n  }\n\n  clone() {\n    const clone = Object.create(this);\n    clone.clipBox = this.clipBox.slice();\n    return clone;\n  }\n\n  setCurrentPoint(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  updatePathMinMax(transform, x, y) {\n    [x, y] = Util.applyTransform([x, y], transform);\n    this.minX = Math.min(this.minX, x);\n    this.minY = Math.min(this.minY, y);\n    this.maxX = Math.max(this.maxX, x);\n    this.maxY = Math.max(this.maxY, y);\n  }\n\n  updateRectMinMax(transform, rect) {\n    const p1 = Util.applyTransform(rect, transform);\n    const p2 = Util.applyTransform(rect.slice(2), transform);\n    const p3 = Util.applyTransform([rect[0], rect[3]], transform);\n    const p4 = Util.applyTransform([rect[2], rect[1]], transform);\n    this.minX = Math.min(this.minX, p1[0], p2[0], p3[0], p4[0]);\n    this.minY = Math.min(this.minY, p1[1], p2[1], p3[1], p4[1]);\n    this.maxX = Math.max(this.maxX, p1[0], p2[0], p3[0], p4[0]);\n    this.maxY = Math.max(this.maxY, p1[1], p2[1], p3[1], p4[1]);\n  }\n\n  updateScalingPathMinMax(transform, minMax) {\n    Util.scaleMinMax(transform, minMax);\n    this.minX = Math.min(this.minX, minMax[0]);\n    this.minY = Math.min(this.minY, minMax[1]);\n    this.maxX = Math.max(this.maxX, minMax[2]);\n    this.maxY = Math.max(this.maxY, minMax[3]);\n  }\n\n  updateCurvePathMinMax(transform, x0, y0, x1, y1, x2, y2, x3, y3, minMax) {\n    const box = Util.bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3, minMax);\n\n    if (minMax) {\n      return;\n    }\n\n    this.updateRectMinMax(transform, box);\n  }\n\n  getPathBoundingBox(pathType = PathType.FILL, transform = null) {\n    const box = [this.minX, this.minY, this.maxX, this.maxY];\n\n    if (pathType === PathType.STROKE) {\n      if (!transform) {\n        unreachable(\"Stroke bounding box must include transform.\");\n      }\n\n      const scale = Util.singularValueDecompose2dScale(transform);\n      const xStrokePad = scale[0] * this.lineWidth / 2;\n      const yStrokePad = scale[1] * this.lineWidth / 2;\n      box[0] -= xStrokePad;\n      box[1] -= yStrokePad;\n      box[2] += xStrokePad;\n      box[3] += yStrokePad;\n    }\n\n    return box;\n  }\n\n  updateClipFromPath() {\n    const intersect = Util.intersect(this.clipBox, this.getPathBoundingBox());\n    this.startNewPathAndClipBox(intersect || [0, 0, 0, 0]);\n  }\n\n  isEmptyClip() {\n    return this.minX === Infinity;\n  }\n\n  startNewPathAndClipBox(box) {\n    this.clipBox = box;\n    this.minX = Infinity;\n    this.minY = Infinity;\n    this.maxX = 0;\n    this.maxY = 0;\n  }\n\n  getClippedPathBoundingBox(pathType = PathType.FILL, transform = null) {\n    return Util.intersect(this.clipBox, this.getPathBoundingBox(pathType, transform));\n  }\n\n}\n\nfunction putBinaryImageData(ctx, imgData) {\n  if (typeof ImageData !== \"undefined\" && imgData instanceof ImageData) {\n    ctx.putImageData(imgData, 0, 0);\n    return;\n  }\n\n  const height = imgData.height,\n        width = imgData.width;\n  const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n  const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n  const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n  const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n  let srcPos = 0,\n      destPos;\n  const src = imgData.data;\n  const dest = chunkImgData.data;\n  let i, j, thisChunkHeight, elemsInThisChunk;\n\n  if (imgData.kind === util_ImageKind.GRAYSCALE_1BPP) {\n    const srcLength = src.byteLength;\n    const dest32 = new Uint32Array(dest.buffer, 0, dest.byteLength >> 2);\n    const dest32DataLength = dest32.length;\n    const fullSrcDiff = width + 7 >> 3;\n    const white = 0xffffffff;\n    const black = util_FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n\n    for (i = 0; i < totalChunks; i++) {\n      thisChunkHeight = i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n      destPos = 0;\n\n      for (j = 0; j < thisChunkHeight; j++) {\n        const srcDiff = srcLength - srcPos;\n        let k = 0;\n        const kEnd = srcDiff > fullSrcDiff ? width : srcDiff * 8 - 7;\n        const kEndUnrolled = kEnd & ~7;\n        let mask = 0;\n        let srcByte = 0;\n\n        for (; k < kEndUnrolled; k += 8) {\n          srcByte = src[srcPos++];\n          dest32[destPos++] = srcByte & 128 ? white : black;\n          dest32[destPos++] = srcByte & 64 ? white : black;\n          dest32[destPos++] = srcByte & 32 ? white : black;\n          dest32[destPos++] = srcByte & 16 ? white : black;\n          dest32[destPos++] = srcByte & 8 ? white : black;\n          dest32[destPos++] = srcByte & 4 ? white : black;\n          dest32[destPos++] = srcByte & 2 ? white : black;\n          dest32[destPos++] = srcByte & 1 ? white : black;\n        }\n\n        for (; k < kEnd; k++) {\n          if (mask === 0) {\n            srcByte = src[srcPos++];\n            mask = 128;\n          }\n\n          dest32[destPos++] = srcByte & mask ? white : black;\n          mask >>= 1;\n        }\n      }\n\n      while (destPos < dest32DataLength) {\n        dest32[destPos++] = 0;\n      }\n\n      ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n    }\n  } else if (imgData.kind === util_ImageKind.RGBA_32BPP) {\n    j = 0;\n    elemsInThisChunk = width * FULL_CHUNK_HEIGHT * 4;\n\n    for (i = 0; i < fullChunks; i++) {\n      dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n      srcPos += elemsInThisChunk;\n      ctx.putImageData(chunkImgData, 0, j);\n      j += FULL_CHUNK_HEIGHT;\n    }\n\n    if (i < totalChunks) {\n      elemsInThisChunk = width * partialChunkHeight * 4;\n      dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n      ctx.putImageData(chunkImgData, 0, j);\n    }\n  } else if (imgData.kind === util_ImageKind.RGB_24BPP) {\n    thisChunkHeight = FULL_CHUNK_HEIGHT;\n    elemsInThisChunk = width * thisChunkHeight;\n\n    for (i = 0; i < totalChunks; i++) {\n      if (i >= fullChunks) {\n        thisChunkHeight = partialChunkHeight;\n        elemsInThisChunk = width * thisChunkHeight;\n      }\n\n      destPos = 0;\n\n      for (j = elemsInThisChunk; j--;) {\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = 255;\n      }\n\n      ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n    }\n  } else {\n    throw new Error(`bad image kind: ${imgData.kind}`);\n  }\n}\n\nfunction putBinaryImageMask(ctx, imgData) {\n  if (imgData.bitmap) {\n    ctx.drawImage(imgData.bitmap, 0, 0);\n    return;\n  }\n\n  const height = imgData.height,\n        width = imgData.width;\n  const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n  const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n  const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n  const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n  let srcPos = 0;\n  const src = imgData.data;\n  const dest = chunkImgData.data;\n\n  for (let i = 0; i < totalChunks; i++) {\n    const thisChunkHeight = i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n    ({\n      srcPos\n    } = convertBlackAndWhiteToRGBA({\n      src,\n      srcPos,\n      dest,\n      width,\n      height: thisChunkHeight,\n      nonBlackColor: 0\n    }));\n    ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n  }\n}\n\nfunction copyCtxState(sourceCtx, destCtx) {\n  const properties = [\"strokeStyle\", \"fillStyle\", \"fillRule\", \"globalAlpha\", \"lineWidth\", \"lineCap\", \"lineJoin\", \"miterLimit\", \"globalCompositeOperation\", \"font\", \"filter\"];\n\n  for (const property of properties) {\n    if (sourceCtx[property] !== undefined) {\n      destCtx[property] = sourceCtx[property];\n    }\n  }\n\n  if (sourceCtx.setLineDash !== undefined) {\n    destCtx.setLineDash(sourceCtx.getLineDash());\n    destCtx.lineDashOffset = sourceCtx.lineDashOffset;\n  }\n}\n\nfunction resetCtxToDefault(ctx) {\n  ctx.strokeStyle = ctx.fillStyle = \"#000000\";\n  ctx.fillRule = \"nonzero\";\n  ctx.globalAlpha = 1;\n  ctx.lineWidth = 1;\n  ctx.lineCap = \"butt\";\n  ctx.lineJoin = \"miter\";\n  ctx.miterLimit = 10;\n  ctx.globalCompositeOperation = \"source-over\";\n  ctx.font = \"10px sans-serif\";\n\n  if (ctx.setLineDash !== undefined) {\n    ctx.setLineDash([]);\n    ctx.lineDashOffset = 0;\n  }\n\n  if (!isNodeJS) {\n    const {\n      filter\n    } = ctx;\n\n    if (filter !== \"none\" && filter !== \"\") {\n      ctx.filter = \"none\";\n    }\n  }\n}\n\nfunction getImageSmoothingEnabled(transform, interpolate) {\n  if (interpolate) {\n    return true;\n  }\n\n  const scale = Util.singularValueDecompose2dScale(transform);\n  scale[0] = Math.fround(scale[0]);\n  scale[1] = Math.fround(scale[1]);\n  const actualScale = Math.fround((globalThis.devicePixelRatio || 1) * PixelsPerInch.PDF_TO_CSS_UNITS);\n  return scale[0] <= actualScale && scale[1] <= actualScale;\n}\n\nconst LINE_CAP_STYLES = [\"butt\", \"round\", \"square\"];\nconst LINE_JOIN_STYLES = [\"miter\", \"round\", \"bevel\"];\nconst NORMAL_CLIP = {};\nconst EO_CLIP = {};\n\nclass CanvasGraphics {\n  constructor(canvasCtx, commonObjs, objs, canvasFactory, filterFactory, {\n    optionalContentConfig,\n    markedContentStack = null\n  }, annotationCanvasMap, pageColors) {\n    this.ctx = canvasCtx;\n    this.current = new CanvasExtraState(this.ctx.canvas.width, this.ctx.canvas.height);\n    this.stateStack = [];\n    this.pendingClip = null;\n    this.pendingEOFill = false;\n    this.res = null;\n    this.xobjs = null;\n    this.commonObjs = commonObjs;\n    this.objs = objs;\n    this.canvasFactory = canvasFactory;\n    this.filterFactory = filterFactory;\n    this.groupStack = [];\n    this.processingType3 = null;\n    this.baseTransform = null;\n    this.baseTransformStack = [];\n    this.groupLevel = 0;\n    this.smaskStack = [];\n    this.smaskCounter = 0;\n    this.tempSMask = null;\n    this.suspendedCtx = null;\n    this.contentVisible = true;\n    this.markedContentStack = markedContentStack || [];\n    this.optionalContentConfig = optionalContentConfig;\n    this.cachedCanvases = new CachedCanvases(this.canvasFactory);\n    this.cachedPatterns = new Map();\n    this.annotationCanvasMap = annotationCanvasMap;\n    this.viewportScale = 1;\n    this.outputScaleX = 1;\n    this.outputScaleY = 1;\n    this.pageColors = pageColors;\n    this._cachedScaleForStroking = [-1, 0];\n    this._cachedGetSinglePixelWidth = null;\n    this._cachedBitmapsMap = new Map();\n  }\n\n  getObject(data, fallback = null) {\n    if (typeof data === \"string\") {\n      return data.startsWith(\"g_\") ? this.commonObjs.get(data) : this.objs.get(data);\n    }\n\n    return fallback;\n  }\n\n  beginDrawing({\n    transform,\n    viewport,\n    transparency = false,\n    background = null\n  }) {\n    const width = this.ctx.canvas.width;\n    const height = this.ctx.canvas.height;\n    const savedFillStyle = this.ctx.fillStyle;\n    this.ctx.fillStyle = background || \"#ffffff\";\n    this.ctx.fillRect(0, 0, width, height);\n    this.ctx.fillStyle = savedFillStyle;\n\n    if (transparency) {\n      const transparentCanvas = this.cachedCanvases.getCanvas(\"transparent\", width, height);\n      this.compositeCtx = this.ctx;\n      this.transparentCanvas = transparentCanvas.canvas;\n      this.ctx = transparentCanvas.context;\n      this.ctx.save();\n      this.ctx.transform(...getCurrentTransform(this.compositeCtx));\n    }\n\n    this.ctx.save();\n    resetCtxToDefault(this.ctx);\n\n    if (transform) {\n      this.ctx.transform(...transform);\n      this.outputScaleX = transform[0];\n      this.outputScaleY = transform[0];\n    }\n\n    this.ctx.transform(...viewport.transform);\n    this.viewportScale = viewport.scale;\n    this.baseTransform = getCurrentTransform(this.ctx);\n  }\n\n  executeOperatorList(operatorList, executionStartIdx, continueCallback, stepper) {\n    const argsArray = operatorList.argsArray;\n    const fnArray = operatorList.fnArray;\n    let i = executionStartIdx || 0;\n    const argsArrayLen = argsArray.length;\n\n    if (argsArrayLen === i) {\n      return i;\n    }\n\n    const chunkOperations = argsArrayLen - i > EXECUTION_STEPS && typeof continueCallback === \"function\";\n    const endTime = chunkOperations ? Date.now() + EXECUTION_TIME : 0;\n    let steps = 0;\n    const commonObjs = this.commonObjs;\n    const objs = this.objs;\n    let fnId;\n\n    while (true) {\n      if (stepper !== undefined && i === stepper.nextBreakPoint) {\n        stepper.breakIt(i, continueCallback);\n        return i;\n      }\n\n      fnId = fnArray[i];\n\n      if (fnId !== OPS.dependency) {\n        this[fnId].apply(this, argsArray[i]);\n      } else {\n        for (const depObjId of argsArray[i]) {\n          const objsPool = depObjId.startsWith(\"g_\") ? commonObjs : objs;\n\n          if (!objsPool.has(depObjId)) {\n            objsPool.get(depObjId, continueCallback);\n            return i;\n          }\n        }\n      }\n\n      i++;\n\n      if (i === argsArrayLen) {\n        return i;\n      }\n\n      if (chunkOperations && ++steps > EXECUTION_STEPS) {\n        if (Date.now() > endTime) {\n          continueCallback();\n          return i;\n        }\n\n        steps = 0;\n      }\n    }\n  }\n\n  #restoreInitialState() {\n    while (this.stateStack.length || this.inSMaskMode) {\n      this.restore();\n    }\n\n    this.current.activeSMask = null;\n    this.ctx.restore();\n\n    if (this.transparentCanvas) {\n      this.ctx = this.compositeCtx;\n      this.ctx.save();\n      this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n      this.ctx.drawImage(this.transparentCanvas, 0, 0);\n      this.ctx.restore();\n      this.transparentCanvas = null;\n    }\n  }\n\n  endDrawing() {\n    this.#restoreInitialState();\n    this.cachedCanvases.clear();\n    this.cachedPatterns.clear();\n\n    for (const cache of this._cachedBitmapsMap.values()) {\n      for (const canvas of cache.values()) {\n        if (typeof HTMLCanvasElement !== \"undefined\" && canvas instanceof HTMLCanvasElement) {\n          canvas.width = canvas.height = 0;\n        }\n      }\n\n      cache.clear();\n    }\n\n    this._cachedBitmapsMap.clear();\n\n    this.#drawFilter();\n  }\n\n  #drawFilter() {\n    if (this.pageColors) {\n      const hcmFilterId = this.filterFactory.addHCMFilter(this.pageColors.foreground, this.pageColors.background);\n\n      if (hcmFilterId !== \"none\") {\n        const savedFilter = this.ctx.filter;\n        this.ctx.filter = hcmFilterId;\n        this.ctx.drawImage(this.ctx.canvas, 0, 0);\n        this.ctx.filter = savedFilter;\n      }\n    }\n  }\n\n  _scaleImage(img, inverseTransform) {\n    const width = img.width;\n    const height = img.height;\n    let widthScale = Math.max(Math.hypot(inverseTransform[0], inverseTransform[1]), 1);\n    let heightScale = Math.max(Math.hypot(inverseTransform[2], inverseTransform[3]), 1);\n    let paintWidth = width,\n        paintHeight = height;\n    let tmpCanvasId = \"prescale1\";\n    let tmpCanvas, tmpCtx;\n\n    while (widthScale > 2 && paintWidth > 1 || heightScale > 2 && paintHeight > 1) {\n      let newWidth = paintWidth,\n          newHeight = paintHeight;\n\n      if (widthScale > 2 && paintWidth > 1) {\n        newWidth = paintWidth >= 16384 ? Math.floor(paintWidth / 2) - 1 || 1 : Math.ceil(paintWidth / 2);\n        widthScale /= paintWidth / newWidth;\n      }\n\n      if (heightScale > 2 && paintHeight > 1) {\n        newHeight = paintHeight >= 16384 ? Math.floor(paintHeight / 2) - 1 || 1 : Math.ceil(paintHeight) / 2;\n        heightScale /= paintHeight / newHeight;\n      }\n\n      tmpCanvas = this.cachedCanvases.getCanvas(tmpCanvasId, newWidth, newHeight);\n      tmpCtx = tmpCanvas.context;\n      tmpCtx.clearRect(0, 0, newWidth, newHeight);\n      tmpCtx.drawImage(img, 0, 0, paintWidth, paintHeight, 0, 0, newWidth, newHeight);\n      img = tmpCanvas.canvas;\n      paintWidth = newWidth;\n      paintHeight = newHeight;\n      tmpCanvasId = tmpCanvasId === \"prescale1\" ? \"prescale2\" : \"prescale1\";\n    }\n\n    return {\n      img,\n      paintWidth,\n      paintHeight\n    };\n  }\n\n  _createMaskCanvas(img) {\n    const ctx = this.ctx;\n    const {\n      width,\n      height\n    } = img;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n    const currentTransform = getCurrentTransform(ctx);\n    let cache, cacheKey, scaled, maskCanvas;\n\n    if ((img.bitmap || img.data) && img.count > 1) {\n      const mainKey = img.bitmap || img.data.buffer;\n      cacheKey = JSON.stringify(isPatternFill ? currentTransform : [currentTransform.slice(0, 4), fillColor]);\n      cache = this._cachedBitmapsMap.get(mainKey);\n\n      if (!cache) {\n        cache = new Map();\n\n        this._cachedBitmapsMap.set(mainKey, cache);\n      }\n\n      const cachedImage = cache.get(cacheKey);\n\n      if (cachedImage && !isPatternFill) {\n        const offsetX = Math.round(Math.min(currentTransform[0], currentTransform[2]) + currentTransform[4]);\n        const offsetY = Math.round(Math.min(currentTransform[1], currentTransform[3]) + currentTransform[5]);\n        return {\n          canvas: cachedImage,\n          offsetX,\n          offsetY\n        };\n      }\n\n      scaled = cachedImage;\n    }\n\n    if (!scaled) {\n      maskCanvas = this.cachedCanvases.getCanvas(\"maskCanvas\", width, height);\n      putBinaryImageMask(maskCanvas.context, img);\n    }\n\n    let maskToCanvas = Util.transform(currentTransform, [1 / width, 0, 0, -1 / height, 0, 0]);\n    maskToCanvas = Util.transform(maskToCanvas, [1, 0, 0, 1, 0, -height]);\n    const [minX, minY, maxX, maxY] = Util.getAxialAlignedBoundingBox([0, 0, width, height], maskToCanvas);\n    const drawnWidth = Math.round(maxX - minX) || 1;\n    const drawnHeight = Math.round(maxY - minY) || 1;\n    const fillCanvas = this.cachedCanvases.getCanvas(\"fillCanvas\", drawnWidth, drawnHeight);\n    const fillCtx = fillCanvas.context;\n    const offsetX = minX;\n    const offsetY = minY;\n    fillCtx.translate(-offsetX, -offsetY);\n    fillCtx.transform(...maskToCanvas);\n\n    if (!scaled) {\n      scaled = this._scaleImage(maskCanvas.canvas, getCurrentTransformInverse(fillCtx));\n      scaled = scaled.img;\n\n      if (cache && isPatternFill) {\n        cache.set(cacheKey, scaled);\n      }\n    }\n\n    fillCtx.imageSmoothingEnabled = getImageSmoothingEnabled(getCurrentTransform(fillCtx), img.interpolate);\n    drawImageAtIntegerCoords(fillCtx, scaled, 0, 0, scaled.width, scaled.height, 0, 0, width, height);\n    fillCtx.globalCompositeOperation = \"source-in\";\n    const inverse = Util.transform(getCurrentTransformInverse(fillCtx), [1, 0, 0, 1, -offsetX, -offsetY]);\n    fillCtx.fillStyle = isPatternFill ? fillColor.getPattern(ctx, this, inverse, PathType.FILL) : fillColor;\n    fillCtx.fillRect(0, 0, width, height);\n\n    if (cache && !isPatternFill) {\n      this.cachedCanvases.delete(\"fillCanvas\");\n      cache.set(cacheKey, fillCanvas.canvas);\n    }\n\n    return {\n      canvas: fillCanvas.canvas,\n      offsetX: Math.round(offsetX),\n      offsetY: Math.round(offsetY)\n    };\n  }\n\n  setLineWidth(width) {\n    if (width !== this.current.lineWidth) {\n      this._cachedScaleForStroking[0] = -1;\n    }\n\n    this.current.lineWidth = width;\n    this.ctx.lineWidth = width;\n  }\n\n  setLineCap(style) {\n    this.ctx.lineCap = LINE_CAP_STYLES[style];\n  }\n\n  setLineJoin(style) {\n    this.ctx.lineJoin = LINE_JOIN_STYLES[style];\n  }\n\n  setMiterLimit(limit) {\n    this.ctx.miterLimit = limit;\n  }\n\n  setDash(dashArray, dashPhase) {\n    const ctx = this.ctx;\n\n    if (ctx.setLineDash !== undefined) {\n      ctx.setLineDash(dashArray);\n      ctx.lineDashOffset = dashPhase;\n    }\n  }\n\n  setRenderingIntent(intent) {}\n\n  setFlatness(flatness) {}\n\n  setGState(states) {\n    for (const [key, value] of states) {\n      switch (key) {\n        case \"LW\":\n          this.setLineWidth(value);\n          break;\n\n        case \"LC\":\n          this.setLineCap(value);\n          break;\n\n        case \"LJ\":\n          this.setLineJoin(value);\n          break;\n\n        case \"ML\":\n          this.setMiterLimit(value);\n          break;\n\n        case \"D\":\n          this.setDash(value[0], value[1]);\n          break;\n\n        case \"RI\":\n          this.setRenderingIntent(value);\n          break;\n\n        case \"FL\":\n          this.setFlatness(value);\n          break;\n\n        case \"Font\":\n          this.setFont(value[0], value[1]);\n          break;\n\n        case \"CA\":\n          this.current.strokeAlpha = value;\n          break;\n\n        case \"ca\":\n          this.current.fillAlpha = value;\n          this.ctx.globalAlpha = value;\n          break;\n\n        case \"BM\":\n          this.ctx.globalCompositeOperation = value;\n          break;\n\n        case \"SMask\":\n          this.current.activeSMask = value ? this.tempSMask : null;\n          this.tempSMask = null;\n          this.checkSMaskState();\n          break;\n\n        case \"TR\":\n          this.ctx.filter = this.current.transferMaps = this.filterFactory.addFilter(value);\n          break;\n      }\n    }\n  }\n\n  get inSMaskMode() {\n    return !!this.suspendedCtx;\n  }\n\n  checkSMaskState() {\n    const inSMaskMode = this.inSMaskMode;\n\n    if (this.current.activeSMask && !inSMaskMode) {\n      this.beginSMaskMode();\n    } else if (!this.current.activeSMask && inSMaskMode) {\n      this.endSMaskMode();\n    }\n  }\n\n  beginSMaskMode() {\n    if (this.inSMaskMode) {\n      throw new Error(\"beginSMaskMode called while already in smask mode\");\n    }\n\n    const drawnWidth = this.ctx.canvas.width;\n    const drawnHeight = this.ctx.canvas.height;\n    const cacheId = \"smaskGroupAt\" + this.groupLevel;\n    const scratchCanvas = this.cachedCanvases.getCanvas(cacheId, drawnWidth, drawnHeight);\n    this.suspendedCtx = this.ctx;\n    this.ctx = scratchCanvas.context;\n    const ctx = this.ctx;\n    ctx.setTransform(...getCurrentTransform(this.suspendedCtx));\n    copyCtxState(this.suspendedCtx, ctx);\n    mirrorContextOperations(ctx, this.suspendedCtx);\n    this.setGState([[\"BM\", \"source-over\"], [\"ca\", 1], [\"CA\", 1]]);\n  }\n\n  endSMaskMode() {\n    if (!this.inSMaskMode) {\n      throw new Error(\"endSMaskMode called while not in smask mode\");\n    }\n\n    this.ctx._removeMirroring();\n\n    copyCtxState(this.ctx, this.suspendedCtx);\n    this.ctx = this.suspendedCtx;\n    this.suspendedCtx = null;\n  }\n\n  compose(dirtyBox) {\n    if (!this.current.activeSMask) {\n      return;\n    }\n\n    if (!dirtyBox) {\n      dirtyBox = [0, 0, this.ctx.canvas.width, this.ctx.canvas.height];\n    } else {\n      dirtyBox[0] = Math.floor(dirtyBox[0]);\n      dirtyBox[1] = Math.floor(dirtyBox[1]);\n      dirtyBox[2] = Math.ceil(dirtyBox[2]);\n      dirtyBox[3] = Math.ceil(dirtyBox[3]);\n    }\n\n    const smask = this.current.activeSMask;\n    const suspendedCtx = this.suspendedCtx;\n    this.composeSMask(suspendedCtx, smask, this.ctx, dirtyBox);\n    this.ctx.save();\n    this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n    this.ctx.restore();\n  }\n\n  composeSMask(ctx, smask, layerCtx, layerBox) {\n    const layerOffsetX = layerBox[0];\n    const layerOffsetY = layerBox[1];\n    const layerWidth = layerBox[2] - layerOffsetX;\n    const layerHeight = layerBox[3] - layerOffsetY;\n\n    if (layerWidth === 0 || layerHeight === 0) {\n      return;\n    }\n\n    this.genericComposeSMask(smask.context, layerCtx, layerWidth, layerHeight, smask.subtype, smask.backdrop, smask.transferMap, layerOffsetX, layerOffsetY, smask.offsetX, smask.offsetY);\n    ctx.save();\n    ctx.globalAlpha = 1;\n    ctx.globalCompositeOperation = \"source-over\";\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.drawImage(layerCtx.canvas, 0, 0);\n    ctx.restore();\n  }\n\n  genericComposeSMask(maskCtx, layerCtx, width, height, subtype, backdrop, transferMap, layerOffsetX, layerOffsetY, maskOffsetX, maskOffsetY) {\n    let maskCanvas = maskCtx.canvas;\n    let maskX = layerOffsetX - maskOffsetX;\n    let maskY = layerOffsetY - maskOffsetY;\n\n    if (backdrop) {\n      if (maskX < 0 || maskY < 0 || maskX + width > maskCanvas.width || maskY + height > maskCanvas.height) {\n        const canvas = this.cachedCanvases.getCanvas(\"maskExtension\", width, height);\n        const ctx = canvas.context;\n        ctx.drawImage(maskCanvas, -maskX, -maskY);\n\n        if (backdrop.some(c => c !== 0)) {\n          ctx.globalCompositeOperation = \"destination-atop\";\n          ctx.fillStyle = Util.makeHexColor(...backdrop);\n          ctx.fillRect(0, 0, width, height);\n          ctx.globalCompositeOperation = \"source-over\";\n        }\n\n        maskCanvas = canvas.canvas;\n        maskX = maskY = 0;\n      } else if (backdrop.some(c => c !== 0)) {\n        maskCtx.save();\n        maskCtx.globalAlpha = 1;\n        maskCtx.setTransform(1, 0, 0, 1, 0, 0);\n        const clip = new Path2D();\n        clip.rect(maskX, maskY, width, height);\n        maskCtx.clip(clip);\n        maskCtx.globalCompositeOperation = \"destination-atop\";\n        maskCtx.fillStyle = Util.makeHexColor(...backdrop);\n        maskCtx.fillRect(maskX, maskY, width, height);\n        maskCtx.restore();\n      }\n    }\n\n    layerCtx.save();\n    layerCtx.globalAlpha = 1;\n    layerCtx.setTransform(1, 0, 0, 1, 0, 0);\n\n    if (subtype === \"Alpha\" && transferMap) {\n      layerCtx.filter = this.filterFactory.addAlphaFilter(transferMap);\n    } else if (subtype === \"Luminosity\") {\n      layerCtx.filter = this.filterFactory.addLuminosityFilter(transferMap);\n    }\n\n    const clip = new Path2D();\n    clip.rect(layerOffsetX, layerOffsetY, width, height);\n    layerCtx.clip(clip);\n    layerCtx.globalCompositeOperation = \"destination-in\";\n    layerCtx.drawImage(maskCanvas, maskX, maskY, width, height, layerOffsetX, layerOffsetY, width, height);\n    layerCtx.restore();\n  }\n\n  save() {\n    if (this.inSMaskMode) {\n      copyCtxState(this.ctx, this.suspendedCtx);\n      this.suspendedCtx.save();\n    } else {\n      this.ctx.save();\n    }\n\n    const old = this.current;\n    this.stateStack.push(old);\n    this.current = old.clone();\n  }\n\n  restore() {\n    if (this.stateStack.length === 0 && this.inSMaskMode) {\n      this.endSMaskMode();\n    }\n\n    if (this.stateStack.length !== 0) {\n      this.current = this.stateStack.pop();\n\n      if (this.inSMaskMode) {\n        this.suspendedCtx.restore();\n        copyCtxState(this.suspendedCtx, this.ctx);\n      } else {\n        this.ctx.restore();\n      }\n\n      this.checkSMaskState();\n      this.pendingClip = null;\n      this._cachedScaleForStroking[0] = -1;\n      this._cachedGetSinglePixelWidth = null;\n    }\n  }\n\n  transform(a, b, c, d, e, f) {\n    this.ctx.transform(a, b, c, d, e, f);\n    this._cachedScaleForStroking[0] = -1;\n    this._cachedGetSinglePixelWidth = null;\n  }\n\n  constructPath(ops, args, minMax) {\n    const ctx = this.ctx;\n    const current = this.current;\n    let x = current.x,\n        y = current.y;\n    let startX, startY;\n    const currentTransform = getCurrentTransform(ctx);\n    const isScalingMatrix = currentTransform[0] === 0 && currentTransform[3] === 0 || currentTransform[1] === 0 && currentTransform[2] === 0;\n    const minMaxForBezier = isScalingMatrix ? minMax.slice(0) : null;\n\n    for (let i = 0, j = 0, ii = ops.length; i < ii; i++) {\n      switch (ops[i] | 0) {\n        case OPS.rectangle:\n          x = args[j++];\n          y = args[j++];\n          const width = args[j++];\n          const height = args[j++];\n          const xw = x + width;\n          const yh = y + height;\n          ctx.moveTo(x, y);\n\n          if (width === 0 || height === 0) {\n            ctx.lineTo(xw, yh);\n          } else {\n            ctx.lineTo(xw, y);\n            ctx.lineTo(xw, yh);\n            ctx.lineTo(x, yh);\n          }\n\n          if (!isScalingMatrix) {\n            current.updateRectMinMax(currentTransform, [x, y, xw, yh]);\n          }\n\n          ctx.closePath();\n          break;\n\n        case OPS.moveTo:\n          x = args[j++];\n          y = args[j++];\n          ctx.moveTo(x, y);\n\n          if (!isScalingMatrix) {\n            current.updatePathMinMax(currentTransform, x, y);\n          }\n\n          break;\n\n        case OPS.lineTo:\n          x = args[j++];\n          y = args[j++];\n          ctx.lineTo(x, y);\n\n          if (!isScalingMatrix) {\n            current.updatePathMinMax(currentTransform, x, y);\n          }\n\n          break;\n\n        case OPS.curveTo:\n          startX = x;\n          startY = y;\n          x = args[j + 4];\n          y = args[j + 5];\n          ctx.bezierCurveTo(args[j], args[j + 1], args[j + 2], args[j + 3], x, y);\n          current.updateCurvePathMinMax(currentTransform, startX, startY, args[j], args[j + 1], args[j + 2], args[j + 3], x, y, minMaxForBezier);\n          j += 6;\n          break;\n\n        case OPS.curveTo2:\n          startX = x;\n          startY = y;\n          ctx.bezierCurveTo(x, y, args[j], args[j + 1], args[j + 2], args[j + 3]);\n          current.updateCurvePathMinMax(currentTransform, startX, startY, x, y, args[j], args[j + 1], args[j + 2], args[j + 3], minMaxForBezier);\n          x = args[j + 2];\n          y = args[j + 3];\n          j += 4;\n          break;\n\n        case OPS.curveTo3:\n          startX = x;\n          startY = y;\n          x = args[j + 2];\n          y = args[j + 3];\n          ctx.bezierCurveTo(args[j], args[j + 1], x, y, x, y);\n          current.updateCurvePathMinMax(currentTransform, startX, startY, args[j], args[j + 1], x, y, x, y, minMaxForBezier);\n          j += 4;\n          break;\n\n        case OPS.closePath:\n          ctx.closePath();\n          break;\n      }\n    }\n\n    if (isScalingMatrix) {\n      current.updateScalingPathMinMax(currentTransform, minMaxForBezier);\n    }\n\n    current.setCurrentPoint(x, y);\n  }\n\n  closePath() {\n    this.ctx.closePath();\n  }\n\n  stroke(consumePath = true) {\n    const ctx = this.ctx;\n    const strokeColor = this.current.strokeColor;\n    ctx.globalAlpha = this.current.strokeAlpha;\n\n    if (this.contentVisible) {\n      if (typeof strokeColor === \"object\" && strokeColor?.getPattern) {\n        ctx.save();\n        ctx.strokeStyle = strokeColor.getPattern(ctx, this, getCurrentTransformInverse(ctx), PathType.STROKE);\n        this.rescaleAndStroke(false);\n        ctx.restore();\n      } else {\n        this.rescaleAndStroke(true);\n      }\n    }\n\n    if (consumePath) {\n      this.consumePath(this.current.getClippedPathBoundingBox());\n    }\n\n    ctx.globalAlpha = this.current.fillAlpha;\n  }\n\n  closeStroke() {\n    this.closePath();\n    this.stroke();\n  }\n\n  fill(consumePath = true) {\n    const ctx = this.ctx;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n    let needRestore = false;\n\n    if (isPatternFill) {\n      ctx.save();\n      ctx.fillStyle = fillColor.getPattern(ctx, this, getCurrentTransformInverse(ctx), PathType.FILL);\n      needRestore = true;\n    }\n\n    const intersect = this.current.getClippedPathBoundingBox();\n\n    if (this.contentVisible && intersect !== null) {\n      if (this.pendingEOFill) {\n        ctx.fill(\"evenodd\");\n        this.pendingEOFill = false;\n      } else {\n        ctx.fill();\n      }\n    }\n\n    if (needRestore) {\n      ctx.restore();\n    }\n\n    if (consumePath) {\n      this.consumePath(intersect);\n    }\n  }\n\n  eoFill() {\n    this.pendingEOFill = true;\n    this.fill();\n  }\n\n  fillStroke() {\n    this.fill(false);\n    this.stroke(false);\n    this.consumePath();\n  }\n\n  eoFillStroke() {\n    this.pendingEOFill = true;\n    this.fillStroke();\n  }\n\n  closeFillStroke() {\n    this.closePath();\n    this.fillStroke();\n  }\n\n  closeEOFillStroke() {\n    this.pendingEOFill = true;\n    this.closePath();\n    this.fillStroke();\n  }\n\n  endPath() {\n    this.consumePath();\n  }\n\n  clip() {\n    this.pendingClip = NORMAL_CLIP;\n  }\n\n  eoClip() {\n    this.pendingClip = EO_CLIP;\n  }\n\n  beginText() {\n    this.current.textMatrix = IDENTITY_MATRIX;\n    this.current.textMatrixScale = 1;\n    this.current.x = this.current.lineX = 0;\n    this.current.y = this.current.lineY = 0;\n  }\n\n  endText() {\n    const paths = this.pendingTextPaths;\n    const ctx = this.ctx;\n\n    if (paths === undefined) {\n      ctx.beginPath();\n      return;\n    }\n\n    ctx.save();\n    ctx.beginPath();\n\n    for (const path of paths) {\n      ctx.setTransform(...path.transform);\n      ctx.translate(path.x, path.y);\n      path.addToPath(ctx, path.fontSize);\n    }\n\n    ctx.restore();\n    ctx.clip();\n    ctx.beginPath();\n    delete this.pendingTextPaths;\n  }\n\n  setCharSpacing(spacing) {\n    this.current.charSpacing = spacing;\n  }\n\n  setWordSpacing(spacing) {\n    this.current.wordSpacing = spacing;\n  }\n\n  setHScale(scale) {\n    this.current.textHScale = scale / 100;\n  }\n\n  setLeading(leading) {\n    this.current.leading = -leading;\n  }\n\n  setFont(fontRefName, size) {\n    const fontObj = this.commonObjs.get(fontRefName);\n    const current = this.current;\n\n    if (!fontObj) {\n      throw new Error(`Can't find font for ${fontRefName}`);\n    }\n\n    current.fontMatrix = fontObj.fontMatrix || FONT_IDENTITY_MATRIX;\n\n    if (current.fontMatrix[0] === 0 || current.fontMatrix[3] === 0) {\n      warn(\"Invalid font matrix for font \" + fontRefName);\n    }\n\n    if (size < 0) {\n      size = -size;\n      current.fontDirection = -1;\n    } else {\n      current.fontDirection = 1;\n    }\n\n    this.current.font = fontObj;\n    this.current.fontSize = size;\n\n    if (fontObj.isType3Font) {\n      return;\n    }\n\n    const name = fontObj.loadedName || \"sans-serif\";\n    const typeface = fontObj.systemFontInfo?.css || `\"${name}\", ${fontObj.fallbackName}`;\n    let bold = \"normal\";\n\n    if (fontObj.black) {\n      bold = \"900\";\n    } else if (fontObj.bold) {\n      bold = \"bold\";\n    }\n\n    const italic = fontObj.italic ? \"italic\" : \"normal\";\n    let browserFontSize = size;\n\n    if (size < MIN_FONT_SIZE) {\n      browserFontSize = MIN_FONT_SIZE;\n    } else if (size > MAX_FONT_SIZE) {\n      browserFontSize = MAX_FONT_SIZE;\n    }\n\n    this.current.fontSizeScale = size / browserFontSize;\n    this.ctx.font = `${italic} ${bold} ${browserFontSize}px ${typeface}`;\n  }\n\n  setTextRenderingMode(mode) {\n    this.current.textRenderingMode = mode;\n  }\n\n  setTextRise(rise) {\n    this.current.textRise = rise;\n  }\n\n  moveText(x, y) {\n    this.current.x = this.current.lineX += x;\n    this.current.y = this.current.lineY += y;\n  }\n\n  setLeadingMoveText(x, y) {\n    this.setLeading(-y);\n    this.moveText(x, y);\n  }\n\n  setTextMatrix(a, b, c, d, e, f) {\n    this.current.textMatrix = [a, b, c, d, e, f];\n    this.current.textMatrixScale = Math.hypot(a, b);\n    this.current.x = this.current.lineX = 0;\n    this.current.y = this.current.lineY = 0;\n  }\n\n  nextLine() {\n    this.moveText(0, this.current.leading);\n  }\n\n  paintChar(character, x, y, patternTransform) {\n    const ctx = this.ctx;\n    const current = this.current;\n    const font = current.font;\n    const textRenderingMode = current.textRenderingMode;\n    const fontSize = current.fontSize / current.fontSizeScale;\n    const fillStrokeMode = textRenderingMode & TextRenderingMode.FILL_STROKE_MASK;\n    const isAddToPathSet = !!(textRenderingMode & TextRenderingMode.ADD_TO_PATH_FLAG);\n    const patternFill = current.patternFill && !font.missingFile;\n    let addToPath;\n\n    if (font.disableFontFace || isAddToPathSet || patternFill) {\n      addToPath = font.getPathGenerator(this.commonObjs, character);\n    }\n\n    if (font.disableFontFace || patternFill) {\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.beginPath();\n      addToPath(ctx, fontSize);\n\n      if (patternTransform) {\n        ctx.setTransform(...patternTransform);\n      }\n\n      if (fillStrokeMode === TextRenderingMode.FILL || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        ctx.fill();\n      }\n\n      if (fillStrokeMode === TextRenderingMode.STROKE || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        ctx.stroke();\n      }\n\n      ctx.restore();\n    } else {\n      if (fillStrokeMode === TextRenderingMode.FILL || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        ctx.fillText(character, x, y);\n      }\n\n      if (fillStrokeMode === TextRenderingMode.STROKE || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        ctx.strokeText(character, x, y);\n      }\n    }\n\n    if (isAddToPathSet) {\n      const paths = this.pendingTextPaths ||= [];\n      paths.push({\n        transform: getCurrentTransform(ctx),\n        x,\n        y,\n        fontSize,\n        addToPath\n      });\n    }\n  }\n\n  get isFontSubpixelAAEnabled() {\n    const {\n      context: ctx\n    } = this.cachedCanvases.getCanvas(\"isFontSubpixelAAEnabled\", 10, 10);\n    ctx.scale(1.5, 1);\n    ctx.fillText(\"I\", 0, 10);\n    const data = ctx.getImageData(0, 0, 10, 10).data;\n    let enabled = false;\n\n    for (let i = 3; i < data.length; i += 4) {\n      if (data[i] > 0 && data[i] < 255) {\n        enabled = true;\n        break;\n      }\n    }\n\n    return shadow(this, \"isFontSubpixelAAEnabled\", enabled);\n  }\n\n  showText(glyphs) {\n    const current = this.current;\n    const font = current.font;\n\n    if (font.isType3Font) {\n      return this.showType3Text(glyphs);\n    }\n\n    const fontSize = current.fontSize;\n\n    if (fontSize === 0) {\n      return undefined;\n    }\n\n    const ctx = this.ctx;\n    const fontSizeScale = current.fontSizeScale;\n    const charSpacing = current.charSpacing;\n    const wordSpacing = current.wordSpacing;\n    const fontDirection = current.fontDirection;\n    const textHScale = current.textHScale * fontDirection;\n    const glyphsLength = glyphs.length;\n    const vertical = font.vertical;\n    const spacingDir = vertical ? 1 : -1;\n    const defaultVMetrics = font.defaultVMetrics;\n    const widthAdvanceScale = fontSize * current.fontMatrix[0];\n    const simpleFillText = current.textRenderingMode === TextRenderingMode.FILL && !font.disableFontFace && !current.patternFill;\n    ctx.save();\n    ctx.transform(...current.textMatrix);\n    ctx.translate(current.x, current.y + current.textRise);\n\n    if (fontDirection > 0) {\n      ctx.scale(textHScale, -1);\n    } else {\n      ctx.scale(textHScale, 1);\n    }\n\n    let patternTransform;\n\n    if (current.patternFill) {\n      ctx.save();\n      const pattern = current.fillColor.getPattern(ctx, this, getCurrentTransformInverse(ctx), PathType.FILL);\n      patternTransform = getCurrentTransform(ctx);\n      ctx.restore();\n      ctx.fillStyle = pattern;\n    }\n\n    let lineWidth = current.lineWidth;\n    const scale = current.textMatrixScale;\n\n    if (scale === 0 || lineWidth === 0) {\n      const fillStrokeMode = current.textRenderingMode & TextRenderingMode.FILL_STROKE_MASK;\n\n      if (fillStrokeMode === TextRenderingMode.STROKE || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        lineWidth = this.getSinglePixelWidth();\n      }\n    } else {\n      lineWidth /= scale;\n    }\n\n    if (fontSizeScale !== 1.0) {\n      ctx.scale(fontSizeScale, fontSizeScale);\n      lineWidth /= fontSizeScale;\n    }\n\n    ctx.lineWidth = lineWidth;\n\n    if (font.isInvalidPDFjsFont) {\n      const chars = [];\n      let width = 0;\n\n      for (const glyph of glyphs) {\n        chars.push(glyph.unicode);\n        width += glyph.width;\n      }\n\n      ctx.fillText(chars.join(\"\"), 0, 0);\n      current.x += width * widthAdvanceScale * textHScale;\n      ctx.restore();\n      this.compose();\n      return undefined;\n    }\n\n    let x = 0,\n        i;\n\n    for (i = 0; i < glyphsLength; ++i) {\n      const glyph = glyphs[i];\n\n      if (typeof glyph === \"number\") {\n        x += spacingDir * glyph * fontSize / 1000;\n        continue;\n      }\n\n      let restoreNeeded = false;\n      const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n      const character = glyph.fontChar;\n      const accent = glyph.accent;\n      let scaledX, scaledY;\n      let width = glyph.width;\n\n      if (vertical) {\n        const vmetric = glyph.vmetric || defaultVMetrics;\n        const vx = -(glyph.vmetric ? vmetric[1] : width * 0.5) * widthAdvanceScale;\n        const vy = vmetric[2] * widthAdvanceScale;\n        width = vmetric ? -vmetric[0] : width;\n        scaledX = vx / fontSizeScale;\n        scaledY = (x + vy) / fontSizeScale;\n      } else {\n        scaledX = x / fontSizeScale;\n        scaledY = 0;\n      }\n\n      if (font.remeasure && width > 0) {\n        const measuredWidth = ctx.measureText(character).width * 1000 / fontSize * fontSizeScale;\n\n        if (width < measuredWidth && this.isFontSubpixelAAEnabled) {\n          const characterScaleX = width / measuredWidth;\n          restoreNeeded = true;\n          ctx.save();\n          ctx.scale(characterScaleX, 1);\n          scaledX /= characterScaleX;\n        } else if (width !== measuredWidth) {\n          scaledX += (width - measuredWidth) / 2000 * fontSize / fontSizeScale;\n        }\n      }\n\n      if (this.contentVisible && (glyph.isInFont || font.missingFile)) {\n        if (simpleFillText && !accent) {\n          ctx.fillText(character, scaledX, scaledY);\n        } else {\n          this.paintChar(character, scaledX, scaledY, patternTransform);\n\n          if (accent) {\n            const scaledAccentX = scaledX + fontSize * accent.offset.x / fontSizeScale;\n            const scaledAccentY = scaledY - fontSize * accent.offset.y / fontSizeScale;\n            this.paintChar(accent.fontChar, scaledAccentX, scaledAccentY, patternTransform);\n          }\n        }\n      }\n\n      const charWidth = vertical ? width * widthAdvanceScale - spacing * fontDirection : width * widthAdvanceScale + spacing * fontDirection;\n      x += charWidth;\n\n      if (restoreNeeded) {\n        ctx.restore();\n      }\n    }\n\n    if (vertical) {\n      current.y -= x;\n    } else {\n      current.x += x * textHScale;\n    }\n\n    ctx.restore();\n    this.compose();\n    return undefined;\n  }\n\n  showType3Text(glyphs) {\n    const ctx = this.ctx;\n    const current = this.current;\n    const font = current.font;\n    const fontSize = current.fontSize;\n    const fontDirection = current.fontDirection;\n    const spacingDir = font.vertical ? 1 : -1;\n    const charSpacing = current.charSpacing;\n    const wordSpacing = current.wordSpacing;\n    const textHScale = current.textHScale * fontDirection;\n    const fontMatrix = current.fontMatrix || FONT_IDENTITY_MATRIX;\n    const glyphsLength = glyphs.length;\n    const isTextInvisible = current.textRenderingMode === TextRenderingMode.INVISIBLE;\n    let i, glyph, width, spacingLength;\n\n    if (isTextInvisible || fontSize === 0) {\n      return;\n    }\n\n    this._cachedScaleForStroking[0] = -1;\n    this._cachedGetSinglePixelWidth = null;\n    ctx.save();\n    ctx.transform(...current.textMatrix);\n    ctx.translate(current.x, current.y);\n    ctx.scale(textHScale, fontDirection);\n\n    for (i = 0; i < glyphsLength; ++i) {\n      glyph = glyphs[i];\n\n      if (typeof glyph === \"number\") {\n        spacingLength = spacingDir * glyph * fontSize / 1000;\n        this.ctx.translate(spacingLength, 0);\n        current.x += spacingLength * textHScale;\n        continue;\n      }\n\n      const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n      const operatorList = font.charProcOperatorList[glyph.operatorListId];\n\n      if (!operatorList) {\n        warn(`Type3 character \"${glyph.operatorListId}\" is not available.`);\n        continue;\n      }\n\n      if (this.contentVisible) {\n        this.processingType3 = glyph;\n        this.save();\n        ctx.scale(fontSize, fontSize);\n        ctx.transform(...fontMatrix);\n        this.executeOperatorList(operatorList);\n        this.restore();\n      }\n\n      const transformed = Util.applyTransform([glyph.width, 0], fontMatrix);\n      width = transformed[0] * fontSize + spacing;\n      ctx.translate(width, 0);\n      current.x += width * textHScale;\n    }\n\n    ctx.restore();\n    this.processingType3 = null;\n  }\n\n  setCharWidth(xWidth, yWidth) {}\n\n  setCharWidthAndBounds(xWidth, yWidth, llx, lly, urx, ury) {\n    this.ctx.rect(llx, lly, urx - llx, ury - lly);\n    this.ctx.clip();\n    this.endPath();\n  }\n\n  getColorN_Pattern(IR) {\n    let pattern;\n\n    if (IR[0] === \"TilingPattern\") {\n      const color = IR[1];\n      const baseTransform = this.baseTransform || getCurrentTransform(this.ctx);\n      const canvasGraphicsFactory = {\n        createCanvasGraphics: ctx => new CanvasGraphics(ctx, this.commonObjs, this.objs, this.canvasFactory, this.filterFactory, {\n          optionalContentConfig: this.optionalContentConfig,\n          markedContentStack: this.markedContentStack\n        })\n      };\n      pattern = new TilingPattern(IR, color, this.ctx, canvasGraphicsFactory, baseTransform);\n    } else {\n      pattern = this._getPattern(IR[1], IR[2]);\n    }\n\n    return pattern;\n  }\n\n  setStrokeColorN() {\n    this.current.strokeColor = this.getColorN_Pattern(arguments);\n  }\n\n  setFillColorN() {\n    this.current.fillColor = this.getColorN_Pattern(arguments);\n    this.current.patternFill = true;\n  }\n\n  setStrokeRGBColor(r, g, b) {\n    this.ctx.strokeStyle = this.current.strokeColor = Util.makeHexColor(r, g, b);\n  }\n\n  setStrokeTransparent() {\n    this.ctx.strokeStyle = this.current.strokeColor = \"transparent\";\n  }\n\n  setFillRGBColor(r, g, b) {\n    this.ctx.fillStyle = this.current.fillColor = Util.makeHexColor(r, g, b);\n    this.current.patternFill = false;\n  }\n\n  setFillTransparent() {\n    this.ctx.fillStyle = this.current.fillColor = \"transparent\";\n    this.current.patternFill = false;\n  }\n\n  _getPattern(objId, matrix = null) {\n    let pattern;\n\n    if (this.cachedPatterns.has(objId)) {\n      pattern = this.cachedPatterns.get(objId);\n    } else {\n      pattern = getShadingPattern(this.getObject(objId));\n      this.cachedPatterns.set(objId, pattern);\n    }\n\n    if (matrix) {\n      pattern.matrix = matrix;\n    }\n\n    return pattern;\n  }\n\n  shadingFill(objId) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    const ctx = this.ctx;\n    this.save();\n\n    const pattern = this._getPattern(objId);\n\n    ctx.fillStyle = pattern.getPattern(ctx, this, getCurrentTransformInverse(ctx), PathType.SHADING);\n    const inv = getCurrentTransformInverse(ctx);\n\n    if (inv) {\n      const {\n        width,\n        height\n      } = ctx.canvas;\n      const [x0, y0, x1, y1] = Util.getAxialAlignedBoundingBox([0, 0, width, height], inv);\n      this.ctx.fillRect(x0, y0, x1 - x0, y1 - y0);\n    } else {\n      this.ctx.fillRect(-1e10, -1e10, 2e10, 2e10);\n    }\n\n    this.compose(this.current.getClippedPathBoundingBox());\n    this.restore();\n  }\n\n  beginInlineImage() {\n    unreachable(\"Should not call beginInlineImage\");\n  }\n\n  beginImageData() {\n    unreachable(\"Should not call beginImageData\");\n  }\n\n  paintFormXObjectBegin(matrix, bbox) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    this.save();\n    this.baseTransformStack.push(this.baseTransform);\n\n    if (matrix) {\n      this.transform(...matrix);\n    }\n\n    this.baseTransform = getCurrentTransform(this.ctx);\n\n    if (bbox) {\n      const width = bbox[2] - bbox[0];\n      const height = bbox[3] - bbox[1];\n      this.ctx.rect(bbox[0], bbox[1], width, height);\n      this.current.updateRectMinMax(getCurrentTransform(this.ctx), bbox);\n      this.clip();\n      this.endPath();\n    }\n  }\n\n  paintFormXObjectEnd() {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    this.restore();\n    this.baseTransform = this.baseTransformStack.pop();\n  }\n\n  beginGroup(group) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    this.save();\n\n    if (this.inSMaskMode) {\n      this.endSMaskMode();\n      this.current.activeSMask = null;\n    }\n\n    const currentCtx = this.ctx;\n\n    if (!group.isolated) {\n      info(\"TODO: Support non-isolated groups.\");\n    }\n\n    if (group.knockout) {\n      warn(\"Knockout groups not supported.\");\n    }\n\n    const currentTransform = getCurrentTransform(currentCtx);\n\n    if (group.matrix) {\n      currentCtx.transform(...group.matrix);\n    }\n\n    if (!group.bbox) {\n      throw new Error(\"Bounding box is required.\");\n    }\n\n    let bounds = Util.getAxialAlignedBoundingBox(group.bbox, getCurrentTransform(currentCtx));\n    const canvasBounds = [0, 0, currentCtx.canvas.width, currentCtx.canvas.height];\n    bounds = Util.intersect(bounds, canvasBounds) || [0, 0, 0, 0];\n    const offsetX = Math.floor(bounds[0]);\n    const offsetY = Math.floor(bounds[1]);\n    const drawnWidth = Math.max(Math.ceil(bounds[2]) - offsetX, 1);\n    const drawnHeight = Math.max(Math.ceil(bounds[3]) - offsetY, 1);\n    this.current.startNewPathAndClipBox([0, 0, drawnWidth, drawnHeight]);\n    let cacheId = \"groupAt\" + this.groupLevel;\n\n    if (group.smask) {\n      cacheId += \"_smask_\" + this.smaskCounter++ % 2;\n    }\n\n    const scratchCanvas = this.cachedCanvases.getCanvas(cacheId, drawnWidth, drawnHeight);\n    const groupCtx = scratchCanvas.context;\n    groupCtx.translate(-offsetX, -offsetY);\n    groupCtx.transform(...currentTransform);\n\n    if (group.smask) {\n      this.smaskStack.push({\n        canvas: scratchCanvas.canvas,\n        context: groupCtx,\n        offsetX,\n        offsetY,\n        subtype: group.smask.subtype,\n        backdrop: group.smask.backdrop,\n        transferMap: group.smask.transferMap || null,\n        startTransformInverse: null\n      });\n    } else {\n      currentCtx.setTransform(1, 0, 0, 1, 0, 0);\n      currentCtx.translate(offsetX, offsetY);\n      currentCtx.save();\n    }\n\n    copyCtxState(currentCtx, groupCtx);\n    this.ctx = groupCtx;\n    this.setGState([[\"BM\", \"source-over\"], [\"ca\", 1], [\"CA\", 1]]);\n    this.groupStack.push(currentCtx);\n    this.groupLevel++;\n  }\n\n  endGroup(group) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    this.groupLevel--;\n    const groupCtx = this.ctx;\n    const ctx = this.groupStack.pop();\n    this.ctx = ctx;\n    this.ctx.imageSmoothingEnabled = false;\n\n    if (group.smask) {\n      this.tempSMask = this.smaskStack.pop();\n      this.restore();\n    } else {\n      this.ctx.restore();\n      const currentMtx = getCurrentTransform(this.ctx);\n      this.restore();\n      this.ctx.save();\n      this.ctx.setTransform(...currentMtx);\n      const dirtyBox = Util.getAxialAlignedBoundingBox([0, 0, groupCtx.canvas.width, groupCtx.canvas.height], currentMtx);\n      this.ctx.drawImage(groupCtx.canvas, 0, 0);\n      this.ctx.restore();\n      this.compose(dirtyBox);\n    }\n  }\n\n  beginAnnotation(id, rect, transform, matrix, hasOwnCanvas) {\n    this.#restoreInitialState();\n    resetCtxToDefault(this.ctx);\n    this.ctx.save();\n    this.save();\n\n    if (this.baseTransform) {\n      this.ctx.setTransform(...this.baseTransform);\n    }\n\n    if (rect) {\n      const width = rect[2] - rect[0];\n      const height = rect[3] - rect[1];\n\n      if (hasOwnCanvas && this.annotationCanvasMap) {\n        transform = transform.slice();\n        transform[4] -= rect[0];\n        transform[5] -= rect[1];\n        rect = rect.slice();\n        rect[0] = rect[1] = 0;\n        rect[2] = width;\n        rect[3] = height;\n        const [scaleX, scaleY] = Util.singularValueDecompose2dScale(getCurrentTransform(this.ctx));\n        const {\n          viewportScale\n        } = this;\n        const canvasWidth = Math.ceil(width * this.outputScaleX * viewportScale);\n        const canvasHeight = Math.ceil(height * this.outputScaleY * viewportScale);\n        this.annotationCanvas = this.canvasFactory.create(canvasWidth, canvasHeight);\n        const {\n          canvas,\n          context\n        } = this.annotationCanvas;\n        this.annotationCanvasMap.set(id, canvas);\n        this.annotationCanvas.savedCtx = this.ctx;\n        this.ctx = context;\n        this.ctx.save();\n        this.ctx.setTransform(scaleX, 0, 0, -scaleY, 0, height * scaleY);\n        resetCtxToDefault(this.ctx);\n      } else {\n        resetCtxToDefault(this.ctx);\n        this.ctx.rect(rect[0], rect[1], width, height);\n        this.ctx.clip();\n        this.endPath();\n      }\n    }\n\n    this.current = new CanvasExtraState(this.ctx.canvas.width, this.ctx.canvas.height);\n    this.transform(...transform);\n    this.transform(...matrix);\n  }\n\n  endAnnotation() {\n    if (this.annotationCanvas) {\n      this.ctx.restore();\n      this.#drawFilter();\n      this.ctx = this.annotationCanvas.savedCtx;\n      delete this.annotationCanvas.savedCtx;\n      delete this.annotationCanvas;\n    }\n  }\n\n  paintImageMaskXObject(img) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    const count = img.count;\n    img = this.getObject(img.data, img);\n    img.count = count;\n    const ctx = this.ctx;\n    const glyph = this.processingType3;\n\n    if (glyph) {\n      if (glyph.compiled === undefined) {\n        glyph.compiled = compileType3Glyph(img);\n      }\n\n      if (glyph.compiled) {\n        glyph.compiled(ctx);\n        return;\n      }\n    }\n\n    const mask = this._createMaskCanvas(img);\n\n    const maskCanvas = mask.canvas;\n    ctx.save();\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.drawImage(maskCanvas, mask.offsetX, mask.offsetY);\n    ctx.restore();\n    this.compose();\n  }\n\n  paintImageMaskXObjectRepeat(img, scaleX, skewX = 0, skewY = 0, scaleY, positions) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    img = this.getObject(img.data, img);\n    const ctx = this.ctx;\n    ctx.save();\n    const currentTransform = getCurrentTransform(ctx);\n    ctx.transform(scaleX, skewX, skewY, scaleY, 0, 0);\n\n    const mask = this._createMaskCanvas(img);\n\n    ctx.setTransform(1, 0, 0, 1, mask.offsetX - currentTransform[4], mask.offsetY - currentTransform[5]);\n\n    for (let i = 0, ii = positions.length; i < ii; i += 2) {\n      const trans = Util.transform(currentTransform, [scaleX, skewX, skewY, scaleY, positions[i], positions[i + 1]]);\n      const [x, y] = Util.applyTransform([0, 0], trans);\n      ctx.drawImage(mask.canvas, x, y);\n    }\n\n    ctx.restore();\n    this.compose();\n  }\n\n  paintImageMaskXObjectGroup(images) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    const ctx = this.ctx;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n\n    for (const image of images) {\n      const {\n        data,\n        width,\n        height,\n        transform\n      } = image;\n      const maskCanvas = this.cachedCanvases.getCanvas(\"maskCanvas\", width, height);\n      const maskCtx = maskCanvas.context;\n      maskCtx.save();\n      const img = this.getObject(data, image);\n      putBinaryImageMask(maskCtx, img);\n      maskCtx.globalCompositeOperation = \"source-in\";\n      maskCtx.fillStyle = isPatternFill ? fillColor.getPattern(maskCtx, this, getCurrentTransformInverse(ctx), PathType.FILL) : fillColor;\n      maskCtx.fillRect(0, 0, width, height);\n      maskCtx.restore();\n      ctx.save();\n      ctx.transform(...transform);\n      ctx.scale(1, -1);\n      drawImageAtIntegerCoords(ctx, maskCanvas.canvas, 0, 0, width, height, 0, -1, 1, 1);\n      ctx.restore();\n    }\n\n    this.compose();\n  }\n\n  paintImageXObject(objId) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    const imgData = this.getObject(objId);\n\n    if (!imgData) {\n      warn(\"Dependent image isn't ready yet\");\n      return;\n    }\n\n    this.paintInlineImageXObject(imgData);\n  }\n\n  paintImageXObjectRepeat(objId, scaleX, scaleY, positions) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    const imgData = this.getObject(objId);\n\n    if (!imgData) {\n      warn(\"Dependent image isn't ready yet\");\n      return;\n    }\n\n    const width = imgData.width;\n    const height = imgData.height;\n    const map = [];\n\n    for (let i = 0, ii = positions.length; i < ii; i += 2) {\n      map.push({\n        transform: [scaleX, 0, 0, scaleY, positions[i], positions[i + 1]],\n        x: 0,\n        y: 0,\n        w: width,\n        h: height\n      });\n    }\n\n    this.paintInlineImageXObjectGroup(imgData, map);\n  }\n\n  applyTransferMapsToCanvas(ctx) {\n    if (this.current.transferMaps !== \"none\") {\n      ctx.filter = this.current.transferMaps;\n      ctx.drawImage(ctx.canvas, 0, 0);\n      ctx.filter = \"none\";\n    }\n\n    return ctx.canvas;\n  }\n\n  applyTransferMapsToBitmap(imgData) {\n    if (this.current.transferMaps === \"none\") {\n      return imgData.bitmap;\n    }\n\n    const {\n      bitmap,\n      width,\n      height\n    } = imgData;\n    const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", width, height);\n    const tmpCtx = tmpCanvas.context;\n    tmpCtx.filter = this.current.transferMaps;\n    tmpCtx.drawImage(bitmap, 0, 0);\n    tmpCtx.filter = \"none\";\n    return tmpCanvas.canvas;\n  }\n\n  paintInlineImageXObject(imgData) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    const width = imgData.width;\n    const height = imgData.height;\n    const ctx = this.ctx;\n    this.save();\n\n    if (!isNodeJS) {\n      const {\n        filter\n      } = ctx;\n\n      if (filter !== \"none\" && filter !== \"\") {\n        ctx.filter = \"none\";\n      }\n    }\n\n    ctx.scale(1 / width, -1 / height);\n    let imgToPaint;\n\n    if (imgData.bitmap) {\n      imgToPaint = this.applyTransferMapsToBitmap(imgData);\n    } else if (typeof HTMLElement === \"function\" && imgData instanceof HTMLElement || !imgData.data) {\n      imgToPaint = imgData;\n    } else {\n      const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", width, height);\n      const tmpCtx = tmpCanvas.context;\n      putBinaryImageData(tmpCtx, imgData);\n      imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n    }\n\n    const scaled = this._scaleImage(imgToPaint, getCurrentTransformInverse(ctx));\n\n    ctx.imageSmoothingEnabled = getImageSmoothingEnabled(getCurrentTransform(ctx), imgData.interpolate);\n    drawImageAtIntegerCoords(ctx, scaled.img, 0, 0, scaled.paintWidth, scaled.paintHeight, 0, -height, width, height);\n    this.compose();\n    this.restore();\n  }\n\n  paintInlineImageXObjectGroup(imgData, map) {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    const ctx = this.ctx;\n    let imgToPaint;\n\n    if (imgData.bitmap) {\n      imgToPaint = imgData.bitmap;\n    } else {\n      const w = imgData.width;\n      const h = imgData.height;\n      const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", w, h);\n      const tmpCtx = tmpCanvas.context;\n      putBinaryImageData(tmpCtx, imgData);\n      imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n    }\n\n    for (const entry of map) {\n      ctx.save();\n      ctx.transform(...entry.transform);\n      ctx.scale(1, -1);\n      drawImageAtIntegerCoords(ctx, imgToPaint, entry.x, entry.y, entry.w, entry.h, 0, -1, 1, 1);\n      ctx.restore();\n    }\n\n    this.compose();\n  }\n\n  paintSolidColorImageMask() {\n    if (!this.contentVisible) {\n      return;\n    }\n\n    this.ctx.fillRect(0, 0, 1, 1);\n    this.compose();\n  }\n\n  markPoint(tag) {}\n\n  markPointProps(tag, properties) {}\n\n  beginMarkedContent(tag) {\n    this.markedContentStack.push({\n      visible: true\n    });\n  }\n\n  beginMarkedContentProps(tag, properties) {\n    if (tag === \"OC\") {\n      this.markedContentStack.push({\n        visible: this.optionalContentConfig.isVisible(properties)\n      });\n    } else {\n      this.markedContentStack.push({\n        visible: true\n      });\n    }\n\n    this.contentVisible = this.isContentVisible();\n  }\n\n  endMarkedContent() {\n    this.markedContentStack.pop();\n    this.contentVisible = this.isContentVisible();\n  }\n\n  beginCompat() {}\n\n  endCompat() {}\n\n  consumePath(clipBox) {\n    const isEmpty = this.current.isEmptyClip();\n\n    if (this.pendingClip) {\n      this.current.updateClipFromPath();\n    }\n\n    if (!this.pendingClip) {\n      this.compose(clipBox);\n    }\n\n    const ctx = this.ctx;\n\n    if (this.pendingClip) {\n      if (!isEmpty) {\n        if (this.pendingClip === EO_CLIP) {\n          ctx.clip(\"evenodd\");\n        } else {\n          ctx.clip();\n        }\n      }\n\n      this.pendingClip = null;\n    }\n\n    this.current.startNewPathAndClipBox(this.current.clipBox);\n    ctx.beginPath();\n  }\n\n  getSinglePixelWidth() {\n    if (!this._cachedGetSinglePixelWidth) {\n      const m = getCurrentTransform(this.ctx);\n\n      if (m[1] === 0 && m[2] === 0) {\n        this._cachedGetSinglePixelWidth = 1 / Math.min(Math.abs(m[0]), Math.abs(m[3]));\n      } else {\n        const absDet = Math.abs(m[0] * m[3] - m[2] * m[1]);\n        const normX = Math.hypot(m[0], m[2]);\n        const normY = Math.hypot(m[1], m[3]);\n        this._cachedGetSinglePixelWidth = Math.max(normX, normY) / absDet;\n      }\n    }\n\n    return this._cachedGetSinglePixelWidth;\n  }\n\n  getScaleForStroking() {\n    if (this._cachedScaleForStroking[0] === -1) {\n      const {\n        lineWidth\n      } = this.current;\n      const {\n        a,\n        b,\n        c,\n        d\n      } = this.ctx.getTransform();\n      let scaleX, scaleY;\n\n      if (b === 0 && c === 0) {\n        const normX = Math.abs(a);\n        const normY = Math.abs(d);\n\n        if (normX === normY) {\n          if (lineWidth === 0) {\n            scaleX = scaleY = 1 / normX;\n          } else {\n            const scaledLineWidth = normX * lineWidth;\n            scaleX = scaleY = scaledLineWidth < 1 ? 1 / scaledLineWidth : 1;\n          }\n        } else if (lineWidth === 0) {\n          scaleX = 1 / normX;\n          scaleY = 1 / normY;\n        } else {\n          const scaledXLineWidth = normX * lineWidth;\n          const scaledYLineWidth = normY * lineWidth;\n          scaleX = scaledXLineWidth < 1 ? 1 / scaledXLineWidth : 1;\n          scaleY = scaledYLineWidth < 1 ? 1 / scaledYLineWidth : 1;\n        }\n      } else {\n        const absDet = Math.abs(a * d - b * c);\n        const normX = Math.hypot(a, b);\n        const normY = Math.hypot(c, d);\n\n        if (lineWidth === 0) {\n          scaleX = normY / absDet;\n          scaleY = normX / absDet;\n        } else {\n          const baseArea = lineWidth * absDet;\n          scaleX = normY > baseArea ? normY / baseArea : 1;\n          scaleY = normX > baseArea ? normX / baseArea : 1;\n        }\n      }\n\n      this._cachedScaleForStroking[0] = scaleX;\n      this._cachedScaleForStroking[1] = scaleY;\n    }\n\n    return this._cachedScaleForStroking;\n  }\n\n  rescaleAndStroke(saveRestore) {\n    const {\n      ctx\n    } = this;\n    const {\n      lineWidth\n    } = this.current;\n    const [scaleX, scaleY] = this.getScaleForStroking();\n    ctx.lineWidth = lineWidth || 1;\n\n    if (scaleX === 1 && scaleY === 1) {\n      ctx.stroke();\n      return;\n    }\n\n    const dashes = ctx.getLineDash();\n\n    if (saveRestore) {\n      ctx.save();\n    }\n\n    ctx.scale(scaleX, scaleY);\n\n    if (dashes.length > 0) {\n      const scale = Math.max(scaleX, scaleY);\n      ctx.setLineDash(dashes.map(x => x / scale));\n      ctx.lineDashOffset /= scale;\n    }\n\n    ctx.stroke();\n\n    if (saveRestore) {\n      ctx.restore();\n    }\n  }\n\n  isContentVisible() {\n    for (let i = this.markedContentStack.length - 1; i >= 0; i--) {\n      if (!this.markedContentStack[i].visible) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n}\n\nfor (const op in OPS) {\n  if (CanvasGraphics.prototype[op] !== undefined) {\n    CanvasGraphics.prototype[OPS[op]] = CanvasGraphics.prototype[op];\n  }\n}\n\n; // CONCATENATED MODULE: ./src/display/worker_options.js\n\nclass GlobalWorkerOptions {\n  static #port = null;\n  static #src = \"\";\n\n  static get workerPort() {\n    return this.#port;\n  }\n\n  static set workerPort(val) {\n    if (!(typeof Worker !== \"undefined\" && val instanceof Worker) && val !== null) {\n      throw new Error(\"Invalid `workerPort` type.\");\n    }\n\n    this.#port = val;\n  }\n\n  static get workerSrc() {\n    return this.#src;\n  }\n\n  static set workerSrc(val) {\n    if (typeof val !== \"string\") {\n      throw new Error(\"Invalid `workerSrc` type.\");\n    }\n\n    this.#src = val;\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/shared/message_handler.js\n\nconst CallbackKind = {\n  UNKNOWN: 0,\n  DATA: 1,\n  ERROR: 2\n};\nconst StreamKind = {\n  UNKNOWN: 0,\n  CANCEL: 1,\n  CANCEL_COMPLETE: 2,\n  CLOSE: 3,\n  ENQUEUE: 4,\n  ERROR: 5,\n  PULL: 6,\n  PULL_COMPLETE: 7,\n  START_COMPLETE: 8\n};\n\nfunction wrapReason(reason) {\n  if (!(reason instanceof Error || typeof reason === \"object\" && reason !== null)) {\n    unreachable('wrapReason: Expected \"reason\" to be a (possibly cloned) Error.');\n  }\n\n  switch (reason.name) {\n    case \"AbortException\":\n      return new AbortException(reason.message);\n\n    case \"MissingPDFException\":\n      return new MissingPDFException(reason.message);\n\n    case \"PasswordException\":\n      return new PasswordException(reason.message, reason.code);\n\n    case \"UnexpectedResponseException\":\n      return new UnexpectedResponseException(reason.message, reason.status);\n\n    case \"UnknownErrorException\":\n      return new UnknownErrorException(reason.message, reason.details);\n\n    default:\n      return new UnknownErrorException(reason.message, reason.toString());\n  }\n}\n\nclass MessageHandler {\n  constructor(sourceName, targetName, comObj) {\n    this.sourceName = sourceName;\n    this.targetName = targetName;\n    this.comObj = comObj;\n    this.callbackId = 1;\n    this.streamId = 1;\n    this.streamSinks = Object.create(null);\n    this.streamControllers = Object.create(null);\n    this.callbackCapabilities = Object.create(null);\n    this.actionHandler = Object.create(null);\n\n    this._onComObjOnMessage = event => {\n      const data = event.data;\n\n      if (data.targetName !== this.sourceName) {\n        return;\n      }\n\n      if (data.stream) {\n        this.#processStreamMessage(data);\n        return;\n      }\n\n      if (data.callback) {\n        const callbackId = data.callbackId;\n        const capability = this.callbackCapabilities[callbackId];\n\n        if (!capability) {\n          throw new Error(`Cannot resolve callback ${callbackId}`);\n        }\n\n        delete this.callbackCapabilities[callbackId];\n\n        if (data.callback === CallbackKind.DATA) {\n          capability.resolve(data.data);\n        } else if (data.callback === CallbackKind.ERROR) {\n          capability.reject(wrapReason(data.reason));\n        } else {\n          throw new Error(\"Unexpected callback case\");\n        }\n\n        return;\n      }\n\n      const action = this.actionHandler[data.action];\n\n      if (!action) {\n        throw new Error(`Unknown action from worker: ${data.action}`);\n      }\n\n      if (data.callbackId) {\n        const cbSourceName = this.sourceName;\n        const cbTargetName = data.sourceName;\n        new Promise(function (resolve) {\n          resolve(action(data.data));\n        }).then(function (result) {\n          comObj.postMessage({\n            sourceName: cbSourceName,\n            targetName: cbTargetName,\n            callback: CallbackKind.DATA,\n            callbackId: data.callbackId,\n            data: result\n          });\n        }, function (reason) {\n          comObj.postMessage({\n            sourceName: cbSourceName,\n            targetName: cbTargetName,\n            callback: CallbackKind.ERROR,\n            callbackId: data.callbackId,\n            reason: wrapReason(reason)\n          });\n        });\n        return;\n      }\n\n      if (data.streamId) {\n        this.#createStreamSink(data);\n        return;\n      }\n\n      action(data.data);\n    };\n\n    comObj.addEventListener(\"message\", this._onComObjOnMessage);\n  }\n\n  on(actionName, handler) {\n    const ah = this.actionHandler;\n\n    if (ah[actionName]) {\n      throw new Error(`There is already an actionName called \"${actionName}\"`);\n    }\n\n    ah[actionName] = handler;\n  }\n\n  send(actionName, data, transfers) {\n    this.comObj.postMessage({\n      sourceName: this.sourceName,\n      targetName: this.targetName,\n      action: actionName,\n      data\n    }, transfers);\n  }\n\n  sendWithPromise(actionName, data, transfers) {\n    const callbackId = this.callbackId++;\n    const capability = Promise.withResolvers();\n    this.callbackCapabilities[callbackId] = capability;\n\n    try {\n      this.comObj.postMessage({\n        sourceName: this.sourceName,\n        targetName: this.targetName,\n        action: actionName,\n        callbackId,\n        data\n      }, transfers);\n    } catch (ex) {\n      capability.reject(ex);\n    }\n\n    return capability.promise;\n  }\n\n  sendWithStream(actionName, data, queueingStrategy, transfers) {\n    const streamId = this.streamId++,\n          sourceName = this.sourceName,\n          targetName = this.targetName,\n          comObj = this.comObj;\n    return new ReadableStream({\n      start: controller => {\n        const startCapability = Promise.withResolvers();\n        this.streamControllers[streamId] = {\n          controller,\n          startCall: startCapability,\n          pullCall: null,\n          cancelCall: null,\n          isClosed: false\n        };\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          action: actionName,\n          streamId,\n          data,\n          desiredSize: controller.desiredSize\n        }, transfers);\n        return startCapability.promise;\n      },\n      pull: controller => {\n        const pullCapability = Promise.withResolvers();\n        this.streamControllers[streamId].pullCall = pullCapability;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.PULL,\n          streamId,\n          desiredSize: controller.desiredSize\n        });\n        return pullCapability.promise;\n      },\n      cancel: reason => {\n        assert(reason instanceof Error, \"cancel must have a valid reason\");\n        const cancelCapability = Promise.withResolvers();\n        this.streamControllers[streamId].cancelCall = cancelCapability;\n        this.streamControllers[streamId].isClosed = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.CANCEL,\n          streamId,\n          reason: wrapReason(reason)\n        });\n        return cancelCapability.promise;\n      }\n    }, queueingStrategy);\n  }\n\n  #createStreamSink(data) {\n    const streamId = data.streamId,\n          sourceName = this.sourceName,\n          targetName = data.sourceName,\n          comObj = this.comObj;\n    const self = this,\n          action = this.actionHandler[data.action];\n    const streamSink = {\n      enqueue(chunk, size = 1, transfers) {\n        if (this.isCancelled) {\n          return;\n        }\n\n        const lastDesiredSize = this.desiredSize;\n        this.desiredSize -= size;\n\n        if (lastDesiredSize > 0 && this.desiredSize <= 0) {\n          this.sinkCapability = Promise.withResolvers();\n          this.ready = this.sinkCapability.promise;\n        }\n\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.ENQUEUE,\n          streamId,\n          chunk\n        }, transfers);\n      },\n\n      close() {\n        if (this.isCancelled) {\n          return;\n        }\n\n        this.isCancelled = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.CLOSE,\n          streamId\n        });\n        delete self.streamSinks[streamId];\n      },\n\n      error(reason) {\n        assert(reason instanceof Error, \"error must have a valid reason\");\n\n        if (this.isCancelled) {\n          return;\n        }\n\n        this.isCancelled = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.ERROR,\n          streamId,\n          reason: wrapReason(reason)\n        });\n      },\n\n      sinkCapability: Promise.withResolvers(),\n      onPull: null,\n      onCancel: null,\n      isCancelled: false,\n      desiredSize: data.desiredSize,\n      ready: null\n    };\n    streamSink.sinkCapability.resolve();\n    streamSink.ready = streamSink.sinkCapability.promise;\n    this.streamSinks[streamId] = streamSink;\n    new Promise(function (resolve) {\n      resolve(action(data.data, streamSink));\n    }).then(function () {\n      comObj.postMessage({\n        sourceName,\n        targetName,\n        stream: StreamKind.START_COMPLETE,\n        streamId,\n        success: true\n      });\n    }, function (reason) {\n      comObj.postMessage({\n        sourceName,\n        targetName,\n        stream: StreamKind.START_COMPLETE,\n        streamId,\n        reason: wrapReason(reason)\n      });\n    });\n  }\n\n  #processStreamMessage(data) {\n    const streamId = data.streamId,\n          sourceName = this.sourceName,\n          targetName = data.sourceName,\n          comObj = this.comObj;\n    const streamController = this.streamControllers[streamId],\n          streamSink = this.streamSinks[streamId];\n\n    switch (data.stream) {\n      case StreamKind.START_COMPLETE:\n        if (data.success) {\n          streamController.startCall.resolve();\n        } else {\n          streamController.startCall.reject(wrapReason(data.reason));\n        }\n\n        break;\n\n      case StreamKind.PULL_COMPLETE:\n        if (data.success) {\n          streamController.pullCall.resolve();\n        } else {\n          streamController.pullCall.reject(wrapReason(data.reason));\n        }\n\n        break;\n\n      case StreamKind.PULL:\n        if (!streamSink) {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL_COMPLETE,\n            streamId,\n            success: true\n          });\n          break;\n        }\n\n        if (streamSink.desiredSize <= 0 && data.desiredSize > 0) {\n          streamSink.sinkCapability.resolve();\n        }\n\n        streamSink.desiredSize = data.desiredSize;\n        new Promise(function (resolve) {\n          resolve(streamSink.onPull?.());\n        }).then(function () {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL_COMPLETE,\n            streamId,\n            success: true\n          });\n        }, function (reason) {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL_COMPLETE,\n            streamId,\n            reason: wrapReason(reason)\n          });\n        });\n        break;\n\n      case StreamKind.ENQUEUE:\n        assert(streamController, \"enqueue should have stream controller\");\n\n        if (streamController.isClosed) {\n          break;\n        }\n\n        streamController.controller.enqueue(data.chunk);\n        break;\n\n      case StreamKind.CLOSE:\n        assert(streamController, \"close should have stream controller\");\n\n        if (streamController.isClosed) {\n          break;\n        }\n\n        streamController.isClosed = true;\n        streamController.controller.close();\n        this.#deleteStreamController(streamController, streamId);\n        break;\n\n      case StreamKind.ERROR:\n        assert(streamController, \"error should have stream controller\");\n        streamController.controller.error(wrapReason(data.reason));\n        this.#deleteStreamController(streamController, streamId);\n        break;\n\n      case StreamKind.CANCEL_COMPLETE:\n        if (data.success) {\n          streamController.cancelCall.resolve();\n        } else {\n          streamController.cancelCall.reject(wrapReason(data.reason));\n        }\n\n        this.#deleteStreamController(streamController, streamId);\n        break;\n\n      case StreamKind.CANCEL:\n        if (!streamSink) {\n          break;\n        }\n\n        new Promise(function (resolve) {\n          resolve(streamSink.onCancel?.(wrapReason(data.reason)));\n        }).then(function () {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.CANCEL_COMPLETE,\n            streamId,\n            success: true\n          });\n        }, function (reason) {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.CANCEL_COMPLETE,\n            streamId,\n            reason: wrapReason(reason)\n          });\n        });\n        streamSink.sinkCapability.reject(wrapReason(data.reason));\n        streamSink.isCancelled = true;\n        delete this.streamSinks[streamId];\n        break;\n\n      default:\n        throw new Error(\"Unexpected stream case\");\n    }\n  }\n\n  #deleteStreamController(streamController, streamId) {\n    var _this16 = this;\n\n    return _asyncToGenerator(function* () {\n      yield Promise.allSettled([streamController.startCall?.promise, streamController.pullCall?.promise, streamController.cancelCall?.promise]);\n      delete _this16.streamControllers[streamId];\n    })();\n  }\n\n  destroy() {\n    this.comObj.removeEventListener(\"message\", this._onComObjOnMessage);\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/metadata.js\n\nclass Metadata {\n  #metadataMap;\n  #data;\n\n  constructor({\n    parsedData,\n    rawData\n  }) {\n    this.#metadataMap = parsedData;\n    this.#data = rawData;\n  }\n\n  getRaw() {\n    return this.#data;\n  }\n\n  get(name) {\n    return this.#metadataMap.get(name) ?? null;\n  }\n\n  getAll() {\n    return objectFromMap(this.#metadataMap);\n  }\n\n  has(name) {\n    return this.#metadataMap.has(name);\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/optional_content_config.js\n\nconst INTERNAL = Symbol(\"INTERNAL\");\n\nclass OptionalContentGroup {\n  #isDisplay = false;\n  #isPrint = false;\n  #userSet = false;\n  #visible = true;\n\n  constructor(renderingIntent, {\n    name,\n    intent,\n    usage\n  }) {\n    this.#isDisplay = !!(renderingIntent & RenderingIntentFlag.DISPLAY);\n    this.#isPrint = !!(renderingIntent & RenderingIntentFlag.PRINT);\n    this.name = name;\n    this.intent = intent;\n    this.usage = usage;\n  }\n\n  get visible() {\n    if (this.#userSet) {\n      return this.#visible;\n    }\n\n    if (!this.#visible) {\n      return false;\n    }\n\n    const {\n      print,\n      view\n    } = this.usage;\n\n    if (this.#isDisplay) {\n      return view?.viewState !== \"OFF\";\n    } else if (this.#isPrint) {\n      return print?.printState !== \"OFF\";\n    }\n\n    return true;\n  }\n\n  _setVisible(internal, visible, userSet = false) {\n    if (internal !== INTERNAL) {\n      unreachable(\"Internal method `_setVisible` called.\");\n    }\n\n    this.#userSet = userSet;\n    this.#visible = visible;\n  }\n\n}\n\nclass OptionalContentConfig {\n  #cachedGetHash = null;\n  #groups = new Map();\n  #initialHash = null;\n  #order = null;\n\n  constructor(data, renderingIntent = RenderingIntentFlag.DISPLAY) {\n    this.renderingIntent = renderingIntent;\n    this.name = null;\n    this.creator = null;\n\n    if (data === null) {\n      return;\n    }\n\n    this.name = data.name;\n    this.creator = data.creator;\n    this.#order = data.order;\n\n    for (const group of data.groups) {\n      this.#groups.set(group.id, new OptionalContentGroup(renderingIntent, group));\n    }\n\n    if (data.baseState === \"OFF\") {\n      for (const group of this.#groups.values()) {\n        group._setVisible(INTERNAL, false);\n      }\n    }\n\n    for (const on of data.on) {\n      this.#groups.get(on)._setVisible(INTERNAL, true);\n    }\n\n    for (const off of data.off) {\n      this.#groups.get(off)._setVisible(INTERNAL, false);\n    }\n\n    this.#initialHash = this.getHash();\n  }\n\n  #evaluateVisibilityExpression(array) {\n    const length = array.length;\n\n    if (length < 2) {\n      return true;\n    }\n\n    const operator = array[0];\n\n    for (let i = 1; i < length; i++) {\n      const element = array[i];\n      let state;\n\n      if (Array.isArray(element)) {\n        state = this.#evaluateVisibilityExpression(element);\n      } else if (this.#groups.has(element)) {\n        state = this.#groups.get(element).visible;\n      } else {\n        warn(`Optional content group not found: ${element}`);\n        return true;\n      }\n\n      switch (operator) {\n        case \"And\":\n          if (!state) {\n            return false;\n          }\n\n          break;\n\n        case \"Or\":\n          if (state) {\n            return true;\n          }\n\n          break;\n\n        case \"Not\":\n          return !state;\n\n        default:\n          return true;\n      }\n    }\n\n    return operator === \"And\";\n  }\n\n  isVisible(group) {\n    if (this.#groups.size === 0) {\n      return true;\n    }\n\n    if (!group) {\n      info(\"Optional content group not defined.\");\n      return true;\n    }\n\n    if (group.type === \"OCG\") {\n      if (!this.#groups.has(group.id)) {\n        warn(`Optional content group not found: ${group.id}`);\n        return true;\n      }\n\n      return this.#groups.get(group.id).visible;\n    } else if (group.type === \"OCMD\") {\n      if (group.expression) {\n        return this.#evaluateVisibilityExpression(group.expression);\n      }\n\n      if (!group.policy || group.policy === \"AnyOn\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n\n          if (this.#groups.get(id).visible) {\n            return true;\n          }\n        }\n\n        return false;\n      } else if (group.policy === \"AllOn\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n\n          if (!this.#groups.get(id).visible) {\n            return false;\n          }\n        }\n\n        return true;\n      } else if (group.policy === \"AnyOff\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n\n          if (!this.#groups.get(id).visible) {\n            return true;\n          }\n        }\n\n        return false;\n      } else if (group.policy === \"AllOff\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n\n          if (this.#groups.get(id).visible) {\n            return false;\n          }\n        }\n\n        return true;\n      }\n\n      warn(`Unknown optional content policy ${group.policy}.`);\n      return true;\n    }\n\n    warn(`Unknown group type ${group.type}.`);\n    return true;\n  }\n\n  setVisibility(id, visible = true) {\n    const group = this.#groups.get(id);\n\n    if (!group) {\n      warn(`Optional content group not found: ${id}`);\n      return;\n    }\n\n    group._setVisible(INTERNAL, !!visible, true);\n\n    this.#cachedGetHash = null;\n  }\n\n  setOCGState({\n    state,\n    preserveRB\n  }) {\n    let operator;\n\n    for (const elem of state) {\n      switch (elem) {\n        case \"ON\":\n        case \"OFF\":\n        case \"Toggle\":\n          operator = elem;\n          continue;\n      }\n\n      const group = this.#groups.get(elem);\n\n      if (!group) {\n        continue;\n      }\n\n      switch (operator) {\n        case \"ON\":\n          group._setVisible(INTERNAL, true);\n\n          break;\n\n        case \"OFF\":\n          group._setVisible(INTERNAL, false);\n\n          break;\n\n        case \"Toggle\":\n          group._setVisible(INTERNAL, !group.visible);\n\n          break;\n      }\n    }\n\n    this.#cachedGetHash = null;\n  }\n\n  get hasInitialVisibility() {\n    return this.#initialHash === null || this.getHash() === this.#initialHash;\n  }\n\n  getOrder() {\n    if (!this.#groups.size) {\n      return null;\n    }\n\n    if (this.#order) {\n      return this.#order.slice();\n    }\n\n    return [...this.#groups.keys()];\n  }\n\n  getGroups() {\n    return this.#groups.size > 0 ? objectFromMap(this.#groups) : null;\n  }\n\n  getGroup(id) {\n    return this.#groups.get(id) || null;\n  }\n\n  getHash() {\n    if (this.#cachedGetHash !== null) {\n      return this.#cachedGetHash;\n    }\n\n    const hash = new MurmurHash3_64();\n\n    for (const [id, group] of this.#groups) {\n      hash.update(`${id}:${group.visible}`);\n    }\n\n    return this.#cachedGetHash = hash.hexdigest();\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/transport_stream.js\n\nclass PDFDataTransportStream {\n  constructor(pdfDataRangeTransport, {\n    disableRange = false,\n    disableStream = false\n  }) {\n    assert(pdfDataRangeTransport, 'PDFDataTransportStream - missing required \"pdfDataRangeTransport\" argument.');\n    const {\n      length,\n      initialData,\n      progressiveDone,\n      contentDispositionFilename\n    } = pdfDataRangeTransport;\n    this._queuedChunks = [];\n    this._progressiveDone = progressiveDone;\n    this._contentDispositionFilename = contentDispositionFilename;\n\n    if (initialData?.length > 0) {\n      const buffer = initialData instanceof Uint8Array && initialData.byteLength === initialData.buffer.byteLength ? initialData.buffer : new Uint8Array(initialData).buffer;\n\n      this._queuedChunks.push(buffer);\n    }\n\n    this._pdfDataRangeTransport = pdfDataRangeTransport;\n    this._isStreamingSupported = !disableStream;\n    this._isRangeSupported = !disableRange;\n    this._contentLength = length;\n    this._fullRequestReader = null;\n    this._rangeReaders = [];\n    pdfDataRangeTransport.addRangeListener((begin, chunk) => {\n      this._onReceiveData({\n        begin,\n        chunk\n      });\n    });\n    pdfDataRangeTransport.addProgressListener((loaded, total) => {\n      this._onProgress({\n        loaded,\n        total\n      });\n    });\n    pdfDataRangeTransport.addProgressiveReadListener(chunk => {\n      this._onReceiveData({\n        chunk\n      });\n    });\n    pdfDataRangeTransport.addProgressiveDoneListener(() => {\n      this._onProgressiveDone();\n    });\n    pdfDataRangeTransport.transportReady();\n  }\n\n  _onReceiveData({\n    begin,\n    chunk\n  }) {\n    const buffer = chunk instanceof Uint8Array && chunk.byteLength === chunk.buffer.byteLength ? chunk.buffer : new Uint8Array(chunk).buffer;\n\n    if (begin === undefined) {\n      if (this._fullRequestReader) {\n        this._fullRequestReader._enqueue(buffer);\n      } else {\n        this._queuedChunks.push(buffer);\n      }\n    } else {\n      const found = this._rangeReaders.some(function (rangeReader) {\n        if (rangeReader._begin !== begin) {\n          return false;\n        }\n\n        rangeReader._enqueue(buffer);\n\n        return true;\n      });\n\n      assert(found, \"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.\");\n    }\n  }\n\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n\n  _onProgress(evt) {\n    if (evt.total === undefined) {\n      this._rangeReaders[0]?.onProgress?.({\n        loaded: evt.loaded\n      });\n    } else {\n      this._fullRequestReader?.onProgress?.({\n        loaded: evt.loaded,\n        total: evt.total\n      });\n    }\n  }\n\n  _onProgressiveDone() {\n    this._fullRequestReader?.progressiveDone();\n    this._progressiveDone = true;\n  }\n\n  _removeRangeReader(reader) {\n    const i = this._rangeReaders.indexOf(reader);\n\n    if (i >= 0) {\n      this._rangeReaders.splice(i, 1);\n    }\n  }\n\n  getFullReader() {\n    assert(!this._fullRequestReader, \"PDFDataTransportStream.getFullReader can only be called once.\");\n    const queuedChunks = this._queuedChunks;\n    this._queuedChunks = null;\n    return new PDFDataTransportStreamReader(this, queuedChunks, this._progressiveDone, this._contentDispositionFilename);\n  }\n\n  getRangeReader(begin, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n\n    const reader = new PDFDataTransportStreamRangeReader(this, begin, end);\n\n    this._pdfDataRangeTransport.requestDataRange(begin, end);\n\n    this._rangeReaders.push(reader);\n\n    return reader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n\n    this._pdfDataRangeTransport.abort();\n  }\n\n}\n\nclass PDFDataTransportStreamReader {\n  constructor(stream, queuedChunks, progressiveDone = false, contentDispositionFilename = null) {\n    this._stream = stream;\n    this._done = progressiveDone || false;\n    this._filename = isPdfFile(contentDispositionFilename) ? contentDispositionFilename : null;\n    this._queuedChunks = queuedChunks || [];\n    this._loaded = 0;\n\n    for (const chunk of this._queuedChunks) {\n      this._loaded += chunk.byteLength;\n    }\n\n    this._requests = [];\n    this._headersReady = Promise.resolve();\n    stream._fullRequestReader = this;\n    this.onProgress = null;\n  }\n\n  _enqueue(chunk) {\n    if (this._done) {\n      return;\n    }\n\n    if (this._requests.length > 0) {\n      const requestCapability = this._requests.shift();\n\n      requestCapability.resolve({\n        value: chunk,\n        done: false\n      });\n    } else {\n      this._queuedChunks.push(chunk);\n    }\n\n    this._loaded += chunk.byteLength;\n  }\n\n  get headersReady() {\n    return this._headersReady;\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get isRangeSupported() {\n    return this._stream._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._stream._isStreamingSupported;\n  }\n\n  get contentLength() {\n    return this._stream._contentLength;\n  }\n\n  read() {\n    var _this17 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this17._queuedChunks.length > 0) {\n        const chunk = _this17._queuedChunks.shift();\n\n        return {\n          value: chunk,\n          done: false\n        };\n      }\n\n      if (_this17._done) {\n        return {\n          value: undefined,\n          done: true\n        };\n      }\n\n      const requestCapability = Promise.withResolvers();\n\n      _this17._requests.push(requestCapability);\n\n      return requestCapability.promise;\n    })();\n  }\n\n  cancel(reason) {\n    this._done = true;\n\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n\n    this._requests.length = 0;\n  }\n\n  progressiveDone() {\n    if (this._done) {\n      return;\n    }\n\n    this._done = true;\n  }\n\n}\n\nclass PDFDataTransportStreamRangeReader {\n  constructor(stream, begin, end) {\n    this._stream = stream;\n    this._begin = begin;\n    this._end = end;\n    this._queuedChunk = null;\n    this._requests = [];\n    this._done = false;\n    this.onProgress = null;\n  }\n\n  _enqueue(chunk) {\n    if (this._done) {\n      return;\n    }\n\n    if (this._requests.length === 0) {\n      this._queuedChunk = chunk;\n    } else {\n      const requestsCapability = this._requests.shift();\n\n      requestsCapability.resolve({\n        value: chunk,\n        done: false\n      });\n\n      for (const requestCapability of this._requests) {\n        requestCapability.resolve({\n          value: undefined,\n          done: true\n        });\n      }\n\n      this._requests.length = 0;\n    }\n\n    this._done = true;\n\n    this._stream._removeRangeReader(this);\n  }\n\n  get isStreamingSupported() {\n    return false;\n  }\n\n  read() {\n    var _this18 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this18._queuedChunk) {\n        const chunk = _this18._queuedChunk;\n        _this18._queuedChunk = null;\n        return {\n          value: chunk,\n          done: false\n        };\n      }\n\n      if (_this18._done) {\n        return {\n          value: undefined,\n          done: true\n        };\n      }\n\n      const requestCapability = Promise.withResolvers();\n\n      _this18._requests.push(requestCapability);\n\n      return requestCapability.promise;\n    })();\n  }\n\n  cancel(reason) {\n    this._done = true;\n\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n\n    this._requests.length = 0;\n\n    this._stream._removeRangeReader(this);\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/content_disposition.js\n\nfunction getFilenameFromContentDispositionHeader(contentDisposition) {\n  let needsEncodingFixup = true;\n  let tmp = toParamRegExp(\"filename\\\\*\", \"i\").exec(contentDisposition);\n\n  if (tmp) {\n    tmp = tmp[1];\n    let filename = rfc2616unquote(tmp);\n    filename = unescape(filename);\n    filename = rfc5987decode(filename);\n    filename = rfc2047decode(filename);\n    return fixupEncoding(filename);\n  }\n\n  tmp = rfc2231getparam(contentDisposition);\n\n  if (tmp) {\n    const filename = rfc2047decode(tmp);\n    return fixupEncoding(filename);\n  }\n\n  tmp = toParamRegExp(\"filename\", \"i\").exec(contentDisposition);\n\n  if (tmp) {\n    tmp = tmp[1];\n    let filename = rfc2616unquote(tmp);\n    filename = rfc2047decode(filename);\n    return fixupEncoding(filename);\n  }\n\n  function toParamRegExp(attributePattern, flags) {\n    return new RegExp(\"(?:^|;)\\\\s*\" + attributePattern + \"\\\\s*=\\\\s*\" + \"(\" + '[^\";\\\\s][^;\\\\s]*' + \"|\" + '\"(?:[^\"\\\\\\\\]|\\\\\\\\\"?)+\"?' + \")\", flags);\n  }\n\n  function textdecode(encoding, value) {\n    if (encoding) {\n      if (!/^[\\x00-\\xFF]+$/.test(value)) {\n        return value;\n      }\n\n      try {\n        const decoder = new TextDecoder(encoding, {\n          fatal: true\n        });\n        const buffer = stringToBytes(value);\n        value = decoder.decode(buffer);\n        needsEncodingFixup = false;\n      } catch {}\n    }\n\n    return value;\n  }\n\n  function fixupEncoding(value) {\n    if (needsEncodingFixup && /[\\x80-\\xff]/.test(value)) {\n      value = textdecode(\"utf-8\", value);\n\n      if (needsEncodingFixup) {\n        value = textdecode(\"iso-8859-1\", value);\n      }\n    }\n\n    return value;\n  }\n\n  function rfc2231getparam(contentDispositionStr) {\n    const matches = [];\n    let match;\n    const iter = toParamRegExp(\"filename\\\\*((?!0\\\\d)\\\\d+)(\\\\*?)\", \"ig\");\n\n    while ((match = iter.exec(contentDispositionStr)) !== null) {\n      let [, n, quot, part] = match;\n      n = parseInt(n, 10);\n\n      if (n in matches) {\n        if (n === 0) {\n          break;\n        }\n\n        continue;\n      }\n\n      matches[n] = [quot, part];\n    }\n\n    const parts = [];\n\n    for (let n = 0; n < matches.length; ++n) {\n      if (!(n in matches)) {\n        break;\n      }\n\n      let [quot, part] = matches[n];\n      part = rfc2616unquote(part);\n\n      if (quot) {\n        part = unescape(part);\n\n        if (n === 0) {\n          part = rfc5987decode(part);\n        }\n      }\n\n      parts.push(part);\n    }\n\n    return parts.join(\"\");\n  }\n\n  function rfc2616unquote(value) {\n    if (value.startsWith('\"')) {\n      const parts = value.slice(1).split('\\\\\"');\n\n      for (let i = 0; i < parts.length; ++i) {\n        const quotindex = parts[i].indexOf('\"');\n\n        if (quotindex !== -1) {\n          parts[i] = parts[i].slice(0, quotindex);\n          parts.length = i + 1;\n        }\n\n        parts[i] = parts[i].replaceAll(/\\\\(.)/g, \"$1\");\n      }\n\n      value = parts.join('\"');\n    }\n\n    return value;\n  }\n\n  function rfc5987decode(extvalue) {\n    const encodingend = extvalue.indexOf(\"'\");\n\n    if (encodingend === -1) {\n      return extvalue;\n    }\n\n    const encoding = extvalue.slice(0, encodingend);\n    const langvalue = extvalue.slice(encodingend + 1);\n    const value = langvalue.replace(/^[^']*'/, \"\");\n    return textdecode(encoding, value);\n  }\n\n  function rfc2047decode(value) {\n    if (!value.startsWith(\"=?\") || /[\\x00-\\x19\\x80-\\xff]/.test(value)) {\n      return value;\n    }\n\n    return value.replaceAll(/=\\?([\\w-]*)\\?([QqBb])\\?((?:[^?]|\\?(?!=))*)\\?=/g, function (matches, charset, encoding, text) {\n      if (encoding === \"q\" || encoding === \"Q\") {\n        text = text.replaceAll(\"_\", \" \");\n        text = text.replaceAll(/=([0-9a-fA-F]{2})/g, function (match, hex) {\n          return String.fromCharCode(parseInt(hex, 16));\n        });\n        return textdecode(charset, text);\n      }\n\n      try {\n        text = atob(text);\n      } catch {}\n\n      return textdecode(charset, text);\n    });\n  }\n\n  return \"\";\n}\n\n; // CONCATENATED MODULE: ./src/display/network_utils.js\n\nfunction validateRangeRequestCapabilities({\n  getResponseHeader,\n  isHttp,\n  rangeChunkSize,\n  disableRange\n}) {\n  const returnValues = {\n    allowRangeRequests: false,\n    suggestedLength: undefined\n  };\n  const length = parseInt(getResponseHeader(\"Content-Length\"), 10);\n\n  if (!Number.isInteger(length)) {\n    return returnValues;\n  }\n\n  returnValues.suggestedLength = length;\n\n  if (length <= 2 * rangeChunkSize) {\n    return returnValues;\n  }\n\n  if (disableRange || !isHttp) {\n    return returnValues;\n  }\n\n  if (getResponseHeader(\"Accept-Ranges\") !== \"bytes\") {\n    return returnValues;\n  }\n\n  const contentEncoding = getResponseHeader(\"Content-Encoding\") || \"identity\";\n\n  if (contentEncoding !== \"identity\") {\n    return returnValues;\n  }\n\n  returnValues.allowRangeRequests = true;\n  return returnValues;\n}\n\nfunction extractFilenameFromHeader(getResponseHeader) {\n  const contentDisposition = getResponseHeader(\"Content-Disposition\");\n\n  if (contentDisposition) {\n    let filename = getFilenameFromContentDispositionHeader(contentDisposition);\n\n    if (filename.includes(\"%\")) {\n      try {\n        filename = decodeURIComponent(filename);\n      } catch {}\n    }\n\n    if (isPdfFile(filename)) {\n      return filename;\n    }\n  }\n\n  return null;\n}\n\nfunction createResponseStatusError(status, url) {\n  if (status === 404 || status === 0 && url.startsWith(\"file:\")) {\n    return new MissingPDFException('Missing PDF \"' + url + '\".');\n  }\n\n  return new UnexpectedResponseException(`Unexpected server response (${status}) while retrieving PDF \"${url}\".`, status);\n}\n\nfunction validateResponseStatus(status) {\n  return status === 200 || status === 206;\n}\n\n; // CONCATENATED MODULE: ./src/display/fetch_stream.js\n\nfunction createFetchOptions(headers, withCredentials, abortController) {\n  return {\n    method: \"GET\",\n    headers,\n    signal: abortController.signal,\n    mode: \"cors\",\n    credentials: withCredentials ? \"include\" : \"same-origin\",\n    redirect: \"follow\"\n  };\n}\n\nfunction createHeaders(httpHeaders) {\n  const headers = new Headers();\n\n  for (const property in httpHeaders) {\n    const value = httpHeaders[property];\n\n    if (value === undefined) {\n      continue;\n    }\n\n    headers.append(property, value);\n  }\n\n  return headers;\n}\n\nfunction getArrayBuffer(val) {\n  if (val instanceof Uint8Array) {\n    return val.buffer;\n  }\n\n  if (val instanceof ArrayBuffer) {\n    return val;\n  }\n\n  warn(`getArrayBuffer - unexpected data format: ${val}`);\n  return new Uint8Array(val).buffer;\n}\n\nclass PDFFetchStream {\n  constructor(source) {\n    this.source = source;\n    this.isHttp = /^https?:/i.test(source.url);\n    this.httpHeaders = this.isHttp && source.httpHeaders || {};\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n\n  getFullReader() {\n    assert(!this._fullRequestReader, \"PDFFetchStream.getFullReader can only be called once.\");\n    this._fullRequestReader = new PDFFetchStreamReader(this);\n    return this._fullRequestReader;\n  }\n\n  getRangeReader(begin, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n\n    const reader = new PDFFetchStreamRangeReader(this, begin, end);\n\n    this._rangeRequestReaders.push(reader);\n\n    return reader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n\n}\n\nclass PDFFetchStreamReader {\n  constructor(stream) {\n    this._stream = stream;\n    this._reader = null;\n    this._loaded = 0;\n    this._filename = null;\n    const source = stream.source;\n    this._withCredentials = source.withCredentials || false;\n    this._contentLength = source.length;\n    this._headersCapability = Promise.withResolvers();\n    this._disableRange = source.disableRange || false;\n    this._rangeChunkSize = source.rangeChunkSize;\n\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n\n    this._abortController = new AbortController();\n    this._isStreamingSupported = !source.disableStream;\n    this._isRangeSupported = !source.disableRange;\n    this._headers = createHeaders(this._stream.httpHeaders);\n    const url = source.url;\n    fetch(url, createFetchOptions(this._headers, this._withCredentials, this._abortController)).then(response => {\n      if (!validateResponseStatus(response.status)) {\n        throw createResponseStatusError(response.status, url);\n      }\n\n      this._reader = response.body.getReader();\n\n      this._headersCapability.resolve();\n\n      const getResponseHeader = name => response.headers.get(name);\n\n      const {\n        allowRangeRequests,\n        suggestedLength\n      } = validateRangeRequestCapabilities({\n        getResponseHeader,\n        isHttp: this._stream.isHttp,\n        rangeChunkSize: this._rangeChunkSize,\n        disableRange: this._disableRange\n      });\n      this._isRangeSupported = allowRangeRequests;\n      this._contentLength = suggestedLength || this._contentLength;\n      this._filename = extractFilenameFromHeader(getResponseHeader);\n\n      if (!this._isStreamingSupported && this._isRangeSupported) {\n        this.cancel(new AbortException(\"Streaming is disabled.\"));\n      }\n    }).catch(this._headersCapability.reject);\n    this.onProgress = null;\n  }\n\n  get headersReady() {\n    return this._headersCapability.promise;\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get contentLength() {\n    return this._contentLength;\n  }\n\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  read() {\n    var _this19 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this19._headersCapability.promise;\n      const {\n        value,\n        done\n      } = yield _this19._reader.read();\n\n      if (done) {\n        return {\n          value,\n          done\n        };\n      }\n\n      _this19._loaded += value.byteLength;\n      _this19.onProgress?.({\n        loaded: _this19._loaded,\n        total: _this19._contentLength\n      });\n      return {\n        value: getArrayBuffer(value),\n        done: false\n      };\n    })();\n  }\n\n  cancel(reason) {\n    this._reader?.cancel(reason);\n\n    this._abortController.abort();\n  }\n\n}\n\nclass PDFFetchStreamRangeReader {\n  constructor(stream, begin, end) {\n    this._stream = stream;\n    this._reader = null;\n    this._loaded = 0;\n    const source = stream.source;\n    this._withCredentials = source.withCredentials || false;\n    this._readCapability = Promise.withResolvers();\n    this._isStreamingSupported = !source.disableStream;\n    this._abortController = new AbortController();\n    this._headers = createHeaders(this._stream.httpHeaders);\n\n    this._headers.append(\"Range\", `bytes=${begin}-${end - 1}`);\n\n    const url = source.url;\n    fetch(url, createFetchOptions(this._headers, this._withCredentials, this._abortController)).then(response => {\n      if (!validateResponseStatus(response.status)) {\n        throw createResponseStatusError(response.status, url);\n      }\n\n      this._readCapability.resolve();\n\n      this._reader = response.body.getReader();\n    }).catch(this._readCapability.reject);\n    this.onProgress = null;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  read() {\n    var _this20 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this20._readCapability.promise;\n      const {\n        value,\n        done\n      } = yield _this20._reader.read();\n\n      if (done) {\n        return {\n          value,\n          done\n        };\n      }\n\n      _this20._loaded += value.byteLength;\n      _this20.onProgress?.({\n        loaded: _this20._loaded\n      });\n      return {\n        value: getArrayBuffer(value),\n        done: false\n      };\n    })();\n  }\n\n  cancel(reason) {\n    this._reader?.cancel(reason);\n\n    this._abortController.abort();\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/network.js\n\nconst OK_RESPONSE = 200;\nconst PARTIAL_CONTENT_RESPONSE = 206;\n\nfunction network_getArrayBuffer(xhr) {\n  const data = xhr.response;\n\n  if (typeof data !== \"string\") {\n    return data;\n  }\n\n  return stringToBytes(data).buffer;\n}\n\nclass NetworkManager {\n  constructor(url, args = {}) {\n    this.url = url;\n    this.isHttp = /^https?:/i.test(url);\n    this.httpHeaders = this.isHttp && args.httpHeaders || Object.create(null);\n    this.withCredentials = args.withCredentials || false;\n    this.currXhrId = 0;\n    this.pendingRequests = Object.create(null);\n  }\n\n  requestRange(begin, end, listeners) {\n    const args = {\n      begin,\n      end\n    };\n\n    for (const prop in listeners) {\n      args[prop] = listeners[prop];\n    }\n\n    return this.request(args);\n  }\n\n  requestFull(listeners) {\n    return this.request(listeners);\n  }\n\n  request(args) {\n    const xhr = new XMLHttpRequest();\n    const xhrId = this.currXhrId++;\n    const pendingRequest = this.pendingRequests[xhrId] = {\n      xhr\n    };\n    xhr.open(\"GET\", this.url);\n    xhr.withCredentials = this.withCredentials;\n\n    for (const property in this.httpHeaders) {\n      const value = this.httpHeaders[property];\n\n      if (value === undefined) {\n        continue;\n      }\n\n      xhr.setRequestHeader(property, value);\n    }\n\n    if (this.isHttp && \"begin\" in args && \"end\" in args) {\n      xhr.setRequestHeader(\"Range\", `bytes=${args.begin}-${args.end - 1}`);\n      pendingRequest.expectedStatus = PARTIAL_CONTENT_RESPONSE;\n    } else {\n      pendingRequest.expectedStatus = OK_RESPONSE;\n    }\n\n    xhr.responseType = \"arraybuffer\";\n\n    if (args.onError) {\n      xhr.onerror = function (evt) {\n        args.onError(xhr.status);\n      };\n    }\n\n    xhr.onreadystatechange = this.onStateChange.bind(this, xhrId);\n    xhr.onprogress = this.onProgress.bind(this, xhrId);\n    pendingRequest.onHeadersReceived = args.onHeadersReceived;\n    pendingRequest.onDone = args.onDone;\n    pendingRequest.onError = args.onError;\n    pendingRequest.onProgress = args.onProgress;\n    xhr.send(null);\n    return xhrId;\n  }\n\n  onProgress(xhrId, evt) {\n    const pendingRequest = this.pendingRequests[xhrId];\n\n    if (!pendingRequest) {\n      return;\n    }\n\n    pendingRequest.onProgress?.(evt);\n  }\n\n  onStateChange(xhrId, evt) {\n    const pendingRequest = this.pendingRequests[xhrId];\n\n    if (!pendingRequest) {\n      return;\n    }\n\n    const xhr = pendingRequest.xhr;\n\n    if (xhr.readyState >= 2 && pendingRequest.onHeadersReceived) {\n      pendingRequest.onHeadersReceived();\n      delete pendingRequest.onHeadersReceived;\n    }\n\n    if (xhr.readyState !== 4) {\n      return;\n    }\n\n    if (!(xhrId in this.pendingRequests)) {\n      return;\n    }\n\n    delete this.pendingRequests[xhrId];\n\n    if (xhr.status === 0 && this.isHttp) {\n      pendingRequest.onError?.(xhr.status);\n      return;\n    }\n\n    const xhrStatus = xhr.status || OK_RESPONSE;\n    const ok_response_on_range_request = xhrStatus === OK_RESPONSE && pendingRequest.expectedStatus === PARTIAL_CONTENT_RESPONSE;\n\n    if (!ok_response_on_range_request && xhrStatus !== pendingRequest.expectedStatus) {\n      pendingRequest.onError?.(xhr.status);\n      return;\n    }\n\n    const chunk = network_getArrayBuffer(xhr);\n\n    if (xhrStatus === PARTIAL_CONTENT_RESPONSE) {\n      const rangeHeader = xhr.getResponseHeader(\"Content-Range\");\n      const matches = /bytes (\\d+)-(\\d+)\\/(\\d+)/.exec(rangeHeader);\n      pendingRequest.onDone({\n        begin: parseInt(matches[1], 10),\n        chunk\n      });\n    } else if (chunk) {\n      pendingRequest.onDone({\n        begin: 0,\n        chunk\n      });\n    } else {\n      pendingRequest.onError?.(xhr.status);\n    }\n  }\n\n  getRequestXhr(xhrId) {\n    return this.pendingRequests[xhrId].xhr;\n  }\n\n  isPendingRequest(xhrId) {\n    return xhrId in this.pendingRequests;\n  }\n\n  abortRequest(xhrId) {\n    const xhr = this.pendingRequests[xhrId].xhr;\n    delete this.pendingRequests[xhrId];\n    xhr.abort();\n  }\n\n}\n\nclass PDFNetworkStream {\n  constructor(source) {\n    this._source = source;\n    this._manager = new NetworkManager(source.url, {\n      httpHeaders: source.httpHeaders,\n      withCredentials: source.withCredentials\n    });\n    this._rangeChunkSize = source.rangeChunkSize;\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n\n  _onRangeRequestReaderClosed(reader) {\n    const i = this._rangeRequestReaders.indexOf(reader);\n\n    if (i >= 0) {\n      this._rangeRequestReaders.splice(i, 1);\n    }\n  }\n\n  getFullReader() {\n    assert(!this._fullRequestReader, \"PDFNetworkStream.getFullReader can only be called once.\");\n    this._fullRequestReader = new PDFNetworkStreamFullRequestReader(this._manager, this._source);\n    return this._fullRequestReader;\n  }\n\n  getRangeReader(begin, end) {\n    const reader = new PDFNetworkStreamRangeRequestReader(this._manager, begin, end);\n    reader.onClosed = this._onRangeRequestReaderClosed.bind(this);\n\n    this._rangeRequestReaders.push(reader);\n\n    return reader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n\n}\n\nclass PDFNetworkStreamFullRequestReader {\n  constructor(manager, source) {\n    this._manager = manager;\n    const args = {\n      onHeadersReceived: this._onHeadersReceived.bind(this),\n      onDone: this._onDone.bind(this),\n      onError: this._onError.bind(this),\n      onProgress: this._onProgress.bind(this)\n    };\n    this._url = source.url;\n    this._fullRequestId = manager.requestFull(args);\n    this._headersReceivedCapability = Promise.withResolvers();\n    this._disableRange = source.disableRange || false;\n    this._contentLength = source.length;\n    this._rangeChunkSize = source.rangeChunkSize;\n\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n\n    this._isStreamingSupported = false;\n    this._isRangeSupported = false;\n    this._cachedChunks = [];\n    this._requests = [];\n    this._done = false;\n    this._storedError = undefined;\n    this._filename = null;\n    this.onProgress = null;\n  }\n\n  _onHeadersReceived() {\n    const fullRequestXhrId = this._fullRequestId;\n\n    const fullRequestXhr = this._manager.getRequestXhr(fullRequestXhrId);\n\n    const getResponseHeader = name => fullRequestXhr.getResponseHeader(name);\n\n    const {\n      allowRangeRequests,\n      suggestedLength\n    } = validateRangeRequestCapabilities({\n      getResponseHeader,\n      isHttp: this._manager.isHttp,\n      rangeChunkSize: this._rangeChunkSize,\n      disableRange: this._disableRange\n    });\n\n    if (allowRangeRequests) {\n      this._isRangeSupported = true;\n    }\n\n    this._contentLength = suggestedLength || this._contentLength;\n    this._filename = extractFilenameFromHeader(getResponseHeader);\n\n    if (this._isRangeSupported) {\n      this._manager.abortRequest(fullRequestXhrId);\n    }\n\n    this._headersReceivedCapability.resolve();\n  }\n\n  _onDone(data) {\n    if (data) {\n      if (this._requests.length > 0) {\n        const requestCapability = this._requests.shift();\n\n        requestCapability.resolve({\n          value: data.chunk,\n          done: false\n        });\n      } else {\n        this._cachedChunks.push(data.chunk);\n      }\n    }\n\n    this._done = true;\n\n    if (this._cachedChunks.length > 0) {\n      return;\n    }\n\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n\n    this._requests.length = 0;\n  }\n\n  _onError(status) {\n    this._storedError = createResponseStatusError(status, this._url);\n\n    this._headersReceivedCapability.reject(this._storedError);\n\n    for (const requestCapability of this._requests) {\n      requestCapability.reject(this._storedError);\n    }\n\n    this._requests.length = 0;\n    this._cachedChunks.length = 0;\n  }\n\n  _onProgress(evt) {\n    this.onProgress?.({\n      loaded: evt.loaded,\n      total: evt.lengthComputable ? evt.total : this._contentLength\n    });\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  get contentLength() {\n    return this._contentLength;\n  }\n\n  get headersReady() {\n    return this._headersReceivedCapability.promise;\n  }\n\n  read() {\n    var _this21 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this21._storedError) {\n        throw _this21._storedError;\n      }\n\n      if (_this21._cachedChunks.length > 0) {\n        const chunk = _this21._cachedChunks.shift();\n\n        return {\n          value: chunk,\n          done: false\n        };\n      }\n\n      if (_this21._done) {\n        return {\n          value: undefined,\n          done: true\n        };\n      }\n\n      const requestCapability = Promise.withResolvers();\n\n      _this21._requests.push(requestCapability);\n\n      return requestCapability.promise;\n    })();\n  }\n\n  cancel(reason) {\n    this._done = true;\n\n    this._headersReceivedCapability.reject(reason);\n\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n\n    this._requests.length = 0;\n\n    if (this._manager.isPendingRequest(this._fullRequestId)) {\n      this._manager.abortRequest(this._fullRequestId);\n    }\n\n    this._fullRequestReader = null;\n  }\n\n}\n\nclass PDFNetworkStreamRangeRequestReader {\n  constructor(manager, begin, end) {\n    this._manager = manager;\n    const args = {\n      onDone: this._onDone.bind(this),\n      onError: this._onError.bind(this),\n      onProgress: this._onProgress.bind(this)\n    };\n    this._url = manager.url;\n    this._requestId = manager.requestRange(begin, end, args);\n    this._requests = [];\n    this._queuedChunk = null;\n    this._done = false;\n    this._storedError = undefined;\n    this.onProgress = null;\n    this.onClosed = null;\n  }\n\n  _close() {\n    this.onClosed?.(this);\n  }\n\n  _onDone(data) {\n    const chunk = data.chunk;\n\n    if (this._requests.length > 0) {\n      const requestCapability = this._requests.shift();\n\n      requestCapability.resolve({\n        value: chunk,\n        done: false\n      });\n    } else {\n      this._queuedChunk = chunk;\n    }\n\n    this._done = true;\n\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n\n    this._requests.length = 0;\n\n    this._close();\n  }\n\n  _onError(status) {\n    this._storedError = createResponseStatusError(status, this._url);\n\n    for (const requestCapability of this._requests) {\n      requestCapability.reject(this._storedError);\n    }\n\n    this._requests.length = 0;\n    this._queuedChunk = null;\n  }\n\n  _onProgress(evt) {\n    if (!this.isStreamingSupported) {\n      this.onProgress?.({\n        loaded: evt.loaded\n      });\n    }\n  }\n\n  get isStreamingSupported() {\n    return false;\n  }\n\n  read() {\n    var _this22 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this22._storedError) {\n        throw _this22._storedError;\n      }\n\n      if (_this22._queuedChunk !== null) {\n        const chunk = _this22._queuedChunk;\n        _this22._queuedChunk = null;\n        return {\n          value: chunk,\n          done: false\n        };\n      }\n\n      if (_this22._done) {\n        return {\n          value: undefined,\n          done: true\n        };\n      }\n\n      const requestCapability = Promise.withResolvers();\n\n      _this22._requests.push(requestCapability);\n\n      return requestCapability.promise;\n    })();\n  }\n\n  cancel(reason) {\n    this._done = true;\n\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n\n    this._requests.length = 0;\n\n    if (this._manager.isPendingRequest(this._requestId)) {\n      this._manager.abortRequest(this._requestId);\n    }\n\n    this._close();\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/node_stream.js\n\nconst urlRegex = /^[a-z][a-z0-9\\-+.]+:/i;\n\nfunction parseUrlOrPath(sourceUrl) {\n  if (urlRegex.test(sourceUrl)) {\n    return new URL(sourceUrl);\n  }\n\n  const url = NodePackages.get(\"url\");\n  return new URL(url.pathToFileURL(sourceUrl));\n}\n\nfunction createRequest(url, headers, callback) {\n  if (url.protocol === \"http:\") {\n    const http = NodePackages.get(\"http\");\n    return http.request(url, {\n      headers\n    }, callback);\n  }\n\n  const https = NodePackages.get(\"https\");\n  return https.request(url, {\n    headers\n  }, callback);\n}\n\nclass PDFNodeStream {\n  constructor(source) {\n    this.source = source;\n    this.url = parseUrlOrPath(source.url);\n    this.isHttp = this.url.protocol === \"http:\" || this.url.protocol === \"https:\";\n    this.isFsUrl = this.url.protocol === \"file:\";\n    this.httpHeaders = this.isHttp && source.httpHeaders || {};\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n\n  getFullReader() {\n    assert(!this._fullRequestReader, \"PDFNodeStream.getFullReader can only be called once.\");\n    this._fullRequestReader = this.isFsUrl ? new PDFNodeStreamFsFullReader(this) : new PDFNodeStreamFullReader(this);\n    return this._fullRequestReader;\n  }\n\n  getRangeReader(start, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n\n    const rangeReader = this.isFsUrl ? new PDFNodeStreamFsRangeReader(this, start, end) : new PDFNodeStreamRangeReader(this, start, end);\n\n    this._rangeRequestReaders.push(rangeReader);\n\n    return rangeReader;\n  }\n\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n\n}\n\nclass BaseFullReader {\n  constructor(stream) {\n    this._url = stream.url;\n    this._done = false;\n    this._storedError = null;\n    this.onProgress = null;\n    const source = stream.source;\n    this._contentLength = source.length;\n    this._loaded = 0;\n    this._filename = null;\n    this._disableRange = source.disableRange || false;\n    this._rangeChunkSize = source.rangeChunkSize;\n\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n\n    this._isStreamingSupported = !source.disableStream;\n    this._isRangeSupported = !source.disableRange;\n    this._readableStream = null;\n    this._readCapability = Promise.withResolvers();\n    this._headersCapability = Promise.withResolvers();\n  }\n\n  get headersReady() {\n    return this._headersCapability.promise;\n  }\n\n  get filename() {\n    return this._filename;\n  }\n\n  get contentLength() {\n    return this._contentLength;\n  }\n\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  read() {\n    var _this23 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this23._readCapability.promise;\n\n      if (_this23._done) {\n        return {\n          value: undefined,\n          done: true\n        };\n      }\n\n      if (_this23._storedError) {\n        throw _this23._storedError;\n      }\n\n      const chunk = _this23._readableStream.read();\n\n      if (chunk === null) {\n        _this23._readCapability = Promise.withResolvers();\n        return _this23.read();\n      }\n\n      _this23._loaded += chunk.length;\n      _this23.onProgress?.({\n        loaded: _this23._loaded,\n        total: _this23._contentLength\n      });\n      const buffer = new Uint8Array(chunk).buffer;\n      return {\n        value: buffer,\n        done: false\n      };\n    })();\n  }\n\n  cancel(reason) {\n    if (!this._readableStream) {\n      this._error(reason);\n\n      return;\n    }\n\n    this._readableStream.destroy(reason);\n  }\n\n  _error(reason) {\n    this._storedError = reason;\n\n    this._readCapability.resolve();\n  }\n\n  _setReadableStream(readableStream) {\n    this._readableStream = readableStream;\n    readableStream.on(\"readable\", () => {\n      this._readCapability.resolve();\n    });\n    readableStream.on(\"end\", () => {\n      readableStream.destroy();\n      this._done = true;\n\n      this._readCapability.resolve();\n    });\n    readableStream.on(\"error\", reason => {\n      this._error(reason);\n    });\n\n    if (!this._isStreamingSupported && this._isRangeSupported) {\n      this._error(new AbortException(\"streaming is disabled\"));\n    }\n\n    if (this._storedError) {\n      this._readableStream.destroy(this._storedError);\n    }\n  }\n\n}\n\nclass BaseRangeReader {\n  constructor(stream) {\n    this._url = stream.url;\n    this._done = false;\n    this._storedError = null;\n    this.onProgress = null;\n    this._loaded = 0;\n    this._readableStream = null;\n    this._readCapability = Promise.withResolvers();\n    const source = stream.source;\n    this._isStreamingSupported = !source.disableStream;\n  }\n\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n\n  read() {\n    var _this24 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this24._readCapability.promise;\n\n      if (_this24._done) {\n        return {\n          value: undefined,\n          done: true\n        };\n      }\n\n      if (_this24._storedError) {\n        throw _this24._storedError;\n      }\n\n      const chunk = _this24._readableStream.read();\n\n      if (chunk === null) {\n        _this24._readCapability = Promise.withResolvers();\n        return _this24.read();\n      }\n\n      _this24._loaded += chunk.length;\n      _this24.onProgress?.({\n        loaded: _this24._loaded\n      });\n      const buffer = new Uint8Array(chunk).buffer;\n      return {\n        value: buffer,\n        done: false\n      };\n    })();\n  }\n\n  cancel(reason) {\n    if (!this._readableStream) {\n      this._error(reason);\n\n      return;\n    }\n\n    this._readableStream.destroy(reason);\n  }\n\n  _error(reason) {\n    this._storedError = reason;\n\n    this._readCapability.resolve();\n  }\n\n  _setReadableStream(readableStream) {\n    this._readableStream = readableStream;\n    readableStream.on(\"readable\", () => {\n      this._readCapability.resolve();\n    });\n    readableStream.on(\"end\", () => {\n      readableStream.destroy();\n      this._done = true;\n\n      this._readCapability.resolve();\n    });\n    readableStream.on(\"error\", reason => {\n      this._error(reason);\n    });\n\n    if (this._storedError) {\n      this._readableStream.destroy(this._storedError);\n    }\n  }\n\n}\n\nclass PDFNodeStreamFullReader extends BaseFullReader {\n  constructor(stream) {\n    super(stream);\n\n    const handleResponse = response => {\n      if (response.statusCode === 404) {\n        const error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n        this._storedError = error;\n\n        this._headersCapability.reject(error);\n\n        return;\n      }\n\n      this._headersCapability.resolve();\n\n      this._setReadableStream(response);\n\n      const getResponseHeader = name => this._readableStream.headers[name.toLowerCase()];\n\n      const {\n        allowRangeRequests,\n        suggestedLength\n      } = validateRangeRequestCapabilities({\n        getResponseHeader,\n        isHttp: stream.isHttp,\n        rangeChunkSize: this._rangeChunkSize,\n        disableRange: this._disableRange\n      });\n      this._isRangeSupported = allowRangeRequests;\n      this._contentLength = suggestedLength || this._contentLength;\n      this._filename = extractFilenameFromHeader(getResponseHeader);\n    };\n\n    this._request = createRequest(this._url, stream.httpHeaders, handleResponse);\n\n    this._request.on(\"error\", reason => {\n      this._storedError = reason;\n\n      this._headersCapability.reject(reason);\n    });\n\n    this._request.end();\n  }\n\n}\n\nclass PDFNodeStreamRangeReader extends BaseRangeReader {\n  constructor(stream, start, end) {\n    super(stream);\n    this._httpHeaders = {};\n\n    for (const property in stream.httpHeaders) {\n      const value = stream.httpHeaders[property];\n\n      if (value === undefined) {\n        continue;\n      }\n\n      this._httpHeaders[property] = value;\n    }\n\n    this._httpHeaders.Range = `bytes=${start}-${end - 1}`;\n\n    const handleResponse = response => {\n      if (response.statusCode === 404) {\n        const error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n        this._storedError = error;\n        return;\n      }\n\n      this._setReadableStream(response);\n    };\n\n    this._request = createRequest(this._url, this._httpHeaders, handleResponse);\n\n    this._request.on(\"error\", reason => {\n      this._storedError = reason;\n    });\n\n    this._request.end();\n  }\n\n}\n\nclass PDFNodeStreamFsFullReader extends BaseFullReader {\n  constructor(stream) {\n    super(stream);\n    const fs = NodePackages.get(\"fs\");\n    fs.promises.lstat(this._url).then(stat => {\n      this._contentLength = stat.size;\n\n      this._setReadableStream(fs.createReadStream(this._url));\n\n      this._headersCapability.resolve();\n    }, error => {\n      if (error.code === \"ENOENT\") {\n        error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n      }\n\n      this._storedError = error;\n\n      this._headersCapability.reject(error);\n    });\n  }\n\n}\n\nclass PDFNodeStreamFsRangeReader extends BaseRangeReader {\n  constructor(stream, start, end) {\n    super(stream);\n    const fs = NodePackages.get(\"fs\");\n\n    this._setReadableStream(fs.createReadStream(this._url, {\n      start,\n      end: end - 1\n    }));\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/text_layer.js\n\nconst MAX_TEXT_DIVS_TO_RENDER = 100000;\nconst DEFAULT_FONT_SIZE = 30;\nconst DEFAULT_FONT_ASCENT = 0.8;\n\nclass TextLayer {\n  #capability = Promise.withResolvers();\n  #container = null;\n  #disableProcessItems = false;\n  #fontInspectorEnabled = !!globalThis.FontInspector?.enabled;\n  #lang = null;\n  #layoutTextParams = null;\n  #pageHeight = 0;\n  #pageWidth = 0;\n  #reader = null;\n  #rootContainer = null;\n  #rotation = 0;\n  #scale = 0;\n  #styleCache = Object.create(null);\n  #textContentItemsStr = [];\n  #textContentSource = null;\n  #textDivs = [];\n  #textDivProperties = new WeakMap();\n  #transform = null;\n  static #ascentCache = new Map();\n  static #canvasContexts = new Map();\n  static #minFontSize = null;\n  static #pendingTextLayers = new Set();\n\n  constructor({\n    textContentSource,\n    container,\n    viewport\n  }) {\n    if (textContentSource instanceof ReadableStream) {\n      this.#textContentSource = textContentSource;\n    } else if (typeof textContentSource === \"object\") {\n      this.#textContentSource = new ReadableStream({\n        start(controller) {\n          controller.enqueue(textContentSource);\n          controller.close();\n        }\n\n      });\n    } else {\n      throw new Error('No \"textContentSource\" parameter specified.');\n    }\n\n    this.#container = this.#rootContainer = container;\n    this.#scale = viewport.scale * (globalThis.devicePixelRatio || 1);\n    this.#rotation = viewport.rotation;\n    this.#layoutTextParams = {\n      prevFontSize: null,\n      prevFontFamily: null,\n      div: null,\n      properties: null,\n      ctx: null\n    };\n    const {\n      pageWidth,\n      pageHeight,\n      pageX,\n      pageY\n    } = viewport.rawDims;\n    this.#transform = [1, 0, 0, -1, -pageX, pageY + pageHeight];\n    this.#pageWidth = pageWidth;\n    this.#pageHeight = pageHeight;\n    TextLayer.#ensureMinFontSizeComputed();\n    setLayerDimensions(container, viewport);\n    this.#capability.promise.catch(() => {}).then(() => {\n      TextLayer.#pendingTextLayers.delete(this);\n      this.#layoutTextParams = null;\n      this.#styleCache = null;\n    });\n  }\n\n  render() {\n    const pump = () => {\n      this.#reader.read().then(({\n        value,\n        done\n      }) => {\n        if (done) {\n          this.#capability.resolve();\n          return;\n        }\n\n        this.#lang ??= value.lang;\n        Object.assign(this.#styleCache, value.styles);\n        this.#processItems(value.items);\n        pump();\n      }, this.#capability.reject);\n    };\n\n    this.#reader = this.#textContentSource.getReader();\n    TextLayer.#pendingTextLayers.add(this);\n    pump();\n    return this.#capability.promise;\n  }\n\n  update({\n    viewport,\n    onBefore = null\n  }) {\n    const scale = viewport.scale * (globalThis.devicePixelRatio || 1);\n    const rotation = viewport.rotation;\n\n    if (rotation !== this.#rotation) {\n      onBefore?.();\n      this.#rotation = rotation;\n      setLayerDimensions(this.#rootContainer, {\n        rotation\n      });\n    }\n\n    if (scale !== this.#scale) {\n      onBefore?.();\n      this.#scale = scale;\n      const params = {\n        prevFontSize: null,\n        prevFontFamily: null,\n        div: null,\n        properties: null,\n        ctx: TextLayer.#getCtx(this.#lang)\n      };\n\n      for (const div of this.#textDivs) {\n        params.properties = this.#textDivProperties.get(div);\n        params.div = div;\n        this.#layout(params);\n      }\n    }\n  }\n\n  cancel() {\n    const abortEx = new AbortException(\"TextLayer task cancelled.\");\n    this.#reader?.cancel(abortEx).catch(() => {});\n    this.#reader = null;\n    this.#capability.reject(abortEx);\n  }\n\n  get textDivs() {\n    return this.#textDivs;\n  }\n\n  get textContentItemsStr() {\n    return this.#textContentItemsStr;\n  }\n\n  #processItems(items) {\n    if (this.#disableProcessItems) {\n      return;\n    }\n\n    this.#layoutTextParams.ctx ??= TextLayer.#getCtx(this.#lang);\n    const textDivs = this.#textDivs,\n          textContentItemsStr = this.#textContentItemsStr;\n\n    for (const item of items) {\n      if (textDivs.length > MAX_TEXT_DIVS_TO_RENDER) {\n        warn(\"Ignoring additional textDivs for performance reasons.\");\n        this.#disableProcessItems = true;\n        return;\n      }\n\n      if (item.str === undefined) {\n        if (item.type === \"beginMarkedContentProps\" || item.type === \"beginMarkedContent\") {\n          const parent = this.#container;\n          this.#container = document.createElement(\"span\");\n          this.#container.classList.add(\"markedContent\");\n\n          if (item.id !== null) {\n            this.#container.setAttribute(\"id\", `${item.id}`);\n          }\n\n          parent.append(this.#container);\n        } else if (item.type === \"endMarkedContent\") {\n          this.#container = this.#container.parentNode;\n        }\n\n        continue;\n      }\n\n      textContentItemsStr.push(item.str);\n      this.#appendText(item);\n    }\n  }\n\n  #appendText(geom) {\n    const textDiv = document.createElement(\"span\");\n    const textDivProperties = {\n      angle: 0,\n      canvasWidth: 0,\n      hasText: geom.str !== \"\",\n      hasEOL: geom.hasEOL,\n      fontSize: 0\n    };\n    this.#textDivs.push(textDiv);\n    const tx = Util.transform(this.#transform, geom.transform);\n    let angle = Math.atan2(tx[1], tx[0]);\n    const style = this.#styleCache[geom.fontName];\n\n    if (style.vertical) {\n      angle += Math.PI / 2;\n    }\n\n    const fontFamily = this.#fontInspectorEnabled && style.fontSubstitution || style.fontFamily;\n    const fontHeight = Math.hypot(tx[2], tx[3]);\n    const fontAscent = fontHeight * TextLayer.#getAscent(fontFamily, this.#lang);\n    let left, top;\n\n    if (angle === 0) {\n      left = tx[4];\n      top = tx[5] - fontAscent;\n    } else {\n      left = tx[4] + fontAscent * Math.sin(angle);\n      top = tx[5] - fontAscent * Math.cos(angle);\n    }\n\n    const scaleFactorStr = \"calc(var(--scale-factor)*\";\n    const divStyle = textDiv.style;\n\n    if (this.#container === this.#rootContainer) {\n      divStyle.left = `${(100 * left / this.#pageWidth).toFixed(2)}%`;\n      divStyle.top = `${(100 * top / this.#pageHeight).toFixed(2)}%`;\n    } else {\n      divStyle.left = `${scaleFactorStr}${left.toFixed(2)}px)`;\n      divStyle.top = `${scaleFactorStr}${top.toFixed(2)}px)`;\n    }\n\n    divStyle.fontSize = `${scaleFactorStr}${(TextLayer.#minFontSize * fontHeight).toFixed(2)}px)`;\n    divStyle.fontFamily = fontFamily;\n    textDivProperties.fontSize = fontHeight;\n    textDiv.setAttribute(\"role\", \"presentation\");\n    textDiv.textContent = geom.str;\n    textDiv.dir = geom.dir;\n\n    if (this.#fontInspectorEnabled) {\n      textDiv.dataset.fontName = style.fontSubstitutionLoadedName || geom.fontName;\n    }\n\n    if (angle !== 0) {\n      textDivProperties.angle = angle * (180 / Math.PI);\n    }\n\n    let shouldScaleText = false;\n\n    if (geom.str.length > 1) {\n      shouldScaleText = true;\n    } else if (geom.str !== \" \" && geom.transform[0] !== geom.transform[3]) {\n      const absScaleX = Math.abs(geom.transform[0]),\n            absScaleY = Math.abs(geom.transform[3]);\n\n      if (absScaleX !== absScaleY && Math.max(absScaleX, absScaleY) / Math.min(absScaleX, absScaleY) > 1.5) {\n        shouldScaleText = true;\n      }\n    }\n\n    if (shouldScaleText) {\n      textDivProperties.canvasWidth = style.vertical ? geom.height : geom.width;\n    }\n\n    this.#textDivProperties.set(textDiv, textDivProperties);\n    this.#layoutTextParams.div = textDiv;\n    this.#layoutTextParams.properties = textDivProperties;\n    this.#layout(this.#layoutTextParams);\n\n    if (textDivProperties.hasText) {\n      this.#container.append(textDiv);\n    }\n\n    if (textDivProperties.hasEOL) {\n      const br = document.createElement(\"br\");\n      br.setAttribute(\"role\", \"presentation\");\n      this.#container.append(br);\n    }\n  }\n\n  #layout(params) {\n    const {\n      div,\n      properties,\n      ctx,\n      prevFontSize,\n      prevFontFamily\n    } = params;\n    const {\n      style\n    } = div;\n    let transform = \"\";\n\n    if (TextLayer.#minFontSize > 1) {\n      transform = `scale(${1 / TextLayer.#minFontSize})`;\n    }\n\n    if (properties.canvasWidth !== 0 && properties.hasText) {\n      const {\n        fontFamily\n      } = style;\n      const {\n        canvasWidth,\n        fontSize\n      } = properties;\n\n      if (prevFontSize !== fontSize || prevFontFamily !== fontFamily) {\n        ctx.font = `${fontSize * this.#scale}px ${fontFamily}`;\n        params.prevFontSize = fontSize;\n        params.prevFontFamily = fontFamily;\n      }\n\n      const {\n        width\n      } = ctx.measureText(div.textContent);\n\n      if (width > 0) {\n        transform = `scaleX(${canvasWidth * this.#scale / width}) ${transform}`;\n      }\n    }\n\n    if (properties.angle !== 0) {\n      transform = `rotate(${properties.angle}deg) ${transform}`;\n    }\n\n    if (transform.length > 0) {\n      style.transform = transform;\n    }\n  }\n\n  static cleanup() {\n    if (this.#pendingTextLayers.size > 0) {\n      return;\n    }\n\n    this.#ascentCache.clear();\n\n    for (const {\n      canvas\n    } of this.#canvasContexts.values()) {\n      canvas.remove();\n    }\n\n    this.#canvasContexts.clear();\n  }\n\n  static #getCtx(lang = null) {\n    let canvasContext = this.#canvasContexts.get(lang ||= \"\");\n\n    if (!canvasContext) {\n      const canvas = document.createElement(\"canvas\");\n      canvas.className = \"hiddenCanvasElement\";\n      canvas.lang = lang;\n      document.body.append(canvas);\n      canvasContext = canvas.getContext(\"2d\", {\n        alpha: false,\n        willReadFrequently: true\n      });\n      this.#canvasContexts.set(lang, canvasContext);\n    }\n\n    return canvasContext;\n  }\n\n  static #ensureMinFontSizeComputed() {\n    if (this.#minFontSize !== null) {\n      return;\n    }\n\n    const div = document.createElement(\"div\");\n    div.style.opacity = 0;\n    div.style.lineHeight = 1;\n    div.style.fontSize = \"1px\";\n    div.style.position = \"absolute\";\n    div.textContent = \"X\";\n    document.body.append(div);\n    this.#minFontSize = div.getBoundingClientRect().height;\n    div.remove();\n  }\n\n  static #getAscent(fontFamily, lang) {\n    const cachedAscent = this.#ascentCache.get(fontFamily);\n\n    if (cachedAscent) {\n      return cachedAscent;\n    }\n\n    const ctx = this.#getCtx(lang);\n    const savedFont = ctx.font;\n    ctx.canvas.width = ctx.canvas.height = DEFAULT_FONT_SIZE;\n    ctx.font = `${DEFAULT_FONT_SIZE}px ${fontFamily}`;\n    const metrics = ctx.measureText(\"\");\n    let ascent = metrics.fontBoundingBoxAscent;\n    let descent = Math.abs(metrics.fontBoundingBoxDescent);\n\n    if (ascent) {\n      const ratio = ascent / (ascent + descent);\n      this.#ascentCache.set(fontFamily, ratio);\n      ctx.canvas.width = ctx.canvas.height = 0;\n      ctx.font = savedFont;\n      return ratio;\n    }\n\n    ctx.strokeStyle = \"red\";\n    ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n    ctx.strokeText(\"g\", 0, 0);\n    let pixels = ctx.getImageData(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE).data;\n    descent = 0;\n\n    for (let i = pixels.length - 1 - 3; i >= 0; i -= 4) {\n      if (pixels[i] > 0) {\n        descent = Math.ceil(i / 4 / DEFAULT_FONT_SIZE);\n        break;\n      }\n    }\n\n    ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n    ctx.strokeText(\"A\", 0, DEFAULT_FONT_SIZE);\n    pixels = ctx.getImageData(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE).data;\n    ascent = 0;\n\n    for (let i = 0, ii = pixels.length; i < ii; i += 4) {\n      if (pixels[i] > 0) {\n        ascent = DEFAULT_FONT_SIZE - Math.floor(i / 4 / DEFAULT_FONT_SIZE);\n        break;\n      }\n    }\n\n    ctx.canvas.width = ctx.canvas.height = 0;\n    ctx.font = savedFont;\n    const ratio = ascent ? ascent / (ascent + descent) : DEFAULT_FONT_ASCENT;\n    this.#ascentCache.set(fontFamily, ratio);\n    return ratio;\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/xfa_text.js\n\nclass XfaText {\n  static textContent(xfa) {\n    const items = [];\n    const output = {\n      items,\n      styles: Object.create(null)\n    };\n\n    function walk(node) {\n      if (!node) {\n        return;\n      }\n\n      let str = null;\n      const name = node.name;\n\n      if (name === \"#text\") {\n        str = node.value;\n      } else if (!XfaText.shouldBuildText(name)) {\n        return;\n      } else if (node?.attributes?.textContent) {\n        str = node.attributes.textContent;\n      } else if (node.value) {\n        str = node.value;\n      }\n\n      if (str !== null) {\n        items.push({\n          str\n        });\n      }\n\n      if (!node.children) {\n        return;\n      }\n\n      for (const child of node.children) {\n        walk(child);\n      }\n    }\n\n    walk(xfa);\n    return output;\n  }\n\n  static shouldBuildText(name) {\n    return !(name === \"textarea\" || name === \"input\" || name === \"option\" || name === \"select\");\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/api.js\n\nconst DEFAULT_RANGE_CHUNK_SIZE = 65536;\nconst RENDERING_CANCELLED_TIMEOUT = 100;\nconst DELAYED_CLEANUP_TIMEOUT = 5000;\nconst DefaultCanvasFactory = isNodeJS ? NodeCanvasFactory : DOMCanvasFactory;\nconst DefaultCMapReaderFactory = isNodeJS ? NodeCMapReaderFactory : DOMCMapReaderFactory;\nconst DefaultFilterFactory = isNodeJS ? NodeFilterFactory : DOMFilterFactory;\nconst DefaultStandardFontDataFactory = isNodeJS ? NodeStandardFontDataFactory : DOMStandardFontDataFactory;\n\nfunction getDocument(src = {}) {\n  if (typeof src === \"string\" || src instanceof URL) {\n    src = {\n      url: src\n    };\n  } else if (src instanceof ArrayBuffer || ArrayBuffer.isView(src)) {\n    src = {\n      data: src\n    };\n  }\n\n  const task = new PDFDocumentLoadingTask();\n  const {\n    docId\n  } = task;\n  const url = src.url ? getUrlProp(src.url) : null;\n  const data = src.data ? getDataProp(src.data) : null;\n  const httpHeaders = src.httpHeaders || null;\n  const withCredentials = src.withCredentials === true;\n  const password = src.password ?? null;\n  const rangeTransport = src.range instanceof PDFDataRangeTransport ? src.range : null;\n  const rangeChunkSize = Number.isInteger(src.rangeChunkSize) && src.rangeChunkSize > 0 ? src.rangeChunkSize : DEFAULT_RANGE_CHUNK_SIZE;\n  let worker = src.worker instanceof PDFWorker ? src.worker : null;\n  const verbosity = src.verbosity;\n  const docBaseUrl = typeof src.docBaseUrl === \"string\" && !isDataScheme(src.docBaseUrl) ? src.docBaseUrl : null;\n  const cMapUrl = typeof src.cMapUrl === \"string\" ? src.cMapUrl : null;\n  const cMapPacked = src.cMapPacked !== false;\n  const CMapReaderFactory = src.CMapReaderFactory || DefaultCMapReaderFactory;\n  const standardFontDataUrl = typeof src.standardFontDataUrl === \"string\" ? src.standardFontDataUrl : null;\n  const StandardFontDataFactory = src.StandardFontDataFactory || DefaultStandardFontDataFactory;\n  const ignoreErrors = src.stopAtErrors !== true;\n  const maxImageSize = Number.isInteger(src.maxImageSize) && src.maxImageSize > -1 ? src.maxImageSize : -1;\n  const isEvalSupported = src.isEvalSupported !== false;\n  const isOffscreenCanvasSupported = typeof src.isOffscreenCanvasSupported === \"boolean\" ? src.isOffscreenCanvasSupported : !isNodeJS;\n  const canvasMaxAreaInBytes = Number.isInteger(src.canvasMaxAreaInBytes) ? src.canvasMaxAreaInBytes : -1;\n  const disableFontFace = typeof src.disableFontFace === \"boolean\" ? src.disableFontFace : isNodeJS;\n  const fontExtraProperties = src.fontExtraProperties === true;\n  const enableXfa = src.enableXfa === true;\n  const ownerDocument = src.ownerDocument || globalThis.document;\n  const disableRange = src.disableRange === true;\n  const disableStream = src.disableStream === true;\n  const disableAutoFetch = src.disableAutoFetch === true;\n  const pdfBug = src.pdfBug === true;\n  const enableHWA = src.enableHWA === true;\n  const length = rangeTransport ? rangeTransport.length : src.length ?? NaN;\n  const useSystemFonts = typeof src.useSystemFonts === \"boolean\" ? src.useSystemFonts : !isNodeJS && !disableFontFace;\n  const useWorkerFetch = typeof src.useWorkerFetch === \"boolean\" ? src.useWorkerFetch : CMapReaderFactory === DOMCMapReaderFactory && StandardFontDataFactory === DOMStandardFontDataFactory && cMapUrl && standardFontDataUrl && isValidFetchUrl(cMapUrl, document.baseURI) && isValidFetchUrl(standardFontDataUrl, document.baseURI);\n  const canvasFactory = src.canvasFactory || new DefaultCanvasFactory({\n    ownerDocument,\n    enableHWA\n  });\n  const filterFactory = src.filterFactory || new DefaultFilterFactory({\n    docId,\n    ownerDocument\n  });\n  const styleElement = null;\n  setVerbosityLevel(verbosity);\n  const transportFactory = {\n    canvasFactory,\n    filterFactory\n  };\n\n  if (!useWorkerFetch) {\n    transportFactory.cMapReaderFactory = new CMapReaderFactory({\n      baseUrl: cMapUrl,\n      isCompressed: cMapPacked\n    });\n    transportFactory.standardFontDataFactory = new StandardFontDataFactory({\n      baseUrl: standardFontDataUrl\n    });\n  }\n\n  if (!worker) {\n    const workerParams = {\n      verbosity,\n      port: GlobalWorkerOptions.workerPort\n    };\n    worker = workerParams.port ? PDFWorker.fromPort(workerParams) : new PDFWorker(workerParams);\n    task._worker = worker;\n  }\n\n  const docParams = {\n    docId,\n    apiVersion: \"4.6.82\",\n    data,\n    password,\n    disableAutoFetch,\n    rangeChunkSize,\n    length,\n    docBaseUrl,\n    enableXfa,\n    evaluatorOptions: {\n      maxImageSize,\n      disableFontFace,\n      ignoreErrors,\n      isEvalSupported,\n      isOffscreenCanvasSupported,\n      canvasMaxAreaInBytes,\n      fontExtraProperties,\n      useSystemFonts,\n      cMapUrl: useWorkerFetch ? cMapUrl : null,\n      standardFontDataUrl: useWorkerFetch ? standardFontDataUrl : null\n    }\n  };\n  const transportParams = {\n    disableFontFace,\n    fontExtraProperties,\n    ownerDocument,\n    pdfBug,\n    styleElement,\n    loadingParams: {\n      disableAutoFetch,\n      enableXfa\n    }\n  };\n  worker.promise.then(function () {\n    if (task.destroyed) {\n      throw new Error(\"Loading aborted\");\n    }\n\n    if (worker.destroyed) {\n      throw new Error(\"Worker was destroyed\");\n    }\n\n    const workerIdPromise = worker.messageHandler.sendWithPromise(\"GetDocRequest\", docParams, data ? [data.buffer] : null);\n    let networkStream;\n\n    if (rangeTransport) {\n      networkStream = new PDFDataTransportStream(rangeTransport, {\n        disableRange,\n        disableStream\n      });\n    } else if (!data) {\n      if (!url) {\n        throw new Error(\"getDocument - no `url` parameter provided.\");\n      }\n\n      const createPDFNetworkStream = params => {\n        if (isNodeJS) {\n          const isFetchSupported = function () {\n            return typeof fetch !== \"undefined\" && typeof Response !== \"undefined\" && \"body\" in Response.prototype;\n          };\n\n          return isFetchSupported() && isValidFetchUrl(params.url) ? new PDFFetchStream(params) : new PDFNodeStream(params);\n        }\n\n        return isValidFetchUrl(params.url) ? new PDFFetchStream(params) : new PDFNetworkStream(params);\n      };\n\n      networkStream = createPDFNetworkStream({\n        url,\n        length,\n        httpHeaders,\n        withCredentials,\n        rangeChunkSize,\n        disableRange,\n        disableStream\n      });\n    }\n\n    return workerIdPromise.then(workerId => {\n      if (task.destroyed) {\n        throw new Error(\"Loading aborted\");\n      }\n\n      if (worker.destroyed) {\n        throw new Error(\"Worker was destroyed\");\n      }\n\n      const messageHandler = new MessageHandler(docId, workerId, worker.port);\n      const transport = new WorkerTransport(messageHandler, task, networkStream, transportParams, transportFactory);\n      task._transport = transport;\n      messageHandler.send(\"Ready\", null);\n    });\n  }).catch(task._capability.reject);\n  return task;\n}\n\nfunction getUrlProp(val) {\n  if (val instanceof URL) {\n    return val.href;\n  }\n\n  try {\n    return new URL(val, window.location).href;\n  } catch {\n    if (isNodeJS && typeof val === \"string\") {\n      return val;\n    }\n  }\n\n  throw new Error(\"Invalid PDF url data: \" + \"either string or URL-object is expected in the url property.\");\n}\n\nfunction getDataProp(val) {\n  if (isNodeJS && typeof Buffer !== \"undefined\" && val instanceof Buffer) {\n    throw new Error(\"Please provide binary data as `Uint8Array`, rather than `Buffer`.\");\n  }\n\n  if (val instanceof Uint8Array && val.byteLength === val.buffer.byteLength) {\n    return val;\n  }\n\n  if (typeof val === \"string\") {\n    return stringToBytes(val);\n  }\n\n  if (val instanceof ArrayBuffer || ArrayBuffer.isView(val) || typeof val === \"object\" && !isNaN(val?.length)) {\n    return new Uint8Array(val);\n  }\n\n  throw new Error(\"Invalid PDF binary data: either TypedArray, \" + \"string, or array-like object is expected in the data property.\");\n}\n\nfunction isRefProxy(ref) {\n  return typeof ref === \"object\" && Number.isInteger(ref?.num) && ref.num >= 0 && Number.isInteger(ref?.gen) && ref.gen >= 0;\n}\n\nclass PDFDocumentLoadingTask {\n  static #docId = 0;\n\n  constructor() {\n    this._capability = Promise.withResolvers();\n    this._transport = null;\n    this._worker = null;\n    this.docId = `d${PDFDocumentLoadingTask.#docId++}`;\n    this.destroyed = false;\n    this.onPassword = null;\n    this.onProgress = null;\n  }\n\n  get promise() {\n    return this._capability.promise;\n  }\n\n  destroy() {\n    var _this25 = this;\n\n    return _asyncToGenerator(function* () {\n      _this25.destroyed = true;\n\n      try {\n        if (_this25._worker?.port) {\n          _this25._worker._pendingDestroy = true;\n        }\n\n        yield _this25._transport?.destroy();\n      } catch (ex) {\n        if (_this25._worker?.port) {\n          delete _this25._worker._pendingDestroy;\n        }\n\n        throw ex;\n      }\n\n      _this25._transport = null;\n\n      if (_this25._worker) {\n        _this25._worker.destroy();\n\n        _this25._worker = null;\n      }\n    })();\n  }\n\n}\n\nclass PDFDataRangeTransport {\n  constructor(length, initialData, progressiveDone = false, contentDispositionFilename = null) {\n    this.length = length;\n    this.initialData = initialData;\n    this.progressiveDone = progressiveDone;\n    this.contentDispositionFilename = contentDispositionFilename;\n    this._rangeListeners = [];\n    this._progressListeners = [];\n    this._progressiveReadListeners = [];\n    this._progressiveDoneListeners = [];\n    this._readyCapability = Promise.withResolvers();\n  }\n\n  addRangeListener(listener) {\n    this._rangeListeners.push(listener);\n  }\n\n  addProgressListener(listener) {\n    this._progressListeners.push(listener);\n  }\n\n  addProgressiveReadListener(listener) {\n    this._progressiveReadListeners.push(listener);\n  }\n\n  addProgressiveDoneListener(listener) {\n    this._progressiveDoneListeners.push(listener);\n  }\n\n  onDataRange(begin, chunk) {\n    for (const listener of this._rangeListeners) {\n      listener(begin, chunk);\n    }\n  }\n\n  onDataProgress(loaded, total) {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressListeners) {\n        listener(loaded, total);\n      }\n    });\n  }\n\n  onDataProgressiveRead(chunk) {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressiveReadListeners) {\n        listener(chunk);\n      }\n    });\n  }\n\n  onDataProgressiveDone() {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressiveDoneListeners) {\n        listener();\n      }\n    });\n  }\n\n  transportReady() {\n    this._readyCapability.resolve();\n  }\n\n  requestDataRange(begin, end) {\n    unreachable(\"Abstract method PDFDataRangeTransport.requestDataRange\");\n  }\n\n  abort() {}\n\n}\n\nclass PDFDocumentProxy {\n  constructor(pdfInfo, transport) {\n    this._pdfInfo = pdfInfo;\n    this._transport = transport;\n  }\n\n  get annotationStorage() {\n    return this._transport.annotationStorage;\n  }\n\n  get filterFactory() {\n    return this._transport.filterFactory;\n  }\n\n  get numPages() {\n    return this._pdfInfo.numPages;\n  }\n\n  get fingerprints() {\n    return this._pdfInfo.fingerprints;\n  }\n\n  get isPureXfa() {\n    return shadow(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n  }\n\n  get allXfaHtml() {\n    return this._transport._htmlForXfa;\n  }\n\n  getPage(pageNumber) {\n    return this._transport.getPage(pageNumber);\n  }\n\n  getPageIndex(ref) {\n    return this._transport.getPageIndex(ref);\n  }\n\n  getDestinations() {\n    return this._transport.getDestinations();\n  }\n\n  getDestination(id) {\n    return this._transport.getDestination(id);\n  }\n\n  getPageLabels() {\n    return this._transport.getPageLabels();\n  }\n\n  getPageLayout() {\n    return this._transport.getPageLayout();\n  }\n\n  getPageMode() {\n    return this._transport.getPageMode();\n  }\n\n  getViewerPreferences() {\n    return this._transport.getViewerPreferences();\n  }\n\n  getOpenAction() {\n    return this._transport.getOpenAction();\n  }\n\n  getAttachments() {\n    return this._transport.getAttachments();\n  }\n\n  getJSActions() {\n    return this._transport.getDocJSActions();\n  }\n\n  getOutline() {\n    return this._transport.getOutline();\n  }\n\n  getOptionalContentConfig({\n    intent = \"display\"\n  } = {}) {\n    const {\n      renderingIntent\n    } = this._transport.getRenderingIntent(intent);\n\n    return this._transport.getOptionalContentConfig(renderingIntent);\n  }\n\n  getPermissions() {\n    return this._transport.getPermissions();\n  }\n\n  getMetadata() {\n    return this._transport.getMetadata();\n  }\n\n  getMarkInfo() {\n    return this._transport.getMarkInfo();\n  }\n\n  getData() {\n    return this._transport.getData();\n  }\n\n  saveDocument() {\n    return this._transport.saveDocument();\n  }\n\n  getDownloadInfo() {\n    return this._transport.downloadInfoCapability.promise;\n  }\n\n  cleanup(keepLoadedFonts = false) {\n    return this._transport.startCleanup(keepLoadedFonts || this.isPureXfa);\n  }\n\n  destroy() {\n    return this.loadingTask.destroy();\n  }\n\n  cachedPageNumber(ref) {\n    return this._transport.cachedPageNumber(ref);\n  }\n\n  get loadingParams() {\n    return this._transport.loadingParams;\n  }\n\n  get loadingTask() {\n    return this._transport.loadingTask;\n  }\n\n  getFieldObjects() {\n    return this._transport.getFieldObjects();\n  }\n\n  hasJSActions() {\n    return this._transport.hasJSActions();\n  }\n\n  getCalculationOrderIds() {\n    return this._transport.getCalculationOrderIds();\n  }\n\n}\n\nclass PDFPageProxy {\n  #delayedCleanupTimeout = null;\n  #pendingCleanup = false;\n\n  constructor(pageIndex, pageInfo, transport, pdfBug = false) {\n    this._pageIndex = pageIndex;\n    this._pageInfo = pageInfo;\n    this._transport = transport;\n    this._stats = pdfBug ? new StatTimer() : null;\n    this._pdfBug = pdfBug;\n    this.commonObjs = transport.commonObjs;\n    this.objs = new PDFObjects();\n    this._maybeCleanupAfterRender = false;\n    this._intentStates = new Map();\n    this.destroyed = false;\n  }\n\n  get pageNumber() {\n    return this._pageIndex + 1;\n  }\n\n  get rotate() {\n    return this._pageInfo.rotate;\n  }\n\n  get ref() {\n    return this._pageInfo.ref;\n  }\n\n  get userUnit() {\n    return this._pageInfo.userUnit;\n  }\n\n  get view() {\n    return this._pageInfo.view;\n  }\n\n  getViewport({\n    scale,\n    rotation = this.rotate,\n    offsetX = 0,\n    offsetY = 0,\n    dontFlip = false\n  } = {}) {\n    return new PageViewport({\n      viewBox: this.view,\n      scale,\n      rotation,\n      offsetX,\n      offsetY,\n      dontFlip\n    });\n  }\n\n  getAnnotations({\n    intent = \"display\"\n  } = {}) {\n    const {\n      renderingIntent\n    } = this._transport.getRenderingIntent(intent);\n\n    return this._transport.getAnnotations(this._pageIndex, renderingIntent);\n  }\n\n  getJSActions() {\n    return this._transport.getPageJSActions(this._pageIndex);\n  }\n\n  get filterFactory() {\n    return this._transport.filterFactory;\n  }\n\n  get isPureXfa() {\n    return shadow(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n  }\n\n  getXfa() {\n    var _this26 = this;\n\n    return _asyncToGenerator(function* () {\n      return _this26._transport._htmlForXfa?.children[_this26._pageIndex] || null;\n    })();\n  }\n\n  render({\n    canvasContext,\n    viewport,\n    intent = \"display\",\n    annotationMode = AnnotationMode.ENABLE,\n    transform = null,\n    background = null,\n    optionalContentConfigPromise = null,\n    annotationCanvasMap = null,\n    pageColors = null,\n    printAnnotationStorage = null,\n    isEditing = false\n  }) {\n    this._stats?.time(\"Overall\");\n\n    const intentArgs = this._transport.getRenderingIntent(intent, annotationMode, printAnnotationStorage, isEditing);\n\n    const {\n      renderingIntent,\n      cacheKey\n    } = intentArgs;\n    this.#pendingCleanup = false;\n    this.#abortDelayedCleanup();\n    optionalContentConfigPromise ||= this._transport.getOptionalContentConfig(renderingIntent);\n\n    let intentState = this._intentStates.get(cacheKey);\n\n    if (!intentState) {\n      intentState = Object.create(null);\n\n      this._intentStates.set(cacheKey, intentState);\n    }\n\n    if (intentState.streamReaderCancelTimeout) {\n      clearTimeout(intentState.streamReaderCancelTimeout);\n      intentState.streamReaderCancelTimeout = null;\n    }\n\n    const intentPrint = !!(renderingIntent & RenderingIntentFlag.PRINT);\n\n    if (!intentState.displayReadyCapability) {\n      intentState.displayReadyCapability = Promise.withResolvers();\n      intentState.operatorList = {\n        fnArray: [],\n        argsArray: [],\n        lastChunk: false,\n        separateAnnots: null\n      };\n      this._stats?.time(\"Page Request\");\n\n      this._pumpOperatorList(intentArgs);\n    }\n\n    const complete = error => {\n      intentState.renderTasks.delete(internalRenderTask);\n\n      if (this._maybeCleanupAfterRender || intentPrint) {\n        this.#pendingCleanup = true;\n      }\n\n      this.#tryCleanup(!intentPrint);\n\n      if (error) {\n        internalRenderTask.capability.reject(error);\n\n        this._abortOperatorList({\n          intentState,\n          reason: error instanceof Error ? error : new Error(error)\n        });\n      } else {\n        internalRenderTask.capability.resolve();\n      }\n\n      if (this._stats) {\n        this._stats.timeEnd(\"Rendering\");\n\n        this._stats.timeEnd(\"Overall\");\n\n        if (globalThis.Stats?.enabled) {\n          globalThis.Stats.add(this.pageNumber, this._stats);\n        }\n      }\n    };\n\n    const internalRenderTask = new InternalRenderTask({\n      callback: complete,\n      params: {\n        canvasContext,\n        viewport,\n        transform,\n        background\n      },\n      objs: this.objs,\n      commonObjs: this.commonObjs,\n      annotationCanvasMap,\n      operatorList: intentState.operatorList,\n      pageIndex: this._pageIndex,\n      canvasFactory: this._transport.canvasFactory,\n      filterFactory: this._transport.filterFactory,\n      useRequestAnimationFrame: !intentPrint,\n      pdfBug: this._pdfBug,\n      pageColors\n    });\n    (intentState.renderTasks ||= new Set()).add(internalRenderTask);\n    const renderTask = internalRenderTask.task;\n    Promise.all([intentState.displayReadyCapability.promise, optionalContentConfigPromise]).then(([transparency, optionalContentConfig]) => {\n      if (this.destroyed) {\n        complete();\n        return;\n      }\n\n      this._stats?.time(\"Rendering\");\n\n      if (!(optionalContentConfig.renderingIntent & renderingIntent)) {\n        throw new Error(\"Must use the same `intent`-argument when calling the `PDFPageProxy.render` \" + \"and `PDFDocumentProxy.getOptionalContentConfig` methods.\");\n      }\n\n      internalRenderTask.initializeGraphics({\n        transparency,\n        optionalContentConfig\n      });\n      internalRenderTask.operatorListChanged();\n    }).catch(complete);\n    return renderTask;\n  }\n\n  getOperatorList({\n    intent = \"display\",\n    annotationMode = AnnotationMode.ENABLE,\n    printAnnotationStorage = null,\n    isEditing = false\n  } = {}) {\n    function operatorListChanged() {\n      if (intentState.operatorList.lastChunk) {\n        intentState.opListReadCapability.resolve(intentState.operatorList);\n        intentState.renderTasks.delete(opListTask);\n      }\n    }\n\n    const intentArgs = this._transport.getRenderingIntent(intent, annotationMode, printAnnotationStorage, isEditing, true);\n\n    let intentState = this._intentStates.get(intentArgs.cacheKey);\n\n    if (!intentState) {\n      intentState = Object.create(null);\n\n      this._intentStates.set(intentArgs.cacheKey, intentState);\n    }\n\n    let opListTask;\n\n    if (!intentState.opListReadCapability) {\n      opListTask = Object.create(null);\n      opListTask.operatorListChanged = operatorListChanged;\n      intentState.opListReadCapability = Promise.withResolvers();\n      (intentState.renderTasks ||= new Set()).add(opListTask);\n      intentState.operatorList = {\n        fnArray: [],\n        argsArray: [],\n        lastChunk: false,\n        separateAnnots: null\n      };\n      this._stats?.time(\"Page Request\");\n\n      this._pumpOperatorList(intentArgs);\n    }\n\n    return intentState.opListReadCapability.promise;\n  }\n\n  streamTextContent({\n    includeMarkedContent = false,\n    disableNormalization = false\n  } = {}) {\n    const TEXT_CONTENT_CHUNK_SIZE = 100;\n    return this._transport.messageHandler.sendWithStream(\"GetTextContent\", {\n      pageIndex: this._pageIndex,\n      includeMarkedContent: includeMarkedContent === true,\n      disableNormalization: disableNormalization === true\n    }, {\n      highWaterMark: TEXT_CONTENT_CHUNK_SIZE,\n\n      size(textContent) {\n        return textContent.items.length;\n      }\n\n    });\n  }\n\n  getTextContent(params = {}) {\n    if (this._transport._htmlForXfa) {\n      return this.getXfa().then(xfa => XfaText.textContent(xfa));\n    }\n\n    const readableStream = this.streamTextContent(params);\n    return new Promise(function (resolve, reject) {\n      function pump() {\n        reader.read().then(function ({\n          value,\n          done\n        }) {\n          if (done) {\n            resolve(textContent);\n            return;\n          }\n\n          textContent.lang ??= value.lang;\n          Object.assign(textContent.styles, value.styles);\n          textContent.items.push(...value.items);\n          pump();\n        }, reject);\n      }\n\n      const reader = readableStream.getReader();\n      const textContent = {\n        items: [],\n        styles: Object.create(null),\n        lang: null\n      };\n      pump();\n    });\n  }\n\n  getStructTree() {\n    return this._transport.getStructTree(this._pageIndex);\n  }\n\n  _destroy() {\n    this.destroyed = true;\n    const waitOn = [];\n\n    for (const intentState of this._intentStates.values()) {\n      this._abortOperatorList({\n        intentState,\n        reason: new Error(\"Page was destroyed.\"),\n        force: true\n      });\n\n      if (intentState.opListReadCapability) {\n        continue;\n      }\n\n      for (const internalRenderTask of intentState.renderTasks) {\n        waitOn.push(internalRenderTask.completed);\n        internalRenderTask.cancel();\n      }\n    }\n\n    this.objs.clear();\n    this.#pendingCleanup = false;\n    this.#abortDelayedCleanup();\n    return Promise.all(waitOn);\n  }\n\n  cleanup(resetStats = false) {\n    this.#pendingCleanup = true;\n    const success = this.#tryCleanup(false);\n\n    if (resetStats && success) {\n      this._stats &&= new StatTimer();\n    }\n\n    return success;\n  }\n\n  #tryCleanup(delayed = false) {\n    this.#abortDelayedCleanup();\n\n    if (!this.#pendingCleanup || this.destroyed) {\n      return false;\n    }\n\n    if (delayed) {\n      this.#delayedCleanupTimeout = setTimeout(() => {\n        this.#delayedCleanupTimeout = null;\n        this.#tryCleanup(false);\n      }, DELAYED_CLEANUP_TIMEOUT);\n      return false;\n    }\n\n    for (const {\n      renderTasks,\n      operatorList\n    } of this._intentStates.values()) {\n      if (renderTasks.size > 0 || !operatorList.lastChunk) {\n        return false;\n      }\n    }\n\n    this._intentStates.clear();\n\n    this.objs.clear();\n    this.#pendingCleanup = false;\n    return true;\n  }\n\n  #abortDelayedCleanup() {\n    if (this.#delayedCleanupTimeout) {\n      clearTimeout(this.#delayedCleanupTimeout);\n      this.#delayedCleanupTimeout = null;\n    }\n  }\n\n  _startRenderPage(transparency, cacheKey) {\n    const intentState = this._intentStates.get(cacheKey);\n\n    if (!intentState) {\n      return;\n    }\n\n    this._stats?.timeEnd(\"Page Request\");\n    intentState.displayReadyCapability?.resolve(transparency);\n  }\n\n  _renderPageChunk(operatorListChunk, intentState) {\n    for (let i = 0, ii = operatorListChunk.length; i < ii; i++) {\n      intentState.operatorList.fnArray.push(operatorListChunk.fnArray[i]);\n      intentState.operatorList.argsArray.push(operatorListChunk.argsArray[i]);\n    }\n\n    intentState.operatorList.lastChunk = operatorListChunk.lastChunk;\n    intentState.operatorList.separateAnnots = operatorListChunk.separateAnnots;\n\n    for (const internalRenderTask of intentState.renderTasks) {\n      internalRenderTask.operatorListChanged();\n    }\n\n    if (operatorListChunk.lastChunk) {\n      this.#tryCleanup(true);\n    }\n  }\n\n  _pumpOperatorList({\n    renderingIntent,\n    cacheKey,\n    annotationStorageSerializable,\n    modifiedIds\n  }) {\n    const {\n      map,\n      transfer\n    } = annotationStorageSerializable;\n\n    const readableStream = this._transport.messageHandler.sendWithStream(\"GetOperatorList\", {\n      pageIndex: this._pageIndex,\n      intent: renderingIntent,\n      cacheKey,\n      annotationStorage: map,\n      modifiedIds\n    }, transfer);\n\n    const reader = readableStream.getReader();\n\n    const intentState = this._intentStates.get(cacheKey);\n\n    intentState.streamReader = reader;\n\n    const pump = () => {\n      reader.read().then(({\n        value,\n        done\n      }) => {\n        if (done) {\n          intentState.streamReader = null;\n          return;\n        }\n\n        if (this._transport.destroyed) {\n          return;\n        }\n\n        this._renderPageChunk(value, intentState);\n\n        pump();\n      }, reason => {\n        intentState.streamReader = null;\n\n        if (this._transport.destroyed) {\n          return;\n        }\n\n        if (intentState.operatorList) {\n          intentState.operatorList.lastChunk = true;\n\n          for (const internalRenderTask of intentState.renderTasks) {\n            internalRenderTask.operatorListChanged();\n          }\n\n          this.#tryCleanup(true);\n        }\n\n        if (intentState.displayReadyCapability) {\n          intentState.displayReadyCapability.reject(reason);\n        } else if (intentState.opListReadCapability) {\n          intentState.opListReadCapability.reject(reason);\n        } else {\n          throw reason;\n        }\n      });\n    };\n\n    pump();\n  }\n\n  _abortOperatorList({\n    intentState,\n    reason,\n    force = false\n  }) {\n    if (!intentState.streamReader) {\n      return;\n    }\n\n    if (intentState.streamReaderCancelTimeout) {\n      clearTimeout(intentState.streamReaderCancelTimeout);\n      intentState.streamReaderCancelTimeout = null;\n    }\n\n    if (!force) {\n      if (intentState.renderTasks.size > 0) {\n        return;\n      }\n\n      if (reason instanceof RenderingCancelledException) {\n        let delay = RENDERING_CANCELLED_TIMEOUT;\n\n        if (reason.extraDelay > 0 && reason.extraDelay < 1000) {\n          delay += reason.extraDelay;\n        }\n\n        intentState.streamReaderCancelTimeout = setTimeout(() => {\n          intentState.streamReaderCancelTimeout = null;\n\n          this._abortOperatorList({\n            intentState,\n            reason,\n            force: true\n          });\n        }, delay);\n        return;\n      }\n    }\n\n    intentState.streamReader.cancel(new AbortException(reason.message)).catch(() => {});\n    intentState.streamReader = null;\n\n    if (this._transport.destroyed) {\n      return;\n    }\n\n    for (const [curCacheKey, curIntentState] of this._intentStates) {\n      if (curIntentState === intentState) {\n        this._intentStates.delete(curCacheKey);\n\n        break;\n      }\n    }\n\n    this.cleanup();\n  }\n\n  get stats() {\n    return this._stats;\n  }\n\n}\n\nclass LoopbackPort {\n  #listeners = new Set();\n  #deferred = Promise.resolve();\n\n  postMessage(obj, transfer) {\n    const event = {\n      data: structuredClone(obj, transfer ? {\n        transfer\n      } : null)\n    };\n    this.#deferred.then(() => {\n      for (const listener of this.#listeners) {\n        listener.call(this, event);\n      }\n    });\n  }\n\n  addEventListener(name, listener) {\n    this.#listeners.add(listener);\n  }\n\n  removeEventListener(name, listener) {\n    this.#listeners.delete(listener);\n  }\n\n  terminate() {\n    this.#listeners.clear();\n  }\n\n}\n\nclass PDFWorker {\n  static #fakeWorkerId = 0;\n  static #isWorkerDisabled = false;\n  static #workerPorts;\n  static {\n    if (isNodeJS) {\n      this.#isWorkerDisabled = true;\n      GlobalWorkerOptions.workerSrc ||= \"./pdf.worker.mjs\";\n    }\n\n    this._isSameOrigin = (baseUrl, otherUrl) => {\n      let base;\n\n      try {\n        base = new URL(baseUrl);\n\n        if (!base.origin || base.origin === \"null\") {\n          return false;\n        }\n      } catch {\n        return false;\n      }\n\n      const other = new URL(otherUrl, base);\n      return base.origin === other.origin;\n    };\n\n    this._createCDNWrapper = url => {\n      const wrapper = `await import(\"${url}\");`;\n      return URL.createObjectURL(new Blob([wrapper], {\n        type: \"text/javascript\"\n      }));\n    };\n\n  }\n\n  constructor({\n    name = null,\n    port = null,\n    verbosity = getVerbosityLevel()\n  } = {}) {\n    this.name = name;\n    this.destroyed = false;\n    this.verbosity = verbosity;\n    this._readyCapability = Promise.withResolvers();\n    this._port = null;\n    this._webWorker = null;\n    this._messageHandler = null;\n\n    if (port) {\n      if (PDFWorker.#workerPorts?.has(port)) {\n        throw new Error(\"Cannot use more than one PDFWorker per port.\");\n      }\n\n      (PDFWorker.#workerPorts ||= new WeakMap()).set(port, this);\n\n      this._initializeFromPort(port);\n\n      return;\n    }\n\n    this._initialize();\n  }\n\n  get promise() {\n    if (isNodeJS) {\n      return Promise.all([NodePackages.promise, this._readyCapability.promise]);\n    }\n\n    return this._readyCapability.promise;\n  }\n\n  #resolve() {\n    this._readyCapability.resolve();\n\n    this._messageHandler.send(\"configure\", {\n      verbosity: this.verbosity\n    });\n  }\n\n  get port() {\n    return this._port;\n  }\n\n  get messageHandler() {\n    return this._messageHandler;\n  }\n\n  _initializeFromPort(port) {\n    this._port = port;\n    this._messageHandler = new MessageHandler(\"main\", \"worker\", port);\n\n    this._messageHandler.on(\"ready\", function () {});\n\n    this.#resolve();\n  }\n\n  _initialize() {\n    if (PDFWorker.#isWorkerDisabled || PDFWorker.#mainThreadWorkerMessageHandler) {\n      this._setupFakeWorker();\n\n      return;\n    }\n\n    let {\n      workerSrc\n    } = PDFWorker;\n\n    try {\n      if (!PDFWorker._isSameOrigin(window.location.href, workerSrc)) {\n        workerSrc = PDFWorker._createCDNWrapper(new URL(workerSrc, window.location).href);\n      }\n\n      const worker = new Worker(workerSrc, {\n        type: \"module\"\n      });\n      const messageHandler = new MessageHandler(\"main\", \"worker\", worker);\n\n      const terminateEarly = () => {\n        ac.abort();\n        messageHandler.destroy();\n        worker.terminate();\n\n        if (this.destroyed) {\n          this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n        } else {\n          this._setupFakeWorker();\n        }\n      };\n\n      const ac = new AbortController();\n      worker.addEventListener(\"error\", () => {\n        if (!this._webWorker) {\n          terminateEarly();\n        }\n      }, {\n        signal: ac.signal\n      });\n      messageHandler.on(\"test\", data => {\n        ac.abort();\n\n        if (this.destroyed || !data) {\n          terminateEarly();\n          return;\n        }\n\n        this._messageHandler = messageHandler;\n        this._port = worker;\n        this._webWorker = worker;\n        this.#resolve();\n      });\n      messageHandler.on(\"ready\", data => {\n        ac.abort();\n\n        if (this.destroyed) {\n          terminateEarly();\n          return;\n        }\n\n        try {\n          sendTest();\n        } catch {\n          this._setupFakeWorker();\n        }\n      });\n\n      const sendTest = () => {\n        const testObj = new Uint8Array();\n        messageHandler.send(\"test\", testObj, [testObj.buffer]);\n      };\n\n      sendTest();\n      return;\n    } catch {\n      info(\"The worker has been disabled.\");\n    }\n\n    this._setupFakeWorker();\n  }\n\n  _setupFakeWorker() {\n    if (!PDFWorker.#isWorkerDisabled) {\n      warn(\"Setting up fake worker.\");\n      PDFWorker.#isWorkerDisabled = true;\n    }\n\n    PDFWorker._setupFakeWorkerGlobal.then(WorkerMessageHandler => {\n      if (this.destroyed) {\n        this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n\n        return;\n      }\n\n      const port = new LoopbackPort();\n      this._port = port;\n      const id = `fake${PDFWorker.#fakeWorkerId++}`;\n      const workerHandler = new MessageHandler(id + \"_worker\", id, port);\n      WorkerMessageHandler.setup(workerHandler, port);\n      this._messageHandler = new MessageHandler(id, id + \"_worker\", port);\n      this.#resolve();\n    }).catch(reason => {\n      this._readyCapability.reject(new Error(`Setting up fake worker failed: \"${reason.message}\".`));\n    });\n  }\n\n  destroy() {\n    this.destroyed = true;\n\n    if (this._webWorker) {\n      this._webWorker.terminate();\n\n      this._webWorker = null;\n    }\n\n    PDFWorker.#workerPorts?.delete(this._port);\n    this._port = null;\n\n    if (this._messageHandler) {\n      this._messageHandler.destroy();\n\n      this._messageHandler = null;\n    }\n  }\n\n  static fromPort(params) {\n    if (!params?.port) {\n      throw new Error(\"PDFWorker.fromPort - invalid method signature.\");\n    }\n\n    const cachedPort = this.#workerPorts?.get(params.port);\n\n    if (cachedPort) {\n      if (cachedPort._pendingDestroy) {\n        throw new Error(\"PDFWorker.fromPort - the worker is being destroyed.\\n\" + \"Please remember to await `PDFDocumentLoadingTask.destroy()`-calls.\");\n      }\n\n      return cachedPort;\n    }\n\n    return new PDFWorker(params);\n  }\n\n  static get workerSrc() {\n    if (GlobalWorkerOptions.workerSrc) {\n      return GlobalWorkerOptions.workerSrc;\n    }\n\n    throw new Error('No \"GlobalWorkerOptions.workerSrc\" specified.');\n  }\n\n  static get #mainThreadWorkerMessageHandler() {\n    try {\n      return globalThis.pdfjsWorker?.WorkerMessageHandler || null;\n    } catch {\n      return null;\n    }\n  }\n\n  static get _setupFakeWorkerGlobal() {\n    var _this27 = this;\n\n    const loader = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator(function* () {\n        if (_this27.#mainThreadWorkerMessageHandler) {\n          return _this27.#mainThreadWorkerMessageHandler;\n        }\n\n        const worker = yield import(\n        /*webpackIgnore: true*/\n        _this27.workerSrc);\n        return worker.WorkerMessageHandler;\n      });\n\n      return function loader() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    return shadow(this, \"_setupFakeWorkerGlobal\", loader());\n  }\n\n}\n\nclass WorkerTransport {\n  #methodPromises = new Map();\n  #pageCache = new Map();\n  #pagePromises = new Map();\n  #pageRefCache = new Map();\n  #passwordCapability = null;\n\n  constructor(messageHandler, loadingTask, networkStream, params, factory) {\n    this.messageHandler = messageHandler;\n    this.loadingTask = loadingTask;\n    this.commonObjs = new PDFObjects();\n    this.fontLoader = new FontLoader({\n      ownerDocument: params.ownerDocument,\n      styleElement: params.styleElement\n    });\n    this.loadingParams = params.loadingParams;\n    this._params = params;\n    this.canvasFactory = factory.canvasFactory;\n    this.filterFactory = factory.filterFactory;\n    this.cMapReaderFactory = factory.cMapReaderFactory;\n    this.standardFontDataFactory = factory.standardFontDataFactory;\n    this.destroyed = false;\n    this.destroyCapability = null;\n    this._networkStream = networkStream;\n    this._fullReader = null;\n    this._lastProgress = null;\n    this.downloadInfoCapability = Promise.withResolvers();\n    this.setupMessageHandler();\n  }\n\n  #cacheSimpleMethod(name, data = null) {\n    const cachedPromise = this.#methodPromises.get(name);\n\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n\n    const promise = this.messageHandler.sendWithPromise(name, data);\n    this.#methodPromises.set(name, promise);\n    return promise;\n  }\n\n  get annotationStorage() {\n    return shadow(this, \"annotationStorage\", new AnnotationStorage());\n  }\n\n  getRenderingIntent(intent, annotationMode = AnnotationMode.ENABLE, printAnnotationStorage = null, isEditing = false, isOpList = false) {\n    let renderingIntent = RenderingIntentFlag.DISPLAY;\n    let annotationStorageSerializable = SerializableEmpty;\n\n    switch (intent) {\n      case \"any\":\n        renderingIntent = RenderingIntentFlag.ANY;\n        break;\n\n      case \"display\":\n        break;\n\n      case \"print\":\n        renderingIntent = RenderingIntentFlag.PRINT;\n        break;\n\n      default:\n        warn(`getRenderingIntent - invalid intent: ${intent}`);\n    }\n\n    const annotationStorage = renderingIntent & RenderingIntentFlag.PRINT && printAnnotationStorage instanceof PrintAnnotationStorage ? printAnnotationStorage : this.annotationStorage;\n\n    switch (annotationMode) {\n      case AnnotationMode.DISABLE:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_DISABLE;\n        break;\n\n      case AnnotationMode.ENABLE:\n        break;\n\n      case AnnotationMode.ENABLE_FORMS:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_FORMS;\n        break;\n\n      case AnnotationMode.ENABLE_STORAGE:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_STORAGE;\n        annotationStorageSerializable = annotationStorage.serializable;\n        break;\n\n      default:\n        warn(`getRenderingIntent - invalid annotationMode: ${annotationMode}`);\n    }\n\n    if (isEditing) {\n      renderingIntent += RenderingIntentFlag.IS_EDITING;\n    }\n\n    if (isOpList) {\n      renderingIntent += RenderingIntentFlag.OPLIST;\n    }\n\n    const {\n      ids: modifiedIds,\n      hash: modifiedIdsHash\n    } = annotationStorage.modifiedIds;\n    const cacheKeyBuf = [renderingIntent, annotationStorageSerializable.hash, modifiedIdsHash];\n    return {\n      renderingIntent,\n      cacheKey: cacheKeyBuf.join(\"_\"),\n      annotationStorageSerializable,\n      modifiedIds\n    };\n  }\n\n  destroy() {\n    if (this.destroyCapability) {\n      return this.destroyCapability.promise;\n    }\n\n    this.destroyed = true;\n    this.destroyCapability = Promise.withResolvers();\n    this.#passwordCapability?.reject(new Error(\"Worker was destroyed during onPassword callback\"));\n    const waitOn = [];\n\n    for (const page of this.#pageCache.values()) {\n      waitOn.push(page._destroy());\n    }\n\n    this.#pageCache.clear();\n    this.#pagePromises.clear();\n    this.#pageRefCache.clear();\n\n    if (this.hasOwnProperty(\"annotationStorage\")) {\n      this.annotationStorage.resetModified();\n    }\n\n    const terminated = this.messageHandler.sendWithPromise(\"Terminate\", null);\n    waitOn.push(terminated);\n    Promise.all(waitOn).then(() => {\n      this.commonObjs.clear();\n      this.fontLoader.clear();\n      this.#methodPromises.clear();\n      this.filterFactory.destroy();\n      TextLayer.cleanup();\n      this._networkStream?.cancelAllRequests(new AbortException(\"Worker was terminated.\"));\n\n      if (this.messageHandler) {\n        this.messageHandler.destroy();\n        this.messageHandler = null;\n      }\n\n      this.destroyCapability.resolve();\n    }, this.destroyCapability.reject);\n    return this.destroyCapability.promise;\n  }\n\n  setupMessageHandler() {\n    const {\n      messageHandler,\n      loadingTask\n    } = this;\n    messageHandler.on(\"GetReader\", (data, sink) => {\n      assert(this._networkStream, \"GetReader - no `IPDFStream` instance available.\");\n      this._fullReader = this._networkStream.getFullReader();\n\n      this._fullReader.onProgress = evt => {\n        this._lastProgress = {\n          loaded: evt.loaded,\n          total: evt.total\n        };\n      };\n\n      sink.onPull = () => {\n        this._fullReader.read().then(function ({\n          value,\n          done\n        }) {\n          if (done) {\n            sink.close();\n            return;\n          }\n\n          assert(value instanceof ArrayBuffer, \"GetReader - expected an ArrayBuffer.\");\n          sink.enqueue(new Uint8Array(value), 1, [value]);\n        }).catch(reason => {\n          sink.error(reason);\n        });\n      };\n\n      sink.onCancel = reason => {\n        this._fullReader.cancel(reason);\n\n        sink.ready.catch(readyReason => {\n          if (this.destroyed) {\n            return;\n          }\n\n          throw readyReason;\n        });\n      };\n    });\n    messageHandler.on(\"ReaderHeadersReady\", data => {\n      const headersCapability = Promise.withResolvers();\n      const fullReader = this._fullReader;\n      fullReader.headersReady.then(() => {\n        if (!fullReader.isStreamingSupported || !fullReader.isRangeSupported) {\n          if (this._lastProgress) {\n            loadingTask.onProgress?.(this._lastProgress);\n          }\n\n          fullReader.onProgress = evt => {\n            loadingTask.onProgress?.({\n              loaded: evt.loaded,\n              total: evt.total\n            });\n          };\n        }\n\n        headersCapability.resolve({\n          isStreamingSupported: fullReader.isStreamingSupported,\n          isRangeSupported: fullReader.isRangeSupported,\n          contentLength: fullReader.contentLength\n        });\n      }, headersCapability.reject);\n      return headersCapability.promise;\n    });\n    messageHandler.on(\"GetRangeReader\", (data, sink) => {\n      assert(this._networkStream, \"GetRangeReader - no `IPDFStream` instance available.\");\n\n      const rangeReader = this._networkStream.getRangeReader(data.begin, data.end);\n\n      if (!rangeReader) {\n        sink.close();\n        return;\n      }\n\n      sink.onPull = () => {\n        rangeReader.read().then(function ({\n          value,\n          done\n        }) {\n          if (done) {\n            sink.close();\n            return;\n          }\n\n          assert(value instanceof ArrayBuffer, \"GetRangeReader - expected an ArrayBuffer.\");\n          sink.enqueue(new Uint8Array(value), 1, [value]);\n        }).catch(reason => {\n          sink.error(reason);\n        });\n      };\n\n      sink.onCancel = reason => {\n        rangeReader.cancel(reason);\n        sink.ready.catch(readyReason => {\n          if (this.destroyed) {\n            return;\n          }\n\n          throw readyReason;\n        });\n      };\n    });\n    messageHandler.on(\"GetDoc\", ({\n      pdfInfo\n    }) => {\n      this._numPages = pdfInfo.numPages;\n      this._htmlForXfa = pdfInfo.htmlForXfa;\n      delete pdfInfo.htmlForXfa;\n\n      loadingTask._capability.resolve(new PDFDocumentProxy(pdfInfo, this));\n    });\n    messageHandler.on(\"DocException\", function (ex) {\n      let reason;\n\n      switch (ex.name) {\n        case \"PasswordException\":\n          reason = new PasswordException(ex.message, ex.code);\n          break;\n\n        case \"InvalidPDFException\":\n          reason = new InvalidPDFException(ex.message);\n          break;\n\n        case \"MissingPDFException\":\n          reason = new MissingPDFException(ex.message);\n          break;\n\n        case \"UnexpectedResponseException\":\n          reason = new UnexpectedResponseException(ex.message, ex.status);\n          break;\n\n        case \"UnknownErrorException\":\n          reason = new UnknownErrorException(ex.message, ex.details);\n          break;\n\n        default:\n          unreachable(\"DocException - expected a valid Error.\");\n      }\n\n      loadingTask._capability.reject(reason);\n    });\n    messageHandler.on(\"PasswordRequest\", exception => {\n      this.#passwordCapability = Promise.withResolvers();\n\n      if (loadingTask.onPassword) {\n        const updatePassword = password => {\n          if (password instanceof Error) {\n            this.#passwordCapability.reject(password);\n          } else {\n            this.#passwordCapability.resolve({\n              password\n            });\n          }\n        };\n\n        try {\n          loadingTask.onPassword(updatePassword, exception.code);\n        } catch (ex) {\n          this.#passwordCapability.reject(ex);\n        }\n      } else {\n        this.#passwordCapability.reject(new PasswordException(exception.message, exception.code));\n      }\n\n      return this.#passwordCapability.promise;\n    });\n    messageHandler.on(\"DataLoaded\", data => {\n      loadingTask.onProgress?.({\n        loaded: data.length,\n        total: data.length\n      });\n      this.downloadInfoCapability.resolve(data);\n    });\n    messageHandler.on(\"StartRenderPage\", data => {\n      if (this.destroyed) {\n        return;\n      }\n\n      const page = this.#pageCache.get(data.pageIndex);\n\n      page._startRenderPage(data.transparency, data.cacheKey);\n    });\n    messageHandler.on(\"commonobj\", ([id, type, exportedData]) => {\n      if (this.destroyed) {\n        return null;\n      }\n\n      if (this.commonObjs.has(id)) {\n        return null;\n      }\n\n      switch (type) {\n        case \"Font\":\n          const {\n            disableFontFace,\n            fontExtraProperties,\n            pdfBug\n          } = this._params;\n\n          if (\"error\" in exportedData) {\n            const exportedError = exportedData.error;\n            warn(`Error during font loading: ${exportedError}`);\n            this.commonObjs.resolve(id, exportedError);\n            break;\n          }\n\n          const inspectFont = pdfBug && globalThis.FontInspector?.enabled ? (font, url) => globalThis.FontInspector.fontAdded(font, url) : null;\n          const font = new FontFaceObject(exportedData, {\n            disableFontFace,\n            inspectFont\n          });\n          this.fontLoader.bind(font).catch(() => messageHandler.sendWithPromise(\"FontFallback\", {\n            id\n          })).finally(() => {\n            if (!fontExtraProperties && font.data) {\n              font.data = null;\n            }\n\n            this.commonObjs.resolve(id, font);\n          });\n          break;\n\n        case \"CopyLocalImage\":\n          const {\n            imageRef\n          } = exportedData;\n          assert(imageRef, \"The imageRef must be defined.\");\n\n          for (const pageProxy of this.#pageCache.values()) {\n            for (const [, data] of pageProxy.objs) {\n              if (data?.ref !== imageRef) {\n                continue;\n              }\n\n              if (!data.dataLen) {\n                return null;\n              }\n\n              this.commonObjs.resolve(id, structuredClone(data));\n              return data.dataLen;\n            }\n          }\n\n          break;\n\n        case \"FontPath\":\n        case \"Image\":\n        case \"Pattern\":\n          this.commonObjs.resolve(id, exportedData);\n          break;\n\n        default:\n          throw new Error(`Got unknown common object type ${type}`);\n      }\n\n      return null;\n    });\n    messageHandler.on(\"obj\", ([id, pageIndex, type, imageData]) => {\n      if (this.destroyed) {\n        return;\n      }\n\n      const pageProxy = this.#pageCache.get(pageIndex);\n\n      if (pageProxy.objs.has(id)) {\n        return;\n      }\n\n      if (pageProxy._intentStates.size === 0) {\n        imageData?.bitmap?.close();\n        return;\n      }\n\n      switch (type) {\n        case \"Image\":\n          pageProxy.objs.resolve(id, imageData);\n\n          if (imageData?.dataLen > MAX_IMAGE_SIZE_TO_CACHE) {\n            pageProxy._maybeCleanupAfterRender = true;\n          }\n\n          break;\n\n        case \"Pattern\":\n          pageProxy.objs.resolve(id, imageData);\n          break;\n\n        default:\n          throw new Error(`Got unknown object type ${type}`);\n      }\n    });\n    messageHandler.on(\"DocProgress\", data => {\n      if (this.destroyed) {\n        return;\n      }\n\n      loadingTask.onProgress?.({\n        loaded: data.loaded,\n        total: data.total\n      });\n    });\n    messageHandler.on(\"FetchBuiltInCMap\", data => {\n      if (this.destroyed) {\n        return Promise.reject(new Error(\"Worker was destroyed.\"));\n      }\n\n      if (!this.cMapReaderFactory) {\n        return Promise.reject(new Error(\"CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.\"));\n      }\n\n      return this.cMapReaderFactory.fetch(data);\n    });\n    messageHandler.on(\"FetchStandardFontData\", data => {\n      if (this.destroyed) {\n        return Promise.reject(new Error(\"Worker was destroyed.\"));\n      }\n\n      if (!this.standardFontDataFactory) {\n        return Promise.reject(new Error(\"StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.\"));\n      }\n\n      return this.standardFontDataFactory.fetch(data);\n    });\n  }\n\n  getData() {\n    return this.messageHandler.sendWithPromise(\"GetData\", null);\n  }\n\n  saveDocument() {\n    if (this.annotationStorage.size <= 0) {\n      warn(\"saveDocument called while `annotationStorage` is empty, \" + \"please use the getData-method instead.\");\n    }\n\n    const {\n      map,\n      transfer\n    } = this.annotationStorage.serializable;\n    return this.messageHandler.sendWithPromise(\"SaveDocument\", {\n      isPureXfa: !!this._htmlForXfa,\n      numPages: this._numPages,\n      annotationStorage: map,\n      filename: this._fullReader?.filename ?? null\n    }, transfer).finally(() => {\n      this.annotationStorage.resetModified();\n    });\n  }\n\n  getPage(pageNumber) {\n    if (!Number.isInteger(pageNumber) || pageNumber <= 0 || pageNumber > this._numPages) {\n      return Promise.reject(new Error(\"Invalid page request.\"));\n    }\n\n    const pageIndex = pageNumber - 1,\n          cachedPromise = this.#pagePromises.get(pageIndex);\n\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n\n    const promise = this.messageHandler.sendWithPromise(\"GetPage\", {\n      pageIndex\n    }).then(pageInfo => {\n      if (this.destroyed) {\n        throw new Error(\"Transport destroyed\");\n      }\n\n      if (pageInfo.refStr) {\n        this.#pageRefCache.set(pageInfo.refStr, pageNumber);\n      }\n\n      const page = new PDFPageProxy(pageIndex, pageInfo, this, this._params.pdfBug);\n      this.#pageCache.set(pageIndex, page);\n      return page;\n    });\n    this.#pagePromises.set(pageIndex, promise);\n    return promise;\n  }\n\n  getPageIndex(ref) {\n    if (!isRefProxy(ref)) {\n      return Promise.reject(new Error(\"Invalid pageIndex request.\"));\n    }\n\n    return this.messageHandler.sendWithPromise(\"GetPageIndex\", {\n      num: ref.num,\n      gen: ref.gen\n    });\n  }\n\n  getAnnotations(pageIndex, intent) {\n    return this.messageHandler.sendWithPromise(\"GetAnnotations\", {\n      pageIndex,\n      intent\n    });\n  }\n\n  getFieldObjects() {\n    return this.#cacheSimpleMethod(\"GetFieldObjects\");\n  }\n\n  hasJSActions() {\n    return this.#cacheSimpleMethod(\"HasJSActions\");\n  }\n\n  getCalculationOrderIds() {\n    return this.messageHandler.sendWithPromise(\"GetCalculationOrderIds\", null);\n  }\n\n  getDestinations() {\n    return this.messageHandler.sendWithPromise(\"GetDestinations\", null);\n  }\n\n  getDestination(id) {\n    if (typeof id !== \"string\") {\n      return Promise.reject(new Error(\"Invalid destination request.\"));\n    }\n\n    return this.messageHandler.sendWithPromise(\"GetDestination\", {\n      id\n    });\n  }\n\n  getPageLabels() {\n    return this.messageHandler.sendWithPromise(\"GetPageLabels\", null);\n  }\n\n  getPageLayout() {\n    return this.messageHandler.sendWithPromise(\"GetPageLayout\", null);\n  }\n\n  getPageMode() {\n    return this.messageHandler.sendWithPromise(\"GetPageMode\", null);\n  }\n\n  getViewerPreferences() {\n    return this.messageHandler.sendWithPromise(\"GetViewerPreferences\", null);\n  }\n\n  getOpenAction() {\n    return this.messageHandler.sendWithPromise(\"GetOpenAction\", null);\n  }\n\n  getAttachments() {\n    return this.messageHandler.sendWithPromise(\"GetAttachments\", null);\n  }\n\n  getDocJSActions() {\n    return this.#cacheSimpleMethod(\"GetDocJSActions\");\n  }\n\n  getPageJSActions(pageIndex) {\n    return this.messageHandler.sendWithPromise(\"GetPageJSActions\", {\n      pageIndex\n    });\n  }\n\n  getStructTree(pageIndex) {\n    return this.messageHandler.sendWithPromise(\"GetStructTree\", {\n      pageIndex\n    });\n  }\n\n  getOutline() {\n    return this.messageHandler.sendWithPromise(\"GetOutline\", null);\n  }\n\n  getOptionalContentConfig(renderingIntent) {\n    return this.#cacheSimpleMethod(\"GetOptionalContentConfig\").then(data => new OptionalContentConfig(data, renderingIntent));\n  }\n\n  getPermissions() {\n    return this.messageHandler.sendWithPromise(\"GetPermissions\", null);\n  }\n\n  getMetadata() {\n    const name = \"GetMetadata\",\n          cachedPromise = this.#methodPromises.get(name);\n\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n\n    const promise = this.messageHandler.sendWithPromise(name, null).then(results => ({\n      info: results[0],\n      metadata: results[1] ? new Metadata(results[1]) : null,\n      contentDispositionFilename: this._fullReader?.filename ?? null,\n      contentLength: this._fullReader?.contentLength ?? null\n    }));\n    this.#methodPromises.set(name, promise);\n    return promise;\n  }\n\n  getMarkInfo() {\n    return this.messageHandler.sendWithPromise(\"GetMarkInfo\", null);\n  }\n\n  startCleanup(keepLoadedFonts = false) {\n    var _this28 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this28.destroyed) {\n        return;\n      }\n\n      yield _this28.messageHandler.sendWithPromise(\"Cleanup\", null);\n\n      for (const page of _this28.#pageCache.values()) {\n        const cleanupSuccessful = page.cleanup();\n\n        if (!cleanupSuccessful) {\n          throw new Error(`startCleanup: Page ${page.pageNumber} is currently rendering.`);\n        }\n      }\n\n      _this28.commonObjs.clear();\n\n      if (!keepLoadedFonts) {\n        _this28.fontLoader.clear();\n      }\n\n      _this28.#methodPromises.clear();\n\n      _this28.filterFactory.destroy(true);\n\n      TextLayer.cleanup();\n    })();\n  }\n\n  cachedPageNumber(ref) {\n    if (!isRefProxy(ref)) {\n      return null;\n    }\n\n    const refStr = ref.gen === 0 ? `${ref.num}R` : `${ref.num}R${ref.gen}`;\n    return this.#pageRefCache.get(refStr) ?? null;\n  }\n\n}\n\nconst INITIAL_DATA = Symbol(\"INITIAL_DATA\");\n\nclass PDFObjects {\n  #objs = Object.create(null);\n\n  #ensureObj(objId) {\n    return this.#objs[objId] ||= { ...Promise.withResolvers(),\n      data: INITIAL_DATA\n    };\n  }\n\n  get(objId, callback = null) {\n    if (callback) {\n      const obj = this.#ensureObj(objId);\n      obj.promise.then(() => callback(obj.data));\n      return null;\n    }\n\n    const obj = this.#objs[objId];\n\n    if (!obj || obj.data === INITIAL_DATA) {\n      throw new Error(`Requesting object that isn't resolved yet ${objId}.`);\n    }\n\n    return obj.data;\n  }\n\n  has(objId) {\n    const obj = this.#objs[objId];\n    return !!obj && obj.data !== INITIAL_DATA;\n  }\n\n  resolve(objId, data = null) {\n    const obj = this.#ensureObj(objId);\n    obj.data = data;\n    obj.resolve();\n  }\n\n  clear() {\n    for (const objId in this.#objs) {\n      const {\n        data\n      } = this.#objs[objId];\n      data?.bitmap?.close();\n    }\n\n    this.#objs = Object.create(null);\n  }\n\n  *[Symbol.iterator]() {\n    for (const objId in this.#objs) {\n      const {\n        data\n      } = this.#objs[objId];\n\n      if (data === INITIAL_DATA) {\n        continue;\n      }\n\n      yield [objId, data];\n    }\n  }\n\n}\n\nclass RenderTask {\n  #internalRenderTask = null;\n\n  constructor(internalRenderTask) {\n    this.#internalRenderTask = internalRenderTask;\n    this.onContinue = null;\n  }\n\n  get promise() {\n    return this.#internalRenderTask.capability.promise;\n  }\n\n  cancel(extraDelay = 0) {\n    this.#internalRenderTask.cancel(null, extraDelay);\n  }\n\n  get separateAnnots() {\n    const {\n      separateAnnots\n    } = this.#internalRenderTask.operatorList;\n\n    if (!separateAnnots) {\n      return false;\n    }\n\n    const {\n      annotationCanvasMap\n    } = this.#internalRenderTask;\n    return separateAnnots.form || separateAnnots.canvas && annotationCanvasMap?.size > 0;\n  }\n\n}\n\nclass InternalRenderTask {\n  #rAF = null;\n  static #canvasInUse = new WeakSet();\n\n  constructor({\n    callback,\n    params,\n    objs,\n    commonObjs,\n    annotationCanvasMap,\n    operatorList,\n    pageIndex,\n    canvasFactory,\n    filterFactory,\n    useRequestAnimationFrame = false,\n    pdfBug = false,\n    pageColors = null\n  }) {\n    this.callback = callback;\n    this.params = params;\n    this.objs = objs;\n    this.commonObjs = commonObjs;\n    this.annotationCanvasMap = annotationCanvasMap;\n    this.operatorListIdx = null;\n    this.operatorList = operatorList;\n    this._pageIndex = pageIndex;\n    this.canvasFactory = canvasFactory;\n    this.filterFactory = filterFactory;\n    this._pdfBug = pdfBug;\n    this.pageColors = pageColors;\n    this.running = false;\n    this.graphicsReadyCallback = null;\n    this.graphicsReady = false;\n    this._useRequestAnimationFrame = useRequestAnimationFrame === true && typeof window !== \"undefined\";\n    this.cancelled = false;\n    this.capability = Promise.withResolvers();\n    this.task = new RenderTask(this);\n    this._cancelBound = this.cancel.bind(this);\n    this._continueBound = this._continue.bind(this);\n    this._scheduleNextBound = this._scheduleNext.bind(this);\n    this._nextBound = this._next.bind(this);\n    this._canvas = params.canvasContext.canvas;\n  }\n\n  get completed() {\n    return this.capability.promise.catch(function () {});\n  }\n\n  initializeGraphics({\n    transparency = false,\n    optionalContentConfig\n  }) {\n    if (this.cancelled) {\n      return;\n    }\n\n    if (this._canvas) {\n      if (InternalRenderTask.#canvasInUse.has(this._canvas)) {\n        throw new Error(\"Cannot use the same canvas during multiple render() operations. \" + \"Use different canvas or ensure previous operations were \" + \"cancelled or completed.\");\n      }\n\n      InternalRenderTask.#canvasInUse.add(this._canvas);\n    }\n\n    if (this._pdfBug && globalThis.StepperManager?.enabled) {\n      this.stepper = globalThis.StepperManager.create(this._pageIndex);\n      this.stepper.init(this.operatorList);\n      this.stepper.nextBreakPoint = this.stepper.getNextBreakPoint();\n    }\n\n    const {\n      canvasContext,\n      viewport,\n      transform,\n      background\n    } = this.params;\n    this.gfx = new CanvasGraphics(canvasContext, this.commonObjs, this.objs, this.canvasFactory, this.filterFactory, {\n      optionalContentConfig\n    }, this.annotationCanvasMap, this.pageColors);\n    this.gfx.beginDrawing({\n      transform,\n      viewport,\n      transparency,\n      background\n    });\n    this.operatorListIdx = 0;\n    this.graphicsReady = true;\n    this.graphicsReadyCallback?.();\n  }\n\n  cancel(error = null, extraDelay = 0) {\n    this.running = false;\n    this.cancelled = true;\n    this.gfx?.endDrawing();\n\n    if (this.#rAF) {\n      window.cancelAnimationFrame(this.#rAF);\n      this.#rAF = null;\n    }\n\n    InternalRenderTask.#canvasInUse.delete(this._canvas);\n    this.callback(error || new RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex + 1}`, extraDelay));\n  }\n\n  operatorListChanged() {\n    if (!this.graphicsReady) {\n      this.graphicsReadyCallback ||= this._continueBound;\n      return;\n    }\n\n    this.stepper?.updateOperatorList(this.operatorList);\n\n    if (this.running) {\n      return;\n    }\n\n    this._continue();\n  }\n\n  _continue() {\n    this.running = true;\n\n    if (this.cancelled) {\n      return;\n    }\n\n    if (this.task.onContinue) {\n      this.task.onContinue(this._scheduleNextBound);\n    } else {\n      this._scheduleNext();\n    }\n  }\n\n  _scheduleNext() {\n    if (this._useRequestAnimationFrame) {\n      this.#rAF = window.requestAnimationFrame(() => {\n        this.#rAF = null;\n\n        this._nextBound().catch(this._cancelBound);\n      });\n    } else {\n      Promise.resolve().then(this._nextBound).catch(this._cancelBound);\n    }\n  }\n\n  _next() {\n    var _this29 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this29.cancelled) {\n        return;\n      }\n\n      _this29.operatorListIdx = _this29.gfx.executeOperatorList(_this29.operatorList, _this29.operatorListIdx, _this29._continueBound, _this29.stepper);\n\n      if (_this29.operatorListIdx === _this29.operatorList.argsArray.length) {\n        _this29.running = false;\n\n        if (_this29.operatorList.lastChunk) {\n          _this29.gfx.endDrawing();\n\n          InternalRenderTask.#canvasInUse.delete(_this29._canvas);\n\n          _this29.callback();\n        }\n      }\n    })();\n  }\n\n}\n\nconst version = \"4.6.82\";\nconst build = \"9b541910f\";\n; // CONCATENATED MODULE: ./src/shared/scripting_utils.js\n\nfunction makeColorComp(n) {\n  return Math.floor(Math.max(0, Math.min(1, n)) * 255).toString(16).padStart(2, \"0\");\n}\n\nfunction scaleAndClamp(x) {\n  return Math.max(0, Math.min(255, 255 * x));\n}\n\nclass ColorConverters {\n  static CMYK_G([c, y, m, k]) {\n    return [\"G\", 1 - Math.min(1, 0.3 * c + 0.59 * m + 0.11 * y + k)];\n  }\n\n  static G_CMYK([g]) {\n    return [\"CMYK\", 0, 0, 0, 1 - g];\n  }\n\n  static G_RGB([g]) {\n    return [\"RGB\", g, g, g];\n  }\n\n  static G_rgb([g]) {\n    g = scaleAndClamp(g);\n    return [g, g, g];\n  }\n\n  static G_HTML([g]) {\n    const G = makeColorComp(g);\n    return `#${G}${G}${G}`;\n  }\n\n  static RGB_G([r, g, b]) {\n    return [\"G\", 0.3 * r + 0.59 * g + 0.11 * b];\n  }\n\n  static RGB_rgb(color) {\n    return color.map(scaleAndClamp);\n  }\n\n  static RGB_HTML(color) {\n    return `#${color.map(makeColorComp).join(\"\")}`;\n  }\n\n  static T_HTML() {\n    return \"#00000000\";\n  }\n\n  static T_rgb() {\n    return [null];\n  }\n\n  static CMYK_RGB([c, y, m, k]) {\n    return [\"RGB\", 1 - Math.min(1, c + k), 1 - Math.min(1, m + k), 1 - Math.min(1, y + k)];\n  }\n\n  static CMYK_rgb([c, y, m, k]) {\n    return [scaleAndClamp(1 - Math.min(1, c + k)), scaleAndClamp(1 - Math.min(1, m + k)), scaleAndClamp(1 - Math.min(1, y + k))];\n  }\n\n  static CMYK_HTML(components) {\n    const rgb = this.CMYK_RGB(components).slice(1);\n    return this.RGB_HTML(rgb);\n  }\n\n  static RGB_CMYK([r, g, b]) {\n    const c = 1 - r;\n    const m = 1 - g;\n    const y = 1 - b;\n    const k = Math.min(c, m, y);\n    return [\"CMYK\", c, m, y, k];\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/xfa_layer.js\n\nclass XfaLayer {\n  static setupStorage(html, id, element, storage, intent) {\n    const storedData = storage.getValue(id, {\n      value: null\n    });\n\n    switch (element.name) {\n      case \"textarea\":\n        if (storedData.value !== null) {\n          html.textContent = storedData.value;\n        }\n\n        if (intent === \"print\") {\n          break;\n        }\n\n        html.addEventListener(\"input\", event => {\n          storage.setValue(id, {\n            value: event.target.value\n          });\n        });\n        break;\n\n      case \"input\":\n        if (element.attributes.type === \"radio\" || element.attributes.type === \"checkbox\") {\n          if (storedData.value === element.attributes.xfaOn) {\n            html.setAttribute(\"checked\", true);\n          } else if (storedData.value === element.attributes.xfaOff) {\n            html.removeAttribute(\"checked\");\n          }\n\n          if (intent === \"print\") {\n            break;\n          }\n\n          html.addEventListener(\"change\", event => {\n            storage.setValue(id, {\n              value: event.target.checked ? event.target.getAttribute(\"xfaOn\") : event.target.getAttribute(\"xfaOff\")\n            });\n          });\n        } else {\n          if (storedData.value !== null) {\n            html.setAttribute(\"value\", storedData.value);\n          }\n\n          if (intent === \"print\") {\n            break;\n          }\n\n          html.addEventListener(\"input\", event => {\n            storage.setValue(id, {\n              value: event.target.value\n            });\n          });\n        }\n\n        break;\n\n      case \"select\":\n        if (storedData.value !== null) {\n          html.setAttribute(\"value\", storedData.value);\n\n          for (const option of element.children) {\n            if (option.attributes.value === storedData.value) {\n              option.attributes.selected = true;\n            } else if (option.attributes.hasOwnProperty(\"selected\")) {\n              delete option.attributes.selected;\n            }\n          }\n        }\n\n        html.addEventListener(\"input\", event => {\n          const options = event.target.options;\n          const value = options.selectedIndex === -1 ? \"\" : options[options.selectedIndex].value;\n          storage.setValue(id, {\n            value\n          });\n        });\n        break;\n    }\n  }\n\n  static setAttributes({\n    html,\n    element,\n    storage = null,\n    intent,\n    linkService\n  }) {\n    const {\n      attributes\n    } = element;\n    const isHTMLAnchorElement = html instanceof HTMLAnchorElement;\n\n    if (attributes.type === \"radio\") {\n      attributes.name = `${attributes.name}-${intent}`;\n    }\n\n    for (const [key, value] of Object.entries(attributes)) {\n      if (value === null || value === undefined) {\n        continue;\n      }\n\n      switch (key) {\n        case \"class\":\n          if (value.length) {\n            html.setAttribute(key, value.join(\" \"));\n          }\n\n          break;\n\n        case \"dataId\":\n          break;\n\n        case \"id\":\n          html.setAttribute(\"data-element-id\", value);\n          break;\n\n        case \"style\":\n          Object.assign(html.style, value);\n          break;\n\n        case \"textContent\":\n          html.textContent = value;\n          break;\n\n        default:\n          if (!isHTMLAnchorElement || key !== \"href\" && key !== \"newWindow\") {\n            html.setAttribute(key, value);\n          }\n\n      }\n    }\n\n    if (isHTMLAnchorElement) {\n      linkService.addLinkAttributes(html, attributes.href, attributes.newWindow);\n    }\n\n    if (storage && attributes.dataId) {\n      this.setupStorage(html, attributes.dataId, element, storage);\n    }\n  }\n\n  static render(parameters) {\n    const storage = parameters.annotationStorage;\n    const linkService = parameters.linkService;\n    const root = parameters.xfaHtml;\n    const intent = parameters.intent || \"display\";\n    const rootHtml = document.createElement(root.name);\n\n    if (root.attributes) {\n      this.setAttributes({\n        html: rootHtml,\n        element: root,\n        intent,\n        linkService\n      });\n    }\n\n    const isNotForRichText = intent !== \"richText\";\n    const rootDiv = parameters.div;\n    rootDiv.append(rootHtml);\n\n    if (parameters.viewport) {\n      const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n      rootDiv.style.transform = transform;\n    }\n\n    if (isNotForRichText) {\n      rootDiv.setAttribute(\"class\", \"xfaLayer xfaFont\");\n    }\n\n    const textDivs = [];\n\n    if (root.children.length === 0) {\n      if (root.value) {\n        const node = document.createTextNode(root.value);\n        rootHtml.append(node);\n\n        if (isNotForRichText && XfaText.shouldBuildText(root.name)) {\n          textDivs.push(node);\n        }\n      }\n\n      return {\n        textDivs\n      };\n    }\n\n    const stack = [[root, -1, rootHtml]];\n\n    while (stack.length > 0) {\n      const [parent, i, html] = stack.at(-1);\n\n      if (i + 1 === parent.children.length) {\n        stack.pop();\n        continue;\n      }\n\n      const child = parent.children[++stack.at(-1)[1]];\n\n      if (child === null) {\n        continue;\n      }\n\n      const {\n        name\n      } = child;\n\n      if (name === \"#text\") {\n        const node = document.createTextNode(child.value);\n        textDivs.push(node);\n        html.append(node);\n        continue;\n      }\n\n      const childHtml = child?.attributes?.xmlns ? document.createElementNS(child.attributes.xmlns, name) : document.createElement(name);\n      html.append(childHtml);\n\n      if (child.attributes) {\n        this.setAttributes({\n          html: childHtml,\n          element: child,\n          storage,\n          intent,\n          linkService\n        });\n      }\n\n      if (child.children?.length > 0) {\n        stack.push([child, -1, childHtml]);\n      } else if (child.value) {\n        const node = document.createTextNode(child.value);\n\n        if (isNotForRichText && XfaText.shouldBuildText(name)) {\n          textDivs.push(node);\n        }\n\n        childHtml.append(node);\n      }\n    }\n\n    for (const el of rootDiv.querySelectorAll(\".xfaNonInteractive input, .xfaNonInteractive textarea\")) {\n      el.setAttribute(\"readOnly\", true);\n    }\n\n    return {\n      textDivs\n    };\n  }\n\n  static update(parameters) {\n    const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n    parameters.div.style.transform = transform;\n    parameters.div.hidden = false;\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/annotation_layer.js\n\nconst DEFAULT_TAB_INDEX = 1000;\nconst annotation_layer_DEFAULT_FONT_SIZE = 9;\nconst GetElementsByNameSet = new WeakSet();\n\nfunction getRectDims(rect) {\n  return {\n    width: rect[2] - rect[0],\n    height: rect[3] - rect[1]\n  };\n}\n\nclass AnnotationElementFactory {\n  static create(parameters) {\n    const subtype = parameters.data.annotationType;\n\n    switch (subtype) {\n      case AnnotationType.LINK:\n        return new LinkAnnotationElement(parameters);\n\n      case AnnotationType.TEXT:\n        return new TextAnnotationElement(parameters);\n\n      case AnnotationType.WIDGET:\n        const fieldType = parameters.data.fieldType;\n\n        switch (fieldType) {\n          case \"Tx\":\n            return new TextWidgetAnnotationElement(parameters);\n\n          case \"Btn\":\n            if (parameters.data.radioButton) {\n              return new RadioButtonWidgetAnnotationElement(parameters);\n            } else if (parameters.data.checkBox) {\n              return new CheckboxWidgetAnnotationElement(parameters);\n            }\n\n            return new PushButtonWidgetAnnotationElement(parameters);\n\n          case \"Ch\":\n            return new ChoiceWidgetAnnotationElement(parameters);\n\n          case \"Sig\":\n            return new SignatureWidgetAnnotationElement(parameters);\n        }\n\n        return new WidgetAnnotationElement(parameters);\n\n      case AnnotationType.POPUP:\n        return new PopupAnnotationElement(parameters);\n\n      case AnnotationType.FREETEXT:\n        return new FreeTextAnnotationElement(parameters);\n\n      case AnnotationType.LINE:\n        return new LineAnnotationElement(parameters);\n\n      case AnnotationType.SQUARE:\n        return new SquareAnnotationElement(parameters);\n\n      case AnnotationType.CIRCLE:\n        return new CircleAnnotationElement(parameters);\n\n      case AnnotationType.POLYLINE:\n        return new PolylineAnnotationElement(parameters);\n\n      case AnnotationType.CARET:\n        return new CaretAnnotationElement(parameters);\n\n      case AnnotationType.INK:\n        return new InkAnnotationElement(parameters);\n\n      case AnnotationType.POLYGON:\n        return new PolygonAnnotationElement(parameters);\n\n      case AnnotationType.HIGHLIGHT:\n        return new HighlightAnnotationElement(parameters);\n\n      case AnnotationType.UNDERLINE:\n        return new UnderlineAnnotationElement(parameters);\n\n      case AnnotationType.SQUIGGLY:\n        return new SquigglyAnnotationElement(parameters);\n\n      case AnnotationType.STRIKEOUT:\n        return new StrikeOutAnnotationElement(parameters);\n\n      case AnnotationType.STAMP:\n        return new StampAnnotationElement(parameters);\n\n      case AnnotationType.FILEATTACHMENT:\n        return new FileAttachmentAnnotationElement(parameters);\n\n      default:\n        return new AnnotationElement(parameters);\n    }\n  }\n\n}\n\nclass AnnotationElement {\n  #updates = null;\n  #hasBorder = false;\n  #popupElement = null;\n\n  constructor(parameters, {\n    isRenderable = false,\n    ignoreBorder = false,\n    createQuadrilaterals = false\n  } = {}) {\n    this.isRenderable = isRenderable;\n    this.data = parameters.data;\n    this.layer = parameters.layer;\n    this.linkService = parameters.linkService;\n    this.downloadManager = parameters.downloadManager;\n    this.imageResourcesPath = parameters.imageResourcesPath;\n    this.renderForms = parameters.renderForms;\n    this.svgFactory = parameters.svgFactory;\n    this.annotationStorage = parameters.annotationStorage;\n    this.enableScripting = parameters.enableScripting;\n    this.hasJSActions = parameters.hasJSActions;\n    this._fieldObjects = parameters.fieldObjects;\n    this.parent = parameters.parent;\n\n    if (isRenderable) {\n      this.container = this._createContainer(ignoreBorder);\n    }\n\n    if (createQuadrilaterals) {\n      this._createQuadrilaterals();\n    }\n  }\n\n  static _hasPopupData({\n    titleObj,\n    contentsObj,\n    richText\n  }) {\n    return !!(titleObj?.str || contentsObj?.str || richText?.str);\n  }\n\n  get _isEditable() {\n    return this.data.isEditable;\n  }\n\n  get hasPopupData() {\n    return AnnotationElement._hasPopupData(this.data);\n  }\n\n  updateEdited(params) {\n    if (!this.container) {\n      return;\n    }\n\n    this.#updates ||= {\n      rect: this.data.rect.slice(0)\n    };\n    const {\n      rect\n    } = params;\n\n    if (rect) {\n      this.#setRectEdited(rect);\n    }\n\n    this.#popupElement?.popup.updateEdited(params);\n  }\n\n  resetEdited() {\n    if (!this.#updates) {\n      return;\n    }\n\n    this.#setRectEdited(this.#updates.rect);\n    this.#popupElement?.popup.resetEdited();\n    this.#updates = null;\n  }\n\n  #setRectEdited(rect) {\n    const {\n      container: {\n        style\n      },\n      data: {\n        rect: currentRect,\n        rotation\n      },\n      parent: {\n        viewport: {\n          rawDims: {\n            pageWidth,\n            pageHeight,\n            pageX,\n            pageY\n          }\n        }\n      }\n    } = this;\n    currentRect?.splice(0, 4, ...rect);\n    const {\n      width,\n      height\n    } = getRectDims(rect);\n    style.left = `${100 * (rect[0] - pageX) / pageWidth}%`;\n    style.top = `${100 * (pageHeight - rect[3] + pageY) / pageHeight}%`;\n\n    if (rotation === 0) {\n      style.width = `${100 * width / pageWidth}%`;\n      style.height = `${100 * height / pageHeight}%`;\n    } else {\n      this.setRotation(rotation);\n    }\n  }\n\n  _createContainer(ignoreBorder) {\n    const {\n      data,\n      parent: {\n        page,\n        viewport\n      }\n    } = this;\n    const container = document.createElement(\"section\");\n    container.setAttribute(\"data-annotation-id\", data.id);\n\n    if (!(this instanceof WidgetAnnotationElement)) {\n      container.tabIndex = DEFAULT_TAB_INDEX;\n    }\n\n    const {\n      style\n    } = container;\n    style.zIndex = this.parent.zIndex++;\n\n    if (data.popupRef) {\n      container.setAttribute(\"aria-haspopup\", \"dialog\");\n    }\n\n    if (data.alternativeText) {\n      container.title = data.alternativeText;\n    }\n\n    if (data.noRotate) {\n      container.classList.add(\"norotate\");\n    }\n\n    if (!data.rect || this instanceof PopupAnnotationElement) {\n      const {\n        rotation\n      } = data;\n\n      if (!data.hasOwnCanvas && rotation !== 0) {\n        this.setRotation(rotation, container);\n      }\n\n      return container;\n    }\n\n    const {\n      width,\n      height\n    } = getRectDims(data.rect);\n\n    if (!ignoreBorder && data.borderStyle.width > 0) {\n      style.borderWidth = `${data.borderStyle.width}px`;\n      const horizontalRadius = data.borderStyle.horizontalCornerRadius;\n      const verticalRadius = data.borderStyle.verticalCornerRadius;\n\n      if (horizontalRadius > 0 || verticalRadius > 0) {\n        const radius = `calc(${horizontalRadius}px * var(--scale-factor)) / calc(${verticalRadius}px * var(--scale-factor))`;\n        style.borderRadius = radius;\n      } else if (this instanceof RadioButtonWidgetAnnotationElement) {\n        const radius = `calc(${width}px * var(--scale-factor)) / calc(${height}px * var(--scale-factor))`;\n        style.borderRadius = radius;\n      }\n\n      switch (data.borderStyle.style) {\n        case AnnotationBorderStyleType.SOLID:\n          style.borderStyle = \"solid\";\n          break;\n\n        case AnnotationBorderStyleType.DASHED:\n          style.borderStyle = \"dashed\";\n          break;\n\n        case AnnotationBorderStyleType.BEVELED:\n          warn(\"Unimplemented border style: beveled\");\n          break;\n\n        case AnnotationBorderStyleType.INSET:\n          warn(\"Unimplemented border style: inset\");\n          break;\n\n        case AnnotationBorderStyleType.UNDERLINE:\n          style.borderBottomStyle = \"solid\";\n          break;\n\n        default:\n          break;\n      }\n\n      const borderColor = data.borderColor || null;\n\n      if (borderColor) {\n        this.#hasBorder = true;\n        style.borderColor = Util.makeHexColor(borderColor[0] | 0, borderColor[1] | 0, borderColor[2] | 0);\n      } else {\n        style.borderWidth = 0;\n      }\n    }\n\n    const rect = Util.normalizeRect([data.rect[0], page.view[3] - data.rect[1] + page.view[1], data.rect[2], page.view[3] - data.rect[3] + page.view[1]]);\n    const {\n      pageWidth,\n      pageHeight,\n      pageX,\n      pageY\n    } = viewport.rawDims;\n    style.left = `${100 * (rect[0] - pageX) / pageWidth}%`;\n    style.top = `${100 * (rect[1] - pageY) / pageHeight}%`;\n    const {\n      rotation\n    } = data;\n\n    if (data.hasOwnCanvas || rotation === 0) {\n      style.width = `${100 * width / pageWidth}%`;\n      style.height = `${100 * height / pageHeight}%`;\n    } else {\n      this.setRotation(rotation, container);\n    }\n\n    return container;\n  }\n\n  setRotation(angle, container = this.container) {\n    if (!this.data.rect) {\n      return;\n    }\n\n    const {\n      pageWidth,\n      pageHeight\n    } = this.parent.viewport.rawDims;\n    const {\n      width,\n      height\n    } = getRectDims(this.data.rect);\n    let elementWidth, elementHeight;\n\n    if (angle % 180 === 0) {\n      elementWidth = 100 * width / pageWidth;\n      elementHeight = 100 * height / pageHeight;\n    } else {\n      elementWidth = 100 * height / pageWidth;\n      elementHeight = 100 * width / pageHeight;\n    }\n\n    container.style.width = `${elementWidth}%`;\n    container.style.height = `${elementHeight}%`;\n    container.setAttribute(\"data-main-rotation\", (360 - angle) % 360);\n  }\n\n  get _commonActions() {\n    const setColor = (jsName, styleName, event) => {\n      const color = event.detail[jsName];\n      const colorType = color[0];\n      const colorArray = color.slice(1);\n      event.target.style[styleName] = ColorConverters[`${colorType}_HTML`](colorArray);\n      this.annotationStorage.setValue(this.data.id, {\n        [styleName]: ColorConverters[`${colorType}_rgb`](colorArray)\n      });\n    };\n\n    return shadow(this, \"_commonActions\", {\n      display: event => {\n        const {\n          display\n        } = event.detail;\n        const hidden = display % 2 === 1;\n        this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n        this.annotationStorage.setValue(this.data.id, {\n          noView: hidden,\n          noPrint: display === 1 || display === 2\n        });\n      },\n      print: event => {\n        this.annotationStorage.setValue(this.data.id, {\n          noPrint: !event.detail.print\n        });\n      },\n      hidden: event => {\n        const {\n          hidden\n        } = event.detail;\n        this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n        this.annotationStorage.setValue(this.data.id, {\n          noPrint: hidden,\n          noView: hidden\n        });\n      },\n      focus: event => {\n        setTimeout(() => event.target.focus({\n          preventScroll: false\n        }), 0);\n      },\n      userName: event => {\n        event.target.title = event.detail.userName;\n      },\n      readonly: event => {\n        event.target.disabled = event.detail.readonly;\n      },\n      required: event => {\n        this._setRequired(event.target, event.detail.required);\n      },\n      bgColor: event => {\n        setColor(\"bgColor\", \"backgroundColor\", event);\n      },\n      fillColor: event => {\n        setColor(\"fillColor\", \"backgroundColor\", event);\n      },\n      fgColor: event => {\n        setColor(\"fgColor\", \"color\", event);\n      },\n      textColor: event => {\n        setColor(\"textColor\", \"color\", event);\n      },\n      borderColor: event => {\n        setColor(\"borderColor\", \"borderColor\", event);\n      },\n      strokeColor: event => {\n        setColor(\"strokeColor\", \"borderColor\", event);\n      },\n      rotation: event => {\n        const angle = event.detail.rotation;\n        this.setRotation(angle);\n        this.annotationStorage.setValue(this.data.id, {\n          rotation: angle\n        });\n      }\n    });\n  }\n\n  _dispatchEventFromSandbox(actions, jsEvent) {\n    const commonActions = this._commonActions;\n\n    for (const name of Object.keys(jsEvent.detail)) {\n      const action = actions[name] || commonActions[name];\n      action?.(jsEvent);\n    }\n  }\n\n  _setDefaultPropertiesFromJS(element) {\n    if (!this.enableScripting) {\n      return;\n    }\n\n    const storedData = this.annotationStorage.getRawValue(this.data.id);\n\n    if (!storedData) {\n      return;\n    }\n\n    const commonActions = this._commonActions;\n\n    for (const [actionName, detail] of Object.entries(storedData)) {\n      const action = commonActions[actionName];\n\n      if (action) {\n        const eventProxy = {\n          detail: {\n            [actionName]: detail\n          },\n          target: element\n        };\n        action(eventProxy);\n        delete storedData[actionName];\n      }\n    }\n  }\n\n  _createQuadrilaterals() {\n    if (!this.container) {\n      return;\n    }\n\n    const {\n      quadPoints\n    } = this.data;\n\n    if (!quadPoints) {\n      return;\n    }\n\n    const [rectBlX, rectBlY, rectTrX, rectTrY] = this.data.rect.map(x => Math.fround(x));\n\n    if (quadPoints.length === 8) {\n      const [trX, trY, blX, blY] = quadPoints.subarray(2, 6);\n\n      if (rectTrX === trX && rectTrY === trY && rectBlX === blX && rectBlY === blY) {\n        return;\n      }\n    }\n\n    const {\n      style\n    } = this.container;\n    let svgBuffer;\n\n    if (this.#hasBorder) {\n      const {\n        borderColor,\n        borderWidth\n      } = style;\n      style.borderWidth = 0;\n      svgBuffer = [\"url('data:image/svg+xml;utf8,\", `<svg xmlns=\"http://www.w3.org/2000/svg\"`, ` preserveAspectRatio=\"none\" viewBox=\"0 0 1 1\">`, `<g fill=\"transparent\" stroke=\"${borderColor}\" stroke-width=\"${borderWidth}\">`];\n      this.container.classList.add(\"hasBorder\");\n    }\n\n    const width = rectTrX - rectBlX;\n    const height = rectTrY - rectBlY;\n    const {\n      svgFactory\n    } = this;\n    const svg = svgFactory.createElement(\"svg\");\n    svg.classList.add(\"quadrilateralsContainer\");\n    svg.setAttribute(\"width\", 0);\n    svg.setAttribute(\"height\", 0);\n    const defs = svgFactory.createElement(\"defs\");\n    svg.append(defs);\n    const clipPath = svgFactory.createElement(\"clipPath\");\n    const id = `clippath_${this.data.id}`;\n    clipPath.setAttribute(\"id\", id);\n    clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n    defs.append(clipPath);\n\n    for (let i = 2, ii = quadPoints.length; i < ii; i += 8) {\n      const trX = quadPoints[i];\n      const trY = quadPoints[i + 1];\n      const blX = quadPoints[i + 2];\n      const blY = quadPoints[i + 3];\n      const rect = svgFactory.createElement(\"rect\");\n      const x = (blX - rectBlX) / width;\n      const y = (rectTrY - trY) / height;\n      const rectWidth = (trX - blX) / width;\n      const rectHeight = (trY - blY) / height;\n      rect.setAttribute(\"x\", x);\n      rect.setAttribute(\"y\", y);\n      rect.setAttribute(\"width\", rectWidth);\n      rect.setAttribute(\"height\", rectHeight);\n      clipPath.append(rect);\n      svgBuffer?.push(`<rect vector-effect=\"non-scaling-stroke\" x=\"${x}\" y=\"${y}\" width=\"${rectWidth}\" height=\"${rectHeight}\"/>`);\n    }\n\n    if (this.#hasBorder) {\n      svgBuffer.push(`</g></svg>')`);\n      style.backgroundImage = svgBuffer.join(\"\");\n    }\n\n    this.container.append(svg);\n    this.container.style.clipPath = `url(#${id})`;\n  }\n\n  _createPopup() {\n    const {\n      container,\n      data\n    } = this;\n    container.setAttribute(\"aria-haspopup\", \"dialog\");\n    const popup = this.#popupElement = new PopupAnnotationElement({\n      data: {\n        color: data.color,\n        titleObj: data.titleObj,\n        modificationDate: data.modificationDate,\n        contentsObj: data.contentsObj,\n        richText: data.richText,\n        parentRect: data.rect,\n        borderStyle: 0,\n        id: `popup_${data.id}`,\n        rotation: data.rotation\n      },\n      parent: this.parent,\n      elements: [this]\n    });\n    this.parent.div.append(popup.render());\n  }\n\n  render() {\n    unreachable(\"Abstract method `AnnotationElement.render` called\");\n  }\n\n  _getElementsByName(name, skipId = null) {\n    const fields = [];\n\n    if (this._fieldObjects) {\n      const fieldObj = this._fieldObjects[name];\n\n      if (fieldObj) {\n        for (const {\n          page,\n          id,\n          exportValues\n        } of fieldObj) {\n          if (page === -1) {\n            continue;\n          }\n\n          if (id === skipId) {\n            continue;\n          }\n\n          const exportValue = typeof exportValues === \"string\" ? exportValues : null;\n          const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n\n          if (domElement && !GetElementsByNameSet.has(domElement)) {\n            warn(`_getElementsByName - element not allowed: ${id}`);\n            continue;\n          }\n\n          fields.push({\n            id,\n            exportValue,\n            domElement\n          });\n        }\n      }\n\n      return fields;\n    }\n\n    for (const domElement of document.getElementsByName(name)) {\n      const {\n        exportValue\n      } = domElement;\n      const id = domElement.getAttribute(\"data-element-id\");\n\n      if (id === skipId) {\n        continue;\n      }\n\n      if (!GetElementsByNameSet.has(domElement)) {\n        continue;\n      }\n\n      fields.push({\n        id,\n        exportValue,\n        domElement\n      });\n    }\n\n    return fields;\n  }\n\n  show() {\n    if (this.container) {\n      this.container.hidden = false;\n    }\n\n    this.popup?.maybeShow();\n  }\n\n  hide() {\n    if (this.container) {\n      this.container.hidden = true;\n    }\n\n    this.popup?.forceHide();\n  }\n\n  getElementsToTriggerPopup() {\n    return this.container;\n  }\n\n  addHighlightArea() {\n    const triggers = this.getElementsToTriggerPopup();\n\n    if (Array.isArray(triggers)) {\n      for (const element of triggers) {\n        element.classList.add(\"highlightArea\");\n      }\n    } else {\n      triggers.classList.add(\"highlightArea\");\n    }\n  }\n\n  _editOnDoubleClick() {\n    if (!this._isEditable) {\n      return;\n    }\n\n    const {\n      annotationEditorType: mode,\n      data: {\n        id: editId\n      }\n    } = this;\n    this.container.addEventListener(\"dblclick\", () => {\n      this.linkService.eventBus?.dispatch(\"switchannotationeditormode\", {\n        source: this,\n        mode,\n        editId\n      });\n    });\n  }\n\n}\n\nclass LinkAnnotationElement extends AnnotationElement {\n  constructor(parameters, options = null) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: !!options?.ignoreBorder,\n      createQuadrilaterals: true\n    });\n    this.isTooltipOnly = parameters.data.isTooltipOnly;\n  }\n\n  render() {\n    const {\n      data,\n      linkService\n    } = this;\n    const link = document.createElement(\"a\");\n    link.setAttribute(\"data-element-id\", data.id);\n    let isBound = false;\n\n    if (data.url) {\n      linkService.addLinkAttributes(link, data.url, data.newWindow);\n      isBound = true;\n    } else if (data.action) {\n      this._bindNamedAction(link, data.action);\n\n      isBound = true;\n    } else if (data.attachment) {\n      this.#bindAttachment(link, data.attachment, data.attachmentDest);\n      isBound = true;\n    } else if (data.setOCGState) {\n      this.#bindSetOCGState(link, data.setOCGState);\n      isBound = true;\n    } else if (data.dest) {\n      this._bindLink(link, data.dest);\n\n      isBound = true;\n    } else {\n      if (data.actions && (data.actions.Action || data.actions[\"Mouse Up\"] || data.actions[\"Mouse Down\"]) && this.enableScripting && this.hasJSActions) {\n        this._bindJSAction(link, data);\n\n        isBound = true;\n      }\n\n      if (data.resetForm) {\n        this._bindResetFormAction(link, data.resetForm);\n\n        isBound = true;\n      } else if (this.isTooltipOnly && !isBound) {\n        this._bindLink(link, \"\");\n\n        isBound = true;\n      }\n    }\n\n    this.container.classList.add(\"linkAnnotation\");\n\n    if (isBound) {\n      this.container.append(link);\n    }\n\n    return this.container;\n  }\n\n  #setInternalLink() {\n    this.container.setAttribute(\"data-internal-link\", \"\");\n  }\n\n  _bindLink(link, destination) {\n    link.href = this.linkService.getDestinationHash(destination);\n\n    link.onclick = () => {\n      if (destination) {\n        this.linkService.goToDestination(destination);\n      }\n\n      return false;\n    };\n\n    if (destination || destination === \"\") {\n      this.#setInternalLink();\n    }\n  }\n\n  _bindNamedAction(link, action) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n\n    link.onclick = () => {\n      this.linkService.executeNamedAction(action);\n      return false;\n    };\n\n    this.#setInternalLink();\n  }\n\n  #bindAttachment(link, attachment, dest = null) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n\n    if (attachment.description) {\n      link.title = attachment.description;\n    }\n\n    link.onclick = () => {\n      this.downloadManager?.openOrDownloadData(attachment.content, attachment.filename, dest);\n      return false;\n    };\n\n    this.#setInternalLink();\n  }\n\n  #bindSetOCGState(link, action) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n\n    link.onclick = () => {\n      this.linkService.executeSetOCGState(action);\n      return false;\n    };\n\n    this.#setInternalLink();\n  }\n\n  _bindJSAction(link, data) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    const map = new Map([[\"Action\", \"onclick\"], [\"Mouse Up\", \"onmouseup\"], [\"Mouse Down\", \"onmousedown\"]]);\n\n    for (const name of Object.keys(data.actions)) {\n      const jsName = map.get(name);\n\n      if (!jsName) {\n        continue;\n      }\n\n      link[jsName] = () => {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: data.id,\n            name\n          }\n        });\n        return false;\n      };\n    }\n\n    if (!link.onclick) {\n      link.onclick = () => false;\n    }\n\n    this.#setInternalLink();\n  }\n\n  _bindResetFormAction(link, resetForm) {\n    const otherClickAction = link.onclick;\n\n    if (!otherClickAction) {\n      link.href = this.linkService.getAnchorUrl(\"\");\n    }\n\n    this.#setInternalLink();\n\n    if (!this._fieldObjects) {\n      warn(`_bindResetFormAction - \"resetForm\" action not supported, ` + \"ensure that the `fieldObjects` parameter is provided.\");\n\n      if (!otherClickAction) {\n        link.onclick = () => false;\n      }\n\n      return;\n    }\n\n    link.onclick = () => {\n      otherClickAction?.();\n      const {\n        fields: resetFormFields,\n        refs: resetFormRefs,\n        include\n      } = resetForm;\n      const allFields = [];\n\n      if (resetFormFields.length !== 0 || resetFormRefs.length !== 0) {\n        const fieldIds = new Set(resetFormRefs);\n\n        for (const fieldName of resetFormFields) {\n          const fields = this._fieldObjects[fieldName] || [];\n\n          for (const {\n            id\n          } of fields) {\n            fieldIds.add(id);\n          }\n        }\n\n        for (const fields of Object.values(this._fieldObjects)) {\n          for (const field of fields) {\n            if (fieldIds.has(field.id) === include) {\n              allFields.push(field);\n            }\n          }\n        }\n      } else {\n        for (const fields of Object.values(this._fieldObjects)) {\n          allFields.push(...fields);\n        }\n      }\n\n      const storage = this.annotationStorage;\n      const allIds = [];\n\n      for (const field of allFields) {\n        const {\n          id\n        } = field;\n        allIds.push(id);\n\n        switch (field.type) {\n          case \"text\":\n            {\n              const value = field.defaultValue || \"\";\n              storage.setValue(id, {\n                value\n              });\n              break;\n            }\n\n          case \"checkbox\":\n          case \"radiobutton\":\n            {\n              const value = field.defaultValue === field.exportValues;\n              storage.setValue(id, {\n                value\n              });\n              break;\n            }\n\n          case \"combobox\":\n          case \"listbox\":\n            {\n              const value = field.defaultValue || \"\";\n              storage.setValue(id, {\n                value\n              });\n              break;\n            }\n\n          default:\n            continue;\n        }\n\n        const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n\n        if (!domElement) {\n          continue;\n        } else if (!GetElementsByNameSet.has(domElement)) {\n          warn(`_bindResetFormAction - element not allowed: ${id}`);\n          continue;\n        }\n\n        domElement.dispatchEvent(new Event(\"resetform\"));\n      }\n\n      if (this.enableScripting) {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: \"app\",\n            ids: allIds,\n            name: \"ResetForm\"\n          }\n        });\n      }\n\n      return false;\n    };\n  }\n\n}\n\nclass TextAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"textAnnotation\");\n    const image = document.createElement(\"img\");\n    image.src = this.imageResourcesPath + \"annotation-\" + this.data.name.toLowerCase() + \".svg\";\n    image.setAttribute(\"data-l10n-id\", \"pdfjs-text-annotation-type\");\n    image.setAttribute(\"data-l10n-args\", JSON.stringify({\n      type: this.data.name\n    }));\n\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.append(image);\n    return this.container;\n  }\n\n}\n\nclass WidgetAnnotationElement extends AnnotationElement {\n  render() {\n    return this.container;\n  }\n\n  showElementAndHideCanvas(element) {\n    if (this.data.hasOwnCanvas) {\n      if (element.previousSibling?.nodeName === \"CANVAS\") {\n        element.previousSibling.hidden = true;\n      }\n\n      element.hidden = false;\n    }\n  }\n\n  _getKeyModifier(event) {\n    return util_FeatureTest.platform.isMac ? event.metaKey : event.ctrlKey;\n  }\n\n  _setEventListener(element, elementData, baseName, eventName, valueGetter) {\n    if (baseName.includes(\"mouse\")) {\n      element.addEventListener(baseName, event => {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: this.data.id,\n            name: eventName,\n            value: valueGetter(event),\n            shift: event.shiftKey,\n            modifier: this._getKeyModifier(event)\n          }\n        });\n      });\n    } else {\n      element.addEventListener(baseName, event => {\n        if (baseName === \"blur\") {\n          if (!elementData.focused || !event.relatedTarget) {\n            return;\n          }\n\n          elementData.focused = false;\n        } else if (baseName === \"focus\") {\n          if (elementData.focused) {\n            return;\n          }\n\n          elementData.focused = true;\n        }\n\n        if (!valueGetter) {\n          return;\n        }\n\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: this.data.id,\n            name: eventName,\n            value: valueGetter(event)\n          }\n        });\n      });\n    }\n  }\n\n  _setEventListeners(element, elementData, names, getter) {\n    for (const [baseName, eventName] of names) {\n      if (eventName === \"Action\" || this.data.actions?.[eventName]) {\n        if (eventName === \"Focus\" || eventName === \"Blur\") {\n          elementData ||= {\n            focused: false\n          };\n        }\n\n        this._setEventListener(element, elementData, baseName, eventName, getter);\n\n        if (eventName === \"Focus\" && !this.data.actions?.Blur) {\n          this._setEventListener(element, elementData, \"blur\", \"Blur\", null);\n        } else if (eventName === \"Blur\" && !this.data.actions?.Focus) {\n          this._setEventListener(element, elementData, \"focus\", \"Focus\", null);\n        }\n      }\n    }\n  }\n\n  _setBackgroundColor(element) {\n    const color = this.data.backgroundColor || null;\n    element.style.backgroundColor = color === null ? \"transparent\" : Util.makeHexColor(color[0], color[1], color[2]);\n  }\n\n  _setTextStyle(element) {\n    const TEXT_ALIGNMENT = [\"left\", \"center\", \"right\"];\n    const {\n      fontColor\n    } = this.data.defaultAppearanceData;\n    const fontSize = this.data.defaultAppearanceData.fontSize || annotation_layer_DEFAULT_FONT_SIZE;\n    const style = element.style;\n    let computedFontSize;\n    const BORDER_SIZE = 2;\n\n    const roundToOneDecimal = x => Math.round(10 * x) / 10;\n\n    if (this.data.multiLine) {\n      const height = Math.abs(this.data.rect[3] - this.data.rect[1] - BORDER_SIZE);\n      const numberOfLines = Math.round(height / (LINE_FACTOR * fontSize)) || 1;\n      const lineHeight = height / numberOfLines;\n      computedFontSize = Math.min(fontSize, roundToOneDecimal(lineHeight / LINE_FACTOR));\n    } else {\n      const height = Math.abs(this.data.rect[3] - this.data.rect[1] - BORDER_SIZE);\n      computedFontSize = Math.min(fontSize, roundToOneDecimal(height / LINE_FACTOR));\n    }\n\n    style.fontSize = `calc(${computedFontSize}px * var(--scale-factor))`;\n    style.color = Util.makeHexColor(fontColor[0], fontColor[1], fontColor[2]);\n\n    if (this.data.textAlignment !== null) {\n      style.textAlign = TEXT_ALIGNMENT[this.data.textAlignment];\n    }\n  }\n\n  _setRequired(element, isRequired) {\n    if (isRequired) {\n      element.setAttribute(\"required\", true);\n    } else {\n      element.removeAttribute(\"required\");\n    }\n\n    element.setAttribute(\"aria-required\", isRequired);\n  }\n\n}\n\nclass TextWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    const isRenderable = parameters.renderForms || parameters.data.hasOwnCanvas || !parameters.data.hasAppearance && !!parameters.data.fieldValue;\n    super(parameters, {\n      isRenderable\n    });\n  }\n\n  setPropertyOnSiblings(base, key, value, keyInStorage) {\n    const storage = this.annotationStorage;\n\n    for (const element of this._getElementsByName(base.name, base.id)) {\n      if (element.domElement) {\n        element.domElement[key] = value;\n      }\n\n      storage.setValue(element.id, {\n        [keyInStorage]: value\n      });\n    }\n  }\n\n  render() {\n    const storage = this.annotationStorage;\n    const id = this.data.id;\n    this.container.classList.add(\"textWidgetAnnotation\");\n    let element = null;\n\n    if (this.renderForms) {\n      const storedData = storage.getValue(id, {\n        value: this.data.fieldValue\n      });\n      let textContent = storedData.value || \"\";\n      const maxLen = storage.getValue(id, {\n        charLimit: this.data.maxLen\n      }).charLimit;\n\n      if (maxLen && textContent.length > maxLen) {\n        textContent = textContent.slice(0, maxLen);\n      }\n\n      let fieldFormattedValues = storedData.formattedValue || this.data.textContent?.join(\"\\n\") || null;\n\n      if (fieldFormattedValues && this.data.comb) {\n        fieldFormattedValues = fieldFormattedValues.replaceAll(/\\s+/g, \"\");\n      }\n\n      const elementData = {\n        userValue: textContent,\n        formattedValue: fieldFormattedValues,\n        lastCommittedValue: null,\n        commitKey: 1,\n        focused: false\n      };\n\n      if (this.data.multiLine) {\n        element = document.createElement(\"textarea\");\n        element.textContent = fieldFormattedValues ?? textContent;\n\n        if (this.data.doNotScroll) {\n          element.style.overflowY = \"hidden\";\n        }\n      } else {\n        element = document.createElement(\"input\");\n        element.type = \"text\";\n        element.setAttribute(\"value\", fieldFormattedValues ?? textContent);\n\n        if (this.data.doNotScroll) {\n          element.style.overflowX = \"hidden\";\n        }\n      }\n\n      if (this.data.hasOwnCanvas) {\n        element.hidden = true;\n      }\n\n      GetElementsByNameSet.add(element);\n      element.setAttribute(\"data-element-id\", id);\n      element.disabled = this.data.readOnly;\n      element.name = this.data.fieldName;\n      element.tabIndex = DEFAULT_TAB_INDEX;\n\n      this._setRequired(element, this.data.required);\n\n      if (maxLen) {\n        element.maxLength = maxLen;\n      }\n\n      element.addEventListener(\"input\", event => {\n        storage.setValue(id, {\n          value: event.target.value\n        });\n        this.setPropertyOnSiblings(element, \"value\", event.target.value, \"value\");\n        elementData.formattedValue = null;\n      });\n      element.addEventListener(\"resetform\", event => {\n        const defaultValue = this.data.defaultFieldValue ?? \"\";\n        element.value = elementData.userValue = defaultValue;\n        elementData.formattedValue = null;\n      });\n\n      let blurListener = event => {\n        const {\n          formattedValue\n        } = elementData;\n\n        if (formattedValue !== null && formattedValue !== undefined) {\n          event.target.value = formattedValue;\n        }\n\n        event.target.scrollLeft = 0;\n      };\n\n      if (this.enableScripting && this.hasJSActions) {\n        element.addEventListener(\"focus\", event => {\n          if (elementData.focused) {\n            return;\n          }\n\n          const {\n            target\n          } = event;\n\n          if (elementData.userValue) {\n            target.value = elementData.userValue;\n          }\n\n          elementData.lastCommittedValue = target.value;\n          elementData.commitKey = 1;\n\n          if (!this.data.actions?.Focus) {\n            elementData.focused = true;\n          }\n        });\n        element.addEventListener(\"updatefromsandbox\", jsEvent => {\n          this.showElementAndHideCanvas(jsEvent.target);\n          const actions = {\n            value(event) {\n              elementData.userValue = event.detail.value ?? \"\";\n              storage.setValue(id, {\n                value: elementData.userValue.toString()\n              });\n              event.target.value = elementData.userValue;\n            },\n\n            formattedValue(event) {\n              const {\n                formattedValue\n              } = event.detail;\n              elementData.formattedValue = formattedValue;\n\n              if (formattedValue !== null && formattedValue !== undefined && event.target !== document.activeElement) {\n                event.target.value = formattedValue;\n              }\n\n              storage.setValue(id, {\n                formattedValue\n              });\n            },\n\n            selRange(event) {\n              event.target.setSelectionRange(...event.detail.selRange);\n            },\n\n            charLimit: event => {\n              const {\n                charLimit\n              } = event.detail;\n              const {\n                target\n              } = event;\n\n              if (charLimit === 0) {\n                target.removeAttribute(\"maxLength\");\n                return;\n              }\n\n              target.setAttribute(\"maxLength\", charLimit);\n              let value = elementData.userValue;\n\n              if (!value || value.length <= charLimit) {\n                return;\n              }\n\n              value = value.slice(0, charLimit);\n              target.value = elementData.userValue = value;\n              storage.setValue(id, {\n                value\n              });\n              this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n                source: this,\n                detail: {\n                  id,\n                  name: \"Keystroke\",\n                  value,\n                  willCommit: true,\n                  commitKey: 1,\n                  selStart: target.selectionStart,\n                  selEnd: target.selectionEnd\n                }\n              });\n            }\n          };\n\n          this._dispatchEventFromSandbox(actions, jsEvent);\n        });\n        element.addEventListener(\"keydown\", event => {\n          elementData.commitKey = 1;\n          let commitKey = -1;\n\n          if (event.key === \"Escape\") {\n            commitKey = 0;\n          } else if (event.key === \"Enter\" && !this.data.multiLine) {\n            commitKey = 2;\n          } else if (event.key === \"Tab\") {\n            elementData.commitKey = 3;\n          }\n\n          if (commitKey === -1) {\n            return;\n          }\n\n          const {\n            value\n          } = event.target;\n\n          if (elementData.lastCommittedValue === value) {\n            return;\n          }\n\n          elementData.lastCommittedValue = value;\n          elementData.userValue = value;\n          this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n            source: this,\n            detail: {\n              id,\n              name: \"Keystroke\",\n              value,\n              willCommit: true,\n              commitKey,\n              selStart: event.target.selectionStart,\n              selEnd: event.target.selectionEnd\n            }\n          });\n        });\n        const _blurListener = blurListener;\n        blurListener = null;\n        element.addEventListener(\"blur\", event => {\n          if (!elementData.focused || !event.relatedTarget) {\n            return;\n          }\n\n          if (!this.data.actions?.Blur) {\n            elementData.focused = false;\n          }\n\n          const {\n            value\n          } = event.target;\n          elementData.userValue = value;\n\n          if (elementData.lastCommittedValue !== value) {\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id,\n                name: \"Keystroke\",\n                value,\n                willCommit: true,\n                commitKey: elementData.commitKey,\n                selStart: event.target.selectionStart,\n                selEnd: event.target.selectionEnd\n              }\n            });\n          }\n\n          _blurListener(event);\n        });\n\n        if (this.data.actions?.Keystroke) {\n          element.addEventListener(\"beforeinput\", event => {\n            elementData.lastCommittedValue = null;\n            const {\n              data,\n              target\n            } = event;\n            const {\n              value,\n              selectionStart,\n              selectionEnd\n            } = target;\n            let selStart = selectionStart,\n                selEnd = selectionEnd;\n\n            switch (event.inputType) {\n              case \"deleteWordBackward\":\n                {\n                  const match = value.substring(0, selectionStart).match(/\\w*[^\\w]*$/);\n\n                  if (match) {\n                    selStart -= match[0].length;\n                  }\n\n                  break;\n                }\n\n              case \"deleteWordForward\":\n                {\n                  const match = value.substring(selectionStart).match(/^[^\\w]*\\w*/);\n\n                  if (match) {\n                    selEnd += match[0].length;\n                  }\n\n                  break;\n                }\n\n              case \"deleteContentBackward\":\n                if (selectionStart === selectionEnd) {\n                  selStart -= 1;\n                }\n\n                break;\n\n              case \"deleteContentForward\":\n                if (selectionStart === selectionEnd) {\n                  selEnd += 1;\n                }\n\n                break;\n            }\n\n            event.preventDefault();\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id,\n                name: \"Keystroke\",\n                value,\n                change: data || \"\",\n                willCommit: false,\n                selStart,\n                selEnd\n              }\n            });\n          });\n        }\n\n        this._setEventListeners(element, elementData, [[\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"]], event => event.target.value);\n      }\n\n      if (blurListener) {\n        element.addEventListener(\"blur\", blurListener);\n      }\n\n      if (this.data.comb) {\n        const fieldWidth = this.data.rect[2] - this.data.rect[0];\n        const combWidth = fieldWidth / maxLen;\n        element.classList.add(\"comb\");\n        element.style.letterSpacing = `calc(${combWidth}px * var(--scale-factor) - 1ch)`;\n      }\n    } else {\n      element = document.createElement(\"div\");\n      element.textContent = this.data.fieldValue;\n      element.style.verticalAlign = \"middle\";\n      element.style.display = \"table-cell\";\n\n      if (this.data.hasOwnCanvas) {\n        element.hidden = true;\n      }\n    }\n\n    this._setTextStyle(element);\n\n    this._setBackgroundColor(element);\n\n    this._setDefaultPropertiesFromJS(element);\n\n    this.container.append(element);\n    return this.container;\n  }\n\n}\n\nclass SignatureWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: !!parameters.data.hasOwnCanvas\n    });\n  }\n\n}\n\nclass CheckboxWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: parameters.renderForms\n    });\n  }\n\n  render() {\n    const storage = this.annotationStorage;\n    const data = this.data;\n    const id = data.id;\n    let value = storage.getValue(id, {\n      value: data.exportValue === data.fieldValue\n    }).value;\n\n    if (typeof value === \"string\") {\n      value = value !== \"Off\";\n      storage.setValue(id, {\n        value\n      });\n    }\n\n    this.container.classList.add(\"buttonWidgetAnnotation\", \"checkBox\");\n    const element = document.createElement(\"input\");\n    GetElementsByNameSet.add(element);\n    element.setAttribute(\"data-element-id\", id);\n    element.disabled = data.readOnly;\n\n    this._setRequired(element, this.data.required);\n\n    element.type = \"checkbox\";\n    element.name = data.fieldName;\n\n    if (value) {\n      element.setAttribute(\"checked\", true);\n    }\n\n    element.setAttribute(\"exportValue\", data.exportValue);\n    element.tabIndex = DEFAULT_TAB_INDEX;\n    element.addEventListener(\"change\", event => {\n      const {\n        name,\n        checked\n      } = event.target;\n\n      for (const checkbox of this._getElementsByName(name, id)) {\n        const curChecked = checked && checkbox.exportValue === data.exportValue;\n\n        if (checkbox.domElement) {\n          checkbox.domElement.checked = curChecked;\n        }\n\n        storage.setValue(checkbox.id, {\n          value: curChecked\n        });\n      }\n\n      storage.setValue(id, {\n        value: checked\n      });\n    });\n    element.addEventListener(\"resetform\", event => {\n      const defaultValue = data.defaultFieldValue || \"Off\";\n      event.target.checked = defaultValue === data.exportValue;\n    });\n\n    if (this.enableScripting && this.hasJSActions) {\n      element.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value(event) {\n            event.target.checked = event.detail.value !== \"Off\";\n            storage.setValue(id, {\n              value: event.target.checked\n            });\n          }\n\n        };\n\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n\n      this._setEventListeners(element, null, [[\"change\", \"Validate\"], [\"change\", \"Action\"], [\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"]], event => event.target.checked);\n    }\n\n    this._setBackgroundColor(element);\n\n    this._setDefaultPropertiesFromJS(element);\n\n    this.container.append(element);\n    return this.container;\n  }\n\n}\n\nclass RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: parameters.renderForms\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"buttonWidgetAnnotation\", \"radioButton\");\n    const storage = this.annotationStorage;\n    const data = this.data;\n    const id = data.id;\n    let value = storage.getValue(id, {\n      value: data.fieldValue === data.buttonValue\n    }).value;\n\n    if (typeof value === \"string\") {\n      value = value !== data.buttonValue;\n      storage.setValue(id, {\n        value\n      });\n    }\n\n    if (value) {\n      for (const radio of this._getElementsByName(data.fieldName, id)) {\n        storage.setValue(radio.id, {\n          value: false\n        });\n      }\n    }\n\n    const element = document.createElement(\"input\");\n    GetElementsByNameSet.add(element);\n    element.setAttribute(\"data-element-id\", id);\n    element.disabled = data.readOnly;\n\n    this._setRequired(element, this.data.required);\n\n    element.type = \"radio\";\n    element.name = data.fieldName;\n\n    if (value) {\n      element.setAttribute(\"checked\", true);\n    }\n\n    element.tabIndex = DEFAULT_TAB_INDEX;\n    element.addEventListener(\"change\", event => {\n      const {\n        name,\n        checked\n      } = event.target;\n\n      for (const radio of this._getElementsByName(name, id)) {\n        storage.setValue(radio.id, {\n          value: false\n        });\n      }\n\n      storage.setValue(id, {\n        value: checked\n      });\n    });\n    element.addEventListener(\"resetform\", event => {\n      const defaultValue = data.defaultFieldValue;\n      event.target.checked = defaultValue !== null && defaultValue !== undefined && defaultValue === data.buttonValue;\n    });\n\n    if (this.enableScripting && this.hasJSActions) {\n      const pdfButtonValue = data.buttonValue;\n      element.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value: event => {\n            const checked = pdfButtonValue === event.detail.value;\n\n            for (const radio of this._getElementsByName(event.target.name)) {\n              const curChecked = checked && radio.id === id;\n\n              if (radio.domElement) {\n                radio.domElement.checked = curChecked;\n              }\n\n              storage.setValue(radio.id, {\n                value: curChecked\n              });\n            }\n          }\n        };\n\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n\n      this._setEventListeners(element, null, [[\"change\", \"Validate\"], [\"change\", \"Action\"], [\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"]], event => event.target.checked);\n    }\n\n    this._setBackgroundColor(element);\n\n    this._setDefaultPropertiesFromJS(element);\n\n    this.container.append(element);\n    return this.container;\n  }\n\n}\n\nclass PushButtonWidgetAnnotationElement extends LinkAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      ignoreBorder: parameters.data.hasAppearance\n    });\n  }\n\n  render() {\n    const container = super.render();\n    container.classList.add(\"buttonWidgetAnnotation\", \"pushButton\");\n    const linkElement = container.lastChild;\n\n    if (this.enableScripting && this.hasJSActions && linkElement) {\n      this._setDefaultPropertiesFromJS(linkElement);\n\n      linkElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n        this._dispatchEventFromSandbox({}, jsEvent);\n      });\n    }\n\n    return container;\n  }\n\n}\n\nclass ChoiceWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: parameters.renderForms\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"choiceWidgetAnnotation\");\n    const storage = this.annotationStorage;\n    const id = this.data.id;\n    const storedData = storage.getValue(id, {\n      value: this.data.fieldValue\n    });\n    const selectElement = document.createElement(\"select\");\n    GetElementsByNameSet.add(selectElement);\n    selectElement.setAttribute(\"data-element-id\", id);\n    selectElement.disabled = this.data.readOnly;\n\n    this._setRequired(selectElement, this.data.required);\n\n    selectElement.name = this.data.fieldName;\n    selectElement.tabIndex = DEFAULT_TAB_INDEX;\n    let addAnEmptyEntry = this.data.combo && this.data.options.length > 0;\n\n    if (!this.data.combo) {\n      selectElement.size = this.data.options.length;\n\n      if (this.data.multiSelect) {\n        selectElement.multiple = true;\n      }\n    }\n\n    selectElement.addEventListener(\"resetform\", event => {\n      const defaultValue = this.data.defaultFieldValue;\n\n      for (const option of selectElement.options) {\n        option.selected = option.value === defaultValue;\n      }\n    });\n\n    for (const option of this.data.options) {\n      const optionElement = document.createElement(\"option\");\n      optionElement.textContent = option.displayValue;\n      optionElement.value = option.exportValue;\n\n      if (storedData.value.includes(option.exportValue)) {\n        optionElement.setAttribute(\"selected\", true);\n        addAnEmptyEntry = false;\n      }\n\n      selectElement.append(optionElement);\n    }\n\n    let removeEmptyEntry = null;\n\n    if (addAnEmptyEntry) {\n      const noneOptionElement = document.createElement(\"option\");\n      noneOptionElement.value = \" \";\n      noneOptionElement.setAttribute(\"hidden\", true);\n      noneOptionElement.setAttribute(\"selected\", true);\n      selectElement.prepend(noneOptionElement);\n\n      removeEmptyEntry = () => {\n        noneOptionElement.remove();\n        selectElement.removeEventListener(\"input\", removeEmptyEntry);\n        removeEmptyEntry = null;\n      };\n\n      selectElement.addEventListener(\"input\", removeEmptyEntry);\n    }\n\n    const getValue = isExport => {\n      const name = isExport ? \"value\" : \"textContent\";\n      const {\n        options,\n        multiple\n      } = selectElement;\n\n      if (!multiple) {\n        return options.selectedIndex === -1 ? null : options[options.selectedIndex][name];\n      }\n\n      return Array.prototype.filter.call(options, option => option.selected).map(option => option[name]);\n    };\n\n    let selectedValues = getValue(false);\n\n    const getItems = event => {\n      const options = event.target.options;\n      return Array.prototype.map.call(options, option => ({\n        displayValue: option.textContent,\n        exportValue: option.value\n      }));\n    };\n\n    if (this.enableScripting && this.hasJSActions) {\n      selectElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value(event) {\n            removeEmptyEntry?.();\n            const value = event.detail.value;\n            const values = new Set(Array.isArray(value) ? value : [value]);\n\n            for (const option of selectElement.options) {\n              option.selected = values.has(option.value);\n            }\n\n            storage.setValue(id, {\n              value: getValue(true)\n            });\n            selectedValues = getValue(false);\n          },\n\n          multipleSelection(event) {\n            selectElement.multiple = true;\n          },\n\n          remove(event) {\n            const options = selectElement.options;\n            const index = event.detail.remove;\n            options[index].selected = false;\n            selectElement.remove(index);\n\n            if (options.length > 0) {\n              const i = Array.prototype.findIndex.call(options, option => option.selected);\n\n              if (i === -1) {\n                options[0].selected = true;\n              }\n            }\n\n            storage.setValue(id, {\n              value: getValue(true),\n              items: getItems(event)\n            });\n            selectedValues = getValue(false);\n          },\n\n          clear(event) {\n            while (selectElement.length !== 0) {\n              selectElement.remove(0);\n            }\n\n            storage.setValue(id, {\n              value: null,\n              items: []\n            });\n            selectedValues = getValue(false);\n          },\n\n          insert(event) {\n            const {\n              index,\n              displayValue,\n              exportValue\n            } = event.detail.insert;\n            const selectChild = selectElement.children[index];\n            const optionElement = document.createElement(\"option\");\n            optionElement.textContent = displayValue;\n            optionElement.value = exportValue;\n\n            if (selectChild) {\n              selectChild.before(optionElement);\n            } else {\n              selectElement.append(optionElement);\n            }\n\n            storage.setValue(id, {\n              value: getValue(true),\n              items: getItems(event)\n            });\n            selectedValues = getValue(false);\n          },\n\n          items(event) {\n            const {\n              items\n            } = event.detail;\n\n            while (selectElement.length !== 0) {\n              selectElement.remove(0);\n            }\n\n            for (const item of items) {\n              const {\n                displayValue,\n                exportValue\n              } = item;\n              const optionElement = document.createElement(\"option\");\n              optionElement.textContent = displayValue;\n              optionElement.value = exportValue;\n              selectElement.append(optionElement);\n            }\n\n            if (selectElement.options.length > 0) {\n              selectElement.options[0].selected = true;\n            }\n\n            storage.setValue(id, {\n              value: getValue(true),\n              items: getItems(event)\n            });\n            selectedValues = getValue(false);\n          },\n\n          indices(event) {\n            const indices = new Set(event.detail.indices);\n\n            for (const option of event.target.options) {\n              option.selected = indices.has(option.index);\n            }\n\n            storage.setValue(id, {\n              value: getValue(true)\n            });\n            selectedValues = getValue(false);\n          },\n\n          editable(event) {\n            event.target.disabled = !event.detail.editable;\n          }\n\n        };\n\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n      selectElement.addEventListener(\"input\", event => {\n        const exportValue = getValue(true);\n        const change = getValue(false);\n        storage.setValue(id, {\n          value: exportValue\n        });\n        event.preventDefault();\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id,\n            name: \"Keystroke\",\n            value: selectedValues,\n            change,\n            changeEx: exportValue,\n            willCommit: false,\n            commitKey: 1,\n            keyDown: false\n          }\n        });\n      });\n\n      this._setEventListeners(selectElement, null, [[\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"], [\"input\", \"Action\"], [\"input\", \"Validate\"]], event => event.target.value);\n    } else {\n      selectElement.addEventListener(\"input\", function (event) {\n        storage.setValue(id, {\n          value: getValue(true)\n        });\n      });\n    }\n\n    if (this.data.combo) {\n      this._setTextStyle(selectElement);\n    } else {}\n\n    this._setBackgroundColor(selectElement);\n\n    this._setDefaultPropertiesFromJS(selectElement);\n\n    this.container.append(selectElement);\n    return this.container;\n  }\n\n}\n\nclass PopupAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const {\n      data,\n      elements\n    } = parameters;\n    super(parameters, {\n      isRenderable: AnnotationElement._hasPopupData(data)\n    });\n    this.elements = elements;\n    this.popup = null;\n  }\n\n  render() {\n    this.container.classList.add(\"popupAnnotation\");\n    const popup = this.popup = new PopupElement({\n      container: this.container,\n      color: this.data.color,\n      titleObj: this.data.titleObj,\n      modificationDate: this.data.modificationDate,\n      contentsObj: this.data.contentsObj,\n      richText: this.data.richText,\n      rect: this.data.rect,\n      parentRect: this.data.parentRect || null,\n      parent: this.parent,\n      elements: this.elements,\n      open: this.data.open\n    });\n    const elementIds = [];\n\n    for (const element of this.elements) {\n      element.popup = popup;\n      elementIds.push(element.data.id);\n      element.addHighlightArea();\n    }\n\n    this.container.setAttribute(\"aria-controls\", elementIds.map(id => `${AnnotationPrefix}${id}`).join(\",\"));\n    return this.container;\n  }\n\n}\n\nclass PopupElement {\n  #boundKeyDown = this.#keyDown.bind(this);\n  #boundHide = this.#hide.bind(this);\n  #boundShow = this.#show.bind(this);\n  #boundToggle = this.#toggle.bind(this);\n  #color = null;\n  #container = null;\n  #contentsObj = null;\n  #dateObj = null;\n  #elements = null;\n  #parent = null;\n  #parentRect = null;\n  #pinned = false;\n  #popup = null;\n  #position = null;\n  #rect = null;\n  #richText = null;\n  #titleObj = null;\n  #updates = null;\n  #wasVisible = false;\n\n  constructor({\n    container,\n    color,\n    elements,\n    titleObj,\n    modificationDate,\n    contentsObj,\n    richText,\n    parent,\n    rect,\n    parentRect,\n    open\n  }) {\n    this.#container = container;\n    this.#titleObj = titleObj;\n    this.#contentsObj = contentsObj;\n    this.#richText = richText;\n    this.#parent = parent;\n    this.#color = color;\n    this.#rect = rect;\n    this.#parentRect = parentRect;\n    this.#elements = elements;\n    this.#dateObj = PDFDateString.toDateObject(modificationDate);\n    this.trigger = elements.flatMap(e => e.getElementsToTriggerPopup());\n\n    for (const element of this.trigger) {\n      element.addEventListener(\"click\", this.#boundToggle);\n      element.addEventListener(\"mouseenter\", this.#boundShow);\n      element.addEventListener(\"mouseleave\", this.#boundHide);\n      element.classList.add(\"popupTriggerArea\");\n    }\n\n    for (const element of elements) {\n      element.container?.addEventListener(\"keydown\", this.#boundKeyDown);\n    }\n\n    this.#container.hidden = true;\n\n    if (open) {\n      this.#toggle();\n    }\n  }\n\n  render() {\n    if (this.#popup) {\n      return;\n    }\n\n    const popup = this.#popup = document.createElement(\"div\");\n    popup.className = \"popup\";\n\n    if (this.#color) {\n      const baseColor = popup.style.outlineColor = Util.makeHexColor(...this.#color);\n\n      if (CSS.supports(\"background-color\", \"color-mix(in srgb, red 30%, white)\")) {\n        popup.style.backgroundColor = `color-mix(in srgb, ${baseColor} 30%, white)`;\n      } else {\n        const BACKGROUND_ENLIGHT = 0.7;\n        popup.style.backgroundColor = Util.makeHexColor(...this.#color.map(c => Math.floor(BACKGROUND_ENLIGHT * (255 - c) + c)));\n      }\n    }\n\n    const header = document.createElement(\"span\");\n    header.className = \"header\";\n    const title = document.createElement(\"h1\");\n    header.append(title);\n    ({\n      dir: title.dir,\n      str: title.textContent\n    } = this.#titleObj);\n    popup.append(header);\n\n    if (this.#dateObj) {\n      const modificationDate = document.createElement(\"span\");\n      modificationDate.classList.add(\"popupDate\");\n      modificationDate.setAttribute(\"data-l10n-id\", \"pdfjs-annotation-date-time-string\");\n      modificationDate.setAttribute(\"data-l10n-args\", JSON.stringify({\n        dateObj: this.#dateObj.valueOf()\n      }));\n      header.append(modificationDate);\n    }\n\n    const html = this.#html;\n\n    if (html) {\n      XfaLayer.render({\n        xfaHtml: html,\n        intent: \"richText\",\n        div: popup\n      });\n      popup.lastChild.classList.add(\"richText\", \"popupContent\");\n    } else {\n      const contents = this._formatContents(this.#contentsObj);\n\n      popup.append(contents);\n    }\n\n    this.#container.append(popup);\n  }\n\n  get #html() {\n    const richText = this.#richText;\n    const contentsObj = this.#contentsObj;\n\n    if (richText?.str && (!contentsObj?.str || contentsObj.str === richText.str)) {\n      return this.#richText.html || null;\n    }\n\n    return null;\n  }\n\n  get #fontSize() {\n    return this.#html?.attributes?.style?.fontSize || 0;\n  }\n\n  get #fontColor() {\n    return this.#html?.attributes?.style?.color || null;\n  }\n\n  #makePopupContent(text) {\n    const popupLines = [];\n    const popupContent = {\n      str: text,\n      html: {\n        name: \"div\",\n        attributes: {\n          dir: \"auto\"\n        },\n        children: [{\n          name: \"p\",\n          children: popupLines\n        }]\n      }\n    };\n    const lineAttributes = {\n      style: {\n        color: this.#fontColor,\n        fontSize: this.#fontSize ? `calc(${this.#fontSize}px * var(--scale-factor))` : \"\"\n      }\n    };\n\n    for (const line of text.split(\"\\n\")) {\n      popupLines.push({\n        name: \"span\",\n        value: line,\n        attributes: lineAttributes\n      });\n    }\n\n    return popupContent;\n  }\n\n  _formatContents({\n    str,\n    dir\n  }) {\n    const p = document.createElement(\"p\");\n    p.classList.add(\"popupContent\");\n    p.dir = dir;\n    const lines = str.split(/(?:\\r\\n?|\\n)/);\n\n    for (let i = 0, ii = lines.length; i < ii; ++i) {\n      const line = lines[i];\n      p.append(document.createTextNode(line));\n\n      if (i < ii - 1) {\n        p.append(document.createElement(\"br\"));\n      }\n    }\n\n    return p;\n  }\n\n  #keyDown(event) {\n    if (event.altKey || event.shiftKey || event.ctrlKey || event.metaKey) {\n      return;\n    }\n\n    if (event.key === \"Enter\" || event.key === \"Escape\" && this.#pinned) {\n      this.#toggle();\n    }\n  }\n\n  updateEdited({\n    rect,\n    popupContent\n  }) {\n    this.#updates ||= {\n      contentsObj: this.#contentsObj,\n      richText: this.#richText\n    };\n\n    if (rect) {\n      this.#position = null;\n    }\n\n    if (popupContent) {\n      this.#richText = this.#makePopupContent(popupContent);\n      this.#contentsObj = null;\n    }\n\n    this.#popup?.remove();\n    this.#popup = null;\n  }\n\n  resetEdited() {\n    if (!this.#updates) {\n      return;\n    }\n\n    ({\n      contentsObj: this.#contentsObj,\n      richText: this.#richText\n    } = this.#updates);\n    this.#updates = null;\n    this.#popup?.remove();\n    this.#popup = null;\n    this.#position = null;\n  }\n\n  #setPosition() {\n    if (this.#position !== null) {\n      return;\n    }\n\n    const {\n      page: {\n        view\n      },\n      viewport: {\n        rawDims: {\n          pageWidth,\n          pageHeight,\n          pageX,\n          pageY\n        }\n      }\n    } = this.#parent;\n    let useParentRect = !!this.#parentRect;\n    let rect = useParentRect ? this.#parentRect : this.#rect;\n\n    for (const element of this.#elements) {\n      if (!rect || Util.intersect(element.data.rect, rect) !== null) {\n        rect = element.data.rect;\n        useParentRect = true;\n        break;\n      }\n    }\n\n    const normalizedRect = Util.normalizeRect([rect[0], view[3] - rect[1] + view[1], rect[2], view[3] - rect[3] + view[1]]);\n    const HORIZONTAL_SPACE_AFTER_ANNOTATION = 5;\n    const parentWidth = useParentRect ? rect[2] - rect[0] + HORIZONTAL_SPACE_AFTER_ANNOTATION : 0;\n    const popupLeft = normalizedRect[0] + parentWidth;\n    const popupTop = normalizedRect[1];\n    this.#position = [100 * (popupLeft - pageX) / pageWidth, 100 * (popupTop - pageY) / pageHeight];\n    const {\n      style\n    } = this.#container;\n    style.left = `${this.#position[0]}%`;\n    style.top = `${this.#position[1]}%`;\n  }\n\n  #toggle() {\n    this.#pinned = !this.#pinned;\n\n    if (this.#pinned) {\n      this.#show();\n      this.#container.addEventListener(\"click\", this.#boundToggle);\n      this.#container.addEventListener(\"keydown\", this.#boundKeyDown);\n    } else {\n      this.#hide();\n      this.#container.removeEventListener(\"click\", this.#boundToggle);\n      this.#container.removeEventListener(\"keydown\", this.#boundKeyDown);\n    }\n  }\n\n  #show() {\n    if (!this.#popup) {\n      this.render();\n    }\n\n    if (!this.isVisible) {\n      this.#setPosition();\n      this.#container.hidden = false;\n      this.#container.style.zIndex = parseInt(this.#container.style.zIndex) + 1000;\n    } else if (this.#pinned) {\n      this.#container.classList.add(\"focused\");\n    }\n  }\n\n  #hide() {\n    this.#container.classList.remove(\"focused\");\n\n    if (this.#pinned || !this.isVisible) {\n      return;\n    }\n\n    this.#container.hidden = true;\n    this.#container.style.zIndex = parseInt(this.#container.style.zIndex) - 1000;\n  }\n\n  forceHide() {\n    this.#wasVisible = this.isVisible;\n\n    if (!this.#wasVisible) {\n      return;\n    }\n\n    this.#container.hidden = true;\n  }\n\n  maybeShow() {\n    if (!this.#wasVisible) {\n      return;\n    }\n\n    if (!this.#popup) {\n      this.#show();\n    }\n\n    this.#wasVisible = false;\n    this.#container.hidden = false;\n  }\n\n  get isVisible() {\n    return this.#container.hidden === false;\n  }\n\n}\n\nclass FreeTextAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n    this.textContent = parameters.data.textContent;\n    this.textPosition = parameters.data.textPosition;\n    this.annotationEditorType = AnnotationEditorType.FREETEXT;\n  }\n\n  render() {\n    this.container.classList.add(\"freeTextAnnotation\");\n\n    if (this.textContent) {\n      const content = document.createElement(\"div\");\n      content.classList.add(\"annotationTextContent\");\n      content.setAttribute(\"role\", \"comment\");\n\n      for (const line of this.textContent) {\n        const lineSpan = document.createElement(\"span\");\n        lineSpan.textContent = line;\n        content.append(lineSpan);\n      }\n\n      this.container.append(content);\n    }\n\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this._editOnDoubleClick();\n\n    return this.container;\n  }\n\n}\n\nclass LineAnnotationElement extends AnnotationElement {\n  #line = null;\n\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"lineAnnotation\");\n    const data = this.data;\n    const {\n      width,\n      height\n    } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(width, height, true);\n    const line = this.#line = this.svgFactory.createElement(\"svg:line\");\n    line.setAttribute(\"x1\", data.rect[2] - data.lineCoordinates[0]);\n    line.setAttribute(\"y1\", data.rect[3] - data.lineCoordinates[1]);\n    line.setAttribute(\"x2\", data.rect[2] - data.lineCoordinates[2]);\n    line.setAttribute(\"y2\", data.rect[3] - data.lineCoordinates[3]);\n    line.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n    line.setAttribute(\"stroke\", \"transparent\");\n    line.setAttribute(\"fill\", \"transparent\");\n    svg.append(line);\n    this.container.append(svg);\n\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#line;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n\n}\n\nclass SquareAnnotationElement extends AnnotationElement {\n  #square = null;\n\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"squareAnnotation\");\n    const data = this.data;\n    const {\n      width,\n      height\n    } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(width, height, true);\n    const borderWidth = data.borderStyle.width;\n    const square = this.#square = this.svgFactory.createElement(\"svg:rect\");\n    square.setAttribute(\"x\", borderWidth / 2);\n    square.setAttribute(\"y\", borderWidth / 2);\n    square.setAttribute(\"width\", width - borderWidth);\n    square.setAttribute(\"height\", height - borderWidth);\n    square.setAttribute(\"stroke-width\", borderWidth || 1);\n    square.setAttribute(\"stroke\", \"transparent\");\n    square.setAttribute(\"fill\", \"transparent\");\n    svg.append(square);\n    this.container.append(svg);\n\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#square;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n\n}\n\nclass CircleAnnotationElement extends AnnotationElement {\n  #circle = null;\n\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"circleAnnotation\");\n    const data = this.data;\n    const {\n      width,\n      height\n    } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(width, height, true);\n    const borderWidth = data.borderStyle.width;\n    const circle = this.#circle = this.svgFactory.createElement(\"svg:ellipse\");\n    circle.setAttribute(\"cx\", width / 2);\n    circle.setAttribute(\"cy\", height / 2);\n    circle.setAttribute(\"rx\", width / 2 - borderWidth / 2);\n    circle.setAttribute(\"ry\", height / 2 - borderWidth / 2);\n    circle.setAttribute(\"stroke-width\", borderWidth || 1);\n    circle.setAttribute(\"stroke\", \"transparent\");\n    circle.setAttribute(\"fill\", \"transparent\");\n    svg.append(circle);\n    this.container.append(svg);\n\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#circle;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n\n}\n\nclass PolylineAnnotationElement extends AnnotationElement {\n  #polyline = null;\n\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n    this.containerClassName = \"polylineAnnotation\";\n    this.svgElementName = \"svg:polyline\";\n  }\n\n  render() {\n    this.container.classList.add(this.containerClassName);\n    const {\n      data: {\n        rect,\n        vertices,\n        borderStyle,\n        popupRef\n      }\n    } = this;\n\n    if (!vertices) {\n      return this.container;\n    }\n\n    const {\n      width,\n      height\n    } = getRectDims(rect);\n    const svg = this.svgFactory.create(width, height, true);\n    let points = [];\n\n    for (let i = 0, ii = vertices.length; i < ii; i += 2) {\n      const x = vertices[i] - rect[0];\n      const y = rect[3] - vertices[i + 1];\n      points.push(`${x},${y}`);\n    }\n\n    points = points.join(\" \");\n    const polyline = this.#polyline = this.svgFactory.createElement(this.svgElementName);\n    polyline.setAttribute(\"points\", points);\n    polyline.setAttribute(\"stroke-width\", borderStyle.width || 1);\n    polyline.setAttribute(\"stroke\", \"transparent\");\n    polyline.setAttribute(\"fill\", \"transparent\");\n    svg.append(polyline);\n    this.container.append(svg);\n\n    if (!popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#polyline;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n\n}\n\nclass PolygonAnnotationElement extends PolylineAnnotationElement {\n  constructor(parameters) {\n    super(parameters);\n    this.containerClassName = \"polygonAnnotation\";\n    this.svgElementName = \"svg:polygon\";\n  }\n\n}\n\nclass CaretAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"caretAnnotation\");\n\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n}\n\nclass InkAnnotationElement extends AnnotationElement {\n  #polylines = [];\n\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n    this.containerClassName = \"inkAnnotation\";\n    this.svgElementName = \"svg:polyline\";\n    this.annotationEditorType = AnnotationEditorType.INK;\n  }\n\n  render() {\n    this.container.classList.add(this.containerClassName);\n    const {\n      data: {\n        rect,\n        inkLists,\n        borderStyle,\n        popupRef\n      }\n    } = this;\n    const {\n      width,\n      height\n    } = getRectDims(rect);\n    const svg = this.svgFactory.create(width, height, true);\n\n    for (const inkList of inkLists) {\n      let points = [];\n\n      for (let i = 0, ii = inkList.length; i < ii; i += 2) {\n        const x = inkList[i] - rect[0];\n        const y = rect[3] - inkList[i + 1];\n        points.push(`${x},${y}`);\n      }\n\n      points = points.join(\" \");\n      const polyline = this.svgFactory.createElement(this.svgElementName);\n      this.#polylines.push(polyline);\n      polyline.setAttribute(\"points\", points);\n      polyline.setAttribute(\"stroke-width\", borderStyle.width || 1);\n      polyline.setAttribute(\"stroke\", \"transparent\");\n      polyline.setAttribute(\"fill\", \"transparent\");\n\n      if (!popupRef && this.hasPopupData) {\n        this._createPopup();\n      }\n\n      svg.append(polyline);\n    }\n\n    this.container.append(svg);\n    return this.container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#polylines;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n\n}\n\nclass HighlightAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.classList.add(\"highlightAnnotation\");\n    return this.container;\n  }\n\n}\n\nclass UnderlineAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.classList.add(\"underlineAnnotation\");\n    return this.container;\n  }\n\n}\n\nclass SquigglyAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.classList.add(\"squigglyAnnotation\");\n    return this.container;\n  }\n\n}\n\nclass StrikeOutAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true\n    });\n  }\n\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    this.container.classList.add(\"strikeoutAnnotation\");\n    return this.container;\n  }\n\n}\n\nclass StampAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"stampAnnotation\");\n\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n\n    return this.container;\n  }\n\n}\n\nclass FileAttachmentAnnotationElement extends AnnotationElement {\n  #trigger = null;\n\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true\n    });\n    const {\n      file\n    } = this.data;\n    this.filename = file.filename;\n    this.content = file.content;\n    this.linkService.eventBus?.dispatch(\"fileattachmentannotation\", {\n      source: this,\n      ...file\n    });\n  }\n\n  render() {\n    this.container.classList.add(\"fileAttachmentAnnotation\");\n    const {\n      container,\n      data\n    } = this;\n    let trigger;\n\n    if (data.hasAppearance || data.fillAlpha === 0) {\n      trigger = document.createElement(\"div\");\n    } else {\n      trigger = document.createElement(\"img\");\n      trigger.src = `${this.imageResourcesPath}annotation-${/paperclip/i.test(data.name) ? \"paperclip\" : \"pushpin\"}.svg`;\n\n      if (data.fillAlpha && data.fillAlpha < 1) {\n        trigger.style = `filter: opacity(${Math.round(data.fillAlpha * 100)}%);`;\n      }\n    }\n\n    trigger.addEventListener(\"dblclick\", this.#download.bind(this));\n    this.#trigger = trigger;\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n    container.addEventListener(\"keydown\", evt => {\n      if (evt.key === \"Enter\" && (isMac ? evt.metaKey : evt.ctrlKey)) {\n        this.#download();\n      }\n    });\n\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    } else {\n      trigger.classList.add(\"popupTriggerArea\");\n    }\n\n    container.append(trigger);\n    return container;\n  }\n\n  getElementsToTriggerPopup() {\n    return this.#trigger;\n  }\n\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n\n  #download() {\n    this.downloadManager?.openOrDownloadData(this.content, this.filename);\n  }\n\n}\n\nclass AnnotationLayer {\n  #accessibilityManager = null;\n  #annotationCanvasMap = null;\n  #editableAnnotations = new Map();\n\n  constructor({\n    div,\n    accessibilityManager,\n    annotationCanvasMap,\n    annotationEditorUIManager,\n    page,\n    viewport\n  }) {\n    this.div = div;\n    this.#accessibilityManager = accessibilityManager;\n    this.#annotationCanvasMap = annotationCanvasMap;\n    this.page = page;\n    this.viewport = viewport;\n    this.zIndex = 0;\n    this._annotationEditorUIManager = annotationEditorUIManager;\n  }\n\n  hasEditableAnnotations() {\n    return this.#editableAnnotations.size > 0;\n  }\n\n  #appendElement(element, id) {\n    const contentElement = element.firstChild || element;\n    contentElement.id = `${AnnotationPrefix}${id}`;\n    this.div.append(element);\n    this.#accessibilityManager?.moveElementInDOM(this.div, element, contentElement, false);\n  }\n\n  render(params) {\n    var _this30 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        annotations\n      } = params;\n      const layer = _this30.div;\n      setLayerDimensions(layer, _this30.viewport);\n      const popupToElements = new Map();\n      const elementParams = {\n        data: null,\n        layer,\n        linkService: params.linkService,\n        downloadManager: params.downloadManager,\n        imageResourcesPath: params.imageResourcesPath || \"\",\n        renderForms: params.renderForms !== false,\n        svgFactory: new DOMSVGFactory(),\n        annotationStorage: params.annotationStorage || new AnnotationStorage(),\n        enableScripting: params.enableScripting === true,\n        hasJSActions: params.hasJSActions,\n        fieldObjects: params.fieldObjects,\n        parent: _this30,\n        elements: null\n      };\n\n      for (const data of annotations) {\n        if (data.noHTML) {\n          continue;\n        }\n\n        const isPopupAnnotation = data.annotationType === AnnotationType.POPUP;\n\n        if (!isPopupAnnotation) {\n          const {\n            width,\n            height\n          } = getRectDims(data.rect);\n\n          if (width <= 0 || height <= 0) {\n            continue;\n          }\n        } else {\n          const elements = popupToElements.get(data.id);\n\n          if (!elements) {\n            continue;\n          }\n\n          elementParams.elements = elements;\n        }\n\n        elementParams.data = data;\n        const element = AnnotationElementFactory.create(elementParams);\n\n        if (!element.isRenderable) {\n          continue;\n        }\n\n        if (!isPopupAnnotation && data.popupRef) {\n          const elements = popupToElements.get(data.popupRef);\n\n          if (!elements) {\n            popupToElements.set(data.popupRef, [element]);\n          } else {\n            elements.push(element);\n          }\n        }\n\n        const rendered = element.render();\n\n        if (data.hidden) {\n          rendered.style.visibility = \"hidden\";\n        }\n\n        _this30.#appendElement(rendered, data.id);\n\n        if (element._isEditable) {\n          _this30.#editableAnnotations.set(element.data.id, element);\n\n          _this30._annotationEditorUIManager?.renderAnnotationElement(element);\n        }\n      }\n\n      _this30.#setAnnotationCanvasMap();\n    })();\n  }\n\n  update({\n    viewport\n  }) {\n    const layer = this.div;\n    this.viewport = viewport;\n    setLayerDimensions(layer, {\n      rotation: viewport.rotation\n    });\n    this.#setAnnotationCanvasMap();\n    layer.hidden = false;\n  }\n\n  #setAnnotationCanvasMap() {\n    if (!this.#annotationCanvasMap) {\n      return;\n    }\n\n    const layer = this.div;\n\n    for (const [id, canvas] of this.#annotationCanvasMap) {\n      const element = layer.querySelector(`[data-annotation-id=\"${id}\"]`);\n\n      if (!element) {\n        continue;\n      }\n\n      canvas.className = \"annotationContent\";\n      const {\n        firstChild\n      } = element;\n\n      if (!firstChild) {\n        element.append(canvas);\n      } else if (firstChild.nodeName === \"CANVAS\") {\n        firstChild.replaceWith(canvas);\n      } else if (!firstChild.classList.contains(\"annotationContent\")) {\n        firstChild.before(canvas);\n      } else {\n        firstChild.after(canvas);\n      }\n    }\n\n    this.#annotationCanvasMap.clear();\n  }\n\n  getEditableAnnotations() {\n    return Array.from(this.#editableAnnotations.values());\n  }\n\n  getEditableAnnotation(id) {\n    return this.#editableAnnotations.get(id);\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/freetext.js\n\nconst EOL_PATTERN = /\\r\\n?|\\n/g;\n\nclass FreeTextEditor extends AnnotationEditor {\n  #color;\n  #content = \"\";\n  #editorDivId = `${this.id}-editor`;\n  #editModeAC = null;\n  #fontSize;\n  #initialData = null;\n  static _freeTextDefaultContent = \"\";\n  static _internalPadding = 0;\n  static _defaultColor = null;\n  static _defaultFontSize = 10;\n\n  static get _keyboardManager() {\n    const proto = FreeTextEditor.prototype;\n\n    const arrowChecker = self => self.isEmpty();\n\n    const small = AnnotationEditorUIManager.TRANSLATE_SMALL;\n    const big = AnnotationEditorUIManager.TRANSLATE_BIG;\n    return shadow(this, \"_keyboardManager\", new KeyboardManager([[[\"ctrl+s\", \"mac+meta+s\", \"ctrl+p\", \"mac+meta+p\"], proto.commitOrRemove, {\n      bubbles: true\n    }], [[\"ctrl+Enter\", \"mac+meta+Enter\", \"Escape\", \"mac+Escape\"], proto.commitOrRemove], [[\"ArrowLeft\", \"mac+ArrowLeft\"], proto._translateEmpty, {\n      args: [-small, 0],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"], proto._translateEmpty, {\n      args: [-big, 0],\n      checker: arrowChecker\n    }], [[\"ArrowRight\", \"mac+ArrowRight\"], proto._translateEmpty, {\n      args: [small, 0],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"], proto._translateEmpty, {\n      args: [big, 0],\n      checker: arrowChecker\n    }], [[\"ArrowUp\", \"mac+ArrowUp\"], proto._translateEmpty, {\n      args: [0, -small],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], proto._translateEmpty, {\n      args: [0, -big],\n      checker: arrowChecker\n    }], [[\"ArrowDown\", \"mac+ArrowDown\"], proto._translateEmpty, {\n      args: [0, small],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], proto._translateEmpty, {\n      args: [0, big],\n      checker: arrowChecker\n    }]]));\n  }\n\n  static _type = \"freetext\";\n  static _editorType = AnnotationEditorType.FREETEXT;\n\n  constructor(params) {\n    super({ ...params,\n      name: \"freeTextEditor\"\n    });\n    this.#color = params.color || FreeTextEditor._defaultColor || AnnotationEditor._defaultLineColor;\n    this.#fontSize = params.fontSize || FreeTextEditor._defaultFontSize;\n  }\n\n  static initialize(l10n, uiManager) {\n    AnnotationEditor.initialize(l10n, uiManager, {\n      strings: [\"pdfjs-free-text-default-content\"]\n    });\n    const style = getComputedStyle(document.documentElement);\n    this._internalPadding = parseFloat(style.getPropertyValue(\"--freetext-padding\"));\n  }\n\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.FREETEXT_SIZE:\n        FreeTextEditor._defaultFontSize = value;\n        break;\n\n      case AnnotationEditorParamsType.FREETEXT_COLOR:\n        FreeTextEditor._defaultColor = value;\n        break;\n    }\n  }\n\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.FREETEXT_SIZE:\n        this.#updateFontSize(value);\n        break;\n\n      case AnnotationEditorParamsType.FREETEXT_COLOR:\n        this.#updateColor(value);\n        break;\n    }\n  }\n\n  static get defaultPropertiesToUpdate() {\n    return [[AnnotationEditorParamsType.FREETEXT_SIZE, FreeTextEditor._defaultFontSize], [AnnotationEditorParamsType.FREETEXT_COLOR, FreeTextEditor._defaultColor || AnnotationEditor._defaultLineColor]];\n  }\n\n  get propertiesToUpdate() {\n    return [[AnnotationEditorParamsType.FREETEXT_SIZE, this.#fontSize], [AnnotationEditorParamsType.FREETEXT_COLOR, this.#color]];\n  }\n\n  #updateFontSize(fontSize) {\n    const setFontsize = size => {\n      this.editorDiv.style.fontSize = `calc(${size}px * var(--scale-factor))`;\n      this.translate(0, -(size - this.#fontSize) * this.parentScale);\n      this.#fontSize = size;\n      this.#setEditorDimensions();\n    };\n\n    const savedFontsize = this.#fontSize;\n    this.addCommands({\n      cmd: setFontsize.bind(this, fontSize),\n      undo: setFontsize.bind(this, savedFontsize),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.FREETEXT_SIZE,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n\n  #updateColor(color) {\n    const setColor = col => {\n      this.#color = this.editorDiv.style.color = col;\n    };\n\n    const savedColor = this.#color;\n    this.addCommands({\n      cmd: setColor.bind(this, color),\n      undo: setColor.bind(this, savedColor),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.FREETEXT_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n\n  _translateEmpty(x, y) {\n    this._uiManager.translateSelectedEditors(x, y, true);\n  }\n\n  getInitialTranslation() {\n    const scale = this.parentScale;\n    return [-FreeTextEditor._internalPadding * scale, -(FreeTextEditor._internalPadding + this.#fontSize) * scale];\n  }\n\n  rebuild() {\n    if (!this.parent) {\n      return;\n    }\n\n    super.rebuild();\n\n    if (this.div === null) {\n      return;\n    }\n\n    if (!this.isAttachedToDOM) {\n      this.parent.add(this);\n    }\n  }\n\n  enableEditMode() {\n    if (this.isInEditMode()) {\n      return;\n    }\n\n    this.parent.setEditingState(false);\n    this.parent.updateToolbar(AnnotationEditorType.FREETEXT);\n    super.enableEditMode();\n    this.overlayDiv.classList.remove(\"enabled\");\n    this.editorDiv.contentEditable = true;\n    this._isDraggable = false;\n    this.div.removeAttribute(\"aria-activedescendant\");\n    this.#editModeAC = new AbortController();\n\n    const signal = this._uiManager.combinedSignal(this.#editModeAC);\n\n    this.editorDiv.addEventListener(\"keydown\", this.editorDivKeydown.bind(this), {\n      signal\n    });\n    this.editorDiv.addEventListener(\"focus\", this.editorDivFocus.bind(this), {\n      signal\n    });\n    this.editorDiv.addEventListener(\"blur\", this.editorDivBlur.bind(this), {\n      signal\n    });\n    this.editorDiv.addEventListener(\"input\", this.editorDivInput.bind(this), {\n      signal\n    });\n    this.editorDiv.addEventListener(\"paste\", this.editorDivPaste.bind(this), {\n      signal\n    });\n  }\n\n  disableEditMode() {\n    if (!this.isInEditMode()) {\n      return;\n    }\n\n    this.parent.setEditingState(true);\n    super.disableEditMode();\n    this.overlayDiv.classList.add(\"enabled\");\n    this.editorDiv.contentEditable = false;\n    this.div.setAttribute(\"aria-activedescendant\", this.#editorDivId);\n    this._isDraggable = true;\n    this.#editModeAC?.abort();\n    this.#editModeAC = null;\n    this.div.focus({\n      preventScroll: true\n    });\n    this.isEditing = false;\n    this.parent.div.classList.add(\"freetextEditing\");\n  }\n\n  focusin(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n\n    super.focusin(event);\n\n    if (event.target !== this.editorDiv) {\n      this.editorDiv.focus();\n    }\n  }\n\n  onceAdded() {\n    if (this.width) {\n      return;\n    }\n\n    this.enableEditMode();\n    this.editorDiv.focus();\n\n    if (this._initialOptions?.isCentered) {\n      this.center();\n    }\n\n    this._initialOptions = null;\n  }\n\n  isEmpty() {\n    return !this.editorDiv || this.editorDiv.innerText.trim() === \"\";\n  }\n\n  remove() {\n    this.isEditing = false;\n\n    if (this.parent) {\n      this.parent.setEditingState(true);\n      this.parent.div.classList.add(\"freetextEditing\");\n    }\n\n    super.remove();\n  }\n\n  #extractText() {\n    const buffer = [];\n    this.editorDiv.normalize();\n\n    for (const child of this.editorDiv.childNodes) {\n      buffer.push(FreeTextEditor.#getNodeContent(child));\n    }\n\n    return buffer.join(\"\\n\");\n  }\n\n  #setEditorDimensions() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    let rect;\n\n    if (this.isAttachedToDOM) {\n      rect = this.div.getBoundingClientRect();\n    } else {\n      const {\n        currentLayer,\n        div\n      } = this;\n      const savedDisplay = div.style.display;\n      const savedVisibility = div.classList.contains(\"hidden\");\n      div.classList.remove(\"hidden\");\n      div.style.display = \"hidden\";\n      currentLayer.div.append(this.div);\n      rect = div.getBoundingClientRect();\n      div.remove();\n      div.style.display = savedDisplay;\n      div.classList.toggle(\"hidden\", savedVisibility);\n    }\n\n    if (this.rotation % 180 === this.parentRotation % 180) {\n      this.width = rect.width / parentWidth;\n      this.height = rect.height / parentHeight;\n    } else {\n      this.width = rect.height / parentWidth;\n      this.height = rect.width / parentHeight;\n    }\n\n    this.fixAndSetPosition();\n  }\n\n  commit() {\n    if (!this.isInEditMode()) {\n      return;\n    }\n\n    super.commit();\n    this.disableEditMode();\n    const savedText = this.#content;\n    const newText = this.#content = this.#extractText().trimEnd();\n\n    if (savedText === newText) {\n      return;\n    }\n\n    const setText = text => {\n      this.#content = text;\n\n      if (!text) {\n        this.remove();\n        return;\n      }\n\n      this.#setContent();\n\n      this._uiManager.rebuild(this);\n\n      this.#setEditorDimensions();\n    };\n\n    this.addCommands({\n      cmd: () => {\n        setText(newText);\n      },\n      undo: () => {\n        setText(savedText);\n      },\n      mustExec: false\n    });\n    this.#setEditorDimensions();\n  }\n\n  shouldGetKeyboardEvents() {\n    return this.isInEditMode();\n  }\n\n  enterInEditMode() {\n    this.enableEditMode();\n    this.editorDiv.focus();\n  }\n\n  dblclick(event) {\n    this.enterInEditMode();\n  }\n\n  keydown(event) {\n    if (event.target === this.div && event.key === \"Enter\") {\n      this.enterInEditMode();\n      event.preventDefault();\n    }\n  }\n\n  editorDivKeydown(event) {\n    FreeTextEditor._keyboardManager.exec(this, event);\n  }\n\n  editorDivFocus(event) {\n    this.isEditing = true;\n  }\n\n  editorDivBlur(event) {\n    this.isEditing = false;\n  }\n\n  editorDivInput(event) {\n    this.parent.div.classList.toggle(\"freetextEditing\", this.isEmpty());\n  }\n\n  disableEditing() {\n    this.editorDiv.setAttribute(\"role\", \"comment\");\n    this.editorDiv.removeAttribute(\"aria-multiline\");\n  }\n\n  enableEditing() {\n    this.editorDiv.setAttribute(\"role\", \"textbox\");\n    this.editorDiv.setAttribute(\"aria-multiline\", true);\n  }\n\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n\n    let baseX, baseY;\n\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n\n    super.render();\n    this.editorDiv = document.createElement(\"div\");\n    this.editorDiv.className = \"internal\";\n    this.editorDiv.setAttribute(\"id\", this.#editorDivId);\n    this.editorDiv.setAttribute(\"data-l10n-id\", \"pdfjs-free-text\");\n    this.enableEditing();\n\n    AnnotationEditor._l10nPromise.get(\"pdfjs-free-text-default-content\").then(msg => this.editorDiv?.setAttribute(\"default-content\", msg));\n\n    this.editorDiv.contentEditable = true;\n    const {\n      style\n    } = this.editorDiv;\n    style.fontSize = `calc(${this.#fontSize}px * var(--scale-factor))`;\n    style.color = this.#color;\n    this.div.append(this.editorDiv);\n    this.overlayDiv = document.createElement(\"div\");\n    this.overlayDiv.classList.add(\"overlay\", \"enabled\");\n    this.div.append(this.overlayDiv);\n    bindEvents(this, this.div, [\"dblclick\", \"keydown\"]);\n\n    if (this.width) {\n      const [parentWidth, parentHeight] = this.parentDimensions;\n\n      if (this.annotationElementId) {\n        const {\n          position\n        } = this.#initialData;\n        let [tx, ty] = this.getInitialTranslation();\n        [tx, ty] = this.pageTranslationToScreen(tx, ty);\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        const [pageX, pageY] = this.pageTranslation;\n        let posX, posY;\n\n        switch (this.rotation) {\n          case 0:\n            posX = baseX + (position[0] - pageX) / pageWidth;\n            posY = baseY + this.height - (position[1] - pageY) / pageHeight;\n            break;\n\n          case 90:\n            posX = baseX + (position[0] - pageX) / pageWidth;\n            posY = baseY - (position[1] - pageY) / pageHeight;\n            [tx, ty] = [ty, -tx];\n            break;\n\n          case 180:\n            posX = baseX - this.width + (position[0] - pageX) / pageWidth;\n            posY = baseY - (position[1] - pageY) / pageHeight;\n            [tx, ty] = [-tx, -ty];\n            break;\n\n          case 270:\n            posX = baseX + (position[0] - pageX - this.height * pageHeight) / pageWidth;\n            posY = baseY + (position[1] - pageY - this.width * pageWidth) / pageHeight;\n            [tx, ty] = [-ty, tx];\n            break;\n        }\n\n        this.setAt(posX * parentWidth, posY * parentHeight, tx, ty);\n      } else {\n        this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n      }\n\n      this.#setContent();\n      this._isDraggable = true;\n      this.editorDiv.contentEditable = false;\n    } else {\n      this._isDraggable = false;\n      this.editorDiv.contentEditable = true;\n    }\n\n    return this.div;\n  }\n\n  static #getNodeContent(node) {\n    return (node.nodeType === Node.TEXT_NODE ? node.nodeValue : node.innerText).replaceAll(EOL_PATTERN, \"\");\n  }\n\n  editorDivPaste(event) {\n    const clipboardData = event.clipboardData || window.clipboardData;\n    const {\n      types\n    } = clipboardData;\n\n    if (types.length === 1 && types[0] === \"text/plain\") {\n      return;\n    }\n\n    event.preventDefault();\n    const paste = FreeTextEditor.#deserializeContent(clipboardData.getData(\"text\") || \"\").replaceAll(EOL_PATTERN, \"\\n\");\n\n    if (!paste) {\n      return;\n    }\n\n    const selection = window.getSelection();\n\n    if (!selection.rangeCount) {\n      return;\n    }\n\n    this.editorDiv.normalize();\n    selection.deleteFromDocument();\n    const range = selection.getRangeAt(0);\n\n    if (!paste.includes(\"\\n\")) {\n      range.insertNode(document.createTextNode(paste));\n      this.editorDiv.normalize();\n      selection.collapseToStart();\n      return;\n    }\n\n    const {\n      startContainer,\n      startOffset\n    } = range;\n    const bufferBefore = [];\n    const bufferAfter = [];\n\n    if (startContainer.nodeType === Node.TEXT_NODE) {\n      const parent = startContainer.parentElement;\n      bufferAfter.push(startContainer.nodeValue.slice(startOffset).replaceAll(EOL_PATTERN, \"\"));\n\n      if (parent !== this.editorDiv) {\n        let buffer = bufferBefore;\n\n        for (const child of this.editorDiv.childNodes) {\n          if (child === parent) {\n            buffer = bufferAfter;\n            continue;\n          }\n\n          buffer.push(FreeTextEditor.#getNodeContent(child));\n        }\n      }\n\n      bufferBefore.push(startContainer.nodeValue.slice(0, startOffset).replaceAll(EOL_PATTERN, \"\"));\n    } else if (startContainer === this.editorDiv) {\n      let buffer = bufferBefore;\n      let i = 0;\n\n      for (const child of this.editorDiv.childNodes) {\n        if (i++ === startOffset) {\n          buffer = bufferAfter;\n        }\n\n        buffer.push(FreeTextEditor.#getNodeContent(child));\n      }\n    }\n\n    this.#content = `${bufferBefore.join(\"\\n\")}${paste}${bufferAfter.join(\"\\n\")}`;\n    this.#setContent();\n    const newRange = new Range();\n    let beforeLength = bufferBefore.reduce((acc, line) => acc + line.length, 0);\n\n    for (const {\n      firstChild\n    } of this.editorDiv.childNodes) {\n      if (firstChild.nodeType === Node.TEXT_NODE) {\n        const length = firstChild.nodeValue.length;\n\n        if (beforeLength <= length) {\n          newRange.setStart(firstChild, beforeLength);\n          newRange.setEnd(firstChild, beforeLength);\n          break;\n        }\n\n        beforeLength -= length;\n      }\n    }\n\n    selection.removeAllRanges();\n    selection.addRange(newRange);\n  }\n\n  #setContent() {\n    this.editorDiv.replaceChildren();\n\n    if (!this.#content) {\n      return;\n    }\n\n    for (const line of this.#content.split(\"\\n\")) {\n      const div = document.createElement(\"div\");\n      div.append(line ? document.createTextNode(line) : document.createElement(\"br\"));\n      this.editorDiv.append(div);\n    }\n  }\n\n  #serializeContent() {\n    return this.#content.replaceAll(\"\\xa0\", \" \");\n  }\n\n  static #deserializeContent(content) {\n    return content.replaceAll(\" \", \"\\xa0\");\n  }\n\n  get contentDiv() {\n    return this.editorDiv;\n  }\n\n  static deserialize(data, parent, uiManager) {\n    let initialData = null;\n\n    if (data instanceof FreeTextAnnotationElement) {\n      const {\n        data: {\n          defaultAppearanceData: {\n            fontSize,\n            fontColor\n          },\n          rect,\n          rotation,\n          id\n        },\n        textContent,\n        textPosition,\n        parent: {\n          page: {\n            pageNumber\n          }\n        }\n      } = data;\n\n      if (!textContent || textContent.length === 0) {\n        return null;\n      }\n\n      initialData = data = {\n        annotationType: AnnotationEditorType.FREETEXT,\n        color: Array.from(fontColor),\n        fontSize,\n        value: textContent.join(\"\\n\"),\n        position: textPosition,\n        pageIndex: pageNumber - 1,\n        rect: rect.slice(0),\n        rotation,\n        id,\n        deleted: false\n      };\n    }\n\n    const editor = super.deserialize(data, parent, uiManager);\n    editor.#fontSize = data.fontSize;\n    editor.#color = Util.makeHexColor(...data.color);\n    editor.#content = FreeTextEditor.#deserializeContent(data.value);\n    editor.annotationElementId = data.id || null;\n    editor.#initialData = initialData;\n    return editor;\n  }\n\n  serialize(isForCopying = false) {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    if (this.deleted) {\n      return {\n        pageIndex: this.pageIndex,\n        id: this.annotationElementId,\n        deleted: true\n      };\n    }\n\n    const padding = FreeTextEditor._internalPadding * this.parentScale;\n    const rect = this.getRect(padding, padding);\n\n    const color = AnnotationEditor._colorManager.convert(this.isAttachedToDOM ? getComputedStyle(this.editorDiv).color : this.#color);\n\n    const serialized = {\n      annotationType: AnnotationEditorType.FREETEXT,\n      color,\n      fontSize: this.#fontSize,\n      value: this.#serializeContent(),\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.rotation,\n      structTreeParentId: this._structTreeParentId\n    };\n\n    if (isForCopying) {\n      return serialized;\n    }\n\n    if (this.annotationElementId && !this.#hasElementChanged(serialized)) {\n      return null;\n    }\n\n    serialized.id = this.annotationElementId;\n    return serialized;\n  }\n\n  #hasElementChanged(serialized) {\n    const {\n      value,\n      fontSize,\n      color,\n      pageIndex\n    } = this.#initialData;\n    return this._hasBeenMoved || serialized.value !== value || serialized.fontSize !== fontSize || serialized.color.some((c, i) => c !== color[i]) || serialized.pageIndex !== pageIndex;\n  }\n\n  renderAnnotationElement(annotation) {\n    const content = super.renderAnnotationElement(annotation);\n\n    if (this.deleted) {\n      return content;\n    }\n\n    const {\n      style\n    } = content;\n    style.fontSize = `calc(${this.#fontSize}px * var(--scale-factor))`;\n    style.color = this.#color;\n    content.replaceChildren();\n\n    for (const line of this.#content.split(\"\\n\")) {\n      const div = document.createElement(\"div\");\n      div.append(line ? document.createTextNode(line) : document.createElement(\"br\"));\n      content.append(div);\n    }\n\n    const padding = FreeTextEditor._internalPadding * this.parentScale;\n    annotation.updateEdited({\n      rect: this.getRect(padding, padding),\n      popupContent: this.#content\n    });\n    return content;\n  }\n\n  resetAnnotationElement(annotation) {\n    super.resetAnnotationElement(annotation);\n    annotation.resetEdited();\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/outliner.js\n\nclass Outliner {\n  #box;\n  #verticalEdges = [];\n  #intervals = [];\n\n  constructor(boxes, borderWidth = 0, innerMargin = 0, isLTR = true) {\n    let minX = Infinity;\n    let maxX = -Infinity;\n    let minY = Infinity;\n    let maxY = -Infinity;\n    const NUMBER_OF_DIGITS = 4;\n    const EPSILON = 10 ** -NUMBER_OF_DIGITS;\n\n    for (const {\n      x,\n      y,\n      width,\n      height\n    } of boxes) {\n      const x1 = Math.floor((x - borderWidth) / EPSILON) * EPSILON;\n      const x2 = Math.ceil((x + width + borderWidth) / EPSILON) * EPSILON;\n      const y1 = Math.floor((y - borderWidth) / EPSILON) * EPSILON;\n      const y2 = Math.ceil((y + height + borderWidth) / EPSILON) * EPSILON;\n      const left = [x1, y1, y2, true];\n      const right = [x2, y1, y2, false];\n      this.#verticalEdges.push(left, right);\n      minX = Math.min(minX, x1);\n      maxX = Math.max(maxX, x2);\n      minY = Math.min(minY, y1);\n      maxY = Math.max(maxY, y2);\n    }\n\n    const bboxWidth = maxX - minX + 2 * innerMargin;\n    const bboxHeight = maxY - minY + 2 * innerMargin;\n    const shiftedMinX = minX - innerMargin;\n    const shiftedMinY = minY - innerMargin;\n    const lastEdge = this.#verticalEdges.at(isLTR ? -1 : -2);\n    const lastPoint = [lastEdge[0], lastEdge[2]];\n\n    for (const edge of this.#verticalEdges) {\n      const [x, y1, y2] = edge;\n      edge[0] = (x - shiftedMinX) / bboxWidth;\n      edge[1] = (y1 - shiftedMinY) / bboxHeight;\n      edge[2] = (y2 - shiftedMinY) / bboxHeight;\n    }\n\n    this.#box = {\n      x: shiftedMinX,\n      y: shiftedMinY,\n      width: bboxWidth,\n      height: bboxHeight,\n      lastPoint\n    };\n  }\n\n  getOutlines() {\n    this.#verticalEdges.sort((a, b) => a[0] - b[0] || a[1] - b[1] || a[2] - b[2]);\n    const outlineVerticalEdges = [];\n\n    for (const edge of this.#verticalEdges) {\n      if (edge[3]) {\n        outlineVerticalEdges.push(...this.#breakEdge(edge));\n        this.#insert(edge);\n      } else {\n        this.#remove(edge);\n        outlineVerticalEdges.push(...this.#breakEdge(edge));\n      }\n    }\n\n    return this.#getOutlines(outlineVerticalEdges);\n  }\n\n  #getOutlines(outlineVerticalEdges) {\n    const edges = [];\n    const allEdges = new Set();\n\n    for (const edge of outlineVerticalEdges) {\n      const [x, y1, y2] = edge;\n      edges.push([x, y1, edge], [x, y2, edge]);\n    }\n\n    edges.sort((a, b) => a[1] - b[1] || a[0] - b[0]);\n\n    for (let i = 0, ii = edges.length; i < ii; i += 2) {\n      const edge1 = edges[i][2];\n      const edge2 = edges[i + 1][2];\n      edge1.push(edge2);\n      edge2.push(edge1);\n      allEdges.add(edge1);\n      allEdges.add(edge2);\n    }\n\n    const outlines = [];\n    let outline;\n\n    while (allEdges.size > 0) {\n      const edge = allEdges.values().next().value;\n      let [x, y1, y2, edge1, edge2] = edge;\n      allEdges.delete(edge);\n      let lastPointX = x;\n      let lastPointY = y1;\n      outline = [x, y2];\n      outlines.push(outline);\n\n      while (true) {\n        let e;\n\n        if (allEdges.has(edge1)) {\n          e = edge1;\n        } else if (allEdges.has(edge2)) {\n          e = edge2;\n        } else {\n          break;\n        }\n\n        allEdges.delete(e);\n        [x, y1, y2, edge1, edge2] = e;\n\n        if (lastPointX !== x) {\n          outline.push(lastPointX, lastPointY, x, lastPointY === y1 ? y1 : y2);\n          lastPointX = x;\n        }\n\n        lastPointY = lastPointY === y1 ? y2 : y1;\n      }\n\n      outline.push(lastPointX, lastPointY);\n    }\n\n    return new HighlightOutline(outlines, this.#box);\n  }\n\n  #binarySearch(y) {\n    const array = this.#intervals;\n    let start = 0;\n    let end = array.length - 1;\n\n    while (start <= end) {\n      const middle = start + end >> 1;\n      const y1 = array[middle][0];\n\n      if (y1 === y) {\n        return middle;\n      }\n\n      if (y1 < y) {\n        start = middle + 1;\n      } else {\n        end = middle - 1;\n      }\n    }\n\n    return end + 1;\n  }\n\n  #insert([, y1, y2]) {\n    const index = this.#binarySearch(y1);\n    this.#intervals.splice(index, 0, [y1, y2]);\n  }\n\n  #remove([, y1, y2]) {\n    const index = this.#binarySearch(y1);\n\n    for (let i = index; i < this.#intervals.length; i++) {\n      const [start, end] = this.#intervals[i];\n\n      if (start !== y1) {\n        break;\n      }\n\n      if (start === y1 && end === y2) {\n        this.#intervals.splice(i, 1);\n        return;\n      }\n    }\n\n    for (let i = index - 1; i >= 0; i--) {\n      const [start, end] = this.#intervals[i];\n\n      if (start !== y1) {\n        break;\n      }\n\n      if (start === y1 && end === y2) {\n        this.#intervals.splice(i, 1);\n        return;\n      }\n    }\n  }\n\n  #breakEdge(edge) {\n    const [x, y1, y2] = edge;\n    const results = [[x, y1, y2]];\n    const index = this.#binarySearch(y2);\n\n    for (let i = 0; i < index; i++) {\n      const [start, end] = this.#intervals[i];\n\n      for (let j = 0, jj = results.length; j < jj; j++) {\n        const [, y3, y4] = results[j];\n\n        if (end <= y3 || y4 <= start) {\n          continue;\n        }\n\n        if (y3 >= start) {\n          if (y4 > end) {\n            results[j][1] = end;\n          } else {\n            if (jj === 1) {\n              return [];\n            }\n\n            results.splice(j, 1);\n            j--;\n            jj--;\n          }\n\n          continue;\n        }\n\n        results[j][2] = start;\n\n        if (y4 > end) {\n          results.push([x, end, y4]);\n        }\n      }\n    }\n\n    return results;\n  }\n\n}\n\nclass Outline {\n  toSVGPath() {\n    throw new Error(\"Abstract method `toSVGPath` must be implemented.\");\n  }\n\n  get box() {\n    throw new Error(\"Abstract getter `box` must be implemented.\");\n  }\n\n  serialize(_bbox, _rotation) {\n    throw new Error(\"Abstract method `serialize` must be implemented.\");\n  }\n\n  get free() {\n    return this instanceof FreeHighlightOutline;\n  }\n\n}\n\nclass HighlightOutline extends Outline {\n  #box;\n  #outlines;\n\n  constructor(outlines, box) {\n    super();\n    this.#outlines = outlines;\n    this.#box = box;\n  }\n\n  toSVGPath() {\n    const buffer = [];\n\n    for (const polygon of this.#outlines) {\n      let [prevX, prevY] = polygon;\n      buffer.push(`M${prevX} ${prevY}`);\n\n      for (let i = 2; i < polygon.length; i += 2) {\n        const x = polygon[i];\n        const y = polygon[i + 1];\n\n        if (x === prevX) {\n          buffer.push(`V${y}`);\n          prevY = y;\n        } else if (y === prevY) {\n          buffer.push(`H${x}`);\n          prevX = x;\n        }\n      }\n\n      buffer.push(\"Z\");\n    }\n\n    return buffer.join(\" \");\n  }\n\n  serialize([blX, blY, trX, trY], _rotation) {\n    const outlines = [];\n    const width = trX - blX;\n    const height = trY - blY;\n\n    for (const outline of this.#outlines) {\n      const points = new Array(outline.length);\n\n      for (let i = 0; i < outline.length; i += 2) {\n        points[i] = blX + outline[i] * width;\n        points[i + 1] = trY - outline[i + 1] * height;\n      }\n\n      outlines.push(points);\n    }\n\n    return outlines;\n  }\n\n  get box() {\n    return this.#box;\n  }\n\n}\n\nclass FreeOutliner {\n  #box;\n  #bottom = [];\n  #innerMargin;\n  #isLTR;\n  #top = [];\n  #last = new Float64Array(18);\n  #lastX;\n  #lastY;\n  #min;\n  #min_dist;\n  #scaleFactor;\n  #thickness;\n  #points = [];\n  static #MIN_DIST = 8;\n  static #MIN_DIFF = 2;\n  static #MIN = FreeOutliner.#MIN_DIST + FreeOutliner.#MIN_DIFF;\n\n  constructor({\n    x,\n    y\n  }, box, scaleFactor, thickness, isLTR, innerMargin = 0) {\n    this.#box = box;\n    this.#thickness = thickness * scaleFactor;\n    this.#isLTR = isLTR;\n    this.#last.set([NaN, NaN, NaN, NaN, x, y], 6);\n    this.#innerMargin = innerMargin;\n    this.#min_dist = FreeOutliner.#MIN_DIST * scaleFactor;\n    this.#min = FreeOutliner.#MIN * scaleFactor;\n    this.#scaleFactor = scaleFactor;\n    this.#points.push(x, y);\n  }\n\n  get free() {\n    return true;\n  }\n\n  isEmpty() {\n    return isNaN(this.#last[8]);\n  }\n\n  #getLastCoords() {\n    const lastTop = this.#last.subarray(4, 6);\n    const lastBottom = this.#last.subarray(16, 18);\n    const [x, y, width, height] = this.#box;\n    return [(this.#lastX + (lastTop[0] - lastBottom[0]) / 2 - x) / width, (this.#lastY + (lastTop[1] - lastBottom[1]) / 2 - y) / height, (this.#lastX + (lastBottom[0] - lastTop[0]) / 2 - x) / width, (this.#lastY + (lastBottom[1] - lastTop[1]) / 2 - y) / height];\n  }\n\n  add({\n    x,\n    y\n  }) {\n    this.#lastX = x;\n    this.#lastY = y;\n    const [layerX, layerY, layerWidth, layerHeight] = this.#box;\n    let [x1, y1, x2, y2] = this.#last.subarray(8, 12);\n    const diffX = x - x2;\n    const diffY = y - y2;\n    const d = Math.hypot(diffX, diffY);\n\n    if (d < this.#min) {\n      return false;\n    }\n\n    const diffD = d - this.#min_dist;\n    const K = diffD / d;\n    const shiftX = K * diffX;\n    const shiftY = K * diffY;\n    let x0 = x1;\n    let y0 = y1;\n    x1 = x2;\n    y1 = y2;\n    x2 += shiftX;\n    y2 += shiftY;\n    this.#points?.push(x, y);\n    const nX = -shiftY / diffD;\n    const nY = shiftX / diffD;\n    const thX = nX * this.#thickness;\n    const thY = nY * this.#thickness;\n    this.#last.set(this.#last.subarray(2, 8), 0);\n    this.#last.set([x2 + thX, y2 + thY], 4);\n    this.#last.set(this.#last.subarray(14, 18), 12);\n    this.#last.set([x2 - thX, y2 - thY], 16);\n\n    if (isNaN(this.#last[6])) {\n      if (this.#top.length === 0) {\n        this.#last.set([x1 + thX, y1 + thY], 2);\n        this.#top.push(NaN, NaN, NaN, NaN, (x1 + thX - layerX) / layerWidth, (y1 + thY - layerY) / layerHeight);\n        this.#last.set([x1 - thX, y1 - thY], 14);\n        this.#bottom.push(NaN, NaN, NaN, NaN, (x1 - thX - layerX) / layerWidth, (y1 - thY - layerY) / layerHeight);\n      }\n\n      this.#last.set([x0, y0, x1, y1, x2, y2], 6);\n      return !this.isEmpty();\n    }\n\n    this.#last.set([x0, y0, x1, y1, x2, y2], 6);\n    const angle = Math.abs(Math.atan2(y0 - y1, x0 - x1) - Math.atan2(shiftY, shiftX));\n\n    if (angle < Math.PI / 2) {\n      [x1, y1, x2, y2] = this.#last.subarray(2, 6);\n      this.#top.push(NaN, NaN, NaN, NaN, ((x1 + x2) / 2 - layerX) / layerWidth, ((y1 + y2) / 2 - layerY) / layerHeight);\n      [x1, y1, x0, y0] = this.#last.subarray(14, 18);\n      this.#bottom.push(NaN, NaN, NaN, NaN, ((x0 + x1) / 2 - layerX) / layerWidth, ((y0 + y1) / 2 - layerY) / layerHeight);\n      return true;\n    }\n\n    [x0, y0, x1, y1, x2, y2] = this.#last.subarray(0, 6);\n    this.#top.push(((x0 + 5 * x1) / 6 - layerX) / layerWidth, ((y0 + 5 * y1) / 6 - layerY) / layerHeight, ((5 * x1 + x2) / 6 - layerX) / layerWidth, ((5 * y1 + y2) / 6 - layerY) / layerHeight, ((x1 + x2) / 2 - layerX) / layerWidth, ((y1 + y2) / 2 - layerY) / layerHeight);\n    [x2, y2, x1, y1, x0, y0] = this.#last.subarray(12, 18);\n    this.#bottom.push(((x0 + 5 * x1) / 6 - layerX) / layerWidth, ((y0 + 5 * y1) / 6 - layerY) / layerHeight, ((5 * x1 + x2) / 6 - layerX) / layerWidth, ((5 * y1 + y2) / 6 - layerY) / layerHeight, ((x1 + x2) / 2 - layerX) / layerWidth, ((y1 + y2) / 2 - layerY) / layerHeight);\n    return true;\n  }\n\n  toSVGPath() {\n    if (this.isEmpty()) {\n      return \"\";\n    }\n\n    const top = this.#top;\n    const bottom = this.#bottom;\n    const lastTop = this.#last.subarray(4, 6);\n    const lastBottom = this.#last.subarray(16, 18);\n    const [x, y, width, height] = this.#box;\n    const [lastTopX, lastTopY, lastBottomX, lastBottomY] = this.#getLastCoords();\n\n    if (isNaN(this.#last[6]) && !this.isEmpty()) {\n      return `M${(this.#last[2] - x) / width} ${(this.#last[3] - y) / height} L${(this.#last[4] - x) / width} ${(this.#last[5] - y) / height} L${lastTopX} ${lastTopY} L${lastBottomX} ${lastBottomY} L${(this.#last[16] - x) / width} ${(this.#last[17] - y) / height} L${(this.#last[14] - x) / width} ${(this.#last[15] - y) / height} Z`;\n    }\n\n    const buffer = [];\n    buffer.push(`M${top[4]} ${top[5]}`);\n\n    for (let i = 6; i < top.length; i += 6) {\n      if (isNaN(top[i])) {\n        buffer.push(`L${top[i + 4]} ${top[i + 5]}`);\n      } else {\n        buffer.push(`C${top[i]} ${top[i + 1]} ${top[i + 2]} ${top[i + 3]} ${top[i + 4]} ${top[i + 5]}`);\n      }\n    }\n\n    buffer.push(`L${(lastTop[0] - x) / width} ${(lastTop[1] - y) / height} L${lastTopX} ${lastTopY} L${lastBottomX} ${lastBottomY} L${(lastBottom[0] - x) / width} ${(lastBottom[1] - y) / height}`);\n\n    for (let i = bottom.length - 6; i >= 6; i -= 6) {\n      if (isNaN(bottom[i])) {\n        buffer.push(`L${bottom[i + 4]} ${bottom[i + 5]}`);\n      } else {\n        buffer.push(`C${bottom[i]} ${bottom[i + 1]} ${bottom[i + 2]} ${bottom[i + 3]} ${bottom[i + 4]} ${bottom[i + 5]}`);\n      }\n    }\n\n    buffer.push(`L${bottom[4]} ${bottom[5]} Z`);\n    return buffer.join(\" \");\n  }\n\n  getOutlines() {\n    const top = this.#top;\n    const bottom = this.#bottom;\n    const last = this.#last;\n    const lastTop = last.subarray(4, 6);\n    const lastBottom = last.subarray(16, 18);\n    const [layerX, layerY, layerWidth, layerHeight] = this.#box;\n    const points = new Float64Array((this.#points?.length ?? 0) + 2);\n\n    for (let i = 0, ii = points.length - 2; i < ii; i += 2) {\n      points[i] = (this.#points[i] - layerX) / layerWidth;\n      points[i + 1] = (this.#points[i + 1] - layerY) / layerHeight;\n    }\n\n    points[points.length - 2] = (this.#lastX - layerX) / layerWidth;\n    points[points.length - 1] = (this.#lastY - layerY) / layerHeight;\n    const [lastTopX, lastTopY, lastBottomX, lastBottomY] = this.#getLastCoords();\n\n    if (isNaN(last[6]) && !this.isEmpty()) {\n      const outline = new Float64Array(36);\n      outline.set([NaN, NaN, NaN, NaN, (last[2] - layerX) / layerWidth, (last[3] - layerY) / layerHeight, NaN, NaN, NaN, NaN, (last[4] - layerX) / layerWidth, (last[5] - layerY) / layerHeight, NaN, NaN, NaN, NaN, lastTopX, lastTopY, NaN, NaN, NaN, NaN, lastBottomX, lastBottomY, NaN, NaN, NaN, NaN, (last[16] - layerX) / layerWidth, (last[17] - layerY) / layerHeight, NaN, NaN, NaN, NaN, (last[14] - layerX) / layerWidth, (last[15] - layerY) / layerHeight], 0);\n      return new FreeHighlightOutline(outline, points, this.#box, this.#scaleFactor, this.#innerMargin, this.#isLTR);\n    }\n\n    const outline = new Float64Array(this.#top.length + 24 + this.#bottom.length);\n    let N = top.length;\n\n    for (let i = 0; i < N; i += 2) {\n      if (isNaN(top[i])) {\n        outline[i] = outline[i + 1] = NaN;\n        continue;\n      }\n\n      outline[i] = top[i];\n      outline[i + 1] = top[i + 1];\n    }\n\n    outline.set([NaN, NaN, NaN, NaN, (lastTop[0] - layerX) / layerWidth, (lastTop[1] - layerY) / layerHeight, NaN, NaN, NaN, NaN, lastTopX, lastTopY, NaN, NaN, NaN, NaN, lastBottomX, lastBottomY, NaN, NaN, NaN, NaN, (lastBottom[0] - layerX) / layerWidth, (lastBottom[1] - layerY) / layerHeight], N);\n    N += 24;\n\n    for (let i = bottom.length - 6; i >= 6; i -= 6) {\n      for (let j = 0; j < 6; j += 2) {\n        if (isNaN(bottom[i + j])) {\n          outline[N] = outline[N + 1] = NaN;\n          N += 2;\n          continue;\n        }\n\n        outline[N] = bottom[i + j];\n        outline[N + 1] = bottom[i + j + 1];\n        N += 2;\n      }\n    }\n\n    outline.set([NaN, NaN, NaN, NaN, bottom[4], bottom[5]], N);\n    return new FreeHighlightOutline(outline, points, this.#box, this.#scaleFactor, this.#innerMargin, this.#isLTR);\n  }\n\n}\n\nclass FreeHighlightOutline extends Outline {\n  #box;\n  #bbox = null;\n  #innerMargin;\n  #isLTR;\n  #points;\n  #scaleFactor;\n  #outline;\n\n  constructor(outline, points, box, scaleFactor, innerMargin, isLTR) {\n    super();\n    this.#outline = outline;\n    this.#points = points;\n    this.#box = box;\n    this.#scaleFactor = scaleFactor;\n    this.#innerMargin = innerMargin;\n    this.#isLTR = isLTR;\n    this.#computeMinMax(isLTR);\n    const {\n      x,\n      y,\n      width,\n      height\n    } = this.#bbox;\n\n    for (let i = 0, ii = outline.length; i < ii; i += 2) {\n      outline[i] = (outline[i] - x) / width;\n      outline[i + 1] = (outline[i + 1] - y) / height;\n    }\n\n    for (let i = 0, ii = points.length; i < ii; i += 2) {\n      points[i] = (points[i] - x) / width;\n      points[i + 1] = (points[i + 1] - y) / height;\n    }\n  }\n\n  toSVGPath() {\n    const buffer = [`M${this.#outline[4]} ${this.#outline[5]}`];\n\n    for (let i = 6, ii = this.#outline.length; i < ii; i += 6) {\n      if (isNaN(this.#outline[i])) {\n        buffer.push(`L${this.#outline[i + 4]} ${this.#outline[i + 5]}`);\n        continue;\n      }\n\n      buffer.push(`C${this.#outline[i]} ${this.#outline[i + 1]} ${this.#outline[i + 2]} ${this.#outline[i + 3]} ${this.#outline[i + 4]} ${this.#outline[i + 5]}`);\n    }\n\n    buffer.push(\"Z\");\n    return buffer.join(\" \");\n  }\n\n  serialize([blX, blY, trX, trY], rotation) {\n    const width = trX - blX;\n    const height = trY - blY;\n    let outline;\n    let points;\n\n    switch (rotation) {\n      case 0:\n        outline = this.#rescale(this.#outline, blX, trY, width, -height);\n        points = this.#rescale(this.#points, blX, trY, width, -height);\n        break;\n\n      case 90:\n        outline = this.#rescaleAndSwap(this.#outline, blX, blY, width, height);\n        points = this.#rescaleAndSwap(this.#points, blX, blY, width, height);\n        break;\n\n      case 180:\n        outline = this.#rescale(this.#outline, trX, blY, -width, height);\n        points = this.#rescale(this.#points, trX, blY, -width, height);\n        break;\n\n      case 270:\n        outline = this.#rescaleAndSwap(this.#outline, trX, trY, -width, -height);\n        points = this.#rescaleAndSwap(this.#points, trX, trY, -width, -height);\n        break;\n    }\n\n    return {\n      outline: Array.from(outline),\n      points: [Array.from(points)]\n    };\n  }\n\n  #rescale(src, tx, ty, sx, sy) {\n    const dest = new Float64Array(src.length);\n\n    for (let i = 0, ii = src.length; i < ii; i += 2) {\n      dest[i] = tx + src[i] * sx;\n      dest[i + 1] = ty + src[i + 1] * sy;\n    }\n\n    return dest;\n  }\n\n  #rescaleAndSwap(src, tx, ty, sx, sy) {\n    const dest = new Float64Array(src.length);\n\n    for (let i = 0, ii = src.length; i < ii; i += 2) {\n      dest[i] = tx + src[i + 1] * sx;\n      dest[i + 1] = ty + src[i] * sy;\n    }\n\n    return dest;\n  }\n\n  #computeMinMax(isLTR) {\n    const outline = this.#outline;\n    let lastX = outline[4];\n    let lastY = outline[5];\n    let minX = lastX;\n    let minY = lastY;\n    let maxX = lastX;\n    let maxY = lastY;\n    let lastPointX = lastX;\n    let lastPointY = lastY;\n    const ltrCallback = isLTR ? Math.max : Math.min;\n\n    for (let i = 6, ii = outline.length; i < ii; i += 6) {\n      if (isNaN(outline[i])) {\n        minX = Math.min(minX, outline[i + 4]);\n        minY = Math.min(minY, outline[i + 5]);\n        maxX = Math.max(maxX, outline[i + 4]);\n        maxY = Math.max(maxY, outline[i + 5]);\n\n        if (lastPointY < outline[i + 5]) {\n          lastPointX = outline[i + 4];\n          lastPointY = outline[i + 5];\n        } else if (lastPointY === outline[i + 5]) {\n          lastPointX = ltrCallback(lastPointX, outline[i + 4]);\n        }\n      } else {\n        const bbox = Util.bezierBoundingBox(lastX, lastY, ...outline.slice(i, i + 6));\n        minX = Math.min(minX, bbox[0]);\n        minY = Math.min(minY, bbox[1]);\n        maxX = Math.max(maxX, bbox[2]);\n        maxY = Math.max(maxY, bbox[3]);\n\n        if (lastPointY < bbox[3]) {\n          lastPointX = bbox[2];\n          lastPointY = bbox[3];\n        } else if (lastPointY === bbox[3]) {\n          lastPointX = ltrCallback(lastPointX, bbox[2]);\n        }\n      }\n\n      lastX = outline[i + 4];\n      lastY = outline[i + 5];\n    }\n\n    const x = minX - this.#innerMargin,\n          y = minY - this.#innerMargin,\n          width = maxX - minX + 2 * this.#innerMargin,\n          height = maxY - minY + 2 * this.#innerMargin;\n    this.#bbox = {\n      x,\n      y,\n      width,\n      height,\n      lastPoint: [lastPointX, lastPointY]\n    };\n  }\n\n  get box() {\n    return this.#bbox;\n  }\n\n  getNewOutline(thickness, innerMargin) {\n    const {\n      x,\n      y,\n      width,\n      height\n    } = this.#bbox;\n    const [layerX, layerY, layerWidth, layerHeight] = this.#box;\n    const sx = width * layerWidth;\n    const sy = height * layerHeight;\n    const tx = x * layerWidth + layerX;\n    const ty = y * layerHeight + layerY;\n    const outliner = new FreeOutliner({\n      x: this.#points[0] * sx + tx,\n      y: this.#points[1] * sy + ty\n    }, this.#box, this.#scaleFactor, thickness, this.#isLTR, innerMargin ?? this.#innerMargin);\n\n    for (let i = 2; i < this.#points.length; i += 2) {\n      outliner.add({\n        x: this.#points[i] * sx + tx,\n        y: this.#points[i + 1] * sy + ty\n      });\n    }\n\n    return outliner.getOutlines();\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/color_picker.js\n\nclass ColorPicker {\n  #boundKeyDown = this.#keyDown.bind(this);\n  #boundPointerDown = this.#pointerDown.bind(this);\n  #button = null;\n  #buttonSwatch = null;\n  #defaultColor;\n  #dropdown = null;\n  #dropdownWasFromKeyboard = false;\n  #isMainColorPicker = false;\n  #editor = null;\n  #eventBus;\n  #uiManager = null;\n  #type;\n\n  static get _keyboardManager() {\n    return shadow(this, \"_keyboardManager\", new KeyboardManager([[[\"Escape\", \"mac+Escape\"], ColorPicker.prototype._hideDropdownFromKeyboard], [[\" \", \"mac+ \"], ColorPicker.prototype._colorSelectFromKeyboard], [[\"ArrowDown\", \"ArrowRight\", \"mac+ArrowDown\", \"mac+ArrowRight\"], ColorPicker.prototype._moveToNext], [[\"ArrowUp\", \"ArrowLeft\", \"mac+ArrowUp\", \"mac+ArrowLeft\"], ColorPicker.prototype._moveToPrevious], [[\"Home\", \"mac+Home\"], ColorPicker.prototype._moveToBeginning], [[\"End\", \"mac+End\"], ColorPicker.prototype._moveToEnd]]));\n  }\n\n  constructor({\n    editor = null,\n    uiManager = null\n  }) {\n    if (editor) {\n      this.#isMainColorPicker = false;\n      this.#type = AnnotationEditorParamsType.HIGHLIGHT_COLOR;\n      this.#editor = editor;\n    } else {\n      this.#isMainColorPicker = true;\n      this.#type = AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR;\n    }\n\n    this.#uiManager = editor?._uiManager || uiManager;\n    this.#eventBus = this.#uiManager._eventBus;\n    this.#defaultColor = editor?.color || this.#uiManager?.highlightColors.values().next().value || \"#FFFF98\";\n  }\n\n  renderButton() {\n    const button = this.#button = document.createElement(\"button\");\n    button.className = \"colorPicker\";\n    button.tabIndex = \"0\";\n    button.setAttribute(\"data-l10n-id\", \"pdfjs-editor-colorpicker-button\");\n    button.setAttribute(\"aria-haspopup\", true);\n    const signal = this.#uiManager._signal;\n    button.addEventListener(\"click\", this.#openDropdown.bind(this), {\n      signal\n    });\n    button.addEventListener(\"keydown\", this.#boundKeyDown, {\n      signal\n    });\n    const swatch = this.#buttonSwatch = document.createElement(\"span\");\n    swatch.className = \"swatch\";\n    swatch.setAttribute(\"aria-hidden\", true);\n    swatch.style.backgroundColor = this.#defaultColor;\n    button.append(swatch);\n    return button;\n  }\n\n  renderMainDropdown() {\n    const dropdown = this.#dropdown = this.#getDropdownRoot();\n    dropdown.setAttribute(\"aria-orientation\", \"horizontal\");\n    dropdown.setAttribute(\"aria-labelledby\", \"highlightColorPickerLabel\");\n    return dropdown;\n  }\n\n  #getDropdownRoot() {\n    const div = document.createElement(\"div\");\n    const signal = this.#uiManager._signal;\n    div.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    div.className = \"dropdown\";\n    div.role = \"listbox\";\n    div.setAttribute(\"aria-multiselectable\", false);\n    div.setAttribute(\"aria-orientation\", \"vertical\");\n    div.setAttribute(\"data-l10n-id\", \"pdfjs-editor-colorpicker-dropdown\");\n\n    for (const [name, color] of this.#uiManager.highlightColors) {\n      const button = document.createElement(\"button\");\n      button.tabIndex = \"0\";\n      button.role = \"option\";\n      button.setAttribute(\"data-color\", color);\n      button.title = name;\n      button.setAttribute(\"data-l10n-id\", `pdfjs-editor-colorpicker-${name}`);\n      const swatch = document.createElement(\"span\");\n      button.append(swatch);\n      swatch.className = \"swatch\";\n      swatch.style.backgroundColor = color;\n      button.setAttribute(\"aria-selected\", color === this.#defaultColor);\n      button.addEventListener(\"click\", this.#colorSelect.bind(this, color), {\n        signal\n      });\n      div.append(button);\n    }\n\n    div.addEventListener(\"keydown\", this.#boundKeyDown, {\n      signal\n    });\n    return div;\n  }\n\n  #colorSelect(color, event) {\n    event.stopPropagation();\n    this.#eventBus.dispatch(\"switchannotationeditorparams\", {\n      source: this,\n      type: this.#type,\n      value: color\n    });\n  }\n\n  _colorSelectFromKeyboard(event) {\n    if (event.target === this.#button) {\n      this.#openDropdown(event);\n      return;\n    }\n\n    const color = event.target.getAttribute(\"data-color\");\n\n    if (!color) {\n      return;\n    }\n\n    this.#colorSelect(color, event);\n  }\n\n  _moveToNext(event) {\n    if (!this.#isDropdownVisible) {\n      this.#openDropdown(event);\n      return;\n    }\n\n    if (event.target === this.#button) {\n      this.#dropdown.firstChild?.focus();\n      return;\n    }\n\n    event.target.nextSibling?.focus();\n  }\n\n  _moveToPrevious(event) {\n    if (event.target === this.#dropdown?.firstChild || event.target === this.#button) {\n      if (this.#isDropdownVisible) {\n        this._hideDropdownFromKeyboard();\n      }\n\n      return;\n    }\n\n    if (!this.#isDropdownVisible) {\n      this.#openDropdown(event);\n    }\n\n    event.target.previousSibling?.focus();\n  }\n\n  _moveToBeginning(event) {\n    if (!this.#isDropdownVisible) {\n      this.#openDropdown(event);\n      return;\n    }\n\n    this.#dropdown.firstChild?.focus();\n  }\n\n  _moveToEnd(event) {\n    if (!this.#isDropdownVisible) {\n      this.#openDropdown(event);\n      return;\n    }\n\n    this.#dropdown.lastChild?.focus();\n  }\n\n  #keyDown(event) {\n    ColorPicker._keyboardManager.exec(this, event);\n  }\n\n  #openDropdown(event) {\n    if (this.#isDropdownVisible) {\n      this.hideDropdown();\n      return;\n    }\n\n    this.#dropdownWasFromKeyboard = event.detail === 0;\n    window.addEventListener(\"pointerdown\", this.#boundPointerDown, {\n      signal: this.#uiManager._signal\n    });\n\n    if (this.#dropdown) {\n      this.#dropdown.classList.remove(\"hidden\");\n      return;\n    }\n\n    const root = this.#dropdown = this.#getDropdownRoot();\n    this.#button.append(root);\n  }\n\n  #pointerDown(event) {\n    if (this.#dropdown?.contains(event.target)) {\n      return;\n    }\n\n    this.hideDropdown();\n  }\n\n  hideDropdown() {\n    this.#dropdown?.classList.add(\"hidden\");\n    window.removeEventListener(\"pointerdown\", this.#boundPointerDown);\n  }\n\n  get #isDropdownVisible() {\n    return this.#dropdown && !this.#dropdown.classList.contains(\"hidden\");\n  }\n\n  _hideDropdownFromKeyboard() {\n    if (this.#isMainColorPicker) {\n      return;\n    }\n\n    if (!this.#isDropdownVisible) {\n      this.#editor?.unselect();\n      return;\n    }\n\n    this.hideDropdown();\n    this.#button.focus({\n      preventScroll: true,\n      focusVisible: this.#dropdownWasFromKeyboard\n    });\n  }\n\n  updateColor(color) {\n    if (this.#buttonSwatch) {\n      this.#buttonSwatch.style.backgroundColor = color;\n    }\n\n    if (!this.#dropdown) {\n      return;\n    }\n\n    const i = this.#uiManager.highlightColors.values();\n\n    for (const child of this.#dropdown.children) {\n      child.setAttribute(\"aria-selected\", i.next().value === color);\n    }\n  }\n\n  destroy() {\n    this.#button?.remove();\n    this.#button = null;\n    this.#buttonSwatch = null;\n    this.#dropdown?.remove();\n    this.#dropdown = null;\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/highlight.js\n\nclass HighlightEditor extends AnnotationEditor {\n  #anchorNode = null;\n  #anchorOffset = 0;\n  #boxes;\n  #clipPathId = null;\n  #colorPicker = null;\n  #focusOutlines = null;\n  #focusNode = null;\n  #focusOffset = 0;\n  #highlightDiv = null;\n  #highlightOutlines = null;\n  #id = null;\n  #isFreeHighlight = false;\n  #lastPoint = null;\n  #opacity;\n  #outlineId = null;\n  #text = \"\";\n  #thickness;\n  #methodOfCreation = \"\";\n  static _defaultColor = null;\n  static _defaultOpacity = 1;\n  static _defaultThickness = 12;\n  static _l10nPromise;\n  static _type = \"highlight\";\n  static _editorType = AnnotationEditorType.HIGHLIGHT;\n  static _freeHighlightId = -1;\n  static _freeHighlight = null;\n  static _freeHighlightClipId = \"\";\n\n  static get _keyboardManager() {\n    const proto = HighlightEditor.prototype;\n    return shadow(this, \"_keyboardManager\", new KeyboardManager([[[\"ArrowLeft\", \"mac+ArrowLeft\"], proto._moveCaret, {\n      args: [0]\n    }], [[\"ArrowRight\", \"mac+ArrowRight\"], proto._moveCaret, {\n      args: [1]\n    }], [[\"ArrowUp\", \"mac+ArrowUp\"], proto._moveCaret, {\n      args: [2]\n    }], [[\"ArrowDown\", \"mac+ArrowDown\"], proto._moveCaret, {\n      args: [3]\n    }]]));\n  }\n\n  constructor(params) {\n    super({ ...params,\n      name: \"highlightEditor\"\n    });\n    this.color = params.color || HighlightEditor._defaultColor;\n    this.#thickness = params.thickness || HighlightEditor._defaultThickness;\n    this.#opacity = params.opacity || HighlightEditor._defaultOpacity;\n    this.#boxes = params.boxes || null;\n    this.#methodOfCreation = params.methodOfCreation || \"\";\n    this.#text = params.text || \"\";\n    this._isDraggable = false;\n\n    if (params.highlightId > -1) {\n      this.#isFreeHighlight = true;\n      this.#createFreeOutlines(params);\n      this.#addToDrawLayer();\n    } else {\n      this.#anchorNode = params.anchorNode;\n      this.#anchorOffset = params.anchorOffset;\n      this.#focusNode = params.focusNode;\n      this.#focusOffset = params.focusOffset;\n      this.#createOutlines();\n      this.#addToDrawLayer();\n      this.rotate(this.rotation);\n    }\n  }\n\n  get telemetryInitialData() {\n    return {\n      action: \"added\",\n      type: this.#isFreeHighlight ? \"free_highlight\" : \"highlight\",\n      color: this._uiManager.highlightColorNames.get(this.color),\n      thickness: this.#thickness,\n      methodOfCreation: this.#methodOfCreation\n    };\n  }\n\n  get telemetryFinalData() {\n    return {\n      type: \"highlight\",\n      color: this._uiManager.highlightColorNames.get(this.color)\n    };\n  }\n\n  static computeTelemetryFinalData(data) {\n    return {\n      numberOfColors: data.get(\"color\").size\n    };\n  }\n\n  #createOutlines() {\n    const outliner = new Outliner(this.#boxes, 0.001);\n    this.#highlightOutlines = outliner.getOutlines();\n    ({\n      x: this.x,\n      y: this.y,\n      width: this.width,\n      height: this.height\n    } = this.#highlightOutlines.box);\n    const outlinerForOutline = new Outliner(this.#boxes, 0.0025, 0.001, this._uiManager.direction === \"ltr\");\n    this.#focusOutlines = outlinerForOutline.getOutlines();\n    const {\n      lastPoint\n    } = this.#focusOutlines.box;\n    this.#lastPoint = [(lastPoint[0] - this.x) / this.width, (lastPoint[1] - this.y) / this.height];\n  }\n\n  #createFreeOutlines({\n    highlightOutlines,\n    highlightId,\n    clipPathId\n  }) {\n    this.#highlightOutlines = highlightOutlines;\n    const extraThickness = 1.5;\n    this.#focusOutlines = highlightOutlines.getNewOutline(this.#thickness / 2 + extraThickness, 0.0025);\n\n    if (highlightId >= 0) {\n      this.#id = highlightId;\n      this.#clipPathId = clipPathId;\n      this.parent.drawLayer.finalizeLine(highlightId, highlightOutlines);\n      this.#outlineId = this.parent.drawLayer.highlightOutline(this.#focusOutlines);\n    } else if (this.parent) {\n      const angle = this.parent.viewport.rotation;\n      this.parent.drawLayer.updateLine(this.#id, highlightOutlines);\n      this.parent.drawLayer.updateBox(this.#id, HighlightEditor.#rotateBbox(this.#highlightOutlines.box, (angle - this.rotation + 360) % 360));\n      this.parent.drawLayer.updateLine(this.#outlineId, this.#focusOutlines);\n      this.parent.drawLayer.updateBox(this.#outlineId, HighlightEditor.#rotateBbox(this.#focusOutlines.box, angle));\n    }\n\n    const {\n      x,\n      y,\n      width,\n      height\n    } = highlightOutlines.box;\n\n    switch (this.rotation) {\n      case 0:\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n        break;\n\n      case 90:\n        {\n          const [pageWidth, pageHeight] = this.parentDimensions;\n          this.x = y;\n          this.y = 1 - x;\n          this.width = width * pageHeight / pageWidth;\n          this.height = height * pageWidth / pageHeight;\n          break;\n        }\n\n      case 180:\n        this.x = 1 - x;\n        this.y = 1 - y;\n        this.width = width;\n        this.height = height;\n        break;\n\n      case 270:\n        {\n          const [pageWidth, pageHeight] = this.parentDimensions;\n          this.x = 1 - y;\n          this.y = x;\n          this.width = width * pageHeight / pageWidth;\n          this.height = height * pageWidth / pageHeight;\n          break;\n        }\n    }\n\n    const {\n      lastPoint\n    } = this.#focusOutlines.box;\n    this.#lastPoint = [(lastPoint[0] - x) / width, (lastPoint[1] - y) / height];\n  }\n\n  static initialize(l10n, uiManager) {\n    AnnotationEditor.initialize(l10n, uiManager);\n    HighlightEditor._defaultColor ||= uiManager.highlightColors?.values().next().value || \"#fff066\";\n  }\n\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:\n        HighlightEditor._defaultColor = value;\n        break;\n\n      case AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:\n        HighlightEditor._defaultThickness = value;\n        break;\n    }\n  }\n\n  translateInPage(x, y) {}\n\n  get toolbarPosition() {\n    return this.#lastPoint;\n  }\n\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.HIGHLIGHT_COLOR:\n        this.#updateColor(value);\n        break;\n\n      case AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:\n        this.#updateThickness(value);\n        break;\n    }\n  }\n\n  static get defaultPropertiesToUpdate() {\n    return [[AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR, HighlightEditor._defaultColor], [AnnotationEditorParamsType.HIGHLIGHT_THICKNESS, HighlightEditor._defaultThickness]];\n  }\n\n  get propertiesToUpdate() {\n    return [[AnnotationEditorParamsType.HIGHLIGHT_COLOR, this.color || HighlightEditor._defaultColor], [AnnotationEditorParamsType.HIGHLIGHT_THICKNESS, this.#thickness || HighlightEditor._defaultThickness], [AnnotationEditorParamsType.HIGHLIGHT_FREE, this.#isFreeHighlight]];\n  }\n\n  #updateColor(color) {\n    const setColor = col => {\n      this.color = col;\n      this.parent?.drawLayer.changeColor(this.#id, col);\n      this.#colorPicker?.updateColor(col);\n    };\n\n    const savedColor = this.color;\n    this.addCommands({\n      cmd: setColor.bind(this, color),\n      undo: setColor.bind(this, savedColor),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.HIGHLIGHT_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n\n    this._reportTelemetry({\n      action: \"color_changed\",\n      color: this._uiManager.highlightColorNames.get(color)\n    }, true);\n  }\n\n  #updateThickness(thickness) {\n    const savedThickness = this.#thickness;\n\n    const setThickness = th => {\n      this.#thickness = th;\n      this.#changeThickness(th);\n    };\n\n    this.addCommands({\n      cmd: setThickness.bind(this, thickness),\n      undo: setThickness.bind(this, savedThickness),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_THICKNESS,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n\n    this._reportTelemetry({\n      action: \"thickness_changed\",\n      thickness\n    }, true);\n  }\n\n  addEditToolbar() {\n    var _superprop_getAddEditToolbar = () => super.addEditToolbar,\n        _this31 = this;\n\n    return _asyncToGenerator(function* () {\n      const toolbar = yield _superprop_getAddEditToolbar().call(_this31);\n\n      if (!toolbar) {\n        return null;\n      }\n\n      if (_this31._uiManager.highlightColors) {\n        _this31.#colorPicker = new ColorPicker({\n          editor: _this31\n        });\n        toolbar.addColorPicker(_this31.#colorPicker);\n      }\n\n      return toolbar;\n    })();\n  }\n\n  disableEditing() {\n    super.disableEditing();\n    this.div.classList.toggle(\"disabled\", true);\n  }\n\n  enableEditing() {\n    super.enableEditing();\n    this.div.classList.toggle(\"disabled\", false);\n  }\n\n  fixAndSetPosition() {\n    return super.fixAndSetPosition(this.#getRotation());\n  }\n\n  getBaseTranslation() {\n    return [0, 0];\n  }\n\n  getRect(tx, ty) {\n    return super.getRect(tx, ty, this.#getRotation());\n  }\n\n  onceAdded() {\n    this.parent.addUndoableEditor(this);\n    this.div.focus();\n  }\n\n  remove() {\n    this.#cleanDrawLayer();\n\n    this._reportTelemetry({\n      action: \"deleted\"\n    });\n\n    super.remove();\n  }\n\n  rebuild() {\n    if (!this.parent) {\n      return;\n    }\n\n    super.rebuild();\n\n    if (this.div === null) {\n      return;\n    }\n\n    this.#addToDrawLayer();\n\n    if (!this.isAttachedToDOM) {\n      this.parent.add(this);\n    }\n  }\n\n  setParent(parent) {\n    let mustBeSelected = false;\n\n    if (this.parent && !parent) {\n      this.#cleanDrawLayer();\n    } else if (parent) {\n      this.#addToDrawLayer(parent);\n      mustBeSelected = !this.parent && this.div?.classList.contains(\"selectedEditor\");\n    }\n\n    super.setParent(parent);\n    this.show(this._isVisible);\n\n    if (mustBeSelected) {\n      this.select();\n    }\n  }\n\n  #changeThickness(thickness) {\n    if (!this.#isFreeHighlight) {\n      return;\n    }\n\n    this.#createFreeOutlines({\n      highlightOutlines: this.#highlightOutlines.getNewOutline(thickness / 2)\n    });\n    this.fixAndSetPosition();\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.setDims(this.width * parentWidth, this.height * parentHeight);\n  }\n\n  #cleanDrawLayer() {\n    if (this.#id === null || !this.parent) {\n      return;\n    }\n\n    this.parent.drawLayer.remove(this.#id);\n    this.#id = null;\n    this.parent.drawLayer.remove(this.#outlineId);\n    this.#outlineId = null;\n  }\n\n  #addToDrawLayer(parent = this.parent) {\n    if (this.#id !== null) {\n      return;\n    }\n\n    ({\n      id: this.#id,\n      clipPathId: this.#clipPathId\n    } = parent.drawLayer.highlight(this.#highlightOutlines, this.color, this.#opacity));\n    this.#outlineId = parent.drawLayer.highlightOutline(this.#focusOutlines);\n\n    if (this.#highlightDiv) {\n      this.#highlightDiv.style.clipPath = this.#clipPathId;\n    }\n  }\n\n  static #rotateBbox({\n    x,\n    y,\n    width,\n    height\n  }, angle) {\n    switch (angle) {\n      case 90:\n        return {\n          x: 1 - y - height,\n          y: x,\n          width: height,\n          height: width\n        };\n\n      case 180:\n        return {\n          x: 1 - x - width,\n          y: 1 - y - height,\n          width,\n          height\n        };\n\n      case 270:\n        return {\n          x: y,\n          y: 1 - x - width,\n          width: height,\n          height: width\n        };\n    }\n\n    return {\n      x,\n      y,\n      width,\n      height\n    };\n  }\n\n  rotate(angle) {\n    const {\n      drawLayer\n    } = this.parent;\n    let box;\n\n    if (this.#isFreeHighlight) {\n      angle = (angle - this.rotation + 360) % 360;\n      box = HighlightEditor.#rotateBbox(this.#highlightOutlines.box, angle);\n    } else {\n      box = HighlightEditor.#rotateBbox(this, angle);\n    }\n\n    drawLayer.rotate(this.#id, angle);\n    drawLayer.rotate(this.#outlineId, angle);\n    drawLayer.updateBox(this.#id, box);\n    drawLayer.updateBox(this.#outlineId, HighlightEditor.#rotateBbox(this.#focusOutlines.box, angle));\n  }\n\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n\n    const div = super.render();\n\n    if (this.#text) {\n      div.setAttribute(\"aria-label\", this.#text);\n      div.setAttribute(\"role\", \"mark\");\n    }\n\n    if (this.#isFreeHighlight) {\n      div.classList.add(\"free\");\n    } else {\n      this.div.addEventListener(\"keydown\", this.#keydown.bind(this), {\n        signal: this._uiManager._signal\n      });\n    }\n\n    const highlightDiv = this.#highlightDiv = document.createElement(\"div\");\n    div.append(highlightDiv);\n    highlightDiv.setAttribute(\"aria-hidden\", \"true\");\n    highlightDiv.className = \"internal\";\n    highlightDiv.style.clipPath = this.#clipPathId;\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.setDims(this.width * parentWidth, this.height * parentHeight);\n    bindEvents(this, this.#highlightDiv, [\"pointerover\", \"pointerleave\"]);\n    this.enableEditing();\n    return div;\n  }\n\n  pointerover() {\n    this.parent.drawLayer.addClass(this.#outlineId, \"hovered\");\n  }\n\n  pointerleave() {\n    this.parent.drawLayer.removeClass(this.#outlineId, \"hovered\");\n  }\n\n  #keydown(event) {\n    HighlightEditor._keyboardManager.exec(this, event);\n  }\n\n  _moveCaret(direction) {\n    this.parent.unselect(this);\n\n    switch (direction) {\n      case 0:\n      case 2:\n        this.#setCaret(true);\n        break;\n\n      case 1:\n      case 3:\n        this.#setCaret(false);\n        break;\n    }\n  }\n\n  #setCaret(start) {\n    if (!this.#anchorNode) {\n      return;\n    }\n\n    const selection = window.getSelection();\n\n    if (start) {\n      selection.setPosition(this.#anchorNode, this.#anchorOffset);\n    } else {\n      selection.setPosition(this.#focusNode, this.#focusOffset);\n    }\n  }\n\n  select() {\n    super.select();\n\n    if (!this.#outlineId) {\n      return;\n    }\n\n    this.parent?.drawLayer.removeClass(this.#outlineId, \"hovered\");\n    this.parent?.drawLayer.addClass(this.#outlineId, \"selected\");\n  }\n\n  unselect() {\n    super.unselect();\n\n    if (!this.#outlineId) {\n      return;\n    }\n\n    this.parent?.drawLayer.removeClass(this.#outlineId, \"selected\");\n\n    if (!this.#isFreeHighlight) {\n      this.#setCaret(false);\n    }\n  }\n\n  get _mustFixPosition() {\n    return !this.#isFreeHighlight;\n  }\n\n  show(visible = this._isVisible) {\n    super.show(visible);\n\n    if (this.parent) {\n      this.parent.drawLayer.show(this.#id, visible);\n      this.parent.drawLayer.show(this.#outlineId, visible);\n    }\n  }\n\n  #getRotation() {\n    return this.#isFreeHighlight ? this.rotation : 0;\n  }\n\n  #serializeBoxes() {\n    if (this.#isFreeHighlight) {\n      return null;\n    }\n\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    const [pageX, pageY] = this.pageTranslation;\n    const boxes = this.#boxes;\n    const quadPoints = new Float32Array(boxes.length * 8);\n    let i = 0;\n\n    for (const {\n      x,\n      y,\n      width,\n      height\n    } of boxes) {\n      const sx = x * pageWidth + pageX;\n      const sy = (1 - y - height) * pageHeight + pageY;\n      quadPoints[i] = quadPoints[i + 4] = sx;\n      quadPoints[i + 1] = quadPoints[i + 3] = sy;\n      quadPoints[i + 2] = quadPoints[i + 6] = sx + width * pageWidth;\n      quadPoints[i + 5] = quadPoints[i + 7] = sy + height * pageHeight;\n      i += 8;\n    }\n\n    return quadPoints;\n  }\n\n  #serializeOutlines(rect) {\n    return this.#highlightOutlines.serialize(rect, this.#getRotation());\n  }\n\n  static startHighlighting(parent, isLTR, {\n    target: textLayer,\n    x,\n    y\n  }) {\n    const {\n      x: layerX,\n      y: layerY,\n      width: parentWidth,\n      height: parentHeight\n    } = textLayer.getBoundingClientRect();\n    const ac = new AbortController();\n    const signal = parent.combinedSignal(ac);\n\n    const pointerDown = e => {\n      e.preventDefault();\n      e.stopPropagation();\n    };\n\n    const pointerUpCallback = e => {\n      ac.abort();\n      this.#endHighlight(parent, e);\n    };\n\n    window.addEventListener(\"blur\", pointerUpCallback, {\n      signal\n    });\n    window.addEventListener(\"pointerup\", pointerUpCallback, {\n      signal\n    });\n    window.addEventListener(\"pointerdown\", pointerDown, {\n      capture: true,\n      passive: false,\n      signal\n    });\n    window.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    textLayer.addEventListener(\"pointermove\", this.#highlightMove.bind(this, parent), {\n      signal\n    });\n    this._freeHighlight = new FreeOutliner({\n      x,\n      y\n    }, [layerX, layerY, parentWidth, parentHeight], parent.scale, this._defaultThickness / 2, isLTR, 0.001);\n    ({\n      id: this._freeHighlightId,\n      clipPathId: this._freeHighlightClipId\n    } = parent.drawLayer.highlight(this._freeHighlight, this._defaultColor, this._defaultOpacity, true));\n  }\n\n  static #highlightMove(parent, event) {\n    if (this._freeHighlight.add(event)) {\n      parent.drawLayer.updatePath(this._freeHighlightId, this._freeHighlight);\n    }\n  }\n\n  static #endHighlight(parent, event) {\n    if (!this._freeHighlight.isEmpty()) {\n      parent.createAndAddNewEditor(event, false, {\n        highlightId: this._freeHighlightId,\n        highlightOutlines: this._freeHighlight.getOutlines(),\n        clipPathId: this._freeHighlightClipId,\n        methodOfCreation: \"main_toolbar\"\n      });\n    } else {\n      parent.drawLayer.removeFreeHighlight(this._freeHighlightId);\n    }\n\n    this._freeHighlightId = -1;\n    this._freeHighlight = null;\n    this._freeHighlightClipId = \"\";\n  }\n\n  static deserialize(data, parent, uiManager) {\n    const editor = super.deserialize(data, parent, uiManager);\n    const {\n      rect: [blX, blY, trX, trY],\n      color,\n      quadPoints\n    } = data;\n    editor.color = Util.makeHexColor(...color);\n    editor.#opacity = data.opacity;\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    editor.width = (trX - blX) / pageWidth;\n    editor.height = (trY - blY) / pageHeight;\n    const boxes = editor.#boxes = [];\n\n    for (let i = 0; i < quadPoints.length; i += 8) {\n      boxes.push({\n        x: (quadPoints[4] - trX) / pageWidth,\n        y: (trY - (1 - quadPoints[i + 5])) / pageHeight,\n        width: (quadPoints[i + 2] - quadPoints[i]) / pageWidth,\n        height: (quadPoints[i + 5] - quadPoints[i + 1]) / pageHeight\n      });\n    }\n\n    editor.#createOutlines();\n    return editor;\n  }\n\n  serialize(isForCopying = false) {\n    if (this.isEmpty() || isForCopying) {\n      return null;\n    }\n\n    const rect = this.getRect(0, 0);\n\n    const color = AnnotationEditor._colorManager.convert(this.color);\n\n    return {\n      annotationType: AnnotationEditorType.HIGHLIGHT,\n      color,\n      opacity: this.#opacity,\n      thickness: this.#thickness,\n      quadPoints: this.#serializeBoxes(),\n      outlines: this.#serializeOutlines(rect),\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.#getRotation(),\n      structTreeParentId: this._structTreeParentId\n    };\n  }\n\n  static canCreateNewEmptyEditor() {\n    return false;\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/ink.js\n\nclass InkEditor extends AnnotationEditor {\n  #baseHeight = 0;\n  #baseWidth = 0;\n  #canvasContextMenuTimeoutId = null;\n  #currentPath2D = new Path2D();\n  #disableEditing = false;\n  #drawingAC = null;\n  #hasSomethingToDraw = false;\n  #isCanvasInitialized = false;\n  #observer = null;\n  #pointerdownAC = null;\n  #realWidth = 0;\n  #realHeight = 0;\n  #requestFrameCallback = null;\n  static _defaultColor = null;\n  static _defaultOpacity = 1;\n  static _defaultThickness = 1;\n  static _type = \"ink\";\n  static _editorType = AnnotationEditorType.INK;\n\n  constructor(params) {\n    super({ ...params,\n      name: \"inkEditor\"\n    });\n    this.color = params.color || null;\n    this.thickness = params.thickness || null;\n    this.opacity = params.opacity || null;\n    this.paths = [];\n    this.bezierPath2D = [];\n    this.allRawPaths = [];\n    this.currentPath = [];\n    this.scaleFactor = 1;\n    this.translationX = this.translationY = 0;\n    this.x = 0;\n    this.y = 0;\n    this._willKeepAspectRatio = true;\n  }\n\n  static initialize(l10n, uiManager) {\n    AnnotationEditor.initialize(l10n, uiManager);\n  }\n\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.INK_THICKNESS:\n        InkEditor._defaultThickness = value;\n        break;\n\n      case AnnotationEditorParamsType.INK_COLOR:\n        InkEditor._defaultColor = value;\n        break;\n\n      case AnnotationEditorParamsType.INK_OPACITY:\n        InkEditor._defaultOpacity = value / 100;\n        break;\n    }\n  }\n\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.INK_THICKNESS:\n        this.#updateThickness(value);\n        break;\n\n      case AnnotationEditorParamsType.INK_COLOR:\n        this.#updateColor(value);\n        break;\n\n      case AnnotationEditorParamsType.INK_OPACITY:\n        this.#updateOpacity(value);\n        break;\n    }\n  }\n\n  static get defaultPropertiesToUpdate() {\n    return [[AnnotationEditorParamsType.INK_THICKNESS, InkEditor._defaultThickness], [AnnotationEditorParamsType.INK_COLOR, InkEditor._defaultColor || AnnotationEditor._defaultLineColor], [AnnotationEditorParamsType.INK_OPACITY, Math.round(InkEditor._defaultOpacity * 100)]];\n  }\n\n  get propertiesToUpdate() {\n    return [[AnnotationEditorParamsType.INK_THICKNESS, this.thickness || InkEditor._defaultThickness], [AnnotationEditorParamsType.INK_COLOR, this.color || InkEditor._defaultColor || AnnotationEditor._defaultLineColor], [AnnotationEditorParamsType.INK_OPACITY, Math.round(100 * (this.opacity ?? InkEditor._defaultOpacity))]];\n  }\n\n  #updateThickness(thickness) {\n    const setThickness = th => {\n      this.thickness = th;\n      this.#fitToContent();\n    };\n\n    const savedThickness = this.thickness;\n    this.addCommands({\n      cmd: setThickness.bind(this, thickness),\n      undo: setThickness.bind(this, savedThickness),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_THICKNESS,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n\n  #updateColor(color) {\n    const setColor = col => {\n      this.color = col;\n      this.#redraw();\n    };\n\n    const savedColor = this.color;\n    this.addCommands({\n      cmd: setColor.bind(this, color),\n      undo: setColor.bind(this, savedColor),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n\n  #updateOpacity(opacity) {\n    const setOpacity = op => {\n      this.opacity = op;\n      this.#redraw();\n    };\n\n    opacity /= 100;\n    const savedOpacity = this.opacity;\n    this.addCommands({\n      cmd: setOpacity.bind(this, opacity),\n      undo: setOpacity.bind(this, savedOpacity),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_OPACITY,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n\n  rebuild() {\n    if (!this.parent) {\n      return;\n    }\n\n    super.rebuild();\n\n    if (this.div === null) {\n      return;\n    }\n\n    if (!this.canvas) {\n      this.#createCanvas();\n      this.#createObserver();\n    }\n\n    if (!this.isAttachedToDOM) {\n      this.parent.add(this);\n      this.#setCanvasDims();\n    }\n\n    this.#fitToContent();\n  }\n\n  remove() {\n    if (this.canvas === null) {\n      return;\n    }\n\n    if (!this.isEmpty()) {\n      this.commit();\n    }\n\n    this.canvas.width = this.canvas.height = 0;\n    this.canvas.remove();\n    this.canvas = null;\n\n    if (this.#canvasContextMenuTimeoutId) {\n      clearTimeout(this.#canvasContextMenuTimeoutId);\n      this.#canvasContextMenuTimeoutId = null;\n    }\n\n    this.#observer?.disconnect();\n    this.#observer = null;\n    super.remove();\n  }\n\n  setParent(parent) {\n    if (!this.parent && parent) {\n      this._uiManager.removeShouldRescale(this);\n    } else if (this.parent && parent === null) {\n      this._uiManager.addShouldRescale(this);\n    }\n\n    super.setParent(parent);\n  }\n\n  onScaleChanging() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const width = this.width * parentWidth;\n    const height = this.height * parentHeight;\n    this.setDimensions(width, height);\n  }\n\n  enableEditMode() {\n    if (this.#disableEditing || this.canvas === null) {\n      return;\n    }\n\n    super.enableEditMode();\n    this._isDraggable = false;\n    this.#addPointerdownListener();\n  }\n\n  disableEditMode() {\n    if (!this.isInEditMode() || this.canvas === null) {\n      return;\n    }\n\n    super.disableEditMode();\n    this._isDraggable = !this.isEmpty();\n    this.div.classList.remove(\"editing\");\n    this.#removePointerdownListener();\n  }\n\n  onceAdded() {\n    this._isDraggable = !this.isEmpty();\n  }\n\n  isEmpty() {\n    return this.paths.length === 0 || this.paths.length === 1 && this.paths[0].length === 0;\n  }\n\n  #getInitialBBox() {\n    const {\n      parentRotation,\n      parentDimensions: [width, height]\n    } = this;\n\n    switch (parentRotation) {\n      case 90:\n        return [0, height, height, width];\n\n      case 180:\n        return [width, height, width, height];\n\n      case 270:\n        return [width, 0, height, width];\n\n      default:\n        return [0, 0, width, height];\n    }\n  }\n\n  #setStroke() {\n    const {\n      ctx,\n      color,\n      opacity,\n      thickness,\n      parentScale,\n      scaleFactor\n    } = this;\n    ctx.lineWidth = thickness * parentScale / scaleFactor;\n    ctx.lineCap = \"round\";\n    ctx.lineJoin = \"round\";\n    ctx.miterLimit = 10;\n    ctx.strokeStyle = `${color}${opacityToHex(opacity)}`;\n  }\n\n  #startDrawing(x, y) {\n    this.canvas.addEventListener(\"contextmenu\", noContextMenu, {\n      signal: this._uiManager._signal\n    });\n    this.#removePointerdownListener();\n    this.#drawingAC = new AbortController();\n\n    const signal = this._uiManager.combinedSignal(this.#drawingAC);\n\n    this.canvas.addEventListener(\"pointerleave\", this.canvasPointerleave.bind(this), {\n      signal\n    });\n    this.canvas.addEventListener(\"pointermove\", this.canvasPointermove.bind(this), {\n      signal\n    });\n    this.canvas.addEventListener(\"pointerup\", this.canvasPointerup.bind(this), {\n      signal\n    });\n    this.isEditing = true;\n\n    if (!this.#isCanvasInitialized) {\n      this.#isCanvasInitialized = true;\n      this.#setCanvasDims();\n      this.thickness ||= InkEditor._defaultThickness;\n      this.color ||= InkEditor._defaultColor || AnnotationEditor._defaultLineColor;\n      this.opacity ??= InkEditor._defaultOpacity;\n    }\n\n    this.currentPath.push([x, y]);\n    this.#hasSomethingToDraw = false;\n    this.#setStroke();\n\n    this.#requestFrameCallback = () => {\n      this.#drawPoints();\n\n      if (this.#requestFrameCallback) {\n        window.requestAnimationFrame(this.#requestFrameCallback);\n      }\n    };\n\n    window.requestAnimationFrame(this.#requestFrameCallback);\n  }\n\n  #draw(x, y) {\n    const [lastX, lastY] = this.currentPath.at(-1);\n\n    if (this.currentPath.length > 1 && x === lastX && y === lastY) {\n      return;\n    }\n\n    const currentPath = this.currentPath;\n    let path2D = this.#currentPath2D;\n    currentPath.push([x, y]);\n    this.#hasSomethingToDraw = true;\n\n    if (currentPath.length <= 2) {\n      path2D.moveTo(...currentPath[0]);\n      path2D.lineTo(x, y);\n      return;\n    }\n\n    if (currentPath.length === 3) {\n      this.#currentPath2D = path2D = new Path2D();\n      path2D.moveTo(...currentPath[0]);\n    }\n\n    this.#makeBezierCurve(path2D, ...currentPath.at(-3), ...currentPath.at(-2), x, y);\n  }\n\n  #endPath() {\n    if (this.currentPath.length === 0) {\n      return;\n    }\n\n    const lastPoint = this.currentPath.at(-1);\n    this.#currentPath2D.lineTo(...lastPoint);\n  }\n\n  #stopDrawing(x, y) {\n    this.#requestFrameCallback = null;\n    x = Math.min(Math.max(x, 0), this.canvas.width);\n    y = Math.min(Math.max(y, 0), this.canvas.height);\n    this.#draw(x, y);\n    this.#endPath();\n    let bezier;\n\n    if (this.currentPath.length !== 1) {\n      bezier = this.#generateBezierPoints();\n    } else {\n      const xy = [x, y];\n      bezier = [[xy, xy.slice(), xy.slice(), xy]];\n    }\n\n    const path2D = this.#currentPath2D;\n    const currentPath = this.currentPath;\n    this.currentPath = [];\n    this.#currentPath2D = new Path2D();\n\n    const cmd = () => {\n      this.allRawPaths.push(currentPath);\n      this.paths.push(bezier);\n      this.bezierPath2D.push(path2D);\n\n      this._uiManager.rebuild(this);\n    };\n\n    const undo = () => {\n      this.allRawPaths.pop();\n      this.paths.pop();\n      this.bezierPath2D.pop();\n\n      if (this.paths.length === 0) {\n        this.remove();\n      } else {\n        if (!this.canvas) {\n          this.#createCanvas();\n          this.#createObserver();\n        }\n\n        this.#fitToContent();\n      }\n    };\n\n    this.addCommands({\n      cmd,\n      undo,\n      mustExec: true\n    });\n  }\n\n  #drawPoints() {\n    if (!this.#hasSomethingToDraw) {\n      return;\n    }\n\n    this.#hasSomethingToDraw = false;\n    const thickness = Math.ceil(this.thickness * this.parentScale);\n    const lastPoints = this.currentPath.slice(-3);\n    const x = lastPoints.map(xy => xy[0]);\n    const y = lastPoints.map(xy => xy[1]);\n    const xMin = Math.min(...x) - thickness;\n    const xMax = Math.max(...x) + thickness;\n    const yMin = Math.min(...y) - thickness;\n    const yMax = Math.max(...y) + thickness;\n    const {\n      ctx\n    } = this;\n    ctx.save();\n    ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n    for (const path of this.bezierPath2D) {\n      ctx.stroke(path);\n    }\n\n    ctx.stroke(this.#currentPath2D);\n    ctx.restore();\n  }\n\n  #makeBezierCurve(path2D, x0, y0, x1, y1, x2, y2) {\n    const prevX = (x0 + x1) / 2;\n    const prevY = (y0 + y1) / 2;\n    const x3 = (x1 + x2) / 2;\n    const y3 = (y1 + y2) / 2;\n    path2D.bezierCurveTo(prevX + 2 * (x1 - prevX) / 3, prevY + 2 * (y1 - prevY) / 3, x3 + 2 * (x1 - x3) / 3, y3 + 2 * (y1 - y3) / 3, x3, y3);\n  }\n\n  #generateBezierPoints() {\n    const path = this.currentPath;\n\n    if (path.length <= 2) {\n      return [[path[0], path[0], path.at(-1), path.at(-1)]];\n    }\n\n    const bezierPoints = [];\n    let i;\n    let [x0, y0] = path[0];\n\n    for (i = 1; i < path.length - 2; i++) {\n      const [x1, y1] = path[i];\n      const [x2, y2] = path[i + 1];\n      const x3 = (x1 + x2) / 2;\n      const y3 = (y1 + y2) / 2;\n      const control1 = [x0 + 2 * (x1 - x0) / 3, y0 + 2 * (y1 - y0) / 3];\n      const control2 = [x3 + 2 * (x1 - x3) / 3, y3 + 2 * (y1 - y3) / 3];\n      bezierPoints.push([[x0, y0], control1, control2, [x3, y3]]);\n      [x0, y0] = [x3, y3];\n    }\n\n    const [x1, y1] = path[i];\n    const [x2, y2] = path[i + 1];\n    const control1 = [x0 + 2 * (x1 - x0) / 3, y0 + 2 * (y1 - y0) / 3];\n    const control2 = [x2 + 2 * (x1 - x2) / 3, y2 + 2 * (y1 - y2) / 3];\n    bezierPoints.push([[x0, y0], control1, control2, [x2, y2]]);\n    return bezierPoints;\n  }\n\n  #redraw() {\n    if (this.isEmpty()) {\n      this.#updateTransform();\n      return;\n    }\n\n    this.#setStroke();\n    const {\n      canvas,\n      ctx\n    } = this;\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    this.#updateTransform();\n\n    for (const path of this.bezierPath2D) {\n      ctx.stroke(path);\n    }\n  }\n\n  commit() {\n    if (this.#disableEditing) {\n      return;\n    }\n\n    super.commit();\n    this.isEditing = false;\n    this.disableEditMode();\n    this.setInForeground();\n    this.#disableEditing = true;\n    this.div.classList.add(\"disabled\");\n    this.#fitToContent(true);\n    this.select();\n    this.parent.addInkEditorIfNeeded(true);\n    this.moveInDOM();\n    this.div.focus({\n      preventScroll: true\n    });\n  }\n\n  focusin(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n\n    super.focusin(event);\n    this.enableEditMode();\n  }\n\n  #addPointerdownListener() {\n    if (this.#pointerdownAC) {\n      return;\n    }\n\n    this.#pointerdownAC = new AbortController();\n\n    const signal = this._uiManager.combinedSignal(this.#pointerdownAC);\n\n    this.canvas.addEventListener(\"pointerdown\", this.canvasPointerdown.bind(this), {\n      signal\n    });\n  }\n\n  #removePointerdownListener() {\n    this.pointerdownAC?.abort();\n    this.pointerdownAC = null;\n  }\n\n  canvasPointerdown(event) {\n    if (event.button !== 0 || !this.isInEditMode() || this.#disableEditing) {\n      return;\n    }\n\n    this.setInForeground();\n    event.preventDefault();\n\n    if (!this.div.contains(document.activeElement)) {\n      this.div.focus({\n        preventScroll: true\n      });\n    }\n\n    this.#startDrawing(event.offsetX, event.offsetY);\n  }\n\n  canvasPointermove(event) {\n    event.preventDefault();\n    this.#draw(event.offsetX, event.offsetY);\n  }\n\n  canvasPointerup(event) {\n    event.preventDefault();\n    this.#endDrawing(event);\n  }\n\n  canvasPointerleave(event) {\n    this.#endDrawing(event);\n  }\n\n  #endDrawing(event) {\n    this.#drawingAC?.abort();\n    this.#drawingAC = null;\n    this.#addPointerdownListener();\n\n    if (this.#canvasContextMenuTimeoutId) {\n      clearTimeout(this.#canvasContextMenuTimeoutId);\n    }\n\n    this.#canvasContextMenuTimeoutId = setTimeout(() => {\n      this.#canvasContextMenuTimeoutId = null;\n      this.canvas.removeEventListener(\"contextmenu\", noContextMenu);\n    }, 10);\n    this.#stopDrawing(event.offsetX, event.offsetY);\n    this.addToAnnotationStorage();\n    this.setInBackground();\n  }\n\n  #createCanvas() {\n    this.canvas = document.createElement(\"canvas\");\n    this.canvas.width = this.canvas.height = 0;\n    this.canvas.className = \"inkEditorCanvas\";\n    this.canvas.setAttribute(\"data-l10n-id\", \"pdfjs-ink-canvas\");\n    this.div.append(this.canvas);\n    this.ctx = this.canvas.getContext(\"2d\");\n  }\n\n  #createObserver() {\n    this.#observer = new ResizeObserver(entries => {\n      const rect = entries[0].contentRect;\n\n      if (rect.width && rect.height) {\n        this.setDimensions(rect.width, rect.height);\n      }\n    });\n    this.#observer.observe(this.div);\n\n    this._uiManager._signal.addEventListener(\"abort\", () => {\n      this.#observer?.disconnect();\n      this.#observer = null;\n    }, {\n      once: true\n    });\n  }\n\n  get isResizable() {\n    return !this.isEmpty() && this.#disableEditing;\n  }\n\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n\n    let baseX, baseY;\n\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n\n    super.render();\n    this.div.setAttribute(\"data-l10n-id\", \"pdfjs-ink\");\n    const [x, y, w, h] = this.#getInitialBBox();\n    this.setAt(x, y, 0, 0);\n    this.setDims(w, h);\n    this.#createCanvas();\n\n    if (this.width) {\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      this.setAspectRatio(this.width * parentWidth, this.height * parentHeight);\n      this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n      this.#isCanvasInitialized = true;\n      this.#setCanvasDims();\n      this.setDims(this.width * parentWidth, this.height * parentHeight);\n      this.#redraw();\n      this.div.classList.add(\"disabled\");\n    } else {\n      this.div.classList.add(\"editing\");\n      this.enableEditMode();\n    }\n\n    this.#createObserver();\n    return this.div;\n  }\n\n  #setCanvasDims() {\n    if (!this.#isCanvasInitialized) {\n      return;\n    }\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.canvas.width = Math.ceil(this.width * parentWidth);\n    this.canvas.height = Math.ceil(this.height * parentHeight);\n    this.#updateTransform();\n  }\n\n  setDimensions(width, height) {\n    const roundedWidth = Math.round(width);\n    const roundedHeight = Math.round(height);\n\n    if (this.#realWidth === roundedWidth && this.#realHeight === roundedHeight) {\n      return;\n    }\n\n    this.#realWidth = roundedWidth;\n    this.#realHeight = roundedHeight;\n    this.canvas.style.visibility = \"hidden\";\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n    this.fixAndSetPosition();\n\n    if (this.#disableEditing) {\n      this.#setScaleFactor(width, height);\n    }\n\n    this.#setCanvasDims();\n    this.#redraw();\n    this.canvas.style.visibility = \"visible\";\n    this.fixDims();\n  }\n\n  #setScaleFactor(width, height) {\n    const padding = this.#getPadding();\n    const scaleFactorW = (width - padding) / this.#baseWidth;\n    const scaleFactorH = (height - padding) / this.#baseHeight;\n    this.scaleFactor = Math.min(scaleFactorW, scaleFactorH);\n  }\n\n  #updateTransform() {\n    const padding = this.#getPadding() / 2;\n    this.ctx.setTransform(this.scaleFactor, 0, 0, this.scaleFactor, this.translationX * this.scaleFactor + padding, this.translationY * this.scaleFactor + padding);\n  }\n\n  static #buildPath2D(bezier) {\n    const path2D = new Path2D();\n\n    for (let i = 0, ii = bezier.length; i < ii; i++) {\n      const [first, control1, control2, second] = bezier[i];\n\n      if (i === 0) {\n        path2D.moveTo(...first);\n      }\n\n      path2D.bezierCurveTo(control1[0], control1[1], control2[0], control2[1], second[0], second[1]);\n    }\n\n    return path2D;\n  }\n\n  static #toPDFCoordinates(points, rect, rotation) {\n    const [blX, blY, trX, trY] = rect;\n\n    switch (rotation) {\n      case 0:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] += blX;\n          points[i + 1] = trY - points[i + 1];\n        }\n\n        break;\n\n      case 90:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = points[i + 1] + blX;\n          points[i + 1] = x + blY;\n        }\n\n        break;\n\n      case 180:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] = trX - points[i];\n          points[i + 1] += blY;\n        }\n\n        break;\n\n      case 270:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = trX - points[i + 1];\n          points[i + 1] = trY - x;\n        }\n\n        break;\n\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n\n    return points;\n  }\n\n  static #fromPDFCoordinates(points, rect, rotation) {\n    const [blX, blY, trX, trY] = rect;\n\n    switch (rotation) {\n      case 0:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] -= blX;\n          points[i + 1] = trY - points[i + 1];\n        }\n\n        break;\n\n      case 90:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = points[i + 1] - blY;\n          points[i + 1] = x - blX;\n        }\n\n        break;\n\n      case 180:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] = trX - points[i];\n          points[i + 1] -= blY;\n        }\n\n        break;\n\n      case 270:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = trY - points[i + 1];\n          points[i + 1] = trX - x;\n        }\n\n        break;\n\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n\n    return points;\n  }\n\n  #serializePaths(s, tx, ty, rect) {\n    const paths = [];\n    const padding = this.thickness / 2;\n    const shiftX = s * tx + padding;\n    const shiftY = s * ty + padding;\n\n    for (const bezier of this.paths) {\n      const buffer = [];\n      const points = [];\n\n      for (let j = 0, jj = bezier.length; j < jj; j++) {\n        const [first, control1, control2, second] = bezier[j];\n\n        if (first[0] === second[0] && first[1] === second[1] && jj === 1) {\n          const p0 = s * first[0] + shiftX;\n          const p1 = s * first[1] + shiftY;\n          buffer.push(p0, p1);\n          points.push(p0, p1);\n          break;\n        }\n\n        const p10 = s * first[0] + shiftX;\n        const p11 = s * first[1] + shiftY;\n        const p20 = s * control1[0] + shiftX;\n        const p21 = s * control1[1] + shiftY;\n        const p30 = s * control2[0] + shiftX;\n        const p31 = s * control2[1] + shiftY;\n        const p40 = s * second[0] + shiftX;\n        const p41 = s * second[1] + shiftY;\n\n        if (j === 0) {\n          buffer.push(p10, p11);\n          points.push(p10, p11);\n        }\n\n        buffer.push(p20, p21, p30, p31, p40, p41);\n        points.push(p20, p21);\n\n        if (j === jj - 1) {\n          points.push(p40, p41);\n        }\n      }\n\n      paths.push({\n        bezier: InkEditor.#toPDFCoordinates(buffer, rect, this.rotation),\n        points: InkEditor.#toPDFCoordinates(points, rect, this.rotation)\n      });\n    }\n\n    return paths;\n  }\n\n  #getBbox() {\n    let xMin = Infinity;\n    let xMax = -Infinity;\n    let yMin = Infinity;\n    let yMax = -Infinity;\n\n    for (const path of this.paths) {\n      for (const [first, control1, control2, second] of path) {\n        const bbox = Util.bezierBoundingBox(...first, ...control1, ...control2, ...second);\n        xMin = Math.min(xMin, bbox[0]);\n        yMin = Math.min(yMin, bbox[1]);\n        xMax = Math.max(xMax, bbox[2]);\n        yMax = Math.max(yMax, bbox[3]);\n      }\n    }\n\n    return [xMin, yMin, xMax, yMax];\n  }\n\n  #getPadding() {\n    return this.#disableEditing ? Math.ceil(this.thickness * this.parentScale) : 0;\n  }\n\n  #fitToContent(firstTime = false) {\n    if (this.isEmpty()) {\n      return;\n    }\n\n    if (!this.#disableEditing) {\n      this.#redraw();\n      return;\n    }\n\n    const bbox = this.#getBbox();\n    const padding = this.#getPadding();\n    this.#baseWidth = Math.max(AnnotationEditor.MIN_SIZE, bbox[2] - bbox[0]);\n    this.#baseHeight = Math.max(AnnotationEditor.MIN_SIZE, bbox[3] - bbox[1]);\n    const width = Math.ceil(padding + this.#baseWidth * this.scaleFactor);\n    const height = Math.ceil(padding + this.#baseHeight * this.scaleFactor);\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n    this.setAspectRatio(width, height);\n    const prevTranslationX = this.translationX;\n    const prevTranslationY = this.translationY;\n    this.translationX = -bbox[0];\n    this.translationY = -bbox[1];\n    this.#setCanvasDims();\n    this.#redraw();\n    this.#realWidth = width;\n    this.#realHeight = height;\n    this.setDims(width, height);\n    const unscaledPadding = firstTime ? padding / this.scaleFactor / 2 : 0;\n    this.translate(prevTranslationX - this.translationX - unscaledPadding, prevTranslationY - this.translationY - unscaledPadding);\n  }\n\n  static deserialize(data, parent, uiManager) {\n    if (data instanceof InkAnnotationElement) {\n      return null;\n    }\n\n    const editor = super.deserialize(data, parent, uiManager);\n    editor.thickness = data.thickness;\n    editor.color = Util.makeHexColor(...data.color);\n    editor.opacity = data.opacity;\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    const width = editor.width * pageWidth;\n    const height = editor.height * pageHeight;\n    const scaleFactor = editor.parentScale;\n    const padding = data.thickness / 2;\n    editor.#disableEditing = true;\n    editor.#realWidth = Math.round(width);\n    editor.#realHeight = Math.round(height);\n    const {\n      paths,\n      rect,\n      rotation\n    } = data;\n\n    for (let {\n      bezier\n    } of paths) {\n      bezier = InkEditor.#fromPDFCoordinates(bezier, rect, rotation);\n      const path = [];\n      editor.paths.push(path);\n      let p0 = scaleFactor * (bezier[0] - padding);\n      let p1 = scaleFactor * (bezier[1] - padding);\n\n      for (let i = 2, ii = bezier.length; i < ii; i += 6) {\n        const p10 = scaleFactor * (bezier[i] - padding);\n        const p11 = scaleFactor * (bezier[i + 1] - padding);\n        const p20 = scaleFactor * (bezier[i + 2] - padding);\n        const p21 = scaleFactor * (bezier[i + 3] - padding);\n        const p30 = scaleFactor * (bezier[i + 4] - padding);\n        const p31 = scaleFactor * (bezier[i + 5] - padding);\n        path.push([[p0, p1], [p10, p11], [p20, p21], [p30, p31]]);\n        p0 = p30;\n        p1 = p31;\n      }\n\n      const path2D = this.#buildPath2D(path);\n      editor.bezierPath2D.push(path2D);\n    }\n\n    const bbox = editor.#getBbox();\n    editor.#baseWidth = Math.max(AnnotationEditor.MIN_SIZE, bbox[2] - bbox[0]);\n    editor.#baseHeight = Math.max(AnnotationEditor.MIN_SIZE, bbox[3] - bbox[1]);\n    editor.#setScaleFactor(width, height);\n    return editor;\n  }\n\n  serialize() {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    const rect = this.getRect(0, 0);\n\n    const color = AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);\n\n    return {\n      annotationType: AnnotationEditorType.INK,\n      color,\n      thickness: this.thickness,\n      opacity: this.opacity,\n      paths: this.#serializePaths(this.scaleFactor / this.parentScale, this.translationX, this.translationY, rect),\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.rotation,\n      structTreeParentId: this._structTreeParentId\n    };\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/stamp.js\n\nclass StampEditor extends AnnotationEditor {\n  #bitmap = null;\n  #bitmapId = null;\n  #bitmapPromise = null;\n  #bitmapUrl = null;\n  #bitmapFile = null;\n  #bitmapFileName = \"\";\n  #canvas = null;\n  #observer = null;\n  #resizeTimeoutId = null;\n  #isSvg = false;\n  #hasBeenAddedInUndoStack = false;\n  static _type = \"stamp\";\n  static _editorType = AnnotationEditorType.STAMP;\n\n  constructor(params) {\n    super({ ...params,\n      name: \"stampEditor\"\n    });\n    this.#bitmapUrl = params.bitmapUrl;\n    this.#bitmapFile = params.bitmapFile;\n  }\n\n  static initialize(l10n, uiManager) {\n    AnnotationEditor.initialize(l10n, uiManager);\n  }\n\n  static get supportedTypes() {\n    const types = [\"apng\", \"avif\", \"bmp\", \"gif\", \"jpeg\", \"png\", \"svg+xml\", \"webp\", \"x-icon\"];\n    return shadow(this, \"supportedTypes\", types.map(type => `image/${type}`));\n  }\n\n  static get supportedTypesStr() {\n    return shadow(this, \"supportedTypesStr\", this.supportedTypes.join(\",\"));\n  }\n\n  static isHandlingMimeForPasting(mime) {\n    return this.supportedTypes.includes(mime);\n  }\n\n  static paste(item, parent) {\n    parent.pasteEditor(AnnotationEditorType.STAMP, {\n      bitmapFile: item.getAsFile()\n    });\n  }\n\n  altTextFinish() {\n    if (this._uiManager.useNewAltTextFlow) {\n      this.div.hidden = false;\n    }\n\n    super.altTextFinish();\n  }\n\n  get telemetryFinalData() {\n    return {\n      type: \"stamp\",\n      hasAltText: !!this.altTextData?.altText\n    };\n  }\n\n  static computeTelemetryFinalData(data) {\n    const hasAltTextStats = data.get(\"hasAltText\");\n    return {\n      hasAltText: hasAltTextStats.get(true) ?? 0,\n      hasNoAltText: hasAltTextStats.get(false) ?? 0\n    };\n  }\n\n  #getBitmapFetched(data, fromId = false) {\n    if (!data) {\n      this.remove();\n      return;\n    }\n\n    this.#bitmap = data.bitmap;\n\n    if (!fromId) {\n      this.#bitmapId = data.id;\n      this.#isSvg = data.isSvg;\n    }\n\n    if (data.file) {\n      this.#bitmapFileName = data.file.name;\n    }\n\n    this.#createCanvas();\n  }\n\n  #getBitmapDone() {\n    this.#bitmapPromise = null;\n\n    this._uiManager.enableWaiting(false);\n\n    if (!this.#canvas) {\n      return;\n    }\n\n    if (this._uiManager.useNewAltTextWhenAddingImage && this._uiManager.useNewAltTextFlow && this.#bitmap) {\n      this._editToolbar.hide();\n\n      this._uiManager.editAltText(this, true);\n\n      return;\n    }\n\n    if (!this._uiManager.useNewAltTextWhenAddingImage && this._uiManager.useNewAltTextFlow && this.#bitmap) {\n      this._reportTelemetry({\n        action: \"pdfjs.image.image_added\",\n        data: {\n          alt_text_modal: false,\n          alt_text_type: \"empty\"\n        }\n      });\n\n      try {\n        this.mlGuessAltText();\n      } catch {}\n    }\n\n    this.div.focus();\n  }\n\n  mlGuessAltText(imageData = null, updateAltTextData = true) {\n    var _this32 = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this32.hasAltTextData()) {\n        return null;\n      }\n\n      const {\n        mlManager\n      } = _this32._uiManager;\n\n      if (!mlManager) {\n        throw new Error(\"No ML.\");\n      }\n\n      if (!(yield mlManager.isEnabledFor(\"altText\"))) {\n        throw new Error(\"ML isn't enabled for alt text.\");\n      }\n\n      const {\n        data,\n        width,\n        height\n      } = imageData || _this32.copyCanvas(null, true).imageData;\n\n      const response = yield mlManager.guess({\n        name: \"altText\",\n        request: {\n          data,\n          width,\n          height,\n          channels: data.length / (width * height)\n        }\n      });\n\n      if (!response) {\n        throw new Error(\"No response from the AI service.\");\n      }\n\n      if (response.error) {\n        throw new Error(\"Error from the AI service.\");\n      }\n\n      if (response.cancel) {\n        return null;\n      }\n\n      if (!response.output) {\n        throw new Error(\"No valid response from the AI service.\");\n      }\n\n      const altText = response.output;\n      yield _this32.setGuessedAltText(altText);\n\n      if (updateAltTextData && !_this32.hasAltTextData()) {\n        _this32.altTextData = {\n          alt: altText,\n          decorative: false\n        };\n      }\n\n      return altText;\n    })();\n  }\n\n  #getBitmap() {\n    var _this33 = this;\n\n    if (this.#bitmapId) {\n      this._uiManager.enableWaiting(true);\n\n      this._uiManager.imageManager.getFromId(this.#bitmapId).then(data => this.#getBitmapFetched(data, true)).finally(() => this.#getBitmapDone());\n\n      return;\n    }\n\n    if (this.#bitmapUrl) {\n      const url = this.#bitmapUrl;\n      this.#bitmapUrl = null;\n\n      this._uiManager.enableWaiting(true);\n\n      this.#bitmapPromise = this._uiManager.imageManager.getFromUrl(url).then(data => this.#getBitmapFetched(data)).finally(() => this.#getBitmapDone());\n      return;\n    }\n\n    if (this.#bitmapFile) {\n      const file = this.#bitmapFile;\n      this.#bitmapFile = null;\n\n      this._uiManager.enableWaiting(true);\n\n      this.#bitmapPromise = this._uiManager.imageManager.getFromFile(file).then(data => this.#getBitmapFetched(data)).finally(() => this.#getBitmapDone());\n      return;\n    }\n\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = StampEditor.supportedTypesStr;\n    const signal = this._uiManager._signal;\n    this.#bitmapPromise = new Promise(resolve => {\n      input.addEventListener(\"change\", /*#__PURE__*/_asyncToGenerator(function* () {\n        if (!input.files || input.files.length === 0) {\n          _this33.remove();\n        } else {\n          _this33._uiManager.enableWaiting(true);\n\n          const data = yield _this33._uiManager.imageManager.getFromFile(input.files[0]);\n\n          _this33._reportTelemetry({\n            action: \"pdfjs.image.image_selected\",\n            data: {\n              alt_text_modal: _this33._uiManager.useNewAltTextFlow\n            }\n          });\n\n          _this33.#getBitmapFetched(data);\n        }\n\n        resolve();\n      }), {\n        signal\n      });\n      input.addEventListener(\"cancel\", () => {\n        this.remove();\n        resolve();\n      }, {\n        signal\n      });\n    }).finally(() => this.#getBitmapDone());\n    input.click();\n  }\n\n  remove() {\n    if (this.#bitmapId) {\n      this.#bitmap = null;\n\n      this._uiManager.imageManager.deleteId(this.#bitmapId);\n\n      this.#canvas?.remove();\n      this.#canvas = null;\n      this.#observer?.disconnect();\n      this.#observer = null;\n\n      if (this.#resizeTimeoutId) {\n        clearTimeout(this.#resizeTimeoutId);\n        this.#resizeTimeoutId = null;\n      }\n    }\n\n    super.remove();\n  }\n\n  rebuild() {\n    if (!this.parent) {\n      if (this.#bitmapId) {\n        this.#getBitmap();\n      }\n\n      return;\n    }\n\n    super.rebuild();\n\n    if (this.div === null) {\n      return;\n    }\n\n    if (this.#bitmapId && this.#canvas === null) {\n      this.#getBitmap();\n    }\n\n    if (!this.isAttachedToDOM) {\n      this.parent.add(this);\n    }\n  }\n\n  onceAdded() {\n    this._isDraggable = true;\n    this.div.focus();\n  }\n\n  isEmpty() {\n    return !(this.#bitmapPromise || this.#bitmap || this.#bitmapUrl || this.#bitmapFile || this.#bitmapId);\n  }\n\n  get isResizable() {\n    return true;\n  }\n\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n\n    let baseX, baseY;\n\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n\n    super.render();\n    this.div.hidden = true;\n    this.addAltTextButton();\n\n    if (this.#bitmap) {\n      this.#createCanvas();\n    } else {\n      this.#getBitmap();\n    }\n\n    if (this.width) {\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n    }\n\n    return this.div;\n  }\n\n  #createCanvas() {\n    const {\n      div\n    } = this;\n    let {\n      width,\n      height\n    } = this.#bitmap;\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    const MAX_RATIO = 0.75;\n\n    if (this.width) {\n      width = this.width * pageWidth;\n      height = this.height * pageHeight;\n    } else if (width > MAX_RATIO * pageWidth || height > MAX_RATIO * pageHeight) {\n      const factor = Math.min(MAX_RATIO * pageWidth / width, MAX_RATIO * pageHeight / height);\n      width *= factor;\n      height *= factor;\n    }\n\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.setDims(width * parentWidth / pageWidth, height * parentHeight / pageHeight);\n\n    this._uiManager.enableWaiting(false);\n\n    const canvas = this.#canvas = document.createElement(\"canvas\");\n    div.append(canvas);\n\n    if (!this._uiManager.useNewAltTextWhenAddingImage || !this._uiManager.useNewAltTextFlow) {\n      div.hidden = false;\n    }\n\n    this.#drawBitmap(width, height);\n    this.#createObserver();\n\n    if (!this.#hasBeenAddedInUndoStack) {\n      this.parent.addUndoableEditor(this);\n      this.#hasBeenAddedInUndoStack = true;\n    }\n\n    this._reportTelemetry({\n      action: \"inserted_image\"\n    });\n\n    if (this.#bitmapFileName) {\n      canvas.setAttribute(\"aria-label\", this.#bitmapFileName);\n    }\n  }\n\n  copyCanvas(maxDimension, createImageData = false) {\n    if (!maxDimension) {\n      maxDimension = 224;\n    }\n\n    const {\n      width: bitmapWidth,\n      height: bitmapHeight\n    } = this.#bitmap;\n    const canvas = document.createElement(\"canvas\");\n    let bitmap = this.#bitmap;\n    let width = bitmapWidth,\n        height = bitmapHeight;\n\n    if (bitmapWidth > maxDimension || bitmapHeight > maxDimension) {\n      const ratio = Math.min(maxDimension / bitmapWidth, maxDimension / bitmapHeight);\n      width = Math.floor(bitmapWidth * ratio);\n      height = Math.floor(bitmapHeight * ratio);\n\n      if (!this.#isSvg) {\n        bitmap = this.#scaleBitmap(width, height);\n      }\n    }\n\n    canvas.width = width;\n    canvas.height = height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.filter = this._uiManager.hcmFilter;\n    let white = \"white\",\n        black = \"#cfcfd8\";\n\n    if (this._uiManager.hcmFilter !== \"none\") {\n      black = \"black\";\n    } else if (window.matchMedia?.(\"(prefers-color-scheme: dark)\").matches) {\n      white = \"#8f8f9d\";\n      black = \"#42414d\";\n    }\n\n    const boxDim = 15;\n    const pattern = new OffscreenCanvas(boxDim * 2, boxDim * 2);\n    const patternCtx = pattern.getContext(\"2d\");\n    patternCtx.fillStyle = white;\n    patternCtx.fillRect(0, 0, boxDim * 2, boxDim * 2);\n    patternCtx.fillStyle = black;\n    patternCtx.fillRect(0, 0, boxDim, boxDim);\n    patternCtx.fillRect(boxDim, boxDim, boxDim, boxDim);\n    ctx.fillStyle = ctx.createPattern(pattern, \"repeat\");\n    ctx.fillRect(0, 0, width, height);\n\n    if (createImageData) {\n      const offscreen = new OffscreenCanvas(width, height);\n      const offscreenCtx = offscreen.getContext(\"2d\", {\n        willReadFrequently: true\n      });\n      offscreenCtx.drawImage(bitmap, 0, 0, bitmap.width, bitmap.height, 0, 0, width, height);\n      const data = offscreenCtx.getImageData(0, 0, width, height).data;\n      ctx.drawImage(offscreen, 0, 0);\n      return {\n        canvas,\n        imageData: {\n          width,\n          height,\n          data\n        }\n      };\n    }\n\n    ctx.drawImage(bitmap, 0, 0, bitmap.width, bitmap.height, 0, 0, width, height);\n    return {\n      canvas,\n      imageData: null\n    };\n  }\n\n  #setDimensions(width, height) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n    this.setDims(width, height);\n\n    if (this._initialOptions?.isCentered) {\n      this.center();\n    } else {\n      this.fixAndSetPosition();\n    }\n\n    this._initialOptions = null;\n\n    if (this.#resizeTimeoutId !== null) {\n      clearTimeout(this.#resizeTimeoutId);\n    }\n\n    const TIME_TO_WAIT = 200;\n    this.#resizeTimeoutId = setTimeout(() => {\n      this.#resizeTimeoutId = null;\n      this.#drawBitmap(width, height);\n    }, TIME_TO_WAIT);\n  }\n\n  #scaleBitmap(width, height) {\n    const {\n      width: bitmapWidth,\n      height: bitmapHeight\n    } = this.#bitmap;\n    let newWidth = bitmapWidth;\n    let newHeight = bitmapHeight;\n    let bitmap = this.#bitmap;\n\n    while (newWidth > 2 * width || newHeight > 2 * height) {\n      const prevWidth = newWidth;\n      const prevHeight = newHeight;\n\n      if (newWidth > 2 * width) {\n        newWidth = newWidth >= 16384 ? Math.floor(newWidth / 2) - 1 : Math.ceil(newWidth / 2);\n      }\n\n      if (newHeight > 2 * height) {\n        newHeight = newHeight >= 16384 ? Math.floor(newHeight / 2) - 1 : Math.ceil(newHeight / 2);\n      }\n\n      const offscreen = new OffscreenCanvas(newWidth, newHeight);\n      const ctx = offscreen.getContext(\"2d\");\n      ctx.drawImage(bitmap, 0, 0, prevWidth, prevHeight, 0, 0, newWidth, newHeight);\n      bitmap = offscreen.transferToImageBitmap();\n    }\n\n    return bitmap;\n  }\n\n  #drawBitmap(width, height) {\n    width = Math.ceil(width);\n    height = Math.ceil(height);\n    const canvas = this.#canvas;\n\n    if (!canvas || canvas.width === width && canvas.height === height) {\n      return;\n    }\n\n    canvas.width = width;\n    canvas.height = height;\n    const bitmap = this.#isSvg ? this.#bitmap : this.#scaleBitmap(width, height);\n    const ctx = canvas.getContext(\"2d\");\n    ctx.filter = this._uiManager.hcmFilter;\n    ctx.drawImage(bitmap, 0, 0, bitmap.width, bitmap.height, 0, 0, width, height);\n  }\n\n  getImageForAltText() {\n    return this.#canvas;\n  }\n\n  #serializeBitmap(toUrl) {\n    if (toUrl) {\n      if (this.#isSvg) {\n        const url = this._uiManager.imageManager.getSvgUrl(this.#bitmapId);\n\n        if (url) {\n          return url;\n        }\n      }\n\n      const canvas = document.createElement(\"canvas\");\n      ({\n        width: canvas.width,\n        height: canvas.height\n      } = this.#bitmap);\n      const ctx = canvas.getContext(\"2d\");\n      ctx.drawImage(this.#bitmap, 0, 0);\n      return canvas.toDataURL();\n    }\n\n    if (this.#isSvg) {\n      const [pageWidth, pageHeight] = this.pageDimensions;\n      const width = Math.round(this.width * pageWidth * PixelsPerInch.PDF_TO_CSS_UNITS);\n      const height = Math.round(this.height * pageHeight * PixelsPerInch.PDF_TO_CSS_UNITS);\n      const offscreen = new OffscreenCanvas(width, height);\n      const ctx = offscreen.getContext(\"2d\");\n      ctx.drawImage(this.#bitmap, 0, 0, this.#bitmap.width, this.#bitmap.height, 0, 0, width, height);\n      return offscreen.transferToImageBitmap();\n    }\n\n    return structuredClone(this.#bitmap);\n  }\n\n  #createObserver() {\n    if (!this._uiManager._signal) {\n      return;\n    }\n\n    this.#observer = new ResizeObserver(entries => {\n      const rect = entries[0].contentRect;\n\n      if (rect.width && rect.height) {\n        this.#setDimensions(rect.width, rect.height);\n      }\n    });\n    this.#observer.observe(this.div);\n\n    this._uiManager._signal.addEventListener(\"abort\", () => {\n      this.#observer?.disconnect();\n      this.#observer = null;\n    }, {\n      once: true\n    });\n  }\n\n  static deserialize(data, parent, uiManager) {\n    if (data instanceof StampAnnotationElement) {\n      return null;\n    }\n\n    const editor = super.deserialize(data, parent, uiManager);\n    const {\n      rect,\n      bitmapUrl,\n      bitmapId,\n      isSvg,\n      accessibilityData\n    } = data;\n\n    if (bitmapId && uiManager.imageManager.isValidId(bitmapId)) {\n      editor.#bitmapId = bitmapId;\n    } else {\n      editor.#bitmapUrl = bitmapUrl;\n    }\n\n    editor.#isSvg = isSvg;\n    const [parentWidth, parentHeight] = editor.pageDimensions;\n    editor.width = (rect[2] - rect[0]) / parentWidth;\n    editor.height = (rect[3] - rect[1]) / parentHeight;\n\n    if (accessibilityData) {\n      editor.altTextData = accessibilityData;\n    }\n\n    return editor;\n  }\n\n  serialize(isForCopying = false, context = null) {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    const serialized = {\n      annotationType: AnnotationEditorType.STAMP,\n      bitmapId: this.#bitmapId,\n      pageIndex: this.pageIndex,\n      rect: this.getRect(0, 0),\n      rotation: this.rotation,\n      isSvg: this.#isSvg,\n      structTreeParentId: this._structTreeParentId\n    };\n\n    if (isForCopying) {\n      serialized.bitmapUrl = this.#serializeBitmap(true);\n      serialized.accessibilityData = this.serializeAltText(true);\n      return serialized;\n    }\n\n    const {\n      decorative,\n      altText\n    } = this.serializeAltText(false);\n\n    if (!decorative && altText) {\n      serialized.accessibilityData = {\n        type: \"Figure\",\n        alt: altText\n      };\n    }\n\n    if (context === null) {\n      return serialized;\n    }\n\n    context.stamps ||= new Map();\n    const area = this.#isSvg ? (serialized.rect[2] - serialized.rect[0]) * (serialized.rect[3] - serialized.rect[1]) : null;\n\n    if (!context.stamps.has(this.#bitmapId)) {\n      context.stamps.set(this.#bitmapId, {\n        area,\n        serialized\n      });\n      serialized.bitmap = this.#serializeBitmap(false);\n    } else if (this.#isSvg) {\n      const prevData = context.stamps.get(this.#bitmapId);\n\n      if (area > prevData.area) {\n        prevData.area = area;\n        prevData.serialized.bitmap.close();\n        prevData.serialized.bitmap = this.#serializeBitmap(false);\n      }\n    }\n\n    return serialized;\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/editor/annotation_editor_layer.js\n\nclass AnnotationEditorLayer {\n  #accessibilityManager;\n  #allowClick = false;\n  #annotationLayer = null;\n  #clickAC = null;\n  #editorFocusTimeoutId = null;\n  #editors = new Map();\n  #hadPointerDown = false;\n  #isCleaningUp = false;\n  #isDisabling = false;\n  #textLayer = null;\n  #textSelectionAC = null;\n  #uiManager;\n  static _initialized = false;\n  static #editorTypes = new Map([FreeTextEditor, InkEditor, StampEditor, HighlightEditor].map(type => [type._editorType, type]));\n\n  constructor({\n    uiManager,\n    pageIndex,\n    div,\n    accessibilityManager,\n    annotationLayer,\n    drawLayer,\n    textLayer,\n    viewport,\n    l10n\n  }) {\n    const editorTypes = [...AnnotationEditorLayer.#editorTypes.values()];\n\n    if (!AnnotationEditorLayer._initialized) {\n      AnnotationEditorLayer._initialized = true;\n\n      for (const editorType of editorTypes) {\n        editorType.initialize(l10n, uiManager);\n      }\n    }\n\n    uiManager.registerEditorTypes(editorTypes);\n    this.#uiManager = uiManager;\n    this.pageIndex = pageIndex;\n    this.div = div;\n    this.#accessibilityManager = accessibilityManager;\n    this.#annotationLayer = annotationLayer;\n    this.viewport = viewport;\n    this.#textLayer = textLayer;\n    this.drawLayer = drawLayer;\n    this.#uiManager.addLayer(this);\n  }\n\n  get isEmpty() {\n    return this.#editors.size === 0;\n  }\n\n  get isInvisible() {\n    return this.isEmpty && this.#uiManager.getMode() === AnnotationEditorType.NONE;\n  }\n\n  updateToolbar(mode) {\n    this.#uiManager.updateToolbar(mode);\n  }\n\n  updateMode(mode = this.#uiManager.getMode()) {\n    this.#cleanup();\n\n    switch (mode) {\n      case AnnotationEditorType.NONE:\n        this.disableTextSelection();\n        this.togglePointerEvents(false);\n        this.toggleAnnotationLayerPointerEvents(true);\n        this.disableClick();\n        return;\n\n      case AnnotationEditorType.INK:\n        this.addInkEditorIfNeeded(false);\n        this.disableTextSelection();\n        this.togglePointerEvents(true);\n        this.disableClick();\n        break;\n\n      case AnnotationEditorType.HIGHLIGHT:\n        this.enableTextSelection();\n        this.togglePointerEvents(false);\n        this.disableClick();\n        break;\n\n      default:\n        this.disableTextSelection();\n        this.togglePointerEvents(true);\n        this.enableClick();\n    }\n\n    this.toggleAnnotationLayerPointerEvents(false);\n    const {\n      classList\n    } = this.div;\n\n    for (const editorType of AnnotationEditorLayer.#editorTypes.values()) {\n      classList.toggle(`${editorType._type}Editing`, mode === editorType._editorType);\n    }\n\n    this.div.hidden = false;\n  }\n\n  hasTextLayer(textLayer) {\n    return textLayer === this.#textLayer?.div;\n  }\n\n  addInkEditorIfNeeded(isCommitting) {\n    if (this.#uiManager.getMode() !== AnnotationEditorType.INK) {\n      return;\n    }\n\n    if (!isCommitting) {\n      for (const editor of this.#editors.values()) {\n        if (editor.isEmpty()) {\n          editor.setInBackground();\n          return;\n        }\n      }\n    }\n\n    const editor = this.createAndAddNewEditor({\n      offsetX: 0,\n      offsetY: 0\n    }, false);\n    editor.setInBackground();\n  }\n\n  setEditingState(isEditing) {\n    this.#uiManager.setEditingState(isEditing);\n  }\n\n  addCommands(params) {\n    this.#uiManager.addCommands(params);\n  }\n\n  toggleDrawing(enabled = false) {\n    this.div.classList.toggle(\"drawing\", !enabled);\n  }\n\n  togglePointerEvents(enabled = false) {\n    this.div.classList.toggle(\"disabled\", !enabled);\n  }\n\n  toggleAnnotationLayerPointerEvents(enabled = false) {\n    this.#annotationLayer?.div.classList.toggle(\"disabled\", !enabled);\n  }\n\n  enable() {\n    this.div.tabIndex = 0;\n    this.togglePointerEvents(true);\n    const annotationElementIds = new Set();\n\n    for (const editor of this.#editors.values()) {\n      editor.enableEditing();\n      editor.show(true);\n\n      if (editor.annotationElementId) {\n        this.#uiManager.removeChangedExistingAnnotation(editor);\n        annotationElementIds.add(editor.annotationElementId);\n      }\n    }\n\n    if (!this.#annotationLayer) {\n      return;\n    }\n\n    const editables = this.#annotationLayer.getEditableAnnotations();\n\n    for (const editable of editables) {\n      editable.hide();\n\n      if (this.#uiManager.isDeletedAnnotationElement(editable.data.id)) {\n        continue;\n      }\n\n      if (annotationElementIds.has(editable.data.id)) {\n        continue;\n      }\n\n      const editor = this.deserialize(editable);\n\n      if (!editor) {\n        continue;\n      }\n\n      this.addOrRebuild(editor);\n      editor.enableEditing();\n    }\n  }\n\n  disable() {\n    this.#isDisabling = true;\n    this.div.tabIndex = -1;\n    this.togglePointerEvents(false);\n    const changedAnnotations = new Map();\n    const resetAnnotations = new Map();\n\n    for (const editor of this.#editors.values()) {\n      editor.disableEditing();\n\n      if (!editor.annotationElementId) {\n        continue;\n      }\n\n      if (editor.serialize() !== null) {\n        changedAnnotations.set(editor.annotationElementId, editor);\n        continue;\n      } else {\n        resetAnnotations.set(editor.annotationElementId, editor);\n      }\n\n      this.getEditableAnnotation(editor.annotationElementId)?.show();\n      editor.remove();\n    }\n\n    if (this.#annotationLayer) {\n      const editables = this.#annotationLayer.getEditableAnnotations();\n\n      for (const editable of editables) {\n        const {\n          id\n        } = editable.data;\n\n        if (this.#uiManager.isDeletedAnnotationElement(id)) {\n          continue;\n        }\n\n        let editor = resetAnnotations.get(id);\n\n        if (editor) {\n          editor.resetAnnotationElement(editable);\n          editor.show(false);\n          editable.show();\n          continue;\n        }\n\n        editor = changedAnnotations.get(id);\n\n        if (editor) {\n          this.#uiManager.addChangedExistingAnnotation(editor);\n          editor.renderAnnotationElement(editable);\n          editor.show(false);\n        }\n\n        editable.show();\n      }\n    }\n\n    this.#cleanup();\n\n    if (this.isEmpty) {\n      this.div.hidden = true;\n    }\n\n    const {\n      classList\n    } = this.div;\n\n    for (const editorType of AnnotationEditorLayer.#editorTypes.values()) {\n      classList.remove(`${editorType._type}Editing`);\n    }\n\n    this.disableTextSelection();\n    this.toggleAnnotationLayerPointerEvents(true);\n    this.#isDisabling = false;\n  }\n\n  getEditableAnnotation(id) {\n    return this.#annotationLayer?.getEditableAnnotation(id) || null;\n  }\n\n  setActiveEditor(editor) {\n    const currentActive = this.#uiManager.getActive();\n\n    if (currentActive === editor) {\n      return;\n    }\n\n    this.#uiManager.setActiveEditor(editor);\n  }\n\n  enableTextSelection() {\n    this.div.tabIndex = -1;\n\n    if (this.#textLayer?.div && !this.#textSelectionAC) {\n      this.#textSelectionAC = new AbortController();\n      const signal = this.#uiManager.combinedSignal(this.#textSelectionAC);\n      this.#textLayer.div.addEventListener(\"pointerdown\", this.#textLayerPointerDown.bind(this), {\n        signal\n      });\n      this.#textLayer.div.classList.add(\"highlighting\");\n    }\n  }\n\n  disableTextSelection() {\n    this.div.tabIndex = 0;\n\n    if (this.#textLayer?.div && this.#textSelectionAC) {\n      this.#textSelectionAC.abort();\n      this.#textSelectionAC = null;\n      this.#textLayer.div.classList.remove(\"highlighting\");\n    }\n  }\n\n  #textLayerPointerDown(event) {\n    this.#uiManager.unselectAll();\n    const {\n      target\n    } = event;\n\n    if (target === this.#textLayer.div || target.classList.contains(\"endOfContent\") && this.#textLayer.div.contains(target)) {\n      const {\n        isMac\n      } = util_FeatureTest.platform;\n\n      if (event.button !== 0 || event.ctrlKey && isMac) {\n        return;\n      }\n\n      this.#uiManager.showAllEditors(\"highlight\", true, true);\n      this.#textLayer.div.classList.add(\"free\");\n      this.toggleDrawing();\n      HighlightEditor.startHighlighting(this, this.#uiManager.direction === \"ltr\", event);\n      this.#textLayer.div.addEventListener(\"pointerup\", () => {\n        this.#textLayer.div.classList.remove(\"free\");\n        this.toggleDrawing(true);\n      }, {\n        once: true,\n        signal: this.#uiManager._signal\n      });\n      event.preventDefault();\n    }\n  }\n\n  enableClick() {\n    if (this.#clickAC) {\n      return;\n    }\n\n    this.#clickAC = new AbortController();\n    const signal = this.#uiManager.combinedSignal(this.#clickAC);\n    this.div.addEventListener(\"pointerdown\", this.pointerdown.bind(this), {\n      signal\n    });\n    this.div.addEventListener(\"pointerup\", this.pointerup.bind(this), {\n      signal\n    });\n  }\n\n  disableClick() {\n    this.#clickAC?.abort();\n    this.#clickAC = null;\n  }\n\n  attach(editor) {\n    this.#editors.set(editor.id, editor);\n    const {\n      annotationElementId\n    } = editor;\n\n    if (annotationElementId && this.#uiManager.isDeletedAnnotationElement(annotationElementId)) {\n      this.#uiManager.removeDeletedAnnotationElement(editor);\n    }\n  }\n\n  detach(editor) {\n    this.#editors.delete(editor.id);\n    this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n\n    if (!this.#isDisabling && editor.annotationElementId) {\n      this.#uiManager.addDeletedAnnotationElement(editor);\n    }\n  }\n\n  remove(editor) {\n    this.detach(editor);\n    this.#uiManager.removeEditor(editor);\n    editor.div.remove();\n    editor.isAttachedToDOM = false;\n\n    if (!this.#isCleaningUp) {\n      this.addInkEditorIfNeeded(false);\n    }\n  }\n\n  changeParent(editor) {\n    if (editor.parent === this) {\n      return;\n    }\n\n    if (editor.parent && editor.annotationElementId) {\n      this.#uiManager.addDeletedAnnotationElement(editor.annotationElementId);\n      AnnotationEditor.deleteAnnotationElement(editor);\n      editor.annotationElementId = null;\n    }\n\n    this.attach(editor);\n    editor.parent?.detach(editor);\n    editor.setParent(this);\n\n    if (editor.div && editor.isAttachedToDOM) {\n      editor.div.remove();\n      this.div.append(editor.div);\n    }\n  }\n\n  add(editor) {\n    if (editor.parent === this && editor.isAttachedToDOM) {\n      return;\n    }\n\n    this.changeParent(editor);\n    this.#uiManager.addEditor(editor);\n    this.attach(editor);\n\n    if (!editor.isAttachedToDOM) {\n      const div = editor.render();\n      this.div.append(div);\n      editor.isAttachedToDOM = true;\n    }\n\n    editor.fixAndSetPosition();\n    editor.onceAdded();\n    this.#uiManager.addToAnnotationStorage(editor);\n\n    editor._reportTelemetry(editor.telemetryInitialData);\n  }\n\n  moveEditorInDOM(editor) {\n    if (!editor.isAttachedToDOM) {\n      return;\n    }\n\n    const {\n      activeElement\n    } = document;\n\n    if (editor.div.contains(activeElement) && !this.#editorFocusTimeoutId) {\n      editor._focusEventsAllowed = false;\n      this.#editorFocusTimeoutId = setTimeout(() => {\n        this.#editorFocusTimeoutId = null;\n\n        if (!editor.div.contains(document.activeElement)) {\n          editor.div.addEventListener(\"focusin\", () => {\n            editor._focusEventsAllowed = true;\n          }, {\n            once: true,\n            signal: this.#uiManager._signal\n          });\n          activeElement.focus();\n        } else {\n          editor._focusEventsAllowed = true;\n        }\n      }, 0);\n    }\n\n    editor._structTreeParentId = this.#accessibilityManager?.moveElementInDOM(this.div, editor.div, editor.contentDiv, true);\n  }\n\n  addOrRebuild(editor) {\n    if (editor.needsToBeRebuilt()) {\n      editor.parent ||= this;\n      editor.rebuild();\n      editor.show();\n    } else {\n      this.add(editor);\n    }\n  }\n\n  addUndoableEditor(editor) {\n    const cmd = () => editor._uiManager.rebuild(editor);\n\n    const undo = () => {\n      editor.remove();\n    };\n\n    this.addCommands({\n      cmd,\n      undo,\n      mustExec: false\n    });\n  }\n\n  getNextId() {\n    return this.#uiManager.getId();\n  }\n\n  get #currentEditorType() {\n    return AnnotationEditorLayer.#editorTypes.get(this.#uiManager.getMode());\n  }\n\n  combinedSignal(ac) {\n    return this.#uiManager.combinedSignal(ac);\n  }\n\n  #createNewEditor(params) {\n    const editorType = this.#currentEditorType;\n    return editorType ? new editorType.prototype.constructor(params) : null;\n  }\n\n  canCreateNewEmptyEditor() {\n    return this.#currentEditorType?.canCreateNewEmptyEditor();\n  }\n\n  pasteEditor(mode, params) {\n    this.#uiManager.updateToolbar(mode);\n    this.#uiManager.updateMode(mode);\n    const {\n      offsetX,\n      offsetY\n    } = this.#getCenterPoint();\n    const id = this.getNextId();\n    const editor = this.#createNewEditor({\n      parent: this,\n      id,\n      x: offsetX,\n      y: offsetY,\n      uiManager: this.#uiManager,\n      isCentered: true,\n      ...params\n    });\n\n    if (editor) {\n      this.add(editor);\n    }\n  }\n\n  deserialize(data) {\n    return AnnotationEditorLayer.#editorTypes.get(data.annotationType ?? data.annotationEditorType)?.deserialize(data, this, this.#uiManager) || null;\n  }\n\n  createAndAddNewEditor(event, isCentered, data = {}) {\n    const id = this.getNextId();\n    const editor = this.#createNewEditor({\n      parent: this,\n      id,\n      x: event.offsetX,\n      y: event.offsetY,\n      uiManager: this.#uiManager,\n      isCentered,\n      ...data\n    });\n\n    if (editor) {\n      this.add(editor);\n    }\n\n    return editor;\n  }\n\n  #getCenterPoint() {\n    const {\n      x,\n      y,\n      width,\n      height\n    } = this.div.getBoundingClientRect();\n    const tlX = Math.max(0, x);\n    const tlY = Math.max(0, y);\n    const brX = Math.min(window.innerWidth, x + width);\n    const brY = Math.min(window.innerHeight, y + height);\n    const centerX = (tlX + brX) / 2 - x;\n    const centerY = (tlY + brY) / 2 - y;\n    const [offsetX, offsetY] = this.viewport.rotation % 180 === 0 ? [centerX, centerY] : [centerY, centerX];\n    return {\n      offsetX,\n      offsetY\n    };\n  }\n\n  addNewEditor() {\n    this.createAndAddNewEditor(this.#getCenterPoint(), true);\n  }\n\n  setSelected(editor) {\n    this.#uiManager.setSelected(editor);\n  }\n\n  toggleSelected(editor) {\n    this.#uiManager.toggleSelected(editor);\n  }\n\n  isSelected(editor) {\n    return this.#uiManager.isSelected(editor);\n  }\n\n  unselect(editor) {\n    this.#uiManager.unselect(editor);\n  }\n\n  pointerup(event) {\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n\n    if (event.button !== 0 || event.ctrlKey && isMac) {\n      return;\n    }\n\n    if (event.target !== this.div) {\n      return;\n    }\n\n    if (!this.#hadPointerDown) {\n      return;\n    }\n\n    this.#hadPointerDown = false;\n\n    if (!this.#allowClick) {\n      this.#allowClick = true;\n      return;\n    }\n\n    if (this.#uiManager.getMode() === AnnotationEditorType.STAMP) {\n      this.#uiManager.unselectAll();\n      return;\n    }\n\n    this.createAndAddNewEditor(event, false);\n  }\n\n  pointerdown(event) {\n    if (this.#uiManager.getMode() === AnnotationEditorType.HIGHLIGHT) {\n      this.enableTextSelection();\n    }\n\n    if (this.#hadPointerDown) {\n      this.#hadPointerDown = false;\n      return;\n    }\n\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n\n    if (event.button !== 0 || event.ctrlKey && isMac) {\n      return;\n    }\n\n    if (event.target !== this.div) {\n      return;\n    }\n\n    this.#hadPointerDown = true;\n    const editor = this.#uiManager.getActive();\n    this.#allowClick = !editor || editor.isEmpty();\n  }\n\n  findNewParent(editor, x, y) {\n    const layer = this.#uiManager.findParent(x, y);\n\n    if (layer === null || layer === this) {\n      return false;\n    }\n\n    layer.changeParent(editor);\n    return true;\n  }\n\n  destroy() {\n    if (this.#uiManager.getActive()?.parent === this) {\n      this.#uiManager.commitOrRemove();\n      this.#uiManager.setActiveEditor(null);\n    }\n\n    if (this.#editorFocusTimeoutId) {\n      clearTimeout(this.#editorFocusTimeoutId);\n      this.#editorFocusTimeoutId = null;\n    }\n\n    for (const editor of this.#editors.values()) {\n      this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n      editor.setParent(null);\n      editor.isAttachedToDOM = false;\n      editor.div.remove();\n    }\n\n    this.div = null;\n    this.#editors.clear();\n    this.#uiManager.removeLayer(this);\n  }\n\n  #cleanup() {\n    this.#isCleaningUp = true;\n\n    for (const editor of this.#editors.values()) {\n      if (editor.isEmpty()) {\n        editor.remove();\n      }\n    }\n\n    this.#isCleaningUp = false;\n  }\n\n  render({\n    viewport\n  }) {\n    this.viewport = viewport;\n    setLayerDimensions(this.div, viewport);\n\n    for (const editor of this.#uiManager.getEditors(this.pageIndex)) {\n      this.add(editor);\n      editor.rebuild();\n    }\n\n    this.updateMode();\n  }\n\n  update({\n    viewport\n  }) {\n    this.#uiManager.commitOrRemove();\n    this.#cleanup();\n    const oldRotation = this.viewport.rotation;\n    const rotation = viewport.rotation;\n    this.viewport = viewport;\n    setLayerDimensions(this.div, {\n      rotation\n    });\n\n    if (oldRotation !== rotation) {\n      for (const editor of this.#editors.values()) {\n        editor.rotate(rotation);\n      }\n    }\n\n    this.addInkEditorIfNeeded(false);\n  }\n\n  get pageDimensions() {\n    const {\n      pageWidth,\n      pageHeight\n    } = this.viewport.rawDims;\n    return [pageWidth, pageHeight];\n  }\n\n  get scale() {\n    return this.#uiManager.viewParameters.realScale;\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/display/draw_layer.js\n\nclass DrawLayer {\n  #parent = null;\n  #id = 0;\n  #mapping = new Map();\n  #toUpdate = new Map();\n\n  constructor({\n    pageIndex\n  }) {\n    this.pageIndex = pageIndex;\n  }\n\n  setParent(parent) {\n    if (!this.#parent) {\n      this.#parent = parent;\n      return;\n    }\n\n    if (this.#parent !== parent) {\n      if (this.#mapping.size > 0) {\n        for (const root of this.#mapping.values()) {\n          root.remove();\n          parent.append(root);\n        }\n      }\n\n      this.#parent = parent;\n    }\n  }\n\n  static get _svgFactory() {\n    return shadow(this, \"_svgFactory\", new DOMSVGFactory());\n  }\n\n  static #setBox(element, {\n    x = 0,\n    y = 0,\n    width = 1,\n    height = 1\n  } = {}) {\n    const {\n      style\n    } = element;\n    style.top = `${100 * y}%`;\n    style.left = `${100 * x}%`;\n    style.width = `${100 * width}%`;\n    style.height = `${100 * height}%`;\n  }\n\n  #createSVG(box) {\n    const svg = DrawLayer._svgFactory.create(1, 1, true);\n\n    this.#parent.append(svg);\n    svg.setAttribute(\"aria-hidden\", true);\n    DrawLayer.#setBox(svg, box);\n    return svg;\n  }\n\n  #createClipPath(defs, pathId) {\n    const clipPath = DrawLayer._svgFactory.createElement(\"clipPath\");\n\n    defs.append(clipPath);\n    const clipPathId = `clip_${pathId}`;\n    clipPath.setAttribute(\"id\", clipPathId);\n    clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n\n    const clipPathUse = DrawLayer._svgFactory.createElement(\"use\");\n\n    clipPath.append(clipPathUse);\n    clipPathUse.setAttribute(\"href\", `#${pathId}`);\n    clipPathUse.classList.add(\"clip\");\n    return clipPathId;\n  }\n\n  highlight(outlines, color, opacity, isPathUpdatable = false) {\n    const id = this.#id++;\n    const root = this.#createSVG(outlines.box);\n    root.classList.add(\"highlight\");\n\n    if (outlines.free) {\n      root.classList.add(\"free\");\n    }\n\n    const defs = DrawLayer._svgFactory.createElement(\"defs\");\n\n    root.append(defs);\n\n    const path = DrawLayer._svgFactory.createElement(\"path\");\n\n    defs.append(path);\n    const pathId = `path_p${this.pageIndex}_${id}`;\n    path.setAttribute(\"id\", pathId);\n    path.setAttribute(\"d\", outlines.toSVGPath());\n\n    if (isPathUpdatable) {\n      this.#toUpdate.set(id, path);\n    }\n\n    const clipPathId = this.#createClipPath(defs, pathId);\n\n    const use = DrawLayer._svgFactory.createElement(\"use\");\n\n    root.append(use);\n    root.setAttribute(\"fill\", color);\n    root.setAttribute(\"fill-opacity\", opacity);\n    use.setAttribute(\"href\", `#${pathId}`);\n    this.#mapping.set(id, root);\n    return {\n      id,\n      clipPathId: `url(#${clipPathId})`\n    };\n  }\n\n  highlightOutline(outlines) {\n    const id = this.#id++;\n    const root = this.#createSVG(outlines.box);\n    root.classList.add(\"highlightOutline\");\n\n    const defs = DrawLayer._svgFactory.createElement(\"defs\");\n\n    root.append(defs);\n\n    const path = DrawLayer._svgFactory.createElement(\"path\");\n\n    defs.append(path);\n    const pathId = `path_p${this.pageIndex}_${id}`;\n    path.setAttribute(\"id\", pathId);\n    path.setAttribute(\"d\", outlines.toSVGPath());\n    path.setAttribute(\"vector-effect\", \"non-scaling-stroke\");\n    let maskId;\n\n    if (outlines.free) {\n      root.classList.add(\"free\");\n\n      const mask = DrawLayer._svgFactory.createElement(\"mask\");\n\n      defs.append(mask);\n      maskId = `mask_p${this.pageIndex}_${id}`;\n      mask.setAttribute(\"id\", maskId);\n      mask.setAttribute(\"maskUnits\", \"objectBoundingBox\");\n\n      const rect = DrawLayer._svgFactory.createElement(\"rect\");\n\n      mask.append(rect);\n      rect.setAttribute(\"width\", \"1\");\n      rect.setAttribute(\"height\", \"1\");\n      rect.setAttribute(\"fill\", \"white\");\n\n      const use = DrawLayer._svgFactory.createElement(\"use\");\n\n      mask.append(use);\n      use.setAttribute(\"href\", `#${pathId}`);\n      use.setAttribute(\"stroke\", \"none\");\n      use.setAttribute(\"fill\", \"black\");\n      use.setAttribute(\"fill-rule\", \"nonzero\");\n      use.classList.add(\"mask\");\n    }\n\n    const use1 = DrawLayer._svgFactory.createElement(\"use\");\n\n    root.append(use1);\n    use1.setAttribute(\"href\", `#${pathId}`);\n\n    if (maskId) {\n      use1.setAttribute(\"mask\", `url(#${maskId})`);\n    }\n\n    const use2 = use1.cloneNode();\n    root.append(use2);\n    use1.classList.add(\"mainOutline\");\n    use2.classList.add(\"secondaryOutline\");\n    this.#mapping.set(id, root);\n    return id;\n  }\n\n  finalizeLine(id, line) {\n    const path = this.#toUpdate.get(id);\n    this.#toUpdate.delete(id);\n    this.updateBox(id, line.box);\n    path.setAttribute(\"d\", line.toSVGPath());\n  }\n\n  updateLine(id, line) {\n    const root = this.#mapping.get(id);\n    const defs = root.firstChild;\n    const path = defs.firstChild;\n    path.setAttribute(\"d\", line.toSVGPath());\n  }\n\n  removeFreeHighlight(id) {\n    this.remove(id);\n    this.#toUpdate.delete(id);\n  }\n\n  updatePath(id, line) {\n    this.#toUpdate.get(id).setAttribute(\"d\", line.toSVGPath());\n  }\n\n  updateBox(id, box) {\n    DrawLayer.#setBox(this.#mapping.get(id), box);\n  }\n\n  show(id, visible) {\n    this.#mapping.get(id).classList.toggle(\"hidden\", !visible);\n  }\n\n  rotate(id, angle) {\n    this.#mapping.get(id).setAttribute(\"data-main-rotation\", angle);\n  }\n\n  changeColor(id, color) {\n    this.#mapping.get(id).setAttribute(\"fill\", color);\n  }\n\n  changeOpacity(id, opacity) {\n    this.#mapping.get(id).setAttribute(\"fill-opacity\", opacity);\n  }\n\n  addClass(id, className) {\n    this.#mapping.get(id).classList.add(className);\n  }\n\n  removeClass(id, className) {\n    this.#mapping.get(id).classList.remove(className);\n  }\n\n  remove(id) {\n    if (this.#parent === null) {\n      return;\n    }\n\n    this.#mapping.get(id).remove();\n    this.#mapping.delete(id);\n  }\n\n  destroy() {\n    this.#parent = null;\n\n    for (const root of this.#mapping.values()) {\n      root.remove();\n    }\n\n    this.#mapping.clear();\n  }\n\n}\n\n; // CONCATENATED MODULE: ./src/pdf.js\n\nconst pdfjsVersion = \"4.6.82\";\nconst pdfjsBuild = \"9b541910f\";\nvar __webpack_exports__AbortException = __webpack_exports__.AbortException;\nvar __webpack_exports__AnnotationEditorLayer = __webpack_exports__.AnnotationEditorLayer;\nvar __webpack_exports__AnnotationEditorParamsType = __webpack_exports__.AnnotationEditorParamsType;\nvar __webpack_exports__AnnotationEditorType = __webpack_exports__.AnnotationEditorType;\nvar __webpack_exports__AnnotationEditorUIManager = __webpack_exports__.AnnotationEditorUIManager;\nvar __webpack_exports__AnnotationLayer = __webpack_exports__.AnnotationLayer;\nvar __webpack_exports__AnnotationMode = __webpack_exports__.AnnotationMode;\nvar __webpack_exports__CMapCompressionType = __webpack_exports__.CMapCompressionType;\nvar __webpack_exports__ColorPicker = __webpack_exports__.ColorPicker;\nvar __webpack_exports__DOMSVGFactory = __webpack_exports__.DOMSVGFactory;\nvar __webpack_exports__DrawLayer = __webpack_exports__.DrawLayer;\nvar __webpack_exports__FeatureTest = __webpack_exports__.FeatureTest;\nvar __webpack_exports__GlobalWorkerOptions = __webpack_exports__.GlobalWorkerOptions;\nvar __webpack_exports__ImageKind = __webpack_exports__.ImageKind;\nvar __webpack_exports__InvalidPDFException = __webpack_exports__.InvalidPDFException;\nvar __webpack_exports__MissingPDFException = __webpack_exports__.MissingPDFException;\nvar __webpack_exports__OPS = __webpack_exports__.OPS;\nvar __webpack_exports__PDFDataRangeTransport = __webpack_exports__.PDFDataRangeTransport;\nvar __webpack_exports__PDFDateString = __webpack_exports__.PDFDateString;\nvar __webpack_exports__PDFWorker = __webpack_exports__.PDFWorker;\nvar __webpack_exports__PasswordResponses = __webpack_exports__.PasswordResponses;\nvar __webpack_exports__PermissionFlag = __webpack_exports__.PermissionFlag;\nvar __webpack_exports__PixelsPerInch = __webpack_exports__.PixelsPerInch;\nvar __webpack_exports__RenderingCancelledException = __webpack_exports__.RenderingCancelledException;\nvar __webpack_exports__TextLayer = __webpack_exports__.TextLayer;\nvar __webpack_exports__UnexpectedResponseException = __webpack_exports__.UnexpectedResponseException;\nvar __webpack_exports__Util = __webpack_exports__.Util;\nvar __webpack_exports__VerbosityLevel = __webpack_exports__.VerbosityLevel;\nvar __webpack_exports__XfaLayer = __webpack_exports__.XfaLayer;\nvar __webpack_exports__build = __webpack_exports__.build;\nvar __webpack_exports__createValidAbsoluteUrl = __webpack_exports__.createValidAbsoluteUrl;\nvar __webpack_exports__fetchData = __webpack_exports__.fetchData;\nvar __webpack_exports__getDocument = __webpack_exports__.getDocument;\nvar __webpack_exports__getFilenameFromUrl = __webpack_exports__.getFilenameFromUrl;\nvar __webpack_exports__getPdfFilenameFromUrl = __webpack_exports__.getPdfFilenameFromUrl;\nvar __webpack_exports__getXfaPageViewport = __webpack_exports__.getXfaPageViewport;\nvar __webpack_exports__isDataScheme = __webpack_exports__.isDataScheme;\nvar __webpack_exports__isPdfFile = __webpack_exports__.isPdfFile;\nvar __webpack_exports__noContextMenu = __webpack_exports__.noContextMenu;\nvar __webpack_exports__normalizeUnicode = __webpack_exports__.normalizeUnicode;\nvar __webpack_exports__setLayerDimensions = __webpack_exports__.setLayerDimensions;\nvar __webpack_exports__shadow = __webpack_exports__.shadow;\nvar __webpack_exports__version = __webpack_exports__.version;\nexport { __webpack_exports__AbortException as AbortException, __webpack_exports__AnnotationEditorLayer as AnnotationEditorLayer, __webpack_exports__AnnotationEditorParamsType as AnnotationEditorParamsType, __webpack_exports__AnnotationEditorType as AnnotationEditorType, __webpack_exports__AnnotationEditorUIManager as AnnotationEditorUIManager, __webpack_exports__AnnotationLayer as AnnotationLayer, __webpack_exports__AnnotationMode as AnnotationMode, __webpack_exports__CMapCompressionType as CMapCompressionType, __webpack_exports__ColorPicker as ColorPicker, __webpack_exports__DOMSVGFactory as DOMSVGFactory, __webpack_exports__DrawLayer as DrawLayer, __webpack_exports__FeatureTest as FeatureTest, __webpack_exports__GlobalWorkerOptions as GlobalWorkerOptions, __webpack_exports__ImageKind as ImageKind, __webpack_exports__InvalidPDFException as InvalidPDFException, __webpack_exports__MissingPDFException as MissingPDFException, __webpack_exports__OPS as OPS, __webpack_exports__PDFDataRangeTransport as PDFDataRangeTransport, __webpack_exports__PDFDateString as PDFDateString, __webpack_exports__PDFWorker as PDFWorker, __webpack_exports__PasswordResponses as PasswordResponses, __webpack_exports__PermissionFlag as PermissionFlag, __webpack_exports__PixelsPerInch as PixelsPerInch, __webpack_exports__RenderingCancelledException as RenderingCancelledException, __webpack_exports__TextLayer as TextLayer, __webpack_exports__UnexpectedResponseException as UnexpectedResponseException, __webpack_exports__Util as Util, __webpack_exports__VerbosityLevel as VerbosityLevel, __webpack_exports__XfaLayer as XfaLayer, __webpack_exports__build as build, __webpack_exports__createValidAbsoluteUrl as createValidAbsoluteUrl, __webpack_exports__fetchData as fetchData, __webpack_exports__getDocument as getDocument, __webpack_exports__getFilenameFromUrl as getFilenameFromUrl, __webpack_exports__getPdfFilenameFromUrl as getPdfFilenameFromUrl, __webpack_exports__getXfaPageViewport as getXfaPageViewport, __webpack_exports__isDataScheme as isDataScheme, __webpack_exports__isPdfFile as isPdfFile, __webpack_exports__noContextMenu as noContextMenu, __webpack_exports__normalizeUnicode as normalizeUnicode, __webpack_exports__setLayerDimensions as setLayerDimensions, __webpack_exports__shadow as shadow, __webpack_exports__version as version };","map":{"version":3,"names":["__webpack_require__","d","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","__webpack_exports__","globalThis","pdfjsLib","AbortException","AnnotationEditorLayer","AnnotationEditorParamsType","AnnotationEditorType","AnnotationEditorUIManager","AnnotationLayer","AnnotationMode","CMapCompressionType","ColorPicker","DOMSVGFactory","DrawLayer","FeatureTest","util_FeatureTest","GlobalWorkerOptions","ImageKind","util_ImageKind","InvalidPDFException","MissingPDFException","OPS","PDFDataRangeTransport","PDFDateString","PDFWorker","PasswordResponses","PermissionFlag","PixelsPerInch","RenderingCancelledException","TextLayer","UnexpectedResponseException","Util","VerbosityLevel","XfaLayer","build","createValidAbsoluteUrl","fetchData","getDocument","getFilenameFromUrl","getPdfFilenameFromUrl","getXfaPageViewport","isDataScheme","isPdfFile","noContextMenu","normalizeUnicode","setLayerDimensions","shadow","version","isNodeJS","process","versions","nw","electron","type","IDENTITY_MATRIX","FONT_IDENTITY_MATRIX","MAX_IMAGE_SIZE_TO_CACHE","LINE_FACTOR","LINE_DESCENT_FACTOR","BASELINE_FACTOR","RenderingIntentFlag","ANY","DISPLAY","PRINT","SAVE","ANNOTATIONS_FORMS","ANNOTATIONS_STORAGE","ANNOTATIONS_DISABLE","IS_EDITING","OPLIST","DISABLE","ENABLE","ENABLE_FORMS","ENABLE_STORAGE","AnnotationEditorPrefix","NONE","FREETEXT","HIGHLIGHT","STAMP","INK","RESIZE","CREATE","FREETEXT_SIZE","FREETEXT_COLOR","FREETEXT_OPACITY","INK_COLOR","INK_THICKNESS","INK_OPACITY","HIGHLIGHT_COLOR","HIGHLIGHT_DEFAULT_COLOR","HIGHLIGHT_THICKNESS","HIGHLIGHT_FREE","HIGHLIGHT_SHOW_ALL","MODIFY_CONTENTS","COPY","MODIFY_ANNOTATIONS","FILL_INTERACTIVE_FORMS","COPY_FOR_ACCESSIBILITY","ASSEMBLE","PRINT_HIGH_QUALITY","TextRenderingMode","FILL","STROKE","FILL_STROKE","INVISIBLE","FILL_ADD_TO_PATH","STROKE_ADD_TO_PATH","FILL_STROKE_ADD_TO_PATH","ADD_TO_PATH","FILL_STROKE_MASK","ADD_TO_PATH_FLAG","GRAYSCALE_1BPP","RGB_24BPP","RGBA_32BPP","AnnotationType","TEXT","LINK","LINE","SQUARE","CIRCLE","POLYGON","POLYLINE","UNDERLINE","SQUIGGLY","STRIKEOUT","CARET","POPUP","FILEATTACHMENT","SOUND","MOVIE","WIDGET","SCREEN","PRINTERMARK","TRAPNET","WATERMARK","THREED","REDACT","AnnotationReplyType","GROUP","REPLY","AnnotationFlag","HIDDEN","NOZOOM","NOROTATE","NOVIEW","READONLY","LOCKED","TOGGLENOVIEW","LOCKEDCONTENTS","AnnotationFieldFlag","REQUIRED","NOEXPORT","MULTILINE","PASSWORD","NOTOGGLETOOFF","RADIO","PUSHBUTTON","COMBO","EDIT","SORT","FILESELECT","MULTISELECT","DONOTSPELLCHECK","DONOTSCROLL","COMB","RICHTEXT","RADIOSINUNISON","COMMITONSELCHANGE","AnnotationBorderStyleType","SOLID","DASHED","BEVELED","INSET","AnnotationActionEventType","E","X","D","U","Fo","Bl","PO","PC","PV","PI","K","F","V","C","DocumentActionEventType","WC","WS","DS","WP","DP","PageActionEventType","O","ERRORS","WARNINGS","INFOS","BINARY","dependency","setLineWidth","setLineCap","setLineJoin","setMiterLimit","setDash","setRenderingIntent","setFlatness","setGState","save","restore","transform","moveTo","lineTo","curveTo","curveTo2","curveTo3","closePath","rectangle","stroke","closeStroke","fill","eoFill","fillStroke","eoFillStroke","closeFillStroke","closeEOFillStroke","endPath","clip","eoClip","beginText","endText","setCharSpacing","setWordSpacing","setHScale","setLeading","setFont","setTextRenderingMode","setTextRise","moveText","setLeadingMoveText","setTextMatrix","nextLine","showText","showSpacedText","nextLineShowText","nextLineSetSpacingShowText","setCharWidth","setCharWidthAndBounds","setStrokeColorSpace","setFillColorSpace","setStrokeColor","setStrokeColorN","setFillColor","setFillColorN","setStrokeGray","setFillGray","setStrokeRGBColor","setFillRGBColor","setStrokeCMYKColor","setFillCMYKColor","shadingFill","beginInlineImage","beginImageData","endInlineImage","paintXObject","markPoint","markPointProps","beginMarkedContent","beginMarkedContentProps","endMarkedContent","beginCompat","endCompat","paintFormXObjectBegin","paintFormXObjectEnd","beginGroup","endGroup","beginAnnotation","endAnnotation","paintImageMaskXObject","paintImageMaskXObjectGroup","paintImageXObject","paintInlineImageXObject","paintInlineImageXObjectGroup","paintImageXObjectRepeat","paintImageMaskXObjectRepeat","paintSolidColorImageMask","constructPath","setStrokeTransparent","setFillTransparent","NEED_PASSWORD","INCORRECT_PASSWORD","verbosity","setVerbosityLevel","level","Number","isInteger","getVerbosityLevel","info","msg","console","log","warn","unreachable","Error","assert","cond","_isValidProtocol","url","protocol","baseUrl","options","addDefaultProtocol","startsWith","dots","match","length","tryConvertEncoding","stringToUTF8String","absoluteUrl","URL","value","nonSerializable","configurable","writable","BaseException","BaseExceptionClosure","message","name","constructor","PasswordException","code","UnknownErrorException","details","status","FormatError","bytesToString","bytes","undefined","MAX_ARGUMENT_COUNT","String","fromCharCode","apply","strBuf","i","chunkEnd","Math","min","chunk","subarray","push","join","stringToBytes","str","Uint8Array","charCodeAt","string32","objectSize","keys","objectFromMap","map","create","isLittleEndian","buffer8","view32","Uint32Array","buffer","isEvalSupported","Function","isOffscreenCanvasSupported","OffscreenCanvas","platform","navigator","isMac","includes","isCSSRoundSupported","CSS","supports","hexNumbers","Array","from","n","toString","padStart","makeHexColor","r","g","b","scaleMinMax","minMax","temp","m1","m2","applyTransform","p","m","xt","yt","applyInverseTransform","getAxialAlignedBoundingBox","p1","p2","slice","p3","p4","max","inverseTransform","singularValueDecompose2dScale","transpose","a","c","first","second","sqrt","sx","sy","normalizeRect","rect","intersect","rect1","rect2","xLow","xHigh","yLow","yHigh","getExtremumOnCurve","x0","x1","x2","x3","y0","y1","y2","y3","t","mt","tt","ttt","x","y","getExtremum","abs","delta","sqrtDelta","a2","bezierBoundingBox","PDFStringTranslateTable","stringToPDFString","encoding","decoder","TextDecoder","fatal","decoded","decode","replaceAll","ex","ii","charCode","charAt","decodeURIComponent","escape","utf8StringToString","unescape","encodeURIComponent","isArrayEqual","arr1","arr2","getModificationDate","date","Date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","NormalizeRegex","NormalizationMap","Map","_","normalize","getUuid","crypto","randomUUID","buf","getRandomValues","floor","random","AnnotationPrefix","FontRenderOps","BEZIER_CURVE_TO","MOVE_TO","LINE_TO","QUADRATIC_CURVE_TO","RESTORE","SCALE","TRANSFORM","TRANSLATE","BaseFilterFactory","addFilter","maps","addHCMFilter","fgColor","bgColor","addAlphaFilter","addLuminosityFilter","addHighlightHCMFilter","filterName","newFgColor","newBgColor","destroy","keepHCM","BaseCanvasFactory","enableHWA","width","height","canvas","_createCanvas","context","getContext","willReadFrequently","reset","canvasAndContext","BaseCMapReaderFactory","isCompressed","fetch","compressionType","_fetchData","catch","reason","BaseStandardFontDataFactory","filename","BaseSVGFactory","skipDimensions","svg","_createSVG","setAttribute","createElement","SVG_NS","PDF","PDF_TO_CSS_UNITS","DOMFilterFactory","_cache","_defs","docId","document","_hcmCache","id","ownerDocument","cache","hcmCache","defs","div","style","visibility","contain","position","top","left","zIndex","createElementNS","append","body","createTables","mapR","table","mapG","mapB","bufferR","bufferG","bufferB","createUrl","baseURI","split","tableR","tableG","tableB","set","filter","createFilter","addTransferMapConversion","remove","fgRGB","getRGB","bgRGB","color","addGrayConversion","getSteps","start","end","arr","tableA","addTransferMapAlphaConversion","addLuminosityConversion","bind","fgGray","round","bgGray","newFgRGB","newBgRGB","fg","bg","step","newStart","newStep","prev","k","j","size","parentNode","clear","feColorMatrix","appendFeFunc","feComponentTransfer","func","feFunc","rTable","gTable","bTable","aTable","getComputedStyle","getPropertyValue","DOMCanvasFactory","_document","isValidFetchUrl","response","ok","statusText","arrayBuffer","blob","json","text","Promise","resolve","reject","request","XMLHttpRequest","open","responseType","onreadystatechange","readyState","DONE","responseText","send","DOMCMapReaderFactory","then","data","cMapData","ArrayBuffer","DOMStandardFontDataFactory","PageViewport","viewBox","scale","rotation","offsetX","offsetY","dontFlip","centerX","centerY","rotateA","rotateB","rotateC","rotateD","offsetCanvasX","offsetCanvasY","rawDims","pageWidth","pageHeight","pageX","pageY","clone","convertToViewportPoint","convertToViewportRectangle","topLeft","bottomRight","convertToPdfPoint","extraDelay","trim","substring","toLowerCase","test","lastIndexOf","defaultFilename","reURI","reFilename","splitURI","exec","suggestedFilename","StatTimer","started","times","time","now","timeEnd","outBuf","longest","padEnd","e","preventDefault","deprecated","pdfDateStringRegex","toDateObject","input","RegExp","matches","year","parseInt","month","day","hour","minute","universalTimeRelation","offsetHour","offsetMinute","UTC","xfaPage","attributes","colorRGB","getColorValues","colors","span","computedColor","window","getCurrentTransform","ctx","f","getTransform","getCurrentTransformInverse","invertSelf","viewport","mustFlip","mustRotate","useRound","w","h","widthStr","heightStr","EditorToolbar","toolbar","colorPicker","editor","buttons","altText","l10nRemove","freeze","freetext","highlight","ink","stamp","render","editToolbar","className","signal","_uiManager","_signal","addEventListener","pointerDown","toolbarPosition","direction","insetInlineEnd","addDeleteButton","stopPropagation","focusIn","_focusEventsAllowed","focusOut","addListenersToElement","element","capture","hide","classList","add","hideDropdown","show","shown","editorType","button","tabIndex","delete","divider","addAltText","prepend","addColorPicker","renderButton","HighlightToolbar","uiManager","addHighlightButton","getLastPoint","boxes","isLTR","lastY","lastX","box","parent","highlightSelection","bindEvents","names","opacityToHex","opacity","IdManager","ImageManager","baseId","_isSVGFittingCanvas","image","Image","src","promise","drawImage","getImageData","rawData","bitmap","refCounter","isSvg","file","mustRemoveAspectRatioPromise","fileReader","FileReader","imageElement","imagePromise","onload","svgUrl","result","onerror","readAsDataURL","createImageBitmap","error","getFromFile","lastModified","getFromUrl","getFromId","getSvgUrl","deleteId","isValidId","CommandManager","commands","locked","maxSize","cmd","undo","post","mustExec","NaN","overwriteIfSameType","keepUndo","next","splice","redo","hasSomethingToUndo","hasSomethingToRedo","KeyboardManager","callbacks","allKeys","Set","callback","isMacKey","at","serialize","event","altKey","ctrlKey","metaKey","shiftKey","self","has","bubbles","args","checker","ColorManager","_colorsMapping","_colors","convert","rgb","matchMedia","RGB","every","getHexCode","abortController","AbortController","activeEditor","allEditors","allLayers","altTextManager","annotationStorage","changedExistingAnnotations","commandManager","copyPasteAC","currentPageIndex","deletedAnnotationsElementIds","draggingEditors","editorTypes","editorsToRescale","enableHighlightFloatingButton","enableUpdatedAddImage","enableNewAltTextWhenAddingImage","filterFactory","focusMainContainerTimeoutId","focusManagerAC","highlightColors","highlightWhenShiftUp","highlightToolbar","idManager","isEnabled","isWaiting","keyboardManagerAC","lastActiveElement","mainHighlightColorPicker","mlManager","mode","selectedEditors","selectedTextNode","pageColors","showAllStates","previousStates","isEditing","isEmpty","hasSelectedEditor","hasSelectedText","translation","translationTimeoutId","container","viewer","TRANSLATE_SMALL","TRANSLATE_BIG","_keyboardManager","proto","arrowChecker","contains","activeElement","tagName","hasSomethingToControl","textInputChecker","_self","target","el","HTMLInputElement","small","big","selectAll","addNewEditorFromKeyboard","HTMLButtonElement","isEnterHandled","unselectAll","translateSelectedEditors","eventBus","pdfDocument","_eventBus","_on","onEditingAction","onPageChanging","onScaleChanging","onRotationChanging","onSetPreference","evt","updateParams","addSelectionListener","addDragAndDropListeners","addKeyboardManager","viewParameters","realScale","isShiftKeyDown","abort","layer","values","clearTimeout","combinedSignal","ac","AbortSignal","any","useNewAltTextFlow","useNewAltTextWhenAddingImage","hcmFilter","foreground","background","pair","highlightColorNames","reverse","setMainHighlightColorPicker","editAltText","firstTime","switchToMode","on","once","dispatch","source","setPreference","pageNumber","focusMainContainer","focus","findParent","layerX","layerY","getBoundingClientRect","disableUserSelect","toggle","addShouldRescale","removeShouldRescale","commitOrRemove","pagesRotation","getAnchorElementForSelection","anchorNode","nodeType","Node","TEXT_NODE","parentElement","getLayerForTextLayer","textLayer","currentLayer","hasTextLayer","methodOfCreation","selection","getSelection","isCollapsed","anchorOffset","focusNode","focusOffset","anchorElement","closest","getSelectionBoxes","empty","isNoneMode","createAndAddNewEditor","showAllEditors","displayHighlightToolbar","addToAnnotationStorage","setValue","selectionChange","dispatchUpdateStates","activeLayer","toggleDrawing","pointerup","onSelectEnd","addFocusManager","blur","removeFocusManager","hasSelection","lastEditor","keydown","keyup","removeKeyboardManager","addCopyPasteListeners","copy","cut","paste","removeCopyPasteListeners","dragOver","drop","addEditListeners","removeEditListeners","dataTransfer","items","isHandlingMimeForPasting","dropEffect","item","editors","serialized","clipboardData","setData","JSON","stringify","getData","parse","isArray","newEditors","deserializedEditor","deserialize","addEditorToLayer","selectEditors","addCommands","isEditorHandlingKeyboard","hasChanged","entries","some","assign","dispatchUpdateUI","setEditingState","registerEditorTypes","types","defaultPropertiesToUpdate","getId","getLayer","pageIndex","addLayer","enable","disable","removeLayer","updateMode","editId","isFromKeyboard","disableAll","enableAll","annotationElementId","setSelected","enterInEditMode","canCreateNewEmptyEditor","addNewEditor","updateToolbar","updateColor","action","updateDefaultParams","visible","updateButton","state","enableWaiting","mustWait","disableClick","enableClick","getEditors","getEditor","addEditor","removeEditor","setTimeout","unselect","addDeletedAnnotationElement","addChangedExistingAnnotation","deleted","isDeletedAnnotationElement","removeDeletedAnnotationElement","removeChangedExistingAnnotation","addOrRebuild","setActiveEditor","propertiesToUpdate","lastSelectedEditor","ed","updateUI","toggleSelected","select","isSelected","firstSelectedEditor","params","commit","noCommit","totalX","totalY","TIME_TO_WAIT","translateInPage","setUpDragSession","savedX","savedY","savedPageIndex","newX","newY","newPageIndex","endDragSession","mustBeAddedInUndoStack","move","_setParentAndPosition","dragSelectedEditors","tx","ty","drag","rebuild","changeParent","getActive","shouldGetKeyboardEvents","isActive","getMode","imageManager","rangeCount","getRangeAt","commonAncestorContainer","parentWidth","parentHeight","rotator","getAttribute","range","collapsed","getClientRects","renderAnnotationElement","annotation","editorId","getRawValue","hasBeenModified","AltText","altTextDecorative","altTextButton","altTextTooltip","altTextTooltipTimeout","altTextWasFromKeyBoard","badge","guessedText","textWithDisclaimer","_l10nPromise","initialize","l10nPromise","textContent","onClick","_reportTelemetry","label","setState","finish","focusVisible","hasData","setGuessedText","generatedAltText","toggleAltTextBadge","isForCopying","decorative","cancel","enabled","disabled","child","childNodes","tooltip","DELAY_TO_SHOW_TOOLTIP","innerText","getImageForAltText","AnnotationEditor","accessibilityData","allResizerDivs","keepAspectRatio","resizersDiv","savedDimensions","focusAC","focusedResizerName","hasBeenClicked","initialPosition","isInEditMode","isResizerEnabledForKeyboard","moveInDOMTimeout","prevDragX","prevDragY","telemetryTimeouts","_editToolbar","_initialOptions","_isVisible","_l10nResizer","isDraggable","_zIndex","_borderLineWidth","_colorManager","_telemetryTimeout","_resizerKeyboardManager","resize","_resizeWithKeyboard","_stopResizingWithKeyboard","parameters","_willKeepAspectRatio","isCentered","_structTreeParentId","pageRotation","pageDimensions","pageTranslation","parentDimensions","isAttachedToDOM","getPrototypeOf","_type","_defaultLineColor","deleteAnnotationElement","fakeEditor","FakeEditor","getNextId","l10n","topMiddle","topRight","middleRight","bottomMiddle","bottomLeft","middleLeft","strings","documentElement","parseFloat","_value","mime","_isDraggable","center","parentRotation","fixAndSetPosition","setInBackground","setInForeground","setParent","stopResizing","focusin","focusout","relatedTarget","isMultipleSelection","setAt","screenToPageTranslation","translate","scrollIntoView","block","findNewParent","bx","by","getBaseTranslation","toFixed","_hasBeenMoved","_mustFixPosition","moveInDOM","rotatePoint","angle","pageTranslationToScreen","getRotationMatrix","parentScale","scaledWidth","scaledHeight","setDims","fixDims","widthPercent","endsWith","heightPercent","getInitialTranslation","createResizers","classes","resizerPointerdown","savedDraggable","togglePointerEvents","resizerPointermove","passive","savedWidth","savedHeight","savedParentCursor","cursor","savedCursor","pointerUpCallback","addResizeToUndoStack","newWidth","newHeight","minWidth","MIN_SIZE","minHeight","rotationMatrix","transf","invRotationMatrix","invTransf","getPoint","getOpposite","isDiagonal","isHorizontal","point","oppositePoint","transfOppositePoint","oppositeX","oppositeY","ratioX","ratioY","deltaX","deltaY","movementX","movementY","oldDiag","hypot","altTextFinish","addEditToolbar","removeEditToolbar","getClientDimensions","addAltTextButton","altTextData","guessedAltText","setGuessedAltText","serializeAltText","hasAltText","hasAltTextData","addFocusListeners","maxWidth","maxHeight","pointerdown","selectOnPointerEvent","clientX","clientY","pointerMoveCallback","moveEditorInDOM","getRect","shiftX","shiftY","getRectInCurrentCoords","onceAdded","enableEditMode","disableEditMode","needsToBeRebuilt","rotate","_angle","timeout","isResizable","makeResizable","children","boundResizerKeydown","resizerKeydown","boundResizerBlur","resizerBlur","resizerFocus","firstPosition","nextFirstPosition","firstChild","before","lastChild","setResizerTabIndex","stopImmediatePropagation","preventScroll","disableEditing","enableEditing","contentDiv","setAspectRatio","aspectRatio","telemetryInitialData","telemetryFinalData","content","querySelector","nodeName","resetAnnotationElement","SEED","MASK_HIGH","MASK_LOW","MurmurHash3_64","seed","h1","h2","update","isView","byteLength","blockCounts","tailLength","dataUint32","k1","k2","C1","C2","C1_LOW","C2_LOW","hexdigest","SerializableEmpty","hash","transfer","AnnotationStorage","modified","modifiedIds","storage","onSetModified","onResetModified","onAnnotationEditor","getValue","defaultValue","resetModified","entry","val","setModified","getAll","setAll","print","PrintAnnotationStorage","serializable","hasBitmap","editorStats","stats","typeToEditor","counters","count","computeTelemetryFinalData","resetModifiedIds","ids","structuredClone","FontLoader","systemFonts","styleElement","nativeFontFaces","loadingRequests","loadTestFontId","addNativeFontFace","nativeFontFace","fonts","removeNativeFontFace","insertRule","rule","getElementsByTagName","styleSheet","sheet","cssRules","loadSystemFont","systemFontInfo","_inspectFont","loadedName","disableFontFace","isFontLoadingAPISupported","fontFace","FontFace","load","baseFontName","font","attached","missingFile","createNativeFontFace","loaded","family","createFontFaceRule","isSyncFontLoadingSupported","_queueLoadingCallback","_prepareFontLoadEvent","hasFonts","supported","userAgent","completeRequest","done","otherRequest","shift","complete","_loadTestFont","testFont","atob","int32","offset","spliceString","s","insert","chunk1","chunk2","called","isFontReady","fillText","imageData","COMMENT_OFFSET","CFF_CHECKSUM_OFFSET","XXXX_VALUE","checksum","btoa","fontFamily","FontFaceObject","translatedData","inspectFont","compiledGlyphs","cssFontInfo","css","weight","fontWeight","italicAngle","mimetype","getPathGenerator","objs","character","cmds","bezierCurveTo","quadraticCurveTo","glyphDrawer","packageCapability","withResolvers","packageMap","loadPackages","fs","http","https","path2d","NodePackages","node_utils_fetchData","promises","readFile","NodeFilterFactory","NodeCanvasFactory","createCanvas","NodeCMapReaderFactory","NodeStandardFontDataFactory","PathType","SHADING","applyBoundingBox","bbox","region","Path2D","BaseShadingPattern","getPattern","RadialAxialShadingPattern","IR","_bbox","_colorStops","_p0","_p1","_r0","_r1","matrix","_createGradient","grad","createLinearGradient","createRadialGradient","colorStop","addColorStop","owner","inverse","pathType","pattern","ownerBBox","current","getClippedPathBoundingBox","ceil","tmpCanvas","cachedCanvases","getCanvas","tmpCtx","clearRect","beginPath","baseTransform","fillStyle","createPattern","domMatrix","DOMMatrix","setTransform","drawTriangle","c1","c2","c3","coords","rowSize","tmp","scaleX","scaleY","c1r","c1g","c1b","c2r","c2g","c2b","c3r","c3g","c3b","minY","maxY","xa","car","cag","cab","xb","cbr","cbg","cbb","x1_","x2_","drawFigure","figure","ps","cs","verticesPerRow","rows","cols","q","MeshShadingPattern","_coords","_figures","_bounds","_background","_createMeshCanvas","combinedScale","backgroundColor","EXPECTED_SCALE","MAX_PATTERN_SIZE","BORDER_SIZE","boundsWidth","boundsHeight","paddedWidth","paddedHeight","createImageData","putImageData","matrixScale","temporaryPatternCanvas","DummyShadingPattern","getShadingPattern","PaintType","COLORED","UNCOLORED","TilingPattern","canvasGraphicsFactory","operatorList","xstep","ystep","paintType","tilingType","createPatternCanvas","curMatrixScale","dimx","getSizeAndScale","dimy","graphics","createCanvasGraphics","groupLevel","setFillAndStrokeStyleToContext","adjustedX0","adjustedY0","adjustedX1","adjustedY1","clipBbox","executeOperatorList","endDrawing","realOutputSize","bboxWidth","bboxHeight","updateRectMinMax","strokeStyle","fillColor","strokeColor","cssColor","convertToRGBA","kind","convertBlackAndWhiteToRGBA","convertRGBToRGBA","srcPos","dest","nonBlackColor","inverseDecode","black","zeroMapping","oneMapping","widthInSource","widthRemainder","srcLength","destPos","elem","len32","src32","s1","s2","s3","jj","grayToRGBA","MIN_FONT_SIZE","MAX_FONT_SIZE","EXECUTION_TIME","EXECUTION_STEPS","MAX_SIZE_TO_COMPILE","FULL_CHUNK_HEIGHT","mirrorContextOperations","destCtx","_removeMirroring","__originalSave","__originalRestore","__originalRotate","__originalScale","__originalTranslate","__originalTransform","__originalSetTransform","__originalResetTransform","resetTransform","__originalClip","__originalMoveTo","__originalLineTo","__originalBezierCurveTo","__originalRect","__originalClosePath","__originalBeginPath","ctxSave","ctxRestore","ctxTranslate","ctxScale","ctxTransform","ctxSetTransform","ctxResetTransform","ctxRotate","cp1x","cp1y","cp2x","cp2y","CachedCanvases","canvasFactory","canvasEntry","drawImageAtIntegerCoords","srcImg","srcX","srcY","srcW","srcH","destX","destY","destW","destH","tlX","rTlX","tlY","rTlY","brX","rWidth","brY","rHeight","sign","compileType3Glyph","imgData","POINT_TO_PROCESS_LIMIT","POINT_TYPES","width1","points","j0","lineSize","pos","mask","sum","steps","Int32Array","path","p0","pp","drawOutline","CanvasExtraState","alphaIsShape","fontSize","fontSizeScale","textMatrix","textMatrixScale","fontMatrix","leading","lineX","lineY","charSpacing","wordSpacing","textHScale","textRenderingMode","textRise","patternFill","fillAlpha","strokeAlpha","lineWidth","activeSMask","transferMaps","startNewPathAndClipBox","clipBox","setCurrentPoint","updatePathMinMax","minX","maxX","updateScalingPathMinMax","updateCurvePathMinMax","getPathBoundingBox","xStrokePad","yStrokePad","updateClipFromPath","isEmptyClip","Infinity","putBinaryImageData","ImageData","partialChunkHeight","fullChunks","totalChunks","chunkImgData","thisChunkHeight","elemsInThisChunk","dest32","dest32DataLength","fullSrcDiff","white","srcDiff","kEnd","kEndUnrolled","srcByte","putBinaryImageMask","copyCtxState","sourceCtx","properties","property","setLineDash","getLineDash","lineDashOffset","resetCtxToDefault","fillRule","globalAlpha","lineCap","lineJoin","miterLimit","globalCompositeOperation","getImageSmoothingEnabled","interpolate","fround","actualScale","devicePixelRatio","LINE_CAP_STYLES","LINE_JOIN_STYLES","NORMAL_CLIP","EO_CLIP","CanvasGraphics","canvasCtx","commonObjs","optionalContentConfig","markedContentStack","annotationCanvasMap","stateStack","pendingClip","pendingEOFill","res","xobjs","groupStack","processingType3","baseTransformStack","smaskStack","smaskCounter","tempSMask","suspendedCtx","contentVisible","cachedPatterns","viewportScale","outputScaleX","outputScaleY","_cachedScaleForStroking","_cachedGetSinglePixelWidth","_cachedBitmapsMap","getObject","fallback","beginDrawing","transparency","savedFillStyle","fillRect","transparentCanvas","compositeCtx","executionStartIdx","continueCallback","stepper","argsArray","fnArray","argsArrayLen","chunkOperations","endTime","fnId","nextBreakPoint","breakIt","depObjId","objsPool","restoreInitialState","inSMaskMode","HTMLCanvasElement","drawFilter","hcmFilterId","savedFilter","_scaleImage","img","widthScale","heightScale","paintWidth","paintHeight","tmpCanvasId","_createMaskCanvas","isPatternFill","currentTransform","cacheKey","scaled","maskCanvas","mainKey","cachedImage","maskToCanvas","drawnWidth","drawnHeight","fillCanvas","fillCtx","imageSmoothingEnabled","limit","dashArray","dashPhase","intent","flatness","states","checkSMaskState","beginSMaskMode","endSMaskMode","cacheId","scratchCanvas","compose","dirtyBox","smask","composeSMask","layerCtx","layerBox","layerOffsetX","layerOffsetY","layerWidth","layerHeight","genericComposeSMask","subtype","backdrop","transferMap","maskCtx","maskOffsetX","maskOffsetY","maskX","maskY","old","pop","ops","startX","startY","isScalingMatrix","minMaxForBezier","xw","yh","consumePath","rescaleAndStroke","needRestore","paths","pendingTextPaths","addToPath","spacing","fontRefName","fontObj","fontDirection","isType3Font","typeface","fallbackName","bold","italic","browserFontSize","rise","paintChar","patternTransform","fillStrokeMode","isAddToPathSet","strokeText","isFontSubpixelAAEnabled","glyphs","showType3Text","glyphsLength","vertical","spacingDir","defaultVMetrics","widthAdvanceScale","simpleFillText","getSinglePixelWidth","isInvalidPDFjsFont","chars","glyph","unicode","restoreNeeded","isSpace","fontChar","accent","scaledX","scaledY","vmetric","vx","vy","remeasure","measuredWidth","measureText","characterScaleX","isInFont","scaledAccentX","scaledAccentY","charWidth","isTextInvisible","spacingLength","charProcOperatorList","operatorListId","transformed","xWidth","yWidth","llx","lly","urx","ury","getColorN_Pattern","_getPattern","arguments","objId","inv","group","currentCtx","isolated","knockout","bounds","canvasBounds","groupCtx","startTransformInverse","currentMtx","hasOwnCanvas","canvasWidth","canvasHeight","annotationCanvas","savedCtx","compiled","skewX","skewY","positions","trans","images","applyTransferMapsToCanvas","applyTransferMapsToBitmap","imgToPaint","HTMLElement","tag","isVisible","isContentVisible","absDet","normX","normY","getScaleForStroking","scaledLineWidth","scaledXLineWidth","scaledYLineWidth","baseArea","saveRestore","dashes","op","port","workerPort","Worker","workerSrc","CallbackKind","UNKNOWN","DATA","ERROR","StreamKind","CANCEL","CANCEL_COMPLETE","CLOSE","ENQUEUE","PULL","PULL_COMPLETE","START_COMPLETE","wrapReason","MessageHandler","sourceName","targetName","comObj","callbackId","streamId","streamSinks","streamControllers","callbackCapabilities","actionHandler","_onComObjOnMessage","stream","processStreamMessage","capability","cbSourceName","cbTargetName","postMessage","createStreamSink","actionName","handler","ah","transfers","sendWithPromise","sendWithStream","queueingStrategy","ReadableStream","controller","startCapability","startCall","pullCall","cancelCall","isClosed","desiredSize","pull","pullCapability","cancelCapability","streamSink","enqueue","isCancelled","lastDesiredSize","sinkCapability","ready","close","onPull","onCancel","success","streamController","deleteStreamController","allSettled","removeEventListener","Metadata","metadataMap","parsedData","getRaw","INTERNAL","Symbol","OptionalContentGroup","isDisplay","isPrint","userSet","renderingIntent","usage","view","viewState","printState","_setVisible","internal","OptionalContentConfig","cachedGetHash","groups","initialHash","order","creator","baseState","off","getHash","evaluateVisibilityExpression","array","operator","expression","policy","setVisibility","setOCGState","preserveRB","hasInitialVisibility","getOrder","getGroups","getGroup","PDFDataTransportStream","pdfDataRangeTransport","disableRange","disableStream","initialData","progressiveDone","contentDispositionFilename","_queuedChunks","_progressiveDone","_contentDispositionFilename","_pdfDataRangeTransport","_isStreamingSupported","_isRangeSupported","_contentLength","_fullRequestReader","_rangeReaders","addRangeListener","begin","_onReceiveData","addProgressListener","total","_onProgress","addProgressiveReadListener","addProgressiveDoneListener","_onProgressiveDone","transportReady","_enqueue","found","rangeReader","_begin","_progressiveDataLength","_loaded","onProgress","_removeRangeReader","reader","indexOf","getFullReader","queuedChunks","PDFDataTransportStreamReader","getRangeReader","PDFDataTransportStreamRangeReader","requestDataRange","cancelAllRequests","_stream","_done","_filename","_requests","_headersReady","requestCapability","headersReady","isRangeSupported","isStreamingSupported","contentLength","read","_end","_queuedChunk","requestsCapability","getFilenameFromContentDispositionHeader","contentDisposition","needsEncodingFixup","toParamRegExp","rfc2616unquote","rfc5987decode","rfc2047decode","fixupEncoding","rfc2231getparam","attributePattern","flags","textdecode","contentDispositionStr","iter","quot","part","parts","quotindex","extvalue","encodingend","langvalue","replace","charset","hex","validateRangeRequestCapabilities","getResponseHeader","isHttp","rangeChunkSize","returnValues","allowRangeRequests","suggestedLength","contentEncoding","extractFilenameFromHeader","createResponseStatusError","validateResponseStatus","createFetchOptions","headers","withCredentials","method","credentials","redirect","createHeaders","httpHeaders","Headers","getArrayBuffer","PDFFetchStream","_rangeRequestReaders","PDFFetchStreamReader","PDFFetchStreamRangeReader","_reader","_withCredentials","_headersCapability","_disableRange","_rangeChunkSize","_abortController","_headers","getReader","_readCapability","OK_RESPONSE","PARTIAL_CONTENT_RESPONSE","network_getArrayBuffer","xhr","NetworkManager","currXhrId","pendingRequests","requestRange","listeners","requestFull","xhrId","pendingRequest","setRequestHeader","expectedStatus","onError","onStateChange","onprogress","onHeadersReceived","onDone","xhrStatus","ok_response_on_range_request","rangeHeader","getRequestXhr","isPendingRequest","abortRequest","PDFNetworkStream","_source","_manager","_onRangeRequestReaderClosed","PDFNetworkStreamFullRequestReader","PDFNetworkStreamRangeRequestReader","onClosed","manager","_onHeadersReceived","_onDone","_onError","_url","_fullRequestId","_headersReceivedCapability","_cachedChunks","_storedError","fullRequestXhrId","fullRequestXhr","lengthComputable","_requestId","_close","urlRegex","parseUrlOrPath","sourceUrl","pathToFileURL","createRequest","PDFNodeStream","isFsUrl","PDFNodeStreamFsFullReader","PDFNodeStreamFullReader","PDFNodeStreamFsRangeReader","PDFNodeStreamRangeReader","BaseFullReader","_readableStream","_error","_setReadableStream","readableStream","BaseRangeReader","handleResponse","statusCode","_request","_httpHeaders","Range","lstat","stat","createReadStream","MAX_TEXT_DIVS_TO_RENDER","DEFAULT_FONT_SIZE","DEFAULT_FONT_ASCENT","disableProcessItems","fontInspectorEnabled","FontInspector","lang","layoutTextParams","rootContainer","styleCache","textContentItemsStr","textContentSource","textDivs","textDivProperties","WeakMap","ascentCache","canvasContexts","minFontSize","pendingTextLayers","prevFontSize","prevFontFamily","ensureMinFontSizeComputed","pump","styles","processItems","onBefore","getCtx","layout","abortEx","appendText","geom","textDiv","hasText","hasEOL","atan2","fontName","fontSubstitution","fontHeight","fontAscent","getAscent","sin","cos","scaleFactorStr","divStyle","dir","dataset","fontSubstitutionLoadedName","shouldScaleText","absScaleX","absScaleY","br","cleanup","canvasContext","alpha","lineHeight","cachedAscent","savedFont","metrics","ascent","fontBoundingBoxAscent","descent","fontBoundingBoxDescent","ratio","pixels","XfaText","xfa","output","walk","node","shouldBuildText","DEFAULT_RANGE_CHUNK_SIZE","RENDERING_CANCELLED_TIMEOUT","DELAYED_CLEANUP_TIMEOUT","DefaultCanvasFactory","DefaultCMapReaderFactory","DefaultFilterFactory","DefaultStandardFontDataFactory","task","PDFDocumentLoadingTask","getUrlProp","getDataProp","password","rangeTransport","worker","docBaseUrl","cMapUrl","cMapPacked","CMapReaderFactory","standardFontDataUrl","StandardFontDataFactory","ignoreErrors","stopAtErrors","maxImageSize","canvasMaxAreaInBytes","fontExtraProperties","enableXfa","disableAutoFetch","pdfBug","useSystemFonts","useWorkerFetch","transportFactory","cMapReaderFactory","standardFontDataFactory","workerParams","fromPort","_worker","docParams","apiVersion","evaluatorOptions","transportParams","loadingParams","destroyed","workerIdPromise","messageHandler","networkStream","createPDFNetworkStream","isFetchSupported","Response","workerId","transport","WorkerTransport","_transport","_capability","href","location","Buffer","isNaN","isRefProxy","ref","num","gen","onPassword","_pendingDestroy","_rangeListeners","_progressListeners","_progressiveReadListeners","_progressiveDoneListeners","_readyCapability","listener","onDataRange","onDataProgress","onDataProgressiveRead","onDataProgressiveDone","PDFDocumentProxy","pdfInfo","_pdfInfo","numPages","fingerprints","isPureXfa","_htmlForXfa","allXfaHtml","getPage","getPageIndex","getDestinations","getDestination","getPageLabels","getPageLayout","getPageMode","getViewerPreferences","getOpenAction","getAttachments","getJSActions","getDocJSActions","getOutline","getOptionalContentConfig","getRenderingIntent","getPermissions","getMetadata","getMarkInfo","saveDocument","getDownloadInfo","downloadInfoCapability","keepLoadedFonts","startCleanup","loadingTask","cachedPageNumber","getFieldObjects","hasJSActions","getCalculationOrderIds","PDFPageProxy","delayedCleanupTimeout","pendingCleanup","pageInfo","_pageIndex","_pageInfo","_stats","_pdfBug","PDFObjects","_maybeCleanupAfterRender","_intentStates","userUnit","getViewport","getAnnotations","getPageJSActions","getXfa","annotationMode","optionalContentConfigPromise","printAnnotationStorage","intentArgs","abortDelayedCleanup","intentState","streamReaderCancelTimeout","intentPrint","displayReadyCapability","lastChunk","separateAnnots","_pumpOperatorList","renderTasks","internalRenderTask","tryCleanup","_abortOperatorList","Stats","InternalRenderTask","useRequestAnimationFrame","renderTask","all","initializeGraphics","operatorListChanged","getOperatorList","opListReadCapability","opListTask","streamTextContent","includeMarkedContent","disableNormalization","TEXT_CONTENT_CHUNK_SIZE","highWaterMark","getTextContent","getStructTree","_destroy","waitOn","force","completed","resetStats","delayed","_startRenderPage","_renderPageChunk","operatorListChunk","annotationStorageSerializable","streamReader","delay","curCacheKey","curIntentState","LoopbackPort","deferred","terminate","fakeWorkerId","isWorkerDisabled","workerPorts","_isSameOrigin","otherUrl","base","origin","other","_createCDNWrapper","wrapper","createObjectURL","Blob","_port","_webWorker","_messageHandler","_initializeFromPort","_initialize","mainThreadWorkerMessageHandler","_setupFakeWorker","terminateEarly","sendTest","testObj","_setupFakeWorkerGlobal","WorkerMessageHandler","workerHandler","setup","cachedPort","pdfjsWorker","loader","methodPromises","pageCache","pagePromises","pageRefCache","passwordCapability","factory","fontLoader","_params","destroyCapability","_networkStream","_fullReader","_lastProgress","setupMessageHandler","cacheSimpleMethod","cachedPromise","isOpList","modifiedIdsHash","cacheKeyBuf","page","terminated","sink","readyReason","headersCapability","fullReader","_numPages","htmlForXfa","exception","updatePassword","exportedData","exportedError","fontAdded","finally","imageRef","pageProxy","dataLen","refStr","results","metadata","cleanupSuccessful","INITIAL_DATA","ensureObj","iterator","RenderTask","onContinue","form","rAF","canvasInUse","WeakSet","operatorListIdx","running","graphicsReadyCallback","graphicsReady","_useRequestAnimationFrame","cancelled","_cancelBound","_continueBound","_continue","_scheduleNextBound","_scheduleNext","_nextBound","_next","_canvas","StepperManager","init","getNextBreakPoint","gfx","cancelAnimationFrame","updateOperatorList","requestAnimationFrame","makeColorComp","scaleAndClamp","ColorConverters","CMYK_G","G_CMYK","G_RGB","G_rgb","G_HTML","G","RGB_G","RGB_rgb","RGB_HTML","T_HTML","T_rgb","CMYK_RGB","CMYK_rgb","CMYK_HTML","components","RGB_CMYK","setupStorage","html","storedData","xfaOn","xfaOff","removeAttribute","checked","option","selected","selectedIndex","setAttributes","linkService","isHTMLAnchorElement","HTMLAnchorElement","addLinkAttributes","newWindow","dataId","root","xfaHtml","rootHtml","isNotForRichText","rootDiv","createTextNode","stack","childHtml","xmlns","querySelectorAll","hidden","DEFAULT_TAB_INDEX","annotation_layer_DEFAULT_FONT_SIZE","GetElementsByNameSet","getRectDims","AnnotationElementFactory","annotationType","LinkAnnotationElement","TextAnnotationElement","fieldType","TextWidgetAnnotationElement","radioButton","RadioButtonWidgetAnnotationElement","checkBox","CheckboxWidgetAnnotationElement","PushButtonWidgetAnnotationElement","ChoiceWidgetAnnotationElement","SignatureWidgetAnnotationElement","WidgetAnnotationElement","PopupAnnotationElement","FreeTextAnnotationElement","LineAnnotationElement","SquareAnnotationElement","CircleAnnotationElement","PolylineAnnotationElement","CaretAnnotationElement","InkAnnotationElement","PolygonAnnotationElement","HighlightAnnotationElement","UnderlineAnnotationElement","SquigglyAnnotationElement","StrikeOutAnnotationElement","StampAnnotationElement","FileAttachmentAnnotationElement","AnnotationElement","updates","hasBorder","popupElement","isRenderable","ignoreBorder","createQuadrilaterals","downloadManager","imageResourcesPath","renderForms","svgFactory","enableScripting","_fieldObjects","fieldObjects","_createContainer","_createQuadrilaterals","_hasPopupData","titleObj","contentsObj","richText","_isEditable","isEditable","hasPopupData","updateEdited","setRectEdited","popup","resetEdited","currentRect","setRotation","popupRef","alternativeText","title","noRotate","borderStyle","borderWidth","horizontalRadius","horizontalCornerRadius","verticalRadius","verticalCornerRadius","radius","borderRadius","borderBottomStyle","borderColor","elementWidth","elementHeight","_commonActions","setColor","jsName","styleName","detail","colorType","colorArray","display","noView","noPrint","userName","readonly","required","_setRequired","textColor","_dispatchEventFromSandbox","actions","jsEvent","commonActions","_setDefaultPropertiesFromJS","eventProxy","quadPoints","rectBlX","rectBlY","rectTrX","rectTrY","trX","trY","blX","blY","svgBuffer","clipPath","rectWidth","rectHeight","backgroundImage","_createPopup","modificationDate","parentRect","elements","_getElementsByName","skipId","fields","fieldObj","exportValues","exportValue","domElement","getElementsByName","maybeShow","forceHide","getElementsToTriggerPopup","addHighlightArea","triggers","_editOnDoubleClick","annotationEditorType","isTooltipOnly","link","isBound","_bindNamedAction","attachment","bindAttachment","attachmentDest","bindSetOCGState","_bindLink","Action","_bindJSAction","resetForm","_bindResetFormAction","setInternalLink","destination","getDestinationHash","onclick","goToDestination","getAnchorUrl","executeNamedAction","description","openOrDownloadData","executeSetOCGState","otherClickAction","resetFormFields","refs","resetFormRefs","include","allFields","fieldIds","fieldName","field","allIds","dispatchEvent","Event","showElementAndHideCanvas","previousSibling","_getKeyModifier","_setEventListener","elementData","baseName","eventName","valueGetter","modifier","focused","_setEventListeners","getter","Blur","Focus","_setBackgroundColor","_setTextStyle","TEXT_ALIGNMENT","fontColor","defaultAppearanceData","computedFontSize","roundToOneDecimal","multiLine","numberOfLines","textAlignment","textAlign","isRequired","hasAppearance","fieldValue","setPropertyOnSiblings","keyInStorage","maxLen","charLimit","fieldFormattedValues","formattedValue","comb","userValue","lastCommittedValue","commitKey","doNotScroll","overflowY","overflowX","readOnly","maxLength","defaultFieldValue","blurListener","scrollLeft","selRange","setSelectionRange","willCommit","selStart","selectionStart","selEnd","selectionEnd","_blurListener","Keystroke","inputType","change","fieldWidth","combWidth","letterSpacing","verticalAlign","checkbox","curChecked","buttonValue","radio","pdfButtonValue","linkElement","selectElement","addAnEmptyEntry","combo","multiSelect","multiple","optionElement","displayValue","removeEmptyEntry","noneOptionElement","isExport","selectedValues","getItems","multipleSelection","index","findIndex","selectChild","indices","editable","changeEx","keyDown","PopupElement","elementIds","boundKeyDown","boundHide","boundShow","boundToggle","dateObj","pinned","wasVisible","trigger","flatMap","baseColor","outlineColor","BACKGROUND_ENLIGHT","header","valueOf","contents","_formatContents","makePopupContent","popupLines","popupContent","lineAttributes","line","lines","setPosition","useParentRect","normalizedRect","HORIZONTAL_SPACE_AFTER_ANNOTATION","popupLeft","popupTop","textPosition","lineSpan","lineCoordinates","square","circle","polyline","containerClassName","svgElementName","vertices","polylines","inkLists","inkList","download","accessibilityManager","editableAnnotations","annotationEditorUIManager","_annotationEditorUIManager","hasEditableAnnotations","appendElement","contentElement","moveElementInDOM","annotations","popupToElements","elementParams","noHTML","isPopupAnnotation","rendered","setAnnotationCanvasMap","replaceWith","after","getEditableAnnotations","getEditableAnnotation","EOL_PATTERN","FreeTextEditor","editorDivId","editModeAC","_freeTextDefaultContent","_internalPadding","_defaultColor","_defaultFontSize","_translateEmpty","_editorType","updateFontSize","setFontsize","editorDiv","setEditorDimensions","savedFontsize","col","savedColor","overlayDiv","contentEditable","editorDivKeydown","editorDivFocus","editorDivBlur","editorDivInput","editorDivPaste","extractText","getNodeContent","savedDisplay","savedVisibility","savedText","newText","trimEnd","setText","setContent","dblclick","baseX","baseY","posX","posY","nodeValue","deserializeContent","deleteFromDocument","insertNode","collapseToStart","startContainer","startOffset","bufferBefore","bufferAfter","newRange","beforeLength","reduce","acc","setStart","setEnd","removeAllRanges","addRange","replaceChildren","serializeContent","padding","structTreeParentId","hasElementChanged","Outliner","verticalEdges","intervals","innerMargin","NUMBER_OF_DIGITS","EPSILON","right","shiftedMinX","shiftedMinY","lastEdge","lastPoint","edge","getOutlines","sort","outlineVerticalEdges","breakEdge","edges","allEdges","edge1","edge2","outlines","outline","lastPointX","lastPointY","HighlightOutline","binarySearch","middle","y4","Outline","toSVGPath","_rotation","free","FreeHighlightOutline","polygon","prevX","prevY","FreeOutliner","bottom","last","Float64Array","min_dist","scaleFactor","thickness","MIN_DIST","MIN_DIFF","MIN","getLastCoords","lastTop","lastBottom","diffX","diffY","diffD","nX","nY","thX","thY","lastTopX","lastTopY","lastBottomX","lastBottomY","N","computeMinMax","rescale","rescaleAndSwap","ltrCallback","getNewOutline","outliner","boundPointerDown","buttonSwatch","defaultColor","dropdown","dropdownWasFromKeyboard","isMainColorPicker","_hideDropdownFromKeyboard","_colorSelectFromKeyboard","_moveToNext","_moveToPrevious","_moveToBeginning","_moveToEnd","openDropdown","swatch","renderMainDropdown","getDropdownRoot","role","colorSelect","isDropdownVisible","nextSibling","HighlightEditor","clipPathId","focusOutlines","highlightDiv","highlightOutlines","isFreeHighlight","outlineId","_defaultOpacity","_defaultThickness","_freeHighlightId","_freeHighlight","_freeHighlightClipId","_moveCaret","highlightId","createFreeOutlines","addToDrawLayer","createOutlines","numberOfColors","outlinerForOutline","extraThickness","drawLayer","finalizeLine","highlightOutline","updateLine","updateBox","rotateBbox","updateThickness","changeColor","savedThickness","setThickness","th","changeThickness","getRotation","addUndoableEditor","cleanDrawLayer","mustBeSelected","pointerover","addClass","pointerleave","removeClass","setCaret","serializeBoxes","Float32Array","serializeOutlines","startHighlighting","endHighlight","highlightMove","updatePath","removeFreeHighlight","InkEditor","baseHeight","baseWidth","canvasContextMenuTimeoutId","currentPath2D","drawingAC","hasSomethingToDraw","isCanvasInitialized","observer","pointerdownAC","realWidth","realHeight","requestFrameCallback","bezierPath2D","allRawPaths","currentPath","translationX","translationY","updateOpacity","fitToContent","redraw","setOpacity","savedOpacity","createObserver","setCanvasDims","disconnect","setDimensions","addPointerdownListener","removePointerdownListener","getInitialBBox","setStroke","startDrawing","canvasPointerleave","canvasPointermove","canvasPointerup","drawPoints","draw","path2D","makeBezierCurve","stopDrawing","bezier","generateBezierPoints","xy","lastPoints","xMin","xMax","yMin","yMax","bezierPoints","control1","control2","updateTransform","addInkEditorIfNeeded","canvasPointerdown","ResizeObserver","contentRect","observe","roundedWidth","roundedHeight","setScaleFactor","getPadding","scaleFactorW","scaleFactorH","buildPath2D","toPDFCoordinates","fromPDFCoordinates","serializePaths","p10","p11","p20","p21","p30","p31","p40","p41","getBbox","prevTranslationX","prevTranslationY","unscaledPadding","StampEditor","bitmapId","bitmapPromise","bitmapUrl","bitmapFile","bitmapFileName","resizeTimeoutId","hasBeenAddedInUndoStack","supportedTypes","supportedTypesStr","pasteEditor","getAsFile","hasAltTextStats","hasNoAltText","getBitmapFetched","fromId","getBitmapDone","alt_text_modal","alt_text_type","mlGuessAltText","updateAltTextData","isEnabledFor","copyCanvas","guess","channels","alt","getBitmap","accept","files","click","MAX_RATIO","factor","drawBitmap","maxDimension","bitmapWidth","bitmapHeight","scaleBitmap","boxDim","patternCtx","offscreen","offscreenCtx","prevWidth","prevHeight","transferToImageBitmap","serializeBitmap","toUrl","toDataURL","stamps","area","prevData","allowClick","annotationLayer","clickAC","editorFocusTimeoutId","hadPointerDown","isCleaningUp","isDisabling","textSelectionAC","_initialized","isInvisible","disableTextSelection","toggleAnnotationLayerPointerEvents","enableTextSelection","isCommitting","annotationElementIds","editables","changedAnnotations","resetAnnotations","currentActive","textLayerPointerDown","attach","detach","removePointerInTextLayer","currentEditorType","createNewEditor","getCenterPoint","innerWidth","innerHeight","oldRotation","mapping","toUpdate","_svgFactory","setBox","createSVG","createClipPath","pathId","clipPathUse","isPathUpdatable","use","maskId","use1","use2","cloneNode","changeOpacity","pdfjsVersion","pdfjsBuild","__webpack_exports__AbortException","__webpack_exports__AnnotationEditorLayer","__webpack_exports__AnnotationEditorParamsType","__webpack_exports__AnnotationEditorType","__webpack_exports__AnnotationEditorUIManager","__webpack_exports__AnnotationLayer","__webpack_exports__AnnotationMode","__webpack_exports__CMapCompressionType","__webpack_exports__ColorPicker","__webpack_exports__DOMSVGFactory","__webpack_exports__DrawLayer","__webpack_exports__FeatureTest","__webpack_exports__GlobalWorkerOptions","__webpack_exports__ImageKind","__webpack_exports__InvalidPDFException","__webpack_exports__MissingPDFException","__webpack_exports__OPS","__webpack_exports__PDFDataRangeTransport","__webpack_exports__PDFDateString","__webpack_exports__PDFWorker","__webpack_exports__PasswordResponses","__webpack_exports__PermissionFlag","__webpack_exports__PixelsPerInch","__webpack_exports__RenderingCancelledException","__webpack_exports__TextLayer","__webpack_exports__UnexpectedResponseException","__webpack_exports__Util","__webpack_exports__VerbosityLevel","__webpack_exports__XfaLayer","__webpack_exports__build","__webpack_exports__createValidAbsoluteUrl","__webpack_exports__fetchData","__webpack_exports__getDocument","__webpack_exports__getFilenameFromUrl","__webpack_exports__getPdfFilenameFromUrl","__webpack_exports__getXfaPageViewport","__webpack_exports__isDataScheme","__webpack_exports__isPdfFile","__webpack_exports__noContextMenu","__webpack_exports__normalizeUnicode","__webpack_exports__setLayerDimensions","__webpack_exports__shadow","__webpack_exports__version"],"sources":["/Users/valentina/Documents/DEVELOP/ANGULAR/PORTAFOLIO-WEB-ANGULAR/node_modules/pdfjs-dist/build/pdf.mjs"],"sourcesContent":["/**\n * @licstart The following is the entire license notice for the\n * JavaScript code in this page\n *\n * Copyright 2024 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * @licend The above is the entire license notice for the\n * JavaScript code in this page\n */\n\n/******/ // The require scope\n/******/ var __webpack_require__ = {};\n/******/ \n/************************************************************************/\n/******/ /* webpack/runtime/define property getters */\n/******/ (() => {\n/******/ \t// define getter functions for harmony exports\n/******/ \t__webpack_require__.d = (exports, definition) => {\n/******/ \t\tfor(var key in definition) {\n/******/ \t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n/******/ \t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/hasOwnProperty shorthand */\n/******/ (() => {\n/******/ \t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ })();\n/******/ \n/************************************************************************/\nvar __webpack_exports__ = globalThis.pdfjsLib = {};\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  AbortException: () => (/* reexport */ AbortException),\n  AnnotationEditorLayer: () => (/* reexport */ AnnotationEditorLayer),\n  AnnotationEditorParamsType: () => (/* reexport */ AnnotationEditorParamsType),\n  AnnotationEditorType: () => (/* reexport */ AnnotationEditorType),\n  AnnotationEditorUIManager: () => (/* reexport */ AnnotationEditorUIManager),\n  AnnotationLayer: () => (/* reexport */ AnnotationLayer),\n  AnnotationMode: () => (/* reexport */ AnnotationMode),\n  CMapCompressionType: () => (/* reexport */ CMapCompressionType),\n  ColorPicker: () => (/* reexport */ ColorPicker),\n  DOMSVGFactory: () => (/* reexport */ DOMSVGFactory),\n  DrawLayer: () => (/* reexport */ DrawLayer),\n  FeatureTest: () => (/* reexport */ util_FeatureTest),\n  GlobalWorkerOptions: () => (/* reexport */ GlobalWorkerOptions),\n  ImageKind: () => (/* reexport */ util_ImageKind),\n  InvalidPDFException: () => (/* reexport */ InvalidPDFException),\n  MissingPDFException: () => (/* reexport */ MissingPDFException),\n  OPS: () => (/* reexport */ OPS),\n  PDFDataRangeTransport: () => (/* reexport */ PDFDataRangeTransport),\n  PDFDateString: () => (/* reexport */ PDFDateString),\n  PDFWorker: () => (/* reexport */ PDFWorker),\n  PasswordResponses: () => (/* reexport */ PasswordResponses),\n  PermissionFlag: () => (/* reexport */ PermissionFlag),\n  PixelsPerInch: () => (/* reexport */ PixelsPerInch),\n  RenderingCancelledException: () => (/* reexport */ RenderingCancelledException),\n  TextLayer: () => (/* reexport */ TextLayer),\n  UnexpectedResponseException: () => (/* reexport */ UnexpectedResponseException),\n  Util: () => (/* reexport */ Util),\n  VerbosityLevel: () => (/* reexport */ VerbosityLevel),\n  XfaLayer: () => (/* reexport */ XfaLayer),\n  build: () => (/* reexport */ build),\n  createValidAbsoluteUrl: () => (/* reexport */ createValidAbsoluteUrl),\n  fetchData: () => (/* reexport */ fetchData),\n  getDocument: () => (/* reexport */ getDocument),\n  getFilenameFromUrl: () => (/* reexport */ getFilenameFromUrl),\n  getPdfFilenameFromUrl: () => (/* reexport */ getPdfFilenameFromUrl),\n  getXfaPageViewport: () => (/* reexport */ getXfaPageViewport),\n  isDataScheme: () => (/* reexport */ isDataScheme),\n  isPdfFile: () => (/* reexport */ isPdfFile),\n  noContextMenu: () => (/* reexport */ noContextMenu),\n  normalizeUnicode: () => (/* reexport */ normalizeUnicode),\n  setLayerDimensions: () => (/* reexport */ setLayerDimensions),\n  shadow: () => (/* reexport */ shadow),\n  version: () => (/* reexport */ version)\n});\n\n;// CONCATENATED MODULE: ./src/shared/util.js\nconst isNodeJS = typeof process === \"object\" && process + \"\" === \"[object process]\" && !process.versions.nw && !(process.versions.electron && process.type && process.type !== \"browser\");\nconst IDENTITY_MATRIX = [1, 0, 0, 1, 0, 0];\nconst FONT_IDENTITY_MATRIX = [0.001, 0, 0, 0.001, 0, 0];\nconst MAX_IMAGE_SIZE_TO_CACHE = 10e6;\nconst LINE_FACTOR = 1.35;\nconst LINE_DESCENT_FACTOR = 0.35;\nconst BASELINE_FACTOR = LINE_DESCENT_FACTOR / LINE_FACTOR;\nconst RenderingIntentFlag = {\n  ANY: 0x01,\n  DISPLAY: 0x02,\n  PRINT: 0x04,\n  SAVE: 0x08,\n  ANNOTATIONS_FORMS: 0x10,\n  ANNOTATIONS_STORAGE: 0x20,\n  ANNOTATIONS_DISABLE: 0x40,\n  IS_EDITING: 0x80,\n  OPLIST: 0x100\n};\nconst AnnotationMode = {\n  DISABLE: 0,\n  ENABLE: 1,\n  ENABLE_FORMS: 2,\n  ENABLE_STORAGE: 3\n};\nconst AnnotationEditorPrefix = \"pdfjs_internal_editor_\";\nconst AnnotationEditorType = {\n  DISABLE: -1,\n  NONE: 0,\n  FREETEXT: 3,\n  HIGHLIGHT: 9,\n  STAMP: 13,\n  INK: 15\n};\nconst AnnotationEditorParamsType = {\n  RESIZE: 1,\n  CREATE: 2,\n  FREETEXT_SIZE: 11,\n  FREETEXT_COLOR: 12,\n  FREETEXT_OPACITY: 13,\n  INK_COLOR: 21,\n  INK_THICKNESS: 22,\n  INK_OPACITY: 23,\n  HIGHLIGHT_COLOR: 31,\n  HIGHLIGHT_DEFAULT_COLOR: 32,\n  HIGHLIGHT_THICKNESS: 33,\n  HIGHLIGHT_FREE: 34,\n  HIGHLIGHT_SHOW_ALL: 35\n};\nconst PermissionFlag = {\n  PRINT: 0x04,\n  MODIFY_CONTENTS: 0x08,\n  COPY: 0x10,\n  MODIFY_ANNOTATIONS: 0x20,\n  FILL_INTERACTIVE_FORMS: 0x100,\n  COPY_FOR_ACCESSIBILITY: 0x200,\n  ASSEMBLE: 0x400,\n  PRINT_HIGH_QUALITY: 0x800\n};\nconst TextRenderingMode = {\n  FILL: 0,\n  STROKE: 1,\n  FILL_STROKE: 2,\n  INVISIBLE: 3,\n  FILL_ADD_TO_PATH: 4,\n  STROKE_ADD_TO_PATH: 5,\n  FILL_STROKE_ADD_TO_PATH: 6,\n  ADD_TO_PATH: 7,\n  FILL_STROKE_MASK: 3,\n  ADD_TO_PATH_FLAG: 4\n};\nconst util_ImageKind = {\n  GRAYSCALE_1BPP: 1,\n  RGB_24BPP: 2,\n  RGBA_32BPP: 3\n};\nconst AnnotationType = {\n  TEXT: 1,\n  LINK: 2,\n  FREETEXT: 3,\n  LINE: 4,\n  SQUARE: 5,\n  CIRCLE: 6,\n  POLYGON: 7,\n  POLYLINE: 8,\n  HIGHLIGHT: 9,\n  UNDERLINE: 10,\n  SQUIGGLY: 11,\n  STRIKEOUT: 12,\n  STAMP: 13,\n  CARET: 14,\n  INK: 15,\n  POPUP: 16,\n  FILEATTACHMENT: 17,\n  SOUND: 18,\n  MOVIE: 19,\n  WIDGET: 20,\n  SCREEN: 21,\n  PRINTERMARK: 22,\n  TRAPNET: 23,\n  WATERMARK: 24,\n  THREED: 25,\n  REDACT: 26\n};\nconst AnnotationReplyType = {\n  GROUP: \"Group\",\n  REPLY: \"R\"\n};\nconst AnnotationFlag = {\n  INVISIBLE: 0x01,\n  HIDDEN: 0x02,\n  PRINT: 0x04,\n  NOZOOM: 0x08,\n  NOROTATE: 0x10,\n  NOVIEW: 0x20,\n  READONLY: 0x40,\n  LOCKED: 0x80,\n  TOGGLENOVIEW: 0x100,\n  LOCKEDCONTENTS: 0x200\n};\nconst AnnotationFieldFlag = {\n  READONLY: 0x0000001,\n  REQUIRED: 0x0000002,\n  NOEXPORT: 0x0000004,\n  MULTILINE: 0x0001000,\n  PASSWORD: 0x0002000,\n  NOTOGGLETOOFF: 0x0004000,\n  RADIO: 0x0008000,\n  PUSHBUTTON: 0x0010000,\n  COMBO: 0x0020000,\n  EDIT: 0x0040000,\n  SORT: 0x0080000,\n  FILESELECT: 0x0100000,\n  MULTISELECT: 0x0200000,\n  DONOTSPELLCHECK: 0x0400000,\n  DONOTSCROLL: 0x0800000,\n  COMB: 0x1000000,\n  RICHTEXT: 0x2000000,\n  RADIOSINUNISON: 0x2000000,\n  COMMITONSELCHANGE: 0x4000000\n};\nconst AnnotationBorderStyleType = {\n  SOLID: 1,\n  DASHED: 2,\n  BEVELED: 3,\n  INSET: 4,\n  UNDERLINE: 5\n};\nconst AnnotationActionEventType = {\n  E: \"Mouse Enter\",\n  X: \"Mouse Exit\",\n  D: \"Mouse Down\",\n  U: \"Mouse Up\",\n  Fo: \"Focus\",\n  Bl: \"Blur\",\n  PO: \"PageOpen\",\n  PC: \"PageClose\",\n  PV: \"PageVisible\",\n  PI: \"PageInvisible\",\n  K: \"Keystroke\",\n  F: \"Format\",\n  V: \"Validate\",\n  C: \"Calculate\"\n};\nconst DocumentActionEventType = {\n  WC: \"WillClose\",\n  WS: \"WillSave\",\n  DS: \"DidSave\",\n  WP: \"WillPrint\",\n  DP: \"DidPrint\"\n};\nconst PageActionEventType = {\n  O: \"PageOpen\",\n  C: \"PageClose\"\n};\nconst VerbosityLevel = {\n  ERRORS: 0,\n  WARNINGS: 1,\n  INFOS: 5\n};\nconst CMapCompressionType = {\n  NONE: 0,\n  BINARY: 1\n};\nconst OPS = {\n  dependency: 1,\n  setLineWidth: 2,\n  setLineCap: 3,\n  setLineJoin: 4,\n  setMiterLimit: 5,\n  setDash: 6,\n  setRenderingIntent: 7,\n  setFlatness: 8,\n  setGState: 9,\n  save: 10,\n  restore: 11,\n  transform: 12,\n  moveTo: 13,\n  lineTo: 14,\n  curveTo: 15,\n  curveTo2: 16,\n  curveTo3: 17,\n  closePath: 18,\n  rectangle: 19,\n  stroke: 20,\n  closeStroke: 21,\n  fill: 22,\n  eoFill: 23,\n  fillStroke: 24,\n  eoFillStroke: 25,\n  closeFillStroke: 26,\n  closeEOFillStroke: 27,\n  endPath: 28,\n  clip: 29,\n  eoClip: 30,\n  beginText: 31,\n  endText: 32,\n  setCharSpacing: 33,\n  setWordSpacing: 34,\n  setHScale: 35,\n  setLeading: 36,\n  setFont: 37,\n  setTextRenderingMode: 38,\n  setTextRise: 39,\n  moveText: 40,\n  setLeadingMoveText: 41,\n  setTextMatrix: 42,\n  nextLine: 43,\n  showText: 44,\n  showSpacedText: 45,\n  nextLineShowText: 46,\n  nextLineSetSpacingShowText: 47,\n  setCharWidth: 48,\n  setCharWidthAndBounds: 49,\n  setStrokeColorSpace: 50,\n  setFillColorSpace: 51,\n  setStrokeColor: 52,\n  setStrokeColorN: 53,\n  setFillColor: 54,\n  setFillColorN: 55,\n  setStrokeGray: 56,\n  setFillGray: 57,\n  setStrokeRGBColor: 58,\n  setFillRGBColor: 59,\n  setStrokeCMYKColor: 60,\n  setFillCMYKColor: 61,\n  shadingFill: 62,\n  beginInlineImage: 63,\n  beginImageData: 64,\n  endInlineImage: 65,\n  paintXObject: 66,\n  markPoint: 67,\n  markPointProps: 68,\n  beginMarkedContent: 69,\n  beginMarkedContentProps: 70,\n  endMarkedContent: 71,\n  beginCompat: 72,\n  endCompat: 73,\n  paintFormXObjectBegin: 74,\n  paintFormXObjectEnd: 75,\n  beginGroup: 76,\n  endGroup: 77,\n  beginAnnotation: 80,\n  endAnnotation: 81,\n  paintImageMaskXObject: 83,\n  paintImageMaskXObjectGroup: 84,\n  paintImageXObject: 85,\n  paintInlineImageXObject: 86,\n  paintInlineImageXObjectGroup: 87,\n  paintImageXObjectRepeat: 88,\n  paintImageMaskXObjectRepeat: 89,\n  paintSolidColorImageMask: 90,\n  constructPath: 91,\n  setStrokeTransparent: 92,\n  setFillTransparent: 93\n};\nconst PasswordResponses = {\n  NEED_PASSWORD: 1,\n  INCORRECT_PASSWORD: 2\n};\nlet verbosity = VerbosityLevel.WARNINGS;\nfunction setVerbosityLevel(level) {\n  if (Number.isInteger(level)) {\n    verbosity = level;\n  }\n}\nfunction getVerbosityLevel() {\n  return verbosity;\n}\nfunction info(msg) {\n  if (verbosity >= VerbosityLevel.INFOS) {\n    console.log(`Info: ${msg}`);\n  }\n}\nfunction warn(msg) {\n  if (verbosity >= VerbosityLevel.WARNINGS) {\n    console.log(`Warning: ${msg}`);\n  }\n}\nfunction unreachable(msg) {\n  throw new Error(msg);\n}\nfunction assert(cond, msg) {\n  if (!cond) {\n    unreachable(msg);\n  }\n}\nfunction _isValidProtocol(url) {\n  switch (url?.protocol) {\n    case \"http:\":\n    case \"https:\":\n    case \"ftp:\":\n    case \"mailto:\":\n    case \"tel:\":\n      return true;\n    default:\n      return false;\n  }\n}\nfunction createValidAbsoluteUrl(url, baseUrl = null, options = null) {\n  if (!url) {\n    return null;\n  }\n  try {\n    if (options && typeof url === \"string\") {\n      if (options.addDefaultProtocol && url.startsWith(\"www.\")) {\n        const dots = url.match(/\\./g);\n        if (dots?.length >= 2) {\n          url = `http://${url}`;\n        }\n      }\n      if (options.tryConvertEncoding) {\n        try {\n          url = stringToUTF8String(url);\n        } catch {}\n      }\n    }\n    const absoluteUrl = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    if (_isValidProtocol(absoluteUrl)) {\n      return absoluteUrl;\n    }\n  } catch {}\n  return null;\n}\nfunction shadow(obj, prop, value, nonSerializable = false) {\n  Object.defineProperty(obj, prop, {\n    value,\n    enumerable: !nonSerializable,\n    configurable: true,\n    writable: false\n  });\n  return value;\n}\nconst BaseException = function BaseExceptionClosure() {\n  function BaseException(message, name) {\n    this.message = message;\n    this.name = name;\n  }\n  BaseException.prototype = new Error();\n  BaseException.constructor = BaseException;\n  return BaseException;\n}();\nclass PasswordException extends BaseException {\n  constructor(msg, code) {\n    super(msg, \"PasswordException\");\n    this.code = code;\n  }\n}\nclass UnknownErrorException extends BaseException {\n  constructor(msg, details) {\n    super(msg, \"UnknownErrorException\");\n    this.details = details;\n  }\n}\nclass InvalidPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"InvalidPDFException\");\n  }\n}\nclass MissingPDFException extends BaseException {\n  constructor(msg) {\n    super(msg, \"MissingPDFException\");\n  }\n}\nclass UnexpectedResponseException extends BaseException {\n  constructor(msg, status) {\n    super(msg, \"UnexpectedResponseException\");\n    this.status = status;\n  }\n}\nclass FormatError extends BaseException {\n  constructor(msg) {\n    super(msg, \"FormatError\");\n  }\n}\nclass AbortException extends BaseException {\n  constructor(msg) {\n    super(msg, \"AbortException\");\n  }\n}\nfunction bytesToString(bytes) {\n  if (typeof bytes !== \"object\" || bytes?.length === undefined) {\n    unreachable(\"Invalid argument for bytesToString\");\n  }\n  const length = bytes.length;\n  const MAX_ARGUMENT_COUNT = 8192;\n  if (length < MAX_ARGUMENT_COUNT) {\n    return String.fromCharCode.apply(null, bytes);\n  }\n  const strBuf = [];\n  for (let i = 0; i < length; i += MAX_ARGUMENT_COUNT) {\n    const chunkEnd = Math.min(i + MAX_ARGUMENT_COUNT, length);\n    const chunk = bytes.subarray(i, chunkEnd);\n    strBuf.push(String.fromCharCode.apply(null, chunk));\n  }\n  return strBuf.join(\"\");\n}\nfunction stringToBytes(str) {\n  if (typeof str !== \"string\") {\n    unreachable(\"Invalid argument for stringToBytes\");\n  }\n  const length = str.length;\n  const bytes = new Uint8Array(length);\n  for (let i = 0; i < length; ++i) {\n    bytes[i] = str.charCodeAt(i) & 0xff;\n  }\n  return bytes;\n}\nfunction string32(value) {\n  return String.fromCharCode(value >> 24 & 0xff, value >> 16 & 0xff, value >> 8 & 0xff, value & 0xff);\n}\nfunction objectSize(obj) {\n  return Object.keys(obj).length;\n}\nfunction objectFromMap(map) {\n  const obj = Object.create(null);\n  for (const [key, value] of map) {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction isLittleEndian() {\n  const buffer8 = new Uint8Array(4);\n  buffer8[0] = 1;\n  const view32 = new Uint32Array(buffer8.buffer, 0, 1);\n  return view32[0] === 1;\n}\nfunction isEvalSupported() {\n  try {\n    new Function(\"\");\n    return true;\n  } catch {\n    return false;\n  }\n}\nclass util_FeatureTest {\n  static get isLittleEndian() {\n    return shadow(this, \"isLittleEndian\", isLittleEndian());\n  }\n  static get isEvalSupported() {\n    return shadow(this, \"isEvalSupported\", isEvalSupported());\n  }\n  static get isOffscreenCanvasSupported() {\n    return shadow(this, \"isOffscreenCanvasSupported\", typeof OffscreenCanvas !== \"undefined\");\n  }\n  static get platform() {\n    if (typeof navigator !== \"undefined\" && typeof navigator?.platform === \"string\") {\n      return shadow(this, \"platform\", {\n        isMac: navigator.platform.includes(\"Mac\")\n      });\n    }\n    return shadow(this, \"platform\", {\n      isMac: false\n    });\n  }\n  static get isCSSRoundSupported() {\n    return shadow(this, \"isCSSRoundSupported\", globalThis.CSS?.supports?.(\"width: round(1.5px, 1px)\"));\n  }\n}\nconst hexNumbers = Array.from(Array(256).keys(), n => n.toString(16).padStart(2, \"0\"));\nclass Util {\n  static makeHexColor(r, g, b) {\n    return `#${hexNumbers[r]}${hexNumbers[g]}${hexNumbers[b]}`;\n  }\n  static scaleMinMax(transform, minMax) {\n    let temp;\n    if (transform[0]) {\n      if (transform[0] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[2];\n        minMax[2] = temp;\n      }\n      minMax[0] *= transform[0];\n      minMax[2] *= transform[0];\n      if (transform[3] < 0) {\n        temp = minMax[1];\n        minMax[1] = minMax[3];\n        minMax[3] = temp;\n      }\n      minMax[1] *= transform[3];\n      minMax[3] *= transform[3];\n    } else {\n      temp = minMax[0];\n      minMax[0] = minMax[1];\n      minMax[1] = temp;\n      temp = minMax[2];\n      minMax[2] = minMax[3];\n      minMax[3] = temp;\n      if (transform[1] < 0) {\n        temp = minMax[1];\n        minMax[1] = minMax[3];\n        minMax[3] = temp;\n      }\n      minMax[1] *= transform[1];\n      minMax[3] *= transform[1];\n      if (transform[2] < 0) {\n        temp = minMax[0];\n        minMax[0] = minMax[2];\n        minMax[2] = temp;\n      }\n      minMax[0] *= transform[2];\n      minMax[2] *= transform[2];\n    }\n    minMax[0] += transform[4];\n    minMax[1] += transform[5];\n    minMax[2] += transform[4];\n    minMax[3] += transform[5];\n  }\n  static transform(m1, m2) {\n    return [m1[0] * m2[0] + m1[2] * m2[1], m1[1] * m2[0] + m1[3] * m2[1], m1[0] * m2[2] + m1[2] * m2[3], m1[1] * m2[2] + m1[3] * m2[3], m1[0] * m2[4] + m1[2] * m2[5] + m1[4], m1[1] * m2[4] + m1[3] * m2[5] + m1[5]];\n  }\n  static applyTransform(p, m) {\n    const xt = p[0] * m[0] + p[1] * m[2] + m[4];\n    const yt = p[0] * m[1] + p[1] * m[3] + m[5];\n    return [xt, yt];\n  }\n  static applyInverseTransform(p, m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    const xt = (p[0] * m[3] - p[1] * m[2] + m[2] * m[5] - m[4] * m[3]) / d;\n    const yt = (-p[0] * m[1] + p[1] * m[0] + m[4] * m[1] - m[5] * m[0]) / d;\n    return [xt, yt];\n  }\n  static getAxialAlignedBoundingBox(r, m) {\n    const p1 = this.applyTransform(r, m);\n    const p2 = this.applyTransform(r.slice(2, 4), m);\n    const p3 = this.applyTransform([r[0], r[3]], m);\n    const p4 = this.applyTransform([r[2], r[1]], m);\n    return [Math.min(p1[0], p2[0], p3[0], p4[0]), Math.min(p1[1], p2[1], p3[1], p4[1]), Math.max(p1[0], p2[0], p3[0], p4[0]), Math.max(p1[1], p2[1], p3[1], p4[1])];\n  }\n  static inverseTransform(m) {\n    const d = m[0] * m[3] - m[1] * m[2];\n    return [m[3] / d, -m[1] / d, -m[2] / d, m[0] / d, (m[2] * m[5] - m[4] * m[3]) / d, (m[4] * m[1] - m[5] * m[0]) / d];\n  }\n  static singularValueDecompose2dScale(m) {\n    const transpose = [m[0], m[2], m[1], m[3]];\n    const a = m[0] * transpose[0] + m[1] * transpose[2];\n    const b = m[0] * transpose[1] + m[1] * transpose[3];\n    const c = m[2] * transpose[0] + m[3] * transpose[2];\n    const d = m[2] * transpose[1] + m[3] * transpose[3];\n    const first = (a + d) / 2;\n    const second = Math.sqrt((a + d) ** 2 - 4 * (a * d - c * b)) / 2;\n    const sx = first + second || 1;\n    const sy = first - second || 1;\n    return [Math.sqrt(sx), Math.sqrt(sy)];\n  }\n  static normalizeRect(rect) {\n    const r = rect.slice(0);\n    if (rect[0] > rect[2]) {\n      r[0] = rect[2];\n      r[2] = rect[0];\n    }\n    if (rect[1] > rect[3]) {\n      r[1] = rect[3];\n      r[3] = rect[1];\n    }\n    return r;\n  }\n  static intersect(rect1, rect2) {\n    const xLow = Math.max(Math.min(rect1[0], rect1[2]), Math.min(rect2[0], rect2[2]));\n    const xHigh = Math.min(Math.max(rect1[0], rect1[2]), Math.max(rect2[0], rect2[2]));\n    if (xLow > xHigh) {\n      return null;\n    }\n    const yLow = Math.max(Math.min(rect1[1], rect1[3]), Math.min(rect2[1], rect2[3]));\n    const yHigh = Math.min(Math.max(rect1[1], rect1[3]), Math.max(rect2[1], rect2[3]));\n    if (yLow > yHigh) {\n      return null;\n    }\n    return [xLow, yLow, xHigh, yHigh];\n  }\n  static #getExtremumOnCurve(x0, x1, x2, x3, y0, y1, y2, y3, t, minMax) {\n    if (t <= 0 || t >= 1) {\n      return;\n    }\n    const mt = 1 - t;\n    const tt = t * t;\n    const ttt = tt * t;\n    const x = mt * (mt * (mt * x0 + 3 * t * x1) + 3 * tt * x2) + ttt * x3;\n    const y = mt * (mt * (mt * y0 + 3 * t * y1) + 3 * tt * y2) + ttt * y3;\n    minMax[0] = Math.min(minMax[0], x);\n    minMax[1] = Math.min(minMax[1], y);\n    minMax[2] = Math.max(minMax[2], x);\n    minMax[3] = Math.max(minMax[3], y);\n  }\n  static #getExtremum(x0, x1, x2, x3, y0, y1, y2, y3, a, b, c, minMax) {\n    if (Math.abs(a) < 1e-12) {\n      if (Math.abs(b) >= 1e-12) {\n        this.#getExtremumOnCurve(x0, x1, x2, x3, y0, y1, y2, y3, -c / b, minMax);\n      }\n      return;\n    }\n    const delta = b ** 2 - 4 * c * a;\n    if (delta < 0) {\n      return;\n    }\n    const sqrtDelta = Math.sqrt(delta);\n    const a2 = 2 * a;\n    this.#getExtremumOnCurve(x0, x1, x2, x3, y0, y1, y2, y3, (-b + sqrtDelta) / a2, minMax);\n    this.#getExtremumOnCurve(x0, x1, x2, x3, y0, y1, y2, y3, (-b - sqrtDelta) / a2, minMax);\n  }\n  static bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3, minMax) {\n    if (minMax) {\n      minMax[0] = Math.min(minMax[0], x0, x3);\n      minMax[1] = Math.min(minMax[1], y0, y3);\n      minMax[2] = Math.max(minMax[2], x0, x3);\n      minMax[3] = Math.max(minMax[3], y0, y3);\n    } else {\n      minMax = [Math.min(x0, x3), Math.min(y0, y3), Math.max(x0, x3), Math.max(y0, y3)];\n    }\n    this.#getExtremum(x0, x1, x2, x3, y0, y1, y2, y3, 3 * (-x0 + 3 * (x1 - x2) + x3), 6 * (x0 - 2 * x1 + x2), 3 * (x1 - x0), minMax);\n    this.#getExtremum(x0, x1, x2, x3, y0, y1, y2, y3, 3 * (-y0 + 3 * (y1 - y2) + y3), 6 * (y0 - 2 * y1 + y2), 3 * (y1 - y0), minMax);\n    return minMax;\n  }\n}\nconst PDFStringTranslateTable = (/* unused pure expression or super */ null && ([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2d8, 0x2c7, 0x2c6, 0x2d9, 0x2dd, 0x2db, 0x2da, 0x2dc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2022, 0x2020, 0x2021, 0x2026, 0x2014, 0x2013, 0x192, 0x2044, 0x2039, 0x203a, 0x2212, 0x2030, 0x201e, 0x201c, 0x201d, 0x2018, 0x2019, 0x201a, 0x2122, 0xfb01, 0xfb02, 0x141, 0x152, 0x160, 0x178, 0x17d, 0x131, 0x142, 0x153, 0x161, 0x17e, 0, 0x20ac]));\nfunction stringToPDFString(str) {\n  if (str[0] >= \"\\xEF\") {\n    let encoding;\n    if (str[0] === \"\\xFE\" && str[1] === \"\\xFF\") {\n      encoding = \"utf-16be\";\n      if (str.length % 2 === 1) {\n        str = str.slice(0, -1);\n      }\n    } else if (str[0] === \"\\xFF\" && str[1] === \"\\xFE\") {\n      encoding = \"utf-16le\";\n      if (str.length % 2 === 1) {\n        str = str.slice(0, -1);\n      }\n    } else if (str[0] === \"\\xEF\" && str[1] === \"\\xBB\" && str[2] === \"\\xBF\") {\n      encoding = \"utf-8\";\n    }\n    if (encoding) {\n      try {\n        const decoder = new TextDecoder(encoding, {\n          fatal: true\n        });\n        const buffer = stringToBytes(str);\n        const decoded = decoder.decode(buffer);\n        if (!decoded.includes(\"\\x1b\")) {\n          return decoded;\n        }\n        return decoded.replaceAll(/\\x1b[^\\x1b]*(?:\\x1b|$)/g, \"\");\n      } catch (ex) {\n        warn(`stringToPDFString: \"${ex}\".`);\n      }\n    }\n  }\n  const strBuf = [];\n  for (let i = 0, ii = str.length; i < ii; i++) {\n    const charCode = str.charCodeAt(i);\n    if (charCode === 0x1b) {\n      while (++i < ii && str.charCodeAt(i) !== 0x1b) {}\n      continue;\n    }\n    const code = PDFStringTranslateTable[charCode];\n    strBuf.push(code ? String.fromCharCode(code) : str.charAt(i));\n  }\n  return strBuf.join(\"\");\n}\nfunction stringToUTF8String(str) {\n  return decodeURIComponent(escape(str));\n}\nfunction utf8StringToString(str) {\n  return unescape(encodeURIComponent(str));\n}\nfunction isArrayEqual(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n  for (let i = 0, ii = arr1.length; i < ii; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction getModificationDate(date = new Date()) {\n  const buffer = [date.getUTCFullYear().toString(), (date.getUTCMonth() + 1).toString().padStart(2, \"0\"), date.getUTCDate().toString().padStart(2, \"0\"), date.getUTCHours().toString().padStart(2, \"0\"), date.getUTCMinutes().toString().padStart(2, \"0\"), date.getUTCSeconds().toString().padStart(2, \"0\")];\n  return buffer.join(\"\");\n}\nlet NormalizeRegex = null;\nlet NormalizationMap = null;\nfunction normalizeUnicode(str) {\n  if (!NormalizeRegex) {\n    NormalizeRegex = /([\\u00a0\\u00b5\\u037e\\u0eb3\\u2000-\\u200a\\u202f\\u2126\\ufb00-\\ufb04\\ufb06\\ufb20-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufba1\\ufba4-\\ufba9\\ufbae-\\ufbb1\\ufbd3-\\ufbdc\\ufbde-\\ufbe7\\ufbea-\\ufbf8\\ufbfc-\\ufbfd\\ufc00-\\ufc5d\\ufc64-\\ufcf1\\ufcf5-\\ufd3d\\ufd88\\ufdf4\\ufdfa-\\ufdfb\\ufe71\\ufe77\\ufe79\\ufe7b\\ufe7d]+)|(\\ufb05+)/gu;\n    NormalizationMap = new Map([[\"ﬅ\", \"ſt\"]]);\n  }\n  return str.replaceAll(NormalizeRegex, (_, p1, p2) => p1 ? p1.normalize(\"NFKC\") : NormalizationMap.get(p2));\n}\nfunction getUuid() {\n  if (typeof crypto !== \"undefined\" && typeof crypto?.randomUUID === \"function\") {\n    return crypto.randomUUID();\n  }\n  const buf = new Uint8Array(32);\n  if (typeof crypto !== \"undefined\" && typeof crypto?.getRandomValues === \"function\") {\n    crypto.getRandomValues(buf);\n  } else {\n    for (let i = 0; i < 32; i++) {\n      buf[i] = Math.floor(Math.random() * 255);\n    }\n  }\n  return bytesToString(buf);\n}\nconst AnnotationPrefix = \"pdfjs_internal_id_\";\nconst FontRenderOps = {\n  BEZIER_CURVE_TO: 0,\n  MOVE_TO: 1,\n  LINE_TO: 2,\n  QUADRATIC_CURVE_TO: 3,\n  RESTORE: 4,\n  SAVE: 5,\n  SCALE: 6,\n  TRANSFORM: 7,\n  TRANSLATE: 8\n};\n\n;// CONCATENATED MODULE: ./src/display/base_factory.js\n\nclass BaseFilterFactory {\n  addFilter(maps) {\n    return \"none\";\n  }\n  addHCMFilter(fgColor, bgColor) {\n    return \"none\";\n  }\n  addAlphaFilter(map) {\n    return \"none\";\n  }\n  addLuminosityFilter(map) {\n    return \"none\";\n  }\n  addHighlightHCMFilter(filterName, fgColor, bgColor, newFgColor, newBgColor) {\n    return \"none\";\n  }\n  destroy(keepHCM = false) {}\n}\nclass BaseCanvasFactory {\n  #enableHWA = false;\n  constructor({\n    enableHWA = false\n  } = {}) {\n    this.#enableHWA = enableHWA;\n  }\n  create(width, height) {\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid canvas size\");\n    }\n    const canvas = this._createCanvas(width, height);\n    return {\n      canvas,\n      context: canvas.getContext(\"2d\", {\n        willReadFrequently: !this.#enableHWA\n      })\n    };\n  }\n  reset(canvasAndContext, width, height) {\n    if (!canvasAndContext.canvas) {\n      throw new Error(\"Canvas is not specified\");\n    }\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid canvas size\");\n    }\n    canvasAndContext.canvas.width = width;\n    canvasAndContext.canvas.height = height;\n  }\n  destroy(canvasAndContext) {\n    if (!canvasAndContext.canvas) {\n      throw new Error(\"Canvas is not specified\");\n    }\n    canvasAndContext.canvas.width = 0;\n    canvasAndContext.canvas.height = 0;\n    canvasAndContext.canvas = null;\n    canvasAndContext.context = null;\n  }\n  _createCanvas(width, height) {\n    unreachable(\"Abstract method `_createCanvas` called.\");\n  }\n}\nclass BaseCMapReaderFactory {\n  constructor({\n    baseUrl = null,\n    isCompressed = true\n  }) {\n    this.baseUrl = baseUrl;\n    this.isCompressed = isCompressed;\n  }\n  async fetch({\n    name\n  }) {\n    if (!this.baseUrl) {\n      throw new Error(\"Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.\");\n    }\n    if (!name) {\n      throw new Error(\"CMap name must be specified.\");\n    }\n    const url = this.baseUrl + name + (this.isCompressed ? \".bcmap\" : \"\");\n    const compressionType = this.isCompressed ? CMapCompressionType.BINARY : CMapCompressionType.NONE;\n    return this._fetchData(url, compressionType).catch(reason => {\n      throw new Error(`Unable to load ${this.isCompressed ? \"binary \" : \"\"}CMap at: ${url}`);\n    });\n  }\n  _fetchData(url, compressionType) {\n    unreachable(\"Abstract method `_fetchData` called.\");\n  }\n}\nclass BaseStandardFontDataFactory {\n  constructor({\n    baseUrl = null\n  }) {\n    this.baseUrl = baseUrl;\n  }\n  async fetch({\n    filename\n  }) {\n    if (!this.baseUrl) {\n      throw new Error(\"Ensure that the `standardFontDataUrl` API parameter is provided.\");\n    }\n    if (!filename) {\n      throw new Error(\"Font filename must be specified.\");\n    }\n    const url = `${this.baseUrl}${filename}`;\n    return this._fetchData(url).catch(reason => {\n      throw new Error(`Unable to load font data at: ${url}`);\n    });\n  }\n  _fetchData(url) {\n    unreachable(\"Abstract method `_fetchData` called.\");\n  }\n}\nclass BaseSVGFactory {\n  create(width, height, skipDimensions = false) {\n    if (width <= 0 || height <= 0) {\n      throw new Error(\"Invalid SVG dimensions\");\n    }\n    const svg = this._createSVG(\"svg:svg\");\n    svg.setAttribute(\"version\", \"1.1\");\n    if (!skipDimensions) {\n      svg.setAttribute(\"width\", `${width}px`);\n      svg.setAttribute(\"height\", `${height}px`);\n    }\n    svg.setAttribute(\"preserveAspectRatio\", \"none\");\n    svg.setAttribute(\"viewBox\", `0 0 ${width} ${height}`);\n    return svg;\n  }\n  createElement(type) {\n    if (typeof type !== \"string\") {\n      throw new Error(\"Invalid SVG element type\");\n    }\n    return this._createSVG(type);\n  }\n  _createSVG(type) {\n    unreachable(\"Abstract method `_createSVG` called.\");\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/display_utils.js\n\n\nconst SVG_NS = \"http://www.w3.org/2000/svg\";\nclass PixelsPerInch {\n  static CSS = 96.0;\n  static PDF = 72.0;\n  static PDF_TO_CSS_UNITS = this.CSS / this.PDF;\n}\nclass DOMFilterFactory extends BaseFilterFactory {\n  #baseUrl;\n  #_cache;\n  #_defs;\n  #docId;\n  #document;\n  #_hcmCache;\n  #id = 0;\n  constructor({\n    docId,\n    ownerDocument = globalThis.document\n  } = {}) {\n    super();\n    this.#docId = docId;\n    this.#document = ownerDocument;\n  }\n  get #cache() {\n    return this.#_cache ||= new Map();\n  }\n  get #hcmCache() {\n    return this.#_hcmCache ||= new Map();\n  }\n  get #defs() {\n    if (!this.#_defs) {\n      const div = this.#document.createElement(\"div\");\n      const {\n        style\n      } = div;\n      style.visibility = \"hidden\";\n      style.contain = \"strict\";\n      style.width = style.height = 0;\n      style.position = \"absolute\";\n      style.top = style.left = 0;\n      style.zIndex = -1;\n      const svg = this.#document.createElementNS(SVG_NS, \"svg\");\n      svg.setAttribute(\"width\", 0);\n      svg.setAttribute(\"height\", 0);\n      this.#_defs = this.#document.createElementNS(SVG_NS, \"defs\");\n      div.append(svg);\n      svg.append(this.#_defs);\n      this.#document.body.append(div);\n    }\n    return this.#_defs;\n  }\n  #createTables(maps) {\n    if (maps.length === 1) {\n      const mapR = maps[0];\n      const buffer = new Array(256);\n      for (let i = 0; i < 256; i++) {\n        buffer[i] = mapR[i] / 255;\n      }\n      const table = buffer.join(\",\");\n      return [table, table, table];\n    }\n    const [mapR, mapG, mapB] = maps;\n    const bufferR = new Array(256);\n    const bufferG = new Array(256);\n    const bufferB = new Array(256);\n    for (let i = 0; i < 256; i++) {\n      bufferR[i] = mapR[i] / 255;\n      bufferG[i] = mapG[i] / 255;\n      bufferB[i] = mapB[i] / 255;\n    }\n    return [bufferR.join(\",\"), bufferG.join(\",\"), bufferB.join(\",\")];\n  }\n  #createUrl(id) {\n    if (this.#baseUrl === undefined) {\n      this.#baseUrl = \"\";\n      const url = this.#document.URL;\n      if (url !== this.#document.baseURI) {\n        if (isDataScheme(url)) {\n          warn('#createUrl: ignore \"data:\"-URL for performance reasons.');\n        } else {\n          this.#baseUrl = url.split(\"#\", 1)[0];\n        }\n      }\n    }\n    return `url(${this.#baseUrl}#${id})`;\n  }\n  addFilter(maps) {\n    if (!maps) {\n      return \"none\";\n    }\n    let value = this.#cache.get(maps);\n    if (value) {\n      return value;\n    }\n    const [tableR, tableG, tableB] = this.#createTables(maps);\n    const key = maps.length === 1 ? tableR : `${tableR}${tableG}${tableB}`;\n    value = this.#cache.get(key);\n    if (value) {\n      this.#cache.set(maps, value);\n      return value;\n    }\n    const id = `g_${this.#docId}_transfer_map_${this.#id++}`;\n    const url = this.#createUrl(id);\n    this.#cache.set(maps, url);\n    this.#cache.set(key, url);\n    const filter = this.#createFilter(id);\n    this.#addTransferMapConversion(tableR, tableG, tableB, filter);\n    return url;\n  }\n  addHCMFilter(fgColor, bgColor) {\n    const key = `${fgColor}-${bgColor}`;\n    const filterName = \"base\";\n    let info = this.#hcmCache.get(filterName);\n    if (info?.key === key) {\n      return info.url;\n    }\n    if (info) {\n      info.filter?.remove();\n      info.key = key;\n      info.url = \"none\";\n      info.filter = null;\n    } else {\n      info = {\n        key,\n        url: \"none\",\n        filter: null\n      };\n      this.#hcmCache.set(filterName, info);\n    }\n    if (!fgColor || !bgColor) {\n      return info.url;\n    }\n    const fgRGB = this.#getRGB(fgColor);\n    fgColor = Util.makeHexColor(...fgRGB);\n    const bgRGB = this.#getRGB(bgColor);\n    bgColor = Util.makeHexColor(...bgRGB);\n    this.#defs.style.color = \"\";\n    if (fgColor === \"#000000\" && bgColor === \"#ffffff\" || fgColor === bgColor) {\n      return info.url;\n    }\n    const map = new Array(256);\n    for (let i = 0; i <= 255; i++) {\n      const x = i / 255;\n      map[i] = x <= 0.03928 ? x / 12.92 : ((x + 0.055) / 1.055) ** 2.4;\n    }\n    const table = map.join(\",\");\n    const id = `g_${this.#docId}_hcm_filter`;\n    const filter = info.filter = this.#createFilter(id);\n    this.#addTransferMapConversion(table, table, table, filter);\n    this.#addGrayConversion(filter);\n    const getSteps = (c, n) => {\n      const start = fgRGB[c] / 255;\n      const end = bgRGB[c] / 255;\n      const arr = new Array(n + 1);\n      for (let i = 0; i <= n; i++) {\n        arr[i] = start + i / n * (end - start);\n      }\n      return arr.join(\",\");\n    };\n    this.#addTransferMapConversion(getSteps(0, 5), getSteps(1, 5), getSteps(2, 5), filter);\n    info.url = this.#createUrl(id);\n    return info.url;\n  }\n  addAlphaFilter(map) {\n    let value = this.#cache.get(map);\n    if (value) {\n      return value;\n    }\n    const [tableA] = this.#createTables([map]);\n    const key = `alpha_${tableA}`;\n    value = this.#cache.get(key);\n    if (value) {\n      this.#cache.set(map, value);\n      return value;\n    }\n    const id = `g_${this.#docId}_alpha_map_${this.#id++}`;\n    const url = this.#createUrl(id);\n    this.#cache.set(map, url);\n    this.#cache.set(key, url);\n    const filter = this.#createFilter(id);\n    this.#addTransferMapAlphaConversion(tableA, filter);\n    return url;\n  }\n  addLuminosityFilter(map) {\n    let value = this.#cache.get(map || \"luminosity\");\n    if (value) {\n      return value;\n    }\n    let tableA, key;\n    if (map) {\n      [tableA] = this.#createTables([map]);\n      key = `luminosity_${tableA}`;\n    } else {\n      key = \"luminosity\";\n    }\n    value = this.#cache.get(key);\n    if (value) {\n      this.#cache.set(map, value);\n      return value;\n    }\n    const id = `g_${this.#docId}_luminosity_map_${this.#id++}`;\n    const url = this.#createUrl(id);\n    this.#cache.set(map, url);\n    this.#cache.set(key, url);\n    const filter = this.#createFilter(id);\n    this.#addLuminosityConversion(filter);\n    if (map) {\n      this.#addTransferMapAlphaConversion(tableA, filter);\n    }\n    return url;\n  }\n  addHighlightHCMFilter(filterName, fgColor, bgColor, newFgColor, newBgColor) {\n    const key = `${fgColor}-${bgColor}-${newFgColor}-${newBgColor}`;\n    let info = this.#hcmCache.get(filterName);\n    if (info?.key === key) {\n      return info.url;\n    }\n    if (info) {\n      info.filter?.remove();\n      info.key = key;\n      info.url = \"none\";\n      info.filter = null;\n    } else {\n      info = {\n        key,\n        url: \"none\",\n        filter: null\n      };\n      this.#hcmCache.set(filterName, info);\n    }\n    if (!fgColor || !bgColor) {\n      return info.url;\n    }\n    const [fgRGB, bgRGB] = [fgColor, bgColor].map(this.#getRGB.bind(this));\n    let fgGray = Math.round(0.2126 * fgRGB[0] + 0.7152 * fgRGB[1] + 0.0722 * fgRGB[2]);\n    let bgGray = Math.round(0.2126 * bgRGB[0] + 0.7152 * bgRGB[1] + 0.0722 * bgRGB[2]);\n    let [newFgRGB, newBgRGB] = [newFgColor, newBgColor].map(this.#getRGB.bind(this));\n    if (bgGray < fgGray) {\n      [fgGray, bgGray, newFgRGB, newBgRGB] = [bgGray, fgGray, newBgRGB, newFgRGB];\n    }\n    this.#defs.style.color = \"\";\n    const getSteps = (fg, bg, n) => {\n      const arr = new Array(256);\n      const step = (bgGray - fgGray) / n;\n      const newStart = fg / 255;\n      const newStep = (bg - fg) / (255 * n);\n      let prev = 0;\n      for (let i = 0; i <= n; i++) {\n        const k = Math.round(fgGray + i * step);\n        const value = newStart + i * newStep;\n        for (let j = prev; j <= k; j++) {\n          arr[j] = value;\n        }\n        prev = k + 1;\n      }\n      for (let i = prev; i < 256; i++) {\n        arr[i] = arr[prev - 1];\n      }\n      return arr.join(\",\");\n    };\n    const id = `g_${this.#docId}_hcm_${filterName}_filter`;\n    const filter = info.filter = this.#createFilter(id);\n    this.#addGrayConversion(filter);\n    this.#addTransferMapConversion(getSteps(newFgRGB[0], newBgRGB[0], 5), getSteps(newFgRGB[1], newBgRGB[1], 5), getSteps(newFgRGB[2], newBgRGB[2], 5), filter);\n    info.url = this.#createUrl(id);\n    return info.url;\n  }\n  destroy(keepHCM = false) {\n    if (keepHCM && this.#hcmCache.size !== 0) {\n      return;\n    }\n    if (this.#_defs) {\n      this.#_defs.parentNode.parentNode.remove();\n      this.#_defs = null;\n    }\n    if (this.#_cache) {\n      this.#_cache.clear();\n      this.#_cache = null;\n    }\n    this.#id = 0;\n  }\n  #addLuminosityConversion(filter) {\n    const feColorMatrix = this.#document.createElementNS(SVG_NS, \"feColorMatrix\");\n    feColorMatrix.setAttribute(\"type\", \"matrix\");\n    feColorMatrix.setAttribute(\"values\", \"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0\");\n    filter.append(feColorMatrix);\n  }\n  #addGrayConversion(filter) {\n    const feColorMatrix = this.#document.createElementNS(SVG_NS, \"feColorMatrix\");\n    feColorMatrix.setAttribute(\"type\", \"matrix\");\n    feColorMatrix.setAttribute(\"values\", \"0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0\");\n    filter.append(feColorMatrix);\n  }\n  #createFilter(id) {\n    const filter = this.#document.createElementNS(SVG_NS, \"filter\");\n    filter.setAttribute(\"color-interpolation-filters\", \"sRGB\");\n    filter.setAttribute(\"id\", id);\n    this.#defs.append(filter);\n    return filter;\n  }\n  #appendFeFunc(feComponentTransfer, func, table) {\n    const feFunc = this.#document.createElementNS(SVG_NS, func);\n    feFunc.setAttribute(\"type\", \"discrete\");\n    feFunc.setAttribute(\"tableValues\", table);\n    feComponentTransfer.append(feFunc);\n  }\n  #addTransferMapConversion(rTable, gTable, bTable, filter) {\n    const feComponentTransfer = this.#document.createElementNS(SVG_NS, \"feComponentTransfer\");\n    filter.append(feComponentTransfer);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncR\", rTable);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncG\", gTable);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncB\", bTable);\n  }\n  #addTransferMapAlphaConversion(aTable, filter) {\n    const feComponentTransfer = this.#document.createElementNS(SVG_NS, \"feComponentTransfer\");\n    filter.append(feComponentTransfer);\n    this.#appendFeFunc(feComponentTransfer, \"feFuncA\", aTable);\n  }\n  #getRGB(color) {\n    this.#defs.style.color = color;\n    return getRGB(getComputedStyle(this.#defs).getPropertyValue(\"color\"));\n  }\n}\nclass DOMCanvasFactory extends BaseCanvasFactory {\n  constructor({\n    ownerDocument = globalThis.document,\n    enableHWA = false\n  } = {}) {\n    super({\n      enableHWA\n    });\n    this._document = ownerDocument;\n  }\n  _createCanvas(width, height) {\n    const canvas = this._document.createElement(\"canvas\");\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  }\n}\nasync function fetchData(url, type = \"text\") {\n  if (isValidFetchUrl(url, document.baseURI)) {\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(response.statusText);\n    }\n    switch (type) {\n      case \"arraybuffer\":\n        return response.arrayBuffer();\n      case \"blob\":\n        return response.blob();\n      case \"json\":\n        return response.json();\n    }\n    return response.text();\n  }\n  return new Promise((resolve, reject) => {\n    const request = new XMLHttpRequest();\n    request.open(\"GET\", url, true);\n    request.responseType = type;\n    request.onreadystatechange = () => {\n      if (request.readyState !== XMLHttpRequest.DONE) {\n        return;\n      }\n      if (request.status === 200 || request.status === 0) {\n        switch (type) {\n          case \"arraybuffer\":\n          case \"blob\":\n          case \"json\":\n            resolve(request.response);\n            return;\n        }\n        resolve(request.responseText);\n        return;\n      }\n      reject(new Error(request.statusText));\n    };\n    request.send(null);\n  });\n}\nclass DOMCMapReaderFactory extends BaseCMapReaderFactory {\n  _fetchData(url, compressionType) {\n    return fetchData(url, this.isCompressed ? \"arraybuffer\" : \"text\").then(data => ({\n      cMapData: data instanceof ArrayBuffer ? new Uint8Array(data) : stringToBytes(data),\n      compressionType\n    }));\n  }\n}\nclass DOMStandardFontDataFactory extends BaseStandardFontDataFactory {\n  _fetchData(url) {\n    return fetchData(url, \"arraybuffer\").then(data => new Uint8Array(data));\n  }\n}\nclass DOMSVGFactory extends BaseSVGFactory {\n  _createSVG(type) {\n    return document.createElementNS(SVG_NS, type);\n  }\n}\nclass PageViewport {\n  constructor({\n    viewBox,\n    scale,\n    rotation,\n    offsetX = 0,\n    offsetY = 0,\n    dontFlip = false\n  }) {\n    this.viewBox = viewBox;\n    this.scale = scale;\n    this.rotation = rotation;\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    const centerX = (viewBox[2] + viewBox[0]) / 2;\n    const centerY = (viewBox[3] + viewBox[1]) / 2;\n    let rotateA, rotateB, rotateC, rotateD;\n    rotation %= 360;\n    if (rotation < 0) {\n      rotation += 360;\n    }\n    switch (rotation) {\n      case 180:\n        rotateA = -1;\n        rotateB = 0;\n        rotateC = 0;\n        rotateD = 1;\n        break;\n      case 90:\n        rotateA = 0;\n        rotateB = 1;\n        rotateC = 1;\n        rotateD = 0;\n        break;\n      case 270:\n        rotateA = 0;\n        rotateB = -1;\n        rotateC = -1;\n        rotateD = 0;\n        break;\n      case 0:\n        rotateA = 1;\n        rotateB = 0;\n        rotateC = 0;\n        rotateD = -1;\n        break;\n      default:\n        throw new Error(\"PageViewport: Invalid rotation, must be a multiple of 90 degrees.\");\n    }\n    if (dontFlip) {\n      rotateC = -rotateC;\n      rotateD = -rotateD;\n    }\n    let offsetCanvasX, offsetCanvasY;\n    let width, height;\n    if (rotateA === 0) {\n      offsetCanvasX = Math.abs(centerY - viewBox[1]) * scale + offsetX;\n      offsetCanvasY = Math.abs(centerX - viewBox[0]) * scale + offsetY;\n      width = (viewBox[3] - viewBox[1]) * scale;\n      height = (viewBox[2] - viewBox[0]) * scale;\n    } else {\n      offsetCanvasX = Math.abs(centerX - viewBox[0]) * scale + offsetX;\n      offsetCanvasY = Math.abs(centerY - viewBox[1]) * scale + offsetY;\n      width = (viewBox[2] - viewBox[0]) * scale;\n      height = (viewBox[3] - viewBox[1]) * scale;\n    }\n    this.transform = [rotateA * scale, rotateB * scale, rotateC * scale, rotateD * scale, offsetCanvasX - rotateA * scale * centerX - rotateC * scale * centerY, offsetCanvasY - rotateB * scale * centerX - rotateD * scale * centerY];\n    this.width = width;\n    this.height = height;\n  }\n  get rawDims() {\n    const {\n      viewBox\n    } = this;\n    return shadow(this, \"rawDims\", {\n      pageWidth: viewBox[2] - viewBox[0],\n      pageHeight: viewBox[3] - viewBox[1],\n      pageX: viewBox[0],\n      pageY: viewBox[1]\n    });\n  }\n  clone({\n    scale = this.scale,\n    rotation = this.rotation,\n    offsetX = this.offsetX,\n    offsetY = this.offsetY,\n    dontFlip = false\n  } = {}) {\n    return new PageViewport({\n      viewBox: this.viewBox.slice(),\n      scale,\n      rotation,\n      offsetX,\n      offsetY,\n      dontFlip\n    });\n  }\n  convertToViewportPoint(x, y) {\n    return Util.applyTransform([x, y], this.transform);\n  }\n  convertToViewportRectangle(rect) {\n    const topLeft = Util.applyTransform([rect[0], rect[1]], this.transform);\n    const bottomRight = Util.applyTransform([rect[2], rect[3]], this.transform);\n    return [topLeft[0], topLeft[1], bottomRight[0], bottomRight[1]];\n  }\n  convertToPdfPoint(x, y) {\n    return Util.applyInverseTransform([x, y], this.transform);\n  }\n}\nclass RenderingCancelledException extends BaseException {\n  constructor(msg, extraDelay = 0) {\n    super(msg, \"RenderingCancelledException\");\n    this.extraDelay = extraDelay;\n  }\n}\nfunction isDataScheme(url) {\n  const ii = url.length;\n  let i = 0;\n  while (i < ii && url[i].trim() === \"\") {\n    i++;\n  }\n  return url.substring(i, i + 5).toLowerCase() === \"data:\";\n}\nfunction isPdfFile(filename) {\n  return typeof filename === \"string\" && /\\.pdf$/i.test(filename);\n}\nfunction getFilenameFromUrl(url) {\n  [url] = url.split(/[#?]/, 1);\n  return url.substring(url.lastIndexOf(\"/\") + 1);\n}\nfunction getPdfFilenameFromUrl(url, defaultFilename = \"document.pdf\") {\n  if (typeof url !== \"string\") {\n    return defaultFilename;\n  }\n  if (isDataScheme(url)) {\n    warn('getPdfFilenameFromUrl: ignore \"data:\"-URL for performance reasons.');\n    return defaultFilename;\n  }\n  const reURI = /^(?:(?:[^:]+:)?\\/\\/[^/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n  const reFilename = /[^/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n  const splitURI = reURI.exec(url);\n  let suggestedFilename = reFilename.exec(splitURI[1]) || reFilename.exec(splitURI[2]) || reFilename.exec(splitURI[3]);\n  if (suggestedFilename) {\n    suggestedFilename = suggestedFilename[0];\n    if (suggestedFilename.includes(\"%\")) {\n      try {\n        suggestedFilename = reFilename.exec(decodeURIComponent(suggestedFilename))[0];\n      } catch {}\n    }\n  }\n  return suggestedFilename || defaultFilename;\n}\nclass StatTimer {\n  started = Object.create(null);\n  times = [];\n  time(name) {\n    if (name in this.started) {\n      warn(`Timer is already running for ${name}`);\n    }\n    this.started[name] = Date.now();\n  }\n  timeEnd(name) {\n    if (!(name in this.started)) {\n      warn(`Timer has not been started for ${name}`);\n    }\n    this.times.push({\n      name,\n      start: this.started[name],\n      end: Date.now()\n    });\n    delete this.started[name];\n  }\n  toString() {\n    const outBuf = [];\n    let longest = 0;\n    for (const {\n      name\n    } of this.times) {\n      longest = Math.max(name.length, longest);\n    }\n    for (const {\n      name,\n      start,\n      end\n    } of this.times) {\n      outBuf.push(`${name.padEnd(longest)} ${end - start}ms\\n`);\n    }\n    return outBuf.join(\"\");\n  }\n}\nfunction isValidFetchUrl(url, baseUrl) {\n  try {\n    const {\n      protocol\n    } = baseUrl ? new URL(url, baseUrl) : new URL(url);\n    return protocol === \"http:\" || protocol === \"https:\";\n  } catch {\n    return false;\n  }\n}\nfunction noContextMenu(e) {\n  e.preventDefault();\n}\nfunction deprecated(details) {\n  console.log(\"Deprecated API usage: \" + details);\n}\nlet pdfDateStringRegex;\nclass PDFDateString {\n  static toDateObject(input) {\n    if (!input || typeof input !== \"string\") {\n      return null;\n    }\n    pdfDateStringRegex ||= new RegExp(\"^D:\" + \"(\\\\d{4})\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"(\\\\d{2})?\" + \"([Z|+|-])?\" + \"(\\\\d{2})?\" + \"'?\" + \"(\\\\d{2})?\" + \"'?\");\n    const matches = pdfDateStringRegex.exec(input);\n    if (!matches) {\n      return null;\n    }\n    const year = parseInt(matches[1], 10);\n    let month = parseInt(matches[2], 10);\n    month = month >= 1 && month <= 12 ? month - 1 : 0;\n    let day = parseInt(matches[3], 10);\n    day = day >= 1 && day <= 31 ? day : 1;\n    let hour = parseInt(matches[4], 10);\n    hour = hour >= 0 && hour <= 23 ? hour : 0;\n    let minute = parseInt(matches[5], 10);\n    minute = minute >= 0 && minute <= 59 ? minute : 0;\n    let second = parseInt(matches[6], 10);\n    second = second >= 0 && second <= 59 ? second : 0;\n    const universalTimeRelation = matches[7] || \"Z\";\n    let offsetHour = parseInt(matches[8], 10);\n    offsetHour = offsetHour >= 0 && offsetHour <= 23 ? offsetHour : 0;\n    let offsetMinute = parseInt(matches[9], 10) || 0;\n    offsetMinute = offsetMinute >= 0 && offsetMinute <= 59 ? offsetMinute : 0;\n    if (universalTimeRelation === \"-\") {\n      hour += offsetHour;\n      minute += offsetMinute;\n    } else if (universalTimeRelation === \"+\") {\n      hour -= offsetHour;\n      minute -= offsetMinute;\n    }\n    return new Date(Date.UTC(year, month, day, hour, minute, second));\n  }\n}\nfunction getXfaPageViewport(xfaPage, {\n  scale = 1,\n  rotation = 0\n}) {\n  const {\n    width,\n    height\n  } = xfaPage.attributes.style;\n  const viewBox = [0, 0, parseInt(width), parseInt(height)];\n  return new PageViewport({\n    viewBox,\n    scale,\n    rotation\n  });\n}\nfunction getRGB(color) {\n  if (color.startsWith(\"#\")) {\n    const colorRGB = parseInt(color.slice(1), 16);\n    return [(colorRGB & 0xff0000) >> 16, (colorRGB & 0x00ff00) >> 8, colorRGB & 0x0000ff];\n  }\n  if (color.startsWith(\"rgb(\")) {\n    return color.slice(4, -1).split(\",\").map(x => parseInt(x));\n  }\n  if (color.startsWith(\"rgba(\")) {\n    return color.slice(5, -1).split(\",\").map(x => parseInt(x)).slice(0, 3);\n  }\n  warn(`Not a valid color format: \"${color}\"`);\n  return [0, 0, 0];\n}\nfunction getColorValues(colors) {\n  const span = document.createElement(\"span\");\n  span.style.visibility = \"hidden\";\n  document.body.append(span);\n  for (const name of colors.keys()) {\n    span.style.color = name;\n    const computedColor = window.getComputedStyle(span).color;\n    colors.set(name, getRGB(computedColor));\n  }\n  span.remove();\n}\nfunction getCurrentTransform(ctx) {\n  const {\n    a,\n    b,\n    c,\n    d,\n    e,\n    f\n  } = ctx.getTransform();\n  return [a, b, c, d, e, f];\n}\nfunction getCurrentTransformInverse(ctx) {\n  const {\n    a,\n    b,\n    c,\n    d,\n    e,\n    f\n  } = ctx.getTransform().invertSelf();\n  return [a, b, c, d, e, f];\n}\nfunction setLayerDimensions(div, viewport, mustFlip = false, mustRotate = true) {\n  if (viewport instanceof PageViewport) {\n    const {\n      pageWidth,\n      pageHeight\n    } = viewport.rawDims;\n    const {\n      style\n    } = div;\n    const useRound = util_FeatureTest.isCSSRoundSupported;\n    const w = `var(--scale-factor) * ${pageWidth}px`,\n      h = `var(--scale-factor) * ${pageHeight}px`;\n    const widthStr = useRound ? `round(${w}, 1px)` : `calc(${w})`,\n      heightStr = useRound ? `round(${h}, 1px)` : `calc(${h})`;\n    if (!mustFlip || viewport.rotation % 180 === 0) {\n      style.width = widthStr;\n      style.height = heightStr;\n    } else {\n      style.width = heightStr;\n      style.height = widthStr;\n    }\n  }\n  if (mustRotate) {\n    div.setAttribute(\"data-main-rotation\", viewport.rotation);\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/toolbar.js\n\nclass EditorToolbar {\n  #toolbar = null;\n  #colorPicker = null;\n  #editor;\n  #buttons = null;\n  #altText = null;\n  static #l10nRemove = null;\n  constructor(editor) {\n    this.#editor = editor;\n    EditorToolbar.#l10nRemove ||= Object.freeze({\n      freetext: \"pdfjs-editor-remove-freetext-button\",\n      highlight: \"pdfjs-editor-remove-highlight-button\",\n      ink: \"pdfjs-editor-remove-ink-button\",\n      stamp: \"pdfjs-editor-remove-stamp-button\"\n    });\n  }\n  render() {\n    const editToolbar = this.#toolbar = document.createElement(\"div\");\n    editToolbar.className = \"editToolbar\";\n    editToolbar.setAttribute(\"role\", \"toolbar\");\n    const signal = this.#editor._uiManager._signal;\n    editToolbar.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    editToolbar.addEventListener(\"pointerdown\", EditorToolbar.#pointerDown, {\n      signal\n    });\n    const buttons = this.#buttons = document.createElement(\"div\");\n    buttons.className = \"buttons\";\n    editToolbar.append(buttons);\n    const position = this.#editor.toolbarPosition;\n    if (position) {\n      const {\n        style\n      } = editToolbar;\n      const x = this.#editor._uiManager.direction === \"ltr\" ? 1 - position[0] : position[0];\n      style.insetInlineEnd = `${100 * x}%`;\n      style.top = `calc(${100 * position[1]}% + var(--editor-toolbar-vert-offset))`;\n    }\n    this.#addDeleteButton();\n    return editToolbar;\n  }\n  static #pointerDown(e) {\n    e.stopPropagation();\n  }\n  #focusIn(e) {\n    this.#editor._focusEventsAllowed = false;\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  #focusOut(e) {\n    this.#editor._focusEventsAllowed = true;\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  #addListenersToElement(element) {\n    const signal = this.#editor._uiManager._signal;\n    element.addEventListener(\"focusin\", this.#focusIn.bind(this), {\n      capture: true,\n      signal\n    });\n    element.addEventListener(\"focusout\", this.#focusOut.bind(this), {\n      capture: true,\n      signal\n    });\n    element.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n  }\n  hide() {\n    this.#toolbar.classList.add(\"hidden\");\n    this.#colorPicker?.hideDropdown();\n  }\n  show() {\n    this.#toolbar.classList.remove(\"hidden\");\n    this.#altText?.shown();\n  }\n  #addDeleteButton() {\n    const {\n      editorType,\n      _uiManager\n    } = this.#editor;\n    const button = document.createElement(\"button\");\n    button.className = \"delete\";\n    button.tabIndex = 0;\n    button.setAttribute(\"data-l10n-id\", EditorToolbar.#l10nRemove[editorType]);\n    this.#addListenersToElement(button);\n    button.addEventListener(\"click\", e => {\n      _uiManager.delete();\n    }, {\n      signal: _uiManager._signal\n    });\n    this.#buttons.append(button);\n  }\n  get #divider() {\n    const divider = document.createElement(\"div\");\n    divider.className = \"divider\";\n    return divider;\n  }\n  async addAltText(altText) {\n    const button = await altText.render();\n    this.#addListenersToElement(button);\n    this.#buttons.prepend(button, this.#divider);\n    this.#altText = altText;\n  }\n  addColorPicker(colorPicker) {\n    this.#colorPicker = colorPicker;\n    const button = colorPicker.renderButton();\n    this.#addListenersToElement(button);\n    this.#buttons.prepend(button, this.#divider);\n  }\n  remove() {\n    this.#toolbar.remove();\n    this.#colorPicker?.destroy();\n    this.#colorPicker = null;\n  }\n}\nclass HighlightToolbar {\n  #buttons = null;\n  #toolbar = null;\n  #uiManager;\n  constructor(uiManager) {\n    this.#uiManager = uiManager;\n  }\n  #render() {\n    const editToolbar = this.#toolbar = document.createElement(\"div\");\n    editToolbar.className = \"editToolbar\";\n    editToolbar.setAttribute(\"role\", \"toolbar\");\n    editToolbar.addEventListener(\"contextmenu\", noContextMenu, {\n      signal: this.#uiManager._signal\n    });\n    const buttons = this.#buttons = document.createElement(\"div\");\n    buttons.className = \"buttons\";\n    editToolbar.append(buttons);\n    this.#addHighlightButton();\n    return editToolbar;\n  }\n  #getLastPoint(boxes, isLTR) {\n    let lastY = 0;\n    let lastX = 0;\n    for (const box of boxes) {\n      const y = box.y + box.height;\n      if (y < lastY) {\n        continue;\n      }\n      const x = box.x + (isLTR ? box.width : 0);\n      if (y > lastY) {\n        lastX = x;\n        lastY = y;\n        continue;\n      }\n      if (isLTR) {\n        if (x > lastX) {\n          lastX = x;\n        }\n      } else if (x < lastX) {\n        lastX = x;\n      }\n    }\n    return [isLTR ? 1 - lastX : lastX, lastY];\n  }\n  show(parent, boxes, isLTR) {\n    const [x, y] = this.#getLastPoint(boxes, isLTR);\n    const {\n      style\n    } = this.#toolbar ||= this.#render();\n    parent.append(this.#toolbar);\n    style.insetInlineEnd = `${100 * x}%`;\n    style.top = `calc(${100 * y}% + var(--editor-toolbar-vert-offset))`;\n  }\n  hide() {\n    this.#toolbar.remove();\n  }\n  #addHighlightButton() {\n    const button = document.createElement(\"button\");\n    button.className = \"highlightButton\";\n    button.tabIndex = 0;\n    button.setAttribute(\"data-l10n-id\", `pdfjs-highlight-floating-button1`);\n    const span = document.createElement(\"span\");\n    button.append(span);\n    span.className = \"visuallyHidden\";\n    span.setAttribute(\"data-l10n-id\", \"pdfjs-highlight-floating-button-label\");\n    const signal = this.#uiManager._signal;\n    button.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    button.addEventListener(\"click\", () => {\n      this.#uiManager.highlightSelection(\"floating_button\");\n    }, {\n      signal\n    });\n    this.#buttons.append(button);\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/tools.js\n\n\n\nfunction bindEvents(obj, element, names) {\n  for (const name of names) {\n    element.addEventListener(name, obj[name].bind(obj));\n  }\n}\nfunction opacityToHex(opacity) {\n  return Math.round(Math.min(255, Math.max(1, 255 * opacity))).toString(16).padStart(2, \"0\");\n}\nclass IdManager {\n  #id = 0;\n  get id() {\n    return `${AnnotationEditorPrefix}${this.#id++}`;\n  }\n}\nclass ImageManager {\n  #baseId = getUuid();\n  #id = 0;\n  #cache = null;\n  static get _isSVGFittingCanvas() {\n    const svg = `data:image/svg+xml;charset=UTF-8,<svg viewBox=\"0 0 1 1\" width=\"1\" height=\"1\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"1\" height=\"1\" style=\"fill:red;\"/></svg>`;\n    const canvas = new OffscreenCanvas(1, 3);\n    const ctx = canvas.getContext(\"2d\", {\n      willReadFrequently: true\n    });\n    const image = new Image();\n    image.src = svg;\n    const promise = image.decode().then(() => {\n      ctx.drawImage(image, 0, 0, 1, 1, 0, 0, 1, 3);\n      return new Uint32Array(ctx.getImageData(0, 0, 1, 1).data.buffer)[0] === 0;\n    });\n    return shadow(this, \"_isSVGFittingCanvas\", promise);\n  }\n  async #get(key, rawData) {\n    this.#cache ||= new Map();\n    let data = this.#cache.get(key);\n    if (data === null) {\n      return null;\n    }\n    if (data?.bitmap) {\n      data.refCounter += 1;\n      return data;\n    }\n    try {\n      data ||= {\n        bitmap: null,\n        id: `image_${this.#baseId}_${this.#id++}`,\n        refCounter: 0,\n        isSvg: false\n      };\n      let image;\n      if (typeof rawData === \"string\") {\n        data.url = rawData;\n        image = await fetchData(rawData, \"blob\");\n      } else {\n        image = data.file = rawData;\n      }\n      if (image.type === \"image/svg+xml\") {\n        const mustRemoveAspectRatioPromise = ImageManager._isSVGFittingCanvas;\n        const fileReader = new FileReader();\n        const imageElement = new Image();\n        const imagePromise = new Promise((resolve, reject) => {\n          imageElement.onload = () => {\n            data.bitmap = imageElement;\n            data.isSvg = true;\n            resolve();\n          };\n          fileReader.onload = async () => {\n            const url = data.svgUrl = fileReader.result;\n            imageElement.src = (await mustRemoveAspectRatioPromise) ? `${url}#svgView(preserveAspectRatio(none))` : url;\n          };\n          imageElement.onerror = fileReader.onerror = reject;\n        });\n        fileReader.readAsDataURL(image);\n        await imagePromise;\n      } else {\n        data.bitmap = await createImageBitmap(image);\n      }\n      data.refCounter = 1;\n    } catch (e) {\n      console.error(e);\n      data = null;\n    }\n    this.#cache.set(key, data);\n    if (data) {\n      this.#cache.set(data.id, data);\n    }\n    return data;\n  }\n  async getFromFile(file) {\n    const {\n      lastModified,\n      name,\n      size,\n      type\n    } = file;\n    return this.#get(`${lastModified}_${name}_${size}_${type}`, file);\n  }\n  async getFromUrl(url) {\n    return this.#get(url, url);\n  }\n  async getFromId(id) {\n    this.#cache ||= new Map();\n    const data = this.#cache.get(id);\n    if (!data) {\n      return null;\n    }\n    if (data.bitmap) {\n      data.refCounter += 1;\n      return data;\n    }\n    if (data.file) {\n      return this.getFromFile(data.file);\n    }\n    return this.getFromUrl(data.url);\n  }\n  getSvgUrl(id) {\n    const data = this.#cache.get(id);\n    if (!data?.isSvg) {\n      return null;\n    }\n    return data.svgUrl;\n  }\n  deleteId(id) {\n    this.#cache ||= new Map();\n    const data = this.#cache.get(id);\n    if (!data) {\n      return;\n    }\n    data.refCounter -= 1;\n    if (data.refCounter !== 0) {\n      return;\n    }\n    data.bitmap = null;\n  }\n  isValidId(id) {\n    return id.startsWith(`image_${this.#baseId}_`);\n  }\n}\nclass CommandManager {\n  #commands = [];\n  #locked = false;\n  #maxSize;\n  #position = -1;\n  constructor(maxSize = 128) {\n    this.#maxSize = maxSize;\n  }\n  add({\n    cmd,\n    undo,\n    post,\n    mustExec,\n    type = NaN,\n    overwriteIfSameType = false,\n    keepUndo = false\n  }) {\n    if (mustExec) {\n      cmd();\n    }\n    if (this.#locked) {\n      return;\n    }\n    const save = {\n      cmd,\n      undo,\n      post,\n      type\n    };\n    if (this.#position === -1) {\n      if (this.#commands.length > 0) {\n        this.#commands.length = 0;\n      }\n      this.#position = 0;\n      this.#commands.push(save);\n      return;\n    }\n    if (overwriteIfSameType && this.#commands[this.#position].type === type) {\n      if (keepUndo) {\n        save.undo = this.#commands[this.#position].undo;\n      }\n      this.#commands[this.#position] = save;\n      return;\n    }\n    const next = this.#position + 1;\n    if (next === this.#maxSize) {\n      this.#commands.splice(0, 1);\n    } else {\n      this.#position = next;\n      if (next < this.#commands.length) {\n        this.#commands.splice(next);\n      }\n    }\n    this.#commands.push(save);\n  }\n  undo() {\n    if (this.#position === -1) {\n      return;\n    }\n    this.#locked = true;\n    const {\n      undo,\n      post\n    } = this.#commands[this.#position];\n    undo();\n    post?.();\n    this.#locked = false;\n    this.#position -= 1;\n  }\n  redo() {\n    if (this.#position < this.#commands.length - 1) {\n      this.#position += 1;\n      this.#locked = true;\n      const {\n        cmd,\n        post\n      } = this.#commands[this.#position];\n      cmd();\n      post?.();\n      this.#locked = false;\n    }\n  }\n  hasSomethingToUndo() {\n    return this.#position !== -1;\n  }\n  hasSomethingToRedo() {\n    return this.#position < this.#commands.length - 1;\n  }\n  destroy() {\n    this.#commands = null;\n  }\n}\nclass KeyboardManager {\n  constructor(callbacks) {\n    this.buffer = [];\n    this.callbacks = new Map();\n    this.allKeys = new Set();\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n    for (const [keys, callback, options = {}] of callbacks) {\n      for (const key of keys) {\n        const isMacKey = key.startsWith(\"mac+\");\n        if (isMac && isMacKey) {\n          this.callbacks.set(key.slice(4), {\n            callback,\n            options\n          });\n          this.allKeys.add(key.split(\"+\").at(-1));\n        } else if (!isMac && !isMacKey) {\n          this.callbacks.set(key, {\n            callback,\n            options\n          });\n          this.allKeys.add(key.split(\"+\").at(-1));\n        }\n      }\n    }\n  }\n  #serialize(event) {\n    if (event.altKey) {\n      this.buffer.push(\"alt\");\n    }\n    if (event.ctrlKey) {\n      this.buffer.push(\"ctrl\");\n    }\n    if (event.metaKey) {\n      this.buffer.push(\"meta\");\n    }\n    if (event.shiftKey) {\n      this.buffer.push(\"shift\");\n    }\n    this.buffer.push(event.key);\n    const str = this.buffer.join(\"+\");\n    this.buffer.length = 0;\n    return str;\n  }\n  exec(self, event) {\n    if (!this.allKeys.has(event.key)) {\n      return;\n    }\n    const info = this.callbacks.get(this.#serialize(event));\n    if (!info) {\n      return;\n    }\n    const {\n      callback,\n      options: {\n        bubbles = false,\n        args = [],\n        checker = null\n      }\n    } = info;\n    if (checker && !checker(self, event)) {\n      return;\n    }\n    callback.bind(self, ...args, event)();\n    if (!bubbles) {\n      event.stopPropagation();\n      event.preventDefault();\n    }\n  }\n}\nclass ColorManager {\n  static _colorsMapping = new Map([[\"CanvasText\", [0, 0, 0]], [\"Canvas\", [255, 255, 255]]]);\n  get _colors() {\n    const colors = new Map([[\"CanvasText\", null], [\"Canvas\", null]]);\n    getColorValues(colors);\n    return shadow(this, \"_colors\", colors);\n  }\n  convert(color) {\n    const rgb = getRGB(color);\n    if (!window.matchMedia(\"(forced-colors: active)\").matches) {\n      return rgb;\n    }\n    for (const [name, RGB] of this._colors) {\n      if (RGB.every((x, i) => x === rgb[i])) {\n        return ColorManager._colorsMapping.get(name);\n      }\n    }\n    return rgb;\n  }\n  getHexCode(name) {\n    const rgb = this._colors.get(name);\n    if (!rgb) {\n      return name;\n    }\n    return Util.makeHexColor(...rgb);\n  }\n}\nclass AnnotationEditorUIManager {\n  #abortController = new AbortController();\n  #activeEditor = null;\n  #allEditors = new Map();\n  #allLayers = new Map();\n  #altTextManager = null;\n  #annotationStorage = null;\n  #changedExistingAnnotations = null;\n  #commandManager = new CommandManager();\n  #copyPasteAC = null;\n  #currentPageIndex = 0;\n  #deletedAnnotationsElementIds = new Set();\n  #draggingEditors = null;\n  #editorTypes = null;\n  #editorsToRescale = new Set();\n  #enableHighlightFloatingButton = false;\n  #enableUpdatedAddImage = false;\n  #enableNewAltTextWhenAddingImage = false;\n  #filterFactory = null;\n  #focusMainContainerTimeoutId = null;\n  #focusManagerAC = null;\n  #highlightColors = null;\n  #highlightWhenShiftUp = false;\n  #highlightToolbar = null;\n  #idManager = new IdManager();\n  #isEnabled = false;\n  #isWaiting = false;\n  #keyboardManagerAC = null;\n  #lastActiveElement = null;\n  #mainHighlightColorPicker = null;\n  #mlManager = null;\n  #mode = AnnotationEditorType.NONE;\n  #selectedEditors = new Set();\n  #selectedTextNode = null;\n  #pageColors = null;\n  #showAllStates = null;\n  #previousStates = {\n    isEditing: false,\n    isEmpty: true,\n    hasSomethingToUndo: false,\n    hasSomethingToRedo: false,\n    hasSelectedEditor: false,\n    hasSelectedText: false\n  };\n  #translation = [0, 0];\n  #translationTimeoutId = null;\n  #container = null;\n  #viewer = null;\n  static TRANSLATE_SMALL = 1;\n  static TRANSLATE_BIG = 10;\n  static get _keyboardManager() {\n    const proto = AnnotationEditorUIManager.prototype;\n    const arrowChecker = self => self.#container.contains(document.activeElement) && document.activeElement.tagName !== \"BUTTON\" && self.hasSomethingToControl();\n    const textInputChecker = (_self, {\n      target: el\n    }) => {\n      if (el instanceof HTMLInputElement) {\n        const {\n          type\n        } = el;\n        return type !== \"text\" && type !== \"number\";\n      }\n      return true;\n    };\n    const small = this.TRANSLATE_SMALL;\n    const big = this.TRANSLATE_BIG;\n    return shadow(this, \"_keyboardManager\", new KeyboardManager([[[\"ctrl+a\", \"mac+meta+a\"], proto.selectAll, {\n      checker: textInputChecker\n    }], [[\"ctrl+z\", \"mac+meta+z\"], proto.undo, {\n      checker: textInputChecker\n    }], [[\"ctrl+y\", \"ctrl+shift+z\", \"mac+meta+shift+z\", \"ctrl+shift+Z\", \"mac+meta+shift+Z\"], proto.redo, {\n      checker: textInputChecker\n    }], [[\"Backspace\", \"alt+Backspace\", \"ctrl+Backspace\", \"shift+Backspace\", \"mac+Backspace\", \"mac+alt+Backspace\", \"mac+ctrl+Backspace\", \"Delete\", \"ctrl+Delete\", \"shift+Delete\", \"mac+Delete\"], proto.delete, {\n      checker: textInputChecker\n    }], [[\"Enter\", \"mac+Enter\"], proto.addNewEditorFromKeyboard, {\n      checker: (self, {\n        target: el\n      }) => !(el instanceof HTMLButtonElement) && self.#container.contains(el) && !self.isEnterHandled\n    }], [[\" \", \"mac+ \"], proto.addNewEditorFromKeyboard, {\n      checker: (self, {\n        target: el\n      }) => !(el instanceof HTMLButtonElement) && self.#container.contains(document.activeElement)\n    }], [[\"Escape\", \"mac+Escape\"], proto.unselectAll], [[\"ArrowLeft\", \"mac+ArrowLeft\"], proto.translateSelectedEditors, {\n      args: [-small, 0],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"], proto.translateSelectedEditors, {\n      args: [-big, 0],\n      checker: arrowChecker\n    }], [[\"ArrowRight\", \"mac+ArrowRight\"], proto.translateSelectedEditors, {\n      args: [small, 0],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"], proto.translateSelectedEditors, {\n      args: [big, 0],\n      checker: arrowChecker\n    }], [[\"ArrowUp\", \"mac+ArrowUp\"], proto.translateSelectedEditors, {\n      args: [0, -small],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], proto.translateSelectedEditors, {\n      args: [0, -big],\n      checker: arrowChecker\n    }], [[\"ArrowDown\", \"mac+ArrowDown\"], proto.translateSelectedEditors, {\n      args: [0, small],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], proto.translateSelectedEditors, {\n      args: [0, big],\n      checker: arrowChecker\n    }]]));\n  }\n  constructor(container, viewer, altTextManager, eventBus, pdfDocument, pageColors, highlightColors, enableHighlightFloatingButton, enableUpdatedAddImage, enableNewAltTextWhenAddingImage, mlManager) {\n    const signal = this._signal = this.#abortController.signal;\n    this.#container = container;\n    this.#viewer = viewer;\n    this.#altTextManager = altTextManager;\n    this._eventBus = eventBus;\n    eventBus._on(\"editingaction\", this.onEditingAction.bind(this), {\n      signal\n    });\n    eventBus._on(\"pagechanging\", this.onPageChanging.bind(this), {\n      signal\n    });\n    eventBus._on(\"scalechanging\", this.onScaleChanging.bind(this), {\n      signal\n    });\n    eventBus._on(\"rotationchanging\", this.onRotationChanging.bind(this), {\n      signal\n    });\n    eventBus._on(\"setpreference\", this.onSetPreference.bind(this), {\n      signal\n    });\n    eventBus._on(\"switchannotationeditorparams\", evt => this.updateParams(evt.type, evt.value), {\n      signal\n    });\n    this.#addSelectionListener();\n    this.#addDragAndDropListeners();\n    this.#addKeyboardManager();\n    this.#annotationStorage = pdfDocument.annotationStorage;\n    this.#filterFactory = pdfDocument.filterFactory;\n    this.#pageColors = pageColors;\n    this.#highlightColors = highlightColors || null;\n    this.#enableHighlightFloatingButton = enableHighlightFloatingButton;\n    this.#enableUpdatedAddImage = enableUpdatedAddImage;\n    this.#enableNewAltTextWhenAddingImage = enableNewAltTextWhenAddingImage;\n    this.#mlManager = mlManager || null;\n    this.viewParameters = {\n      realScale: PixelsPerInch.PDF_TO_CSS_UNITS,\n      rotation: 0\n    };\n    this.isShiftKeyDown = false;\n  }\n  destroy() {\n    this.#abortController?.abort();\n    this.#abortController = null;\n    this._signal = null;\n    for (const layer of this.#allLayers.values()) {\n      layer.destroy();\n    }\n    this.#allLayers.clear();\n    this.#allEditors.clear();\n    this.#editorsToRescale.clear();\n    this.#activeEditor = null;\n    this.#selectedEditors.clear();\n    this.#commandManager.destroy();\n    this.#altTextManager?.destroy();\n    this.#highlightToolbar?.hide();\n    this.#highlightToolbar = null;\n    if (this.#focusMainContainerTimeoutId) {\n      clearTimeout(this.#focusMainContainerTimeoutId);\n      this.#focusMainContainerTimeoutId = null;\n    }\n    if (this.#translationTimeoutId) {\n      clearTimeout(this.#translationTimeoutId);\n      this.#translationTimeoutId = null;\n    }\n  }\n  combinedSignal(ac) {\n    return AbortSignal.any([this._signal, ac.signal]);\n  }\n  get mlManager() {\n    return this.#mlManager;\n  }\n  get useNewAltTextFlow() {\n    return this.#enableUpdatedAddImage;\n  }\n  get useNewAltTextWhenAddingImage() {\n    return this.#enableNewAltTextWhenAddingImage;\n  }\n  get hcmFilter() {\n    return shadow(this, \"hcmFilter\", this.#pageColors ? this.#filterFactory.addHCMFilter(this.#pageColors.foreground, this.#pageColors.background) : \"none\");\n  }\n  get direction() {\n    return shadow(this, \"direction\", getComputedStyle(this.#container).direction);\n  }\n  get highlightColors() {\n    return shadow(this, \"highlightColors\", this.#highlightColors ? new Map(this.#highlightColors.split(\",\").map(pair => pair.split(\"=\").map(x => x.trim()))) : null);\n  }\n  get highlightColorNames() {\n    return shadow(this, \"highlightColorNames\", this.highlightColors ? new Map(Array.from(this.highlightColors, e => e.reverse())) : null);\n  }\n  setMainHighlightColorPicker(colorPicker) {\n    this.#mainHighlightColorPicker = colorPicker;\n  }\n  editAltText(editor, firstTime = false) {\n    this.#altTextManager?.editAltText(this, editor, firstTime);\n  }\n  switchToMode(mode, callback) {\n    this._eventBus.on(\"annotationeditormodechanged\", callback, {\n      once: true,\n      signal: this._signal\n    });\n    this._eventBus.dispatch(\"showannotationeditorui\", {\n      source: this,\n      mode\n    });\n  }\n  setPreference(name, value) {\n    this._eventBus.dispatch(\"setpreference\", {\n      source: this,\n      name,\n      value\n    });\n  }\n  onSetPreference({\n    name,\n    value\n  }) {\n    switch (name) {\n      case \"enableNewAltTextWhenAddingImage\":\n        this.#enableNewAltTextWhenAddingImage = value;\n        break;\n    }\n  }\n  onPageChanging({\n    pageNumber\n  }) {\n    this.#currentPageIndex = pageNumber - 1;\n  }\n  focusMainContainer() {\n    this.#container.focus();\n  }\n  findParent(x, y) {\n    for (const layer of this.#allLayers.values()) {\n      const {\n        x: layerX,\n        y: layerY,\n        width,\n        height\n      } = layer.div.getBoundingClientRect();\n      if (x >= layerX && x <= layerX + width && y >= layerY && y <= layerY + height) {\n        return layer;\n      }\n    }\n    return null;\n  }\n  disableUserSelect(value = false) {\n    this.#viewer.classList.toggle(\"noUserSelect\", value);\n  }\n  addShouldRescale(editor) {\n    this.#editorsToRescale.add(editor);\n  }\n  removeShouldRescale(editor) {\n    this.#editorsToRescale.delete(editor);\n  }\n  onScaleChanging({\n    scale\n  }) {\n    this.commitOrRemove();\n    this.viewParameters.realScale = scale * PixelsPerInch.PDF_TO_CSS_UNITS;\n    for (const editor of this.#editorsToRescale) {\n      editor.onScaleChanging();\n    }\n  }\n  onRotationChanging({\n    pagesRotation\n  }) {\n    this.commitOrRemove();\n    this.viewParameters.rotation = pagesRotation;\n  }\n  #getAnchorElementForSelection({\n    anchorNode\n  }) {\n    return anchorNode.nodeType === Node.TEXT_NODE ? anchorNode.parentElement : anchorNode;\n  }\n  #getLayerForTextLayer(textLayer) {\n    const {\n      currentLayer\n    } = this;\n    if (currentLayer.hasTextLayer(textLayer)) {\n      return currentLayer;\n    }\n    for (const layer of this.#allLayers.values()) {\n      if (layer.hasTextLayer(textLayer)) {\n        return layer;\n      }\n    }\n    return null;\n  }\n  highlightSelection(methodOfCreation = \"\") {\n    const selection = document.getSelection();\n    if (!selection || selection.isCollapsed) {\n      return;\n    }\n    const {\n      anchorNode,\n      anchorOffset,\n      focusNode,\n      focusOffset\n    } = selection;\n    const text = selection.toString();\n    const anchorElement = this.#getAnchorElementForSelection(selection);\n    const textLayer = anchorElement.closest(\".textLayer\");\n    const boxes = this.getSelectionBoxes(textLayer);\n    if (!boxes) {\n      return;\n    }\n    selection.empty();\n    const layer = this.#getLayerForTextLayer(textLayer);\n    const isNoneMode = this.#mode === AnnotationEditorType.NONE;\n    const callback = () => {\n      layer?.createAndAddNewEditor({\n        x: 0,\n        y: 0\n      }, false, {\n        methodOfCreation,\n        boxes,\n        anchorNode,\n        anchorOffset,\n        focusNode,\n        focusOffset,\n        text\n      });\n      if (isNoneMode) {\n        this.showAllEditors(\"highlight\", true, true);\n      }\n    };\n    if (isNoneMode) {\n      this.switchToMode(AnnotationEditorType.HIGHLIGHT, callback);\n      return;\n    }\n    callback();\n  }\n  #displayHighlightToolbar() {\n    const selection = document.getSelection();\n    if (!selection || selection.isCollapsed) {\n      return;\n    }\n    const anchorElement = this.#getAnchorElementForSelection(selection);\n    const textLayer = anchorElement.closest(\".textLayer\");\n    const boxes = this.getSelectionBoxes(textLayer);\n    if (!boxes) {\n      return;\n    }\n    this.#highlightToolbar ||= new HighlightToolbar(this);\n    this.#highlightToolbar.show(textLayer, boxes, this.direction === \"ltr\");\n  }\n  addToAnnotationStorage(editor) {\n    if (!editor.isEmpty() && this.#annotationStorage && !this.#annotationStorage.has(editor.id)) {\n      this.#annotationStorage.setValue(editor.id, editor);\n    }\n  }\n  #selectionChange() {\n    const selection = document.getSelection();\n    if (!selection || selection.isCollapsed) {\n      if (this.#selectedTextNode) {\n        this.#highlightToolbar?.hide();\n        this.#selectedTextNode = null;\n        this.#dispatchUpdateStates({\n          hasSelectedText: false\n        });\n      }\n      return;\n    }\n    const {\n      anchorNode\n    } = selection;\n    if (anchorNode === this.#selectedTextNode) {\n      return;\n    }\n    const anchorElement = this.#getAnchorElementForSelection(selection);\n    const textLayer = anchorElement.closest(\".textLayer\");\n    if (!textLayer) {\n      if (this.#selectedTextNode) {\n        this.#highlightToolbar?.hide();\n        this.#selectedTextNode = null;\n        this.#dispatchUpdateStates({\n          hasSelectedText: false\n        });\n      }\n      return;\n    }\n    this.#highlightToolbar?.hide();\n    this.#selectedTextNode = anchorNode;\n    this.#dispatchUpdateStates({\n      hasSelectedText: true\n    });\n    if (this.#mode !== AnnotationEditorType.HIGHLIGHT && this.#mode !== AnnotationEditorType.NONE) {\n      return;\n    }\n    if (this.#mode === AnnotationEditorType.HIGHLIGHT) {\n      this.showAllEditors(\"highlight\", true, true);\n    }\n    this.#highlightWhenShiftUp = this.isShiftKeyDown;\n    if (!this.isShiftKeyDown) {\n      const activeLayer = this.#mode === AnnotationEditorType.HIGHLIGHT ? this.#getLayerForTextLayer(textLayer) : null;\n      activeLayer?.toggleDrawing();\n      const ac = new AbortController();\n      const signal = this.combinedSignal(ac);\n      const pointerup = e => {\n        if (e.type === \"pointerup\" && e.button !== 0) {\n          return;\n        }\n        ac.abort();\n        activeLayer?.toggleDrawing(true);\n        if (e.type === \"pointerup\") {\n          this.#onSelectEnd(\"main_toolbar\");\n        }\n      };\n      window.addEventListener(\"pointerup\", pointerup, {\n        signal\n      });\n      window.addEventListener(\"blur\", pointerup, {\n        signal\n      });\n    }\n  }\n  #onSelectEnd(methodOfCreation = \"\") {\n    if (this.#mode === AnnotationEditorType.HIGHLIGHT) {\n      this.highlightSelection(methodOfCreation);\n    } else if (this.#enableHighlightFloatingButton) {\n      this.#displayHighlightToolbar();\n    }\n  }\n  #addSelectionListener() {\n    document.addEventListener(\"selectionchange\", this.#selectionChange.bind(this), {\n      signal: this._signal\n    });\n  }\n  #addFocusManager() {\n    if (this.#focusManagerAC) {\n      return;\n    }\n    this.#focusManagerAC = new AbortController();\n    const signal = this.combinedSignal(this.#focusManagerAC);\n    window.addEventListener(\"focus\", this.focus.bind(this), {\n      signal\n    });\n    window.addEventListener(\"blur\", this.blur.bind(this), {\n      signal\n    });\n  }\n  #removeFocusManager() {\n    this.#focusManagerAC?.abort();\n    this.#focusManagerAC = null;\n  }\n  blur() {\n    this.isShiftKeyDown = false;\n    if (this.#highlightWhenShiftUp) {\n      this.#highlightWhenShiftUp = false;\n      this.#onSelectEnd(\"main_toolbar\");\n    }\n    if (!this.hasSelection) {\n      return;\n    }\n    const {\n      activeElement\n    } = document;\n    for (const editor of this.#selectedEditors) {\n      if (editor.div.contains(activeElement)) {\n        this.#lastActiveElement = [editor, activeElement];\n        editor._focusEventsAllowed = false;\n        break;\n      }\n    }\n  }\n  focus() {\n    if (!this.#lastActiveElement) {\n      return;\n    }\n    const [lastEditor, lastActiveElement] = this.#lastActiveElement;\n    this.#lastActiveElement = null;\n    lastActiveElement.addEventListener(\"focusin\", () => {\n      lastEditor._focusEventsAllowed = true;\n    }, {\n      once: true,\n      signal: this._signal\n    });\n    lastActiveElement.focus();\n  }\n  #addKeyboardManager() {\n    if (this.#keyboardManagerAC) {\n      return;\n    }\n    this.#keyboardManagerAC = new AbortController();\n    const signal = this.combinedSignal(this.#keyboardManagerAC);\n    window.addEventListener(\"keydown\", this.keydown.bind(this), {\n      signal\n    });\n    window.addEventListener(\"keyup\", this.keyup.bind(this), {\n      signal\n    });\n  }\n  #removeKeyboardManager() {\n    this.#keyboardManagerAC?.abort();\n    this.#keyboardManagerAC = null;\n  }\n  #addCopyPasteListeners() {\n    if (this.#copyPasteAC) {\n      return;\n    }\n    this.#copyPasteAC = new AbortController();\n    const signal = this.combinedSignal(this.#copyPasteAC);\n    document.addEventListener(\"copy\", this.copy.bind(this), {\n      signal\n    });\n    document.addEventListener(\"cut\", this.cut.bind(this), {\n      signal\n    });\n    document.addEventListener(\"paste\", this.paste.bind(this), {\n      signal\n    });\n  }\n  #removeCopyPasteListeners() {\n    this.#copyPasteAC?.abort();\n    this.#copyPasteAC = null;\n  }\n  #addDragAndDropListeners() {\n    const signal = this._signal;\n    document.addEventListener(\"dragover\", this.dragOver.bind(this), {\n      signal\n    });\n    document.addEventListener(\"drop\", this.drop.bind(this), {\n      signal\n    });\n  }\n  addEditListeners() {\n    this.#addKeyboardManager();\n    this.#addCopyPasteListeners();\n  }\n  removeEditListeners() {\n    this.#removeKeyboardManager();\n    this.#removeCopyPasteListeners();\n  }\n  dragOver(event) {\n    for (const {\n      type\n    } of event.dataTransfer.items) {\n      for (const editorType of this.#editorTypes) {\n        if (editorType.isHandlingMimeForPasting(type)) {\n          event.dataTransfer.dropEffect = \"copy\";\n          event.preventDefault();\n          return;\n        }\n      }\n    }\n  }\n  drop(event) {\n    for (const item of event.dataTransfer.items) {\n      for (const editorType of this.#editorTypes) {\n        if (editorType.isHandlingMimeForPasting(item.type)) {\n          editorType.paste(item, this.currentLayer);\n          event.preventDefault();\n          return;\n        }\n      }\n    }\n  }\n  copy(event) {\n    event.preventDefault();\n    this.#activeEditor?.commitOrRemove();\n    if (!this.hasSelection) {\n      return;\n    }\n    const editors = [];\n    for (const editor of this.#selectedEditors) {\n      const serialized = editor.serialize(true);\n      if (serialized) {\n        editors.push(serialized);\n      }\n    }\n    if (editors.length === 0) {\n      return;\n    }\n    event.clipboardData.setData(\"application/pdfjs\", JSON.stringify(editors));\n  }\n  cut(event) {\n    this.copy(event);\n    this.delete();\n  }\n  paste(event) {\n    event.preventDefault();\n    const {\n      clipboardData\n    } = event;\n    for (const item of clipboardData.items) {\n      for (const editorType of this.#editorTypes) {\n        if (editorType.isHandlingMimeForPasting(item.type)) {\n          editorType.paste(item, this.currentLayer);\n          return;\n        }\n      }\n    }\n    let data = clipboardData.getData(\"application/pdfjs\");\n    if (!data) {\n      return;\n    }\n    try {\n      data = JSON.parse(data);\n    } catch (ex) {\n      warn(`paste: \"${ex.message}\".`);\n      return;\n    }\n    if (!Array.isArray(data)) {\n      return;\n    }\n    this.unselectAll();\n    const layer = this.currentLayer;\n    try {\n      const newEditors = [];\n      for (const editor of data) {\n        const deserializedEditor = layer.deserialize(editor);\n        if (!deserializedEditor) {\n          return;\n        }\n        newEditors.push(deserializedEditor);\n      }\n      const cmd = () => {\n        for (const editor of newEditors) {\n          this.#addEditorToLayer(editor);\n        }\n        this.#selectEditors(newEditors);\n      };\n      const undo = () => {\n        for (const editor of newEditors) {\n          editor.remove();\n        }\n      };\n      this.addCommands({\n        cmd,\n        undo,\n        mustExec: true\n      });\n    } catch (ex) {\n      warn(`paste: \"${ex.message}\".`);\n    }\n  }\n  keydown(event) {\n    if (!this.isShiftKeyDown && event.key === \"Shift\") {\n      this.isShiftKeyDown = true;\n    }\n    if (this.#mode !== AnnotationEditorType.NONE && !this.isEditorHandlingKeyboard) {\n      AnnotationEditorUIManager._keyboardManager.exec(this, event);\n    }\n  }\n  keyup(event) {\n    if (this.isShiftKeyDown && event.key === \"Shift\") {\n      this.isShiftKeyDown = false;\n      if (this.#highlightWhenShiftUp) {\n        this.#highlightWhenShiftUp = false;\n        this.#onSelectEnd(\"main_toolbar\");\n      }\n    }\n  }\n  onEditingAction({\n    name\n  }) {\n    switch (name) {\n      case \"undo\":\n      case \"redo\":\n      case \"delete\":\n      case \"selectAll\":\n        this[name]();\n        break;\n      case \"highlightSelection\":\n        this.highlightSelection(\"context_menu\");\n        break;\n    }\n  }\n  #dispatchUpdateStates(details) {\n    const hasChanged = Object.entries(details).some(([key, value]) => this.#previousStates[key] !== value);\n    if (hasChanged) {\n      this._eventBus.dispatch(\"annotationeditorstateschanged\", {\n        source: this,\n        details: Object.assign(this.#previousStates, details)\n      });\n      if (this.#mode === AnnotationEditorType.HIGHLIGHT && details.hasSelectedEditor === false) {\n        this.#dispatchUpdateUI([[AnnotationEditorParamsType.HIGHLIGHT_FREE, true]]);\n      }\n    }\n  }\n  #dispatchUpdateUI(details) {\n    this._eventBus.dispatch(\"annotationeditorparamschanged\", {\n      source: this,\n      details\n    });\n  }\n  setEditingState(isEditing) {\n    if (isEditing) {\n      this.#addFocusManager();\n      this.#addCopyPasteListeners();\n      this.#dispatchUpdateStates({\n        isEditing: this.#mode !== AnnotationEditorType.NONE,\n        isEmpty: this.#isEmpty(),\n        hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n        hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n        hasSelectedEditor: false\n      });\n    } else {\n      this.#removeFocusManager();\n      this.#removeCopyPasteListeners();\n      this.#dispatchUpdateStates({\n        isEditing: false\n      });\n      this.disableUserSelect(false);\n    }\n  }\n  registerEditorTypes(types) {\n    if (this.#editorTypes) {\n      return;\n    }\n    this.#editorTypes = types;\n    for (const editorType of this.#editorTypes) {\n      this.#dispatchUpdateUI(editorType.defaultPropertiesToUpdate);\n    }\n  }\n  getId() {\n    return this.#idManager.id;\n  }\n  get currentLayer() {\n    return this.#allLayers.get(this.#currentPageIndex);\n  }\n  getLayer(pageIndex) {\n    return this.#allLayers.get(pageIndex);\n  }\n  get currentPageIndex() {\n    return this.#currentPageIndex;\n  }\n  addLayer(layer) {\n    this.#allLayers.set(layer.pageIndex, layer);\n    if (this.#isEnabled) {\n      layer.enable();\n    } else {\n      layer.disable();\n    }\n  }\n  removeLayer(layer) {\n    this.#allLayers.delete(layer.pageIndex);\n  }\n  updateMode(mode, editId = null, isFromKeyboard = false) {\n    if (this.#mode === mode) {\n      return;\n    }\n    this.#mode = mode;\n    if (mode === AnnotationEditorType.NONE) {\n      this.setEditingState(false);\n      this.#disableAll();\n      return;\n    }\n    this.setEditingState(true);\n    this.#enableAll();\n    this.unselectAll();\n    for (const layer of this.#allLayers.values()) {\n      layer.updateMode(mode);\n    }\n    if (!editId && isFromKeyboard) {\n      this.addNewEditorFromKeyboard();\n      return;\n    }\n    if (!editId) {\n      return;\n    }\n    for (const editor of this.#allEditors.values()) {\n      if (editor.annotationElementId === editId) {\n        this.setSelected(editor);\n        editor.enterInEditMode();\n        break;\n      }\n    }\n  }\n  addNewEditorFromKeyboard() {\n    if (this.currentLayer.canCreateNewEmptyEditor()) {\n      this.currentLayer.addNewEditor();\n    }\n  }\n  updateToolbar(mode) {\n    if (mode === this.#mode) {\n      return;\n    }\n    this._eventBus.dispatch(\"switchannotationeditormode\", {\n      source: this,\n      mode\n    });\n  }\n  updateParams(type, value) {\n    if (!this.#editorTypes) {\n      return;\n    }\n    switch (type) {\n      case AnnotationEditorParamsType.CREATE:\n        this.currentLayer.addNewEditor();\n        return;\n      case AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:\n        this.#mainHighlightColorPicker?.updateColor(value);\n        break;\n      case AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:\n        this._eventBus.dispatch(\"reporttelemetry\", {\n          source: this,\n          details: {\n            type: \"editing\",\n            data: {\n              type: \"highlight\",\n              action: \"toggle_visibility\"\n            }\n          }\n        });\n        (this.#showAllStates ||= new Map()).set(type, value);\n        this.showAllEditors(\"highlight\", value);\n        break;\n    }\n    for (const editor of this.#selectedEditors) {\n      editor.updateParams(type, value);\n    }\n    for (const editorType of this.#editorTypes) {\n      editorType.updateDefaultParams(type, value);\n    }\n  }\n  showAllEditors(type, visible, updateButton = false) {\n    for (const editor of this.#allEditors.values()) {\n      if (editor.editorType === type) {\n        editor.show(visible);\n      }\n    }\n    const state = this.#showAllStates?.get(AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL) ?? true;\n    if (state !== visible) {\n      this.#dispatchUpdateUI([[AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL, visible]]);\n    }\n  }\n  enableWaiting(mustWait = false) {\n    if (this.#isWaiting === mustWait) {\n      return;\n    }\n    this.#isWaiting = mustWait;\n    for (const layer of this.#allLayers.values()) {\n      if (mustWait) {\n        layer.disableClick();\n      } else {\n        layer.enableClick();\n      }\n      layer.div.classList.toggle(\"waiting\", mustWait);\n    }\n  }\n  #enableAll() {\n    if (!this.#isEnabled) {\n      this.#isEnabled = true;\n      for (const layer of this.#allLayers.values()) {\n        layer.enable();\n      }\n      for (const editor of this.#allEditors.values()) {\n        editor.enable();\n      }\n    }\n  }\n  #disableAll() {\n    this.unselectAll();\n    if (this.#isEnabled) {\n      this.#isEnabled = false;\n      for (const layer of this.#allLayers.values()) {\n        layer.disable();\n      }\n      for (const editor of this.#allEditors.values()) {\n        editor.disable();\n      }\n    }\n  }\n  getEditors(pageIndex) {\n    const editors = [];\n    for (const editor of this.#allEditors.values()) {\n      if (editor.pageIndex === pageIndex) {\n        editors.push(editor);\n      }\n    }\n    return editors;\n  }\n  getEditor(id) {\n    return this.#allEditors.get(id);\n  }\n  addEditor(editor) {\n    this.#allEditors.set(editor.id, editor);\n  }\n  removeEditor(editor) {\n    if (editor.div.contains(document.activeElement)) {\n      if (this.#focusMainContainerTimeoutId) {\n        clearTimeout(this.#focusMainContainerTimeoutId);\n      }\n      this.#focusMainContainerTimeoutId = setTimeout(() => {\n        this.focusMainContainer();\n        this.#focusMainContainerTimeoutId = null;\n      }, 0);\n    }\n    this.#allEditors.delete(editor.id);\n    this.unselect(editor);\n    if (!editor.annotationElementId || !this.#deletedAnnotationsElementIds.has(editor.annotationElementId)) {\n      this.#annotationStorage?.remove(editor.id);\n    }\n  }\n  addDeletedAnnotationElement(editor) {\n    this.#deletedAnnotationsElementIds.add(editor.annotationElementId);\n    this.addChangedExistingAnnotation(editor);\n    editor.deleted = true;\n  }\n  isDeletedAnnotationElement(annotationElementId) {\n    return this.#deletedAnnotationsElementIds.has(annotationElementId);\n  }\n  removeDeletedAnnotationElement(editor) {\n    this.#deletedAnnotationsElementIds.delete(editor.annotationElementId);\n    this.removeChangedExistingAnnotation(editor);\n    editor.deleted = false;\n  }\n  #addEditorToLayer(editor) {\n    const layer = this.#allLayers.get(editor.pageIndex);\n    if (layer) {\n      layer.addOrRebuild(editor);\n    } else {\n      this.addEditor(editor);\n      this.addToAnnotationStorage(editor);\n    }\n  }\n  setActiveEditor(editor) {\n    if (this.#activeEditor === editor) {\n      return;\n    }\n    this.#activeEditor = editor;\n    if (editor) {\n      this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    }\n  }\n  get #lastSelectedEditor() {\n    let ed = null;\n    for (ed of this.#selectedEditors) {}\n    return ed;\n  }\n  updateUI(editor) {\n    if (this.#lastSelectedEditor === editor) {\n      this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    }\n  }\n  toggleSelected(editor) {\n    if (this.#selectedEditors.has(editor)) {\n      this.#selectedEditors.delete(editor);\n      editor.unselect();\n      this.#dispatchUpdateStates({\n        hasSelectedEditor: this.hasSelection\n      });\n      return;\n    }\n    this.#selectedEditors.add(editor);\n    editor.select();\n    this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: true\n    });\n  }\n  setSelected(editor) {\n    for (const ed of this.#selectedEditors) {\n      if (ed !== editor) {\n        ed.unselect();\n      }\n    }\n    this.#selectedEditors.clear();\n    this.#selectedEditors.add(editor);\n    editor.select();\n    this.#dispatchUpdateUI(editor.propertiesToUpdate);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: true\n    });\n  }\n  isSelected(editor) {\n    return this.#selectedEditors.has(editor);\n  }\n  get firstSelectedEditor() {\n    return this.#selectedEditors.values().next().value;\n  }\n  unselect(editor) {\n    editor.unselect();\n    this.#selectedEditors.delete(editor);\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: this.hasSelection\n    });\n  }\n  get hasSelection() {\n    return this.#selectedEditors.size !== 0;\n  }\n  get isEnterHandled() {\n    return this.#selectedEditors.size === 1 && this.firstSelectedEditor.isEnterHandled;\n  }\n  undo() {\n    this.#commandManager.undo();\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: this.#commandManager.hasSomethingToUndo(),\n      hasSomethingToRedo: true,\n      isEmpty: this.#isEmpty()\n    });\n  }\n  redo() {\n    this.#commandManager.redo();\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: true,\n      hasSomethingToRedo: this.#commandManager.hasSomethingToRedo(),\n      isEmpty: this.#isEmpty()\n    });\n  }\n  addCommands(params) {\n    this.#commandManager.add(params);\n    this.#dispatchUpdateStates({\n      hasSomethingToUndo: true,\n      hasSomethingToRedo: false,\n      isEmpty: this.#isEmpty()\n    });\n  }\n  #isEmpty() {\n    if (this.#allEditors.size === 0) {\n      return true;\n    }\n    if (this.#allEditors.size === 1) {\n      for (const editor of this.#allEditors.values()) {\n        return editor.isEmpty();\n      }\n    }\n    return false;\n  }\n  delete() {\n    this.commitOrRemove();\n    if (!this.hasSelection) {\n      return;\n    }\n    const editors = [...this.#selectedEditors];\n    const cmd = () => {\n      for (const editor of editors) {\n        editor.remove();\n      }\n    };\n    const undo = () => {\n      for (const editor of editors) {\n        this.#addEditorToLayer(editor);\n      }\n    };\n    this.addCommands({\n      cmd,\n      undo,\n      mustExec: true\n    });\n  }\n  commitOrRemove() {\n    this.#activeEditor?.commitOrRemove();\n  }\n  hasSomethingToControl() {\n    return this.#activeEditor || this.hasSelection;\n  }\n  #selectEditors(editors) {\n    for (const editor of this.#selectedEditors) {\n      editor.unselect();\n    }\n    this.#selectedEditors.clear();\n    for (const editor of editors) {\n      if (editor.isEmpty()) {\n        continue;\n      }\n      this.#selectedEditors.add(editor);\n      editor.select();\n    }\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: this.hasSelection\n    });\n  }\n  selectAll() {\n    for (const editor of this.#selectedEditors) {\n      editor.commit();\n    }\n    this.#selectEditors(this.#allEditors.values());\n  }\n  unselectAll() {\n    if (this.#activeEditor) {\n      this.#activeEditor.commitOrRemove();\n      if (this.#mode !== AnnotationEditorType.NONE) {\n        return;\n      }\n    }\n    if (!this.hasSelection) {\n      return;\n    }\n    for (const editor of this.#selectedEditors) {\n      editor.unselect();\n    }\n    this.#selectedEditors.clear();\n    this.#dispatchUpdateStates({\n      hasSelectedEditor: false\n    });\n  }\n  translateSelectedEditors(x, y, noCommit = false) {\n    if (!noCommit) {\n      this.commitOrRemove();\n    }\n    if (!this.hasSelection) {\n      return;\n    }\n    this.#translation[0] += x;\n    this.#translation[1] += y;\n    const [totalX, totalY] = this.#translation;\n    const editors = [...this.#selectedEditors];\n    const TIME_TO_WAIT = 1000;\n    if (this.#translationTimeoutId) {\n      clearTimeout(this.#translationTimeoutId);\n    }\n    this.#translationTimeoutId = setTimeout(() => {\n      this.#translationTimeoutId = null;\n      this.#translation[0] = this.#translation[1] = 0;\n      this.addCommands({\n        cmd: () => {\n          for (const editor of editors) {\n            if (this.#allEditors.has(editor.id)) {\n              editor.translateInPage(totalX, totalY);\n            }\n          }\n        },\n        undo: () => {\n          for (const editor of editors) {\n            if (this.#allEditors.has(editor.id)) {\n              editor.translateInPage(-totalX, -totalY);\n            }\n          }\n        },\n        mustExec: false\n      });\n    }, TIME_TO_WAIT);\n    for (const editor of editors) {\n      editor.translateInPage(x, y);\n    }\n  }\n  setUpDragSession() {\n    if (!this.hasSelection) {\n      return;\n    }\n    this.disableUserSelect(true);\n    this.#draggingEditors = new Map();\n    for (const editor of this.#selectedEditors) {\n      this.#draggingEditors.set(editor, {\n        savedX: editor.x,\n        savedY: editor.y,\n        savedPageIndex: editor.pageIndex,\n        newX: 0,\n        newY: 0,\n        newPageIndex: -1\n      });\n    }\n  }\n  endDragSession() {\n    if (!this.#draggingEditors) {\n      return false;\n    }\n    this.disableUserSelect(false);\n    const map = this.#draggingEditors;\n    this.#draggingEditors = null;\n    let mustBeAddedInUndoStack = false;\n    for (const [{\n      x,\n      y,\n      pageIndex\n    }, value] of map) {\n      value.newX = x;\n      value.newY = y;\n      value.newPageIndex = pageIndex;\n      mustBeAddedInUndoStack ||= x !== value.savedX || y !== value.savedY || pageIndex !== value.savedPageIndex;\n    }\n    if (!mustBeAddedInUndoStack) {\n      return false;\n    }\n    const move = (editor, x, y, pageIndex) => {\n      if (this.#allEditors.has(editor.id)) {\n        const parent = this.#allLayers.get(pageIndex);\n        if (parent) {\n          editor._setParentAndPosition(parent, x, y);\n        } else {\n          editor.pageIndex = pageIndex;\n          editor.x = x;\n          editor.y = y;\n        }\n      }\n    };\n    this.addCommands({\n      cmd: () => {\n        for (const [editor, {\n          newX,\n          newY,\n          newPageIndex\n        }] of map) {\n          move(editor, newX, newY, newPageIndex);\n        }\n      },\n      undo: () => {\n        for (const [editor, {\n          savedX,\n          savedY,\n          savedPageIndex\n        }] of map) {\n          move(editor, savedX, savedY, savedPageIndex);\n        }\n      },\n      mustExec: true\n    });\n    return true;\n  }\n  dragSelectedEditors(tx, ty) {\n    if (!this.#draggingEditors) {\n      return;\n    }\n    for (const editor of this.#draggingEditors.keys()) {\n      editor.drag(tx, ty);\n    }\n  }\n  rebuild(editor) {\n    if (editor.parent === null) {\n      const parent = this.getLayer(editor.pageIndex);\n      if (parent) {\n        parent.changeParent(editor);\n        parent.addOrRebuild(editor);\n      } else {\n        this.addEditor(editor);\n        this.addToAnnotationStorage(editor);\n        editor.rebuild();\n      }\n    } else {\n      editor.parent.addOrRebuild(editor);\n    }\n  }\n  get isEditorHandlingKeyboard() {\n    return this.getActive()?.shouldGetKeyboardEvents() || this.#selectedEditors.size === 1 && this.firstSelectedEditor.shouldGetKeyboardEvents();\n  }\n  isActive(editor) {\n    return this.#activeEditor === editor;\n  }\n  getActive() {\n    return this.#activeEditor;\n  }\n  getMode() {\n    return this.#mode;\n  }\n  get imageManager() {\n    return shadow(this, \"imageManager\", new ImageManager());\n  }\n  getSelectionBoxes(textLayer) {\n    if (!textLayer) {\n      return null;\n    }\n    const selection = document.getSelection();\n    for (let i = 0, ii = selection.rangeCount; i < ii; i++) {\n      if (!textLayer.contains(selection.getRangeAt(i).commonAncestorContainer)) {\n        return null;\n      }\n    }\n    const {\n      x: layerX,\n      y: layerY,\n      width: parentWidth,\n      height: parentHeight\n    } = textLayer.getBoundingClientRect();\n    let rotator;\n    switch (textLayer.getAttribute(\"data-main-rotation\")) {\n      case \"90\":\n        rotator = (x, y, w, h) => ({\n          x: (y - layerY) / parentHeight,\n          y: 1 - (x + w - layerX) / parentWidth,\n          width: h / parentHeight,\n          height: w / parentWidth\n        });\n        break;\n      case \"180\":\n        rotator = (x, y, w, h) => ({\n          x: 1 - (x + w - layerX) / parentWidth,\n          y: 1 - (y + h - layerY) / parentHeight,\n          width: w / parentWidth,\n          height: h / parentHeight\n        });\n        break;\n      case \"270\":\n        rotator = (x, y, w, h) => ({\n          x: 1 - (y + h - layerY) / parentHeight,\n          y: (x - layerX) / parentWidth,\n          width: h / parentHeight,\n          height: w / parentWidth\n        });\n        break;\n      default:\n        rotator = (x, y, w, h) => ({\n          x: (x - layerX) / parentWidth,\n          y: (y - layerY) / parentHeight,\n          width: w / parentWidth,\n          height: h / parentHeight\n        });\n        break;\n    }\n    const boxes = [];\n    for (let i = 0, ii = selection.rangeCount; i < ii; i++) {\n      const range = selection.getRangeAt(i);\n      if (range.collapsed) {\n        continue;\n      }\n      for (const {\n        x,\n        y,\n        width,\n        height\n      } of range.getClientRects()) {\n        if (width === 0 || height === 0) {\n          continue;\n        }\n        boxes.push(rotator(x, y, width, height));\n      }\n    }\n    return boxes.length === 0 ? null : boxes;\n  }\n  addChangedExistingAnnotation({\n    annotationElementId,\n    id\n  }) {\n    (this.#changedExistingAnnotations ||= new Map()).set(annotationElementId, id);\n  }\n  removeChangedExistingAnnotation({\n    annotationElementId\n  }) {\n    this.#changedExistingAnnotations?.delete(annotationElementId);\n  }\n  renderAnnotationElement(annotation) {\n    const editorId = this.#changedExistingAnnotations?.get(annotation.data.id);\n    if (!editorId) {\n      return;\n    }\n    const editor = this.#annotationStorage.getRawValue(editorId);\n    if (!editor) {\n      return;\n    }\n    if (this.#mode === AnnotationEditorType.NONE && !editor.hasBeenModified) {\n      return;\n    }\n    editor.renderAnnotationElement(annotation);\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/alt_text.js\n\nclass AltText {\n  #altText = null;\n  #altTextDecorative = false;\n  #altTextButton = null;\n  #altTextTooltip = null;\n  #altTextTooltipTimeout = null;\n  #altTextWasFromKeyBoard = false;\n  #badge = null;\n  #editor = null;\n  #guessedText = null;\n  #textWithDisclaimer = null;\n  #useNewAltTextFlow = false;\n  static _l10nPromise = null;\n  constructor(editor) {\n    this.#editor = editor;\n    this.#useNewAltTextFlow = editor._uiManager.useNewAltTextFlow;\n  }\n  static initialize(l10nPromise) {\n    AltText._l10nPromise ||= l10nPromise;\n  }\n  async render() {\n    const altText = this.#altTextButton = document.createElement(\"button\");\n    altText.className = \"altText\";\n    let msg;\n    if (this.#useNewAltTextFlow) {\n      altText.classList.add(\"new\");\n      msg = await AltText._l10nPromise.get(\"pdfjs-editor-new-alt-text-missing-button-label\");\n    } else {\n      msg = await AltText._l10nPromise.get(\"pdfjs-editor-alt-text-button-label\");\n    }\n    altText.textContent = msg;\n    altText.setAttribute(\"aria-label\", msg);\n    altText.tabIndex = \"0\";\n    const signal = this.#editor._uiManager._signal;\n    altText.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    altText.addEventListener(\"pointerdown\", event => event.stopPropagation(), {\n      signal\n    });\n    const onClick = event => {\n      event.preventDefault();\n      this.#editor._uiManager.editAltText(this.#editor);\n      if (this.#useNewAltTextFlow) {\n        this.#editor._reportTelemetry({\n          action: \"pdfjs.image.alt_text.image_status_label_clicked\",\n          data: {\n            label: this.#label\n          }\n        });\n      }\n    };\n    altText.addEventListener(\"click\", onClick, {\n      capture: true,\n      signal\n    });\n    altText.addEventListener(\"keydown\", event => {\n      if (event.target === altText && event.key === \"Enter\") {\n        this.#altTextWasFromKeyBoard = true;\n        onClick(event);\n      }\n    }, {\n      signal\n    });\n    await this.#setState();\n    return altText;\n  }\n  get #label() {\n    return this.#altText && \"added\" || this.#altText === null && this.guessedText && \"review\" || \"missing\";\n  }\n  finish() {\n    if (!this.#altTextButton) {\n      return;\n    }\n    this.#altTextButton.focus({\n      focusVisible: this.#altTextWasFromKeyBoard\n    });\n    this.#altTextWasFromKeyBoard = false;\n  }\n  isEmpty() {\n    if (this.#useNewAltTextFlow) {\n      return this.#altText === null;\n    }\n    return !this.#altText && !this.#altTextDecorative;\n  }\n  hasData() {\n    if (this.#useNewAltTextFlow) {\n      return this.#altText !== null || !!this.#guessedText;\n    }\n    return this.isEmpty();\n  }\n  get guessedText() {\n    return this.#guessedText;\n  }\n  async setGuessedText(guessedText) {\n    if (this.#altText !== null) {\n      return;\n    }\n    this.#guessedText = guessedText;\n    this.#textWithDisclaimer = await AltText._l10nPromise.get(\"pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer\")({\n      generatedAltText: guessedText\n    });\n    this.#setState();\n  }\n  toggleAltTextBadge(visibility = false) {\n    if (!this.#useNewAltTextFlow || this.#altText) {\n      this.#badge?.remove();\n      this.#badge = null;\n      return;\n    }\n    if (!this.#badge) {\n      const badge = this.#badge = document.createElement(\"div\");\n      badge.className = \"noAltTextBadge\";\n      this.#editor.div.append(badge);\n    }\n    this.#badge.classList.toggle(\"hidden\", !visibility);\n  }\n  serialize(isForCopying) {\n    let altText = this.#altText;\n    if (!isForCopying && this.#guessedText === altText) {\n      altText = this.#textWithDisclaimer;\n    }\n    return {\n      altText,\n      decorative: this.#altTextDecorative,\n      guessedText: this.#guessedText,\n      textWithDisclaimer: this.#textWithDisclaimer\n    };\n  }\n  get data() {\n    return {\n      altText: this.#altText,\n      decorative: this.#altTextDecorative\n    };\n  }\n  set data({\n    altText,\n    decorative,\n    guessedText,\n    textWithDisclaimer,\n    cancel = false\n  }) {\n    if (guessedText) {\n      this.#guessedText = guessedText;\n      this.#textWithDisclaimer = textWithDisclaimer;\n    }\n    if (this.#altText === altText && this.#altTextDecorative === decorative) {\n      return;\n    }\n    if (!cancel) {\n      this.#altText = altText;\n      this.#altTextDecorative = decorative;\n    }\n    this.#setState();\n  }\n  toggle(enabled = false) {\n    if (!this.#altTextButton) {\n      return;\n    }\n    if (!enabled && this.#altTextTooltipTimeout) {\n      clearTimeout(this.#altTextTooltipTimeout);\n      this.#altTextTooltipTimeout = null;\n    }\n    this.#altTextButton.disabled = !enabled;\n  }\n  shown() {\n    this.#editor._reportTelemetry({\n      action: \"pdfjs.image.alt_text.image_status_label_displayed\",\n      data: {\n        label: this.#label\n      }\n    });\n  }\n  destroy() {\n    this.#altTextButton?.remove();\n    this.#altTextButton = null;\n    this.#altTextTooltip = null;\n    this.#badge?.remove();\n    this.#badge = null;\n  }\n  async #setState() {\n    const button = this.#altTextButton;\n    if (!button) {\n      return;\n    }\n    if (this.#useNewAltTextFlow) {\n      const label = this.#label;\n      const type = label === \"review\" ? \"to-review\" : label;\n      button.classList.toggle(\"done\", !!this.#altText);\n      AltText._l10nPromise.get(`pdfjs-editor-new-alt-text-${type}-button-label`).then(msg => {\n        button.setAttribute(\"aria-label\", msg);\n        for (const child of button.childNodes) {\n          if (child.nodeType === Node.TEXT_NODE) {\n            child.textContent = msg;\n            break;\n          }\n        }\n      });\n      if (!this.#altText) {\n        this.#altTextTooltip?.remove();\n        return;\n      }\n    } else {\n      if (!this.#altText && !this.#altTextDecorative) {\n        button.classList.remove(\"done\");\n        this.#altTextTooltip?.remove();\n        return;\n      }\n      button.classList.add(\"done\");\n      AltText._l10nPromise.get(\"pdfjs-editor-alt-text-edit-button-label\").then(msg => {\n        button.setAttribute(\"aria-label\", msg);\n      });\n    }\n    let tooltip = this.#altTextTooltip;\n    if (!tooltip) {\n      this.#altTextTooltip = tooltip = document.createElement(\"span\");\n      tooltip.className = \"tooltip\";\n      tooltip.setAttribute(\"role\", \"tooltip\");\n      const id = tooltip.id = `alt-text-tooltip-${this.#editor.id}`;\n      button.setAttribute(\"aria-describedby\", id);\n      const DELAY_TO_SHOW_TOOLTIP = 100;\n      const signal = this.#editor._uiManager._signal;\n      signal.addEventListener(\"abort\", () => {\n        clearTimeout(this.#altTextTooltipTimeout);\n        this.#altTextTooltipTimeout = null;\n      }, {\n        once: true\n      });\n      button.addEventListener(\"mouseenter\", () => {\n        this.#altTextTooltipTimeout = setTimeout(() => {\n          this.#altTextTooltipTimeout = null;\n          this.#altTextTooltip.classList.add(\"show\");\n          this.#editor._reportTelemetry({\n            action: \"alt_text_tooltip\"\n          });\n        }, DELAY_TO_SHOW_TOOLTIP);\n      }, {\n        signal\n      });\n      button.addEventListener(\"mouseleave\", () => {\n        if (this.#altTextTooltipTimeout) {\n          clearTimeout(this.#altTextTooltipTimeout);\n          this.#altTextTooltipTimeout = null;\n        }\n        this.#altTextTooltip?.classList.remove(\"show\");\n      }, {\n        signal\n      });\n    }\n    tooltip.innerText = this.#altTextDecorative ? await AltText._l10nPromise.get(\"pdfjs-editor-alt-text-decorative-tooltip\") : this.#altText;\n    if (!tooltip.parentNode) {\n      button.append(tooltip);\n    }\n    const element = this.#editor.getImageForAltText();\n    element?.setAttribute(\"aria-describedby\", tooltip.id);\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/editor.js\n\n\n\n\n\nclass AnnotationEditor {\n  #accessibilityData = null;\n  #allResizerDivs = null;\n  #altText = null;\n  #disabled = false;\n  #keepAspectRatio = false;\n  #resizersDiv = null;\n  #savedDimensions = null;\n  #focusAC = null;\n  #focusedResizerName = \"\";\n  #hasBeenClicked = false;\n  #initialPosition = null;\n  #isEditing = false;\n  #isInEditMode = false;\n  #isResizerEnabledForKeyboard = false;\n  #moveInDOMTimeout = null;\n  #prevDragX = 0;\n  #prevDragY = 0;\n  #telemetryTimeouts = null;\n  _editToolbar = null;\n  _initialOptions = Object.create(null);\n  _isVisible = true;\n  _uiManager = null;\n  _focusEventsAllowed = true;\n  static _l10nPromise = null;\n  static _l10nResizer = null;\n  #isDraggable = false;\n  #zIndex = AnnotationEditor._zIndex++;\n  static _borderLineWidth = -1;\n  static _colorManager = new ColorManager();\n  static _zIndex = 1;\n  static _telemetryTimeout = 1000;\n  static get _resizerKeyboardManager() {\n    const resize = AnnotationEditor.prototype._resizeWithKeyboard;\n    const small = AnnotationEditorUIManager.TRANSLATE_SMALL;\n    const big = AnnotationEditorUIManager.TRANSLATE_BIG;\n    return shadow(this, \"_resizerKeyboardManager\", new KeyboardManager([[[\"ArrowLeft\", \"mac+ArrowLeft\"], resize, {\n      args: [-small, 0]\n    }], [[\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"], resize, {\n      args: [-big, 0]\n    }], [[\"ArrowRight\", \"mac+ArrowRight\"], resize, {\n      args: [small, 0]\n    }], [[\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"], resize, {\n      args: [big, 0]\n    }], [[\"ArrowUp\", \"mac+ArrowUp\"], resize, {\n      args: [0, -small]\n    }], [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], resize, {\n      args: [0, -big]\n    }], [[\"ArrowDown\", \"mac+ArrowDown\"], resize, {\n      args: [0, small]\n    }], [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], resize, {\n      args: [0, big]\n    }], [[\"Escape\", \"mac+Escape\"], AnnotationEditor.prototype._stopResizingWithKeyboard]]));\n  }\n  constructor(parameters) {\n    this.parent = parameters.parent;\n    this.id = parameters.id;\n    this.width = this.height = null;\n    this.pageIndex = parameters.parent.pageIndex;\n    this.name = parameters.name;\n    this.div = null;\n    this._uiManager = parameters.uiManager;\n    this.annotationElementId = null;\n    this._willKeepAspectRatio = false;\n    this._initialOptions.isCentered = parameters.isCentered;\n    this._structTreeParentId = null;\n    const {\n      rotation,\n      rawDims: {\n        pageWidth,\n        pageHeight,\n        pageX,\n        pageY\n      }\n    } = this.parent.viewport;\n    this.rotation = rotation;\n    this.pageRotation = (360 + rotation - this._uiManager.viewParameters.rotation) % 360;\n    this.pageDimensions = [pageWidth, pageHeight];\n    this.pageTranslation = [pageX, pageY];\n    const [width, height] = this.parentDimensions;\n    this.x = parameters.x / width;\n    this.y = parameters.y / height;\n    this.isAttachedToDOM = false;\n    this.deleted = false;\n  }\n  get editorType() {\n    return Object.getPrototypeOf(this).constructor._type;\n  }\n  static get _defaultLineColor() {\n    return shadow(this, \"_defaultLineColor\", this._colorManager.getHexCode(\"CanvasText\"));\n  }\n  static deleteAnnotationElement(editor) {\n    const fakeEditor = new FakeEditor({\n      id: editor.parent.getNextId(),\n      parent: editor.parent,\n      uiManager: editor._uiManager\n    });\n    fakeEditor.annotationElementId = editor.annotationElementId;\n    fakeEditor.deleted = true;\n    fakeEditor._uiManager.addToAnnotationStorage(fakeEditor);\n  }\n  static initialize(l10n, _uiManager, options) {\n    AnnotationEditor._l10nResizer ||= Object.freeze({\n      topLeft: \"pdfjs-editor-resizer-top-left\",\n      topMiddle: \"pdfjs-editor-resizer-top-middle\",\n      topRight: \"pdfjs-editor-resizer-top-right\",\n      middleRight: \"pdfjs-editor-resizer-middle-right\",\n      bottomRight: \"pdfjs-editor-resizer-bottom-right\",\n      bottomMiddle: \"pdfjs-editor-resizer-bottom-middle\",\n      bottomLeft: \"pdfjs-editor-resizer-bottom-left\",\n      middleLeft: \"pdfjs-editor-resizer-middle-left\"\n    });\n    AnnotationEditor._l10nPromise ||= new Map([...[\"pdfjs-editor-alt-text-button-label\", \"pdfjs-editor-alt-text-edit-button-label\", \"pdfjs-editor-alt-text-decorative-tooltip\", \"pdfjs-editor-new-alt-text-added-button-label\", \"pdfjs-editor-new-alt-text-missing-button-label\", \"pdfjs-editor-new-alt-text-to-review-button-label\"].map(str => [str, l10n.get(str)]), ...[\"pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer\"].map(str => [str, l10n.get.bind(l10n, str)])]);\n    if (options?.strings) {\n      for (const str of options.strings) {\n        AnnotationEditor._l10nPromise.set(str, l10n.get(str));\n      }\n    }\n    if (AnnotationEditor._borderLineWidth !== -1) {\n      return;\n    }\n    const style = getComputedStyle(document.documentElement);\n    AnnotationEditor._borderLineWidth = parseFloat(style.getPropertyValue(\"--outline-width\")) || 0;\n  }\n  static updateDefaultParams(_type, _value) {}\n  static get defaultPropertiesToUpdate() {\n    return [];\n  }\n  static isHandlingMimeForPasting(mime) {\n    return false;\n  }\n  static paste(item, parent) {\n    unreachable(\"Not implemented\");\n  }\n  get propertiesToUpdate() {\n    return [];\n  }\n  get _isDraggable() {\n    return this.#isDraggable;\n  }\n  set _isDraggable(value) {\n    this.#isDraggable = value;\n    this.div?.classList.toggle(\"draggable\", value);\n  }\n  get isEnterHandled() {\n    return true;\n  }\n  center() {\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    switch (this.parentRotation) {\n      case 90:\n        this.x -= this.height * pageHeight / (pageWidth * 2);\n        this.y += this.width * pageWidth / (pageHeight * 2);\n        break;\n      case 180:\n        this.x += this.width / 2;\n        this.y += this.height / 2;\n        break;\n      case 270:\n        this.x += this.height * pageHeight / (pageWidth * 2);\n        this.y -= this.width * pageWidth / (pageHeight * 2);\n        break;\n      default:\n        this.x -= this.width / 2;\n        this.y -= this.height / 2;\n        break;\n    }\n    this.fixAndSetPosition();\n  }\n  addCommands(params) {\n    this._uiManager.addCommands(params);\n  }\n  get currentLayer() {\n    return this._uiManager.currentLayer;\n  }\n  setInBackground() {\n    this.div.style.zIndex = 0;\n  }\n  setInForeground() {\n    this.div.style.zIndex = this.#zIndex;\n  }\n  setParent(parent) {\n    if (parent !== null) {\n      this.pageIndex = parent.pageIndex;\n      this.pageDimensions = parent.pageDimensions;\n    } else {\n      this.#stopResizing();\n    }\n    this.parent = parent;\n  }\n  focusin(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n    if (!this.#hasBeenClicked) {\n      this.parent.setSelected(this);\n    } else {\n      this.#hasBeenClicked = false;\n    }\n  }\n  focusout(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n    if (!this.isAttachedToDOM) {\n      return;\n    }\n    const target = event.relatedTarget;\n    if (target?.closest(`#${this.id}`)) {\n      return;\n    }\n    event.preventDefault();\n    if (!this.parent?.isMultipleSelection) {\n      this.commitOrRemove();\n    }\n  }\n  commitOrRemove() {\n    if (this.isEmpty()) {\n      this.remove();\n    } else {\n      this.commit();\n    }\n  }\n  commit() {\n    this.addToAnnotationStorage();\n  }\n  addToAnnotationStorage() {\n    this._uiManager.addToAnnotationStorage(this);\n  }\n  setAt(x, y, tx, ty) {\n    const [width, height] = this.parentDimensions;\n    [tx, ty] = this.screenToPageTranslation(tx, ty);\n    this.x = (x + tx) / width;\n    this.y = (y + ty) / height;\n    this.fixAndSetPosition();\n  }\n  #translate([width, height], x, y) {\n    [x, y] = this.screenToPageTranslation(x, y);\n    this.x += x / width;\n    this.y += y / height;\n    this.fixAndSetPosition();\n  }\n  translate(x, y) {\n    this.#translate(this.parentDimensions, x, y);\n  }\n  translateInPage(x, y) {\n    this.#initialPosition ||= [this.x, this.y];\n    this.#translate(this.pageDimensions, x, y);\n    this.div.scrollIntoView({\n      block: \"nearest\"\n    });\n  }\n  drag(tx, ty) {\n    this.#initialPosition ||= [this.x, this.y];\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.x += tx / parentWidth;\n    this.y += ty / parentHeight;\n    if (this.parent && (this.x < 0 || this.x > 1 || this.y < 0 || this.y > 1)) {\n      const {\n        x,\n        y\n      } = this.div.getBoundingClientRect();\n      if (this.parent.findNewParent(this, x, y)) {\n        this.x -= Math.floor(this.x);\n        this.y -= Math.floor(this.y);\n      }\n    }\n    let {\n      x,\n      y\n    } = this;\n    const [bx, by] = this.getBaseTranslation();\n    x += bx;\n    y += by;\n    this.div.style.left = `${(100 * x).toFixed(2)}%`;\n    this.div.style.top = `${(100 * y).toFixed(2)}%`;\n    this.div.scrollIntoView({\n      block: \"nearest\"\n    });\n  }\n  get _hasBeenMoved() {\n    return !!this.#initialPosition && (this.#initialPosition[0] !== this.x || this.#initialPosition[1] !== this.y);\n  }\n  getBaseTranslation() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const {\n      _borderLineWidth\n    } = AnnotationEditor;\n    const x = _borderLineWidth / parentWidth;\n    const y = _borderLineWidth / parentHeight;\n    switch (this.rotation) {\n      case 90:\n        return [-x, y];\n      case 180:\n        return [x, y];\n      case 270:\n        return [x, -y];\n      default:\n        return [-x, -y];\n    }\n  }\n  get _mustFixPosition() {\n    return true;\n  }\n  fixAndSetPosition(rotation = this.rotation) {\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    let {\n      x,\n      y,\n      width,\n      height\n    } = this;\n    width *= pageWidth;\n    height *= pageHeight;\n    x *= pageWidth;\n    y *= pageHeight;\n    if (this._mustFixPosition) {\n      switch (rotation) {\n        case 0:\n          x = Math.max(0, Math.min(pageWidth - width, x));\n          y = Math.max(0, Math.min(pageHeight - height, y));\n          break;\n        case 90:\n          x = Math.max(0, Math.min(pageWidth - height, x));\n          y = Math.min(pageHeight, Math.max(width, y));\n          break;\n        case 180:\n          x = Math.min(pageWidth, Math.max(width, x));\n          y = Math.min(pageHeight, Math.max(height, y));\n          break;\n        case 270:\n          x = Math.min(pageWidth, Math.max(height, x));\n          y = Math.max(0, Math.min(pageHeight - width, y));\n          break;\n      }\n    }\n    this.x = x /= pageWidth;\n    this.y = y /= pageHeight;\n    const [bx, by] = this.getBaseTranslation();\n    x += bx;\n    y += by;\n    const {\n      style\n    } = this.div;\n    style.left = `${(100 * x).toFixed(2)}%`;\n    style.top = `${(100 * y).toFixed(2)}%`;\n    this.moveInDOM();\n  }\n  static #rotatePoint(x, y, angle) {\n    switch (angle) {\n      case 90:\n        return [y, -x];\n      case 180:\n        return [-x, -y];\n      case 270:\n        return [-y, x];\n      default:\n        return [x, y];\n    }\n  }\n  screenToPageTranslation(x, y) {\n    return AnnotationEditor.#rotatePoint(x, y, this.parentRotation);\n  }\n  pageTranslationToScreen(x, y) {\n    return AnnotationEditor.#rotatePoint(x, y, 360 - this.parentRotation);\n  }\n  #getRotationMatrix(rotation) {\n    switch (rotation) {\n      case 90:\n        {\n          const [pageWidth, pageHeight] = this.pageDimensions;\n          return [0, -pageWidth / pageHeight, pageHeight / pageWidth, 0];\n        }\n      case 180:\n        return [-1, 0, 0, -1];\n      case 270:\n        {\n          const [pageWidth, pageHeight] = this.pageDimensions;\n          return [0, pageWidth / pageHeight, -pageHeight / pageWidth, 0];\n        }\n      default:\n        return [1, 0, 0, 1];\n    }\n  }\n  get parentScale() {\n    return this._uiManager.viewParameters.realScale;\n  }\n  get parentRotation() {\n    return (this._uiManager.viewParameters.rotation + this.pageRotation) % 360;\n  }\n  get parentDimensions() {\n    const {\n      parentScale,\n      pageDimensions: [pageWidth, pageHeight]\n    } = this;\n    const scaledWidth = pageWidth * parentScale;\n    const scaledHeight = pageHeight * parentScale;\n    return util_FeatureTest.isCSSRoundSupported ? [Math.round(scaledWidth), Math.round(scaledHeight)] : [scaledWidth, scaledHeight];\n  }\n  setDims(width, height) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.div.style.width = `${(100 * width / parentWidth).toFixed(2)}%`;\n    if (!this.#keepAspectRatio) {\n      this.div.style.height = `${(100 * height / parentHeight).toFixed(2)}%`;\n    }\n  }\n  fixDims() {\n    const {\n      style\n    } = this.div;\n    const {\n      height,\n      width\n    } = style;\n    const widthPercent = width.endsWith(\"%\");\n    const heightPercent = !this.#keepAspectRatio && height.endsWith(\"%\");\n    if (widthPercent && heightPercent) {\n      return;\n    }\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    if (!widthPercent) {\n      style.width = `${(100 * parseFloat(width) / parentWidth).toFixed(2)}%`;\n    }\n    if (!this.#keepAspectRatio && !heightPercent) {\n      style.height = `${(100 * parseFloat(height) / parentHeight).toFixed(2)}%`;\n    }\n  }\n  getInitialTranslation() {\n    return [0, 0];\n  }\n  #createResizers() {\n    if (this.#resizersDiv) {\n      return;\n    }\n    this.#resizersDiv = document.createElement(\"div\");\n    this.#resizersDiv.classList.add(\"resizers\");\n    const classes = this._willKeepAspectRatio ? [\"topLeft\", \"topRight\", \"bottomRight\", \"bottomLeft\"] : [\"topLeft\", \"topMiddle\", \"topRight\", \"middleRight\", \"bottomRight\", \"bottomMiddle\", \"bottomLeft\", \"middleLeft\"];\n    const signal = this._uiManager._signal;\n    for (const name of classes) {\n      const div = document.createElement(\"div\");\n      this.#resizersDiv.append(div);\n      div.classList.add(\"resizer\", name);\n      div.setAttribute(\"data-resizer-name\", name);\n      div.addEventListener(\"pointerdown\", this.#resizerPointerdown.bind(this, name), {\n        signal\n      });\n      div.addEventListener(\"contextmenu\", noContextMenu, {\n        signal\n      });\n      div.tabIndex = -1;\n    }\n    this.div.prepend(this.#resizersDiv);\n  }\n  #resizerPointerdown(name, event) {\n    event.preventDefault();\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n    if (event.button !== 0 || event.ctrlKey && isMac) {\n      return;\n    }\n    this.#altText?.toggle(false);\n    const savedDraggable = this._isDraggable;\n    this._isDraggable = false;\n    const ac = new AbortController();\n    const signal = this._uiManager.combinedSignal(ac);\n    this.parent.togglePointerEvents(false);\n    window.addEventListener(\"pointermove\", this.#resizerPointermove.bind(this, name), {\n      passive: true,\n      capture: true,\n      signal\n    });\n    window.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    const savedX = this.x;\n    const savedY = this.y;\n    const savedWidth = this.width;\n    const savedHeight = this.height;\n    const savedParentCursor = this.parent.div.style.cursor;\n    const savedCursor = this.div.style.cursor;\n    this.div.style.cursor = this.parent.div.style.cursor = window.getComputedStyle(event.target).cursor;\n    const pointerUpCallback = () => {\n      ac.abort();\n      this.parent.togglePointerEvents(true);\n      this.#altText?.toggle(true);\n      this._isDraggable = savedDraggable;\n      this.parent.div.style.cursor = savedParentCursor;\n      this.div.style.cursor = savedCursor;\n      this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n    };\n    window.addEventListener(\"pointerup\", pointerUpCallback, {\n      signal\n    });\n    window.addEventListener(\"blur\", pointerUpCallback, {\n      signal\n    });\n  }\n  #addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight) {\n    const newX = this.x;\n    const newY = this.y;\n    const newWidth = this.width;\n    const newHeight = this.height;\n    if (newX === savedX && newY === savedY && newWidth === savedWidth && newHeight === savedHeight) {\n      return;\n    }\n    this.addCommands({\n      cmd: () => {\n        this.width = newWidth;\n        this.height = newHeight;\n        this.x = newX;\n        this.y = newY;\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n        this.fixAndSetPosition();\n      },\n      undo: () => {\n        this.width = savedWidth;\n        this.height = savedHeight;\n        this.x = savedX;\n        this.y = savedY;\n        const [parentWidth, parentHeight] = this.parentDimensions;\n        this.setDims(parentWidth * savedWidth, parentHeight * savedHeight);\n        this.fixAndSetPosition();\n      },\n      mustExec: true\n    });\n  }\n  #resizerPointermove(name, event) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const savedX = this.x;\n    const savedY = this.y;\n    const savedWidth = this.width;\n    const savedHeight = this.height;\n    const minWidth = AnnotationEditor.MIN_SIZE / parentWidth;\n    const minHeight = AnnotationEditor.MIN_SIZE / parentHeight;\n    const round = x => Math.round(x * 10000) / 10000;\n    const rotationMatrix = this.#getRotationMatrix(this.rotation);\n    const transf = (x, y) => [rotationMatrix[0] * x + rotationMatrix[2] * y, rotationMatrix[1] * x + rotationMatrix[3] * y];\n    const invRotationMatrix = this.#getRotationMatrix(360 - this.rotation);\n    const invTransf = (x, y) => [invRotationMatrix[0] * x + invRotationMatrix[2] * y, invRotationMatrix[1] * x + invRotationMatrix[3] * y];\n    let getPoint;\n    let getOpposite;\n    let isDiagonal = false;\n    let isHorizontal = false;\n    switch (name) {\n      case \"topLeft\":\n        isDiagonal = true;\n        getPoint = (w, h) => [0, 0];\n        getOpposite = (w, h) => [w, h];\n        break;\n      case \"topMiddle\":\n        getPoint = (w, h) => [w / 2, 0];\n        getOpposite = (w, h) => [w / 2, h];\n        break;\n      case \"topRight\":\n        isDiagonal = true;\n        getPoint = (w, h) => [w, 0];\n        getOpposite = (w, h) => [0, h];\n        break;\n      case \"middleRight\":\n        isHorizontal = true;\n        getPoint = (w, h) => [w, h / 2];\n        getOpposite = (w, h) => [0, h / 2];\n        break;\n      case \"bottomRight\":\n        isDiagonal = true;\n        getPoint = (w, h) => [w, h];\n        getOpposite = (w, h) => [0, 0];\n        break;\n      case \"bottomMiddle\":\n        getPoint = (w, h) => [w / 2, h];\n        getOpposite = (w, h) => [w / 2, 0];\n        break;\n      case \"bottomLeft\":\n        isDiagonal = true;\n        getPoint = (w, h) => [0, h];\n        getOpposite = (w, h) => [w, 0];\n        break;\n      case \"middleLeft\":\n        isHorizontal = true;\n        getPoint = (w, h) => [0, h / 2];\n        getOpposite = (w, h) => [w, h / 2];\n        break;\n    }\n    const point = getPoint(savedWidth, savedHeight);\n    const oppositePoint = getOpposite(savedWidth, savedHeight);\n    let transfOppositePoint = transf(...oppositePoint);\n    const oppositeX = round(savedX + transfOppositePoint[0]);\n    const oppositeY = round(savedY + transfOppositePoint[1]);\n    let ratioX = 1;\n    let ratioY = 1;\n    let [deltaX, deltaY] = this.screenToPageTranslation(event.movementX, event.movementY);\n    [deltaX, deltaY] = invTransf(deltaX / parentWidth, deltaY / parentHeight);\n    if (isDiagonal) {\n      const oldDiag = Math.hypot(savedWidth, savedHeight);\n      ratioX = ratioY = Math.max(Math.min(Math.hypot(oppositePoint[0] - point[0] - deltaX, oppositePoint[1] - point[1] - deltaY) / oldDiag, 1 / savedWidth, 1 / savedHeight), minWidth / savedWidth, minHeight / savedHeight);\n    } else if (isHorizontal) {\n      ratioX = Math.max(minWidth, Math.min(1, Math.abs(oppositePoint[0] - point[0] - deltaX))) / savedWidth;\n    } else {\n      ratioY = Math.max(minHeight, Math.min(1, Math.abs(oppositePoint[1] - point[1] - deltaY))) / savedHeight;\n    }\n    const newWidth = round(savedWidth * ratioX);\n    const newHeight = round(savedHeight * ratioY);\n    transfOppositePoint = transf(...getOpposite(newWidth, newHeight));\n    const newX = oppositeX - transfOppositePoint[0];\n    const newY = oppositeY - transfOppositePoint[1];\n    this.width = newWidth;\n    this.height = newHeight;\n    this.x = newX;\n    this.y = newY;\n    this.setDims(parentWidth * newWidth, parentHeight * newHeight);\n    this.fixAndSetPosition();\n  }\n  altTextFinish() {\n    this.#altText?.finish();\n  }\n  async addEditToolbar() {\n    if (this._editToolbar || this.#isInEditMode) {\n      return this._editToolbar;\n    }\n    this._editToolbar = new EditorToolbar(this);\n    this.div.append(this._editToolbar.render());\n    if (this.#altText) {\n      await this._editToolbar.addAltText(this.#altText);\n    }\n    return this._editToolbar;\n  }\n  removeEditToolbar() {\n    if (!this._editToolbar) {\n      return;\n    }\n    this._editToolbar.remove();\n    this._editToolbar = null;\n    this.#altText?.destroy();\n  }\n  getClientDimensions() {\n    return this.div.getBoundingClientRect();\n  }\n  async addAltTextButton() {\n    if (this.#altText) {\n      return;\n    }\n    AltText.initialize(AnnotationEditor._l10nPromise);\n    this.#altText = new AltText(this);\n    if (this.#accessibilityData) {\n      this.#altText.data = this.#accessibilityData;\n      this.#accessibilityData = null;\n    }\n    await this.addEditToolbar();\n  }\n  get altTextData() {\n    return this.#altText?.data;\n  }\n  set altTextData(data) {\n    if (!this.#altText) {\n      return;\n    }\n    this.#altText.data = data;\n  }\n  get guessedAltText() {\n    return this.#altText?.guessedText;\n  }\n  async setGuessedAltText(text) {\n    await this.#altText?.setGuessedText(text);\n  }\n  serializeAltText(isForCopying) {\n    return this.#altText?.serialize(isForCopying);\n  }\n  hasAltText() {\n    return !!this.#altText && !this.#altText.isEmpty();\n  }\n  hasAltTextData() {\n    return this.#altText?.hasData() ?? false;\n  }\n  render() {\n    this.div = document.createElement(\"div\");\n    this.div.setAttribute(\"data-editor-rotation\", (360 - this.rotation) % 360);\n    this.div.className = this.name;\n    this.div.setAttribute(\"id\", this.id);\n    this.div.tabIndex = this.#disabled ? -1 : 0;\n    if (!this._isVisible) {\n      this.div.classList.add(\"hidden\");\n    }\n    this.setInForeground();\n    this.#addFocusListeners();\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    if (this.parentRotation % 180 !== 0) {\n      this.div.style.maxWidth = `${(100 * parentHeight / parentWidth).toFixed(2)}%`;\n      this.div.style.maxHeight = `${(100 * parentWidth / parentHeight).toFixed(2)}%`;\n    }\n    const [tx, ty] = this.getInitialTranslation();\n    this.translate(tx, ty);\n    bindEvents(this, this.div, [\"pointerdown\"]);\n    return this.div;\n  }\n  pointerdown(event) {\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n    if (event.button !== 0 || event.ctrlKey && isMac) {\n      event.preventDefault();\n      return;\n    }\n    this.#hasBeenClicked = true;\n    if (this._isDraggable) {\n      this.#setUpDragSession(event);\n      return;\n    }\n    this.#selectOnPointerEvent(event);\n  }\n  #selectOnPointerEvent(event) {\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n    if (event.ctrlKey && !isMac || event.shiftKey || event.metaKey && isMac) {\n      this.parent.toggleSelected(this);\n    } else {\n      this.parent.setSelected(this);\n    }\n  }\n  #setUpDragSession(event) {\n    const isSelected = this._uiManager.isSelected(this);\n    this._uiManager.setUpDragSession();\n    const ac = new AbortController();\n    const signal = this._uiManager.combinedSignal(ac);\n    if (isSelected) {\n      this.div.classList.add(\"moving\");\n      this.#prevDragX = event.clientX;\n      this.#prevDragY = event.clientY;\n      const pointerMoveCallback = e => {\n        const {\n          clientX: x,\n          clientY: y\n        } = e;\n        const [tx, ty] = this.screenToPageTranslation(x - this.#prevDragX, y - this.#prevDragY);\n        this.#prevDragX = x;\n        this.#prevDragY = y;\n        this._uiManager.dragSelectedEditors(tx, ty);\n      };\n      window.addEventListener(\"pointermove\", pointerMoveCallback, {\n        passive: true,\n        capture: true,\n        signal\n      });\n    }\n    const pointerUpCallback = () => {\n      ac.abort();\n      if (isSelected) {\n        this.div.classList.remove(\"moving\");\n      }\n      this.#hasBeenClicked = false;\n      if (!this._uiManager.endDragSession()) {\n        this.#selectOnPointerEvent(event);\n      }\n    };\n    window.addEventListener(\"pointerup\", pointerUpCallback, {\n      signal\n    });\n    window.addEventListener(\"blur\", pointerUpCallback, {\n      signal\n    });\n  }\n  moveInDOM() {\n    if (this.#moveInDOMTimeout) {\n      clearTimeout(this.#moveInDOMTimeout);\n    }\n    this.#moveInDOMTimeout = setTimeout(() => {\n      this.#moveInDOMTimeout = null;\n      this.parent?.moveEditorInDOM(this);\n    }, 0);\n  }\n  _setParentAndPosition(parent, x, y) {\n    parent.changeParent(this);\n    this.x = x;\n    this.y = y;\n    this.fixAndSetPosition();\n  }\n  getRect(tx, ty, rotation = this.rotation) {\n    const scale = this.parentScale;\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    const [pageX, pageY] = this.pageTranslation;\n    const shiftX = tx / scale;\n    const shiftY = ty / scale;\n    const x = this.x * pageWidth;\n    const y = this.y * pageHeight;\n    const width = this.width * pageWidth;\n    const height = this.height * pageHeight;\n    switch (rotation) {\n      case 0:\n        return [x + shiftX + pageX, pageHeight - y - shiftY - height + pageY, x + shiftX + width + pageX, pageHeight - y - shiftY + pageY];\n      case 90:\n        return [x + shiftY + pageX, pageHeight - y + shiftX + pageY, x + shiftY + height + pageX, pageHeight - y + shiftX + width + pageY];\n      case 180:\n        return [x - shiftX - width + pageX, pageHeight - y + shiftY + pageY, x - shiftX + pageX, pageHeight - y + shiftY + height + pageY];\n      case 270:\n        return [x - shiftY - height + pageX, pageHeight - y - shiftX - width + pageY, x - shiftY + pageX, pageHeight - y - shiftX + pageY];\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n  }\n  getRectInCurrentCoords(rect, pageHeight) {\n    const [x1, y1, x2, y2] = rect;\n    const width = x2 - x1;\n    const height = y2 - y1;\n    switch (this.rotation) {\n      case 0:\n        return [x1, pageHeight - y2, width, height];\n      case 90:\n        return [x1, pageHeight - y1, height, width];\n      case 180:\n        return [x2, pageHeight - y1, width, height];\n      case 270:\n        return [x2, pageHeight - y2, height, width];\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n  }\n  onceAdded() {}\n  isEmpty() {\n    return false;\n  }\n  enableEditMode() {\n    this.#isInEditMode = true;\n  }\n  disableEditMode() {\n    this.#isInEditMode = false;\n  }\n  isInEditMode() {\n    return this.#isInEditMode;\n  }\n  shouldGetKeyboardEvents() {\n    return this.#isResizerEnabledForKeyboard;\n  }\n  needsToBeRebuilt() {\n    return this.div && !this.isAttachedToDOM;\n  }\n  #addFocusListeners() {\n    if (this.#focusAC || !this.div) {\n      return;\n    }\n    this.#focusAC = new AbortController();\n    const signal = this._uiManager.combinedSignal(this.#focusAC);\n    this.div.addEventListener(\"focusin\", this.focusin.bind(this), {\n      signal\n    });\n    this.div.addEventListener(\"focusout\", this.focusout.bind(this), {\n      signal\n    });\n  }\n  rebuild() {\n    this.#addFocusListeners();\n  }\n  rotate(_angle) {}\n  serialize(isForCopying = false, context = null) {\n    unreachable(\"An editor must be serializable\");\n  }\n  static deserialize(data, parent, uiManager) {\n    const editor = new this.prototype.constructor({\n      parent,\n      id: parent.getNextId(),\n      uiManager\n    });\n    editor.rotation = data.rotation;\n    editor.#accessibilityData = data.accessibilityData;\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    const [x, y, width, height] = editor.getRectInCurrentCoords(data.rect, pageHeight);\n    editor.x = x / pageWidth;\n    editor.y = y / pageHeight;\n    editor.width = width / pageWidth;\n    editor.height = height / pageHeight;\n    return editor;\n  }\n  get hasBeenModified() {\n    return !!this.annotationElementId && (this.deleted || this.serialize() !== null);\n  }\n  remove() {\n    this.#focusAC?.abort();\n    this.#focusAC = null;\n    if (!this.isEmpty()) {\n      this.commit();\n    }\n    if (this.parent) {\n      this.parent.remove(this);\n    } else {\n      this._uiManager.removeEditor(this);\n    }\n    if (this.#moveInDOMTimeout) {\n      clearTimeout(this.#moveInDOMTimeout);\n      this.#moveInDOMTimeout = null;\n    }\n    this.#stopResizing();\n    this.removeEditToolbar();\n    if (this.#telemetryTimeouts) {\n      for (const timeout of this.#telemetryTimeouts.values()) {\n        clearTimeout(timeout);\n      }\n      this.#telemetryTimeouts = null;\n    }\n    this.parent = null;\n  }\n  get isResizable() {\n    return false;\n  }\n  makeResizable() {\n    if (this.isResizable) {\n      this.#createResizers();\n      this.#resizersDiv.classList.remove(\"hidden\");\n      bindEvents(this, this.div, [\"keydown\"]);\n    }\n  }\n  get toolbarPosition() {\n    return null;\n  }\n  keydown(event) {\n    if (!this.isResizable || event.target !== this.div || event.key !== \"Enter\") {\n      return;\n    }\n    this._uiManager.setSelected(this);\n    this.#savedDimensions = {\n      savedX: this.x,\n      savedY: this.y,\n      savedWidth: this.width,\n      savedHeight: this.height\n    };\n    const children = this.#resizersDiv.children;\n    if (!this.#allResizerDivs) {\n      this.#allResizerDivs = Array.from(children);\n      const boundResizerKeydown = this.#resizerKeydown.bind(this);\n      const boundResizerBlur = this.#resizerBlur.bind(this);\n      const signal = this._uiManager._signal;\n      for (const div of this.#allResizerDivs) {\n        const name = div.getAttribute(\"data-resizer-name\");\n        div.setAttribute(\"role\", \"spinbutton\");\n        div.addEventListener(\"keydown\", boundResizerKeydown, {\n          signal\n        });\n        div.addEventListener(\"blur\", boundResizerBlur, {\n          signal\n        });\n        div.addEventListener(\"focus\", this.#resizerFocus.bind(this, name), {\n          signal\n        });\n        div.setAttribute(\"data-l10n-id\", AnnotationEditor._l10nResizer[name]);\n      }\n    }\n    const first = this.#allResizerDivs[0];\n    let firstPosition = 0;\n    for (const div of children) {\n      if (div === first) {\n        break;\n      }\n      firstPosition++;\n    }\n    const nextFirstPosition = (360 - this.rotation + this.parentRotation) % 360 / 90 * (this.#allResizerDivs.length / 4);\n    if (nextFirstPosition !== firstPosition) {\n      if (nextFirstPosition < firstPosition) {\n        for (let i = 0; i < firstPosition - nextFirstPosition; i++) {\n          this.#resizersDiv.append(this.#resizersDiv.firstChild);\n        }\n      } else if (nextFirstPosition > firstPosition) {\n        for (let i = 0; i < nextFirstPosition - firstPosition; i++) {\n          this.#resizersDiv.firstChild.before(this.#resizersDiv.lastChild);\n        }\n      }\n      let i = 0;\n      for (const child of children) {\n        const div = this.#allResizerDivs[i++];\n        const name = div.getAttribute(\"data-resizer-name\");\n        child.setAttribute(\"data-l10n-id\", AnnotationEditor._l10nResizer[name]);\n      }\n    }\n    this.#setResizerTabIndex(0);\n    this.#isResizerEnabledForKeyboard = true;\n    this.#resizersDiv.firstChild.focus({\n      focusVisible: true\n    });\n    event.preventDefault();\n    event.stopImmediatePropagation();\n  }\n  #resizerKeydown(event) {\n    AnnotationEditor._resizerKeyboardManager.exec(this, event);\n  }\n  #resizerBlur(event) {\n    if (this.#isResizerEnabledForKeyboard && event.relatedTarget?.parentNode !== this.#resizersDiv) {\n      this.#stopResizing();\n    }\n  }\n  #resizerFocus(name) {\n    this.#focusedResizerName = this.#isResizerEnabledForKeyboard ? name : \"\";\n  }\n  #setResizerTabIndex(value) {\n    if (!this.#allResizerDivs) {\n      return;\n    }\n    for (const div of this.#allResizerDivs) {\n      div.tabIndex = value;\n    }\n  }\n  _resizeWithKeyboard(x, y) {\n    if (!this.#isResizerEnabledForKeyboard) {\n      return;\n    }\n    this.#resizerPointermove(this.#focusedResizerName, {\n      movementX: x,\n      movementY: y\n    });\n  }\n  #stopResizing() {\n    this.#isResizerEnabledForKeyboard = false;\n    this.#setResizerTabIndex(-1);\n    if (this.#savedDimensions) {\n      const {\n        savedX,\n        savedY,\n        savedWidth,\n        savedHeight\n      } = this.#savedDimensions;\n      this.#addResizeToUndoStack(savedX, savedY, savedWidth, savedHeight);\n      this.#savedDimensions = null;\n    }\n  }\n  _stopResizingWithKeyboard() {\n    this.#stopResizing();\n    this.div.focus();\n  }\n  select() {\n    this.makeResizable();\n    this.div?.classList.add(\"selectedEditor\");\n    if (!this._editToolbar) {\n      this.addEditToolbar().then(() => {\n        if (this.div?.classList.contains(\"selectedEditor\")) {\n          this._editToolbar?.show();\n        }\n      });\n      return;\n    }\n    this._editToolbar?.show();\n    this.#altText?.toggleAltTextBadge(false);\n  }\n  unselect() {\n    this.#resizersDiv?.classList.add(\"hidden\");\n    this.div?.classList.remove(\"selectedEditor\");\n    if (this.div?.contains(document.activeElement)) {\n      this._uiManager.currentLayer.div.focus({\n        preventScroll: true\n      });\n    }\n    this._editToolbar?.hide();\n    this.#altText?.toggleAltTextBadge(true);\n  }\n  updateParams(type, value) {}\n  disableEditing() {}\n  enableEditing() {}\n  enterInEditMode() {}\n  getImageForAltText() {\n    return null;\n  }\n  get contentDiv() {\n    return this.div;\n  }\n  get isEditing() {\n    return this.#isEditing;\n  }\n  set isEditing(value) {\n    this.#isEditing = value;\n    if (!this.parent) {\n      return;\n    }\n    if (value) {\n      this.parent.setSelected(this);\n      this.parent.setActiveEditor(this);\n    } else {\n      this.parent.setActiveEditor(null);\n    }\n  }\n  setAspectRatio(width, height) {\n    this.#keepAspectRatio = true;\n    const aspectRatio = width / height;\n    const {\n      style\n    } = this.div;\n    style.aspectRatio = aspectRatio;\n    style.height = \"auto\";\n  }\n  static get MIN_SIZE() {\n    return 16;\n  }\n  static canCreateNewEmptyEditor() {\n    return true;\n  }\n  get telemetryInitialData() {\n    return {\n      action: \"added\"\n    };\n  }\n  get telemetryFinalData() {\n    return null;\n  }\n  _reportTelemetry(data, mustWait = false) {\n    if (mustWait) {\n      this.#telemetryTimeouts ||= new Map();\n      const {\n        action\n      } = data;\n      let timeout = this.#telemetryTimeouts.get(action);\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n      timeout = setTimeout(() => {\n        this._reportTelemetry(data);\n        this.#telemetryTimeouts.delete(action);\n        if (this.#telemetryTimeouts.size === 0) {\n          this.#telemetryTimeouts = null;\n        }\n      }, AnnotationEditor._telemetryTimeout);\n      this.#telemetryTimeouts.set(action, timeout);\n      return;\n    }\n    data.type ||= this.editorType;\n    this._uiManager._eventBus.dispatch(\"reporttelemetry\", {\n      source: this,\n      details: {\n        type: \"editing\",\n        data\n      }\n    });\n  }\n  show(visible = this._isVisible) {\n    this.div.classList.toggle(\"hidden\", !visible);\n    this._isVisible = visible;\n  }\n  enable() {\n    if (this.div) {\n      this.div.tabIndex = 0;\n    }\n    this.#disabled = false;\n  }\n  disable() {\n    if (this.div) {\n      this.div.tabIndex = -1;\n    }\n    this.#disabled = true;\n  }\n  renderAnnotationElement(annotation) {\n    let content = annotation.container.querySelector(\".annotationContent\");\n    if (!content) {\n      content = document.createElement(\"div\");\n      content.classList.add(\"annotationContent\", this.editorType);\n      annotation.container.prepend(content);\n    } else if (content.nodeName === \"CANVAS\") {\n      const canvas = content;\n      content = document.createElement(\"div\");\n      content.classList.add(\"annotationContent\", this.editorType);\n      canvas.before(content);\n    }\n    return content;\n  }\n  resetAnnotationElement(annotation) {\n    const {\n      firstChild\n    } = annotation.container;\n    if (firstChild.nodeName === \"DIV\" && firstChild.classList.contains(\"annotationContent\")) {\n      firstChild.remove();\n    }\n  }\n}\nclass FakeEditor extends AnnotationEditor {\n  constructor(params) {\n    super(params);\n    this.annotationElementId = params.annotationElementId;\n    this.deleted = true;\n  }\n  serialize() {\n    return {\n      id: this.annotationElementId,\n      deleted: true,\n      pageIndex: this.pageIndex\n    };\n  }\n}\n\n;// CONCATENATED MODULE: ./src/shared/murmurhash3.js\nconst SEED = 0xc3d2e1f0;\nconst MASK_HIGH = 0xffff0000;\nconst MASK_LOW = 0xffff;\nclass MurmurHash3_64 {\n  constructor(seed) {\n    this.h1 = seed ? seed & 0xffffffff : SEED;\n    this.h2 = seed ? seed & 0xffffffff : SEED;\n  }\n  update(input) {\n    let data, length;\n    if (typeof input === \"string\") {\n      data = new Uint8Array(input.length * 2);\n      length = 0;\n      for (let i = 0, ii = input.length; i < ii; i++) {\n        const code = input.charCodeAt(i);\n        if (code <= 0xff) {\n          data[length++] = code;\n        } else {\n          data[length++] = code >>> 8;\n          data[length++] = code & 0xff;\n        }\n      }\n    } else if (ArrayBuffer.isView(input)) {\n      data = input.slice();\n      length = data.byteLength;\n    } else {\n      throw new Error(\"Invalid data format, must be a string or TypedArray.\");\n    }\n    const blockCounts = length >> 2;\n    const tailLength = length - blockCounts * 4;\n    const dataUint32 = new Uint32Array(data.buffer, 0, blockCounts);\n    let k1 = 0,\n      k2 = 0;\n    let h1 = this.h1,\n      h2 = this.h2;\n    const C1 = 0xcc9e2d51,\n      C2 = 0x1b873593;\n    const C1_LOW = C1 & MASK_LOW,\n      C2_LOW = C2 & MASK_LOW;\n    for (let i = 0; i < blockCounts; i++) {\n      if (i & 1) {\n        k1 = dataUint32[i];\n        k1 = k1 * C1 & MASK_HIGH | k1 * C1_LOW & MASK_LOW;\n        k1 = k1 << 15 | k1 >>> 17;\n        k1 = k1 * C2 & MASK_HIGH | k1 * C2_LOW & MASK_LOW;\n        h1 ^= k1;\n        h1 = h1 << 13 | h1 >>> 19;\n        h1 = h1 * 5 + 0xe6546b64;\n      } else {\n        k2 = dataUint32[i];\n        k2 = k2 * C1 & MASK_HIGH | k2 * C1_LOW & MASK_LOW;\n        k2 = k2 << 15 | k2 >>> 17;\n        k2 = k2 * C2 & MASK_HIGH | k2 * C2_LOW & MASK_LOW;\n        h2 ^= k2;\n        h2 = h2 << 13 | h2 >>> 19;\n        h2 = h2 * 5 + 0xe6546b64;\n      }\n    }\n    k1 = 0;\n    switch (tailLength) {\n      case 3:\n        k1 ^= data[blockCounts * 4 + 2] << 16;\n      case 2:\n        k1 ^= data[blockCounts * 4 + 1] << 8;\n      case 1:\n        k1 ^= data[blockCounts * 4];\n        k1 = k1 * C1 & MASK_HIGH | k1 * C1_LOW & MASK_LOW;\n        k1 = k1 << 15 | k1 >>> 17;\n        k1 = k1 * C2 & MASK_HIGH | k1 * C2_LOW & MASK_LOW;\n        if (blockCounts & 1) {\n          h1 ^= k1;\n        } else {\n          h2 ^= k1;\n        }\n    }\n    this.h1 = h1;\n    this.h2 = h2;\n  }\n  hexdigest() {\n    let h1 = this.h1,\n      h2 = this.h2;\n    h1 ^= h2 >>> 1;\n    h1 = h1 * 0xed558ccd & MASK_HIGH | h1 * 0x8ccd & MASK_LOW;\n    h2 = h2 * 0xff51afd7 & MASK_HIGH | ((h2 << 16 | h1 >>> 16) * 0xafd7ed55 & MASK_HIGH) >>> 16;\n    h1 ^= h2 >>> 1;\n    h1 = h1 * 0x1a85ec53 & MASK_HIGH | h1 * 0xec53 & MASK_LOW;\n    h2 = h2 * 0xc4ceb9fe & MASK_HIGH | ((h2 << 16 | h1 >>> 16) * 0xb9fe1a85 & MASK_HIGH) >>> 16;\n    h1 ^= h2 >>> 1;\n    return (h1 >>> 0).toString(16).padStart(8, \"0\") + (h2 >>> 0).toString(16).padStart(8, \"0\");\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/annotation_storage.js\n\n\n\nconst SerializableEmpty = Object.freeze({\n  map: null,\n  hash: \"\",\n  transfer: undefined\n});\nclass AnnotationStorage {\n  #modified = false;\n  #modifiedIds = null;\n  #storage = new Map();\n  constructor() {\n    this.onSetModified = null;\n    this.onResetModified = null;\n    this.onAnnotationEditor = null;\n  }\n  getValue(key, defaultValue) {\n    const value = this.#storage.get(key);\n    if (value === undefined) {\n      return defaultValue;\n    }\n    return Object.assign(defaultValue, value);\n  }\n  getRawValue(key) {\n    return this.#storage.get(key);\n  }\n  remove(key) {\n    this.#storage.delete(key);\n    if (this.#storage.size === 0) {\n      this.resetModified();\n    }\n    if (typeof this.onAnnotationEditor === \"function\") {\n      for (const value of this.#storage.values()) {\n        if (value instanceof AnnotationEditor) {\n          return;\n        }\n      }\n      this.onAnnotationEditor(null);\n    }\n  }\n  setValue(key, value) {\n    const obj = this.#storage.get(key);\n    let modified = false;\n    if (obj !== undefined) {\n      for (const [entry, val] of Object.entries(value)) {\n        if (obj[entry] !== val) {\n          modified = true;\n          obj[entry] = val;\n        }\n      }\n    } else {\n      modified = true;\n      this.#storage.set(key, value);\n    }\n    if (modified) {\n      this.#setModified();\n    }\n    if (value instanceof AnnotationEditor && typeof this.onAnnotationEditor === \"function\") {\n      this.onAnnotationEditor(value.constructor._type);\n    }\n  }\n  has(key) {\n    return this.#storage.has(key);\n  }\n  getAll() {\n    return this.#storage.size > 0 ? objectFromMap(this.#storage) : null;\n  }\n  setAll(obj) {\n    for (const [key, val] of Object.entries(obj)) {\n      this.setValue(key, val);\n    }\n  }\n  get size() {\n    return this.#storage.size;\n  }\n  #setModified() {\n    if (!this.#modified) {\n      this.#modified = true;\n      if (typeof this.onSetModified === \"function\") {\n        this.onSetModified();\n      }\n    }\n  }\n  resetModified() {\n    if (this.#modified) {\n      this.#modified = false;\n      if (typeof this.onResetModified === \"function\") {\n        this.onResetModified();\n      }\n    }\n  }\n  get print() {\n    return new PrintAnnotationStorage(this);\n  }\n  get serializable() {\n    if (this.#storage.size === 0) {\n      return SerializableEmpty;\n    }\n    const map = new Map(),\n      hash = new MurmurHash3_64(),\n      transfer = [];\n    const context = Object.create(null);\n    let hasBitmap = false;\n    for (const [key, val] of this.#storage) {\n      const serialized = val instanceof AnnotationEditor ? val.serialize(false, context) : val;\n      if (serialized) {\n        map.set(key, serialized);\n        hash.update(`${key}:${JSON.stringify(serialized)}`);\n        hasBitmap ||= !!serialized.bitmap;\n      }\n    }\n    if (hasBitmap) {\n      for (const value of map.values()) {\n        if (value.bitmap) {\n          transfer.push(value.bitmap);\n        }\n      }\n    }\n    return map.size > 0 ? {\n      map,\n      hash: hash.hexdigest(),\n      transfer\n    } : SerializableEmpty;\n  }\n  get editorStats() {\n    let stats = null;\n    const typeToEditor = new Map();\n    for (const value of this.#storage.values()) {\n      if (!(value instanceof AnnotationEditor)) {\n        continue;\n      }\n      const editorStats = value.telemetryFinalData;\n      if (!editorStats) {\n        continue;\n      }\n      const {\n        type\n      } = editorStats;\n      if (!typeToEditor.has(type)) {\n        typeToEditor.set(type, Object.getPrototypeOf(value).constructor);\n      }\n      stats ||= Object.create(null);\n      const map = stats[type] ||= new Map();\n      for (const [key, val] of Object.entries(editorStats)) {\n        if (key === \"type\") {\n          continue;\n        }\n        let counters = map.get(key);\n        if (!counters) {\n          counters = new Map();\n          map.set(key, counters);\n        }\n        const count = counters.get(val) ?? 0;\n        counters.set(val, count + 1);\n      }\n    }\n    for (const [type, editor] of typeToEditor) {\n      stats[type] = editor.computeTelemetryFinalData(stats[type]);\n    }\n    return stats;\n  }\n  resetModifiedIds() {\n    this.#modifiedIds = null;\n  }\n  get modifiedIds() {\n    if (this.#modifiedIds) {\n      return this.#modifiedIds;\n    }\n    const ids = [];\n    for (const value of this.#storage.values()) {\n      if (!(value instanceof AnnotationEditor) || !value.annotationElementId || !value.serialize()) {\n        continue;\n      }\n      ids.push(value.annotationElementId);\n    }\n    return this.#modifiedIds = {\n      ids: new Set(ids),\n      hash: ids.join(\",\")\n    };\n  }\n}\nclass PrintAnnotationStorage extends AnnotationStorage {\n  #serializable;\n  constructor(parent) {\n    super();\n    const {\n      map,\n      hash,\n      transfer\n    } = parent.serializable;\n    const clone = structuredClone(map, transfer ? {\n      transfer\n    } : null);\n    this.#serializable = {\n      map: clone,\n      hash,\n      transfer\n    };\n  }\n  get print() {\n    unreachable(\"Should not call PrintAnnotationStorage.print\");\n  }\n  get serializable() {\n    return this.#serializable;\n  }\n  get modifiedIds() {\n    return shadow(this, \"modifiedIds\", {\n      ids: new Set(),\n      hash: \"\"\n    });\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/font_loader.js\n\nclass FontLoader {\n  #systemFonts = new Set();\n  constructor({\n    ownerDocument = globalThis.document,\n    styleElement = null\n  }) {\n    this._document = ownerDocument;\n    this.nativeFontFaces = new Set();\n    this.styleElement = null;\n    this.loadingRequests = [];\n    this.loadTestFontId = 0;\n  }\n  addNativeFontFace(nativeFontFace) {\n    this.nativeFontFaces.add(nativeFontFace);\n    this._document.fonts.add(nativeFontFace);\n  }\n  removeNativeFontFace(nativeFontFace) {\n    this.nativeFontFaces.delete(nativeFontFace);\n    this._document.fonts.delete(nativeFontFace);\n  }\n  insertRule(rule) {\n    if (!this.styleElement) {\n      this.styleElement = this._document.createElement(\"style\");\n      this._document.documentElement.getElementsByTagName(\"head\")[0].append(this.styleElement);\n    }\n    const styleSheet = this.styleElement.sheet;\n    styleSheet.insertRule(rule, styleSheet.cssRules.length);\n  }\n  clear() {\n    for (const nativeFontFace of this.nativeFontFaces) {\n      this._document.fonts.delete(nativeFontFace);\n    }\n    this.nativeFontFaces.clear();\n    this.#systemFonts.clear();\n    if (this.styleElement) {\n      this.styleElement.remove();\n      this.styleElement = null;\n    }\n  }\n  async loadSystemFont({\n    systemFontInfo: info,\n    _inspectFont\n  }) {\n    if (!info || this.#systemFonts.has(info.loadedName)) {\n      return;\n    }\n    assert(!this.disableFontFace, \"loadSystemFont shouldn't be called when `disableFontFace` is set.\");\n    if (this.isFontLoadingAPISupported) {\n      const {\n        loadedName,\n        src,\n        style\n      } = info;\n      const fontFace = new FontFace(loadedName, src, style);\n      this.addNativeFontFace(fontFace);\n      try {\n        await fontFace.load();\n        this.#systemFonts.add(loadedName);\n        _inspectFont?.(info);\n      } catch {\n        warn(`Cannot load system font: ${info.baseFontName}, installing it could help to improve PDF rendering.`);\n        this.removeNativeFontFace(fontFace);\n      }\n      return;\n    }\n    unreachable(\"Not implemented: loadSystemFont without the Font Loading API.\");\n  }\n  async bind(font) {\n    if (font.attached || font.missingFile && !font.systemFontInfo) {\n      return;\n    }\n    font.attached = true;\n    if (font.systemFontInfo) {\n      await this.loadSystemFont(font);\n      return;\n    }\n    if (this.isFontLoadingAPISupported) {\n      const nativeFontFace = font.createNativeFontFace();\n      if (nativeFontFace) {\n        this.addNativeFontFace(nativeFontFace);\n        try {\n          await nativeFontFace.loaded;\n        } catch (ex) {\n          warn(`Failed to load font '${nativeFontFace.family}': '${ex}'.`);\n          font.disableFontFace = true;\n          throw ex;\n        }\n      }\n      return;\n    }\n    const rule = font.createFontFaceRule();\n    if (rule) {\n      this.insertRule(rule);\n      if (this.isSyncFontLoadingSupported) {\n        return;\n      }\n      await new Promise(resolve => {\n        const request = this._queueLoadingCallback(resolve);\n        this._prepareFontLoadEvent(font, request);\n      });\n    }\n  }\n  get isFontLoadingAPISupported() {\n    const hasFonts = !!this._document?.fonts;\n    return shadow(this, \"isFontLoadingAPISupported\", hasFonts);\n  }\n  get isSyncFontLoadingSupported() {\n    let supported = false;\n    if (isNodeJS) {\n      supported = true;\n    } else if (typeof navigator !== \"undefined\" && typeof navigator?.userAgent === \"string\" && /Mozilla\\/5.0.*?rv:\\d+.*? Gecko/.test(navigator.userAgent)) {\n      supported = true;\n    }\n    return shadow(this, \"isSyncFontLoadingSupported\", supported);\n  }\n  _queueLoadingCallback(callback) {\n    function completeRequest() {\n      assert(!request.done, \"completeRequest() cannot be called twice.\");\n      request.done = true;\n      while (loadingRequests.length > 0 && loadingRequests[0].done) {\n        const otherRequest = loadingRequests.shift();\n        setTimeout(otherRequest.callback, 0);\n      }\n    }\n    const {\n      loadingRequests\n    } = this;\n    const request = {\n      done: false,\n      complete: completeRequest,\n      callback\n    };\n    loadingRequests.push(request);\n    return request;\n  }\n  get _loadTestFont() {\n    const testFont = atob(\"T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQA\" + \"FQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAA\" + \"ALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgA\" + \"AAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1\" + \"AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD\" + \"6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACM\" + \"AooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4D\" + \"IP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAA\" + \"AAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUA\" + \"AQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgAB\" + \"AAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABY\" + \"AAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAA\" + \"AC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" + \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAA\" + \"AAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQAC\" + \"AQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3\" + \"Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTj\" + \"FQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==\");\n    return shadow(this, \"_loadTestFont\", testFont);\n  }\n  _prepareFontLoadEvent(font, request) {\n    function int32(data, offset) {\n      return data.charCodeAt(offset) << 24 | data.charCodeAt(offset + 1) << 16 | data.charCodeAt(offset + 2) << 8 | data.charCodeAt(offset + 3) & 0xff;\n    }\n    function spliceString(s, offset, remove, insert) {\n      const chunk1 = s.substring(0, offset);\n      const chunk2 = s.substring(offset + remove);\n      return chunk1 + insert + chunk2;\n    }\n    let i, ii;\n    const canvas = this._document.createElement(\"canvas\");\n    canvas.width = 1;\n    canvas.height = 1;\n    const ctx = canvas.getContext(\"2d\");\n    let called = 0;\n    function isFontReady(name, callback) {\n      if (++called > 30) {\n        warn(\"Load test font never loaded.\");\n        callback();\n        return;\n      }\n      ctx.font = \"30px \" + name;\n      ctx.fillText(\".\", 0, 20);\n      const imageData = ctx.getImageData(0, 0, 1, 1);\n      if (imageData.data[3] > 0) {\n        callback();\n        return;\n      }\n      setTimeout(isFontReady.bind(null, name, callback));\n    }\n    const loadTestFontId = `lt${Date.now()}${this.loadTestFontId++}`;\n    let data = this._loadTestFont;\n    const COMMENT_OFFSET = 976;\n    data = spliceString(data, COMMENT_OFFSET, loadTestFontId.length, loadTestFontId);\n    const CFF_CHECKSUM_OFFSET = 16;\n    const XXXX_VALUE = 0x58585858;\n    let checksum = int32(data, CFF_CHECKSUM_OFFSET);\n    for (i = 0, ii = loadTestFontId.length - 3; i < ii; i += 4) {\n      checksum = checksum - XXXX_VALUE + int32(loadTestFontId, i) | 0;\n    }\n    if (i < loadTestFontId.length) {\n      checksum = checksum - XXXX_VALUE + int32(loadTestFontId + \"XXX\", i) | 0;\n    }\n    data = spliceString(data, CFF_CHECKSUM_OFFSET, 4, string32(checksum));\n    const url = `url(data:font/opentype;base64,${btoa(data)});`;\n    const rule = `@font-face {font-family:\"${loadTestFontId}\";src:${url}}`;\n    this.insertRule(rule);\n    const div = this._document.createElement(\"div\");\n    div.style.visibility = \"hidden\";\n    div.style.width = div.style.height = \"10px\";\n    div.style.position = \"absolute\";\n    div.style.top = div.style.left = \"0px\";\n    for (const name of [font.loadedName, loadTestFontId]) {\n      const span = this._document.createElement(\"span\");\n      span.textContent = \"Hi\";\n      span.style.fontFamily = name;\n      div.append(span);\n    }\n    this._document.body.append(div);\n    isFontReady(loadTestFontId, () => {\n      div.remove();\n      request.complete();\n    });\n  }\n}\nclass FontFaceObject {\n  constructor(translatedData, {\n    disableFontFace = false,\n    inspectFont = null\n  }) {\n    this.compiledGlyphs = Object.create(null);\n    for (const i in translatedData) {\n      this[i] = translatedData[i];\n    }\n    this.disableFontFace = disableFontFace === true;\n    this._inspectFont = inspectFont;\n  }\n  createNativeFontFace() {\n    if (!this.data || this.disableFontFace) {\n      return null;\n    }\n    let nativeFontFace;\n    if (!this.cssFontInfo) {\n      nativeFontFace = new FontFace(this.loadedName, this.data, {});\n    } else {\n      const css = {\n        weight: this.cssFontInfo.fontWeight\n      };\n      if (this.cssFontInfo.italicAngle) {\n        css.style = `oblique ${this.cssFontInfo.italicAngle}deg`;\n      }\n      nativeFontFace = new FontFace(this.cssFontInfo.fontFamily, this.data, css);\n    }\n    this._inspectFont?.(this);\n    return nativeFontFace;\n  }\n  createFontFaceRule() {\n    if (!this.data || this.disableFontFace) {\n      return null;\n    }\n    const data = bytesToString(this.data);\n    const url = `url(data:${this.mimetype};base64,${btoa(data)});`;\n    let rule;\n    if (!this.cssFontInfo) {\n      rule = `@font-face {font-family:\"${this.loadedName}\";src:${url}}`;\n    } else {\n      let css = `font-weight: ${this.cssFontInfo.fontWeight};`;\n      if (this.cssFontInfo.italicAngle) {\n        css += `font-style: oblique ${this.cssFontInfo.italicAngle}deg;`;\n      }\n      rule = `@font-face {font-family:\"${this.cssFontInfo.fontFamily}\";${css}src:${url}}`;\n    }\n    this._inspectFont?.(this, url);\n    return rule;\n  }\n  getPathGenerator(objs, character) {\n    if (this.compiledGlyphs[character] !== undefined) {\n      return this.compiledGlyphs[character];\n    }\n    let cmds;\n    try {\n      cmds = objs.get(this.loadedName + \"_path_\" + character);\n    } catch (ex) {\n      warn(`getPathGenerator - ignoring character: \"${ex}\".`);\n    }\n    if (!Array.isArray(cmds) || cmds.length === 0) {\n      return this.compiledGlyphs[character] = function (c, size) {};\n    }\n    const commands = [];\n    for (let i = 0, ii = cmds.length; i < ii;) {\n      switch (cmds[i++]) {\n        case FontRenderOps.BEZIER_CURVE_TO:\n          {\n            const [a, b, c, d, e, f] = cmds.slice(i, i + 6);\n            commands.push(ctx => ctx.bezierCurveTo(a, b, c, d, e, f));\n            i += 6;\n          }\n          break;\n        case FontRenderOps.MOVE_TO:\n          {\n            const [a, b] = cmds.slice(i, i + 2);\n            commands.push(ctx => ctx.moveTo(a, b));\n            i += 2;\n          }\n          break;\n        case FontRenderOps.LINE_TO:\n          {\n            const [a, b] = cmds.slice(i, i + 2);\n            commands.push(ctx => ctx.lineTo(a, b));\n            i += 2;\n          }\n          break;\n        case FontRenderOps.QUADRATIC_CURVE_TO:\n          {\n            const [a, b, c, d] = cmds.slice(i, i + 4);\n            commands.push(ctx => ctx.quadraticCurveTo(a, b, c, d));\n            i += 4;\n          }\n          break;\n        case FontRenderOps.RESTORE:\n          commands.push(ctx => ctx.restore());\n          break;\n        case FontRenderOps.SAVE:\n          commands.push(ctx => ctx.save());\n          break;\n        case FontRenderOps.SCALE:\n          assert(commands.length === 2, \"Scale command is only valid at the third position.\");\n          break;\n        case FontRenderOps.TRANSFORM:\n          {\n            const [a, b, c, d, e, f] = cmds.slice(i, i + 6);\n            commands.push(ctx => ctx.transform(a, b, c, d, e, f));\n            i += 6;\n          }\n          break;\n        case FontRenderOps.TRANSLATE:\n          {\n            const [a, b] = cmds.slice(i, i + 2);\n            commands.push(ctx => ctx.translate(a, b));\n            i += 2;\n          }\n          break;\n      }\n    }\n    return this.compiledGlyphs[character] = function glyphDrawer(ctx, size) {\n      commands[0](ctx);\n      commands[1](ctx);\n      ctx.scale(size, -size);\n      for (let i = 2, ii = commands.length; i < ii; i++) {\n        commands[i](ctx);\n      }\n    };\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/node_utils.js\n\n\nif (isNodeJS) {\n  var packageCapability = Promise.withResolvers();\n  var packageMap = null;\n  const loadPackages = async () => {\n    const fs = await import( /*webpackIgnore: true*/\"fs\"),\n      http = await import( /*webpackIgnore: true*/\"http\"),\n      https = await import( /*webpackIgnore: true*/\"https\"),\n      url = await import( /*webpackIgnore: true*/\"url\");\n    let canvas, path2d;\n    return new Map(Object.entries({\n      fs,\n      http,\n      https,\n      url,\n      canvas,\n      path2d\n    }));\n  };\n  loadPackages().then(map => {\n    packageMap = map;\n    packageCapability.resolve();\n  }, reason => {\n    warn(`loadPackages: ${reason}`);\n    packageMap = new Map();\n    packageCapability.resolve();\n  });\n}\nclass NodePackages {\n  static get promise() {\n    return packageCapability.promise;\n  }\n  static get(name) {\n    return packageMap?.get(name);\n  }\n}\nconst node_utils_fetchData = function (url) {\n  const fs = NodePackages.get(\"fs\");\n  return fs.promises.readFile(url).then(data => new Uint8Array(data));\n};\nclass NodeFilterFactory extends BaseFilterFactory {}\nclass NodeCanvasFactory extends BaseCanvasFactory {\n  _createCanvas(width, height) {\n    const canvas = NodePackages.get(\"canvas\");\n    return canvas.createCanvas(width, height);\n  }\n}\nclass NodeCMapReaderFactory extends BaseCMapReaderFactory {\n  _fetchData(url, compressionType) {\n    return node_utils_fetchData(url).then(data => ({\n      cMapData: data,\n      compressionType\n    }));\n  }\n}\nclass NodeStandardFontDataFactory extends BaseStandardFontDataFactory {\n  _fetchData(url) {\n    return node_utils_fetchData(url);\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/pattern_helper.js\n\n\nconst PathType = {\n  FILL: \"Fill\",\n  STROKE: \"Stroke\",\n  SHADING: \"Shading\"\n};\nfunction applyBoundingBox(ctx, bbox) {\n  if (!bbox) {\n    return;\n  }\n  const width = bbox[2] - bbox[0];\n  const height = bbox[3] - bbox[1];\n  const region = new Path2D();\n  region.rect(bbox[0], bbox[1], width, height);\n  ctx.clip(region);\n}\nclass BaseShadingPattern {\n  getPattern() {\n    unreachable(\"Abstract method `getPattern` called.\");\n  }\n}\nclass RadialAxialShadingPattern extends BaseShadingPattern {\n  constructor(IR) {\n    super();\n    this._type = IR[1];\n    this._bbox = IR[2];\n    this._colorStops = IR[3];\n    this._p0 = IR[4];\n    this._p1 = IR[5];\n    this._r0 = IR[6];\n    this._r1 = IR[7];\n    this.matrix = null;\n  }\n  _createGradient(ctx) {\n    let grad;\n    if (this._type === \"axial\") {\n      grad = ctx.createLinearGradient(this._p0[0], this._p0[1], this._p1[0], this._p1[1]);\n    } else if (this._type === \"radial\") {\n      grad = ctx.createRadialGradient(this._p0[0], this._p0[1], this._r0, this._p1[0], this._p1[1], this._r1);\n    }\n    for (const colorStop of this._colorStops) {\n      grad.addColorStop(colorStop[0], colorStop[1]);\n    }\n    return grad;\n  }\n  getPattern(ctx, owner, inverse, pathType) {\n    let pattern;\n    if (pathType === PathType.STROKE || pathType === PathType.FILL) {\n      const ownerBBox = owner.current.getClippedPathBoundingBox(pathType, getCurrentTransform(ctx)) || [0, 0, 0, 0];\n      const width = Math.ceil(ownerBBox[2] - ownerBBox[0]) || 1;\n      const height = Math.ceil(ownerBBox[3] - ownerBBox[1]) || 1;\n      const tmpCanvas = owner.cachedCanvases.getCanvas(\"pattern\", width, height, true);\n      const tmpCtx = tmpCanvas.context;\n      tmpCtx.clearRect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n      tmpCtx.beginPath();\n      tmpCtx.rect(0, 0, tmpCtx.canvas.width, tmpCtx.canvas.height);\n      tmpCtx.translate(-ownerBBox[0], -ownerBBox[1]);\n      inverse = Util.transform(inverse, [1, 0, 0, 1, ownerBBox[0], ownerBBox[1]]);\n      tmpCtx.transform(...owner.baseTransform);\n      if (this.matrix) {\n        tmpCtx.transform(...this.matrix);\n      }\n      applyBoundingBox(tmpCtx, this._bbox);\n      tmpCtx.fillStyle = this._createGradient(tmpCtx);\n      tmpCtx.fill();\n      pattern = ctx.createPattern(tmpCanvas.canvas, \"no-repeat\");\n      const domMatrix = new DOMMatrix(inverse);\n      pattern.setTransform(domMatrix);\n    } else {\n      applyBoundingBox(ctx, this._bbox);\n      pattern = this._createGradient(ctx);\n    }\n    return pattern;\n  }\n}\nfunction drawTriangle(data, context, p1, p2, p3, c1, c2, c3) {\n  const coords = context.coords,\n    colors = context.colors;\n  const bytes = data.data,\n    rowSize = data.width * 4;\n  let tmp;\n  if (coords[p1 + 1] > coords[p2 + 1]) {\n    tmp = p1;\n    p1 = p2;\n    p2 = tmp;\n    tmp = c1;\n    c1 = c2;\n    c2 = tmp;\n  }\n  if (coords[p2 + 1] > coords[p3 + 1]) {\n    tmp = p2;\n    p2 = p3;\n    p3 = tmp;\n    tmp = c2;\n    c2 = c3;\n    c3 = tmp;\n  }\n  if (coords[p1 + 1] > coords[p2 + 1]) {\n    tmp = p1;\n    p1 = p2;\n    p2 = tmp;\n    tmp = c1;\n    c1 = c2;\n    c2 = tmp;\n  }\n  const x1 = (coords[p1] + context.offsetX) * context.scaleX;\n  const y1 = (coords[p1 + 1] + context.offsetY) * context.scaleY;\n  const x2 = (coords[p2] + context.offsetX) * context.scaleX;\n  const y2 = (coords[p2 + 1] + context.offsetY) * context.scaleY;\n  const x3 = (coords[p3] + context.offsetX) * context.scaleX;\n  const y3 = (coords[p3 + 1] + context.offsetY) * context.scaleY;\n  if (y1 >= y3) {\n    return;\n  }\n  const c1r = colors[c1],\n    c1g = colors[c1 + 1],\n    c1b = colors[c1 + 2];\n  const c2r = colors[c2],\n    c2g = colors[c2 + 1],\n    c2b = colors[c2 + 2];\n  const c3r = colors[c3],\n    c3g = colors[c3 + 1],\n    c3b = colors[c3 + 2];\n  const minY = Math.round(y1),\n    maxY = Math.round(y3);\n  let xa, car, cag, cab;\n  let xb, cbr, cbg, cbb;\n  for (let y = minY; y <= maxY; y++) {\n    if (y < y2) {\n      const k = y < y1 ? 0 : (y1 - y) / (y1 - y2);\n      xa = x1 - (x1 - x2) * k;\n      car = c1r - (c1r - c2r) * k;\n      cag = c1g - (c1g - c2g) * k;\n      cab = c1b - (c1b - c2b) * k;\n    } else {\n      let k;\n      if (y > y3) {\n        k = 1;\n      } else if (y2 === y3) {\n        k = 0;\n      } else {\n        k = (y2 - y) / (y2 - y3);\n      }\n      xa = x2 - (x2 - x3) * k;\n      car = c2r - (c2r - c3r) * k;\n      cag = c2g - (c2g - c3g) * k;\n      cab = c2b - (c2b - c3b) * k;\n    }\n    let k;\n    if (y < y1) {\n      k = 0;\n    } else if (y > y3) {\n      k = 1;\n    } else {\n      k = (y1 - y) / (y1 - y3);\n    }\n    xb = x1 - (x1 - x3) * k;\n    cbr = c1r - (c1r - c3r) * k;\n    cbg = c1g - (c1g - c3g) * k;\n    cbb = c1b - (c1b - c3b) * k;\n    const x1_ = Math.round(Math.min(xa, xb));\n    const x2_ = Math.round(Math.max(xa, xb));\n    let j = rowSize * y + x1_ * 4;\n    for (let x = x1_; x <= x2_; x++) {\n      k = (xa - x) / (xa - xb);\n      if (k < 0) {\n        k = 0;\n      } else if (k > 1) {\n        k = 1;\n      }\n      bytes[j++] = car - (car - cbr) * k | 0;\n      bytes[j++] = cag - (cag - cbg) * k | 0;\n      bytes[j++] = cab - (cab - cbb) * k | 0;\n      bytes[j++] = 255;\n    }\n  }\n}\nfunction drawFigure(data, figure, context) {\n  const ps = figure.coords;\n  const cs = figure.colors;\n  let i, ii;\n  switch (figure.type) {\n    case \"lattice\":\n      const verticesPerRow = figure.verticesPerRow;\n      const rows = Math.floor(ps.length / verticesPerRow) - 1;\n      const cols = verticesPerRow - 1;\n      for (i = 0; i < rows; i++) {\n        let q = i * verticesPerRow;\n        for (let j = 0; j < cols; j++, q++) {\n          drawTriangle(data, context, ps[q], ps[q + 1], ps[q + verticesPerRow], cs[q], cs[q + 1], cs[q + verticesPerRow]);\n          drawTriangle(data, context, ps[q + verticesPerRow + 1], ps[q + 1], ps[q + verticesPerRow], cs[q + verticesPerRow + 1], cs[q + 1], cs[q + verticesPerRow]);\n        }\n      }\n      break;\n    case \"triangles\":\n      for (i = 0, ii = ps.length; i < ii; i += 3) {\n        drawTriangle(data, context, ps[i], ps[i + 1], ps[i + 2], cs[i], cs[i + 1], cs[i + 2]);\n      }\n      break;\n    default:\n      throw new Error(\"illegal figure\");\n  }\n}\nclass MeshShadingPattern extends BaseShadingPattern {\n  constructor(IR) {\n    super();\n    this._coords = IR[2];\n    this._colors = IR[3];\n    this._figures = IR[4];\n    this._bounds = IR[5];\n    this._bbox = IR[7];\n    this._background = IR[8];\n    this.matrix = null;\n  }\n  _createMeshCanvas(combinedScale, backgroundColor, cachedCanvases) {\n    const EXPECTED_SCALE = 1.1;\n    const MAX_PATTERN_SIZE = 3000;\n    const BORDER_SIZE = 2;\n    const offsetX = Math.floor(this._bounds[0]);\n    const offsetY = Math.floor(this._bounds[1]);\n    const boundsWidth = Math.ceil(this._bounds[2]) - offsetX;\n    const boundsHeight = Math.ceil(this._bounds[3]) - offsetY;\n    const width = Math.min(Math.ceil(Math.abs(boundsWidth * combinedScale[0] * EXPECTED_SCALE)), MAX_PATTERN_SIZE);\n    const height = Math.min(Math.ceil(Math.abs(boundsHeight * combinedScale[1] * EXPECTED_SCALE)), MAX_PATTERN_SIZE);\n    const scaleX = boundsWidth / width;\n    const scaleY = boundsHeight / height;\n    const context = {\n      coords: this._coords,\n      colors: this._colors,\n      offsetX: -offsetX,\n      offsetY: -offsetY,\n      scaleX: 1 / scaleX,\n      scaleY: 1 / scaleY\n    };\n    const paddedWidth = width + BORDER_SIZE * 2;\n    const paddedHeight = height + BORDER_SIZE * 2;\n    const tmpCanvas = cachedCanvases.getCanvas(\"mesh\", paddedWidth, paddedHeight, false);\n    const tmpCtx = tmpCanvas.context;\n    const data = tmpCtx.createImageData(width, height);\n    if (backgroundColor) {\n      const bytes = data.data;\n      for (let i = 0, ii = bytes.length; i < ii; i += 4) {\n        bytes[i] = backgroundColor[0];\n        bytes[i + 1] = backgroundColor[1];\n        bytes[i + 2] = backgroundColor[2];\n        bytes[i + 3] = 255;\n      }\n    }\n    for (const figure of this._figures) {\n      drawFigure(data, figure, context);\n    }\n    tmpCtx.putImageData(data, BORDER_SIZE, BORDER_SIZE);\n    const canvas = tmpCanvas.canvas;\n    return {\n      canvas,\n      offsetX: offsetX - BORDER_SIZE * scaleX,\n      offsetY: offsetY - BORDER_SIZE * scaleY,\n      scaleX,\n      scaleY\n    };\n  }\n  getPattern(ctx, owner, inverse, pathType) {\n    applyBoundingBox(ctx, this._bbox);\n    let scale;\n    if (pathType === PathType.SHADING) {\n      scale = Util.singularValueDecompose2dScale(getCurrentTransform(ctx));\n    } else {\n      scale = Util.singularValueDecompose2dScale(owner.baseTransform);\n      if (this.matrix) {\n        const matrixScale = Util.singularValueDecompose2dScale(this.matrix);\n        scale = [scale[0] * matrixScale[0], scale[1] * matrixScale[1]];\n      }\n    }\n    const temporaryPatternCanvas = this._createMeshCanvas(scale, pathType === PathType.SHADING ? null : this._background, owner.cachedCanvases);\n    if (pathType !== PathType.SHADING) {\n      ctx.setTransform(...owner.baseTransform);\n      if (this.matrix) {\n        ctx.transform(...this.matrix);\n      }\n    }\n    ctx.translate(temporaryPatternCanvas.offsetX, temporaryPatternCanvas.offsetY);\n    ctx.scale(temporaryPatternCanvas.scaleX, temporaryPatternCanvas.scaleY);\n    return ctx.createPattern(temporaryPatternCanvas.canvas, \"no-repeat\");\n  }\n}\nclass DummyShadingPattern extends BaseShadingPattern {\n  getPattern() {\n    return \"hotpink\";\n  }\n}\nfunction getShadingPattern(IR) {\n  switch (IR[0]) {\n    case \"RadialAxial\":\n      return new RadialAxialShadingPattern(IR);\n    case \"Mesh\":\n      return new MeshShadingPattern(IR);\n    case \"Dummy\":\n      return new DummyShadingPattern();\n  }\n  throw new Error(`Unknown IR type: ${IR[0]}`);\n}\nconst PaintType = {\n  COLORED: 1,\n  UNCOLORED: 2\n};\nclass TilingPattern {\n  static MAX_PATTERN_SIZE = 3000;\n  constructor(IR, color, ctx, canvasGraphicsFactory, baseTransform) {\n    this.operatorList = IR[2];\n    this.matrix = IR[3];\n    this.bbox = IR[4];\n    this.xstep = IR[5];\n    this.ystep = IR[6];\n    this.paintType = IR[7];\n    this.tilingType = IR[8];\n    this.color = color;\n    this.ctx = ctx;\n    this.canvasGraphicsFactory = canvasGraphicsFactory;\n    this.baseTransform = baseTransform;\n  }\n  createPatternCanvas(owner) {\n    const operatorList = this.operatorList;\n    const bbox = this.bbox;\n    const xstep = this.xstep;\n    const ystep = this.ystep;\n    const paintType = this.paintType;\n    const tilingType = this.tilingType;\n    const color = this.color;\n    const canvasGraphicsFactory = this.canvasGraphicsFactory;\n    info(\"TilingType: \" + tilingType);\n    const x0 = bbox[0],\n      y0 = bbox[1],\n      x1 = bbox[2],\n      y1 = bbox[3];\n    const matrixScale = Util.singularValueDecompose2dScale(this.matrix);\n    const curMatrixScale = Util.singularValueDecompose2dScale(this.baseTransform);\n    const combinedScale = [matrixScale[0] * curMatrixScale[0], matrixScale[1] * curMatrixScale[1]];\n    const dimx = this.getSizeAndScale(xstep, this.ctx.canvas.width, combinedScale[0]);\n    const dimy = this.getSizeAndScale(ystep, this.ctx.canvas.height, combinedScale[1]);\n    const tmpCanvas = owner.cachedCanvases.getCanvas(\"pattern\", dimx.size, dimy.size, true);\n    const tmpCtx = tmpCanvas.context;\n    const graphics = canvasGraphicsFactory.createCanvasGraphics(tmpCtx);\n    graphics.groupLevel = owner.groupLevel;\n    this.setFillAndStrokeStyleToContext(graphics, paintType, color);\n    let adjustedX0 = x0;\n    let adjustedY0 = y0;\n    let adjustedX1 = x1;\n    let adjustedY1 = y1;\n    if (x0 < 0) {\n      adjustedX0 = 0;\n      adjustedX1 += Math.abs(x0);\n    }\n    if (y0 < 0) {\n      adjustedY0 = 0;\n      adjustedY1 += Math.abs(y0);\n    }\n    tmpCtx.translate(-(dimx.scale * adjustedX0), -(dimy.scale * adjustedY0));\n    graphics.transform(dimx.scale, 0, 0, dimy.scale, 0, 0);\n    tmpCtx.save();\n    this.clipBbox(graphics, adjustedX0, adjustedY0, adjustedX1, adjustedY1);\n    graphics.baseTransform = getCurrentTransform(graphics.ctx);\n    graphics.executeOperatorList(operatorList);\n    graphics.endDrawing();\n    return {\n      canvas: tmpCanvas.canvas,\n      scaleX: dimx.scale,\n      scaleY: dimy.scale,\n      offsetX: adjustedX0,\n      offsetY: adjustedY0\n    };\n  }\n  getSizeAndScale(step, realOutputSize, scale) {\n    step = Math.abs(step);\n    const maxSize = Math.max(TilingPattern.MAX_PATTERN_SIZE, realOutputSize);\n    let size = Math.ceil(step * scale);\n    if (size >= maxSize) {\n      size = maxSize;\n    } else {\n      scale = size / step;\n    }\n    return {\n      scale,\n      size\n    };\n  }\n  clipBbox(graphics, x0, y0, x1, y1) {\n    const bboxWidth = x1 - x0;\n    const bboxHeight = y1 - y0;\n    graphics.ctx.rect(x0, y0, bboxWidth, bboxHeight);\n    graphics.current.updateRectMinMax(getCurrentTransform(graphics.ctx), [x0, y0, x1, y1]);\n    graphics.clip();\n    graphics.endPath();\n  }\n  setFillAndStrokeStyleToContext(graphics, paintType, color) {\n    const context = graphics.ctx,\n      current = graphics.current;\n    switch (paintType) {\n      case PaintType.COLORED:\n        const ctx = this.ctx;\n        context.fillStyle = ctx.fillStyle;\n        context.strokeStyle = ctx.strokeStyle;\n        current.fillColor = ctx.fillStyle;\n        current.strokeColor = ctx.strokeStyle;\n        break;\n      case PaintType.UNCOLORED:\n        const cssColor = Util.makeHexColor(color[0], color[1], color[2]);\n        context.fillStyle = cssColor;\n        context.strokeStyle = cssColor;\n        current.fillColor = cssColor;\n        current.strokeColor = cssColor;\n        break;\n      default:\n        throw new FormatError(`Unsupported paint type: ${paintType}`);\n    }\n  }\n  getPattern(ctx, owner, inverse, pathType) {\n    let matrix = inverse;\n    if (pathType !== PathType.SHADING) {\n      matrix = Util.transform(matrix, owner.baseTransform);\n      if (this.matrix) {\n        matrix = Util.transform(matrix, this.matrix);\n      }\n    }\n    const temporaryPatternCanvas = this.createPatternCanvas(owner);\n    let domMatrix = new DOMMatrix(matrix);\n    domMatrix = domMatrix.translate(temporaryPatternCanvas.offsetX, temporaryPatternCanvas.offsetY);\n    domMatrix = domMatrix.scale(1 / temporaryPatternCanvas.scaleX, 1 / temporaryPatternCanvas.scaleY);\n    const pattern = ctx.createPattern(temporaryPatternCanvas.canvas, \"repeat\");\n    pattern.setTransform(domMatrix);\n    return pattern;\n  }\n}\n\n;// CONCATENATED MODULE: ./src/shared/image_utils.js\n\nfunction convertToRGBA(params) {\n  switch (params.kind) {\n    case ImageKind.GRAYSCALE_1BPP:\n      return convertBlackAndWhiteToRGBA(params);\n    case ImageKind.RGB_24BPP:\n      return convertRGBToRGBA(params);\n  }\n  return null;\n}\nfunction convertBlackAndWhiteToRGBA({\n  src,\n  srcPos = 0,\n  dest,\n  width,\n  height,\n  nonBlackColor = 0xffffffff,\n  inverseDecode = false\n}) {\n  const black = util_FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n  const [zeroMapping, oneMapping] = inverseDecode ? [nonBlackColor, black] : [black, nonBlackColor];\n  const widthInSource = width >> 3;\n  const widthRemainder = width & 7;\n  const srcLength = src.length;\n  dest = new Uint32Array(dest.buffer);\n  let destPos = 0;\n  for (let i = 0; i < height; i++) {\n    for (const max = srcPos + widthInSource; srcPos < max; srcPos++) {\n      const elem = srcPos < srcLength ? src[srcPos] : 255;\n      dest[destPos++] = elem & 0b10000000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1000000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b100000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b10000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1000 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b100 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b10 ? oneMapping : zeroMapping;\n      dest[destPos++] = elem & 0b1 ? oneMapping : zeroMapping;\n    }\n    if (widthRemainder === 0) {\n      continue;\n    }\n    const elem = srcPos < srcLength ? src[srcPos++] : 255;\n    for (let j = 0; j < widthRemainder; j++) {\n      dest[destPos++] = elem & 1 << 7 - j ? oneMapping : zeroMapping;\n    }\n  }\n  return {\n    srcPos,\n    destPos\n  };\n}\nfunction convertRGBToRGBA({\n  src,\n  srcPos = 0,\n  dest,\n  destPos = 0,\n  width,\n  height\n}) {\n  let i = 0;\n  const len32 = src.length >> 2;\n  const src32 = new Uint32Array(src.buffer, srcPos, len32);\n  if (FeatureTest.isLittleEndian) {\n    for (; i < len32 - 2; i += 3, destPos += 4) {\n      const s1 = src32[i];\n      const s2 = src32[i + 1];\n      const s3 = src32[i + 2];\n      dest[destPos] = s1 | 0xff000000;\n      dest[destPos + 1] = s1 >>> 24 | s2 << 8 | 0xff000000;\n      dest[destPos + 2] = s2 >>> 16 | s3 << 16 | 0xff000000;\n      dest[destPos + 3] = s3 >>> 8 | 0xff000000;\n    }\n    for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n      dest[destPos++] = src[j] | src[j + 1] << 8 | src[j + 2] << 16 | 0xff000000;\n    }\n  } else {\n    for (; i < len32 - 2; i += 3, destPos += 4) {\n      const s1 = src32[i];\n      const s2 = src32[i + 1];\n      const s3 = src32[i + 2];\n      dest[destPos] = s1 | 0xff;\n      dest[destPos + 1] = s1 << 24 | s2 >>> 8 | 0xff;\n      dest[destPos + 2] = s2 << 16 | s3 >>> 16 | 0xff;\n      dest[destPos + 3] = s3 << 8 | 0xff;\n    }\n    for (let j = i * 4, jj = src.length; j < jj; j += 3) {\n      dest[destPos++] = src[j] << 24 | src[j + 1] << 16 | src[j + 2] << 8 | 0xff;\n    }\n  }\n  return {\n    srcPos,\n    destPos\n  };\n}\nfunction grayToRGBA(src, dest) {\n  if (FeatureTest.isLittleEndian) {\n    for (let i = 0, ii = src.length; i < ii; i++) {\n      dest[i] = src[i] * 0x10101 | 0xff000000;\n    }\n  } else {\n    for (let i = 0, ii = src.length; i < ii; i++) {\n      dest[i] = src[i] * 0x1010100 | 0x000000ff;\n    }\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/canvas.js\n\n\n\n\nconst MIN_FONT_SIZE = 16;\nconst MAX_FONT_SIZE = 100;\nconst EXECUTION_TIME = 15;\nconst EXECUTION_STEPS = 10;\nconst MAX_SIZE_TO_COMPILE = 1000;\nconst FULL_CHUNK_HEIGHT = 16;\nfunction mirrorContextOperations(ctx, destCtx) {\n  if (ctx._removeMirroring) {\n    throw new Error(\"Context is already forwarding operations.\");\n  }\n  ctx.__originalSave = ctx.save;\n  ctx.__originalRestore = ctx.restore;\n  ctx.__originalRotate = ctx.rotate;\n  ctx.__originalScale = ctx.scale;\n  ctx.__originalTranslate = ctx.translate;\n  ctx.__originalTransform = ctx.transform;\n  ctx.__originalSetTransform = ctx.setTransform;\n  ctx.__originalResetTransform = ctx.resetTransform;\n  ctx.__originalClip = ctx.clip;\n  ctx.__originalMoveTo = ctx.moveTo;\n  ctx.__originalLineTo = ctx.lineTo;\n  ctx.__originalBezierCurveTo = ctx.bezierCurveTo;\n  ctx.__originalRect = ctx.rect;\n  ctx.__originalClosePath = ctx.closePath;\n  ctx.__originalBeginPath = ctx.beginPath;\n  ctx._removeMirroring = () => {\n    ctx.save = ctx.__originalSave;\n    ctx.restore = ctx.__originalRestore;\n    ctx.rotate = ctx.__originalRotate;\n    ctx.scale = ctx.__originalScale;\n    ctx.translate = ctx.__originalTranslate;\n    ctx.transform = ctx.__originalTransform;\n    ctx.setTransform = ctx.__originalSetTransform;\n    ctx.resetTransform = ctx.__originalResetTransform;\n    ctx.clip = ctx.__originalClip;\n    ctx.moveTo = ctx.__originalMoveTo;\n    ctx.lineTo = ctx.__originalLineTo;\n    ctx.bezierCurveTo = ctx.__originalBezierCurveTo;\n    ctx.rect = ctx.__originalRect;\n    ctx.closePath = ctx.__originalClosePath;\n    ctx.beginPath = ctx.__originalBeginPath;\n    delete ctx._removeMirroring;\n  };\n  ctx.save = function ctxSave() {\n    destCtx.save();\n    this.__originalSave();\n  };\n  ctx.restore = function ctxRestore() {\n    destCtx.restore();\n    this.__originalRestore();\n  };\n  ctx.translate = function ctxTranslate(x, y) {\n    destCtx.translate(x, y);\n    this.__originalTranslate(x, y);\n  };\n  ctx.scale = function ctxScale(x, y) {\n    destCtx.scale(x, y);\n    this.__originalScale(x, y);\n  };\n  ctx.transform = function ctxTransform(a, b, c, d, e, f) {\n    destCtx.transform(a, b, c, d, e, f);\n    this.__originalTransform(a, b, c, d, e, f);\n  };\n  ctx.setTransform = function ctxSetTransform(a, b, c, d, e, f) {\n    destCtx.setTransform(a, b, c, d, e, f);\n    this.__originalSetTransform(a, b, c, d, e, f);\n  };\n  ctx.resetTransform = function ctxResetTransform() {\n    destCtx.resetTransform();\n    this.__originalResetTransform();\n  };\n  ctx.rotate = function ctxRotate(angle) {\n    destCtx.rotate(angle);\n    this.__originalRotate(angle);\n  };\n  ctx.clip = function ctxRotate(rule) {\n    destCtx.clip(rule);\n    this.__originalClip(rule);\n  };\n  ctx.moveTo = function (x, y) {\n    destCtx.moveTo(x, y);\n    this.__originalMoveTo(x, y);\n  };\n  ctx.lineTo = function (x, y) {\n    destCtx.lineTo(x, y);\n    this.__originalLineTo(x, y);\n  };\n  ctx.bezierCurveTo = function (cp1x, cp1y, cp2x, cp2y, x, y) {\n    destCtx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n    this.__originalBezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n  };\n  ctx.rect = function (x, y, width, height) {\n    destCtx.rect(x, y, width, height);\n    this.__originalRect(x, y, width, height);\n  };\n  ctx.closePath = function () {\n    destCtx.closePath();\n    this.__originalClosePath();\n  };\n  ctx.beginPath = function () {\n    destCtx.beginPath();\n    this.__originalBeginPath();\n  };\n}\nclass CachedCanvases {\n  constructor(canvasFactory) {\n    this.canvasFactory = canvasFactory;\n    this.cache = Object.create(null);\n  }\n  getCanvas(id, width, height) {\n    let canvasEntry;\n    if (this.cache[id] !== undefined) {\n      canvasEntry = this.cache[id];\n      this.canvasFactory.reset(canvasEntry, width, height);\n    } else {\n      canvasEntry = this.canvasFactory.create(width, height);\n      this.cache[id] = canvasEntry;\n    }\n    return canvasEntry;\n  }\n  delete(id) {\n    delete this.cache[id];\n  }\n  clear() {\n    for (const id in this.cache) {\n      const canvasEntry = this.cache[id];\n      this.canvasFactory.destroy(canvasEntry);\n      delete this.cache[id];\n    }\n  }\n}\nfunction drawImageAtIntegerCoords(ctx, srcImg, srcX, srcY, srcW, srcH, destX, destY, destW, destH) {\n  const [a, b, c, d, tx, ty] = getCurrentTransform(ctx);\n  if (b === 0 && c === 0) {\n    const tlX = destX * a + tx;\n    const rTlX = Math.round(tlX);\n    const tlY = destY * d + ty;\n    const rTlY = Math.round(tlY);\n    const brX = (destX + destW) * a + tx;\n    const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n    const brY = (destY + destH) * d + ty;\n    const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n    ctx.setTransform(Math.sign(a), 0, 0, Math.sign(d), rTlX, rTlY);\n    ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rWidth, rHeight);\n    ctx.setTransform(a, b, c, d, tx, ty);\n    return [rWidth, rHeight];\n  }\n  if (a === 0 && d === 0) {\n    const tlX = destY * c + tx;\n    const rTlX = Math.round(tlX);\n    const tlY = destX * b + ty;\n    const rTlY = Math.round(tlY);\n    const brX = (destY + destH) * c + tx;\n    const rWidth = Math.abs(Math.round(brX) - rTlX) || 1;\n    const brY = (destX + destW) * b + ty;\n    const rHeight = Math.abs(Math.round(brY) - rTlY) || 1;\n    ctx.setTransform(0, Math.sign(b), Math.sign(c), 0, rTlX, rTlY);\n    ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, 0, 0, rHeight, rWidth);\n    ctx.setTransform(a, b, c, d, tx, ty);\n    return [rHeight, rWidth];\n  }\n  ctx.drawImage(srcImg, srcX, srcY, srcW, srcH, destX, destY, destW, destH);\n  const scaleX = Math.hypot(a, b);\n  const scaleY = Math.hypot(c, d);\n  return [scaleX * destW, scaleY * destH];\n}\nfunction compileType3Glyph(imgData) {\n  const {\n    width,\n    height\n  } = imgData;\n  if (width > MAX_SIZE_TO_COMPILE || height > MAX_SIZE_TO_COMPILE) {\n    return null;\n  }\n  const POINT_TO_PROCESS_LIMIT = 1000;\n  const POINT_TYPES = new Uint8Array([0, 2, 4, 0, 1, 0, 5, 4, 8, 10, 0, 8, 0, 2, 1, 0]);\n  const width1 = width + 1;\n  let points = new Uint8Array(width1 * (height + 1));\n  let i, j, j0;\n  const lineSize = width + 7 & ~7;\n  let data = new Uint8Array(lineSize * height),\n    pos = 0;\n  for (const elem of imgData.data) {\n    let mask = 128;\n    while (mask > 0) {\n      data[pos++] = elem & mask ? 0 : 255;\n      mask >>= 1;\n    }\n  }\n  let count = 0;\n  pos = 0;\n  if (data[pos] !== 0) {\n    points[0] = 1;\n    ++count;\n  }\n  for (j = 1; j < width; j++) {\n    if (data[pos] !== data[pos + 1]) {\n      points[j] = data[pos] ? 2 : 1;\n      ++count;\n    }\n    pos++;\n  }\n  if (data[pos] !== 0) {\n    points[j] = 2;\n    ++count;\n  }\n  for (i = 1; i < height; i++) {\n    pos = i * lineSize;\n    j0 = i * width1;\n    if (data[pos - lineSize] !== data[pos]) {\n      points[j0] = data[pos] ? 1 : 8;\n      ++count;\n    }\n    let sum = (data[pos] ? 4 : 0) + (data[pos - lineSize] ? 8 : 0);\n    for (j = 1; j < width; j++) {\n      sum = (sum >> 2) + (data[pos + 1] ? 4 : 0) + (data[pos - lineSize + 1] ? 8 : 0);\n      if (POINT_TYPES[sum]) {\n        points[j0 + j] = POINT_TYPES[sum];\n        ++count;\n      }\n      pos++;\n    }\n    if (data[pos - lineSize] !== data[pos]) {\n      points[j0 + j] = data[pos] ? 2 : 4;\n      ++count;\n    }\n    if (count > POINT_TO_PROCESS_LIMIT) {\n      return null;\n    }\n  }\n  pos = lineSize * (height - 1);\n  j0 = i * width1;\n  if (data[pos] !== 0) {\n    points[j0] = 8;\n    ++count;\n  }\n  for (j = 1; j < width; j++) {\n    if (data[pos] !== data[pos + 1]) {\n      points[j0 + j] = data[pos] ? 4 : 8;\n      ++count;\n    }\n    pos++;\n  }\n  if (data[pos] !== 0) {\n    points[j0 + j] = 4;\n    ++count;\n  }\n  if (count > POINT_TO_PROCESS_LIMIT) {\n    return null;\n  }\n  const steps = new Int32Array([0, width1, -1, 0, -width1, 0, 0, 0, 1]);\n  const path = new Path2D();\n  for (i = 0; count && i <= height; i++) {\n    let p = i * width1;\n    const end = p + width;\n    while (p < end && !points[p]) {\n      p++;\n    }\n    if (p === end) {\n      continue;\n    }\n    path.moveTo(p % width1, i);\n    const p0 = p;\n    let type = points[p];\n    do {\n      const step = steps[type];\n      do {\n        p += step;\n      } while (!points[p]);\n      const pp = points[p];\n      if (pp !== 5 && pp !== 10) {\n        type = pp;\n        points[p] = 0;\n      } else {\n        type = pp & 0x33 * type >> 4;\n        points[p] &= type >> 2 | type << 2;\n      }\n      path.lineTo(p % width1, p / width1 | 0);\n      if (!points[p]) {\n        --count;\n      }\n    } while (p0 !== p);\n    --i;\n  }\n  data = null;\n  points = null;\n  const drawOutline = function (c) {\n    c.save();\n    c.scale(1 / width, -1 / height);\n    c.translate(0, -height);\n    c.fill(path);\n    c.beginPath();\n    c.restore();\n  };\n  return drawOutline;\n}\nclass CanvasExtraState {\n  constructor(width, height) {\n    this.alphaIsShape = false;\n    this.fontSize = 0;\n    this.fontSizeScale = 1;\n    this.textMatrix = IDENTITY_MATRIX;\n    this.textMatrixScale = 1;\n    this.fontMatrix = FONT_IDENTITY_MATRIX;\n    this.leading = 0;\n    this.x = 0;\n    this.y = 0;\n    this.lineX = 0;\n    this.lineY = 0;\n    this.charSpacing = 0;\n    this.wordSpacing = 0;\n    this.textHScale = 1;\n    this.textRenderingMode = TextRenderingMode.FILL;\n    this.textRise = 0;\n    this.fillColor = \"#000000\";\n    this.strokeColor = \"#000000\";\n    this.patternFill = false;\n    this.fillAlpha = 1;\n    this.strokeAlpha = 1;\n    this.lineWidth = 1;\n    this.activeSMask = null;\n    this.transferMaps = \"none\";\n    this.startNewPathAndClipBox([0, 0, width, height]);\n  }\n  clone() {\n    const clone = Object.create(this);\n    clone.clipBox = this.clipBox.slice();\n    return clone;\n  }\n  setCurrentPoint(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n  updatePathMinMax(transform, x, y) {\n    [x, y] = Util.applyTransform([x, y], transform);\n    this.minX = Math.min(this.minX, x);\n    this.minY = Math.min(this.minY, y);\n    this.maxX = Math.max(this.maxX, x);\n    this.maxY = Math.max(this.maxY, y);\n  }\n  updateRectMinMax(transform, rect) {\n    const p1 = Util.applyTransform(rect, transform);\n    const p2 = Util.applyTransform(rect.slice(2), transform);\n    const p3 = Util.applyTransform([rect[0], rect[3]], transform);\n    const p4 = Util.applyTransform([rect[2], rect[1]], transform);\n    this.minX = Math.min(this.minX, p1[0], p2[0], p3[0], p4[0]);\n    this.minY = Math.min(this.minY, p1[1], p2[1], p3[1], p4[1]);\n    this.maxX = Math.max(this.maxX, p1[0], p2[0], p3[0], p4[0]);\n    this.maxY = Math.max(this.maxY, p1[1], p2[1], p3[1], p4[1]);\n  }\n  updateScalingPathMinMax(transform, minMax) {\n    Util.scaleMinMax(transform, minMax);\n    this.minX = Math.min(this.minX, minMax[0]);\n    this.minY = Math.min(this.minY, minMax[1]);\n    this.maxX = Math.max(this.maxX, minMax[2]);\n    this.maxY = Math.max(this.maxY, minMax[3]);\n  }\n  updateCurvePathMinMax(transform, x0, y0, x1, y1, x2, y2, x3, y3, minMax) {\n    const box = Util.bezierBoundingBox(x0, y0, x1, y1, x2, y2, x3, y3, minMax);\n    if (minMax) {\n      return;\n    }\n    this.updateRectMinMax(transform, box);\n  }\n  getPathBoundingBox(pathType = PathType.FILL, transform = null) {\n    const box = [this.minX, this.minY, this.maxX, this.maxY];\n    if (pathType === PathType.STROKE) {\n      if (!transform) {\n        unreachable(\"Stroke bounding box must include transform.\");\n      }\n      const scale = Util.singularValueDecompose2dScale(transform);\n      const xStrokePad = scale[0] * this.lineWidth / 2;\n      const yStrokePad = scale[1] * this.lineWidth / 2;\n      box[0] -= xStrokePad;\n      box[1] -= yStrokePad;\n      box[2] += xStrokePad;\n      box[3] += yStrokePad;\n    }\n    return box;\n  }\n  updateClipFromPath() {\n    const intersect = Util.intersect(this.clipBox, this.getPathBoundingBox());\n    this.startNewPathAndClipBox(intersect || [0, 0, 0, 0]);\n  }\n  isEmptyClip() {\n    return this.minX === Infinity;\n  }\n  startNewPathAndClipBox(box) {\n    this.clipBox = box;\n    this.minX = Infinity;\n    this.minY = Infinity;\n    this.maxX = 0;\n    this.maxY = 0;\n  }\n  getClippedPathBoundingBox(pathType = PathType.FILL, transform = null) {\n    return Util.intersect(this.clipBox, this.getPathBoundingBox(pathType, transform));\n  }\n}\nfunction putBinaryImageData(ctx, imgData) {\n  if (typeof ImageData !== \"undefined\" && imgData instanceof ImageData) {\n    ctx.putImageData(imgData, 0, 0);\n    return;\n  }\n  const height = imgData.height,\n    width = imgData.width;\n  const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n  const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n  const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n  const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n  let srcPos = 0,\n    destPos;\n  const src = imgData.data;\n  const dest = chunkImgData.data;\n  let i, j, thisChunkHeight, elemsInThisChunk;\n  if (imgData.kind === util_ImageKind.GRAYSCALE_1BPP) {\n    const srcLength = src.byteLength;\n    const dest32 = new Uint32Array(dest.buffer, 0, dest.byteLength >> 2);\n    const dest32DataLength = dest32.length;\n    const fullSrcDiff = width + 7 >> 3;\n    const white = 0xffffffff;\n    const black = util_FeatureTest.isLittleEndian ? 0xff000000 : 0x000000ff;\n    for (i = 0; i < totalChunks; i++) {\n      thisChunkHeight = i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n      destPos = 0;\n      for (j = 0; j < thisChunkHeight; j++) {\n        const srcDiff = srcLength - srcPos;\n        let k = 0;\n        const kEnd = srcDiff > fullSrcDiff ? width : srcDiff * 8 - 7;\n        const kEndUnrolled = kEnd & ~7;\n        let mask = 0;\n        let srcByte = 0;\n        for (; k < kEndUnrolled; k += 8) {\n          srcByte = src[srcPos++];\n          dest32[destPos++] = srcByte & 128 ? white : black;\n          dest32[destPos++] = srcByte & 64 ? white : black;\n          dest32[destPos++] = srcByte & 32 ? white : black;\n          dest32[destPos++] = srcByte & 16 ? white : black;\n          dest32[destPos++] = srcByte & 8 ? white : black;\n          dest32[destPos++] = srcByte & 4 ? white : black;\n          dest32[destPos++] = srcByte & 2 ? white : black;\n          dest32[destPos++] = srcByte & 1 ? white : black;\n        }\n        for (; k < kEnd; k++) {\n          if (mask === 0) {\n            srcByte = src[srcPos++];\n            mask = 128;\n          }\n          dest32[destPos++] = srcByte & mask ? white : black;\n          mask >>= 1;\n        }\n      }\n      while (destPos < dest32DataLength) {\n        dest32[destPos++] = 0;\n      }\n      ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n    }\n  } else if (imgData.kind === util_ImageKind.RGBA_32BPP) {\n    j = 0;\n    elemsInThisChunk = width * FULL_CHUNK_HEIGHT * 4;\n    for (i = 0; i < fullChunks; i++) {\n      dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n      srcPos += elemsInThisChunk;\n      ctx.putImageData(chunkImgData, 0, j);\n      j += FULL_CHUNK_HEIGHT;\n    }\n    if (i < totalChunks) {\n      elemsInThisChunk = width * partialChunkHeight * 4;\n      dest.set(src.subarray(srcPos, srcPos + elemsInThisChunk));\n      ctx.putImageData(chunkImgData, 0, j);\n    }\n  } else if (imgData.kind === util_ImageKind.RGB_24BPP) {\n    thisChunkHeight = FULL_CHUNK_HEIGHT;\n    elemsInThisChunk = width * thisChunkHeight;\n    for (i = 0; i < totalChunks; i++) {\n      if (i >= fullChunks) {\n        thisChunkHeight = partialChunkHeight;\n        elemsInThisChunk = width * thisChunkHeight;\n      }\n      destPos = 0;\n      for (j = elemsInThisChunk; j--;) {\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = src[srcPos++];\n        dest[destPos++] = 255;\n      }\n      ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n    }\n  } else {\n    throw new Error(`bad image kind: ${imgData.kind}`);\n  }\n}\nfunction putBinaryImageMask(ctx, imgData) {\n  if (imgData.bitmap) {\n    ctx.drawImage(imgData.bitmap, 0, 0);\n    return;\n  }\n  const height = imgData.height,\n    width = imgData.width;\n  const partialChunkHeight = height % FULL_CHUNK_HEIGHT;\n  const fullChunks = (height - partialChunkHeight) / FULL_CHUNK_HEIGHT;\n  const totalChunks = partialChunkHeight === 0 ? fullChunks : fullChunks + 1;\n  const chunkImgData = ctx.createImageData(width, FULL_CHUNK_HEIGHT);\n  let srcPos = 0;\n  const src = imgData.data;\n  const dest = chunkImgData.data;\n  for (let i = 0; i < totalChunks; i++) {\n    const thisChunkHeight = i < fullChunks ? FULL_CHUNK_HEIGHT : partialChunkHeight;\n    ({\n      srcPos\n    } = convertBlackAndWhiteToRGBA({\n      src,\n      srcPos,\n      dest,\n      width,\n      height: thisChunkHeight,\n      nonBlackColor: 0\n    }));\n    ctx.putImageData(chunkImgData, 0, i * FULL_CHUNK_HEIGHT);\n  }\n}\nfunction copyCtxState(sourceCtx, destCtx) {\n  const properties = [\"strokeStyle\", \"fillStyle\", \"fillRule\", \"globalAlpha\", \"lineWidth\", \"lineCap\", \"lineJoin\", \"miterLimit\", \"globalCompositeOperation\", \"font\", \"filter\"];\n  for (const property of properties) {\n    if (sourceCtx[property] !== undefined) {\n      destCtx[property] = sourceCtx[property];\n    }\n  }\n  if (sourceCtx.setLineDash !== undefined) {\n    destCtx.setLineDash(sourceCtx.getLineDash());\n    destCtx.lineDashOffset = sourceCtx.lineDashOffset;\n  }\n}\nfunction resetCtxToDefault(ctx) {\n  ctx.strokeStyle = ctx.fillStyle = \"#000000\";\n  ctx.fillRule = \"nonzero\";\n  ctx.globalAlpha = 1;\n  ctx.lineWidth = 1;\n  ctx.lineCap = \"butt\";\n  ctx.lineJoin = \"miter\";\n  ctx.miterLimit = 10;\n  ctx.globalCompositeOperation = \"source-over\";\n  ctx.font = \"10px sans-serif\";\n  if (ctx.setLineDash !== undefined) {\n    ctx.setLineDash([]);\n    ctx.lineDashOffset = 0;\n  }\n  if (!isNodeJS) {\n    const {\n      filter\n    } = ctx;\n    if (filter !== \"none\" && filter !== \"\") {\n      ctx.filter = \"none\";\n    }\n  }\n}\nfunction getImageSmoothingEnabled(transform, interpolate) {\n  if (interpolate) {\n    return true;\n  }\n  const scale = Util.singularValueDecompose2dScale(transform);\n  scale[0] = Math.fround(scale[0]);\n  scale[1] = Math.fround(scale[1]);\n  const actualScale = Math.fround((globalThis.devicePixelRatio || 1) * PixelsPerInch.PDF_TO_CSS_UNITS);\n  return scale[0] <= actualScale && scale[1] <= actualScale;\n}\nconst LINE_CAP_STYLES = [\"butt\", \"round\", \"square\"];\nconst LINE_JOIN_STYLES = [\"miter\", \"round\", \"bevel\"];\nconst NORMAL_CLIP = {};\nconst EO_CLIP = {};\nclass CanvasGraphics {\n  constructor(canvasCtx, commonObjs, objs, canvasFactory, filterFactory, {\n    optionalContentConfig,\n    markedContentStack = null\n  }, annotationCanvasMap, pageColors) {\n    this.ctx = canvasCtx;\n    this.current = new CanvasExtraState(this.ctx.canvas.width, this.ctx.canvas.height);\n    this.stateStack = [];\n    this.pendingClip = null;\n    this.pendingEOFill = false;\n    this.res = null;\n    this.xobjs = null;\n    this.commonObjs = commonObjs;\n    this.objs = objs;\n    this.canvasFactory = canvasFactory;\n    this.filterFactory = filterFactory;\n    this.groupStack = [];\n    this.processingType3 = null;\n    this.baseTransform = null;\n    this.baseTransformStack = [];\n    this.groupLevel = 0;\n    this.smaskStack = [];\n    this.smaskCounter = 0;\n    this.tempSMask = null;\n    this.suspendedCtx = null;\n    this.contentVisible = true;\n    this.markedContentStack = markedContentStack || [];\n    this.optionalContentConfig = optionalContentConfig;\n    this.cachedCanvases = new CachedCanvases(this.canvasFactory);\n    this.cachedPatterns = new Map();\n    this.annotationCanvasMap = annotationCanvasMap;\n    this.viewportScale = 1;\n    this.outputScaleX = 1;\n    this.outputScaleY = 1;\n    this.pageColors = pageColors;\n    this._cachedScaleForStroking = [-1, 0];\n    this._cachedGetSinglePixelWidth = null;\n    this._cachedBitmapsMap = new Map();\n  }\n  getObject(data, fallback = null) {\n    if (typeof data === \"string\") {\n      return data.startsWith(\"g_\") ? this.commonObjs.get(data) : this.objs.get(data);\n    }\n    return fallback;\n  }\n  beginDrawing({\n    transform,\n    viewport,\n    transparency = false,\n    background = null\n  }) {\n    const width = this.ctx.canvas.width;\n    const height = this.ctx.canvas.height;\n    const savedFillStyle = this.ctx.fillStyle;\n    this.ctx.fillStyle = background || \"#ffffff\";\n    this.ctx.fillRect(0, 0, width, height);\n    this.ctx.fillStyle = savedFillStyle;\n    if (transparency) {\n      const transparentCanvas = this.cachedCanvases.getCanvas(\"transparent\", width, height);\n      this.compositeCtx = this.ctx;\n      this.transparentCanvas = transparentCanvas.canvas;\n      this.ctx = transparentCanvas.context;\n      this.ctx.save();\n      this.ctx.transform(...getCurrentTransform(this.compositeCtx));\n    }\n    this.ctx.save();\n    resetCtxToDefault(this.ctx);\n    if (transform) {\n      this.ctx.transform(...transform);\n      this.outputScaleX = transform[0];\n      this.outputScaleY = transform[0];\n    }\n    this.ctx.transform(...viewport.transform);\n    this.viewportScale = viewport.scale;\n    this.baseTransform = getCurrentTransform(this.ctx);\n  }\n  executeOperatorList(operatorList, executionStartIdx, continueCallback, stepper) {\n    const argsArray = operatorList.argsArray;\n    const fnArray = operatorList.fnArray;\n    let i = executionStartIdx || 0;\n    const argsArrayLen = argsArray.length;\n    if (argsArrayLen === i) {\n      return i;\n    }\n    const chunkOperations = argsArrayLen - i > EXECUTION_STEPS && typeof continueCallback === \"function\";\n    const endTime = chunkOperations ? Date.now() + EXECUTION_TIME : 0;\n    let steps = 0;\n    const commonObjs = this.commonObjs;\n    const objs = this.objs;\n    let fnId;\n    while (true) {\n      if (stepper !== undefined && i === stepper.nextBreakPoint) {\n        stepper.breakIt(i, continueCallback);\n        return i;\n      }\n      fnId = fnArray[i];\n      if (fnId !== OPS.dependency) {\n        this[fnId].apply(this, argsArray[i]);\n      } else {\n        for (const depObjId of argsArray[i]) {\n          const objsPool = depObjId.startsWith(\"g_\") ? commonObjs : objs;\n          if (!objsPool.has(depObjId)) {\n            objsPool.get(depObjId, continueCallback);\n            return i;\n          }\n        }\n      }\n      i++;\n      if (i === argsArrayLen) {\n        return i;\n      }\n      if (chunkOperations && ++steps > EXECUTION_STEPS) {\n        if (Date.now() > endTime) {\n          continueCallback();\n          return i;\n        }\n        steps = 0;\n      }\n    }\n  }\n  #restoreInitialState() {\n    while (this.stateStack.length || this.inSMaskMode) {\n      this.restore();\n    }\n    this.current.activeSMask = null;\n    this.ctx.restore();\n    if (this.transparentCanvas) {\n      this.ctx = this.compositeCtx;\n      this.ctx.save();\n      this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n      this.ctx.drawImage(this.transparentCanvas, 0, 0);\n      this.ctx.restore();\n      this.transparentCanvas = null;\n    }\n  }\n  endDrawing() {\n    this.#restoreInitialState();\n    this.cachedCanvases.clear();\n    this.cachedPatterns.clear();\n    for (const cache of this._cachedBitmapsMap.values()) {\n      for (const canvas of cache.values()) {\n        if (typeof HTMLCanvasElement !== \"undefined\" && canvas instanceof HTMLCanvasElement) {\n          canvas.width = canvas.height = 0;\n        }\n      }\n      cache.clear();\n    }\n    this._cachedBitmapsMap.clear();\n    this.#drawFilter();\n  }\n  #drawFilter() {\n    if (this.pageColors) {\n      const hcmFilterId = this.filterFactory.addHCMFilter(this.pageColors.foreground, this.pageColors.background);\n      if (hcmFilterId !== \"none\") {\n        const savedFilter = this.ctx.filter;\n        this.ctx.filter = hcmFilterId;\n        this.ctx.drawImage(this.ctx.canvas, 0, 0);\n        this.ctx.filter = savedFilter;\n      }\n    }\n  }\n  _scaleImage(img, inverseTransform) {\n    const width = img.width;\n    const height = img.height;\n    let widthScale = Math.max(Math.hypot(inverseTransform[0], inverseTransform[1]), 1);\n    let heightScale = Math.max(Math.hypot(inverseTransform[2], inverseTransform[3]), 1);\n    let paintWidth = width,\n      paintHeight = height;\n    let tmpCanvasId = \"prescale1\";\n    let tmpCanvas, tmpCtx;\n    while (widthScale > 2 && paintWidth > 1 || heightScale > 2 && paintHeight > 1) {\n      let newWidth = paintWidth,\n        newHeight = paintHeight;\n      if (widthScale > 2 && paintWidth > 1) {\n        newWidth = paintWidth >= 16384 ? Math.floor(paintWidth / 2) - 1 || 1 : Math.ceil(paintWidth / 2);\n        widthScale /= paintWidth / newWidth;\n      }\n      if (heightScale > 2 && paintHeight > 1) {\n        newHeight = paintHeight >= 16384 ? Math.floor(paintHeight / 2) - 1 || 1 : Math.ceil(paintHeight) / 2;\n        heightScale /= paintHeight / newHeight;\n      }\n      tmpCanvas = this.cachedCanvases.getCanvas(tmpCanvasId, newWidth, newHeight);\n      tmpCtx = tmpCanvas.context;\n      tmpCtx.clearRect(0, 0, newWidth, newHeight);\n      tmpCtx.drawImage(img, 0, 0, paintWidth, paintHeight, 0, 0, newWidth, newHeight);\n      img = tmpCanvas.canvas;\n      paintWidth = newWidth;\n      paintHeight = newHeight;\n      tmpCanvasId = tmpCanvasId === \"prescale1\" ? \"prescale2\" : \"prescale1\";\n    }\n    return {\n      img,\n      paintWidth,\n      paintHeight\n    };\n  }\n  _createMaskCanvas(img) {\n    const ctx = this.ctx;\n    const {\n      width,\n      height\n    } = img;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n    const currentTransform = getCurrentTransform(ctx);\n    let cache, cacheKey, scaled, maskCanvas;\n    if ((img.bitmap || img.data) && img.count > 1) {\n      const mainKey = img.bitmap || img.data.buffer;\n      cacheKey = JSON.stringify(isPatternFill ? currentTransform : [currentTransform.slice(0, 4), fillColor]);\n      cache = this._cachedBitmapsMap.get(mainKey);\n      if (!cache) {\n        cache = new Map();\n        this._cachedBitmapsMap.set(mainKey, cache);\n      }\n      const cachedImage = cache.get(cacheKey);\n      if (cachedImage && !isPatternFill) {\n        const offsetX = Math.round(Math.min(currentTransform[0], currentTransform[2]) + currentTransform[4]);\n        const offsetY = Math.round(Math.min(currentTransform[1], currentTransform[3]) + currentTransform[5]);\n        return {\n          canvas: cachedImage,\n          offsetX,\n          offsetY\n        };\n      }\n      scaled = cachedImage;\n    }\n    if (!scaled) {\n      maskCanvas = this.cachedCanvases.getCanvas(\"maskCanvas\", width, height);\n      putBinaryImageMask(maskCanvas.context, img);\n    }\n    let maskToCanvas = Util.transform(currentTransform, [1 / width, 0, 0, -1 / height, 0, 0]);\n    maskToCanvas = Util.transform(maskToCanvas, [1, 0, 0, 1, 0, -height]);\n    const [minX, minY, maxX, maxY] = Util.getAxialAlignedBoundingBox([0, 0, width, height], maskToCanvas);\n    const drawnWidth = Math.round(maxX - minX) || 1;\n    const drawnHeight = Math.round(maxY - minY) || 1;\n    const fillCanvas = this.cachedCanvases.getCanvas(\"fillCanvas\", drawnWidth, drawnHeight);\n    const fillCtx = fillCanvas.context;\n    const offsetX = minX;\n    const offsetY = minY;\n    fillCtx.translate(-offsetX, -offsetY);\n    fillCtx.transform(...maskToCanvas);\n    if (!scaled) {\n      scaled = this._scaleImage(maskCanvas.canvas, getCurrentTransformInverse(fillCtx));\n      scaled = scaled.img;\n      if (cache && isPatternFill) {\n        cache.set(cacheKey, scaled);\n      }\n    }\n    fillCtx.imageSmoothingEnabled = getImageSmoothingEnabled(getCurrentTransform(fillCtx), img.interpolate);\n    drawImageAtIntegerCoords(fillCtx, scaled, 0, 0, scaled.width, scaled.height, 0, 0, width, height);\n    fillCtx.globalCompositeOperation = \"source-in\";\n    const inverse = Util.transform(getCurrentTransformInverse(fillCtx), [1, 0, 0, 1, -offsetX, -offsetY]);\n    fillCtx.fillStyle = isPatternFill ? fillColor.getPattern(ctx, this, inverse, PathType.FILL) : fillColor;\n    fillCtx.fillRect(0, 0, width, height);\n    if (cache && !isPatternFill) {\n      this.cachedCanvases.delete(\"fillCanvas\");\n      cache.set(cacheKey, fillCanvas.canvas);\n    }\n    return {\n      canvas: fillCanvas.canvas,\n      offsetX: Math.round(offsetX),\n      offsetY: Math.round(offsetY)\n    };\n  }\n  setLineWidth(width) {\n    if (width !== this.current.lineWidth) {\n      this._cachedScaleForStroking[0] = -1;\n    }\n    this.current.lineWidth = width;\n    this.ctx.lineWidth = width;\n  }\n  setLineCap(style) {\n    this.ctx.lineCap = LINE_CAP_STYLES[style];\n  }\n  setLineJoin(style) {\n    this.ctx.lineJoin = LINE_JOIN_STYLES[style];\n  }\n  setMiterLimit(limit) {\n    this.ctx.miterLimit = limit;\n  }\n  setDash(dashArray, dashPhase) {\n    const ctx = this.ctx;\n    if (ctx.setLineDash !== undefined) {\n      ctx.setLineDash(dashArray);\n      ctx.lineDashOffset = dashPhase;\n    }\n  }\n  setRenderingIntent(intent) {}\n  setFlatness(flatness) {}\n  setGState(states) {\n    for (const [key, value] of states) {\n      switch (key) {\n        case \"LW\":\n          this.setLineWidth(value);\n          break;\n        case \"LC\":\n          this.setLineCap(value);\n          break;\n        case \"LJ\":\n          this.setLineJoin(value);\n          break;\n        case \"ML\":\n          this.setMiterLimit(value);\n          break;\n        case \"D\":\n          this.setDash(value[0], value[1]);\n          break;\n        case \"RI\":\n          this.setRenderingIntent(value);\n          break;\n        case \"FL\":\n          this.setFlatness(value);\n          break;\n        case \"Font\":\n          this.setFont(value[0], value[1]);\n          break;\n        case \"CA\":\n          this.current.strokeAlpha = value;\n          break;\n        case \"ca\":\n          this.current.fillAlpha = value;\n          this.ctx.globalAlpha = value;\n          break;\n        case \"BM\":\n          this.ctx.globalCompositeOperation = value;\n          break;\n        case \"SMask\":\n          this.current.activeSMask = value ? this.tempSMask : null;\n          this.tempSMask = null;\n          this.checkSMaskState();\n          break;\n        case \"TR\":\n          this.ctx.filter = this.current.transferMaps = this.filterFactory.addFilter(value);\n          break;\n      }\n    }\n  }\n  get inSMaskMode() {\n    return !!this.suspendedCtx;\n  }\n  checkSMaskState() {\n    const inSMaskMode = this.inSMaskMode;\n    if (this.current.activeSMask && !inSMaskMode) {\n      this.beginSMaskMode();\n    } else if (!this.current.activeSMask && inSMaskMode) {\n      this.endSMaskMode();\n    }\n  }\n  beginSMaskMode() {\n    if (this.inSMaskMode) {\n      throw new Error(\"beginSMaskMode called while already in smask mode\");\n    }\n    const drawnWidth = this.ctx.canvas.width;\n    const drawnHeight = this.ctx.canvas.height;\n    const cacheId = \"smaskGroupAt\" + this.groupLevel;\n    const scratchCanvas = this.cachedCanvases.getCanvas(cacheId, drawnWidth, drawnHeight);\n    this.suspendedCtx = this.ctx;\n    this.ctx = scratchCanvas.context;\n    const ctx = this.ctx;\n    ctx.setTransform(...getCurrentTransform(this.suspendedCtx));\n    copyCtxState(this.suspendedCtx, ctx);\n    mirrorContextOperations(ctx, this.suspendedCtx);\n    this.setGState([[\"BM\", \"source-over\"], [\"ca\", 1], [\"CA\", 1]]);\n  }\n  endSMaskMode() {\n    if (!this.inSMaskMode) {\n      throw new Error(\"endSMaskMode called while not in smask mode\");\n    }\n    this.ctx._removeMirroring();\n    copyCtxState(this.ctx, this.suspendedCtx);\n    this.ctx = this.suspendedCtx;\n    this.suspendedCtx = null;\n  }\n  compose(dirtyBox) {\n    if (!this.current.activeSMask) {\n      return;\n    }\n    if (!dirtyBox) {\n      dirtyBox = [0, 0, this.ctx.canvas.width, this.ctx.canvas.height];\n    } else {\n      dirtyBox[0] = Math.floor(dirtyBox[0]);\n      dirtyBox[1] = Math.floor(dirtyBox[1]);\n      dirtyBox[2] = Math.ceil(dirtyBox[2]);\n      dirtyBox[3] = Math.ceil(dirtyBox[3]);\n    }\n    const smask = this.current.activeSMask;\n    const suspendedCtx = this.suspendedCtx;\n    this.composeSMask(suspendedCtx, smask, this.ctx, dirtyBox);\n    this.ctx.save();\n    this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n    this.ctx.restore();\n  }\n  composeSMask(ctx, smask, layerCtx, layerBox) {\n    const layerOffsetX = layerBox[0];\n    const layerOffsetY = layerBox[1];\n    const layerWidth = layerBox[2] - layerOffsetX;\n    const layerHeight = layerBox[3] - layerOffsetY;\n    if (layerWidth === 0 || layerHeight === 0) {\n      return;\n    }\n    this.genericComposeSMask(smask.context, layerCtx, layerWidth, layerHeight, smask.subtype, smask.backdrop, smask.transferMap, layerOffsetX, layerOffsetY, smask.offsetX, smask.offsetY);\n    ctx.save();\n    ctx.globalAlpha = 1;\n    ctx.globalCompositeOperation = \"source-over\";\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.drawImage(layerCtx.canvas, 0, 0);\n    ctx.restore();\n  }\n  genericComposeSMask(maskCtx, layerCtx, width, height, subtype, backdrop, transferMap, layerOffsetX, layerOffsetY, maskOffsetX, maskOffsetY) {\n    let maskCanvas = maskCtx.canvas;\n    let maskX = layerOffsetX - maskOffsetX;\n    let maskY = layerOffsetY - maskOffsetY;\n    if (backdrop) {\n      if (maskX < 0 || maskY < 0 || maskX + width > maskCanvas.width || maskY + height > maskCanvas.height) {\n        const canvas = this.cachedCanvases.getCanvas(\"maskExtension\", width, height);\n        const ctx = canvas.context;\n        ctx.drawImage(maskCanvas, -maskX, -maskY);\n        if (backdrop.some(c => c !== 0)) {\n          ctx.globalCompositeOperation = \"destination-atop\";\n          ctx.fillStyle = Util.makeHexColor(...backdrop);\n          ctx.fillRect(0, 0, width, height);\n          ctx.globalCompositeOperation = \"source-over\";\n        }\n        maskCanvas = canvas.canvas;\n        maskX = maskY = 0;\n      } else if (backdrop.some(c => c !== 0)) {\n        maskCtx.save();\n        maskCtx.globalAlpha = 1;\n        maskCtx.setTransform(1, 0, 0, 1, 0, 0);\n        const clip = new Path2D();\n        clip.rect(maskX, maskY, width, height);\n        maskCtx.clip(clip);\n        maskCtx.globalCompositeOperation = \"destination-atop\";\n        maskCtx.fillStyle = Util.makeHexColor(...backdrop);\n        maskCtx.fillRect(maskX, maskY, width, height);\n        maskCtx.restore();\n      }\n    }\n    layerCtx.save();\n    layerCtx.globalAlpha = 1;\n    layerCtx.setTransform(1, 0, 0, 1, 0, 0);\n    if (subtype === \"Alpha\" && transferMap) {\n      layerCtx.filter = this.filterFactory.addAlphaFilter(transferMap);\n    } else if (subtype === \"Luminosity\") {\n      layerCtx.filter = this.filterFactory.addLuminosityFilter(transferMap);\n    }\n    const clip = new Path2D();\n    clip.rect(layerOffsetX, layerOffsetY, width, height);\n    layerCtx.clip(clip);\n    layerCtx.globalCompositeOperation = \"destination-in\";\n    layerCtx.drawImage(maskCanvas, maskX, maskY, width, height, layerOffsetX, layerOffsetY, width, height);\n    layerCtx.restore();\n  }\n  save() {\n    if (this.inSMaskMode) {\n      copyCtxState(this.ctx, this.suspendedCtx);\n      this.suspendedCtx.save();\n    } else {\n      this.ctx.save();\n    }\n    const old = this.current;\n    this.stateStack.push(old);\n    this.current = old.clone();\n  }\n  restore() {\n    if (this.stateStack.length === 0 && this.inSMaskMode) {\n      this.endSMaskMode();\n    }\n    if (this.stateStack.length !== 0) {\n      this.current = this.stateStack.pop();\n      if (this.inSMaskMode) {\n        this.suspendedCtx.restore();\n        copyCtxState(this.suspendedCtx, this.ctx);\n      } else {\n        this.ctx.restore();\n      }\n      this.checkSMaskState();\n      this.pendingClip = null;\n      this._cachedScaleForStroking[0] = -1;\n      this._cachedGetSinglePixelWidth = null;\n    }\n  }\n  transform(a, b, c, d, e, f) {\n    this.ctx.transform(a, b, c, d, e, f);\n    this._cachedScaleForStroking[0] = -1;\n    this._cachedGetSinglePixelWidth = null;\n  }\n  constructPath(ops, args, minMax) {\n    const ctx = this.ctx;\n    const current = this.current;\n    let x = current.x,\n      y = current.y;\n    let startX, startY;\n    const currentTransform = getCurrentTransform(ctx);\n    const isScalingMatrix = currentTransform[0] === 0 && currentTransform[3] === 0 || currentTransform[1] === 0 && currentTransform[2] === 0;\n    const minMaxForBezier = isScalingMatrix ? minMax.slice(0) : null;\n    for (let i = 0, j = 0, ii = ops.length; i < ii; i++) {\n      switch (ops[i] | 0) {\n        case OPS.rectangle:\n          x = args[j++];\n          y = args[j++];\n          const width = args[j++];\n          const height = args[j++];\n          const xw = x + width;\n          const yh = y + height;\n          ctx.moveTo(x, y);\n          if (width === 0 || height === 0) {\n            ctx.lineTo(xw, yh);\n          } else {\n            ctx.lineTo(xw, y);\n            ctx.lineTo(xw, yh);\n            ctx.lineTo(x, yh);\n          }\n          if (!isScalingMatrix) {\n            current.updateRectMinMax(currentTransform, [x, y, xw, yh]);\n          }\n          ctx.closePath();\n          break;\n        case OPS.moveTo:\n          x = args[j++];\n          y = args[j++];\n          ctx.moveTo(x, y);\n          if (!isScalingMatrix) {\n            current.updatePathMinMax(currentTransform, x, y);\n          }\n          break;\n        case OPS.lineTo:\n          x = args[j++];\n          y = args[j++];\n          ctx.lineTo(x, y);\n          if (!isScalingMatrix) {\n            current.updatePathMinMax(currentTransform, x, y);\n          }\n          break;\n        case OPS.curveTo:\n          startX = x;\n          startY = y;\n          x = args[j + 4];\n          y = args[j + 5];\n          ctx.bezierCurveTo(args[j], args[j + 1], args[j + 2], args[j + 3], x, y);\n          current.updateCurvePathMinMax(currentTransform, startX, startY, args[j], args[j + 1], args[j + 2], args[j + 3], x, y, minMaxForBezier);\n          j += 6;\n          break;\n        case OPS.curveTo2:\n          startX = x;\n          startY = y;\n          ctx.bezierCurveTo(x, y, args[j], args[j + 1], args[j + 2], args[j + 3]);\n          current.updateCurvePathMinMax(currentTransform, startX, startY, x, y, args[j], args[j + 1], args[j + 2], args[j + 3], minMaxForBezier);\n          x = args[j + 2];\n          y = args[j + 3];\n          j += 4;\n          break;\n        case OPS.curveTo3:\n          startX = x;\n          startY = y;\n          x = args[j + 2];\n          y = args[j + 3];\n          ctx.bezierCurveTo(args[j], args[j + 1], x, y, x, y);\n          current.updateCurvePathMinMax(currentTransform, startX, startY, args[j], args[j + 1], x, y, x, y, minMaxForBezier);\n          j += 4;\n          break;\n        case OPS.closePath:\n          ctx.closePath();\n          break;\n      }\n    }\n    if (isScalingMatrix) {\n      current.updateScalingPathMinMax(currentTransform, minMaxForBezier);\n    }\n    current.setCurrentPoint(x, y);\n  }\n  closePath() {\n    this.ctx.closePath();\n  }\n  stroke(consumePath = true) {\n    const ctx = this.ctx;\n    const strokeColor = this.current.strokeColor;\n    ctx.globalAlpha = this.current.strokeAlpha;\n    if (this.contentVisible) {\n      if (typeof strokeColor === \"object\" && strokeColor?.getPattern) {\n        ctx.save();\n        ctx.strokeStyle = strokeColor.getPattern(ctx, this, getCurrentTransformInverse(ctx), PathType.STROKE);\n        this.rescaleAndStroke(false);\n        ctx.restore();\n      } else {\n        this.rescaleAndStroke(true);\n      }\n    }\n    if (consumePath) {\n      this.consumePath(this.current.getClippedPathBoundingBox());\n    }\n    ctx.globalAlpha = this.current.fillAlpha;\n  }\n  closeStroke() {\n    this.closePath();\n    this.stroke();\n  }\n  fill(consumePath = true) {\n    const ctx = this.ctx;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n    let needRestore = false;\n    if (isPatternFill) {\n      ctx.save();\n      ctx.fillStyle = fillColor.getPattern(ctx, this, getCurrentTransformInverse(ctx), PathType.FILL);\n      needRestore = true;\n    }\n    const intersect = this.current.getClippedPathBoundingBox();\n    if (this.contentVisible && intersect !== null) {\n      if (this.pendingEOFill) {\n        ctx.fill(\"evenodd\");\n        this.pendingEOFill = false;\n      } else {\n        ctx.fill();\n      }\n    }\n    if (needRestore) {\n      ctx.restore();\n    }\n    if (consumePath) {\n      this.consumePath(intersect);\n    }\n  }\n  eoFill() {\n    this.pendingEOFill = true;\n    this.fill();\n  }\n  fillStroke() {\n    this.fill(false);\n    this.stroke(false);\n    this.consumePath();\n  }\n  eoFillStroke() {\n    this.pendingEOFill = true;\n    this.fillStroke();\n  }\n  closeFillStroke() {\n    this.closePath();\n    this.fillStroke();\n  }\n  closeEOFillStroke() {\n    this.pendingEOFill = true;\n    this.closePath();\n    this.fillStroke();\n  }\n  endPath() {\n    this.consumePath();\n  }\n  clip() {\n    this.pendingClip = NORMAL_CLIP;\n  }\n  eoClip() {\n    this.pendingClip = EO_CLIP;\n  }\n  beginText() {\n    this.current.textMatrix = IDENTITY_MATRIX;\n    this.current.textMatrixScale = 1;\n    this.current.x = this.current.lineX = 0;\n    this.current.y = this.current.lineY = 0;\n  }\n  endText() {\n    const paths = this.pendingTextPaths;\n    const ctx = this.ctx;\n    if (paths === undefined) {\n      ctx.beginPath();\n      return;\n    }\n    ctx.save();\n    ctx.beginPath();\n    for (const path of paths) {\n      ctx.setTransform(...path.transform);\n      ctx.translate(path.x, path.y);\n      path.addToPath(ctx, path.fontSize);\n    }\n    ctx.restore();\n    ctx.clip();\n    ctx.beginPath();\n    delete this.pendingTextPaths;\n  }\n  setCharSpacing(spacing) {\n    this.current.charSpacing = spacing;\n  }\n  setWordSpacing(spacing) {\n    this.current.wordSpacing = spacing;\n  }\n  setHScale(scale) {\n    this.current.textHScale = scale / 100;\n  }\n  setLeading(leading) {\n    this.current.leading = -leading;\n  }\n  setFont(fontRefName, size) {\n    const fontObj = this.commonObjs.get(fontRefName);\n    const current = this.current;\n    if (!fontObj) {\n      throw new Error(`Can't find font for ${fontRefName}`);\n    }\n    current.fontMatrix = fontObj.fontMatrix || FONT_IDENTITY_MATRIX;\n    if (current.fontMatrix[0] === 0 || current.fontMatrix[3] === 0) {\n      warn(\"Invalid font matrix for font \" + fontRefName);\n    }\n    if (size < 0) {\n      size = -size;\n      current.fontDirection = -1;\n    } else {\n      current.fontDirection = 1;\n    }\n    this.current.font = fontObj;\n    this.current.fontSize = size;\n    if (fontObj.isType3Font) {\n      return;\n    }\n    const name = fontObj.loadedName || \"sans-serif\";\n    const typeface = fontObj.systemFontInfo?.css || `\"${name}\", ${fontObj.fallbackName}`;\n    let bold = \"normal\";\n    if (fontObj.black) {\n      bold = \"900\";\n    } else if (fontObj.bold) {\n      bold = \"bold\";\n    }\n    const italic = fontObj.italic ? \"italic\" : \"normal\";\n    let browserFontSize = size;\n    if (size < MIN_FONT_SIZE) {\n      browserFontSize = MIN_FONT_SIZE;\n    } else if (size > MAX_FONT_SIZE) {\n      browserFontSize = MAX_FONT_SIZE;\n    }\n    this.current.fontSizeScale = size / browserFontSize;\n    this.ctx.font = `${italic} ${bold} ${browserFontSize}px ${typeface}`;\n  }\n  setTextRenderingMode(mode) {\n    this.current.textRenderingMode = mode;\n  }\n  setTextRise(rise) {\n    this.current.textRise = rise;\n  }\n  moveText(x, y) {\n    this.current.x = this.current.lineX += x;\n    this.current.y = this.current.lineY += y;\n  }\n  setLeadingMoveText(x, y) {\n    this.setLeading(-y);\n    this.moveText(x, y);\n  }\n  setTextMatrix(a, b, c, d, e, f) {\n    this.current.textMatrix = [a, b, c, d, e, f];\n    this.current.textMatrixScale = Math.hypot(a, b);\n    this.current.x = this.current.lineX = 0;\n    this.current.y = this.current.lineY = 0;\n  }\n  nextLine() {\n    this.moveText(0, this.current.leading);\n  }\n  paintChar(character, x, y, patternTransform) {\n    const ctx = this.ctx;\n    const current = this.current;\n    const font = current.font;\n    const textRenderingMode = current.textRenderingMode;\n    const fontSize = current.fontSize / current.fontSizeScale;\n    const fillStrokeMode = textRenderingMode & TextRenderingMode.FILL_STROKE_MASK;\n    const isAddToPathSet = !!(textRenderingMode & TextRenderingMode.ADD_TO_PATH_FLAG);\n    const patternFill = current.patternFill && !font.missingFile;\n    let addToPath;\n    if (font.disableFontFace || isAddToPathSet || patternFill) {\n      addToPath = font.getPathGenerator(this.commonObjs, character);\n    }\n    if (font.disableFontFace || patternFill) {\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.beginPath();\n      addToPath(ctx, fontSize);\n      if (patternTransform) {\n        ctx.setTransform(...patternTransform);\n      }\n      if (fillStrokeMode === TextRenderingMode.FILL || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        ctx.fill();\n      }\n      if (fillStrokeMode === TextRenderingMode.STROKE || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        ctx.stroke();\n      }\n      ctx.restore();\n    } else {\n      if (fillStrokeMode === TextRenderingMode.FILL || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        ctx.fillText(character, x, y);\n      }\n      if (fillStrokeMode === TextRenderingMode.STROKE || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        ctx.strokeText(character, x, y);\n      }\n    }\n    if (isAddToPathSet) {\n      const paths = this.pendingTextPaths ||= [];\n      paths.push({\n        transform: getCurrentTransform(ctx),\n        x,\n        y,\n        fontSize,\n        addToPath\n      });\n    }\n  }\n  get isFontSubpixelAAEnabled() {\n    const {\n      context: ctx\n    } = this.cachedCanvases.getCanvas(\"isFontSubpixelAAEnabled\", 10, 10);\n    ctx.scale(1.5, 1);\n    ctx.fillText(\"I\", 0, 10);\n    const data = ctx.getImageData(0, 0, 10, 10).data;\n    let enabled = false;\n    for (let i = 3; i < data.length; i += 4) {\n      if (data[i] > 0 && data[i] < 255) {\n        enabled = true;\n        break;\n      }\n    }\n    return shadow(this, \"isFontSubpixelAAEnabled\", enabled);\n  }\n  showText(glyphs) {\n    const current = this.current;\n    const font = current.font;\n    if (font.isType3Font) {\n      return this.showType3Text(glyphs);\n    }\n    const fontSize = current.fontSize;\n    if (fontSize === 0) {\n      return undefined;\n    }\n    const ctx = this.ctx;\n    const fontSizeScale = current.fontSizeScale;\n    const charSpacing = current.charSpacing;\n    const wordSpacing = current.wordSpacing;\n    const fontDirection = current.fontDirection;\n    const textHScale = current.textHScale * fontDirection;\n    const glyphsLength = glyphs.length;\n    const vertical = font.vertical;\n    const spacingDir = vertical ? 1 : -1;\n    const defaultVMetrics = font.defaultVMetrics;\n    const widthAdvanceScale = fontSize * current.fontMatrix[0];\n    const simpleFillText = current.textRenderingMode === TextRenderingMode.FILL && !font.disableFontFace && !current.patternFill;\n    ctx.save();\n    ctx.transform(...current.textMatrix);\n    ctx.translate(current.x, current.y + current.textRise);\n    if (fontDirection > 0) {\n      ctx.scale(textHScale, -1);\n    } else {\n      ctx.scale(textHScale, 1);\n    }\n    let patternTransform;\n    if (current.patternFill) {\n      ctx.save();\n      const pattern = current.fillColor.getPattern(ctx, this, getCurrentTransformInverse(ctx), PathType.FILL);\n      patternTransform = getCurrentTransform(ctx);\n      ctx.restore();\n      ctx.fillStyle = pattern;\n    }\n    let lineWidth = current.lineWidth;\n    const scale = current.textMatrixScale;\n    if (scale === 0 || lineWidth === 0) {\n      const fillStrokeMode = current.textRenderingMode & TextRenderingMode.FILL_STROKE_MASK;\n      if (fillStrokeMode === TextRenderingMode.STROKE || fillStrokeMode === TextRenderingMode.FILL_STROKE) {\n        lineWidth = this.getSinglePixelWidth();\n      }\n    } else {\n      lineWidth /= scale;\n    }\n    if (fontSizeScale !== 1.0) {\n      ctx.scale(fontSizeScale, fontSizeScale);\n      lineWidth /= fontSizeScale;\n    }\n    ctx.lineWidth = lineWidth;\n    if (font.isInvalidPDFjsFont) {\n      const chars = [];\n      let width = 0;\n      for (const glyph of glyphs) {\n        chars.push(glyph.unicode);\n        width += glyph.width;\n      }\n      ctx.fillText(chars.join(\"\"), 0, 0);\n      current.x += width * widthAdvanceScale * textHScale;\n      ctx.restore();\n      this.compose();\n      return undefined;\n    }\n    let x = 0,\n      i;\n    for (i = 0; i < glyphsLength; ++i) {\n      const glyph = glyphs[i];\n      if (typeof glyph === \"number\") {\n        x += spacingDir * glyph * fontSize / 1000;\n        continue;\n      }\n      let restoreNeeded = false;\n      const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n      const character = glyph.fontChar;\n      const accent = glyph.accent;\n      let scaledX, scaledY;\n      let width = glyph.width;\n      if (vertical) {\n        const vmetric = glyph.vmetric || defaultVMetrics;\n        const vx = -(glyph.vmetric ? vmetric[1] : width * 0.5) * widthAdvanceScale;\n        const vy = vmetric[2] * widthAdvanceScale;\n        width = vmetric ? -vmetric[0] : width;\n        scaledX = vx / fontSizeScale;\n        scaledY = (x + vy) / fontSizeScale;\n      } else {\n        scaledX = x / fontSizeScale;\n        scaledY = 0;\n      }\n      if (font.remeasure && width > 0) {\n        const measuredWidth = ctx.measureText(character).width * 1000 / fontSize * fontSizeScale;\n        if (width < measuredWidth && this.isFontSubpixelAAEnabled) {\n          const characterScaleX = width / measuredWidth;\n          restoreNeeded = true;\n          ctx.save();\n          ctx.scale(characterScaleX, 1);\n          scaledX /= characterScaleX;\n        } else if (width !== measuredWidth) {\n          scaledX += (width - measuredWidth) / 2000 * fontSize / fontSizeScale;\n        }\n      }\n      if (this.contentVisible && (glyph.isInFont || font.missingFile)) {\n        if (simpleFillText && !accent) {\n          ctx.fillText(character, scaledX, scaledY);\n        } else {\n          this.paintChar(character, scaledX, scaledY, patternTransform);\n          if (accent) {\n            const scaledAccentX = scaledX + fontSize * accent.offset.x / fontSizeScale;\n            const scaledAccentY = scaledY - fontSize * accent.offset.y / fontSizeScale;\n            this.paintChar(accent.fontChar, scaledAccentX, scaledAccentY, patternTransform);\n          }\n        }\n      }\n      const charWidth = vertical ? width * widthAdvanceScale - spacing * fontDirection : width * widthAdvanceScale + spacing * fontDirection;\n      x += charWidth;\n      if (restoreNeeded) {\n        ctx.restore();\n      }\n    }\n    if (vertical) {\n      current.y -= x;\n    } else {\n      current.x += x * textHScale;\n    }\n    ctx.restore();\n    this.compose();\n    return undefined;\n  }\n  showType3Text(glyphs) {\n    const ctx = this.ctx;\n    const current = this.current;\n    const font = current.font;\n    const fontSize = current.fontSize;\n    const fontDirection = current.fontDirection;\n    const spacingDir = font.vertical ? 1 : -1;\n    const charSpacing = current.charSpacing;\n    const wordSpacing = current.wordSpacing;\n    const textHScale = current.textHScale * fontDirection;\n    const fontMatrix = current.fontMatrix || FONT_IDENTITY_MATRIX;\n    const glyphsLength = glyphs.length;\n    const isTextInvisible = current.textRenderingMode === TextRenderingMode.INVISIBLE;\n    let i, glyph, width, spacingLength;\n    if (isTextInvisible || fontSize === 0) {\n      return;\n    }\n    this._cachedScaleForStroking[0] = -1;\n    this._cachedGetSinglePixelWidth = null;\n    ctx.save();\n    ctx.transform(...current.textMatrix);\n    ctx.translate(current.x, current.y);\n    ctx.scale(textHScale, fontDirection);\n    for (i = 0; i < glyphsLength; ++i) {\n      glyph = glyphs[i];\n      if (typeof glyph === \"number\") {\n        spacingLength = spacingDir * glyph * fontSize / 1000;\n        this.ctx.translate(spacingLength, 0);\n        current.x += spacingLength * textHScale;\n        continue;\n      }\n      const spacing = (glyph.isSpace ? wordSpacing : 0) + charSpacing;\n      const operatorList = font.charProcOperatorList[glyph.operatorListId];\n      if (!operatorList) {\n        warn(`Type3 character \"${glyph.operatorListId}\" is not available.`);\n        continue;\n      }\n      if (this.contentVisible) {\n        this.processingType3 = glyph;\n        this.save();\n        ctx.scale(fontSize, fontSize);\n        ctx.transform(...fontMatrix);\n        this.executeOperatorList(operatorList);\n        this.restore();\n      }\n      const transformed = Util.applyTransform([glyph.width, 0], fontMatrix);\n      width = transformed[0] * fontSize + spacing;\n      ctx.translate(width, 0);\n      current.x += width * textHScale;\n    }\n    ctx.restore();\n    this.processingType3 = null;\n  }\n  setCharWidth(xWidth, yWidth) {}\n  setCharWidthAndBounds(xWidth, yWidth, llx, lly, urx, ury) {\n    this.ctx.rect(llx, lly, urx - llx, ury - lly);\n    this.ctx.clip();\n    this.endPath();\n  }\n  getColorN_Pattern(IR) {\n    let pattern;\n    if (IR[0] === \"TilingPattern\") {\n      const color = IR[1];\n      const baseTransform = this.baseTransform || getCurrentTransform(this.ctx);\n      const canvasGraphicsFactory = {\n        createCanvasGraphics: ctx => new CanvasGraphics(ctx, this.commonObjs, this.objs, this.canvasFactory, this.filterFactory, {\n          optionalContentConfig: this.optionalContentConfig,\n          markedContentStack: this.markedContentStack\n        })\n      };\n      pattern = new TilingPattern(IR, color, this.ctx, canvasGraphicsFactory, baseTransform);\n    } else {\n      pattern = this._getPattern(IR[1], IR[2]);\n    }\n    return pattern;\n  }\n  setStrokeColorN() {\n    this.current.strokeColor = this.getColorN_Pattern(arguments);\n  }\n  setFillColorN() {\n    this.current.fillColor = this.getColorN_Pattern(arguments);\n    this.current.patternFill = true;\n  }\n  setStrokeRGBColor(r, g, b) {\n    this.ctx.strokeStyle = this.current.strokeColor = Util.makeHexColor(r, g, b);\n  }\n  setStrokeTransparent() {\n    this.ctx.strokeStyle = this.current.strokeColor = \"transparent\";\n  }\n  setFillRGBColor(r, g, b) {\n    this.ctx.fillStyle = this.current.fillColor = Util.makeHexColor(r, g, b);\n    this.current.patternFill = false;\n  }\n  setFillTransparent() {\n    this.ctx.fillStyle = this.current.fillColor = \"transparent\";\n    this.current.patternFill = false;\n  }\n  _getPattern(objId, matrix = null) {\n    let pattern;\n    if (this.cachedPatterns.has(objId)) {\n      pattern = this.cachedPatterns.get(objId);\n    } else {\n      pattern = getShadingPattern(this.getObject(objId));\n      this.cachedPatterns.set(objId, pattern);\n    }\n    if (matrix) {\n      pattern.matrix = matrix;\n    }\n    return pattern;\n  }\n  shadingFill(objId) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const ctx = this.ctx;\n    this.save();\n    const pattern = this._getPattern(objId);\n    ctx.fillStyle = pattern.getPattern(ctx, this, getCurrentTransformInverse(ctx), PathType.SHADING);\n    const inv = getCurrentTransformInverse(ctx);\n    if (inv) {\n      const {\n        width,\n        height\n      } = ctx.canvas;\n      const [x0, y0, x1, y1] = Util.getAxialAlignedBoundingBox([0, 0, width, height], inv);\n      this.ctx.fillRect(x0, y0, x1 - x0, y1 - y0);\n    } else {\n      this.ctx.fillRect(-1e10, -1e10, 2e10, 2e10);\n    }\n    this.compose(this.current.getClippedPathBoundingBox());\n    this.restore();\n  }\n  beginInlineImage() {\n    unreachable(\"Should not call beginInlineImage\");\n  }\n  beginImageData() {\n    unreachable(\"Should not call beginImageData\");\n  }\n  paintFormXObjectBegin(matrix, bbox) {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.save();\n    this.baseTransformStack.push(this.baseTransform);\n    if (matrix) {\n      this.transform(...matrix);\n    }\n    this.baseTransform = getCurrentTransform(this.ctx);\n    if (bbox) {\n      const width = bbox[2] - bbox[0];\n      const height = bbox[3] - bbox[1];\n      this.ctx.rect(bbox[0], bbox[1], width, height);\n      this.current.updateRectMinMax(getCurrentTransform(this.ctx), bbox);\n      this.clip();\n      this.endPath();\n    }\n  }\n  paintFormXObjectEnd() {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.restore();\n    this.baseTransform = this.baseTransformStack.pop();\n  }\n  beginGroup(group) {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.save();\n    if (this.inSMaskMode) {\n      this.endSMaskMode();\n      this.current.activeSMask = null;\n    }\n    const currentCtx = this.ctx;\n    if (!group.isolated) {\n      info(\"TODO: Support non-isolated groups.\");\n    }\n    if (group.knockout) {\n      warn(\"Knockout groups not supported.\");\n    }\n    const currentTransform = getCurrentTransform(currentCtx);\n    if (group.matrix) {\n      currentCtx.transform(...group.matrix);\n    }\n    if (!group.bbox) {\n      throw new Error(\"Bounding box is required.\");\n    }\n    let bounds = Util.getAxialAlignedBoundingBox(group.bbox, getCurrentTransform(currentCtx));\n    const canvasBounds = [0, 0, currentCtx.canvas.width, currentCtx.canvas.height];\n    bounds = Util.intersect(bounds, canvasBounds) || [0, 0, 0, 0];\n    const offsetX = Math.floor(bounds[0]);\n    const offsetY = Math.floor(bounds[1]);\n    const drawnWidth = Math.max(Math.ceil(bounds[2]) - offsetX, 1);\n    const drawnHeight = Math.max(Math.ceil(bounds[3]) - offsetY, 1);\n    this.current.startNewPathAndClipBox([0, 0, drawnWidth, drawnHeight]);\n    let cacheId = \"groupAt\" + this.groupLevel;\n    if (group.smask) {\n      cacheId += \"_smask_\" + this.smaskCounter++ % 2;\n    }\n    const scratchCanvas = this.cachedCanvases.getCanvas(cacheId, drawnWidth, drawnHeight);\n    const groupCtx = scratchCanvas.context;\n    groupCtx.translate(-offsetX, -offsetY);\n    groupCtx.transform(...currentTransform);\n    if (group.smask) {\n      this.smaskStack.push({\n        canvas: scratchCanvas.canvas,\n        context: groupCtx,\n        offsetX,\n        offsetY,\n        subtype: group.smask.subtype,\n        backdrop: group.smask.backdrop,\n        transferMap: group.smask.transferMap || null,\n        startTransformInverse: null\n      });\n    } else {\n      currentCtx.setTransform(1, 0, 0, 1, 0, 0);\n      currentCtx.translate(offsetX, offsetY);\n      currentCtx.save();\n    }\n    copyCtxState(currentCtx, groupCtx);\n    this.ctx = groupCtx;\n    this.setGState([[\"BM\", \"source-over\"], [\"ca\", 1], [\"CA\", 1]]);\n    this.groupStack.push(currentCtx);\n    this.groupLevel++;\n  }\n  endGroup(group) {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.groupLevel--;\n    const groupCtx = this.ctx;\n    const ctx = this.groupStack.pop();\n    this.ctx = ctx;\n    this.ctx.imageSmoothingEnabled = false;\n    if (group.smask) {\n      this.tempSMask = this.smaskStack.pop();\n      this.restore();\n    } else {\n      this.ctx.restore();\n      const currentMtx = getCurrentTransform(this.ctx);\n      this.restore();\n      this.ctx.save();\n      this.ctx.setTransform(...currentMtx);\n      const dirtyBox = Util.getAxialAlignedBoundingBox([0, 0, groupCtx.canvas.width, groupCtx.canvas.height], currentMtx);\n      this.ctx.drawImage(groupCtx.canvas, 0, 0);\n      this.ctx.restore();\n      this.compose(dirtyBox);\n    }\n  }\n  beginAnnotation(id, rect, transform, matrix, hasOwnCanvas) {\n    this.#restoreInitialState();\n    resetCtxToDefault(this.ctx);\n    this.ctx.save();\n    this.save();\n    if (this.baseTransform) {\n      this.ctx.setTransform(...this.baseTransform);\n    }\n    if (rect) {\n      const width = rect[2] - rect[0];\n      const height = rect[3] - rect[1];\n      if (hasOwnCanvas && this.annotationCanvasMap) {\n        transform = transform.slice();\n        transform[4] -= rect[0];\n        transform[5] -= rect[1];\n        rect = rect.slice();\n        rect[0] = rect[1] = 0;\n        rect[2] = width;\n        rect[3] = height;\n        const [scaleX, scaleY] = Util.singularValueDecompose2dScale(getCurrentTransform(this.ctx));\n        const {\n          viewportScale\n        } = this;\n        const canvasWidth = Math.ceil(width * this.outputScaleX * viewportScale);\n        const canvasHeight = Math.ceil(height * this.outputScaleY * viewportScale);\n        this.annotationCanvas = this.canvasFactory.create(canvasWidth, canvasHeight);\n        const {\n          canvas,\n          context\n        } = this.annotationCanvas;\n        this.annotationCanvasMap.set(id, canvas);\n        this.annotationCanvas.savedCtx = this.ctx;\n        this.ctx = context;\n        this.ctx.save();\n        this.ctx.setTransform(scaleX, 0, 0, -scaleY, 0, height * scaleY);\n        resetCtxToDefault(this.ctx);\n      } else {\n        resetCtxToDefault(this.ctx);\n        this.ctx.rect(rect[0], rect[1], width, height);\n        this.ctx.clip();\n        this.endPath();\n      }\n    }\n    this.current = new CanvasExtraState(this.ctx.canvas.width, this.ctx.canvas.height);\n    this.transform(...transform);\n    this.transform(...matrix);\n  }\n  endAnnotation() {\n    if (this.annotationCanvas) {\n      this.ctx.restore();\n      this.#drawFilter();\n      this.ctx = this.annotationCanvas.savedCtx;\n      delete this.annotationCanvas.savedCtx;\n      delete this.annotationCanvas;\n    }\n  }\n  paintImageMaskXObject(img) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const count = img.count;\n    img = this.getObject(img.data, img);\n    img.count = count;\n    const ctx = this.ctx;\n    const glyph = this.processingType3;\n    if (glyph) {\n      if (glyph.compiled === undefined) {\n        glyph.compiled = compileType3Glyph(img);\n      }\n      if (glyph.compiled) {\n        glyph.compiled(ctx);\n        return;\n      }\n    }\n    const mask = this._createMaskCanvas(img);\n    const maskCanvas = mask.canvas;\n    ctx.save();\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.drawImage(maskCanvas, mask.offsetX, mask.offsetY);\n    ctx.restore();\n    this.compose();\n  }\n  paintImageMaskXObjectRepeat(img, scaleX, skewX = 0, skewY = 0, scaleY, positions) {\n    if (!this.contentVisible) {\n      return;\n    }\n    img = this.getObject(img.data, img);\n    const ctx = this.ctx;\n    ctx.save();\n    const currentTransform = getCurrentTransform(ctx);\n    ctx.transform(scaleX, skewX, skewY, scaleY, 0, 0);\n    const mask = this._createMaskCanvas(img);\n    ctx.setTransform(1, 0, 0, 1, mask.offsetX - currentTransform[4], mask.offsetY - currentTransform[5]);\n    for (let i = 0, ii = positions.length; i < ii; i += 2) {\n      const trans = Util.transform(currentTransform, [scaleX, skewX, skewY, scaleY, positions[i], positions[i + 1]]);\n      const [x, y] = Util.applyTransform([0, 0], trans);\n      ctx.drawImage(mask.canvas, x, y);\n    }\n    ctx.restore();\n    this.compose();\n  }\n  paintImageMaskXObjectGroup(images) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const ctx = this.ctx;\n    const fillColor = this.current.fillColor;\n    const isPatternFill = this.current.patternFill;\n    for (const image of images) {\n      const {\n        data,\n        width,\n        height,\n        transform\n      } = image;\n      const maskCanvas = this.cachedCanvases.getCanvas(\"maskCanvas\", width, height);\n      const maskCtx = maskCanvas.context;\n      maskCtx.save();\n      const img = this.getObject(data, image);\n      putBinaryImageMask(maskCtx, img);\n      maskCtx.globalCompositeOperation = \"source-in\";\n      maskCtx.fillStyle = isPatternFill ? fillColor.getPattern(maskCtx, this, getCurrentTransformInverse(ctx), PathType.FILL) : fillColor;\n      maskCtx.fillRect(0, 0, width, height);\n      maskCtx.restore();\n      ctx.save();\n      ctx.transform(...transform);\n      ctx.scale(1, -1);\n      drawImageAtIntegerCoords(ctx, maskCanvas.canvas, 0, 0, width, height, 0, -1, 1, 1);\n      ctx.restore();\n    }\n    this.compose();\n  }\n  paintImageXObject(objId) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const imgData = this.getObject(objId);\n    if (!imgData) {\n      warn(\"Dependent image isn't ready yet\");\n      return;\n    }\n    this.paintInlineImageXObject(imgData);\n  }\n  paintImageXObjectRepeat(objId, scaleX, scaleY, positions) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const imgData = this.getObject(objId);\n    if (!imgData) {\n      warn(\"Dependent image isn't ready yet\");\n      return;\n    }\n    const width = imgData.width;\n    const height = imgData.height;\n    const map = [];\n    for (let i = 0, ii = positions.length; i < ii; i += 2) {\n      map.push({\n        transform: [scaleX, 0, 0, scaleY, positions[i], positions[i + 1]],\n        x: 0,\n        y: 0,\n        w: width,\n        h: height\n      });\n    }\n    this.paintInlineImageXObjectGroup(imgData, map);\n  }\n  applyTransferMapsToCanvas(ctx) {\n    if (this.current.transferMaps !== \"none\") {\n      ctx.filter = this.current.transferMaps;\n      ctx.drawImage(ctx.canvas, 0, 0);\n      ctx.filter = \"none\";\n    }\n    return ctx.canvas;\n  }\n  applyTransferMapsToBitmap(imgData) {\n    if (this.current.transferMaps === \"none\") {\n      return imgData.bitmap;\n    }\n    const {\n      bitmap,\n      width,\n      height\n    } = imgData;\n    const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", width, height);\n    const tmpCtx = tmpCanvas.context;\n    tmpCtx.filter = this.current.transferMaps;\n    tmpCtx.drawImage(bitmap, 0, 0);\n    tmpCtx.filter = \"none\";\n    return tmpCanvas.canvas;\n  }\n  paintInlineImageXObject(imgData) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const width = imgData.width;\n    const height = imgData.height;\n    const ctx = this.ctx;\n    this.save();\n    if (!isNodeJS) {\n      const {\n        filter\n      } = ctx;\n      if (filter !== \"none\" && filter !== \"\") {\n        ctx.filter = \"none\";\n      }\n    }\n    ctx.scale(1 / width, -1 / height);\n    let imgToPaint;\n    if (imgData.bitmap) {\n      imgToPaint = this.applyTransferMapsToBitmap(imgData);\n    } else if (typeof HTMLElement === \"function\" && imgData instanceof HTMLElement || !imgData.data) {\n      imgToPaint = imgData;\n    } else {\n      const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", width, height);\n      const tmpCtx = tmpCanvas.context;\n      putBinaryImageData(tmpCtx, imgData);\n      imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n    }\n    const scaled = this._scaleImage(imgToPaint, getCurrentTransformInverse(ctx));\n    ctx.imageSmoothingEnabled = getImageSmoothingEnabled(getCurrentTransform(ctx), imgData.interpolate);\n    drawImageAtIntegerCoords(ctx, scaled.img, 0, 0, scaled.paintWidth, scaled.paintHeight, 0, -height, width, height);\n    this.compose();\n    this.restore();\n  }\n  paintInlineImageXObjectGroup(imgData, map) {\n    if (!this.contentVisible) {\n      return;\n    }\n    const ctx = this.ctx;\n    let imgToPaint;\n    if (imgData.bitmap) {\n      imgToPaint = imgData.bitmap;\n    } else {\n      const w = imgData.width;\n      const h = imgData.height;\n      const tmpCanvas = this.cachedCanvases.getCanvas(\"inlineImage\", w, h);\n      const tmpCtx = tmpCanvas.context;\n      putBinaryImageData(tmpCtx, imgData);\n      imgToPaint = this.applyTransferMapsToCanvas(tmpCtx);\n    }\n    for (const entry of map) {\n      ctx.save();\n      ctx.transform(...entry.transform);\n      ctx.scale(1, -1);\n      drawImageAtIntegerCoords(ctx, imgToPaint, entry.x, entry.y, entry.w, entry.h, 0, -1, 1, 1);\n      ctx.restore();\n    }\n    this.compose();\n  }\n  paintSolidColorImageMask() {\n    if (!this.contentVisible) {\n      return;\n    }\n    this.ctx.fillRect(0, 0, 1, 1);\n    this.compose();\n  }\n  markPoint(tag) {}\n  markPointProps(tag, properties) {}\n  beginMarkedContent(tag) {\n    this.markedContentStack.push({\n      visible: true\n    });\n  }\n  beginMarkedContentProps(tag, properties) {\n    if (tag === \"OC\") {\n      this.markedContentStack.push({\n        visible: this.optionalContentConfig.isVisible(properties)\n      });\n    } else {\n      this.markedContentStack.push({\n        visible: true\n      });\n    }\n    this.contentVisible = this.isContentVisible();\n  }\n  endMarkedContent() {\n    this.markedContentStack.pop();\n    this.contentVisible = this.isContentVisible();\n  }\n  beginCompat() {}\n  endCompat() {}\n  consumePath(clipBox) {\n    const isEmpty = this.current.isEmptyClip();\n    if (this.pendingClip) {\n      this.current.updateClipFromPath();\n    }\n    if (!this.pendingClip) {\n      this.compose(clipBox);\n    }\n    const ctx = this.ctx;\n    if (this.pendingClip) {\n      if (!isEmpty) {\n        if (this.pendingClip === EO_CLIP) {\n          ctx.clip(\"evenodd\");\n        } else {\n          ctx.clip();\n        }\n      }\n      this.pendingClip = null;\n    }\n    this.current.startNewPathAndClipBox(this.current.clipBox);\n    ctx.beginPath();\n  }\n  getSinglePixelWidth() {\n    if (!this._cachedGetSinglePixelWidth) {\n      const m = getCurrentTransform(this.ctx);\n      if (m[1] === 0 && m[2] === 0) {\n        this._cachedGetSinglePixelWidth = 1 / Math.min(Math.abs(m[0]), Math.abs(m[3]));\n      } else {\n        const absDet = Math.abs(m[0] * m[3] - m[2] * m[1]);\n        const normX = Math.hypot(m[0], m[2]);\n        const normY = Math.hypot(m[1], m[3]);\n        this._cachedGetSinglePixelWidth = Math.max(normX, normY) / absDet;\n      }\n    }\n    return this._cachedGetSinglePixelWidth;\n  }\n  getScaleForStroking() {\n    if (this._cachedScaleForStroking[0] === -1) {\n      const {\n        lineWidth\n      } = this.current;\n      const {\n        a,\n        b,\n        c,\n        d\n      } = this.ctx.getTransform();\n      let scaleX, scaleY;\n      if (b === 0 && c === 0) {\n        const normX = Math.abs(a);\n        const normY = Math.abs(d);\n        if (normX === normY) {\n          if (lineWidth === 0) {\n            scaleX = scaleY = 1 / normX;\n          } else {\n            const scaledLineWidth = normX * lineWidth;\n            scaleX = scaleY = scaledLineWidth < 1 ? 1 / scaledLineWidth : 1;\n          }\n        } else if (lineWidth === 0) {\n          scaleX = 1 / normX;\n          scaleY = 1 / normY;\n        } else {\n          const scaledXLineWidth = normX * lineWidth;\n          const scaledYLineWidth = normY * lineWidth;\n          scaleX = scaledXLineWidth < 1 ? 1 / scaledXLineWidth : 1;\n          scaleY = scaledYLineWidth < 1 ? 1 / scaledYLineWidth : 1;\n        }\n      } else {\n        const absDet = Math.abs(a * d - b * c);\n        const normX = Math.hypot(a, b);\n        const normY = Math.hypot(c, d);\n        if (lineWidth === 0) {\n          scaleX = normY / absDet;\n          scaleY = normX / absDet;\n        } else {\n          const baseArea = lineWidth * absDet;\n          scaleX = normY > baseArea ? normY / baseArea : 1;\n          scaleY = normX > baseArea ? normX / baseArea : 1;\n        }\n      }\n      this._cachedScaleForStroking[0] = scaleX;\n      this._cachedScaleForStroking[1] = scaleY;\n    }\n    return this._cachedScaleForStroking;\n  }\n  rescaleAndStroke(saveRestore) {\n    const {\n      ctx\n    } = this;\n    const {\n      lineWidth\n    } = this.current;\n    const [scaleX, scaleY] = this.getScaleForStroking();\n    ctx.lineWidth = lineWidth || 1;\n    if (scaleX === 1 && scaleY === 1) {\n      ctx.stroke();\n      return;\n    }\n    const dashes = ctx.getLineDash();\n    if (saveRestore) {\n      ctx.save();\n    }\n    ctx.scale(scaleX, scaleY);\n    if (dashes.length > 0) {\n      const scale = Math.max(scaleX, scaleY);\n      ctx.setLineDash(dashes.map(x => x / scale));\n      ctx.lineDashOffset /= scale;\n    }\n    ctx.stroke();\n    if (saveRestore) {\n      ctx.restore();\n    }\n  }\n  isContentVisible() {\n    for (let i = this.markedContentStack.length - 1; i >= 0; i--) {\n      if (!this.markedContentStack[i].visible) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\nfor (const op in OPS) {\n  if (CanvasGraphics.prototype[op] !== undefined) {\n    CanvasGraphics.prototype[OPS[op]] = CanvasGraphics.prototype[op];\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/worker_options.js\nclass GlobalWorkerOptions {\n  static #port = null;\n  static #src = \"\";\n  static get workerPort() {\n    return this.#port;\n  }\n  static set workerPort(val) {\n    if (!(typeof Worker !== \"undefined\" && val instanceof Worker) && val !== null) {\n      throw new Error(\"Invalid `workerPort` type.\");\n    }\n    this.#port = val;\n  }\n  static get workerSrc() {\n    return this.#src;\n  }\n  static set workerSrc(val) {\n    if (typeof val !== \"string\") {\n      throw new Error(\"Invalid `workerSrc` type.\");\n    }\n    this.#src = val;\n  }\n}\n\n;// CONCATENATED MODULE: ./src/shared/message_handler.js\n\nconst CallbackKind = {\n  UNKNOWN: 0,\n  DATA: 1,\n  ERROR: 2\n};\nconst StreamKind = {\n  UNKNOWN: 0,\n  CANCEL: 1,\n  CANCEL_COMPLETE: 2,\n  CLOSE: 3,\n  ENQUEUE: 4,\n  ERROR: 5,\n  PULL: 6,\n  PULL_COMPLETE: 7,\n  START_COMPLETE: 8\n};\nfunction wrapReason(reason) {\n  if (!(reason instanceof Error || typeof reason === \"object\" && reason !== null)) {\n    unreachable('wrapReason: Expected \"reason\" to be a (possibly cloned) Error.');\n  }\n  switch (reason.name) {\n    case \"AbortException\":\n      return new AbortException(reason.message);\n    case \"MissingPDFException\":\n      return new MissingPDFException(reason.message);\n    case \"PasswordException\":\n      return new PasswordException(reason.message, reason.code);\n    case \"UnexpectedResponseException\":\n      return new UnexpectedResponseException(reason.message, reason.status);\n    case \"UnknownErrorException\":\n      return new UnknownErrorException(reason.message, reason.details);\n    default:\n      return new UnknownErrorException(reason.message, reason.toString());\n  }\n}\nclass MessageHandler {\n  constructor(sourceName, targetName, comObj) {\n    this.sourceName = sourceName;\n    this.targetName = targetName;\n    this.comObj = comObj;\n    this.callbackId = 1;\n    this.streamId = 1;\n    this.streamSinks = Object.create(null);\n    this.streamControllers = Object.create(null);\n    this.callbackCapabilities = Object.create(null);\n    this.actionHandler = Object.create(null);\n    this._onComObjOnMessage = event => {\n      const data = event.data;\n      if (data.targetName !== this.sourceName) {\n        return;\n      }\n      if (data.stream) {\n        this.#processStreamMessage(data);\n        return;\n      }\n      if (data.callback) {\n        const callbackId = data.callbackId;\n        const capability = this.callbackCapabilities[callbackId];\n        if (!capability) {\n          throw new Error(`Cannot resolve callback ${callbackId}`);\n        }\n        delete this.callbackCapabilities[callbackId];\n        if (data.callback === CallbackKind.DATA) {\n          capability.resolve(data.data);\n        } else if (data.callback === CallbackKind.ERROR) {\n          capability.reject(wrapReason(data.reason));\n        } else {\n          throw new Error(\"Unexpected callback case\");\n        }\n        return;\n      }\n      const action = this.actionHandler[data.action];\n      if (!action) {\n        throw new Error(`Unknown action from worker: ${data.action}`);\n      }\n      if (data.callbackId) {\n        const cbSourceName = this.sourceName;\n        const cbTargetName = data.sourceName;\n        new Promise(function (resolve) {\n          resolve(action(data.data));\n        }).then(function (result) {\n          comObj.postMessage({\n            sourceName: cbSourceName,\n            targetName: cbTargetName,\n            callback: CallbackKind.DATA,\n            callbackId: data.callbackId,\n            data: result\n          });\n        }, function (reason) {\n          comObj.postMessage({\n            sourceName: cbSourceName,\n            targetName: cbTargetName,\n            callback: CallbackKind.ERROR,\n            callbackId: data.callbackId,\n            reason: wrapReason(reason)\n          });\n        });\n        return;\n      }\n      if (data.streamId) {\n        this.#createStreamSink(data);\n        return;\n      }\n      action(data.data);\n    };\n    comObj.addEventListener(\"message\", this._onComObjOnMessage);\n  }\n  on(actionName, handler) {\n    const ah = this.actionHandler;\n    if (ah[actionName]) {\n      throw new Error(`There is already an actionName called \"${actionName}\"`);\n    }\n    ah[actionName] = handler;\n  }\n  send(actionName, data, transfers) {\n    this.comObj.postMessage({\n      sourceName: this.sourceName,\n      targetName: this.targetName,\n      action: actionName,\n      data\n    }, transfers);\n  }\n  sendWithPromise(actionName, data, transfers) {\n    const callbackId = this.callbackId++;\n    const capability = Promise.withResolvers();\n    this.callbackCapabilities[callbackId] = capability;\n    try {\n      this.comObj.postMessage({\n        sourceName: this.sourceName,\n        targetName: this.targetName,\n        action: actionName,\n        callbackId,\n        data\n      }, transfers);\n    } catch (ex) {\n      capability.reject(ex);\n    }\n    return capability.promise;\n  }\n  sendWithStream(actionName, data, queueingStrategy, transfers) {\n    const streamId = this.streamId++,\n      sourceName = this.sourceName,\n      targetName = this.targetName,\n      comObj = this.comObj;\n    return new ReadableStream({\n      start: controller => {\n        const startCapability = Promise.withResolvers();\n        this.streamControllers[streamId] = {\n          controller,\n          startCall: startCapability,\n          pullCall: null,\n          cancelCall: null,\n          isClosed: false\n        };\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          action: actionName,\n          streamId,\n          data,\n          desiredSize: controller.desiredSize\n        }, transfers);\n        return startCapability.promise;\n      },\n      pull: controller => {\n        const pullCapability = Promise.withResolvers();\n        this.streamControllers[streamId].pullCall = pullCapability;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.PULL,\n          streamId,\n          desiredSize: controller.desiredSize\n        });\n        return pullCapability.promise;\n      },\n      cancel: reason => {\n        assert(reason instanceof Error, \"cancel must have a valid reason\");\n        const cancelCapability = Promise.withResolvers();\n        this.streamControllers[streamId].cancelCall = cancelCapability;\n        this.streamControllers[streamId].isClosed = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.CANCEL,\n          streamId,\n          reason: wrapReason(reason)\n        });\n        return cancelCapability.promise;\n      }\n    }, queueingStrategy);\n  }\n  #createStreamSink(data) {\n    const streamId = data.streamId,\n      sourceName = this.sourceName,\n      targetName = data.sourceName,\n      comObj = this.comObj;\n    const self = this,\n      action = this.actionHandler[data.action];\n    const streamSink = {\n      enqueue(chunk, size = 1, transfers) {\n        if (this.isCancelled) {\n          return;\n        }\n        const lastDesiredSize = this.desiredSize;\n        this.desiredSize -= size;\n        if (lastDesiredSize > 0 && this.desiredSize <= 0) {\n          this.sinkCapability = Promise.withResolvers();\n          this.ready = this.sinkCapability.promise;\n        }\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.ENQUEUE,\n          streamId,\n          chunk\n        }, transfers);\n      },\n      close() {\n        if (this.isCancelled) {\n          return;\n        }\n        this.isCancelled = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.CLOSE,\n          streamId\n        });\n        delete self.streamSinks[streamId];\n      },\n      error(reason) {\n        assert(reason instanceof Error, \"error must have a valid reason\");\n        if (this.isCancelled) {\n          return;\n        }\n        this.isCancelled = true;\n        comObj.postMessage({\n          sourceName,\n          targetName,\n          stream: StreamKind.ERROR,\n          streamId,\n          reason: wrapReason(reason)\n        });\n      },\n      sinkCapability: Promise.withResolvers(),\n      onPull: null,\n      onCancel: null,\n      isCancelled: false,\n      desiredSize: data.desiredSize,\n      ready: null\n    };\n    streamSink.sinkCapability.resolve();\n    streamSink.ready = streamSink.sinkCapability.promise;\n    this.streamSinks[streamId] = streamSink;\n    new Promise(function (resolve) {\n      resolve(action(data.data, streamSink));\n    }).then(function () {\n      comObj.postMessage({\n        sourceName,\n        targetName,\n        stream: StreamKind.START_COMPLETE,\n        streamId,\n        success: true\n      });\n    }, function (reason) {\n      comObj.postMessage({\n        sourceName,\n        targetName,\n        stream: StreamKind.START_COMPLETE,\n        streamId,\n        reason: wrapReason(reason)\n      });\n    });\n  }\n  #processStreamMessage(data) {\n    const streamId = data.streamId,\n      sourceName = this.sourceName,\n      targetName = data.sourceName,\n      comObj = this.comObj;\n    const streamController = this.streamControllers[streamId],\n      streamSink = this.streamSinks[streamId];\n    switch (data.stream) {\n      case StreamKind.START_COMPLETE:\n        if (data.success) {\n          streamController.startCall.resolve();\n        } else {\n          streamController.startCall.reject(wrapReason(data.reason));\n        }\n        break;\n      case StreamKind.PULL_COMPLETE:\n        if (data.success) {\n          streamController.pullCall.resolve();\n        } else {\n          streamController.pullCall.reject(wrapReason(data.reason));\n        }\n        break;\n      case StreamKind.PULL:\n        if (!streamSink) {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL_COMPLETE,\n            streamId,\n            success: true\n          });\n          break;\n        }\n        if (streamSink.desiredSize <= 0 && data.desiredSize > 0) {\n          streamSink.sinkCapability.resolve();\n        }\n        streamSink.desiredSize = data.desiredSize;\n        new Promise(function (resolve) {\n          resolve(streamSink.onPull?.());\n        }).then(function () {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL_COMPLETE,\n            streamId,\n            success: true\n          });\n        }, function (reason) {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.PULL_COMPLETE,\n            streamId,\n            reason: wrapReason(reason)\n          });\n        });\n        break;\n      case StreamKind.ENQUEUE:\n        assert(streamController, \"enqueue should have stream controller\");\n        if (streamController.isClosed) {\n          break;\n        }\n        streamController.controller.enqueue(data.chunk);\n        break;\n      case StreamKind.CLOSE:\n        assert(streamController, \"close should have stream controller\");\n        if (streamController.isClosed) {\n          break;\n        }\n        streamController.isClosed = true;\n        streamController.controller.close();\n        this.#deleteStreamController(streamController, streamId);\n        break;\n      case StreamKind.ERROR:\n        assert(streamController, \"error should have stream controller\");\n        streamController.controller.error(wrapReason(data.reason));\n        this.#deleteStreamController(streamController, streamId);\n        break;\n      case StreamKind.CANCEL_COMPLETE:\n        if (data.success) {\n          streamController.cancelCall.resolve();\n        } else {\n          streamController.cancelCall.reject(wrapReason(data.reason));\n        }\n        this.#deleteStreamController(streamController, streamId);\n        break;\n      case StreamKind.CANCEL:\n        if (!streamSink) {\n          break;\n        }\n        new Promise(function (resolve) {\n          resolve(streamSink.onCancel?.(wrapReason(data.reason)));\n        }).then(function () {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.CANCEL_COMPLETE,\n            streamId,\n            success: true\n          });\n        }, function (reason) {\n          comObj.postMessage({\n            sourceName,\n            targetName,\n            stream: StreamKind.CANCEL_COMPLETE,\n            streamId,\n            reason: wrapReason(reason)\n          });\n        });\n        streamSink.sinkCapability.reject(wrapReason(data.reason));\n        streamSink.isCancelled = true;\n        delete this.streamSinks[streamId];\n        break;\n      default:\n        throw new Error(\"Unexpected stream case\");\n    }\n  }\n  async #deleteStreamController(streamController, streamId) {\n    await Promise.allSettled([streamController.startCall?.promise, streamController.pullCall?.promise, streamController.cancelCall?.promise]);\n    delete this.streamControllers[streamId];\n  }\n  destroy() {\n    this.comObj.removeEventListener(\"message\", this._onComObjOnMessage);\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/metadata.js\n\nclass Metadata {\n  #metadataMap;\n  #data;\n  constructor({\n    parsedData,\n    rawData\n  }) {\n    this.#metadataMap = parsedData;\n    this.#data = rawData;\n  }\n  getRaw() {\n    return this.#data;\n  }\n  get(name) {\n    return this.#metadataMap.get(name) ?? null;\n  }\n  getAll() {\n    return objectFromMap(this.#metadataMap);\n  }\n  has(name) {\n    return this.#metadataMap.has(name);\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/optional_content_config.js\n\n\nconst INTERNAL = Symbol(\"INTERNAL\");\nclass OptionalContentGroup {\n  #isDisplay = false;\n  #isPrint = false;\n  #userSet = false;\n  #visible = true;\n  constructor(renderingIntent, {\n    name,\n    intent,\n    usage\n  }) {\n    this.#isDisplay = !!(renderingIntent & RenderingIntentFlag.DISPLAY);\n    this.#isPrint = !!(renderingIntent & RenderingIntentFlag.PRINT);\n    this.name = name;\n    this.intent = intent;\n    this.usage = usage;\n  }\n  get visible() {\n    if (this.#userSet) {\n      return this.#visible;\n    }\n    if (!this.#visible) {\n      return false;\n    }\n    const {\n      print,\n      view\n    } = this.usage;\n    if (this.#isDisplay) {\n      return view?.viewState !== \"OFF\";\n    } else if (this.#isPrint) {\n      return print?.printState !== \"OFF\";\n    }\n    return true;\n  }\n  _setVisible(internal, visible, userSet = false) {\n    if (internal !== INTERNAL) {\n      unreachable(\"Internal method `_setVisible` called.\");\n    }\n    this.#userSet = userSet;\n    this.#visible = visible;\n  }\n}\nclass OptionalContentConfig {\n  #cachedGetHash = null;\n  #groups = new Map();\n  #initialHash = null;\n  #order = null;\n  constructor(data, renderingIntent = RenderingIntentFlag.DISPLAY) {\n    this.renderingIntent = renderingIntent;\n    this.name = null;\n    this.creator = null;\n    if (data === null) {\n      return;\n    }\n    this.name = data.name;\n    this.creator = data.creator;\n    this.#order = data.order;\n    for (const group of data.groups) {\n      this.#groups.set(group.id, new OptionalContentGroup(renderingIntent, group));\n    }\n    if (data.baseState === \"OFF\") {\n      for (const group of this.#groups.values()) {\n        group._setVisible(INTERNAL, false);\n      }\n    }\n    for (const on of data.on) {\n      this.#groups.get(on)._setVisible(INTERNAL, true);\n    }\n    for (const off of data.off) {\n      this.#groups.get(off)._setVisible(INTERNAL, false);\n    }\n    this.#initialHash = this.getHash();\n  }\n  #evaluateVisibilityExpression(array) {\n    const length = array.length;\n    if (length < 2) {\n      return true;\n    }\n    const operator = array[0];\n    for (let i = 1; i < length; i++) {\n      const element = array[i];\n      let state;\n      if (Array.isArray(element)) {\n        state = this.#evaluateVisibilityExpression(element);\n      } else if (this.#groups.has(element)) {\n        state = this.#groups.get(element).visible;\n      } else {\n        warn(`Optional content group not found: ${element}`);\n        return true;\n      }\n      switch (operator) {\n        case \"And\":\n          if (!state) {\n            return false;\n          }\n          break;\n        case \"Or\":\n          if (state) {\n            return true;\n          }\n          break;\n        case \"Not\":\n          return !state;\n        default:\n          return true;\n      }\n    }\n    return operator === \"And\";\n  }\n  isVisible(group) {\n    if (this.#groups.size === 0) {\n      return true;\n    }\n    if (!group) {\n      info(\"Optional content group not defined.\");\n      return true;\n    }\n    if (group.type === \"OCG\") {\n      if (!this.#groups.has(group.id)) {\n        warn(`Optional content group not found: ${group.id}`);\n        return true;\n      }\n      return this.#groups.get(group.id).visible;\n    } else if (group.type === \"OCMD\") {\n      if (group.expression) {\n        return this.#evaluateVisibilityExpression(group.expression);\n      }\n      if (!group.policy || group.policy === \"AnyOn\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (this.#groups.get(id).visible) {\n            return true;\n          }\n        }\n        return false;\n      } else if (group.policy === \"AllOn\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (!this.#groups.get(id).visible) {\n            return false;\n          }\n        }\n        return true;\n      } else if (group.policy === \"AnyOff\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (!this.#groups.get(id).visible) {\n            return true;\n          }\n        }\n        return false;\n      } else if (group.policy === \"AllOff\") {\n        for (const id of group.ids) {\n          if (!this.#groups.has(id)) {\n            warn(`Optional content group not found: ${id}`);\n            return true;\n          }\n          if (this.#groups.get(id).visible) {\n            return false;\n          }\n        }\n        return true;\n      }\n      warn(`Unknown optional content policy ${group.policy}.`);\n      return true;\n    }\n    warn(`Unknown group type ${group.type}.`);\n    return true;\n  }\n  setVisibility(id, visible = true) {\n    const group = this.#groups.get(id);\n    if (!group) {\n      warn(`Optional content group not found: ${id}`);\n      return;\n    }\n    group._setVisible(INTERNAL, !!visible, true);\n    this.#cachedGetHash = null;\n  }\n  setOCGState({\n    state,\n    preserveRB\n  }) {\n    let operator;\n    for (const elem of state) {\n      switch (elem) {\n        case \"ON\":\n        case \"OFF\":\n        case \"Toggle\":\n          operator = elem;\n          continue;\n      }\n      const group = this.#groups.get(elem);\n      if (!group) {\n        continue;\n      }\n      switch (operator) {\n        case \"ON\":\n          group._setVisible(INTERNAL, true);\n          break;\n        case \"OFF\":\n          group._setVisible(INTERNAL, false);\n          break;\n        case \"Toggle\":\n          group._setVisible(INTERNAL, !group.visible);\n          break;\n      }\n    }\n    this.#cachedGetHash = null;\n  }\n  get hasInitialVisibility() {\n    return this.#initialHash === null || this.getHash() === this.#initialHash;\n  }\n  getOrder() {\n    if (!this.#groups.size) {\n      return null;\n    }\n    if (this.#order) {\n      return this.#order.slice();\n    }\n    return [...this.#groups.keys()];\n  }\n  getGroups() {\n    return this.#groups.size > 0 ? objectFromMap(this.#groups) : null;\n  }\n  getGroup(id) {\n    return this.#groups.get(id) || null;\n  }\n  getHash() {\n    if (this.#cachedGetHash !== null) {\n      return this.#cachedGetHash;\n    }\n    const hash = new MurmurHash3_64();\n    for (const [id, group] of this.#groups) {\n      hash.update(`${id}:${group.visible}`);\n    }\n    return this.#cachedGetHash = hash.hexdigest();\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/transport_stream.js\n\n\nclass PDFDataTransportStream {\n  constructor(pdfDataRangeTransport, {\n    disableRange = false,\n    disableStream = false\n  }) {\n    assert(pdfDataRangeTransport, 'PDFDataTransportStream - missing required \"pdfDataRangeTransport\" argument.');\n    const {\n      length,\n      initialData,\n      progressiveDone,\n      contentDispositionFilename\n    } = pdfDataRangeTransport;\n    this._queuedChunks = [];\n    this._progressiveDone = progressiveDone;\n    this._contentDispositionFilename = contentDispositionFilename;\n    if (initialData?.length > 0) {\n      const buffer = initialData instanceof Uint8Array && initialData.byteLength === initialData.buffer.byteLength ? initialData.buffer : new Uint8Array(initialData).buffer;\n      this._queuedChunks.push(buffer);\n    }\n    this._pdfDataRangeTransport = pdfDataRangeTransport;\n    this._isStreamingSupported = !disableStream;\n    this._isRangeSupported = !disableRange;\n    this._contentLength = length;\n    this._fullRequestReader = null;\n    this._rangeReaders = [];\n    pdfDataRangeTransport.addRangeListener((begin, chunk) => {\n      this._onReceiveData({\n        begin,\n        chunk\n      });\n    });\n    pdfDataRangeTransport.addProgressListener((loaded, total) => {\n      this._onProgress({\n        loaded,\n        total\n      });\n    });\n    pdfDataRangeTransport.addProgressiveReadListener(chunk => {\n      this._onReceiveData({\n        chunk\n      });\n    });\n    pdfDataRangeTransport.addProgressiveDoneListener(() => {\n      this._onProgressiveDone();\n    });\n    pdfDataRangeTransport.transportReady();\n  }\n  _onReceiveData({\n    begin,\n    chunk\n  }) {\n    const buffer = chunk instanceof Uint8Array && chunk.byteLength === chunk.buffer.byteLength ? chunk.buffer : new Uint8Array(chunk).buffer;\n    if (begin === undefined) {\n      if (this._fullRequestReader) {\n        this._fullRequestReader._enqueue(buffer);\n      } else {\n        this._queuedChunks.push(buffer);\n      }\n    } else {\n      const found = this._rangeReaders.some(function (rangeReader) {\n        if (rangeReader._begin !== begin) {\n          return false;\n        }\n        rangeReader._enqueue(buffer);\n        return true;\n      });\n      assert(found, \"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.\");\n    }\n  }\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n  _onProgress(evt) {\n    if (evt.total === undefined) {\n      this._rangeReaders[0]?.onProgress?.({\n        loaded: evt.loaded\n      });\n    } else {\n      this._fullRequestReader?.onProgress?.({\n        loaded: evt.loaded,\n        total: evt.total\n      });\n    }\n  }\n  _onProgressiveDone() {\n    this._fullRequestReader?.progressiveDone();\n    this._progressiveDone = true;\n  }\n  _removeRangeReader(reader) {\n    const i = this._rangeReaders.indexOf(reader);\n    if (i >= 0) {\n      this._rangeReaders.splice(i, 1);\n    }\n  }\n  getFullReader() {\n    assert(!this._fullRequestReader, \"PDFDataTransportStream.getFullReader can only be called once.\");\n    const queuedChunks = this._queuedChunks;\n    this._queuedChunks = null;\n    return new PDFDataTransportStreamReader(this, queuedChunks, this._progressiveDone, this._contentDispositionFilename);\n  }\n  getRangeReader(begin, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n    const reader = new PDFDataTransportStreamRangeReader(this, begin, end);\n    this._pdfDataRangeTransport.requestDataRange(begin, end);\n    this._rangeReaders.push(reader);\n    return reader;\n  }\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n    for (const reader of this._rangeReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n    this._pdfDataRangeTransport.abort();\n  }\n}\nclass PDFDataTransportStreamReader {\n  constructor(stream, queuedChunks, progressiveDone = false, contentDispositionFilename = null) {\n    this._stream = stream;\n    this._done = progressiveDone || false;\n    this._filename = isPdfFile(contentDispositionFilename) ? contentDispositionFilename : null;\n    this._queuedChunks = queuedChunks || [];\n    this._loaded = 0;\n    for (const chunk of this._queuedChunks) {\n      this._loaded += chunk.byteLength;\n    }\n    this._requests = [];\n    this._headersReady = Promise.resolve();\n    stream._fullRequestReader = this;\n    this.onProgress = null;\n  }\n  _enqueue(chunk) {\n    if (this._done) {\n      return;\n    }\n    if (this._requests.length > 0) {\n      const requestCapability = this._requests.shift();\n      requestCapability.resolve({\n        value: chunk,\n        done: false\n      });\n    } else {\n      this._queuedChunks.push(chunk);\n    }\n    this._loaded += chunk.byteLength;\n  }\n  get headersReady() {\n    return this._headersReady;\n  }\n  get filename() {\n    return this._filename;\n  }\n  get isRangeSupported() {\n    return this._stream._isRangeSupported;\n  }\n  get isStreamingSupported() {\n    return this._stream._isStreamingSupported;\n  }\n  get contentLength() {\n    return this._stream._contentLength;\n  }\n  async read() {\n    if (this._queuedChunks.length > 0) {\n      const chunk = this._queuedChunks.shift();\n      return {\n        value: chunk,\n        done: false\n      };\n    }\n    if (this._done) {\n      return {\n        value: undefined,\n        done: true\n      };\n    }\n    const requestCapability = Promise.withResolvers();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n  cancel(reason) {\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n    this._requests.length = 0;\n  }\n  progressiveDone() {\n    if (this._done) {\n      return;\n    }\n    this._done = true;\n  }\n}\nclass PDFDataTransportStreamRangeReader {\n  constructor(stream, begin, end) {\n    this._stream = stream;\n    this._begin = begin;\n    this._end = end;\n    this._queuedChunk = null;\n    this._requests = [];\n    this._done = false;\n    this.onProgress = null;\n  }\n  _enqueue(chunk) {\n    if (this._done) {\n      return;\n    }\n    if (this._requests.length === 0) {\n      this._queuedChunk = chunk;\n    } else {\n      const requestsCapability = this._requests.shift();\n      requestsCapability.resolve({\n        value: chunk,\n        done: false\n      });\n      for (const requestCapability of this._requests) {\n        requestCapability.resolve({\n          value: undefined,\n          done: true\n        });\n      }\n      this._requests.length = 0;\n    }\n    this._done = true;\n    this._stream._removeRangeReader(this);\n  }\n  get isStreamingSupported() {\n    return false;\n  }\n  async read() {\n    if (this._queuedChunk) {\n      const chunk = this._queuedChunk;\n      this._queuedChunk = null;\n      return {\n        value: chunk,\n        done: false\n      };\n    }\n    if (this._done) {\n      return {\n        value: undefined,\n        done: true\n      };\n    }\n    const requestCapability = Promise.withResolvers();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n  cancel(reason) {\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n    this._requests.length = 0;\n    this._stream._removeRangeReader(this);\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/content_disposition.js\n\nfunction getFilenameFromContentDispositionHeader(contentDisposition) {\n  let needsEncodingFixup = true;\n  let tmp = toParamRegExp(\"filename\\\\*\", \"i\").exec(contentDisposition);\n  if (tmp) {\n    tmp = tmp[1];\n    let filename = rfc2616unquote(tmp);\n    filename = unescape(filename);\n    filename = rfc5987decode(filename);\n    filename = rfc2047decode(filename);\n    return fixupEncoding(filename);\n  }\n  tmp = rfc2231getparam(contentDisposition);\n  if (tmp) {\n    const filename = rfc2047decode(tmp);\n    return fixupEncoding(filename);\n  }\n  tmp = toParamRegExp(\"filename\", \"i\").exec(contentDisposition);\n  if (tmp) {\n    tmp = tmp[1];\n    let filename = rfc2616unquote(tmp);\n    filename = rfc2047decode(filename);\n    return fixupEncoding(filename);\n  }\n  function toParamRegExp(attributePattern, flags) {\n    return new RegExp(\"(?:^|;)\\\\s*\" + attributePattern + \"\\\\s*=\\\\s*\" + \"(\" + '[^\";\\\\s][^;\\\\s]*' + \"|\" + '\"(?:[^\"\\\\\\\\]|\\\\\\\\\"?)+\"?' + \")\", flags);\n  }\n  function textdecode(encoding, value) {\n    if (encoding) {\n      if (!/^[\\x00-\\xFF]+$/.test(value)) {\n        return value;\n      }\n      try {\n        const decoder = new TextDecoder(encoding, {\n          fatal: true\n        });\n        const buffer = stringToBytes(value);\n        value = decoder.decode(buffer);\n        needsEncodingFixup = false;\n      } catch {}\n    }\n    return value;\n  }\n  function fixupEncoding(value) {\n    if (needsEncodingFixup && /[\\x80-\\xff]/.test(value)) {\n      value = textdecode(\"utf-8\", value);\n      if (needsEncodingFixup) {\n        value = textdecode(\"iso-8859-1\", value);\n      }\n    }\n    return value;\n  }\n  function rfc2231getparam(contentDispositionStr) {\n    const matches = [];\n    let match;\n    const iter = toParamRegExp(\"filename\\\\*((?!0\\\\d)\\\\d+)(\\\\*?)\", \"ig\");\n    while ((match = iter.exec(contentDispositionStr)) !== null) {\n      let [, n, quot, part] = match;\n      n = parseInt(n, 10);\n      if (n in matches) {\n        if (n === 0) {\n          break;\n        }\n        continue;\n      }\n      matches[n] = [quot, part];\n    }\n    const parts = [];\n    for (let n = 0; n < matches.length; ++n) {\n      if (!(n in matches)) {\n        break;\n      }\n      let [quot, part] = matches[n];\n      part = rfc2616unquote(part);\n      if (quot) {\n        part = unescape(part);\n        if (n === 0) {\n          part = rfc5987decode(part);\n        }\n      }\n      parts.push(part);\n    }\n    return parts.join(\"\");\n  }\n  function rfc2616unquote(value) {\n    if (value.startsWith('\"')) {\n      const parts = value.slice(1).split('\\\\\"');\n      for (let i = 0; i < parts.length; ++i) {\n        const quotindex = parts[i].indexOf('\"');\n        if (quotindex !== -1) {\n          parts[i] = parts[i].slice(0, quotindex);\n          parts.length = i + 1;\n        }\n        parts[i] = parts[i].replaceAll(/\\\\(.)/g, \"$1\");\n      }\n      value = parts.join('\"');\n    }\n    return value;\n  }\n  function rfc5987decode(extvalue) {\n    const encodingend = extvalue.indexOf(\"'\");\n    if (encodingend === -1) {\n      return extvalue;\n    }\n    const encoding = extvalue.slice(0, encodingend);\n    const langvalue = extvalue.slice(encodingend + 1);\n    const value = langvalue.replace(/^[^']*'/, \"\");\n    return textdecode(encoding, value);\n  }\n  function rfc2047decode(value) {\n    if (!value.startsWith(\"=?\") || /[\\x00-\\x19\\x80-\\xff]/.test(value)) {\n      return value;\n    }\n    return value.replaceAll(/=\\?([\\w-]*)\\?([QqBb])\\?((?:[^?]|\\?(?!=))*)\\?=/g, function (matches, charset, encoding, text) {\n      if (encoding === \"q\" || encoding === \"Q\") {\n        text = text.replaceAll(\"_\", \" \");\n        text = text.replaceAll(/=([0-9a-fA-F]{2})/g, function (match, hex) {\n          return String.fromCharCode(parseInt(hex, 16));\n        });\n        return textdecode(charset, text);\n      }\n      try {\n        text = atob(text);\n      } catch {}\n      return textdecode(charset, text);\n    });\n  }\n  return \"\";\n}\n\n;// CONCATENATED MODULE: ./src/display/network_utils.js\n\n\n\nfunction validateRangeRequestCapabilities({\n  getResponseHeader,\n  isHttp,\n  rangeChunkSize,\n  disableRange\n}) {\n  const returnValues = {\n    allowRangeRequests: false,\n    suggestedLength: undefined\n  };\n  const length = parseInt(getResponseHeader(\"Content-Length\"), 10);\n  if (!Number.isInteger(length)) {\n    return returnValues;\n  }\n  returnValues.suggestedLength = length;\n  if (length <= 2 * rangeChunkSize) {\n    return returnValues;\n  }\n  if (disableRange || !isHttp) {\n    return returnValues;\n  }\n  if (getResponseHeader(\"Accept-Ranges\") !== \"bytes\") {\n    return returnValues;\n  }\n  const contentEncoding = getResponseHeader(\"Content-Encoding\") || \"identity\";\n  if (contentEncoding !== \"identity\") {\n    return returnValues;\n  }\n  returnValues.allowRangeRequests = true;\n  return returnValues;\n}\nfunction extractFilenameFromHeader(getResponseHeader) {\n  const contentDisposition = getResponseHeader(\"Content-Disposition\");\n  if (contentDisposition) {\n    let filename = getFilenameFromContentDispositionHeader(contentDisposition);\n    if (filename.includes(\"%\")) {\n      try {\n        filename = decodeURIComponent(filename);\n      } catch {}\n    }\n    if (isPdfFile(filename)) {\n      return filename;\n    }\n  }\n  return null;\n}\nfunction createResponseStatusError(status, url) {\n  if (status === 404 || status === 0 && url.startsWith(\"file:\")) {\n    return new MissingPDFException('Missing PDF \"' + url + '\".');\n  }\n  return new UnexpectedResponseException(`Unexpected server response (${status}) while retrieving PDF \"${url}\".`, status);\n}\nfunction validateResponseStatus(status) {\n  return status === 200 || status === 206;\n}\n\n;// CONCATENATED MODULE: ./src/display/fetch_stream.js\n\n\nfunction createFetchOptions(headers, withCredentials, abortController) {\n  return {\n    method: \"GET\",\n    headers,\n    signal: abortController.signal,\n    mode: \"cors\",\n    credentials: withCredentials ? \"include\" : \"same-origin\",\n    redirect: \"follow\"\n  };\n}\nfunction createHeaders(httpHeaders) {\n  const headers = new Headers();\n  for (const property in httpHeaders) {\n    const value = httpHeaders[property];\n    if (value === undefined) {\n      continue;\n    }\n    headers.append(property, value);\n  }\n  return headers;\n}\nfunction getArrayBuffer(val) {\n  if (val instanceof Uint8Array) {\n    return val.buffer;\n  }\n  if (val instanceof ArrayBuffer) {\n    return val;\n  }\n  warn(`getArrayBuffer - unexpected data format: ${val}`);\n  return new Uint8Array(val).buffer;\n}\nclass PDFFetchStream {\n  constructor(source) {\n    this.source = source;\n    this.isHttp = /^https?:/i.test(source.url);\n    this.httpHeaders = this.isHttp && source.httpHeaders || {};\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n  getFullReader() {\n    assert(!this._fullRequestReader, \"PDFFetchStream.getFullReader can only be called once.\");\n    this._fullRequestReader = new PDFFetchStreamReader(this);\n    return this._fullRequestReader;\n  }\n  getRangeReader(begin, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n    const reader = new PDFFetchStreamRangeReader(this, begin, end);\n    this._rangeRequestReaders.push(reader);\n    return reader;\n  }\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n}\nclass PDFFetchStreamReader {\n  constructor(stream) {\n    this._stream = stream;\n    this._reader = null;\n    this._loaded = 0;\n    this._filename = null;\n    const source = stream.source;\n    this._withCredentials = source.withCredentials || false;\n    this._contentLength = source.length;\n    this._headersCapability = Promise.withResolvers();\n    this._disableRange = source.disableRange || false;\n    this._rangeChunkSize = source.rangeChunkSize;\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n    this._abortController = new AbortController();\n    this._isStreamingSupported = !source.disableStream;\n    this._isRangeSupported = !source.disableRange;\n    this._headers = createHeaders(this._stream.httpHeaders);\n    const url = source.url;\n    fetch(url, createFetchOptions(this._headers, this._withCredentials, this._abortController)).then(response => {\n      if (!validateResponseStatus(response.status)) {\n        throw createResponseStatusError(response.status, url);\n      }\n      this._reader = response.body.getReader();\n      this._headersCapability.resolve();\n      const getResponseHeader = name => response.headers.get(name);\n      const {\n        allowRangeRequests,\n        suggestedLength\n      } = validateRangeRequestCapabilities({\n        getResponseHeader,\n        isHttp: this._stream.isHttp,\n        rangeChunkSize: this._rangeChunkSize,\n        disableRange: this._disableRange\n      });\n      this._isRangeSupported = allowRangeRequests;\n      this._contentLength = suggestedLength || this._contentLength;\n      this._filename = extractFilenameFromHeader(getResponseHeader);\n      if (!this._isStreamingSupported && this._isRangeSupported) {\n        this.cancel(new AbortException(\"Streaming is disabled.\"));\n      }\n    }).catch(this._headersCapability.reject);\n    this.onProgress = null;\n  }\n  get headersReady() {\n    return this._headersCapability.promise;\n  }\n  get filename() {\n    return this._filename;\n  }\n  get contentLength() {\n    return this._contentLength;\n  }\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n  async read() {\n    await this._headersCapability.promise;\n    const {\n      value,\n      done\n    } = await this._reader.read();\n    if (done) {\n      return {\n        value,\n        done\n      };\n    }\n    this._loaded += value.byteLength;\n    this.onProgress?.({\n      loaded: this._loaded,\n      total: this._contentLength\n    });\n    return {\n      value: getArrayBuffer(value),\n      done: false\n    };\n  }\n  cancel(reason) {\n    this._reader?.cancel(reason);\n    this._abortController.abort();\n  }\n}\nclass PDFFetchStreamRangeReader {\n  constructor(stream, begin, end) {\n    this._stream = stream;\n    this._reader = null;\n    this._loaded = 0;\n    const source = stream.source;\n    this._withCredentials = source.withCredentials || false;\n    this._readCapability = Promise.withResolvers();\n    this._isStreamingSupported = !source.disableStream;\n    this._abortController = new AbortController();\n    this._headers = createHeaders(this._stream.httpHeaders);\n    this._headers.append(\"Range\", `bytes=${begin}-${end - 1}`);\n    const url = source.url;\n    fetch(url, createFetchOptions(this._headers, this._withCredentials, this._abortController)).then(response => {\n      if (!validateResponseStatus(response.status)) {\n        throw createResponseStatusError(response.status, url);\n      }\n      this._readCapability.resolve();\n      this._reader = response.body.getReader();\n    }).catch(this._readCapability.reject);\n    this.onProgress = null;\n  }\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n  async read() {\n    await this._readCapability.promise;\n    const {\n      value,\n      done\n    } = await this._reader.read();\n    if (done) {\n      return {\n        value,\n        done\n      };\n    }\n    this._loaded += value.byteLength;\n    this.onProgress?.({\n      loaded: this._loaded\n    });\n    return {\n      value: getArrayBuffer(value),\n      done: false\n    };\n  }\n  cancel(reason) {\n    this._reader?.cancel(reason);\n    this._abortController.abort();\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/network.js\n\n\nconst OK_RESPONSE = 200;\nconst PARTIAL_CONTENT_RESPONSE = 206;\nfunction network_getArrayBuffer(xhr) {\n  const data = xhr.response;\n  if (typeof data !== \"string\") {\n    return data;\n  }\n  return stringToBytes(data).buffer;\n}\nclass NetworkManager {\n  constructor(url, args = {}) {\n    this.url = url;\n    this.isHttp = /^https?:/i.test(url);\n    this.httpHeaders = this.isHttp && args.httpHeaders || Object.create(null);\n    this.withCredentials = args.withCredentials || false;\n    this.currXhrId = 0;\n    this.pendingRequests = Object.create(null);\n  }\n  requestRange(begin, end, listeners) {\n    const args = {\n      begin,\n      end\n    };\n    for (const prop in listeners) {\n      args[prop] = listeners[prop];\n    }\n    return this.request(args);\n  }\n  requestFull(listeners) {\n    return this.request(listeners);\n  }\n  request(args) {\n    const xhr = new XMLHttpRequest();\n    const xhrId = this.currXhrId++;\n    const pendingRequest = this.pendingRequests[xhrId] = {\n      xhr\n    };\n    xhr.open(\"GET\", this.url);\n    xhr.withCredentials = this.withCredentials;\n    for (const property in this.httpHeaders) {\n      const value = this.httpHeaders[property];\n      if (value === undefined) {\n        continue;\n      }\n      xhr.setRequestHeader(property, value);\n    }\n    if (this.isHttp && \"begin\" in args && \"end\" in args) {\n      xhr.setRequestHeader(\"Range\", `bytes=${args.begin}-${args.end - 1}`);\n      pendingRequest.expectedStatus = PARTIAL_CONTENT_RESPONSE;\n    } else {\n      pendingRequest.expectedStatus = OK_RESPONSE;\n    }\n    xhr.responseType = \"arraybuffer\";\n    if (args.onError) {\n      xhr.onerror = function (evt) {\n        args.onError(xhr.status);\n      };\n    }\n    xhr.onreadystatechange = this.onStateChange.bind(this, xhrId);\n    xhr.onprogress = this.onProgress.bind(this, xhrId);\n    pendingRequest.onHeadersReceived = args.onHeadersReceived;\n    pendingRequest.onDone = args.onDone;\n    pendingRequest.onError = args.onError;\n    pendingRequest.onProgress = args.onProgress;\n    xhr.send(null);\n    return xhrId;\n  }\n  onProgress(xhrId, evt) {\n    const pendingRequest = this.pendingRequests[xhrId];\n    if (!pendingRequest) {\n      return;\n    }\n    pendingRequest.onProgress?.(evt);\n  }\n  onStateChange(xhrId, evt) {\n    const pendingRequest = this.pendingRequests[xhrId];\n    if (!pendingRequest) {\n      return;\n    }\n    const xhr = pendingRequest.xhr;\n    if (xhr.readyState >= 2 && pendingRequest.onHeadersReceived) {\n      pendingRequest.onHeadersReceived();\n      delete pendingRequest.onHeadersReceived;\n    }\n    if (xhr.readyState !== 4) {\n      return;\n    }\n    if (!(xhrId in this.pendingRequests)) {\n      return;\n    }\n    delete this.pendingRequests[xhrId];\n    if (xhr.status === 0 && this.isHttp) {\n      pendingRequest.onError?.(xhr.status);\n      return;\n    }\n    const xhrStatus = xhr.status || OK_RESPONSE;\n    const ok_response_on_range_request = xhrStatus === OK_RESPONSE && pendingRequest.expectedStatus === PARTIAL_CONTENT_RESPONSE;\n    if (!ok_response_on_range_request && xhrStatus !== pendingRequest.expectedStatus) {\n      pendingRequest.onError?.(xhr.status);\n      return;\n    }\n    const chunk = network_getArrayBuffer(xhr);\n    if (xhrStatus === PARTIAL_CONTENT_RESPONSE) {\n      const rangeHeader = xhr.getResponseHeader(\"Content-Range\");\n      const matches = /bytes (\\d+)-(\\d+)\\/(\\d+)/.exec(rangeHeader);\n      pendingRequest.onDone({\n        begin: parseInt(matches[1], 10),\n        chunk\n      });\n    } else if (chunk) {\n      pendingRequest.onDone({\n        begin: 0,\n        chunk\n      });\n    } else {\n      pendingRequest.onError?.(xhr.status);\n    }\n  }\n  getRequestXhr(xhrId) {\n    return this.pendingRequests[xhrId].xhr;\n  }\n  isPendingRequest(xhrId) {\n    return xhrId in this.pendingRequests;\n  }\n  abortRequest(xhrId) {\n    const xhr = this.pendingRequests[xhrId].xhr;\n    delete this.pendingRequests[xhrId];\n    xhr.abort();\n  }\n}\nclass PDFNetworkStream {\n  constructor(source) {\n    this._source = source;\n    this._manager = new NetworkManager(source.url, {\n      httpHeaders: source.httpHeaders,\n      withCredentials: source.withCredentials\n    });\n    this._rangeChunkSize = source.rangeChunkSize;\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n  _onRangeRequestReaderClosed(reader) {\n    const i = this._rangeRequestReaders.indexOf(reader);\n    if (i >= 0) {\n      this._rangeRequestReaders.splice(i, 1);\n    }\n  }\n  getFullReader() {\n    assert(!this._fullRequestReader, \"PDFNetworkStream.getFullReader can only be called once.\");\n    this._fullRequestReader = new PDFNetworkStreamFullRequestReader(this._manager, this._source);\n    return this._fullRequestReader;\n  }\n  getRangeReader(begin, end) {\n    const reader = new PDFNetworkStreamRangeRequestReader(this._manager, begin, end);\n    reader.onClosed = this._onRangeRequestReaderClosed.bind(this);\n    this._rangeRequestReaders.push(reader);\n    return reader;\n  }\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n}\nclass PDFNetworkStreamFullRequestReader {\n  constructor(manager, source) {\n    this._manager = manager;\n    const args = {\n      onHeadersReceived: this._onHeadersReceived.bind(this),\n      onDone: this._onDone.bind(this),\n      onError: this._onError.bind(this),\n      onProgress: this._onProgress.bind(this)\n    };\n    this._url = source.url;\n    this._fullRequestId = manager.requestFull(args);\n    this._headersReceivedCapability = Promise.withResolvers();\n    this._disableRange = source.disableRange || false;\n    this._contentLength = source.length;\n    this._rangeChunkSize = source.rangeChunkSize;\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n    this._isStreamingSupported = false;\n    this._isRangeSupported = false;\n    this._cachedChunks = [];\n    this._requests = [];\n    this._done = false;\n    this._storedError = undefined;\n    this._filename = null;\n    this.onProgress = null;\n  }\n  _onHeadersReceived() {\n    const fullRequestXhrId = this._fullRequestId;\n    const fullRequestXhr = this._manager.getRequestXhr(fullRequestXhrId);\n    const getResponseHeader = name => fullRequestXhr.getResponseHeader(name);\n    const {\n      allowRangeRequests,\n      suggestedLength\n    } = validateRangeRequestCapabilities({\n      getResponseHeader,\n      isHttp: this._manager.isHttp,\n      rangeChunkSize: this._rangeChunkSize,\n      disableRange: this._disableRange\n    });\n    if (allowRangeRequests) {\n      this._isRangeSupported = true;\n    }\n    this._contentLength = suggestedLength || this._contentLength;\n    this._filename = extractFilenameFromHeader(getResponseHeader);\n    if (this._isRangeSupported) {\n      this._manager.abortRequest(fullRequestXhrId);\n    }\n    this._headersReceivedCapability.resolve();\n  }\n  _onDone(data) {\n    if (data) {\n      if (this._requests.length > 0) {\n        const requestCapability = this._requests.shift();\n        requestCapability.resolve({\n          value: data.chunk,\n          done: false\n        });\n      } else {\n        this._cachedChunks.push(data.chunk);\n      }\n    }\n    this._done = true;\n    if (this._cachedChunks.length > 0) {\n      return;\n    }\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n    this._requests.length = 0;\n  }\n  _onError(status) {\n    this._storedError = createResponseStatusError(status, this._url);\n    this._headersReceivedCapability.reject(this._storedError);\n    for (const requestCapability of this._requests) {\n      requestCapability.reject(this._storedError);\n    }\n    this._requests.length = 0;\n    this._cachedChunks.length = 0;\n  }\n  _onProgress(evt) {\n    this.onProgress?.({\n      loaded: evt.loaded,\n      total: evt.lengthComputable ? evt.total : this._contentLength\n    });\n  }\n  get filename() {\n    return this._filename;\n  }\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n  get contentLength() {\n    return this._contentLength;\n  }\n  get headersReady() {\n    return this._headersReceivedCapability.promise;\n  }\n  async read() {\n    if (this._storedError) {\n      throw this._storedError;\n    }\n    if (this._cachedChunks.length > 0) {\n      const chunk = this._cachedChunks.shift();\n      return {\n        value: chunk,\n        done: false\n      };\n    }\n    if (this._done) {\n      return {\n        value: undefined,\n        done: true\n      };\n    }\n    const requestCapability = Promise.withResolvers();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n  cancel(reason) {\n    this._done = true;\n    this._headersReceivedCapability.reject(reason);\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n    this._requests.length = 0;\n    if (this._manager.isPendingRequest(this._fullRequestId)) {\n      this._manager.abortRequest(this._fullRequestId);\n    }\n    this._fullRequestReader = null;\n  }\n}\nclass PDFNetworkStreamRangeRequestReader {\n  constructor(manager, begin, end) {\n    this._manager = manager;\n    const args = {\n      onDone: this._onDone.bind(this),\n      onError: this._onError.bind(this),\n      onProgress: this._onProgress.bind(this)\n    };\n    this._url = manager.url;\n    this._requestId = manager.requestRange(begin, end, args);\n    this._requests = [];\n    this._queuedChunk = null;\n    this._done = false;\n    this._storedError = undefined;\n    this.onProgress = null;\n    this.onClosed = null;\n  }\n  _close() {\n    this.onClosed?.(this);\n  }\n  _onDone(data) {\n    const chunk = data.chunk;\n    if (this._requests.length > 0) {\n      const requestCapability = this._requests.shift();\n      requestCapability.resolve({\n        value: chunk,\n        done: false\n      });\n    } else {\n      this._queuedChunk = chunk;\n    }\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n    this._requests.length = 0;\n    this._close();\n  }\n  _onError(status) {\n    this._storedError = createResponseStatusError(status, this._url);\n    for (const requestCapability of this._requests) {\n      requestCapability.reject(this._storedError);\n    }\n    this._requests.length = 0;\n    this._queuedChunk = null;\n  }\n  _onProgress(evt) {\n    if (!this.isStreamingSupported) {\n      this.onProgress?.({\n        loaded: evt.loaded\n      });\n    }\n  }\n  get isStreamingSupported() {\n    return false;\n  }\n  async read() {\n    if (this._storedError) {\n      throw this._storedError;\n    }\n    if (this._queuedChunk !== null) {\n      const chunk = this._queuedChunk;\n      this._queuedChunk = null;\n      return {\n        value: chunk,\n        done: false\n      };\n    }\n    if (this._done) {\n      return {\n        value: undefined,\n        done: true\n      };\n    }\n    const requestCapability = Promise.withResolvers();\n    this._requests.push(requestCapability);\n    return requestCapability.promise;\n  }\n  cancel(reason) {\n    this._done = true;\n    for (const requestCapability of this._requests) {\n      requestCapability.resolve({\n        value: undefined,\n        done: true\n      });\n    }\n    this._requests.length = 0;\n    if (this._manager.isPendingRequest(this._requestId)) {\n      this._manager.abortRequest(this._requestId);\n    }\n    this._close();\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/node_stream.js\n\n\n\nconst urlRegex = /^[a-z][a-z0-9\\-+.]+:/i;\nfunction parseUrlOrPath(sourceUrl) {\n  if (urlRegex.test(sourceUrl)) {\n    return new URL(sourceUrl);\n  }\n  const url = NodePackages.get(\"url\");\n  return new URL(url.pathToFileURL(sourceUrl));\n}\nfunction createRequest(url, headers, callback) {\n  if (url.protocol === \"http:\") {\n    const http = NodePackages.get(\"http\");\n    return http.request(url, {\n      headers\n    }, callback);\n  }\n  const https = NodePackages.get(\"https\");\n  return https.request(url, {\n    headers\n  }, callback);\n}\nclass PDFNodeStream {\n  constructor(source) {\n    this.source = source;\n    this.url = parseUrlOrPath(source.url);\n    this.isHttp = this.url.protocol === \"http:\" || this.url.protocol === \"https:\";\n    this.isFsUrl = this.url.protocol === \"file:\";\n    this.httpHeaders = this.isHttp && source.httpHeaders || {};\n    this._fullRequestReader = null;\n    this._rangeRequestReaders = [];\n  }\n  get _progressiveDataLength() {\n    return this._fullRequestReader?._loaded ?? 0;\n  }\n  getFullReader() {\n    assert(!this._fullRequestReader, \"PDFNodeStream.getFullReader can only be called once.\");\n    this._fullRequestReader = this.isFsUrl ? new PDFNodeStreamFsFullReader(this) : new PDFNodeStreamFullReader(this);\n    return this._fullRequestReader;\n  }\n  getRangeReader(start, end) {\n    if (end <= this._progressiveDataLength) {\n      return null;\n    }\n    const rangeReader = this.isFsUrl ? new PDFNodeStreamFsRangeReader(this, start, end) : new PDFNodeStreamRangeReader(this, start, end);\n    this._rangeRequestReaders.push(rangeReader);\n    return rangeReader;\n  }\n  cancelAllRequests(reason) {\n    this._fullRequestReader?.cancel(reason);\n    for (const reader of this._rangeRequestReaders.slice(0)) {\n      reader.cancel(reason);\n    }\n  }\n}\nclass BaseFullReader {\n  constructor(stream) {\n    this._url = stream.url;\n    this._done = false;\n    this._storedError = null;\n    this.onProgress = null;\n    const source = stream.source;\n    this._contentLength = source.length;\n    this._loaded = 0;\n    this._filename = null;\n    this._disableRange = source.disableRange || false;\n    this._rangeChunkSize = source.rangeChunkSize;\n    if (!this._rangeChunkSize && !this._disableRange) {\n      this._disableRange = true;\n    }\n    this._isStreamingSupported = !source.disableStream;\n    this._isRangeSupported = !source.disableRange;\n    this._readableStream = null;\n    this._readCapability = Promise.withResolvers();\n    this._headersCapability = Promise.withResolvers();\n  }\n  get headersReady() {\n    return this._headersCapability.promise;\n  }\n  get filename() {\n    return this._filename;\n  }\n  get contentLength() {\n    return this._contentLength;\n  }\n  get isRangeSupported() {\n    return this._isRangeSupported;\n  }\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n  async read() {\n    await this._readCapability.promise;\n    if (this._done) {\n      return {\n        value: undefined,\n        done: true\n      };\n    }\n    if (this._storedError) {\n      throw this._storedError;\n    }\n    const chunk = this._readableStream.read();\n    if (chunk === null) {\n      this._readCapability = Promise.withResolvers();\n      return this.read();\n    }\n    this._loaded += chunk.length;\n    this.onProgress?.({\n      loaded: this._loaded,\n      total: this._contentLength\n    });\n    const buffer = new Uint8Array(chunk).buffer;\n    return {\n      value: buffer,\n      done: false\n    };\n  }\n  cancel(reason) {\n    if (!this._readableStream) {\n      this._error(reason);\n      return;\n    }\n    this._readableStream.destroy(reason);\n  }\n  _error(reason) {\n    this._storedError = reason;\n    this._readCapability.resolve();\n  }\n  _setReadableStream(readableStream) {\n    this._readableStream = readableStream;\n    readableStream.on(\"readable\", () => {\n      this._readCapability.resolve();\n    });\n    readableStream.on(\"end\", () => {\n      readableStream.destroy();\n      this._done = true;\n      this._readCapability.resolve();\n    });\n    readableStream.on(\"error\", reason => {\n      this._error(reason);\n    });\n    if (!this._isStreamingSupported && this._isRangeSupported) {\n      this._error(new AbortException(\"streaming is disabled\"));\n    }\n    if (this._storedError) {\n      this._readableStream.destroy(this._storedError);\n    }\n  }\n}\nclass BaseRangeReader {\n  constructor(stream) {\n    this._url = stream.url;\n    this._done = false;\n    this._storedError = null;\n    this.onProgress = null;\n    this._loaded = 0;\n    this._readableStream = null;\n    this._readCapability = Promise.withResolvers();\n    const source = stream.source;\n    this._isStreamingSupported = !source.disableStream;\n  }\n  get isStreamingSupported() {\n    return this._isStreamingSupported;\n  }\n  async read() {\n    await this._readCapability.promise;\n    if (this._done) {\n      return {\n        value: undefined,\n        done: true\n      };\n    }\n    if (this._storedError) {\n      throw this._storedError;\n    }\n    const chunk = this._readableStream.read();\n    if (chunk === null) {\n      this._readCapability = Promise.withResolvers();\n      return this.read();\n    }\n    this._loaded += chunk.length;\n    this.onProgress?.({\n      loaded: this._loaded\n    });\n    const buffer = new Uint8Array(chunk).buffer;\n    return {\n      value: buffer,\n      done: false\n    };\n  }\n  cancel(reason) {\n    if (!this._readableStream) {\n      this._error(reason);\n      return;\n    }\n    this._readableStream.destroy(reason);\n  }\n  _error(reason) {\n    this._storedError = reason;\n    this._readCapability.resolve();\n  }\n  _setReadableStream(readableStream) {\n    this._readableStream = readableStream;\n    readableStream.on(\"readable\", () => {\n      this._readCapability.resolve();\n    });\n    readableStream.on(\"end\", () => {\n      readableStream.destroy();\n      this._done = true;\n      this._readCapability.resolve();\n    });\n    readableStream.on(\"error\", reason => {\n      this._error(reason);\n    });\n    if (this._storedError) {\n      this._readableStream.destroy(this._storedError);\n    }\n  }\n}\nclass PDFNodeStreamFullReader extends BaseFullReader {\n  constructor(stream) {\n    super(stream);\n    const handleResponse = response => {\n      if (response.statusCode === 404) {\n        const error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n        this._storedError = error;\n        this._headersCapability.reject(error);\n        return;\n      }\n      this._headersCapability.resolve();\n      this._setReadableStream(response);\n      const getResponseHeader = name => this._readableStream.headers[name.toLowerCase()];\n      const {\n        allowRangeRequests,\n        suggestedLength\n      } = validateRangeRequestCapabilities({\n        getResponseHeader,\n        isHttp: stream.isHttp,\n        rangeChunkSize: this._rangeChunkSize,\n        disableRange: this._disableRange\n      });\n      this._isRangeSupported = allowRangeRequests;\n      this._contentLength = suggestedLength || this._contentLength;\n      this._filename = extractFilenameFromHeader(getResponseHeader);\n    };\n    this._request = createRequest(this._url, stream.httpHeaders, handleResponse);\n    this._request.on(\"error\", reason => {\n      this._storedError = reason;\n      this._headersCapability.reject(reason);\n    });\n    this._request.end();\n  }\n}\nclass PDFNodeStreamRangeReader extends BaseRangeReader {\n  constructor(stream, start, end) {\n    super(stream);\n    this._httpHeaders = {};\n    for (const property in stream.httpHeaders) {\n      const value = stream.httpHeaders[property];\n      if (value === undefined) {\n        continue;\n      }\n      this._httpHeaders[property] = value;\n    }\n    this._httpHeaders.Range = `bytes=${start}-${end - 1}`;\n    const handleResponse = response => {\n      if (response.statusCode === 404) {\n        const error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n        this._storedError = error;\n        return;\n      }\n      this._setReadableStream(response);\n    };\n    this._request = createRequest(this._url, this._httpHeaders, handleResponse);\n    this._request.on(\"error\", reason => {\n      this._storedError = reason;\n    });\n    this._request.end();\n  }\n}\nclass PDFNodeStreamFsFullReader extends BaseFullReader {\n  constructor(stream) {\n    super(stream);\n    const fs = NodePackages.get(\"fs\");\n    fs.promises.lstat(this._url).then(stat => {\n      this._contentLength = stat.size;\n      this._setReadableStream(fs.createReadStream(this._url));\n      this._headersCapability.resolve();\n    }, error => {\n      if (error.code === \"ENOENT\") {\n        error = new MissingPDFException(`Missing PDF \"${this._url}\".`);\n      }\n      this._storedError = error;\n      this._headersCapability.reject(error);\n    });\n  }\n}\nclass PDFNodeStreamFsRangeReader extends BaseRangeReader {\n  constructor(stream, start, end) {\n    super(stream);\n    const fs = NodePackages.get(\"fs\");\n    this._setReadableStream(fs.createReadStream(this._url, {\n      start,\n      end: end - 1\n    }));\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/text_layer.js\n\n\nconst MAX_TEXT_DIVS_TO_RENDER = 100000;\nconst DEFAULT_FONT_SIZE = 30;\nconst DEFAULT_FONT_ASCENT = 0.8;\nclass TextLayer {\n  #capability = Promise.withResolvers();\n  #container = null;\n  #disableProcessItems = false;\n  #fontInspectorEnabled = !!globalThis.FontInspector?.enabled;\n  #lang = null;\n  #layoutTextParams = null;\n  #pageHeight = 0;\n  #pageWidth = 0;\n  #reader = null;\n  #rootContainer = null;\n  #rotation = 0;\n  #scale = 0;\n  #styleCache = Object.create(null);\n  #textContentItemsStr = [];\n  #textContentSource = null;\n  #textDivs = [];\n  #textDivProperties = new WeakMap();\n  #transform = null;\n  static #ascentCache = new Map();\n  static #canvasContexts = new Map();\n  static #minFontSize = null;\n  static #pendingTextLayers = new Set();\n  constructor({\n    textContentSource,\n    container,\n    viewport\n  }) {\n    if (textContentSource instanceof ReadableStream) {\n      this.#textContentSource = textContentSource;\n    } else if (typeof textContentSource === \"object\") {\n      this.#textContentSource = new ReadableStream({\n        start(controller) {\n          controller.enqueue(textContentSource);\n          controller.close();\n        }\n      });\n    } else {\n      throw new Error('No \"textContentSource\" parameter specified.');\n    }\n    this.#container = this.#rootContainer = container;\n    this.#scale = viewport.scale * (globalThis.devicePixelRatio || 1);\n    this.#rotation = viewport.rotation;\n    this.#layoutTextParams = {\n      prevFontSize: null,\n      prevFontFamily: null,\n      div: null,\n      properties: null,\n      ctx: null\n    };\n    const {\n      pageWidth,\n      pageHeight,\n      pageX,\n      pageY\n    } = viewport.rawDims;\n    this.#transform = [1, 0, 0, -1, -pageX, pageY + pageHeight];\n    this.#pageWidth = pageWidth;\n    this.#pageHeight = pageHeight;\n    TextLayer.#ensureMinFontSizeComputed();\n    setLayerDimensions(container, viewport);\n    this.#capability.promise.catch(() => {}).then(() => {\n      TextLayer.#pendingTextLayers.delete(this);\n      this.#layoutTextParams = null;\n      this.#styleCache = null;\n    });\n  }\n  render() {\n    const pump = () => {\n      this.#reader.read().then(({\n        value,\n        done\n      }) => {\n        if (done) {\n          this.#capability.resolve();\n          return;\n        }\n        this.#lang ??= value.lang;\n        Object.assign(this.#styleCache, value.styles);\n        this.#processItems(value.items);\n        pump();\n      }, this.#capability.reject);\n    };\n    this.#reader = this.#textContentSource.getReader();\n    TextLayer.#pendingTextLayers.add(this);\n    pump();\n    return this.#capability.promise;\n  }\n  update({\n    viewport,\n    onBefore = null\n  }) {\n    const scale = viewport.scale * (globalThis.devicePixelRatio || 1);\n    const rotation = viewport.rotation;\n    if (rotation !== this.#rotation) {\n      onBefore?.();\n      this.#rotation = rotation;\n      setLayerDimensions(this.#rootContainer, {\n        rotation\n      });\n    }\n    if (scale !== this.#scale) {\n      onBefore?.();\n      this.#scale = scale;\n      const params = {\n        prevFontSize: null,\n        prevFontFamily: null,\n        div: null,\n        properties: null,\n        ctx: TextLayer.#getCtx(this.#lang)\n      };\n      for (const div of this.#textDivs) {\n        params.properties = this.#textDivProperties.get(div);\n        params.div = div;\n        this.#layout(params);\n      }\n    }\n  }\n  cancel() {\n    const abortEx = new AbortException(\"TextLayer task cancelled.\");\n    this.#reader?.cancel(abortEx).catch(() => {});\n    this.#reader = null;\n    this.#capability.reject(abortEx);\n  }\n  get textDivs() {\n    return this.#textDivs;\n  }\n  get textContentItemsStr() {\n    return this.#textContentItemsStr;\n  }\n  #processItems(items) {\n    if (this.#disableProcessItems) {\n      return;\n    }\n    this.#layoutTextParams.ctx ??= TextLayer.#getCtx(this.#lang);\n    const textDivs = this.#textDivs,\n      textContentItemsStr = this.#textContentItemsStr;\n    for (const item of items) {\n      if (textDivs.length > MAX_TEXT_DIVS_TO_RENDER) {\n        warn(\"Ignoring additional textDivs for performance reasons.\");\n        this.#disableProcessItems = true;\n        return;\n      }\n      if (item.str === undefined) {\n        if (item.type === \"beginMarkedContentProps\" || item.type === \"beginMarkedContent\") {\n          const parent = this.#container;\n          this.#container = document.createElement(\"span\");\n          this.#container.classList.add(\"markedContent\");\n          if (item.id !== null) {\n            this.#container.setAttribute(\"id\", `${item.id}`);\n          }\n          parent.append(this.#container);\n        } else if (item.type === \"endMarkedContent\") {\n          this.#container = this.#container.parentNode;\n        }\n        continue;\n      }\n      textContentItemsStr.push(item.str);\n      this.#appendText(item);\n    }\n  }\n  #appendText(geom) {\n    const textDiv = document.createElement(\"span\");\n    const textDivProperties = {\n      angle: 0,\n      canvasWidth: 0,\n      hasText: geom.str !== \"\",\n      hasEOL: geom.hasEOL,\n      fontSize: 0\n    };\n    this.#textDivs.push(textDiv);\n    const tx = Util.transform(this.#transform, geom.transform);\n    let angle = Math.atan2(tx[1], tx[0]);\n    const style = this.#styleCache[geom.fontName];\n    if (style.vertical) {\n      angle += Math.PI / 2;\n    }\n    const fontFamily = this.#fontInspectorEnabled && style.fontSubstitution || style.fontFamily;\n    const fontHeight = Math.hypot(tx[2], tx[3]);\n    const fontAscent = fontHeight * TextLayer.#getAscent(fontFamily, this.#lang);\n    let left, top;\n    if (angle === 0) {\n      left = tx[4];\n      top = tx[5] - fontAscent;\n    } else {\n      left = tx[4] + fontAscent * Math.sin(angle);\n      top = tx[5] - fontAscent * Math.cos(angle);\n    }\n    const scaleFactorStr = \"calc(var(--scale-factor)*\";\n    const divStyle = textDiv.style;\n    if (this.#container === this.#rootContainer) {\n      divStyle.left = `${(100 * left / this.#pageWidth).toFixed(2)}%`;\n      divStyle.top = `${(100 * top / this.#pageHeight).toFixed(2)}%`;\n    } else {\n      divStyle.left = `${scaleFactorStr}${left.toFixed(2)}px)`;\n      divStyle.top = `${scaleFactorStr}${top.toFixed(2)}px)`;\n    }\n    divStyle.fontSize = `${scaleFactorStr}${(TextLayer.#minFontSize * fontHeight).toFixed(2)}px)`;\n    divStyle.fontFamily = fontFamily;\n    textDivProperties.fontSize = fontHeight;\n    textDiv.setAttribute(\"role\", \"presentation\");\n    textDiv.textContent = geom.str;\n    textDiv.dir = geom.dir;\n    if (this.#fontInspectorEnabled) {\n      textDiv.dataset.fontName = style.fontSubstitutionLoadedName || geom.fontName;\n    }\n    if (angle !== 0) {\n      textDivProperties.angle = angle * (180 / Math.PI);\n    }\n    let shouldScaleText = false;\n    if (geom.str.length > 1) {\n      shouldScaleText = true;\n    } else if (geom.str !== \" \" && geom.transform[0] !== geom.transform[3]) {\n      const absScaleX = Math.abs(geom.transform[0]),\n        absScaleY = Math.abs(geom.transform[3]);\n      if (absScaleX !== absScaleY && Math.max(absScaleX, absScaleY) / Math.min(absScaleX, absScaleY) > 1.5) {\n        shouldScaleText = true;\n      }\n    }\n    if (shouldScaleText) {\n      textDivProperties.canvasWidth = style.vertical ? geom.height : geom.width;\n    }\n    this.#textDivProperties.set(textDiv, textDivProperties);\n    this.#layoutTextParams.div = textDiv;\n    this.#layoutTextParams.properties = textDivProperties;\n    this.#layout(this.#layoutTextParams);\n    if (textDivProperties.hasText) {\n      this.#container.append(textDiv);\n    }\n    if (textDivProperties.hasEOL) {\n      const br = document.createElement(\"br\");\n      br.setAttribute(\"role\", \"presentation\");\n      this.#container.append(br);\n    }\n  }\n  #layout(params) {\n    const {\n      div,\n      properties,\n      ctx,\n      prevFontSize,\n      prevFontFamily\n    } = params;\n    const {\n      style\n    } = div;\n    let transform = \"\";\n    if (TextLayer.#minFontSize > 1) {\n      transform = `scale(${1 / TextLayer.#minFontSize})`;\n    }\n    if (properties.canvasWidth !== 0 && properties.hasText) {\n      const {\n        fontFamily\n      } = style;\n      const {\n        canvasWidth,\n        fontSize\n      } = properties;\n      if (prevFontSize !== fontSize || prevFontFamily !== fontFamily) {\n        ctx.font = `${fontSize * this.#scale}px ${fontFamily}`;\n        params.prevFontSize = fontSize;\n        params.prevFontFamily = fontFamily;\n      }\n      const {\n        width\n      } = ctx.measureText(div.textContent);\n      if (width > 0) {\n        transform = `scaleX(${canvasWidth * this.#scale / width}) ${transform}`;\n      }\n    }\n    if (properties.angle !== 0) {\n      transform = `rotate(${properties.angle}deg) ${transform}`;\n    }\n    if (transform.length > 0) {\n      style.transform = transform;\n    }\n  }\n  static cleanup() {\n    if (this.#pendingTextLayers.size > 0) {\n      return;\n    }\n    this.#ascentCache.clear();\n    for (const {\n      canvas\n    } of this.#canvasContexts.values()) {\n      canvas.remove();\n    }\n    this.#canvasContexts.clear();\n  }\n  static #getCtx(lang = null) {\n    let canvasContext = this.#canvasContexts.get(lang ||= \"\");\n    if (!canvasContext) {\n      const canvas = document.createElement(\"canvas\");\n      canvas.className = \"hiddenCanvasElement\";\n      canvas.lang = lang;\n      document.body.append(canvas);\n      canvasContext = canvas.getContext(\"2d\", {\n        alpha: false,\n        willReadFrequently: true\n      });\n      this.#canvasContexts.set(lang, canvasContext);\n    }\n    return canvasContext;\n  }\n  static #ensureMinFontSizeComputed() {\n    if (this.#minFontSize !== null) {\n      return;\n    }\n    const div = document.createElement(\"div\");\n    div.style.opacity = 0;\n    div.style.lineHeight = 1;\n    div.style.fontSize = \"1px\";\n    div.style.position = \"absolute\";\n    div.textContent = \"X\";\n    document.body.append(div);\n    this.#minFontSize = div.getBoundingClientRect().height;\n    div.remove();\n  }\n  static #getAscent(fontFamily, lang) {\n    const cachedAscent = this.#ascentCache.get(fontFamily);\n    if (cachedAscent) {\n      return cachedAscent;\n    }\n    const ctx = this.#getCtx(lang);\n    const savedFont = ctx.font;\n    ctx.canvas.width = ctx.canvas.height = DEFAULT_FONT_SIZE;\n    ctx.font = `${DEFAULT_FONT_SIZE}px ${fontFamily}`;\n    const metrics = ctx.measureText(\"\");\n    let ascent = metrics.fontBoundingBoxAscent;\n    let descent = Math.abs(metrics.fontBoundingBoxDescent);\n    if (ascent) {\n      const ratio = ascent / (ascent + descent);\n      this.#ascentCache.set(fontFamily, ratio);\n      ctx.canvas.width = ctx.canvas.height = 0;\n      ctx.font = savedFont;\n      return ratio;\n    }\n    ctx.strokeStyle = \"red\";\n    ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n    ctx.strokeText(\"g\", 0, 0);\n    let pixels = ctx.getImageData(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE).data;\n    descent = 0;\n    for (let i = pixels.length - 1 - 3; i >= 0; i -= 4) {\n      if (pixels[i] > 0) {\n        descent = Math.ceil(i / 4 / DEFAULT_FONT_SIZE);\n        break;\n      }\n    }\n    ctx.clearRect(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE);\n    ctx.strokeText(\"A\", 0, DEFAULT_FONT_SIZE);\n    pixels = ctx.getImageData(0, 0, DEFAULT_FONT_SIZE, DEFAULT_FONT_SIZE).data;\n    ascent = 0;\n    for (let i = 0, ii = pixels.length; i < ii; i += 4) {\n      if (pixels[i] > 0) {\n        ascent = DEFAULT_FONT_SIZE - Math.floor(i / 4 / DEFAULT_FONT_SIZE);\n        break;\n      }\n    }\n    ctx.canvas.width = ctx.canvas.height = 0;\n    ctx.font = savedFont;\n    const ratio = ascent ? ascent / (ascent + descent) : DEFAULT_FONT_ASCENT;\n    this.#ascentCache.set(fontFamily, ratio);\n    return ratio;\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/xfa_text.js\nclass XfaText {\n  static textContent(xfa) {\n    const items = [];\n    const output = {\n      items,\n      styles: Object.create(null)\n    };\n    function walk(node) {\n      if (!node) {\n        return;\n      }\n      let str = null;\n      const name = node.name;\n      if (name === \"#text\") {\n        str = node.value;\n      } else if (!XfaText.shouldBuildText(name)) {\n        return;\n      } else if (node?.attributes?.textContent) {\n        str = node.attributes.textContent;\n      } else if (node.value) {\n        str = node.value;\n      }\n      if (str !== null) {\n        items.push({\n          str\n        });\n      }\n      if (!node.children) {\n        return;\n      }\n      for (const child of node.children) {\n        walk(child);\n      }\n    }\n    walk(xfa);\n    return output;\n  }\n  static shouldBuildText(name) {\n    return !(name === \"textarea\" || name === \"input\" || name === \"option\" || name === \"select\");\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/api.js\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst DEFAULT_RANGE_CHUNK_SIZE = 65536;\nconst RENDERING_CANCELLED_TIMEOUT = 100;\nconst DELAYED_CLEANUP_TIMEOUT = 5000;\nconst DefaultCanvasFactory = isNodeJS ? NodeCanvasFactory : DOMCanvasFactory;\nconst DefaultCMapReaderFactory = isNodeJS ? NodeCMapReaderFactory : DOMCMapReaderFactory;\nconst DefaultFilterFactory = isNodeJS ? NodeFilterFactory : DOMFilterFactory;\nconst DefaultStandardFontDataFactory = isNodeJS ? NodeStandardFontDataFactory : DOMStandardFontDataFactory;\nfunction getDocument(src = {}) {\n  if (typeof src === \"string\" || src instanceof URL) {\n    src = {\n      url: src\n    };\n  } else if (src instanceof ArrayBuffer || ArrayBuffer.isView(src)) {\n    src = {\n      data: src\n    };\n  }\n  const task = new PDFDocumentLoadingTask();\n  const {\n    docId\n  } = task;\n  const url = src.url ? getUrlProp(src.url) : null;\n  const data = src.data ? getDataProp(src.data) : null;\n  const httpHeaders = src.httpHeaders || null;\n  const withCredentials = src.withCredentials === true;\n  const password = src.password ?? null;\n  const rangeTransport = src.range instanceof PDFDataRangeTransport ? src.range : null;\n  const rangeChunkSize = Number.isInteger(src.rangeChunkSize) && src.rangeChunkSize > 0 ? src.rangeChunkSize : DEFAULT_RANGE_CHUNK_SIZE;\n  let worker = src.worker instanceof PDFWorker ? src.worker : null;\n  const verbosity = src.verbosity;\n  const docBaseUrl = typeof src.docBaseUrl === \"string\" && !isDataScheme(src.docBaseUrl) ? src.docBaseUrl : null;\n  const cMapUrl = typeof src.cMapUrl === \"string\" ? src.cMapUrl : null;\n  const cMapPacked = src.cMapPacked !== false;\n  const CMapReaderFactory = src.CMapReaderFactory || DefaultCMapReaderFactory;\n  const standardFontDataUrl = typeof src.standardFontDataUrl === \"string\" ? src.standardFontDataUrl : null;\n  const StandardFontDataFactory = src.StandardFontDataFactory || DefaultStandardFontDataFactory;\n  const ignoreErrors = src.stopAtErrors !== true;\n  const maxImageSize = Number.isInteger(src.maxImageSize) && src.maxImageSize > -1 ? src.maxImageSize : -1;\n  const isEvalSupported = src.isEvalSupported !== false;\n  const isOffscreenCanvasSupported = typeof src.isOffscreenCanvasSupported === \"boolean\" ? src.isOffscreenCanvasSupported : !isNodeJS;\n  const canvasMaxAreaInBytes = Number.isInteger(src.canvasMaxAreaInBytes) ? src.canvasMaxAreaInBytes : -1;\n  const disableFontFace = typeof src.disableFontFace === \"boolean\" ? src.disableFontFace : isNodeJS;\n  const fontExtraProperties = src.fontExtraProperties === true;\n  const enableXfa = src.enableXfa === true;\n  const ownerDocument = src.ownerDocument || globalThis.document;\n  const disableRange = src.disableRange === true;\n  const disableStream = src.disableStream === true;\n  const disableAutoFetch = src.disableAutoFetch === true;\n  const pdfBug = src.pdfBug === true;\n  const enableHWA = src.enableHWA === true;\n  const length = rangeTransport ? rangeTransport.length : src.length ?? NaN;\n  const useSystemFonts = typeof src.useSystemFonts === \"boolean\" ? src.useSystemFonts : !isNodeJS && !disableFontFace;\n  const useWorkerFetch = typeof src.useWorkerFetch === \"boolean\" ? src.useWorkerFetch : CMapReaderFactory === DOMCMapReaderFactory && StandardFontDataFactory === DOMStandardFontDataFactory && cMapUrl && standardFontDataUrl && isValidFetchUrl(cMapUrl, document.baseURI) && isValidFetchUrl(standardFontDataUrl, document.baseURI);\n  const canvasFactory = src.canvasFactory || new DefaultCanvasFactory({\n    ownerDocument,\n    enableHWA\n  });\n  const filterFactory = src.filterFactory || new DefaultFilterFactory({\n    docId,\n    ownerDocument\n  });\n  const styleElement = null;\n  setVerbosityLevel(verbosity);\n  const transportFactory = {\n    canvasFactory,\n    filterFactory\n  };\n  if (!useWorkerFetch) {\n    transportFactory.cMapReaderFactory = new CMapReaderFactory({\n      baseUrl: cMapUrl,\n      isCompressed: cMapPacked\n    });\n    transportFactory.standardFontDataFactory = new StandardFontDataFactory({\n      baseUrl: standardFontDataUrl\n    });\n  }\n  if (!worker) {\n    const workerParams = {\n      verbosity,\n      port: GlobalWorkerOptions.workerPort\n    };\n    worker = workerParams.port ? PDFWorker.fromPort(workerParams) : new PDFWorker(workerParams);\n    task._worker = worker;\n  }\n  const docParams = {\n    docId,\n    apiVersion: \"4.6.82\",\n    data,\n    password,\n    disableAutoFetch,\n    rangeChunkSize,\n    length,\n    docBaseUrl,\n    enableXfa,\n    evaluatorOptions: {\n      maxImageSize,\n      disableFontFace,\n      ignoreErrors,\n      isEvalSupported,\n      isOffscreenCanvasSupported,\n      canvasMaxAreaInBytes,\n      fontExtraProperties,\n      useSystemFonts,\n      cMapUrl: useWorkerFetch ? cMapUrl : null,\n      standardFontDataUrl: useWorkerFetch ? standardFontDataUrl : null\n    }\n  };\n  const transportParams = {\n    disableFontFace,\n    fontExtraProperties,\n    ownerDocument,\n    pdfBug,\n    styleElement,\n    loadingParams: {\n      disableAutoFetch,\n      enableXfa\n    }\n  };\n  worker.promise.then(function () {\n    if (task.destroyed) {\n      throw new Error(\"Loading aborted\");\n    }\n    if (worker.destroyed) {\n      throw new Error(\"Worker was destroyed\");\n    }\n    const workerIdPromise = worker.messageHandler.sendWithPromise(\"GetDocRequest\", docParams, data ? [data.buffer] : null);\n    let networkStream;\n    if (rangeTransport) {\n      networkStream = new PDFDataTransportStream(rangeTransport, {\n        disableRange,\n        disableStream\n      });\n    } else if (!data) {\n      if (!url) {\n        throw new Error(\"getDocument - no `url` parameter provided.\");\n      }\n      const createPDFNetworkStream = params => {\n        if (isNodeJS) {\n          const isFetchSupported = function () {\n            return typeof fetch !== \"undefined\" && typeof Response !== \"undefined\" && \"body\" in Response.prototype;\n          };\n          return isFetchSupported() && isValidFetchUrl(params.url) ? new PDFFetchStream(params) : new PDFNodeStream(params);\n        }\n        return isValidFetchUrl(params.url) ? new PDFFetchStream(params) : new PDFNetworkStream(params);\n      };\n      networkStream = createPDFNetworkStream({\n        url,\n        length,\n        httpHeaders,\n        withCredentials,\n        rangeChunkSize,\n        disableRange,\n        disableStream\n      });\n    }\n    return workerIdPromise.then(workerId => {\n      if (task.destroyed) {\n        throw new Error(\"Loading aborted\");\n      }\n      if (worker.destroyed) {\n        throw new Error(\"Worker was destroyed\");\n      }\n      const messageHandler = new MessageHandler(docId, workerId, worker.port);\n      const transport = new WorkerTransport(messageHandler, task, networkStream, transportParams, transportFactory);\n      task._transport = transport;\n      messageHandler.send(\"Ready\", null);\n    });\n  }).catch(task._capability.reject);\n  return task;\n}\nfunction getUrlProp(val) {\n  if (val instanceof URL) {\n    return val.href;\n  }\n  try {\n    return new URL(val, window.location).href;\n  } catch {\n    if (isNodeJS && typeof val === \"string\") {\n      return val;\n    }\n  }\n  throw new Error(\"Invalid PDF url data: \" + \"either string or URL-object is expected in the url property.\");\n}\nfunction getDataProp(val) {\n  if (isNodeJS && typeof Buffer !== \"undefined\" && val instanceof Buffer) {\n    throw new Error(\"Please provide binary data as `Uint8Array`, rather than `Buffer`.\");\n  }\n  if (val instanceof Uint8Array && val.byteLength === val.buffer.byteLength) {\n    return val;\n  }\n  if (typeof val === \"string\") {\n    return stringToBytes(val);\n  }\n  if (val instanceof ArrayBuffer || ArrayBuffer.isView(val) || typeof val === \"object\" && !isNaN(val?.length)) {\n    return new Uint8Array(val);\n  }\n  throw new Error(\"Invalid PDF binary data: either TypedArray, \" + \"string, or array-like object is expected in the data property.\");\n}\nfunction isRefProxy(ref) {\n  return typeof ref === \"object\" && Number.isInteger(ref?.num) && ref.num >= 0 && Number.isInteger(ref?.gen) && ref.gen >= 0;\n}\nclass PDFDocumentLoadingTask {\n  static #docId = 0;\n  constructor() {\n    this._capability = Promise.withResolvers();\n    this._transport = null;\n    this._worker = null;\n    this.docId = `d${PDFDocumentLoadingTask.#docId++}`;\n    this.destroyed = false;\n    this.onPassword = null;\n    this.onProgress = null;\n  }\n  get promise() {\n    return this._capability.promise;\n  }\n  async destroy() {\n    this.destroyed = true;\n    try {\n      if (this._worker?.port) {\n        this._worker._pendingDestroy = true;\n      }\n      await this._transport?.destroy();\n    } catch (ex) {\n      if (this._worker?.port) {\n        delete this._worker._pendingDestroy;\n      }\n      throw ex;\n    }\n    this._transport = null;\n    if (this._worker) {\n      this._worker.destroy();\n      this._worker = null;\n    }\n  }\n}\nclass PDFDataRangeTransport {\n  constructor(length, initialData, progressiveDone = false, contentDispositionFilename = null) {\n    this.length = length;\n    this.initialData = initialData;\n    this.progressiveDone = progressiveDone;\n    this.contentDispositionFilename = contentDispositionFilename;\n    this._rangeListeners = [];\n    this._progressListeners = [];\n    this._progressiveReadListeners = [];\n    this._progressiveDoneListeners = [];\n    this._readyCapability = Promise.withResolvers();\n  }\n  addRangeListener(listener) {\n    this._rangeListeners.push(listener);\n  }\n  addProgressListener(listener) {\n    this._progressListeners.push(listener);\n  }\n  addProgressiveReadListener(listener) {\n    this._progressiveReadListeners.push(listener);\n  }\n  addProgressiveDoneListener(listener) {\n    this._progressiveDoneListeners.push(listener);\n  }\n  onDataRange(begin, chunk) {\n    for (const listener of this._rangeListeners) {\n      listener(begin, chunk);\n    }\n  }\n  onDataProgress(loaded, total) {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressListeners) {\n        listener(loaded, total);\n      }\n    });\n  }\n  onDataProgressiveRead(chunk) {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressiveReadListeners) {\n        listener(chunk);\n      }\n    });\n  }\n  onDataProgressiveDone() {\n    this._readyCapability.promise.then(() => {\n      for (const listener of this._progressiveDoneListeners) {\n        listener();\n      }\n    });\n  }\n  transportReady() {\n    this._readyCapability.resolve();\n  }\n  requestDataRange(begin, end) {\n    unreachable(\"Abstract method PDFDataRangeTransport.requestDataRange\");\n  }\n  abort() {}\n}\nclass PDFDocumentProxy {\n  constructor(pdfInfo, transport) {\n    this._pdfInfo = pdfInfo;\n    this._transport = transport;\n  }\n  get annotationStorage() {\n    return this._transport.annotationStorage;\n  }\n  get filterFactory() {\n    return this._transport.filterFactory;\n  }\n  get numPages() {\n    return this._pdfInfo.numPages;\n  }\n  get fingerprints() {\n    return this._pdfInfo.fingerprints;\n  }\n  get isPureXfa() {\n    return shadow(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n  }\n  get allXfaHtml() {\n    return this._transport._htmlForXfa;\n  }\n  getPage(pageNumber) {\n    return this._transport.getPage(pageNumber);\n  }\n  getPageIndex(ref) {\n    return this._transport.getPageIndex(ref);\n  }\n  getDestinations() {\n    return this._transport.getDestinations();\n  }\n  getDestination(id) {\n    return this._transport.getDestination(id);\n  }\n  getPageLabels() {\n    return this._transport.getPageLabels();\n  }\n  getPageLayout() {\n    return this._transport.getPageLayout();\n  }\n  getPageMode() {\n    return this._transport.getPageMode();\n  }\n  getViewerPreferences() {\n    return this._transport.getViewerPreferences();\n  }\n  getOpenAction() {\n    return this._transport.getOpenAction();\n  }\n  getAttachments() {\n    return this._transport.getAttachments();\n  }\n  getJSActions() {\n    return this._transport.getDocJSActions();\n  }\n  getOutline() {\n    return this._transport.getOutline();\n  }\n  getOptionalContentConfig({\n    intent = \"display\"\n  } = {}) {\n    const {\n      renderingIntent\n    } = this._transport.getRenderingIntent(intent);\n    return this._transport.getOptionalContentConfig(renderingIntent);\n  }\n  getPermissions() {\n    return this._transport.getPermissions();\n  }\n  getMetadata() {\n    return this._transport.getMetadata();\n  }\n  getMarkInfo() {\n    return this._transport.getMarkInfo();\n  }\n  getData() {\n    return this._transport.getData();\n  }\n  saveDocument() {\n    return this._transport.saveDocument();\n  }\n  getDownloadInfo() {\n    return this._transport.downloadInfoCapability.promise;\n  }\n  cleanup(keepLoadedFonts = false) {\n    return this._transport.startCleanup(keepLoadedFonts || this.isPureXfa);\n  }\n  destroy() {\n    return this.loadingTask.destroy();\n  }\n  cachedPageNumber(ref) {\n    return this._transport.cachedPageNumber(ref);\n  }\n  get loadingParams() {\n    return this._transport.loadingParams;\n  }\n  get loadingTask() {\n    return this._transport.loadingTask;\n  }\n  getFieldObjects() {\n    return this._transport.getFieldObjects();\n  }\n  hasJSActions() {\n    return this._transport.hasJSActions();\n  }\n  getCalculationOrderIds() {\n    return this._transport.getCalculationOrderIds();\n  }\n}\nclass PDFPageProxy {\n  #delayedCleanupTimeout = null;\n  #pendingCleanup = false;\n  constructor(pageIndex, pageInfo, transport, pdfBug = false) {\n    this._pageIndex = pageIndex;\n    this._pageInfo = pageInfo;\n    this._transport = transport;\n    this._stats = pdfBug ? new StatTimer() : null;\n    this._pdfBug = pdfBug;\n    this.commonObjs = transport.commonObjs;\n    this.objs = new PDFObjects();\n    this._maybeCleanupAfterRender = false;\n    this._intentStates = new Map();\n    this.destroyed = false;\n  }\n  get pageNumber() {\n    return this._pageIndex + 1;\n  }\n  get rotate() {\n    return this._pageInfo.rotate;\n  }\n  get ref() {\n    return this._pageInfo.ref;\n  }\n  get userUnit() {\n    return this._pageInfo.userUnit;\n  }\n  get view() {\n    return this._pageInfo.view;\n  }\n  getViewport({\n    scale,\n    rotation = this.rotate,\n    offsetX = 0,\n    offsetY = 0,\n    dontFlip = false\n  } = {}) {\n    return new PageViewport({\n      viewBox: this.view,\n      scale,\n      rotation,\n      offsetX,\n      offsetY,\n      dontFlip\n    });\n  }\n  getAnnotations({\n    intent = \"display\"\n  } = {}) {\n    const {\n      renderingIntent\n    } = this._transport.getRenderingIntent(intent);\n    return this._transport.getAnnotations(this._pageIndex, renderingIntent);\n  }\n  getJSActions() {\n    return this._transport.getPageJSActions(this._pageIndex);\n  }\n  get filterFactory() {\n    return this._transport.filterFactory;\n  }\n  get isPureXfa() {\n    return shadow(this, \"isPureXfa\", !!this._transport._htmlForXfa);\n  }\n  async getXfa() {\n    return this._transport._htmlForXfa?.children[this._pageIndex] || null;\n  }\n  render({\n    canvasContext,\n    viewport,\n    intent = \"display\",\n    annotationMode = AnnotationMode.ENABLE,\n    transform = null,\n    background = null,\n    optionalContentConfigPromise = null,\n    annotationCanvasMap = null,\n    pageColors = null,\n    printAnnotationStorage = null,\n    isEditing = false\n  }) {\n    this._stats?.time(\"Overall\");\n    const intentArgs = this._transport.getRenderingIntent(intent, annotationMode, printAnnotationStorage, isEditing);\n    const {\n      renderingIntent,\n      cacheKey\n    } = intentArgs;\n    this.#pendingCleanup = false;\n    this.#abortDelayedCleanup();\n    optionalContentConfigPromise ||= this._transport.getOptionalContentConfig(renderingIntent);\n    let intentState = this._intentStates.get(cacheKey);\n    if (!intentState) {\n      intentState = Object.create(null);\n      this._intentStates.set(cacheKey, intentState);\n    }\n    if (intentState.streamReaderCancelTimeout) {\n      clearTimeout(intentState.streamReaderCancelTimeout);\n      intentState.streamReaderCancelTimeout = null;\n    }\n    const intentPrint = !!(renderingIntent & RenderingIntentFlag.PRINT);\n    if (!intentState.displayReadyCapability) {\n      intentState.displayReadyCapability = Promise.withResolvers();\n      intentState.operatorList = {\n        fnArray: [],\n        argsArray: [],\n        lastChunk: false,\n        separateAnnots: null\n      };\n      this._stats?.time(\"Page Request\");\n      this._pumpOperatorList(intentArgs);\n    }\n    const complete = error => {\n      intentState.renderTasks.delete(internalRenderTask);\n      if (this._maybeCleanupAfterRender || intentPrint) {\n        this.#pendingCleanup = true;\n      }\n      this.#tryCleanup(!intentPrint);\n      if (error) {\n        internalRenderTask.capability.reject(error);\n        this._abortOperatorList({\n          intentState,\n          reason: error instanceof Error ? error : new Error(error)\n        });\n      } else {\n        internalRenderTask.capability.resolve();\n      }\n      if (this._stats) {\n        this._stats.timeEnd(\"Rendering\");\n        this._stats.timeEnd(\"Overall\");\n        if (globalThis.Stats?.enabled) {\n          globalThis.Stats.add(this.pageNumber, this._stats);\n        }\n      }\n    };\n    const internalRenderTask = new InternalRenderTask({\n      callback: complete,\n      params: {\n        canvasContext,\n        viewport,\n        transform,\n        background\n      },\n      objs: this.objs,\n      commonObjs: this.commonObjs,\n      annotationCanvasMap,\n      operatorList: intentState.operatorList,\n      pageIndex: this._pageIndex,\n      canvasFactory: this._transport.canvasFactory,\n      filterFactory: this._transport.filterFactory,\n      useRequestAnimationFrame: !intentPrint,\n      pdfBug: this._pdfBug,\n      pageColors\n    });\n    (intentState.renderTasks ||= new Set()).add(internalRenderTask);\n    const renderTask = internalRenderTask.task;\n    Promise.all([intentState.displayReadyCapability.promise, optionalContentConfigPromise]).then(([transparency, optionalContentConfig]) => {\n      if (this.destroyed) {\n        complete();\n        return;\n      }\n      this._stats?.time(\"Rendering\");\n      if (!(optionalContentConfig.renderingIntent & renderingIntent)) {\n        throw new Error(\"Must use the same `intent`-argument when calling the `PDFPageProxy.render` \" + \"and `PDFDocumentProxy.getOptionalContentConfig` methods.\");\n      }\n      internalRenderTask.initializeGraphics({\n        transparency,\n        optionalContentConfig\n      });\n      internalRenderTask.operatorListChanged();\n    }).catch(complete);\n    return renderTask;\n  }\n  getOperatorList({\n    intent = \"display\",\n    annotationMode = AnnotationMode.ENABLE,\n    printAnnotationStorage = null,\n    isEditing = false\n  } = {}) {\n    function operatorListChanged() {\n      if (intentState.operatorList.lastChunk) {\n        intentState.opListReadCapability.resolve(intentState.operatorList);\n        intentState.renderTasks.delete(opListTask);\n      }\n    }\n    const intentArgs = this._transport.getRenderingIntent(intent, annotationMode, printAnnotationStorage, isEditing, true);\n    let intentState = this._intentStates.get(intentArgs.cacheKey);\n    if (!intentState) {\n      intentState = Object.create(null);\n      this._intentStates.set(intentArgs.cacheKey, intentState);\n    }\n    let opListTask;\n    if (!intentState.opListReadCapability) {\n      opListTask = Object.create(null);\n      opListTask.operatorListChanged = operatorListChanged;\n      intentState.opListReadCapability = Promise.withResolvers();\n      (intentState.renderTasks ||= new Set()).add(opListTask);\n      intentState.operatorList = {\n        fnArray: [],\n        argsArray: [],\n        lastChunk: false,\n        separateAnnots: null\n      };\n      this._stats?.time(\"Page Request\");\n      this._pumpOperatorList(intentArgs);\n    }\n    return intentState.opListReadCapability.promise;\n  }\n  streamTextContent({\n    includeMarkedContent = false,\n    disableNormalization = false\n  } = {}) {\n    const TEXT_CONTENT_CHUNK_SIZE = 100;\n    return this._transport.messageHandler.sendWithStream(\"GetTextContent\", {\n      pageIndex: this._pageIndex,\n      includeMarkedContent: includeMarkedContent === true,\n      disableNormalization: disableNormalization === true\n    }, {\n      highWaterMark: TEXT_CONTENT_CHUNK_SIZE,\n      size(textContent) {\n        return textContent.items.length;\n      }\n    });\n  }\n  getTextContent(params = {}) {\n    if (this._transport._htmlForXfa) {\n      return this.getXfa().then(xfa => XfaText.textContent(xfa));\n    }\n    const readableStream = this.streamTextContent(params);\n    return new Promise(function (resolve, reject) {\n      function pump() {\n        reader.read().then(function ({\n          value,\n          done\n        }) {\n          if (done) {\n            resolve(textContent);\n            return;\n          }\n          textContent.lang ??= value.lang;\n          Object.assign(textContent.styles, value.styles);\n          textContent.items.push(...value.items);\n          pump();\n        }, reject);\n      }\n      const reader = readableStream.getReader();\n      const textContent = {\n        items: [],\n        styles: Object.create(null),\n        lang: null\n      };\n      pump();\n    });\n  }\n  getStructTree() {\n    return this._transport.getStructTree(this._pageIndex);\n  }\n  _destroy() {\n    this.destroyed = true;\n    const waitOn = [];\n    for (const intentState of this._intentStates.values()) {\n      this._abortOperatorList({\n        intentState,\n        reason: new Error(\"Page was destroyed.\"),\n        force: true\n      });\n      if (intentState.opListReadCapability) {\n        continue;\n      }\n      for (const internalRenderTask of intentState.renderTasks) {\n        waitOn.push(internalRenderTask.completed);\n        internalRenderTask.cancel();\n      }\n    }\n    this.objs.clear();\n    this.#pendingCleanup = false;\n    this.#abortDelayedCleanup();\n    return Promise.all(waitOn);\n  }\n  cleanup(resetStats = false) {\n    this.#pendingCleanup = true;\n    const success = this.#tryCleanup(false);\n    if (resetStats && success) {\n      this._stats &&= new StatTimer();\n    }\n    return success;\n  }\n  #tryCleanup(delayed = false) {\n    this.#abortDelayedCleanup();\n    if (!this.#pendingCleanup || this.destroyed) {\n      return false;\n    }\n    if (delayed) {\n      this.#delayedCleanupTimeout = setTimeout(() => {\n        this.#delayedCleanupTimeout = null;\n        this.#tryCleanup(false);\n      }, DELAYED_CLEANUP_TIMEOUT);\n      return false;\n    }\n    for (const {\n      renderTasks,\n      operatorList\n    } of this._intentStates.values()) {\n      if (renderTasks.size > 0 || !operatorList.lastChunk) {\n        return false;\n      }\n    }\n    this._intentStates.clear();\n    this.objs.clear();\n    this.#pendingCleanup = false;\n    return true;\n  }\n  #abortDelayedCleanup() {\n    if (this.#delayedCleanupTimeout) {\n      clearTimeout(this.#delayedCleanupTimeout);\n      this.#delayedCleanupTimeout = null;\n    }\n  }\n  _startRenderPage(transparency, cacheKey) {\n    const intentState = this._intentStates.get(cacheKey);\n    if (!intentState) {\n      return;\n    }\n    this._stats?.timeEnd(\"Page Request\");\n    intentState.displayReadyCapability?.resolve(transparency);\n  }\n  _renderPageChunk(operatorListChunk, intentState) {\n    for (let i = 0, ii = operatorListChunk.length; i < ii; i++) {\n      intentState.operatorList.fnArray.push(operatorListChunk.fnArray[i]);\n      intentState.operatorList.argsArray.push(operatorListChunk.argsArray[i]);\n    }\n    intentState.operatorList.lastChunk = operatorListChunk.lastChunk;\n    intentState.operatorList.separateAnnots = operatorListChunk.separateAnnots;\n    for (const internalRenderTask of intentState.renderTasks) {\n      internalRenderTask.operatorListChanged();\n    }\n    if (operatorListChunk.lastChunk) {\n      this.#tryCleanup(true);\n    }\n  }\n  _pumpOperatorList({\n    renderingIntent,\n    cacheKey,\n    annotationStorageSerializable,\n    modifiedIds\n  }) {\n    const {\n      map,\n      transfer\n    } = annotationStorageSerializable;\n    const readableStream = this._transport.messageHandler.sendWithStream(\"GetOperatorList\", {\n      pageIndex: this._pageIndex,\n      intent: renderingIntent,\n      cacheKey,\n      annotationStorage: map,\n      modifiedIds\n    }, transfer);\n    const reader = readableStream.getReader();\n    const intentState = this._intentStates.get(cacheKey);\n    intentState.streamReader = reader;\n    const pump = () => {\n      reader.read().then(({\n        value,\n        done\n      }) => {\n        if (done) {\n          intentState.streamReader = null;\n          return;\n        }\n        if (this._transport.destroyed) {\n          return;\n        }\n        this._renderPageChunk(value, intentState);\n        pump();\n      }, reason => {\n        intentState.streamReader = null;\n        if (this._transport.destroyed) {\n          return;\n        }\n        if (intentState.operatorList) {\n          intentState.operatorList.lastChunk = true;\n          for (const internalRenderTask of intentState.renderTasks) {\n            internalRenderTask.operatorListChanged();\n          }\n          this.#tryCleanup(true);\n        }\n        if (intentState.displayReadyCapability) {\n          intentState.displayReadyCapability.reject(reason);\n        } else if (intentState.opListReadCapability) {\n          intentState.opListReadCapability.reject(reason);\n        } else {\n          throw reason;\n        }\n      });\n    };\n    pump();\n  }\n  _abortOperatorList({\n    intentState,\n    reason,\n    force = false\n  }) {\n    if (!intentState.streamReader) {\n      return;\n    }\n    if (intentState.streamReaderCancelTimeout) {\n      clearTimeout(intentState.streamReaderCancelTimeout);\n      intentState.streamReaderCancelTimeout = null;\n    }\n    if (!force) {\n      if (intentState.renderTasks.size > 0) {\n        return;\n      }\n      if (reason instanceof RenderingCancelledException) {\n        let delay = RENDERING_CANCELLED_TIMEOUT;\n        if (reason.extraDelay > 0 && reason.extraDelay < 1000) {\n          delay += reason.extraDelay;\n        }\n        intentState.streamReaderCancelTimeout = setTimeout(() => {\n          intentState.streamReaderCancelTimeout = null;\n          this._abortOperatorList({\n            intentState,\n            reason,\n            force: true\n          });\n        }, delay);\n        return;\n      }\n    }\n    intentState.streamReader.cancel(new AbortException(reason.message)).catch(() => {});\n    intentState.streamReader = null;\n    if (this._transport.destroyed) {\n      return;\n    }\n    for (const [curCacheKey, curIntentState] of this._intentStates) {\n      if (curIntentState === intentState) {\n        this._intentStates.delete(curCacheKey);\n        break;\n      }\n    }\n    this.cleanup();\n  }\n  get stats() {\n    return this._stats;\n  }\n}\nclass LoopbackPort {\n  #listeners = new Set();\n  #deferred = Promise.resolve();\n  postMessage(obj, transfer) {\n    const event = {\n      data: structuredClone(obj, transfer ? {\n        transfer\n      } : null)\n    };\n    this.#deferred.then(() => {\n      for (const listener of this.#listeners) {\n        listener.call(this, event);\n      }\n    });\n  }\n  addEventListener(name, listener) {\n    this.#listeners.add(listener);\n  }\n  removeEventListener(name, listener) {\n    this.#listeners.delete(listener);\n  }\n  terminate() {\n    this.#listeners.clear();\n  }\n}\nclass PDFWorker {\n  static #fakeWorkerId = 0;\n  static #isWorkerDisabled = false;\n  static #workerPorts;\n  static {\n    if (isNodeJS) {\n      this.#isWorkerDisabled = true;\n      GlobalWorkerOptions.workerSrc ||= \"./pdf.worker.mjs\";\n    }\n    this._isSameOrigin = (baseUrl, otherUrl) => {\n      let base;\n      try {\n        base = new URL(baseUrl);\n        if (!base.origin || base.origin === \"null\") {\n          return false;\n        }\n      } catch {\n        return false;\n      }\n      const other = new URL(otherUrl, base);\n      return base.origin === other.origin;\n    };\n    this._createCDNWrapper = url => {\n      const wrapper = `await import(\"${url}\");`;\n      return URL.createObjectURL(new Blob([wrapper], {\n        type: \"text/javascript\"\n      }));\n    };\n  }\n  constructor({\n    name = null,\n    port = null,\n    verbosity = getVerbosityLevel()\n  } = {}) {\n    this.name = name;\n    this.destroyed = false;\n    this.verbosity = verbosity;\n    this._readyCapability = Promise.withResolvers();\n    this._port = null;\n    this._webWorker = null;\n    this._messageHandler = null;\n    if (port) {\n      if (PDFWorker.#workerPorts?.has(port)) {\n        throw new Error(\"Cannot use more than one PDFWorker per port.\");\n      }\n      (PDFWorker.#workerPorts ||= new WeakMap()).set(port, this);\n      this._initializeFromPort(port);\n      return;\n    }\n    this._initialize();\n  }\n  get promise() {\n    if (isNodeJS) {\n      return Promise.all([NodePackages.promise, this._readyCapability.promise]);\n    }\n    return this._readyCapability.promise;\n  }\n  #resolve() {\n    this._readyCapability.resolve();\n    this._messageHandler.send(\"configure\", {\n      verbosity: this.verbosity\n    });\n  }\n  get port() {\n    return this._port;\n  }\n  get messageHandler() {\n    return this._messageHandler;\n  }\n  _initializeFromPort(port) {\n    this._port = port;\n    this._messageHandler = new MessageHandler(\"main\", \"worker\", port);\n    this._messageHandler.on(\"ready\", function () {});\n    this.#resolve();\n  }\n  _initialize() {\n    if (PDFWorker.#isWorkerDisabled || PDFWorker.#mainThreadWorkerMessageHandler) {\n      this._setupFakeWorker();\n      return;\n    }\n    let {\n      workerSrc\n    } = PDFWorker;\n    try {\n      if (!PDFWorker._isSameOrigin(window.location.href, workerSrc)) {\n        workerSrc = PDFWorker._createCDNWrapper(new URL(workerSrc, window.location).href);\n      }\n      const worker = new Worker(workerSrc, {\n        type: \"module\"\n      });\n      const messageHandler = new MessageHandler(\"main\", \"worker\", worker);\n      const terminateEarly = () => {\n        ac.abort();\n        messageHandler.destroy();\n        worker.terminate();\n        if (this.destroyed) {\n          this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n        } else {\n          this._setupFakeWorker();\n        }\n      };\n      const ac = new AbortController();\n      worker.addEventListener(\"error\", () => {\n        if (!this._webWorker) {\n          terminateEarly();\n        }\n      }, {\n        signal: ac.signal\n      });\n      messageHandler.on(\"test\", data => {\n        ac.abort();\n        if (this.destroyed || !data) {\n          terminateEarly();\n          return;\n        }\n        this._messageHandler = messageHandler;\n        this._port = worker;\n        this._webWorker = worker;\n        this.#resolve();\n      });\n      messageHandler.on(\"ready\", data => {\n        ac.abort();\n        if (this.destroyed) {\n          terminateEarly();\n          return;\n        }\n        try {\n          sendTest();\n        } catch {\n          this._setupFakeWorker();\n        }\n      });\n      const sendTest = () => {\n        const testObj = new Uint8Array();\n        messageHandler.send(\"test\", testObj, [testObj.buffer]);\n      };\n      sendTest();\n      return;\n    } catch {\n      info(\"The worker has been disabled.\");\n    }\n    this._setupFakeWorker();\n  }\n  _setupFakeWorker() {\n    if (!PDFWorker.#isWorkerDisabled) {\n      warn(\"Setting up fake worker.\");\n      PDFWorker.#isWorkerDisabled = true;\n    }\n    PDFWorker._setupFakeWorkerGlobal.then(WorkerMessageHandler => {\n      if (this.destroyed) {\n        this._readyCapability.reject(new Error(\"Worker was destroyed\"));\n        return;\n      }\n      const port = new LoopbackPort();\n      this._port = port;\n      const id = `fake${PDFWorker.#fakeWorkerId++}`;\n      const workerHandler = new MessageHandler(id + \"_worker\", id, port);\n      WorkerMessageHandler.setup(workerHandler, port);\n      this._messageHandler = new MessageHandler(id, id + \"_worker\", port);\n      this.#resolve();\n    }).catch(reason => {\n      this._readyCapability.reject(new Error(`Setting up fake worker failed: \"${reason.message}\".`));\n    });\n  }\n  destroy() {\n    this.destroyed = true;\n    if (this._webWorker) {\n      this._webWorker.terminate();\n      this._webWorker = null;\n    }\n    PDFWorker.#workerPorts?.delete(this._port);\n    this._port = null;\n    if (this._messageHandler) {\n      this._messageHandler.destroy();\n      this._messageHandler = null;\n    }\n  }\n  static fromPort(params) {\n    if (!params?.port) {\n      throw new Error(\"PDFWorker.fromPort - invalid method signature.\");\n    }\n    const cachedPort = this.#workerPorts?.get(params.port);\n    if (cachedPort) {\n      if (cachedPort._pendingDestroy) {\n        throw new Error(\"PDFWorker.fromPort - the worker is being destroyed.\\n\" + \"Please remember to await `PDFDocumentLoadingTask.destroy()`-calls.\");\n      }\n      return cachedPort;\n    }\n    return new PDFWorker(params);\n  }\n  static get workerSrc() {\n    if (GlobalWorkerOptions.workerSrc) {\n      return GlobalWorkerOptions.workerSrc;\n    }\n    throw new Error('No \"GlobalWorkerOptions.workerSrc\" specified.');\n  }\n  static get #mainThreadWorkerMessageHandler() {\n    try {\n      return globalThis.pdfjsWorker?.WorkerMessageHandler || null;\n    } catch {\n      return null;\n    }\n  }\n  static get _setupFakeWorkerGlobal() {\n    const loader = async () => {\n      if (this.#mainThreadWorkerMessageHandler) {\n        return this.#mainThreadWorkerMessageHandler;\n      }\n      const worker = await import( /*webpackIgnore: true*/this.workerSrc);\n      return worker.WorkerMessageHandler;\n    };\n    return shadow(this, \"_setupFakeWorkerGlobal\", loader());\n  }\n}\nclass WorkerTransport {\n  #methodPromises = new Map();\n  #pageCache = new Map();\n  #pagePromises = new Map();\n  #pageRefCache = new Map();\n  #passwordCapability = null;\n  constructor(messageHandler, loadingTask, networkStream, params, factory) {\n    this.messageHandler = messageHandler;\n    this.loadingTask = loadingTask;\n    this.commonObjs = new PDFObjects();\n    this.fontLoader = new FontLoader({\n      ownerDocument: params.ownerDocument,\n      styleElement: params.styleElement\n    });\n    this.loadingParams = params.loadingParams;\n    this._params = params;\n    this.canvasFactory = factory.canvasFactory;\n    this.filterFactory = factory.filterFactory;\n    this.cMapReaderFactory = factory.cMapReaderFactory;\n    this.standardFontDataFactory = factory.standardFontDataFactory;\n    this.destroyed = false;\n    this.destroyCapability = null;\n    this._networkStream = networkStream;\n    this._fullReader = null;\n    this._lastProgress = null;\n    this.downloadInfoCapability = Promise.withResolvers();\n    this.setupMessageHandler();\n  }\n  #cacheSimpleMethod(name, data = null) {\n    const cachedPromise = this.#methodPromises.get(name);\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n    const promise = this.messageHandler.sendWithPromise(name, data);\n    this.#methodPromises.set(name, promise);\n    return promise;\n  }\n  get annotationStorage() {\n    return shadow(this, \"annotationStorage\", new AnnotationStorage());\n  }\n  getRenderingIntent(intent, annotationMode = AnnotationMode.ENABLE, printAnnotationStorage = null, isEditing = false, isOpList = false) {\n    let renderingIntent = RenderingIntentFlag.DISPLAY;\n    let annotationStorageSerializable = SerializableEmpty;\n    switch (intent) {\n      case \"any\":\n        renderingIntent = RenderingIntentFlag.ANY;\n        break;\n      case \"display\":\n        break;\n      case \"print\":\n        renderingIntent = RenderingIntentFlag.PRINT;\n        break;\n      default:\n        warn(`getRenderingIntent - invalid intent: ${intent}`);\n    }\n    const annotationStorage = renderingIntent & RenderingIntentFlag.PRINT && printAnnotationStorage instanceof PrintAnnotationStorage ? printAnnotationStorage : this.annotationStorage;\n    switch (annotationMode) {\n      case AnnotationMode.DISABLE:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_DISABLE;\n        break;\n      case AnnotationMode.ENABLE:\n        break;\n      case AnnotationMode.ENABLE_FORMS:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_FORMS;\n        break;\n      case AnnotationMode.ENABLE_STORAGE:\n        renderingIntent += RenderingIntentFlag.ANNOTATIONS_STORAGE;\n        annotationStorageSerializable = annotationStorage.serializable;\n        break;\n      default:\n        warn(`getRenderingIntent - invalid annotationMode: ${annotationMode}`);\n    }\n    if (isEditing) {\n      renderingIntent += RenderingIntentFlag.IS_EDITING;\n    }\n    if (isOpList) {\n      renderingIntent += RenderingIntentFlag.OPLIST;\n    }\n    const {\n      ids: modifiedIds,\n      hash: modifiedIdsHash\n    } = annotationStorage.modifiedIds;\n    const cacheKeyBuf = [renderingIntent, annotationStorageSerializable.hash, modifiedIdsHash];\n    return {\n      renderingIntent,\n      cacheKey: cacheKeyBuf.join(\"_\"),\n      annotationStorageSerializable,\n      modifiedIds\n    };\n  }\n  destroy() {\n    if (this.destroyCapability) {\n      return this.destroyCapability.promise;\n    }\n    this.destroyed = true;\n    this.destroyCapability = Promise.withResolvers();\n    this.#passwordCapability?.reject(new Error(\"Worker was destroyed during onPassword callback\"));\n    const waitOn = [];\n    for (const page of this.#pageCache.values()) {\n      waitOn.push(page._destroy());\n    }\n    this.#pageCache.clear();\n    this.#pagePromises.clear();\n    this.#pageRefCache.clear();\n    if (this.hasOwnProperty(\"annotationStorage\")) {\n      this.annotationStorage.resetModified();\n    }\n    const terminated = this.messageHandler.sendWithPromise(\"Terminate\", null);\n    waitOn.push(terminated);\n    Promise.all(waitOn).then(() => {\n      this.commonObjs.clear();\n      this.fontLoader.clear();\n      this.#methodPromises.clear();\n      this.filterFactory.destroy();\n      TextLayer.cleanup();\n      this._networkStream?.cancelAllRequests(new AbortException(\"Worker was terminated.\"));\n      if (this.messageHandler) {\n        this.messageHandler.destroy();\n        this.messageHandler = null;\n      }\n      this.destroyCapability.resolve();\n    }, this.destroyCapability.reject);\n    return this.destroyCapability.promise;\n  }\n  setupMessageHandler() {\n    const {\n      messageHandler,\n      loadingTask\n    } = this;\n    messageHandler.on(\"GetReader\", (data, sink) => {\n      assert(this._networkStream, \"GetReader - no `IPDFStream` instance available.\");\n      this._fullReader = this._networkStream.getFullReader();\n      this._fullReader.onProgress = evt => {\n        this._lastProgress = {\n          loaded: evt.loaded,\n          total: evt.total\n        };\n      };\n      sink.onPull = () => {\n        this._fullReader.read().then(function ({\n          value,\n          done\n        }) {\n          if (done) {\n            sink.close();\n            return;\n          }\n          assert(value instanceof ArrayBuffer, \"GetReader - expected an ArrayBuffer.\");\n          sink.enqueue(new Uint8Array(value), 1, [value]);\n        }).catch(reason => {\n          sink.error(reason);\n        });\n      };\n      sink.onCancel = reason => {\n        this._fullReader.cancel(reason);\n        sink.ready.catch(readyReason => {\n          if (this.destroyed) {\n            return;\n          }\n          throw readyReason;\n        });\n      };\n    });\n    messageHandler.on(\"ReaderHeadersReady\", data => {\n      const headersCapability = Promise.withResolvers();\n      const fullReader = this._fullReader;\n      fullReader.headersReady.then(() => {\n        if (!fullReader.isStreamingSupported || !fullReader.isRangeSupported) {\n          if (this._lastProgress) {\n            loadingTask.onProgress?.(this._lastProgress);\n          }\n          fullReader.onProgress = evt => {\n            loadingTask.onProgress?.({\n              loaded: evt.loaded,\n              total: evt.total\n            });\n          };\n        }\n        headersCapability.resolve({\n          isStreamingSupported: fullReader.isStreamingSupported,\n          isRangeSupported: fullReader.isRangeSupported,\n          contentLength: fullReader.contentLength\n        });\n      }, headersCapability.reject);\n      return headersCapability.promise;\n    });\n    messageHandler.on(\"GetRangeReader\", (data, sink) => {\n      assert(this._networkStream, \"GetRangeReader - no `IPDFStream` instance available.\");\n      const rangeReader = this._networkStream.getRangeReader(data.begin, data.end);\n      if (!rangeReader) {\n        sink.close();\n        return;\n      }\n      sink.onPull = () => {\n        rangeReader.read().then(function ({\n          value,\n          done\n        }) {\n          if (done) {\n            sink.close();\n            return;\n          }\n          assert(value instanceof ArrayBuffer, \"GetRangeReader - expected an ArrayBuffer.\");\n          sink.enqueue(new Uint8Array(value), 1, [value]);\n        }).catch(reason => {\n          sink.error(reason);\n        });\n      };\n      sink.onCancel = reason => {\n        rangeReader.cancel(reason);\n        sink.ready.catch(readyReason => {\n          if (this.destroyed) {\n            return;\n          }\n          throw readyReason;\n        });\n      };\n    });\n    messageHandler.on(\"GetDoc\", ({\n      pdfInfo\n    }) => {\n      this._numPages = pdfInfo.numPages;\n      this._htmlForXfa = pdfInfo.htmlForXfa;\n      delete pdfInfo.htmlForXfa;\n      loadingTask._capability.resolve(new PDFDocumentProxy(pdfInfo, this));\n    });\n    messageHandler.on(\"DocException\", function (ex) {\n      let reason;\n      switch (ex.name) {\n        case \"PasswordException\":\n          reason = new PasswordException(ex.message, ex.code);\n          break;\n        case \"InvalidPDFException\":\n          reason = new InvalidPDFException(ex.message);\n          break;\n        case \"MissingPDFException\":\n          reason = new MissingPDFException(ex.message);\n          break;\n        case \"UnexpectedResponseException\":\n          reason = new UnexpectedResponseException(ex.message, ex.status);\n          break;\n        case \"UnknownErrorException\":\n          reason = new UnknownErrorException(ex.message, ex.details);\n          break;\n        default:\n          unreachable(\"DocException - expected a valid Error.\");\n      }\n      loadingTask._capability.reject(reason);\n    });\n    messageHandler.on(\"PasswordRequest\", exception => {\n      this.#passwordCapability = Promise.withResolvers();\n      if (loadingTask.onPassword) {\n        const updatePassword = password => {\n          if (password instanceof Error) {\n            this.#passwordCapability.reject(password);\n          } else {\n            this.#passwordCapability.resolve({\n              password\n            });\n          }\n        };\n        try {\n          loadingTask.onPassword(updatePassword, exception.code);\n        } catch (ex) {\n          this.#passwordCapability.reject(ex);\n        }\n      } else {\n        this.#passwordCapability.reject(new PasswordException(exception.message, exception.code));\n      }\n      return this.#passwordCapability.promise;\n    });\n    messageHandler.on(\"DataLoaded\", data => {\n      loadingTask.onProgress?.({\n        loaded: data.length,\n        total: data.length\n      });\n      this.downloadInfoCapability.resolve(data);\n    });\n    messageHandler.on(\"StartRenderPage\", data => {\n      if (this.destroyed) {\n        return;\n      }\n      const page = this.#pageCache.get(data.pageIndex);\n      page._startRenderPage(data.transparency, data.cacheKey);\n    });\n    messageHandler.on(\"commonobj\", ([id, type, exportedData]) => {\n      if (this.destroyed) {\n        return null;\n      }\n      if (this.commonObjs.has(id)) {\n        return null;\n      }\n      switch (type) {\n        case \"Font\":\n          const {\n            disableFontFace,\n            fontExtraProperties,\n            pdfBug\n          } = this._params;\n          if (\"error\" in exportedData) {\n            const exportedError = exportedData.error;\n            warn(`Error during font loading: ${exportedError}`);\n            this.commonObjs.resolve(id, exportedError);\n            break;\n          }\n          const inspectFont = pdfBug && globalThis.FontInspector?.enabled ? (font, url) => globalThis.FontInspector.fontAdded(font, url) : null;\n          const font = new FontFaceObject(exportedData, {\n            disableFontFace,\n            inspectFont\n          });\n          this.fontLoader.bind(font).catch(() => messageHandler.sendWithPromise(\"FontFallback\", {\n            id\n          })).finally(() => {\n            if (!fontExtraProperties && font.data) {\n              font.data = null;\n            }\n            this.commonObjs.resolve(id, font);\n          });\n          break;\n        case \"CopyLocalImage\":\n          const {\n            imageRef\n          } = exportedData;\n          assert(imageRef, \"The imageRef must be defined.\");\n          for (const pageProxy of this.#pageCache.values()) {\n            for (const [, data] of pageProxy.objs) {\n              if (data?.ref !== imageRef) {\n                continue;\n              }\n              if (!data.dataLen) {\n                return null;\n              }\n              this.commonObjs.resolve(id, structuredClone(data));\n              return data.dataLen;\n            }\n          }\n          break;\n        case \"FontPath\":\n        case \"Image\":\n        case \"Pattern\":\n          this.commonObjs.resolve(id, exportedData);\n          break;\n        default:\n          throw new Error(`Got unknown common object type ${type}`);\n      }\n      return null;\n    });\n    messageHandler.on(\"obj\", ([id, pageIndex, type, imageData]) => {\n      if (this.destroyed) {\n        return;\n      }\n      const pageProxy = this.#pageCache.get(pageIndex);\n      if (pageProxy.objs.has(id)) {\n        return;\n      }\n      if (pageProxy._intentStates.size === 0) {\n        imageData?.bitmap?.close();\n        return;\n      }\n      switch (type) {\n        case \"Image\":\n          pageProxy.objs.resolve(id, imageData);\n          if (imageData?.dataLen > MAX_IMAGE_SIZE_TO_CACHE) {\n            pageProxy._maybeCleanupAfterRender = true;\n          }\n          break;\n        case \"Pattern\":\n          pageProxy.objs.resolve(id, imageData);\n          break;\n        default:\n          throw new Error(`Got unknown object type ${type}`);\n      }\n    });\n    messageHandler.on(\"DocProgress\", data => {\n      if (this.destroyed) {\n        return;\n      }\n      loadingTask.onProgress?.({\n        loaded: data.loaded,\n        total: data.total\n      });\n    });\n    messageHandler.on(\"FetchBuiltInCMap\", data => {\n      if (this.destroyed) {\n        return Promise.reject(new Error(\"Worker was destroyed.\"));\n      }\n      if (!this.cMapReaderFactory) {\n        return Promise.reject(new Error(\"CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.\"));\n      }\n      return this.cMapReaderFactory.fetch(data);\n    });\n    messageHandler.on(\"FetchStandardFontData\", data => {\n      if (this.destroyed) {\n        return Promise.reject(new Error(\"Worker was destroyed.\"));\n      }\n      if (!this.standardFontDataFactory) {\n        return Promise.reject(new Error(\"StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.\"));\n      }\n      return this.standardFontDataFactory.fetch(data);\n    });\n  }\n  getData() {\n    return this.messageHandler.sendWithPromise(\"GetData\", null);\n  }\n  saveDocument() {\n    if (this.annotationStorage.size <= 0) {\n      warn(\"saveDocument called while `annotationStorage` is empty, \" + \"please use the getData-method instead.\");\n    }\n    const {\n      map,\n      transfer\n    } = this.annotationStorage.serializable;\n    return this.messageHandler.sendWithPromise(\"SaveDocument\", {\n      isPureXfa: !!this._htmlForXfa,\n      numPages: this._numPages,\n      annotationStorage: map,\n      filename: this._fullReader?.filename ?? null\n    }, transfer).finally(() => {\n      this.annotationStorage.resetModified();\n    });\n  }\n  getPage(pageNumber) {\n    if (!Number.isInteger(pageNumber) || pageNumber <= 0 || pageNumber > this._numPages) {\n      return Promise.reject(new Error(\"Invalid page request.\"));\n    }\n    const pageIndex = pageNumber - 1,\n      cachedPromise = this.#pagePromises.get(pageIndex);\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n    const promise = this.messageHandler.sendWithPromise(\"GetPage\", {\n      pageIndex\n    }).then(pageInfo => {\n      if (this.destroyed) {\n        throw new Error(\"Transport destroyed\");\n      }\n      if (pageInfo.refStr) {\n        this.#pageRefCache.set(pageInfo.refStr, pageNumber);\n      }\n      const page = new PDFPageProxy(pageIndex, pageInfo, this, this._params.pdfBug);\n      this.#pageCache.set(pageIndex, page);\n      return page;\n    });\n    this.#pagePromises.set(pageIndex, promise);\n    return promise;\n  }\n  getPageIndex(ref) {\n    if (!isRefProxy(ref)) {\n      return Promise.reject(new Error(\"Invalid pageIndex request.\"));\n    }\n    return this.messageHandler.sendWithPromise(\"GetPageIndex\", {\n      num: ref.num,\n      gen: ref.gen\n    });\n  }\n  getAnnotations(pageIndex, intent) {\n    return this.messageHandler.sendWithPromise(\"GetAnnotations\", {\n      pageIndex,\n      intent\n    });\n  }\n  getFieldObjects() {\n    return this.#cacheSimpleMethod(\"GetFieldObjects\");\n  }\n  hasJSActions() {\n    return this.#cacheSimpleMethod(\"HasJSActions\");\n  }\n  getCalculationOrderIds() {\n    return this.messageHandler.sendWithPromise(\"GetCalculationOrderIds\", null);\n  }\n  getDestinations() {\n    return this.messageHandler.sendWithPromise(\"GetDestinations\", null);\n  }\n  getDestination(id) {\n    if (typeof id !== \"string\") {\n      return Promise.reject(new Error(\"Invalid destination request.\"));\n    }\n    return this.messageHandler.sendWithPromise(\"GetDestination\", {\n      id\n    });\n  }\n  getPageLabels() {\n    return this.messageHandler.sendWithPromise(\"GetPageLabels\", null);\n  }\n  getPageLayout() {\n    return this.messageHandler.sendWithPromise(\"GetPageLayout\", null);\n  }\n  getPageMode() {\n    return this.messageHandler.sendWithPromise(\"GetPageMode\", null);\n  }\n  getViewerPreferences() {\n    return this.messageHandler.sendWithPromise(\"GetViewerPreferences\", null);\n  }\n  getOpenAction() {\n    return this.messageHandler.sendWithPromise(\"GetOpenAction\", null);\n  }\n  getAttachments() {\n    return this.messageHandler.sendWithPromise(\"GetAttachments\", null);\n  }\n  getDocJSActions() {\n    return this.#cacheSimpleMethod(\"GetDocJSActions\");\n  }\n  getPageJSActions(pageIndex) {\n    return this.messageHandler.sendWithPromise(\"GetPageJSActions\", {\n      pageIndex\n    });\n  }\n  getStructTree(pageIndex) {\n    return this.messageHandler.sendWithPromise(\"GetStructTree\", {\n      pageIndex\n    });\n  }\n  getOutline() {\n    return this.messageHandler.sendWithPromise(\"GetOutline\", null);\n  }\n  getOptionalContentConfig(renderingIntent) {\n    return this.#cacheSimpleMethod(\"GetOptionalContentConfig\").then(data => new OptionalContentConfig(data, renderingIntent));\n  }\n  getPermissions() {\n    return this.messageHandler.sendWithPromise(\"GetPermissions\", null);\n  }\n  getMetadata() {\n    const name = \"GetMetadata\",\n      cachedPromise = this.#methodPromises.get(name);\n    if (cachedPromise) {\n      return cachedPromise;\n    }\n    const promise = this.messageHandler.sendWithPromise(name, null).then(results => ({\n      info: results[0],\n      metadata: results[1] ? new Metadata(results[1]) : null,\n      contentDispositionFilename: this._fullReader?.filename ?? null,\n      contentLength: this._fullReader?.contentLength ?? null\n    }));\n    this.#methodPromises.set(name, promise);\n    return promise;\n  }\n  getMarkInfo() {\n    return this.messageHandler.sendWithPromise(\"GetMarkInfo\", null);\n  }\n  async startCleanup(keepLoadedFonts = false) {\n    if (this.destroyed) {\n      return;\n    }\n    await this.messageHandler.sendWithPromise(\"Cleanup\", null);\n    for (const page of this.#pageCache.values()) {\n      const cleanupSuccessful = page.cleanup();\n      if (!cleanupSuccessful) {\n        throw new Error(`startCleanup: Page ${page.pageNumber} is currently rendering.`);\n      }\n    }\n    this.commonObjs.clear();\n    if (!keepLoadedFonts) {\n      this.fontLoader.clear();\n    }\n    this.#methodPromises.clear();\n    this.filterFactory.destroy(true);\n    TextLayer.cleanup();\n  }\n  cachedPageNumber(ref) {\n    if (!isRefProxy(ref)) {\n      return null;\n    }\n    const refStr = ref.gen === 0 ? `${ref.num}R` : `${ref.num}R${ref.gen}`;\n    return this.#pageRefCache.get(refStr) ?? null;\n  }\n}\nconst INITIAL_DATA = Symbol(\"INITIAL_DATA\");\nclass PDFObjects {\n  #objs = Object.create(null);\n  #ensureObj(objId) {\n    return this.#objs[objId] ||= {\n      ...Promise.withResolvers(),\n      data: INITIAL_DATA\n    };\n  }\n  get(objId, callback = null) {\n    if (callback) {\n      const obj = this.#ensureObj(objId);\n      obj.promise.then(() => callback(obj.data));\n      return null;\n    }\n    const obj = this.#objs[objId];\n    if (!obj || obj.data === INITIAL_DATA) {\n      throw new Error(`Requesting object that isn't resolved yet ${objId}.`);\n    }\n    return obj.data;\n  }\n  has(objId) {\n    const obj = this.#objs[objId];\n    return !!obj && obj.data !== INITIAL_DATA;\n  }\n  resolve(objId, data = null) {\n    const obj = this.#ensureObj(objId);\n    obj.data = data;\n    obj.resolve();\n  }\n  clear() {\n    for (const objId in this.#objs) {\n      const {\n        data\n      } = this.#objs[objId];\n      data?.bitmap?.close();\n    }\n    this.#objs = Object.create(null);\n  }\n  *[Symbol.iterator]() {\n    for (const objId in this.#objs) {\n      const {\n        data\n      } = this.#objs[objId];\n      if (data === INITIAL_DATA) {\n        continue;\n      }\n      yield [objId, data];\n    }\n  }\n}\nclass RenderTask {\n  #internalRenderTask = null;\n  constructor(internalRenderTask) {\n    this.#internalRenderTask = internalRenderTask;\n    this.onContinue = null;\n  }\n  get promise() {\n    return this.#internalRenderTask.capability.promise;\n  }\n  cancel(extraDelay = 0) {\n    this.#internalRenderTask.cancel(null, extraDelay);\n  }\n  get separateAnnots() {\n    const {\n      separateAnnots\n    } = this.#internalRenderTask.operatorList;\n    if (!separateAnnots) {\n      return false;\n    }\n    const {\n      annotationCanvasMap\n    } = this.#internalRenderTask;\n    return separateAnnots.form || separateAnnots.canvas && annotationCanvasMap?.size > 0;\n  }\n}\nclass InternalRenderTask {\n  #rAF = null;\n  static #canvasInUse = new WeakSet();\n  constructor({\n    callback,\n    params,\n    objs,\n    commonObjs,\n    annotationCanvasMap,\n    operatorList,\n    pageIndex,\n    canvasFactory,\n    filterFactory,\n    useRequestAnimationFrame = false,\n    pdfBug = false,\n    pageColors = null\n  }) {\n    this.callback = callback;\n    this.params = params;\n    this.objs = objs;\n    this.commonObjs = commonObjs;\n    this.annotationCanvasMap = annotationCanvasMap;\n    this.operatorListIdx = null;\n    this.operatorList = operatorList;\n    this._pageIndex = pageIndex;\n    this.canvasFactory = canvasFactory;\n    this.filterFactory = filterFactory;\n    this._pdfBug = pdfBug;\n    this.pageColors = pageColors;\n    this.running = false;\n    this.graphicsReadyCallback = null;\n    this.graphicsReady = false;\n    this._useRequestAnimationFrame = useRequestAnimationFrame === true && typeof window !== \"undefined\";\n    this.cancelled = false;\n    this.capability = Promise.withResolvers();\n    this.task = new RenderTask(this);\n    this._cancelBound = this.cancel.bind(this);\n    this._continueBound = this._continue.bind(this);\n    this._scheduleNextBound = this._scheduleNext.bind(this);\n    this._nextBound = this._next.bind(this);\n    this._canvas = params.canvasContext.canvas;\n  }\n  get completed() {\n    return this.capability.promise.catch(function () {});\n  }\n  initializeGraphics({\n    transparency = false,\n    optionalContentConfig\n  }) {\n    if (this.cancelled) {\n      return;\n    }\n    if (this._canvas) {\n      if (InternalRenderTask.#canvasInUse.has(this._canvas)) {\n        throw new Error(\"Cannot use the same canvas during multiple render() operations. \" + \"Use different canvas or ensure previous operations were \" + \"cancelled or completed.\");\n      }\n      InternalRenderTask.#canvasInUse.add(this._canvas);\n    }\n    if (this._pdfBug && globalThis.StepperManager?.enabled) {\n      this.stepper = globalThis.StepperManager.create(this._pageIndex);\n      this.stepper.init(this.operatorList);\n      this.stepper.nextBreakPoint = this.stepper.getNextBreakPoint();\n    }\n    const {\n      canvasContext,\n      viewport,\n      transform,\n      background\n    } = this.params;\n    this.gfx = new CanvasGraphics(canvasContext, this.commonObjs, this.objs, this.canvasFactory, this.filterFactory, {\n      optionalContentConfig\n    }, this.annotationCanvasMap, this.pageColors);\n    this.gfx.beginDrawing({\n      transform,\n      viewport,\n      transparency,\n      background\n    });\n    this.operatorListIdx = 0;\n    this.graphicsReady = true;\n    this.graphicsReadyCallback?.();\n  }\n  cancel(error = null, extraDelay = 0) {\n    this.running = false;\n    this.cancelled = true;\n    this.gfx?.endDrawing();\n    if (this.#rAF) {\n      window.cancelAnimationFrame(this.#rAF);\n      this.#rAF = null;\n    }\n    InternalRenderTask.#canvasInUse.delete(this._canvas);\n    this.callback(error || new RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex + 1}`, extraDelay));\n  }\n  operatorListChanged() {\n    if (!this.graphicsReady) {\n      this.graphicsReadyCallback ||= this._continueBound;\n      return;\n    }\n    this.stepper?.updateOperatorList(this.operatorList);\n    if (this.running) {\n      return;\n    }\n    this._continue();\n  }\n  _continue() {\n    this.running = true;\n    if (this.cancelled) {\n      return;\n    }\n    if (this.task.onContinue) {\n      this.task.onContinue(this._scheduleNextBound);\n    } else {\n      this._scheduleNext();\n    }\n  }\n  _scheduleNext() {\n    if (this._useRequestAnimationFrame) {\n      this.#rAF = window.requestAnimationFrame(() => {\n        this.#rAF = null;\n        this._nextBound().catch(this._cancelBound);\n      });\n    } else {\n      Promise.resolve().then(this._nextBound).catch(this._cancelBound);\n    }\n  }\n  async _next() {\n    if (this.cancelled) {\n      return;\n    }\n    this.operatorListIdx = this.gfx.executeOperatorList(this.operatorList, this.operatorListIdx, this._continueBound, this.stepper);\n    if (this.operatorListIdx === this.operatorList.argsArray.length) {\n      this.running = false;\n      if (this.operatorList.lastChunk) {\n        this.gfx.endDrawing();\n        InternalRenderTask.#canvasInUse.delete(this._canvas);\n        this.callback();\n      }\n    }\n  }\n}\nconst version = \"4.6.82\";\nconst build = \"9b541910f\";\n\n;// CONCATENATED MODULE: ./src/shared/scripting_utils.js\nfunction makeColorComp(n) {\n  return Math.floor(Math.max(0, Math.min(1, n)) * 255).toString(16).padStart(2, \"0\");\n}\nfunction scaleAndClamp(x) {\n  return Math.max(0, Math.min(255, 255 * x));\n}\nclass ColorConverters {\n  static CMYK_G([c, y, m, k]) {\n    return [\"G\", 1 - Math.min(1, 0.3 * c + 0.59 * m + 0.11 * y + k)];\n  }\n  static G_CMYK([g]) {\n    return [\"CMYK\", 0, 0, 0, 1 - g];\n  }\n  static G_RGB([g]) {\n    return [\"RGB\", g, g, g];\n  }\n  static G_rgb([g]) {\n    g = scaleAndClamp(g);\n    return [g, g, g];\n  }\n  static G_HTML([g]) {\n    const G = makeColorComp(g);\n    return `#${G}${G}${G}`;\n  }\n  static RGB_G([r, g, b]) {\n    return [\"G\", 0.3 * r + 0.59 * g + 0.11 * b];\n  }\n  static RGB_rgb(color) {\n    return color.map(scaleAndClamp);\n  }\n  static RGB_HTML(color) {\n    return `#${color.map(makeColorComp).join(\"\")}`;\n  }\n  static T_HTML() {\n    return \"#00000000\";\n  }\n  static T_rgb() {\n    return [null];\n  }\n  static CMYK_RGB([c, y, m, k]) {\n    return [\"RGB\", 1 - Math.min(1, c + k), 1 - Math.min(1, m + k), 1 - Math.min(1, y + k)];\n  }\n  static CMYK_rgb([c, y, m, k]) {\n    return [scaleAndClamp(1 - Math.min(1, c + k)), scaleAndClamp(1 - Math.min(1, m + k)), scaleAndClamp(1 - Math.min(1, y + k))];\n  }\n  static CMYK_HTML(components) {\n    const rgb = this.CMYK_RGB(components).slice(1);\n    return this.RGB_HTML(rgb);\n  }\n  static RGB_CMYK([r, g, b]) {\n    const c = 1 - r;\n    const m = 1 - g;\n    const y = 1 - b;\n    const k = Math.min(c, m, y);\n    return [\"CMYK\", c, m, y, k];\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/xfa_layer.js\n\nclass XfaLayer {\n  static setupStorage(html, id, element, storage, intent) {\n    const storedData = storage.getValue(id, {\n      value: null\n    });\n    switch (element.name) {\n      case \"textarea\":\n        if (storedData.value !== null) {\n          html.textContent = storedData.value;\n        }\n        if (intent === \"print\") {\n          break;\n        }\n        html.addEventListener(\"input\", event => {\n          storage.setValue(id, {\n            value: event.target.value\n          });\n        });\n        break;\n      case \"input\":\n        if (element.attributes.type === \"radio\" || element.attributes.type === \"checkbox\") {\n          if (storedData.value === element.attributes.xfaOn) {\n            html.setAttribute(\"checked\", true);\n          } else if (storedData.value === element.attributes.xfaOff) {\n            html.removeAttribute(\"checked\");\n          }\n          if (intent === \"print\") {\n            break;\n          }\n          html.addEventListener(\"change\", event => {\n            storage.setValue(id, {\n              value: event.target.checked ? event.target.getAttribute(\"xfaOn\") : event.target.getAttribute(\"xfaOff\")\n            });\n          });\n        } else {\n          if (storedData.value !== null) {\n            html.setAttribute(\"value\", storedData.value);\n          }\n          if (intent === \"print\") {\n            break;\n          }\n          html.addEventListener(\"input\", event => {\n            storage.setValue(id, {\n              value: event.target.value\n            });\n          });\n        }\n        break;\n      case \"select\":\n        if (storedData.value !== null) {\n          html.setAttribute(\"value\", storedData.value);\n          for (const option of element.children) {\n            if (option.attributes.value === storedData.value) {\n              option.attributes.selected = true;\n            } else if (option.attributes.hasOwnProperty(\"selected\")) {\n              delete option.attributes.selected;\n            }\n          }\n        }\n        html.addEventListener(\"input\", event => {\n          const options = event.target.options;\n          const value = options.selectedIndex === -1 ? \"\" : options[options.selectedIndex].value;\n          storage.setValue(id, {\n            value\n          });\n        });\n        break;\n    }\n  }\n  static setAttributes({\n    html,\n    element,\n    storage = null,\n    intent,\n    linkService\n  }) {\n    const {\n      attributes\n    } = element;\n    const isHTMLAnchorElement = html instanceof HTMLAnchorElement;\n    if (attributes.type === \"radio\") {\n      attributes.name = `${attributes.name}-${intent}`;\n    }\n    for (const [key, value] of Object.entries(attributes)) {\n      if (value === null || value === undefined) {\n        continue;\n      }\n      switch (key) {\n        case \"class\":\n          if (value.length) {\n            html.setAttribute(key, value.join(\" \"));\n          }\n          break;\n        case \"dataId\":\n          break;\n        case \"id\":\n          html.setAttribute(\"data-element-id\", value);\n          break;\n        case \"style\":\n          Object.assign(html.style, value);\n          break;\n        case \"textContent\":\n          html.textContent = value;\n          break;\n        default:\n          if (!isHTMLAnchorElement || key !== \"href\" && key !== \"newWindow\") {\n            html.setAttribute(key, value);\n          }\n      }\n    }\n    if (isHTMLAnchorElement) {\n      linkService.addLinkAttributes(html, attributes.href, attributes.newWindow);\n    }\n    if (storage && attributes.dataId) {\n      this.setupStorage(html, attributes.dataId, element, storage);\n    }\n  }\n  static render(parameters) {\n    const storage = parameters.annotationStorage;\n    const linkService = parameters.linkService;\n    const root = parameters.xfaHtml;\n    const intent = parameters.intent || \"display\";\n    const rootHtml = document.createElement(root.name);\n    if (root.attributes) {\n      this.setAttributes({\n        html: rootHtml,\n        element: root,\n        intent,\n        linkService\n      });\n    }\n    const isNotForRichText = intent !== \"richText\";\n    const rootDiv = parameters.div;\n    rootDiv.append(rootHtml);\n    if (parameters.viewport) {\n      const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n      rootDiv.style.transform = transform;\n    }\n    if (isNotForRichText) {\n      rootDiv.setAttribute(\"class\", \"xfaLayer xfaFont\");\n    }\n    const textDivs = [];\n    if (root.children.length === 0) {\n      if (root.value) {\n        const node = document.createTextNode(root.value);\n        rootHtml.append(node);\n        if (isNotForRichText && XfaText.shouldBuildText(root.name)) {\n          textDivs.push(node);\n        }\n      }\n      return {\n        textDivs\n      };\n    }\n    const stack = [[root, -1, rootHtml]];\n    while (stack.length > 0) {\n      const [parent, i, html] = stack.at(-1);\n      if (i + 1 === parent.children.length) {\n        stack.pop();\n        continue;\n      }\n      const child = parent.children[++stack.at(-1)[1]];\n      if (child === null) {\n        continue;\n      }\n      const {\n        name\n      } = child;\n      if (name === \"#text\") {\n        const node = document.createTextNode(child.value);\n        textDivs.push(node);\n        html.append(node);\n        continue;\n      }\n      const childHtml = child?.attributes?.xmlns ? document.createElementNS(child.attributes.xmlns, name) : document.createElement(name);\n      html.append(childHtml);\n      if (child.attributes) {\n        this.setAttributes({\n          html: childHtml,\n          element: child,\n          storage,\n          intent,\n          linkService\n        });\n      }\n      if (child.children?.length > 0) {\n        stack.push([child, -1, childHtml]);\n      } else if (child.value) {\n        const node = document.createTextNode(child.value);\n        if (isNotForRichText && XfaText.shouldBuildText(name)) {\n          textDivs.push(node);\n        }\n        childHtml.append(node);\n      }\n    }\n    for (const el of rootDiv.querySelectorAll(\".xfaNonInteractive input, .xfaNonInteractive textarea\")) {\n      el.setAttribute(\"readOnly\", true);\n    }\n    return {\n      textDivs\n    };\n  }\n  static update(parameters) {\n    const transform = `matrix(${parameters.viewport.transform.join(\",\")})`;\n    parameters.div.style.transform = transform;\n    parameters.div.hidden = false;\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/annotation_layer.js\n\n\n\n\n\nconst DEFAULT_TAB_INDEX = 1000;\nconst annotation_layer_DEFAULT_FONT_SIZE = 9;\nconst GetElementsByNameSet = new WeakSet();\nfunction getRectDims(rect) {\n  return {\n    width: rect[2] - rect[0],\n    height: rect[3] - rect[1]\n  };\n}\nclass AnnotationElementFactory {\n  static create(parameters) {\n    const subtype = parameters.data.annotationType;\n    switch (subtype) {\n      case AnnotationType.LINK:\n        return new LinkAnnotationElement(parameters);\n      case AnnotationType.TEXT:\n        return new TextAnnotationElement(parameters);\n      case AnnotationType.WIDGET:\n        const fieldType = parameters.data.fieldType;\n        switch (fieldType) {\n          case \"Tx\":\n            return new TextWidgetAnnotationElement(parameters);\n          case \"Btn\":\n            if (parameters.data.radioButton) {\n              return new RadioButtonWidgetAnnotationElement(parameters);\n            } else if (parameters.data.checkBox) {\n              return new CheckboxWidgetAnnotationElement(parameters);\n            }\n            return new PushButtonWidgetAnnotationElement(parameters);\n          case \"Ch\":\n            return new ChoiceWidgetAnnotationElement(parameters);\n          case \"Sig\":\n            return new SignatureWidgetAnnotationElement(parameters);\n        }\n        return new WidgetAnnotationElement(parameters);\n      case AnnotationType.POPUP:\n        return new PopupAnnotationElement(parameters);\n      case AnnotationType.FREETEXT:\n        return new FreeTextAnnotationElement(parameters);\n      case AnnotationType.LINE:\n        return new LineAnnotationElement(parameters);\n      case AnnotationType.SQUARE:\n        return new SquareAnnotationElement(parameters);\n      case AnnotationType.CIRCLE:\n        return new CircleAnnotationElement(parameters);\n      case AnnotationType.POLYLINE:\n        return new PolylineAnnotationElement(parameters);\n      case AnnotationType.CARET:\n        return new CaretAnnotationElement(parameters);\n      case AnnotationType.INK:\n        return new InkAnnotationElement(parameters);\n      case AnnotationType.POLYGON:\n        return new PolygonAnnotationElement(parameters);\n      case AnnotationType.HIGHLIGHT:\n        return new HighlightAnnotationElement(parameters);\n      case AnnotationType.UNDERLINE:\n        return new UnderlineAnnotationElement(parameters);\n      case AnnotationType.SQUIGGLY:\n        return new SquigglyAnnotationElement(parameters);\n      case AnnotationType.STRIKEOUT:\n        return new StrikeOutAnnotationElement(parameters);\n      case AnnotationType.STAMP:\n        return new StampAnnotationElement(parameters);\n      case AnnotationType.FILEATTACHMENT:\n        return new FileAttachmentAnnotationElement(parameters);\n      default:\n        return new AnnotationElement(parameters);\n    }\n  }\n}\nclass AnnotationElement {\n  #updates = null;\n  #hasBorder = false;\n  #popupElement = null;\n  constructor(parameters, {\n    isRenderable = false,\n    ignoreBorder = false,\n    createQuadrilaterals = false\n  } = {}) {\n    this.isRenderable = isRenderable;\n    this.data = parameters.data;\n    this.layer = parameters.layer;\n    this.linkService = parameters.linkService;\n    this.downloadManager = parameters.downloadManager;\n    this.imageResourcesPath = parameters.imageResourcesPath;\n    this.renderForms = parameters.renderForms;\n    this.svgFactory = parameters.svgFactory;\n    this.annotationStorage = parameters.annotationStorage;\n    this.enableScripting = parameters.enableScripting;\n    this.hasJSActions = parameters.hasJSActions;\n    this._fieldObjects = parameters.fieldObjects;\n    this.parent = parameters.parent;\n    if (isRenderable) {\n      this.container = this._createContainer(ignoreBorder);\n    }\n    if (createQuadrilaterals) {\n      this._createQuadrilaterals();\n    }\n  }\n  static _hasPopupData({\n    titleObj,\n    contentsObj,\n    richText\n  }) {\n    return !!(titleObj?.str || contentsObj?.str || richText?.str);\n  }\n  get _isEditable() {\n    return this.data.isEditable;\n  }\n  get hasPopupData() {\n    return AnnotationElement._hasPopupData(this.data);\n  }\n  updateEdited(params) {\n    if (!this.container) {\n      return;\n    }\n    this.#updates ||= {\n      rect: this.data.rect.slice(0)\n    };\n    const {\n      rect\n    } = params;\n    if (rect) {\n      this.#setRectEdited(rect);\n    }\n    this.#popupElement?.popup.updateEdited(params);\n  }\n  resetEdited() {\n    if (!this.#updates) {\n      return;\n    }\n    this.#setRectEdited(this.#updates.rect);\n    this.#popupElement?.popup.resetEdited();\n    this.#updates = null;\n  }\n  #setRectEdited(rect) {\n    const {\n      container: {\n        style\n      },\n      data: {\n        rect: currentRect,\n        rotation\n      },\n      parent: {\n        viewport: {\n          rawDims: {\n            pageWidth,\n            pageHeight,\n            pageX,\n            pageY\n          }\n        }\n      }\n    } = this;\n    currentRect?.splice(0, 4, ...rect);\n    const {\n      width,\n      height\n    } = getRectDims(rect);\n    style.left = `${100 * (rect[0] - pageX) / pageWidth}%`;\n    style.top = `${100 * (pageHeight - rect[3] + pageY) / pageHeight}%`;\n    if (rotation === 0) {\n      style.width = `${100 * width / pageWidth}%`;\n      style.height = `${100 * height / pageHeight}%`;\n    } else {\n      this.setRotation(rotation);\n    }\n  }\n  _createContainer(ignoreBorder) {\n    const {\n      data,\n      parent: {\n        page,\n        viewport\n      }\n    } = this;\n    const container = document.createElement(\"section\");\n    container.setAttribute(\"data-annotation-id\", data.id);\n    if (!(this instanceof WidgetAnnotationElement)) {\n      container.tabIndex = DEFAULT_TAB_INDEX;\n    }\n    const {\n      style\n    } = container;\n    style.zIndex = this.parent.zIndex++;\n    if (data.popupRef) {\n      container.setAttribute(\"aria-haspopup\", \"dialog\");\n    }\n    if (data.alternativeText) {\n      container.title = data.alternativeText;\n    }\n    if (data.noRotate) {\n      container.classList.add(\"norotate\");\n    }\n    if (!data.rect || this instanceof PopupAnnotationElement) {\n      const {\n        rotation\n      } = data;\n      if (!data.hasOwnCanvas && rotation !== 0) {\n        this.setRotation(rotation, container);\n      }\n      return container;\n    }\n    const {\n      width,\n      height\n    } = getRectDims(data.rect);\n    if (!ignoreBorder && data.borderStyle.width > 0) {\n      style.borderWidth = `${data.borderStyle.width}px`;\n      const horizontalRadius = data.borderStyle.horizontalCornerRadius;\n      const verticalRadius = data.borderStyle.verticalCornerRadius;\n      if (horizontalRadius > 0 || verticalRadius > 0) {\n        const radius = `calc(${horizontalRadius}px * var(--scale-factor)) / calc(${verticalRadius}px * var(--scale-factor))`;\n        style.borderRadius = radius;\n      } else if (this instanceof RadioButtonWidgetAnnotationElement) {\n        const radius = `calc(${width}px * var(--scale-factor)) / calc(${height}px * var(--scale-factor))`;\n        style.borderRadius = radius;\n      }\n      switch (data.borderStyle.style) {\n        case AnnotationBorderStyleType.SOLID:\n          style.borderStyle = \"solid\";\n          break;\n        case AnnotationBorderStyleType.DASHED:\n          style.borderStyle = \"dashed\";\n          break;\n        case AnnotationBorderStyleType.BEVELED:\n          warn(\"Unimplemented border style: beveled\");\n          break;\n        case AnnotationBorderStyleType.INSET:\n          warn(\"Unimplemented border style: inset\");\n          break;\n        case AnnotationBorderStyleType.UNDERLINE:\n          style.borderBottomStyle = \"solid\";\n          break;\n        default:\n          break;\n      }\n      const borderColor = data.borderColor || null;\n      if (borderColor) {\n        this.#hasBorder = true;\n        style.borderColor = Util.makeHexColor(borderColor[0] | 0, borderColor[1] | 0, borderColor[2] | 0);\n      } else {\n        style.borderWidth = 0;\n      }\n    }\n    const rect = Util.normalizeRect([data.rect[0], page.view[3] - data.rect[1] + page.view[1], data.rect[2], page.view[3] - data.rect[3] + page.view[1]]);\n    const {\n      pageWidth,\n      pageHeight,\n      pageX,\n      pageY\n    } = viewport.rawDims;\n    style.left = `${100 * (rect[0] - pageX) / pageWidth}%`;\n    style.top = `${100 * (rect[1] - pageY) / pageHeight}%`;\n    const {\n      rotation\n    } = data;\n    if (data.hasOwnCanvas || rotation === 0) {\n      style.width = `${100 * width / pageWidth}%`;\n      style.height = `${100 * height / pageHeight}%`;\n    } else {\n      this.setRotation(rotation, container);\n    }\n    return container;\n  }\n  setRotation(angle, container = this.container) {\n    if (!this.data.rect) {\n      return;\n    }\n    const {\n      pageWidth,\n      pageHeight\n    } = this.parent.viewport.rawDims;\n    const {\n      width,\n      height\n    } = getRectDims(this.data.rect);\n    let elementWidth, elementHeight;\n    if (angle % 180 === 0) {\n      elementWidth = 100 * width / pageWidth;\n      elementHeight = 100 * height / pageHeight;\n    } else {\n      elementWidth = 100 * height / pageWidth;\n      elementHeight = 100 * width / pageHeight;\n    }\n    container.style.width = `${elementWidth}%`;\n    container.style.height = `${elementHeight}%`;\n    container.setAttribute(\"data-main-rotation\", (360 - angle) % 360);\n  }\n  get _commonActions() {\n    const setColor = (jsName, styleName, event) => {\n      const color = event.detail[jsName];\n      const colorType = color[0];\n      const colorArray = color.slice(1);\n      event.target.style[styleName] = ColorConverters[`${colorType}_HTML`](colorArray);\n      this.annotationStorage.setValue(this.data.id, {\n        [styleName]: ColorConverters[`${colorType}_rgb`](colorArray)\n      });\n    };\n    return shadow(this, \"_commonActions\", {\n      display: event => {\n        const {\n          display\n        } = event.detail;\n        const hidden = display % 2 === 1;\n        this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n        this.annotationStorage.setValue(this.data.id, {\n          noView: hidden,\n          noPrint: display === 1 || display === 2\n        });\n      },\n      print: event => {\n        this.annotationStorage.setValue(this.data.id, {\n          noPrint: !event.detail.print\n        });\n      },\n      hidden: event => {\n        const {\n          hidden\n        } = event.detail;\n        this.container.style.visibility = hidden ? \"hidden\" : \"visible\";\n        this.annotationStorage.setValue(this.data.id, {\n          noPrint: hidden,\n          noView: hidden\n        });\n      },\n      focus: event => {\n        setTimeout(() => event.target.focus({\n          preventScroll: false\n        }), 0);\n      },\n      userName: event => {\n        event.target.title = event.detail.userName;\n      },\n      readonly: event => {\n        event.target.disabled = event.detail.readonly;\n      },\n      required: event => {\n        this._setRequired(event.target, event.detail.required);\n      },\n      bgColor: event => {\n        setColor(\"bgColor\", \"backgroundColor\", event);\n      },\n      fillColor: event => {\n        setColor(\"fillColor\", \"backgroundColor\", event);\n      },\n      fgColor: event => {\n        setColor(\"fgColor\", \"color\", event);\n      },\n      textColor: event => {\n        setColor(\"textColor\", \"color\", event);\n      },\n      borderColor: event => {\n        setColor(\"borderColor\", \"borderColor\", event);\n      },\n      strokeColor: event => {\n        setColor(\"strokeColor\", \"borderColor\", event);\n      },\n      rotation: event => {\n        const angle = event.detail.rotation;\n        this.setRotation(angle);\n        this.annotationStorage.setValue(this.data.id, {\n          rotation: angle\n        });\n      }\n    });\n  }\n  _dispatchEventFromSandbox(actions, jsEvent) {\n    const commonActions = this._commonActions;\n    for (const name of Object.keys(jsEvent.detail)) {\n      const action = actions[name] || commonActions[name];\n      action?.(jsEvent);\n    }\n  }\n  _setDefaultPropertiesFromJS(element) {\n    if (!this.enableScripting) {\n      return;\n    }\n    const storedData = this.annotationStorage.getRawValue(this.data.id);\n    if (!storedData) {\n      return;\n    }\n    const commonActions = this._commonActions;\n    for (const [actionName, detail] of Object.entries(storedData)) {\n      const action = commonActions[actionName];\n      if (action) {\n        const eventProxy = {\n          detail: {\n            [actionName]: detail\n          },\n          target: element\n        };\n        action(eventProxy);\n        delete storedData[actionName];\n      }\n    }\n  }\n  _createQuadrilaterals() {\n    if (!this.container) {\n      return;\n    }\n    const {\n      quadPoints\n    } = this.data;\n    if (!quadPoints) {\n      return;\n    }\n    const [rectBlX, rectBlY, rectTrX, rectTrY] = this.data.rect.map(x => Math.fround(x));\n    if (quadPoints.length === 8) {\n      const [trX, trY, blX, blY] = quadPoints.subarray(2, 6);\n      if (rectTrX === trX && rectTrY === trY && rectBlX === blX && rectBlY === blY) {\n        return;\n      }\n    }\n    const {\n      style\n    } = this.container;\n    let svgBuffer;\n    if (this.#hasBorder) {\n      const {\n        borderColor,\n        borderWidth\n      } = style;\n      style.borderWidth = 0;\n      svgBuffer = [\"url('data:image/svg+xml;utf8,\", `<svg xmlns=\"http://www.w3.org/2000/svg\"`, ` preserveAspectRatio=\"none\" viewBox=\"0 0 1 1\">`, `<g fill=\"transparent\" stroke=\"${borderColor}\" stroke-width=\"${borderWidth}\">`];\n      this.container.classList.add(\"hasBorder\");\n    }\n    const width = rectTrX - rectBlX;\n    const height = rectTrY - rectBlY;\n    const {\n      svgFactory\n    } = this;\n    const svg = svgFactory.createElement(\"svg\");\n    svg.classList.add(\"quadrilateralsContainer\");\n    svg.setAttribute(\"width\", 0);\n    svg.setAttribute(\"height\", 0);\n    const defs = svgFactory.createElement(\"defs\");\n    svg.append(defs);\n    const clipPath = svgFactory.createElement(\"clipPath\");\n    const id = `clippath_${this.data.id}`;\n    clipPath.setAttribute(\"id\", id);\n    clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n    defs.append(clipPath);\n    for (let i = 2, ii = quadPoints.length; i < ii; i += 8) {\n      const trX = quadPoints[i];\n      const trY = quadPoints[i + 1];\n      const blX = quadPoints[i + 2];\n      const blY = quadPoints[i + 3];\n      const rect = svgFactory.createElement(\"rect\");\n      const x = (blX - rectBlX) / width;\n      const y = (rectTrY - trY) / height;\n      const rectWidth = (trX - blX) / width;\n      const rectHeight = (trY - blY) / height;\n      rect.setAttribute(\"x\", x);\n      rect.setAttribute(\"y\", y);\n      rect.setAttribute(\"width\", rectWidth);\n      rect.setAttribute(\"height\", rectHeight);\n      clipPath.append(rect);\n      svgBuffer?.push(`<rect vector-effect=\"non-scaling-stroke\" x=\"${x}\" y=\"${y}\" width=\"${rectWidth}\" height=\"${rectHeight}\"/>`);\n    }\n    if (this.#hasBorder) {\n      svgBuffer.push(`</g></svg>')`);\n      style.backgroundImage = svgBuffer.join(\"\");\n    }\n    this.container.append(svg);\n    this.container.style.clipPath = `url(#${id})`;\n  }\n  _createPopup() {\n    const {\n      container,\n      data\n    } = this;\n    container.setAttribute(\"aria-haspopup\", \"dialog\");\n    const popup = this.#popupElement = new PopupAnnotationElement({\n      data: {\n        color: data.color,\n        titleObj: data.titleObj,\n        modificationDate: data.modificationDate,\n        contentsObj: data.contentsObj,\n        richText: data.richText,\n        parentRect: data.rect,\n        borderStyle: 0,\n        id: `popup_${data.id}`,\n        rotation: data.rotation\n      },\n      parent: this.parent,\n      elements: [this]\n    });\n    this.parent.div.append(popup.render());\n  }\n  render() {\n    unreachable(\"Abstract method `AnnotationElement.render` called\");\n  }\n  _getElementsByName(name, skipId = null) {\n    const fields = [];\n    if (this._fieldObjects) {\n      const fieldObj = this._fieldObjects[name];\n      if (fieldObj) {\n        for (const {\n          page,\n          id,\n          exportValues\n        } of fieldObj) {\n          if (page === -1) {\n            continue;\n          }\n          if (id === skipId) {\n            continue;\n          }\n          const exportValue = typeof exportValues === \"string\" ? exportValues : null;\n          const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n          if (domElement && !GetElementsByNameSet.has(domElement)) {\n            warn(`_getElementsByName - element not allowed: ${id}`);\n            continue;\n          }\n          fields.push({\n            id,\n            exportValue,\n            domElement\n          });\n        }\n      }\n      return fields;\n    }\n    for (const domElement of document.getElementsByName(name)) {\n      const {\n        exportValue\n      } = domElement;\n      const id = domElement.getAttribute(\"data-element-id\");\n      if (id === skipId) {\n        continue;\n      }\n      if (!GetElementsByNameSet.has(domElement)) {\n        continue;\n      }\n      fields.push({\n        id,\n        exportValue,\n        domElement\n      });\n    }\n    return fields;\n  }\n  show() {\n    if (this.container) {\n      this.container.hidden = false;\n    }\n    this.popup?.maybeShow();\n  }\n  hide() {\n    if (this.container) {\n      this.container.hidden = true;\n    }\n    this.popup?.forceHide();\n  }\n  getElementsToTriggerPopup() {\n    return this.container;\n  }\n  addHighlightArea() {\n    const triggers = this.getElementsToTriggerPopup();\n    if (Array.isArray(triggers)) {\n      for (const element of triggers) {\n        element.classList.add(\"highlightArea\");\n      }\n    } else {\n      triggers.classList.add(\"highlightArea\");\n    }\n  }\n  _editOnDoubleClick() {\n    if (!this._isEditable) {\n      return;\n    }\n    const {\n      annotationEditorType: mode,\n      data: {\n        id: editId\n      }\n    } = this;\n    this.container.addEventListener(\"dblclick\", () => {\n      this.linkService.eventBus?.dispatch(\"switchannotationeditormode\", {\n        source: this,\n        mode,\n        editId\n      });\n    });\n  }\n}\nclass LinkAnnotationElement extends AnnotationElement {\n  constructor(parameters, options = null) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: !!options?.ignoreBorder,\n      createQuadrilaterals: true\n    });\n    this.isTooltipOnly = parameters.data.isTooltipOnly;\n  }\n  render() {\n    const {\n      data,\n      linkService\n    } = this;\n    const link = document.createElement(\"a\");\n    link.setAttribute(\"data-element-id\", data.id);\n    let isBound = false;\n    if (data.url) {\n      linkService.addLinkAttributes(link, data.url, data.newWindow);\n      isBound = true;\n    } else if (data.action) {\n      this._bindNamedAction(link, data.action);\n      isBound = true;\n    } else if (data.attachment) {\n      this.#bindAttachment(link, data.attachment, data.attachmentDest);\n      isBound = true;\n    } else if (data.setOCGState) {\n      this.#bindSetOCGState(link, data.setOCGState);\n      isBound = true;\n    } else if (data.dest) {\n      this._bindLink(link, data.dest);\n      isBound = true;\n    } else {\n      if (data.actions && (data.actions.Action || data.actions[\"Mouse Up\"] || data.actions[\"Mouse Down\"]) && this.enableScripting && this.hasJSActions) {\n        this._bindJSAction(link, data);\n        isBound = true;\n      }\n      if (data.resetForm) {\n        this._bindResetFormAction(link, data.resetForm);\n        isBound = true;\n      } else if (this.isTooltipOnly && !isBound) {\n        this._bindLink(link, \"\");\n        isBound = true;\n      }\n    }\n    this.container.classList.add(\"linkAnnotation\");\n    if (isBound) {\n      this.container.append(link);\n    }\n    return this.container;\n  }\n  #setInternalLink() {\n    this.container.setAttribute(\"data-internal-link\", \"\");\n  }\n  _bindLink(link, destination) {\n    link.href = this.linkService.getDestinationHash(destination);\n    link.onclick = () => {\n      if (destination) {\n        this.linkService.goToDestination(destination);\n      }\n      return false;\n    };\n    if (destination || destination === \"\") {\n      this.#setInternalLink();\n    }\n  }\n  _bindNamedAction(link, action) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    link.onclick = () => {\n      this.linkService.executeNamedAction(action);\n      return false;\n    };\n    this.#setInternalLink();\n  }\n  #bindAttachment(link, attachment, dest = null) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    if (attachment.description) {\n      link.title = attachment.description;\n    }\n    link.onclick = () => {\n      this.downloadManager?.openOrDownloadData(attachment.content, attachment.filename, dest);\n      return false;\n    };\n    this.#setInternalLink();\n  }\n  #bindSetOCGState(link, action) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    link.onclick = () => {\n      this.linkService.executeSetOCGState(action);\n      return false;\n    };\n    this.#setInternalLink();\n  }\n  _bindJSAction(link, data) {\n    link.href = this.linkService.getAnchorUrl(\"\");\n    const map = new Map([[\"Action\", \"onclick\"], [\"Mouse Up\", \"onmouseup\"], [\"Mouse Down\", \"onmousedown\"]]);\n    for (const name of Object.keys(data.actions)) {\n      const jsName = map.get(name);\n      if (!jsName) {\n        continue;\n      }\n      link[jsName] = () => {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: data.id,\n            name\n          }\n        });\n        return false;\n      };\n    }\n    if (!link.onclick) {\n      link.onclick = () => false;\n    }\n    this.#setInternalLink();\n  }\n  _bindResetFormAction(link, resetForm) {\n    const otherClickAction = link.onclick;\n    if (!otherClickAction) {\n      link.href = this.linkService.getAnchorUrl(\"\");\n    }\n    this.#setInternalLink();\n    if (!this._fieldObjects) {\n      warn(`_bindResetFormAction - \"resetForm\" action not supported, ` + \"ensure that the `fieldObjects` parameter is provided.\");\n      if (!otherClickAction) {\n        link.onclick = () => false;\n      }\n      return;\n    }\n    link.onclick = () => {\n      otherClickAction?.();\n      const {\n        fields: resetFormFields,\n        refs: resetFormRefs,\n        include\n      } = resetForm;\n      const allFields = [];\n      if (resetFormFields.length !== 0 || resetFormRefs.length !== 0) {\n        const fieldIds = new Set(resetFormRefs);\n        for (const fieldName of resetFormFields) {\n          const fields = this._fieldObjects[fieldName] || [];\n          for (const {\n            id\n          } of fields) {\n            fieldIds.add(id);\n          }\n        }\n        for (const fields of Object.values(this._fieldObjects)) {\n          for (const field of fields) {\n            if (fieldIds.has(field.id) === include) {\n              allFields.push(field);\n            }\n          }\n        }\n      } else {\n        for (const fields of Object.values(this._fieldObjects)) {\n          allFields.push(...fields);\n        }\n      }\n      const storage = this.annotationStorage;\n      const allIds = [];\n      for (const field of allFields) {\n        const {\n          id\n        } = field;\n        allIds.push(id);\n        switch (field.type) {\n          case \"text\":\n            {\n              const value = field.defaultValue || \"\";\n              storage.setValue(id, {\n                value\n              });\n              break;\n            }\n          case \"checkbox\":\n          case \"radiobutton\":\n            {\n              const value = field.defaultValue === field.exportValues;\n              storage.setValue(id, {\n                value\n              });\n              break;\n            }\n          case \"combobox\":\n          case \"listbox\":\n            {\n              const value = field.defaultValue || \"\";\n              storage.setValue(id, {\n                value\n              });\n              break;\n            }\n          default:\n            continue;\n        }\n        const domElement = document.querySelector(`[data-element-id=\"${id}\"]`);\n        if (!domElement) {\n          continue;\n        } else if (!GetElementsByNameSet.has(domElement)) {\n          warn(`_bindResetFormAction - element not allowed: ${id}`);\n          continue;\n        }\n        domElement.dispatchEvent(new Event(\"resetform\"));\n      }\n      if (this.enableScripting) {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: \"app\",\n            ids: allIds,\n            name: \"ResetForm\"\n          }\n        });\n      }\n      return false;\n    };\n  }\n}\nclass TextAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true\n    });\n  }\n  render() {\n    this.container.classList.add(\"textAnnotation\");\n    const image = document.createElement(\"img\");\n    image.src = this.imageResourcesPath + \"annotation-\" + this.data.name.toLowerCase() + \".svg\";\n    image.setAttribute(\"data-l10n-id\", \"pdfjs-text-annotation-type\");\n    image.setAttribute(\"data-l10n-args\", JSON.stringify({\n      type: this.data.name\n    }));\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    this.container.append(image);\n    return this.container;\n  }\n}\nclass WidgetAnnotationElement extends AnnotationElement {\n  render() {\n    return this.container;\n  }\n  showElementAndHideCanvas(element) {\n    if (this.data.hasOwnCanvas) {\n      if (element.previousSibling?.nodeName === \"CANVAS\") {\n        element.previousSibling.hidden = true;\n      }\n      element.hidden = false;\n    }\n  }\n  _getKeyModifier(event) {\n    return util_FeatureTest.platform.isMac ? event.metaKey : event.ctrlKey;\n  }\n  _setEventListener(element, elementData, baseName, eventName, valueGetter) {\n    if (baseName.includes(\"mouse\")) {\n      element.addEventListener(baseName, event => {\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: this.data.id,\n            name: eventName,\n            value: valueGetter(event),\n            shift: event.shiftKey,\n            modifier: this._getKeyModifier(event)\n          }\n        });\n      });\n    } else {\n      element.addEventListener(baseName, event => {\n        if (baseName === \"blur\") {\n          if (!elementData.focused || !event.relatedTarget) {\n            return;\n          }\n          elementData.focused = false;\n        } else if (baseName === \"focus\") {\n          if (elementData.focused) {\n            return;\n          }\n          elementData.focused = true;\n        }\n        if (!valueGetter) {\n          return;\n        }\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id: this.data.id,\n            name: eventName,\n            value: valueGetter(event)\n          }\n        });\n      });\n    }\n  }\n  _setEventListeners(element, elementData, names, getter) {\n    for (const [baseName, eventName] of names) {\n      if (eventName === \"Action\" || this.data.actions?.[eventName]) {\n        if (eventName === \"Focus\" || eventName === \"Blur\") {\n          elementData ||= {\n            focused: false\n          };\n        }\n        this._setEventListener(element, elementData, baseName, eventName, getter);\n        if (eventName === \"Focus\" && !this.data.actions?.Blur) {\n          this._setEventListener(element, elementData, \"blur\", \"Blur\", null);\n        } else if (eventName === \"Blur\" && !this.data.actions?.Focus) {\n          this._setEventListener(element, elementData, \"focus\", \"Focus\", null);\n        }\n      }\n    }\n  }\n  _setBackgroundColor(element) {\n    const color = this.data.backgroundColor || null;\n    element.style.backgroundColor = color === null ? \"transparent\" : Util.makeHexColor(color[0], color[1], color[2]);\n  }\n  _setTextStyle(element) {\n    const TEXT_ALIGNMENT = [\"left\", \"center\", \"right\"];\n    const {\n      fontColor\n    } = this.data.defaultAppearanceData;\n    const fontSize = this.data.defaultAppearanceData.fontSize || annotation_layer_DEFAULT_FONT_SIZE;\n    const style = element.style;\n    let computedFontSize;\n    const BORDER_SIZE = 2;\n    const roundToOneDecimal = x => Math.round(10 * x) / 10;\n    if (this.data.multiLine) {\n      const height = Math.abs(this.data.rect[3] - this.data.rect[1] - BORDER_SIZE);\n      const numberOfLines = Math.round(height / (LINE_FACTOR * fontSize)) || 1;\n      const lineHeight = height / numberOfLines;\n      computedFontSize = Math.min(fontSize, roundToOneDecimal(lineHeight / LINE_FACTOR));\n    } else {\n      const height = Math.abs(this.data.rect[3] - this.data.rect[1] - BORDER_SIZE);\n      computedFontSize = Math.min(fontSize, roundToOneDecimal(height / LINE_FACTOR));\n    }\n    style.fontSize = `calc(${computedFontSize}px * var(--scale-factor))`;\n    style.color = Util.makeHexColor(fontColor[0], fontColor[1], fontColor[2]);\n    if (this.data.textAlignment !== null) {\n      style.textAlign = TEXT_ALIGNMENT[this.data.textAlignment];\n    }\n  }\n  _setRequired(element, isRequired) {\n    if (isRequired) {\n      element.setAttribute(\"required\", true);\n    } else {\n      element.removeAttribute(\"required\");\n    }\n    element.setAttribute(\"aria-required\", isRequired);\n  }\n}\nclass TextWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    const isRenderable = parameters.renderForms || parameters.data.hasOwnCanvas || !parameters.data.hasAppearance && !!parameters.data.fieldValue;\n    super(parameters, {\n      isRenderable\n    });\n  }\n  setPropertyOnSiblings(base, key, value, keyInStorage) {\n    const storage = this.annotationStorage;\n    for (const element of this._getElementsByName(base.name, base.id)) {\n      if (element.domElement) {\n        element.domElement[key] = value;\n      }\n      storage.setValue(element.id, {\n        [keyInStorage]: value\n      });\n    }\n  }\n  render() {\n    const storage = this.annotationStorage;\n    const id = this.data.id;\n    this.container.classList.add(\"textWidgetAnnotation\");\n    let element = null;\n    if (this.renderForms) {\n      const storedData = storage.getValue(id, {\n        value: this.data.fieldValue\n      });\n      let textContent = storedData.value || \"\";\n      const maxLen = storage.getValue(id, {\n        charLimit: this.data.maxLen\n      }).charLimit;\n      if (maxLen && textContent.length > maxLen) {\n        textContent = textContent.slice(0, maxLen);\n      }\n      let fieldFormattedValues = storedData.formattedValue || this.data.textContent?.join(\"\\n\") || null;\n      if (fieldFormattedValues && this.data.comb) {\n        fieldFormattedValues = fieldFormattedValues.replaceAll(/\\s+/g, \"\");\n      }\n      const elementData = {\n        userValue: textContent,\n        formattedValue: fieldFormattedValues,\n        lastCommittedValue: null,\n        commitKey: 1,\n        focused: false\n      };\n      if (this.data.multiLine) {\n        element = document.createElement(\"textarea\");\n        element.textContent = fieldFormattedValues ?? textContent;\n        if (this.data.doNotScroll) {\n          element.style.overflowY = \"hidden\";\n        }\n      } else {\n        element = document.createElement(\"input\");\n        element.type = \"text\";\n        element.setAttribute(\"value\", fieldFormattedValues ?? textContent);\n        if (this.data.doNotScroll) {\n          element.style.overflowX = \"hidden\";\n        }\n      }\n      if (this.data.hasOwnCanvas) {\n        element.hidden = true;\n      }\n      GetElementsByNameSet.add(element);\n      element.setAttribute(\"data-element-id\", id);\n      element.disabled = this.data.readOnly;\n      element.name = this.data.fieldName;\n      element.tabIndex = DEFAULT_TAB_INDEX;\n      this._setRequired(element, this.data.required);\n      if (maxLen) {\n        element.maxLength = maxLen;\n      }\n      element.addEventListener(\"input\", event => {\n        storage.setValue(id, {\n          value: event.target.value\n        });\n        this.setPropertyOnSiblings(element, \"value\", event.target.value, \"value\");\n        elementData.formattedValue = null;\n      });\n      element.addEventListener(\"resetform\", event => {\n        const defaultValue = this.data.defaultFieldValue ?? \"\";\n        element.value = elementData.userValue = defaultValue;\n        elementData.formattedValue = null;\n      });\n      let blurListener = event => {\n        const {\n          formattedValue\n        } = elementData;\n        if (formattedValue !== null && formattedValue !== undefined) {\n          event.target.value = formattedValue;\n        }\n        event.target.scrollLeft = 0;\n      };\n      if (this.enableScripting && this.hasJSActions) {\n        element.addEventListener(\"focus\", event => {\n          if (elementData.focused) {\n            return;\n          }\n          const {\n            target\n          } = event;\n          if (elementData.userValue) {\n            target.value = elementData.userValue;\n          }\n          elementData.lastCommittedValue = target.value;\n          elementData.commitKey = 1;\n          if (!this.data.actions?.Focus) {\n            elementData.focused = true;\n          }\n        });\n        element.addEventListener(\"updatefromsandbox\", jsEvent => {\n          this.showElementAndHideCanvas(jsEvent.target);\n          const actions = {\n            value(event) {\n              elementData.userValue = event.detail.value ?? \"\";\n              storage.setValue(id, {\n                value: elementData.userValue.toString()\n              });\n              event.target.value = elementData.userValue;\n            },\n            formattedValue(event) {\n              const {\n                formattedValue\n              } = event.detail;\n              elementData.formattedValue = formattedValue;\n              if (formattedValue !== null && formattedValue !== undefined && event.target !== document.activeElement) {\n                event.target.value = formattedValue;\n              }\n              storage.setValue(id, {\n                formattedValue\n              });\n            },\n            selRange(event) {\n              event.target.setSelectionRange(...event.detail.selRange);\n            },\n            charLimit: event => {\n              const {\n                charLimit\n              } = event.detail;\n              const {\n                target\n              } = event;\n              if (charLimit === 0) {\n                target.removeAttribute(\"maxLength\");\n                return;\n              }\n              target.setAttribute(\"maxLength\", charLimit);\n              let value = elementData.userValue;\n              if (!value || value.length <= charLimit) {\n                return;\n              }\n              value = value.slice(0, charLimit);\n              target.value = elementData.userValue = value;\n              storage.setValue(id, {\n                value\n              });\n              this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n                source: this,\n                detail: {\n                  id,\n                  name: \"Keystroke\",\n                  value,\n                  willCommit: true,\n                  commitKey: 1,\n                  selStart: target.selectionStart,\n                  selEnd: target.selectionEnd\n                }\n              });\n            }\n          };\n          this._dispatchEventFromSandbox(actions, jsEvent);\n        });\n        element.addEventListener(\"keydown\", event => {\n          elementData.commitKey = 1;\n          let commitKey = -1;\n          if (event.key === \"Escape\") {\n            commitKey = 0;\n          } else if (event.key === \"Enter\" && !this.data.multiLine) {\n            commitKey = 2;\n          } else if (event.key === \"Tab\") {\n            elementData.commitKey = 3;\n          }\n          if (commitKey === -1) {\n            return;\n          }\n          const {\n            value\n          } = event.target;\n          if (elementData.lastCommittedValue === value) {\n            return;\n          }\n          elementData.lastCommittedValue = value;\n          elementData.userValue = value;\n          this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n            source: this,\n            detail: {\n              id,\n              name: \"Keystroke\",\n              value,\n              willCommit: true,\n              commitKey,\n              selStart: event.target.selectionStart,\n              selEnd: event.target.selectionEnd\n            }\n          });\n        });\n        const _blurListener = blurListener;\n        blurListener = null;\n        element.addEventListener(\"blur\", event => {\n          if (!elementData.focused || !event.relatedTarget) {\n            return;\n          }\n          if (!this.data.actions?.Blur) {\n            elementData.focused = false;\n          }\n          const {\n            value\n          } = event.target;\n          elementData.userValue = value;\n          if (elementData.lastCommittedValue !== value) {\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id,\n                name: \"Keystroke\",\n                value,\n                willCommit: true,\n                commitKey: elementData.commitKey,\n                selStart: event.target.selectionStart,\n                selEnd: event.target.selectionEnd\n              }\n            });\n          }\n          _blurListener(event);\n        });\n        if (this.data.actions?.Keystroke) {\n          element.addEventListener(\"beforeinput\", event => {\n            elementData.lastCommittedValue = null;\n            const {\n              data,\n              target\n            } = event;\n            const {\n              value,\n              selectionStart,\n              selectionEnd\n            } = target;\n            let selStart = selectionStart,\n              selEnd = selectionEnd;\n            switch (event.inputType) {\n              case \"deleteWordBackward\":\n                {\n                  const match = value.substring(0, selectionStart).match(/\\w*[^\\w]*$/);\n                  if (match) {\n                    selStart -= match[0].length;\n                  }\n                  break;\n                }\n              case \"deleteWordForward\":\n                {\n                  const match = value.substring(selectionStart).match(/^[^\\w]*\\w*/);\n                  if (match) {\n                    selEnd += match[0].length;\n                  }\n                  break;\n                }\n              case \"deleteContentBackward\":\n                if (selectionStart === selectionEnd) {\n                  selStart -= 1;\n                }\n                break;\n              case \"deleteContentForward\":\n                if (selectionStart === selectionEnd) {\n                  selEnd += 1;\n                }\n                break;\n            }\n            event.preventDefault();\n            this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n              source: this,\n              detail: {\n                id,\n                name: \"Keystroke\",\n                value,\n                change: data || \"\",\n                willCommit: false,\n                selStart,\n                selEnd\n              }\n            });\n          });\n        }\n        this._setEventListeners(element, elementData, [[\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"]], event => event.target.value);\n      }\n      if (blurListener) {\n        element.addEventListener(\"blur\", blurListener);\n      }\n      if (this.data.comb) {\n        const fieldWidth = this.data.rect[2] - this.data.rect[0];\n        const combWidth = fieldWidth / maxLen;\n        element.classList.add(\"comb\");\n        element.style.letterSpacing = `calc(${combWidth}px * var(--scale-factor) - 1ch)`;\n      }\n    } else {\n      element = document.createElement(\"div\");\n      element.textContent = this.data.fieldValue;\n      element.style.verticalAlign = \"middle\";\n      element.style.display = \"table-cell\";\n      if (this.data.hasOwnCanvas) {\n        element.hidden = true;\n      }\n    }\n    this._setTextStyle(element);\n    this._setBackgroundColor(element);\n    this._setDefaultPropertiesFromJS(element);\n    this.container.append(element);\n    return this.container;\n  }\n}\nclass SignatureWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: !!parameters.data.hasOwnCanvas\n    });\n  }\n}\nclass CheckboxWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: parameters.renderForms\n    });\n  }\n  render() {\n    const storage = this.annotationStorage;\n    const data = this.data;\n    const id = data.id;\n    let value = storage.getValue(id, {\n      value: data.exportValue === data.fieldValue\n    }).value;\n    if (typeof value === \"string\") {\n      value = value !== \"Off\";\n      storage.setValue(id, {\n        value\n      });\n    }\n    this.container.classList.add(\"buttonWidgetAnnotation\", \"checkBox\");\n    const element = document.createElement(\"input\");\n    GetElementsByNameSet.add(element);\n    element.setAttribute(\"data-element-id\", id);\n    element.disabled = data.readOnly;\n    this._setRequired(element, this.data.required);\n    element.type = \"checkbox\";\n    element.name = data.fieldName;\n    if (value) {\n      element.setAttribute(\"checked\", true);\n    }\n    element.setAttribute(\"exportValue\", data.exportValue);\n    element.tabIndex = DEFAULT_TAB_INDEX;\n    element.addEventListener(\"change\", event => {\n      const {\n        name,\n        checked\n      } = event.target;\n      for (const checkbox of this._getElementsByName(name, id)) {\n        const curChecked = checked && checkbox.exportValue === data.exportValue;\n        if (checkbox.domElement) {\n          checkbox.domElement.checked = curChecked;\n        }\n        storage.setValue(checkbox.id, {\n          value: curChecked\n        });\n      }\n      storage.setValue(id, {\n        value: checked\n      });\n    });\n    element.addEventListener(\"resetform\", event => {\n      const defaultValue = data.defaultFieldValue || \"Off\";\n      event.target.checked = defaultValue === data.exportValue;\n    });\n    if (this.enableScripting && this.hasJSActions) {\n      element.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value(event) {\n            event.target.checked = event.detail.value !== \"Off\";\n            storage.setValue(id, {\n              value: event.target.checked\n            });\n          }\n        };\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n      this._setEventListeners(element, null, [[\"change\", \"Validate\"], [\"change\", \"Action\"], [\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"]], event => event.target.checked);\n    }\n    this._setBackgroundColor(element);\n    this._setDefaultPropertiesFromJS(element);\n    this.container.append(element);\n    return this.container;\n  }\n}\nclass RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: parameters.renderForms\n    });\n  }\n  render() {\n    this.container.classList.add(\"buttonWidgetAnnotation\", \"radioButton\");\n    const storage = this.annotationStorage;\n    const data = this.data;\n    const id = data.id;\n    let value = storage.getValue(id, {\n      value: data.fieldValue === data.buttonValue\n    }).value;\n    if (typeof value === \"string\") {\n      value = value !== data.buttonValue;\n      storage.setValue(id, {\n        value\n      });\n    }\n    if (value) {\n      for (const radio of this._getElementsByName(data.fieldName, id)) {\n        storage.setValue(radio.id, {\n          value: false\n        });\n      }\n    }\n    const element = document.createElement(\"input\");\n    GetElementsByNameSet.add(element);\n    element.setAttribute(\"data-element-id\", id);\n    element.disabled = data.readOnly;\n    this._setRequired(element, this.data.required);\n    element.type = \"radio\";\n    element.name = data.fieldName;\n    if (value) {\n      element.setAttribute(\"checked\", true);\n    }\n    element.tabIndex = DEFAULT_TAB_INDEX;\n    element.addEventListener(\"change\", event => {\n      const {\n        name,\n        checked\n      } = event.target;\n      for (const radio of this._getElementsByName(name, id)) {\n        storage.setValue(radio.id, {\n          value: false\n        });\n      }\n      storage.setValue(id, {\n        value: checked\n      });\n    });\n    element.addEventListener(\"resetform\", event => {\n      const defaultValue = data.defaultFieldValue;\n      event.target.checked = defaultValue !== null && defaultValue !== undefined && defaultValue === data.buttonValue;\n    });\n    if (this.enableScripting && this.hasJSActions) {\n      const pdfButtonValue = data.buttonValue;\n      element.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value: event => {\n            const checked = pdfButtonValue === event.detail.value;\n            for (const radio of this._getElementsByName(event.target.name)) {\n              const curChecked = checked && radio.id === id;\n              if (radio.domElement) {\n                radio.domElement.checked = curChecked;\n              }\n              storage.setValue(radio.id, {\n                value: curChecked\n              });\n            }\n          }\n        };\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n      this._setEventListeners(element, null, [[\"change\", \"Validate\"], [\"change\", \"Action\"], [\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"]], event => event.target.checked);\n    }\n    this._setBackgroundColor(element);\n    this._setDefaultPropertiesFromJS(element);\n    this.container.append(element);\n    return this.container;\n  }\n}\nclass PushButtonWidgetAnnotationElement extends LinkAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      ignoreBorder: parameters.data.hasAppearance\n    });\n  }\n  render() {\n    const container = super.render();\n    container.classList.add(\"buttonWidgetAnnotation\", \"pushButton\");\n    const linkElement = container.lastChild;\n    if (this.enableScripting && this.hasJSActions && linkElement) {\n      this._setDefaultPropertiesFromJS(linkElement);\n      linkElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n        this._dispatchEventFromSandbox({}, jsEvent);\n      });\n    }\n    return container;\n  }\n}\nclass ChoiceWidgetAnnotationElement extends WidgetAnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: parameters.renderForms\n    });\n  }\n  render() {\n    this.container.classList.add(\"choiceWidgetAnnotation\");\n    const storage = this.annotationStorage;\n    const id = this.data.id;\n    const storedData = storage.getValue(id, {\n      value: this.data.fieldValue\n    });\n    const selectElement = document.createElement(\"select\");\n    GetElementsByNameSet.add(selectElement);\n    selectElement.setAttribute(\"data-element-id\", id);\n    selectElement.disabled = this.data.readOnly;\n    this._setRequired(selectElement, this.data.required);\n    selectElement.name = this.data.fieldName;\n    selectElement.tabIndex = DEFAULT_TAB_INDEX;\n    let addAnEmptyEntry = this.data.combo && this.data.options.length > 0;\n    if (!this.data.combo) {\n      selectElement.size = this.data.options.length;\n      if (this.data.multiSelect) {\n        selectElement.multiple = true;\n      }\n    }\n    selectElement.addEventListener(\"resetform\", event => {\n      const defaultValue = this.data.defaultFieldValue;\n      for (const option of selectElement.options) {\n        option.selected = option.value === defaultValue;\n      }\n    });\n    for (const option of this.data.options) {\n      const optionElement = document.createElement(\"option\");\n      optionElement.textContent = option.displayValue;\n      optionElement.value = option.exportValue;\n      if (storedData.value.includes(option.exportValue)) {\n        optionElement.setAttribute(\"selected\", true);\n        addAnEmptyEntry = false;\n      }\n      selectElement.append(optionElement);\n    }\n    let removeEmptyEntry = null;\n    if (addAnEmptyEntry) {\n      const noneOptionElement = document.createElement(\"option\");\n      noneOptionElement.value = \" \";\n      noneOptionElement.setAttribute(\"hidden\", true);\n      noneOptionElement.setAttribute(\"selected\", true);\n      selectElement.prepend(noneOptionElement);\n      removeEmptyEntry = () => {\n        noneOptionElement.remove();\n        selectElement.removeEventListener(\"input\", removeEmptyEntry);\n        removeEmptyEntry = null;\n      };\n      selectElement.addEventListener(\"input\", removeEmptyEntry);\n    }\n    const getValue = isExport => {\n      const name = isExport ? \"value\" : \"textContent\";\n      const {\n        options,\n        multiple\n      } = selectElement;\n      if (!multiple) {\n        return options.selectedIndex === -1 ? null : options[options.selectedIndex][name];\n      }\n      return Array.prototype.filter.call(options, option => option.selected).map(option => option[name]);\n    };\n    let selectedValues = getValue(false);\n    const getItems = event => {\n      const options = event.target.options;\n      return Array.prototype.map.call(options, option => ({\n        displayValue: option.textContent,\n        exportValue: option.value\n      }));\n    };\n    if (this.enableScripting && this.hasJSActions) {\n      selectElement.addEventListener(\"updatefromsandbox\", jsEvent => {\n        const actions = {\n          value(event) {\n            removeEmptyEntry?.();\n            const value = event.detail.value;\n            const values = new Set(Array.isArray(value) ? value : [value]);\n            for (const option of selectElement.options) {\n              option.selected = values.has(option.value);\n            }\n            storage.setValue(id, {\n              value: getValue(true)\n            });\n            selectedValues = getValue(false);\n          },\n          multipleSelection(event) {\n            selectElement.multiple = true;\n          },\n          remove(event) {\n            const options = selectElement.options;\n            const index = event.detail.remove;\n            options[index].selected = false;\n            selectElement.remove(index);\n            if (options.length > 0) {\n              const i = Array.prototype.findIndex.call(options, option => option.selected);\n              if (i === -1) {\n                options[0].selected = true;\n              }\n            }\n            storage.setValue(id, {\n              value: getValue(true),\n              items: getItems(event)\n            });\n            selectedValues = getValue(false);\n          },\n          clear(event) {\n            while (selectElement.length !== 0) {\n              selectElement.remove(0);\n            }\n            storage.setValue(id, {\n              value: null,\n              items: []\n            });\n            selectedValues = getValue(false);\n          },\n          insert(event) {\n            const {\n              index,\n              displayValue,\n              exportValue\n            } = event.detail.insert;\n            const selectChild = selectElement.children[index];\n            const optionElement = document.createElement(\"option\");\n            optionElement.textContent = displayValue;\n            optionElement.value = exportValue;\n            if (selectChild) {\n              selectChild.before(optionElement);\n            } else {\n              selectElement.append(optionElement);\n            }\n            storage.setValue(id, {\n              value: getValue(true),\n              items: getItems(event)\n            });\n            selectedValues = getValue(false);\n          },\n          items(event) {\n            const {\n              items\n            } = event.detail;\n            while (selectElement.length !== 0) {\n              selectElement.remove(0);\n            }\n            for (const item of items) {\n              const {\n                displayValue,\n                exportValue\n              } = item;\n              const optionElement = document.createElement(\"option\");\n              optionElement.textContent = displayValue;\n              optionElement.value = exportValue;\n              selectElement.append(optionElement);\n            }\n            if (selectElement.options.length > 0) {\n              selectElement.options[0].selected = true;\n            }\n            storage.setValue(id, {\n              value: getValue(true),\n              items: getItems(event)\n            });\n            selectedValues = getValue(false);\n          },\n          indices(event) {\n            const indices = new Set(event.detail.indices);\n            for (const option of event.target.options) {\n              option.selected = indices.has(option.index);\n            }\n            storage.setValue(id, {\n              value: getValue(true)\n            });\n            selectedValues = getValue(false);\n          },\n          editable(event) {\n            event.target.disabled = !event.detail.editable;\n          }\n        };\n        this._dispatchEventFromSandbox(actions, jsEvent);\n      });\n      selectElement.addEventListener(\"input\", event => {\n        const exportValue = getValue(true);\n        const change = getValue(false);\n        storage.setValue(id, {\n          value: exportValue\n        });\n        event.preventDefault();\n        this.linkService.eventBus?.dispatch(\"dispatcheventinsandbox\", {\n          source: this,\n          detail: {\n            id,\n            name: \"Keystroke\",\n            value: selectedValues,\n            change,\n            changeEx: exportValue,\n            willCommit: false,\n            commitKey: 1,\n            keyDown: false\n          }\n        });\n      });\n      this._setEventListeners(selectElement, null, [[\"focus\", \"Focus\"], [\"blur\", \"Blur\"], [\"mousedown\", \"Mouse Down\"], [\"mouseenter\", \"Mouse Enter\"], [\"mouseleave\", \"Mouse Exit\"], [\"mouseup\", \"Mouse Up\"], [\"input\", \"Action\"], [\"input\", \"Validate\"]], event => event.target.value);\n    } else {\n      selectElement.addEventListener(\"input\", function (event) {\n        storage.setValue(id, {\n          value: getValue(true)\n        });\n      });\n    }\n    if (this.data.combo) {\n      this._setTextStyle(selectElement);\n    } else {}\n    this._setBackgroundColor(selectElement);\n    this._setDefaultPropertiesFromJS(selectElement);\n    this.container.append(selectElement);\n    return this.container;\n  }\n}\nclass PopupAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    const {\n      data,\n      elements\n    } = parameters;\n    super(parameters, {\n      isRenderable: AnnotationElement._hasPopupData(data)\n    });\n    this.elements = elements;\n    this.popup = null;\n  }\n  render() {\n    this.container.classList.add(\"popupAnnotation\");\n    const popup = this.popup = new PopupElement({\n      container: this.container,\n      color: this.data.color,\n      titleObj: this.data.titleObj,\n      modificationDate: this.data.modificationDate,\n      contentsObj: this.data.contentsObj,\n      richText: this.data.richText,\n      rect: this.data.rect,\n      parentRect: this.data.parentRect || null,\n      parent: this.parent,\n      elements: this.elements,\n      open: this.data.open\n    });\n    const elementIds = [];\n    for (const element of this.elements) {\n      element.popup = popup;\n      elementIds.push(element.data.id);\n      element.addHighlightArea();\n    }\n    this.container.setAttribute(\"aria-controls\", elementIds.map(id => `${AnnotationPrefix}${id}`).join(\",\"));\n    return this.container;\n  }\n}\nclass PopupElement {\n  #boundKeyDown = this.#keyDown.bind(this);\n  #boundHide = this.#hide.bind(this);\n  #boundShow = this.#show.bind(this);\n  #boundToggle = this.#toggle.bind(this);\n  #color = null;\n  #container = null;\n  #contentsObj = null;\n  #dateObj = null;\n  #elements = null;\n  #parent = null;\n  #parentRect = null;\n  #pinned = false;\n  #popup = null;\n  #position = null;\n  #rect = null;\n  #richText = null;\n  #titleObj = null;\n  #updates = null;\n  #wasVisible = false;\n  constructor({\n    container,\n    color,\n    elements,\n    titleObj,\n    modificationDate,\n    contentsObj,\n    richText,\n    parent,\n    rect,\n    parentRect,\n    open\n  }) {\n    this.#container = container;\n    this.#titleObj = titleObj;\n    this.#contentsObj = contentsObj;\n    this.#richText = richText;\n    this.#parent = parent;\n    this.#color = color;\n    this.#rect = rect;\n    this.#parentRect = parentRect;\n    this.#elements = elements;\n    this.#dateObj = PDFDateString.toDateObject(modificationDate);\n    this.trigger = elements.flatMap(e => e.getElementsToTriggerPopup());\n    for (const element of this.trigger) {\n      element.addEventListener(\"click\", this.#boundToggle);\n      element.addEventListener(\"mouseenter\", this.#boundShow);\n      element.addEventListener(\"mouseleave\", this.#boundHide);\n      element.classList.add(\"popupTriggerArea\");\n    }\n    for (const element of elements) {\n      element.container?.addEventListener(\"keydown\", this.#boundKeyDown);\n    }\n    this.#container.hidden = true;\n    if (open) {\n      this.#toggle();\n    }\n  }\n  render() {\n    if (this.#popup) {\n      return;\n    }\n    const popup = this.#popup = document.createElement(\"div\");\n    popup.className = \"popup\";\n    if (this.#color) {\n      const baseColor = popup.style.outlineColor = Util.makeHexColor(...this.#color);\n      if (CSS.supports(\"background-color\", \"color-mix(in srgb, red 30%, white)\")) {\n        popup.style.backgroundColor = `color-mix(in srgb, ${baseColor} 30%, white)`;\n      } else {\n        const BACKGROUND_ENLIGHT = 0.7;\n        popup.style.backgroundColor = Util.makeHexColor(...this.#color.map(c => Math.floor(BACKGROUND_ENLIGHT * (255 - c) + c)));\n      }\n    }\n    const header = document.createElement(\"span\");\n    header.className = \"header\";\n    const title = document.createElement(\"h1\");\n    header.append(title);\n    ({\n      dir: title.dir,\n      str: title.textContent\n    } = this.#titleObj);\n    popup.append(header);\n    if (this.#dateObj) {\n      const modificationDate = document.createElement(\"span\");\n      modificationDate.classList.add(\"popupDate\");\n      modificationDate.setAttribute(\"data-l10n-id\", \"pdfjs-annotation-date-time-string\");\n      modificationDate.setAttribute(\"data-l10n-args\", JSON.stringify({\n        dateObj: this.#dateObj.valueOf()\n      }));\n      header.append(modificationDate);\n    }\n    const html = this.#html;\n    if (html) {\n      XfaLayer.render({\n        xfaHtml: html,\n        intent: \"richText\",\n        div: popup\n      });\n      popup.lastChild.classList.add(\"richText\", \"popupContent\");\n    } else {\n      const contents = this._formatContents(this.#contentsObj);\n      popup.append(contents);\n    }\n    this.#container.append(popup);\n  }\n  get #html() {\n    const richText = this.#richText;\n    const contentsObj = this.#contentsObj;\n    if (richText?.str && (!contentsObj?.str || contentsObj.str === richText.str)) {\n      return this.#richText.html || null;\n    }\n    return null;\n  }\n  get #fontSize() {\n    return this.#html?.attributes?.style?.fontSize || 0;\n  }\n  get #fontColor() {\n    return this.#html?.attributes?.style?.color || null;\n  }\n  #makePopupContent(text) {\n    const popupLines = [];\n    const popupContent = {\n      str: text,\n      html: {\n        name: \"div\",\n        attributes: {\n          dir: \"auto\"\n        },\n        children: [{\n          name: \"p\",\n          children: popupLines\n        }]\n      }\n    };\n    const lineAttributes = {\n      style: {\n        color: this.#fontColor,\n        fontSize: this.#fontSize ? `calc(${this.#fontSize}px * var(--scale-factor))` : \"\"\n      }\n    };\n    for (const line of text.split(\"\\n\")) {\n      popupLines.push({\n        name: \"span\",\n        value: line,\n        attributes: lineAttributes\n      });\n    }\n    return popupContent;\n  }\n  _formatContents({\n    str,\n    dir\n  }) {\n    const p = document.createElement(\"p\");\n    p.classList.add(\"popupContent\");\n    p.dir = dir;\n    const lines = str.split(/(?:\\r\\n?|\\n)/);\n    for (let i = 0, ii = lines.length; i < ii; ++i) {\n      const line = lines[i];\n      p.append(document.createTextNode(line));\n      if (i < ii - 1) {\n        p.append(document.createElement(\"br\"));\n      }\n    }\n    return p;\n  }\n  #keyDown(event) {\n    if (event.altKey || event.shiftKey || event.ctrlKey || event.metaKey) {\n      return;\n    }\n    if (event.key === \"Enter\" || event.key === \"Escape\" && this.#pinned) {\n      this.#toggle();\n    }\n  }\n  updateEdited({\n    rect,\n    popupContent\n  }) {\n    this.#updates ||= {\n      contentsObj: this.#contentsObj,\n      richText: this.#richText\n    };\n    if (rect) {\n      this.#position = null;\n    }\n    if (popupContent) {\n      this.#richText = this.#makePopupContent(popupContent);\n      this.#contentsObj = null;\n    }\n    this.#popup?.remove();\n    this.#popup = null;\n  }\n  resetEdited() {\n    if (!this.#updates) {\n      return;\n    }\n    ({\n      contentsObj: this.#contentsObj,\n      richText: this.#richText\n    } = this.#updates);\n    this.#updates = null;\n    this.#popup?.remove();\n    this.#popup = null;\n    this.#position = null;\n  }\n  #setPosition() {\n    if (this.#position !== null) {\n      return;\n    }\n    const {\n      page: {\n        view\n      },\n      viewport: {\n        rawDims: {\n          pageWidth,\n          pageHeight,\n          pageX,\n          pageY\n        }\n      }\n    } = this.#parent;\n    let useParentRect = !!this.#parentRect;\n    let rect = useParentRect ? this.#parentRect : this.#rect;\n    for (const element of this.#elements) {\n      if (!rect || Util.intersect(element.data.rect, rect) !== null) {\n        rect = element.data.rect;\n        useParentRect = true;\n        break;\n      }\n    }\n    const normalizedRect = Util.normalizeRect([rect[0], view[3] - rect[1] + view[1], rect[2], view[3] - rect[3] + view[1]]);\n    const HORIZONTAL_SPACE_AFTER_ANNOTATION = 5;\n    const parentWidth = useParentRect ? rect[2] - rect[0] + HORIZONTAL_SPACE_AFTER_ANNOTATION : 0;\n    const popupLeft = normalizedRect[0] + parentWidth;\n    const popupTop = normalizedRect[1];\n    this.#position = [100 * (popupLeft - pageX) / pageWidth, 100 * (popupTop - pageY) / pageHeight];\n    const {\n      style\n    } = this.#container;\n    style.left = `${this.#position[0]}%`;\n    style.top = `${this.#position[1]}%`;\n  }\n  #toggle() {\n    this.#pinned = !this.#pinned;\n    if (this.#pinned) {\n      this.#show();\n      this.#container.addEventListener(\"click\", this.#boundToggle);\n      this.#container.addEventListener(\"keydown\", this.#boundKeyDown);\n    } else {\n      this.#hide();\n      this.#container.removeEventListener(\"click\", this.#boundToggle);\n      this.#container.removeEventListener(\"keydown\", this.#boundKeyDown);\n    }\n  }\n  #show() {\n    if (!this.#popup) {\n      this.render();\n    }\n    if (!this.isVisible) {\n      this.#setPosition();\n      this.#container.hidden = false;\n      this.#container.style.zIndex = parseInt(this.#container.style.zIndex) + 1000;\n    } else if (this.#pinned) {\n      this.#container.classList.add(\"focused\");\n    }\n  }\n  #hide() {\n    this.#container.classList.remove(\"focused\");\n    if (this.#pinned || !this.isVisible) {\n      return;\n    }\n    this.#container.hidden = true;\n    this.#container.style.zIndex = parseInt(this.#container.style.zIndex) - 1000;\n  }\n  forceHide() {\n    this.#wasVisible = this.isVisible;\n    if (!this.#wasVisible) {\n      return;\n    }\n    this.#container.hidden = true;\n  }\n  maybeShow() {\n    if (!this.#wasVisible) {\n      return;\n    }\n    if (!this.#popup) {\n      this.#show();\n    }\n    this.#wasVisible = false;\n    this.#container.hidden = false;\n  }\n  get isVisible() {\n    return this.#container.hidden === false;\n  }\n}\nclass FreeTextAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n    this.textContent = parameters.data.textContent;\n    this.textPosition = parameters.data.textPosition;\n    this.annotationEditorType = AnnotationEditorType.FREETEXT;\n  }\n  render() {\n    this.container.classList.add(\"freeTextAnnotation\");\n    if (this.textContent) {\n      const content = document.createElement(\"div\");\n      content.classList.add(\"annotationTextContent\");\n      content.setAttribute(\"role\", \"comment\");\n      for (const line of this.textContent) {\n        const lineSpan = document.createElement(\"span\");\n        lineSpan.textContent = line;\n        content.append(lineSpan);\n      }\n      this.container.append(content);\n    }\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    this._editOnDoubleClick();\n    return this.container;\n  }\n}\nclass LineAnnotationElement extends AnnotationElement {\n  #line = null;\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n  render() {\n    this.container.classList.add(\"lineAnnotation\");\n    const data = this.data;\n    const {\n      width,\n      height\n    } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(width, height, true);\n    const line = this.#line = this.svgFactory.createElement(\"svg:line\");\n    line.setAttribute(\"x1\", data.rect[2] - data.lineCoordinates[0]);\n    line.setAttribute(\"y1\", data.rect[3] - data.lineCoordinates[1]);\n    line.setAttribute(\"x2\", data.rect[2] - data.lineCoordinates[2]);\n    line.setAttribute(\"y2\", data.rect[3] - data.lineCoordinates[3]);\n    line.setAttribute(\"stroke-width\", data.borderStyle.width || 1);\n    line.setAttribute(\"stroke\", \"transparent\");\n    line.setAttribute(\"fill\", \"transparent\");\n    svg.append(line);\n    this.container.append(svg);\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n  getElementsToTriggerPopup() {\n    return this.#line;\n  }\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\nclass SquareAnnotationElement extends AnnotationElement {\n  #square = null;\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n  render() {\n    this.container.classList.add(\"squareAnnotation\");\n    const data = this.data;\n    const {\n      width,\n      height\n    } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(width, height, true);\n    const borderWidth = data.borderStyle.width;\n    const square = this.#square = this.svgFactory.createElement(\"svg:rect\");\n    square.setAttribute(\"x\", borderWidth / 2);\n    square.setAttribute(\"y\", borderWidth / 2);\n    square.setAttribute(\"width\", width - borderWidth);\n    square.setAttribute(\"height\", height - borderWidth);\n    square.setAttribute(\"stroke-width\", borderWidth || 1);\n    square.setAttribute(\"stroke\", \"transparent\");\n    square.setAttribute(\"fill\", \"transparent\");\n    svg.append(square);\n    this.container.append(svg);\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n  getElementsToTriggerPopup() {\n    return this.#square;\n  }\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\nclass CircleAnnotationElement extends AnnotationElement {\n  #circle = null;\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n  render() {\n    this.container.classList.add(\"circleAnnotation\");\n    const data = this.data;\n    const {\n      width,\n      height\n    } = getRectDims(data.rect);\n    const svg = this.svgFactory.create(width, height, true);\n    const borderWidth = data.borderStyle.width;\n    const circle = this.#circle = this.svgFactory.createElement(\"svg:ellipse\");\n    circle.setAttribute(\"cx\", width / 2);\n    circle.setAttribute(\"cy\", height / 2);\n    circle.setAttribute(\"rx\", width / 2 - borderWidth / 2);\n    circle.setAttribute(\"ry\", height / 2 - borderWidth / 2);\n    circle.setAttribute(\"stroke-width\", borderWidth || 1);\n    circle.setAttribute(\"stroke\", \"transparent\");\n    circle.setAttribute(\"fill\", \"transparent\");\n    svg.append(circle);\n    this.container.append(svg);\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n  getElementsToTriggerPopup() {\n    return this.#circle;\n  }\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\nclass PolylineAnnotationElement extends AnnotationElement {\n  #polyline = null;\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n    this.containerClassName = \"polylineAnnotation\";\n    this.svgElementName = \"svg:polyline\";\n  }\n  render() {\n    this.container.classList.add(this.containerClassName);\n    const {\n      data: {\n        rect,\n        vertices,\n        borderStyle,\n        popupRef\n      }\n    } = this;\n    if (!vertices) {\n      return this.container;\n    }\n    const {\n      width,\n      height\n    } = getRectDims(rect);\n    const svg = this.svgFactory.create(width, height, true);\n    let points = [];\n    for (let i = 0, ii = vertices.length; i < ii; i += 2) {\n      const x = vertices[i] - rect[0];\n      const y = rect[3] - vertices[i + 1];\n      points.push(`${x},${y}`);\n    }\n    points = points.join(\" \");\n    const polyline = this.#polyline = this.svgFactory.createElement(this.svgElementName);\n    polyline.setAttribute(\"points\", points);\n    polyline.setAttribute(\"stroke-width\", borderStyle.width || 1);\n    polyline.setAttribute(\"stroke\", \"transparent\");\n    polyline.setAttribute(\"fill\", \"transparent\");\n    svg.append(polyline);\n    this.container.append(svg);\n    if (!popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n  getElementsToTriggerPopup() {\n    return this.#polyline;\n  }\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\nclass PolygonAnnotationElement extends PolylineAnnotationElement {\n  constructor(parameters) {\n    super(parameters);\n    this.containerClassName = \"polygonAnnotation\";\n    this.svgElementName = \"svg:polygon\";\n  }\n}\nclass CaretAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n  render() {\n    this.container.classList.add(\"caretAnnotation\");\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n}\nclass InkAnnotationElement extends AnnotationElement {\n  #polylines = [];\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n    this.containerClassName = \"inkAnnotation\";\n    this.svgElementName = \"svg:polyline\";\n    this.annotationEditorType = AnnotationEditorType.INK;\n  }\n  render() {\n    this.container.classList.add(this.containerClassName);\n    const {\n      data: {\n        rect,\n        inkLists,\n        borderStyle,\n        popupRef\n      }\n    } = this;\n    const {\n      width,\n      height\n    } = getRectDims(rect);\n    const svg = this.svgFactory.create(width, height, true);\n    for (const inkList of inkLists) {\n      let points = [];\n      for (let i = 0, ii = inkList.length; i < ii; i += 2) {\n        const x = inkList[i] - rect[0];\n        const y = rect[3] - inkList[i + 1];\n        points.push(`${x},${y}`);\n      }\n      points = points.join(\" \");\n      const polyline = this.svgFactory.createElement(this.svgElementName);\n      this.#polylines.push(polyline);\n      polyline.setAttribute(\"points\", points);\n      polyline.setAttribute(\"stroke-width\", borderStyle.width || 1);\n      polyline.setAttribute(\"stroke\", \"transparent\");\n      polyline.setAttribute(\"fill\", \"transparent\");\n      if (!popupRef && this.hasPopupData) {\n        this._createPopup();\n      }\n      svg.append(polyline);\n    }\n    this.container.append(svg);\n    return this.container;\n  }\n  getElementsToTriggerPopup() {\n    return this.#polylines;\n  }\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n}\nclass HighlightAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true\n    });\n  }\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    this.container.classList.add(\"highlightAnnotation\");\n    return this.container;\n  }\n}\nclass UnderlineAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true\n    });\n  }\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    this.container.classList.add(\"underlineAnnotation\");\n    return this.container;\n  }\n}\nclass SquigglyAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true\n    });\n  }\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    this.container.classList.add(\"squigglyAnnotation\");\n    return this.container;\n  }\n}\nclass StrikeOutAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true,\n      createQuadrilaterals: true\n    });\n  }\n  render() {\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    this.container.classList.add(\"strikeoutAnnotation\");\n    return this.container;\n  }\n}\nclass StampAnnotationElement extends AnnotationElement {\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true,\n      ignoreBorder: true\n    });\n  }\n  render() {\n    this.container.classList.add(\"stampAnnotation\");\n    if (!this.data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    }\n    return this.container;\n  }\n}\nclass FileAttachmentAnnotationElement extends AnnotationElement {\n  #trigger = null;\n  constructor(parameters) {\n    super(parameters, {\n      isRenderable: true\n    });\n    const {\n      file\n    } = this.data;\n    this.filename = file.filename;\n    this.content = file.content;\n    this.linkService.eventBus?.dispatch(\"fileattachmentannotation\", {\n      source: this,\n      ...file\n    });\n  }\n  render() {\n    this.container.classList.add(\"fileAttachmentAnnotation\");\n    const {\n      container,\n      data\n    } = this;\n    let trigger;\n    if (data.hasAppearance || data.fillAlpha === 0) {\n      trigger = document.createElement(\"div\");\n    } else {\n      trigger = document.createElement(\"img\");\n      trigger.src = `${this.imageResourcesPath}annotation-${/paperclip/i.test(data.name) ? \"paperclip\" : \"pushpin\"}.svg`;\n      if (data.fillAlpha && data.fillAlpha < 1) {\n        trigger.style = `filter: opacity(${Math.round(data.fillAlpha * 100)}%);`;\n      }\n    }\n    trigger.addEventListener(\"dblclick\", this.#download.bind(this));\n    this.#trigger = trigger;\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n    container.addEventListener(\"keydown\", evt => {\n      if (evt.key === \"Enter\" && (isMac ? evt.metaKey : evt.ctrlKey)) {\n        this.#download();\n      }\n    });\n    if (!data.popupRef && this.hasPopupData) {\n      this._createPopup();\n    } else {\n      trigger.classList.add(\"popupTriggerArea\");\n    }\n    container.append(trigger);\n    return container;\n  }\n  getElementsToTriggerPopup() {\n    return this.#trigger;\n  }\n  addHighlightArea() {\n    this.container.classList.add(\"highlightArea\");\n  }\n  #download() {\n    this.downloadManager?.openOrDownloadData(this.content, this.filename);\n  }\n}\nclass AnnotationLayer {\n  #accessibilityManager = null;\n  #annotationCanvasMap = null;\n  #editableAnnotations = new Map();\n  constructor({\n    div,\n    accessibilityManager,\n    annotationCanvasMap,\n    annotationEditorUIManager,\n    page,\n    viewport\n  }) {\n    this.div = div;\n    this.#accessibilityManager = accessibilityManager;\n    this.#annotationCanvasMap = annotationCanvasMap;\n    this.page = page;\n    this.viewport = viewport;\n    this.zIndex = 0;\n    this._annotationEditorUIManager = annotationEditorUIManager;\n  }\n  hasEditableAnnotations() {\n    return this.#editableAnnotations.size > 0;\n  }\n  #appendElement(element, id) {\n    const contentElement = element.firstChild || element;\n    contentElement.id = `${AnnotationPrefix}${id}`;\n    this.div.append(element);\n    this.#accessibilityManager?.moveElementInDOM(this.div, element, contentElement, false);\n  }\n  async render(params) {\n    const {\n      annotations\n    } = params;\n    const layer = this.div;\n    setLayerDimensions(layer, this.viewport);\n    const popupToElements = new Map();\n    const elementParams = {\n      data: null,\n      layer,\n      linkService: params.linkService,\n      downloadManager: params.downloadManager,\n      imageResourcesPath: params.imageResourcesPath || \"\",\n      renderForms: params.renderForms !== false,\n      svgFactory: new DOMSVGFactory(),\n      annotationStorage: params.annotationStorage || new AnnotationStorage(),\n      enableScripting: params.enableScripting === true,\n      hasJSActions: params.hasJSActions,\n      fieldObjects: params.fieldObjects,\n      parent: this,\n      elements: null\n    };\n    for (const data of annotations) {\n      if (data.noHTML) {\n        continue;\n      }\n      const isPopupAnnotation = data.annotationType === AnnotationType.POPUP;\n      if (!isPopupAnnotation) {\n        const {\n          width,\n          height\n        } = getRectDims(data.rect);\n        if (width <= 0 || height <= 0) {\n          continue;\n        }\n      } else {\n        const elements = popupToElements.get(data.id);\n        if (!elements) {\n          continue;\n        }\n        elementParams.elements = elements;\n      }\n      elementParams.data = data;\n      const element = AnnotationElementFactory.create(elementParams);\n      if (!element.isRenderable) {\n        continue;\n      }\n      if (!isPopupAnnotation && data.popupRef) {\n        const elements = popupToElements.get(data.popupRef);\n        if (!elements) {\n          popupToElements.set(data.popupRef, [element]);\n        } else {\n          elements.push(element);\n        }\n      }\n      const rendered = element.render();\n      if (data.hidden) {\n        rendered.style.visibility = \"hidden\";\n      }\n      this.#appendElement(rendered, data.id);\n      if (element._isEditable) {\n        this.#editableAnnotations.set(element.data.id, element);\n        this._annotationEditorUIManager?.renderAnnotationElement(element);\n      }\n    }\n    this.#setAnnotationCanvasMap();\n  }\n  update({\n    viewport\n  }) {\n    const layer = this.div;\n    this.viewport = viewport;\n    setLayerDimensions(layer, {\n      rotation: viewport.rotation\n    });\n    this.#setAnnotationCanvasMap();\n    layer.hidden = false;\n  }\n  #setAnnotationCanvasMap() {\n    if (!this.#annotationCanvasMap) {\n      return;\n    }\n    const layer = this.div;\n    for (const [id, canvas] of this.#annotationCanvasMap) {\n      const element = layer.querySelector(`[data-annotation-id=\"${id}\"]`);\n      if (!element) {\n        continue;\n      }\n      canvas.className = \"annotationContent\";\n      const {\n        firstChild\n      } = element;\n      if (!firstChild) {\n        element.append(canvas);\n      } else if (firstChild.nodeName === \"CANVAS\") {\n        firstChild.replaceWith(canvas);\n      } else if (!firstChild.classList.contains(\"annotationContent\")) {\n        firstChild.before(canvas);\n      } else {\n        firstChild.after(canvas);\n      }\n    }\n    this.#annotationCanvasMap.clear();\n  }\n  getEditableAnnotations() {\n    return Array.from(this.#editableAnnotations.values());\n  }\n  getEditableAnnotation(id) {\n    return this.#editableAnnotations.get(id);\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/freetext.js\n\n\n\n\nconst EOL_PATTERN = /\\r\\n?|\\n/g;\nclass FreeTextEditor extends AnnotationEditor {\n  #color;\n  #content = \"\";\n  #editorDivId = `${this.id}-editor`;\n  #editModeAC = null;\n  #fontSize;\n  #initialData = null;\n  static _freeTextDefaultContent = \"\";\n  static _internalPadding = 0;\n  static _defaultColor = null;\n  static _defaultFontSize = 10;\n  static get _keyboardManager() {\n    const proto = FreeTextEditor.prototype;\n    const arrowChecker = self => self.isEmpty();\n    const small = AnnotationEditorUIManager.TRANSLATE_SMALL;\n    const big = AnnotationEditorUIManager.TRANSLATE_BIG;\n    return shadow(this, \"_keyboardManager\", new KeyboardManager([[[\"ctrl+s\", \"mac+meta+s\", \"ctrl+p\", \"mac+meta+p\"], proto.commitOrRemove, {\n      bubbles: true\n    }], [[\"ctrl+Enter\", \"mac+meta+Enter\", \"Escape\", \"mac+Escape\"], proto.commitOrRemove], [[\"ArrowLeft\", \"mac+ArrowLeft\"], proto._translateEmpty, {\n      args: [-small, 0],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowLeft\", \"mac+shift+ArrowLeft\"], proto._translateEmpty, {\n      args: [-big, 0],\n      checker: arrowChecker\n    }], [[\"ArrowRight\", \"mac+ArrowRight\"], proto._translateEmpty, {\n      args: [small, 0],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowRight\", \"mac+shift+ArrowRight\"], proto._translateEmpty, {\n      args: [big, 0],\n      checker: arrowChecker\n    }], [[\"ArrowUp\", \"mac+ArrowUp\"], proto._translateEmpty, {\n      args: [0, -small],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowUp\", \"mac+shift+ArrowUp\"], proto._translateEmpty, {\n      args: [0, -big],\n      checker: arrowChecker\n    }], [[\"ArrowDown\", \"mac+ArrowDown\"], proto._translateEmpty, {\n      args: [0, small],\n      checker: arrowChecker\n    }], [[\"ctrl+ArrowDown\", \"mac+shift+ArrowDown\"], proto._translateEmpty, {\n      args: [0, big],\n      checker: arrowChecker\n    }]]));\n  }\n  static _type = \"freetext\";\n  static _editorType = AnnotationEditorType.FREETEXT;\n  constructor(params) {\n    super({\n      ...params,\n      name: \"freeTextEditor\"\n    });\n    this.#color = params.color || FreeTextEditor._defaultColor || AnnotationEditor._defaultLineColor;\n    this.#fontSize = params.fontSize || FreeTextEditor._defaultFontSize;\n  }\n  static initialize(l10n, uiManager) {\n    AnnotationEditor.initialize(l10n, uiManager, {\n      strings: [\"pdfjs-free-text-default-content\"]\n    });\n    const style = getComputedStyle(document.documentElement);\n    this._internalPadding = parseFloat(style.getPropertyValue(\"--freetext-padding\"));\n  }\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.FREETEXT_SIZE:\n        FreeTextEditor._defaultFontSize = value;\n        break;\n      case AnnotationEditorParamsType.FREETEXT_COLOR:\n        FreeTextEditor._defaultColor = value;\n        break;\n    }\n  }\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.FREETEXT_SIZE:\n        this.#updateFontSize(value);\n        break;\n      case AnnotationEditorParamsType.FREETEXT_COLOR:\n        this.#updateColor(value);\n        break;\n    }\n  }\n  static get defaultPropertiesToUpdate() {\n    return [[AnnotationEditorParamsType.FREETEXT_SIZE, FreeTextEditor._defaultFontSize], [AnnotationEditorParamsType.FREETEXT_COLOR, FreeTextEditor._defaultColor || AnnotationEditor._defaultLineColor]];\n  }\n  get propertiesToUpdate() {\n    return [[AnnotationEditorParamsType.FREETEXT_SIZE, this.#fontSize], [AnnotationEditorParamsType.FREETEXT_COLOR, this.#color]];\n  }\n  #updateFontSize(fontSize) {\n    const setFontsize = size => {\n      this.editorDiv.style.fontSize = `calc(${size}px * var(--scale-factor))`;\n      this.translate(0, -(size - this.#fontSize) * this.parentScale);\n      this.#fontSize = size;\n      this.#setEditorDimensions();\n    };\n    const savedFontsize = this.#fontSize;\n    this.addCommands({\n      cmd: setFontsize.bind(this, fontSize),\n      undo: setFontsize.bind(this, savedFontsize),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.FREETEXT_SIZE,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n  #updateColor(color) {\n    const setColor = col => {\n      this.#color = this.editorDiv.style.color = col;\n    };\n    const savedColor = this.#color;\n    this.addCommands({\n      cmd: setColor.bind(this, color),\n      undo: setColor.bind(this, savedColor),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.FREETEXT_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n  _translateEmpty(x, y) {\n    this._uiManager.translateSelectedEditors(x, y, true);\n  }\n  getInitialTranslation() {\n    const scale = this.parentScale;\n    return [-FreeTextEditor._internalPadding * scale, -(FreeTextEditor._internalPadding + this.#fontSize) * scale];\n  }\n  rebuild() {\n    if (!this.parent) {\n      return;\n    }\n    super.rebuild();\n    if (this.div === null) {\n      return;\n    }\n    if (!this.isAttachedToDOM) {\n      this.parent.add(this);\n    }\n  }\n  enableEditMode() {\n    if (this.isInEditMode()) {\n      return;\n    }\n    this.parent.setEditingState(false);\n    this.parent.updateToolbar(AnnotationEditorType.FREETEXT);\n    super.enableEditMode();\n    this.overlayDiv.classList.remove(\"enabled\");\n    this.editorDiv.contentEditable = true;\n    this._isDraggable = false;\n    this.div.removeAttribute(\"aria-activedescendant\");\n    this.#editModeAC = new AbortController();\n    const signal = this._uiManager.combinedSignal(this.#editModeAC);\n    this.editorDiv.addEventListener(\"keydown\", this.editorDivKeydown.bind(this), {\n      signal\n    });\n    this.editorDiv.addEventListener(\"focus\", this.editorDivFocus.bind(this), {\n      signal\n    });\n    this.editorDiv.addEventListener(\"blur\", this.editorDivBlur.bind(this), {\n      signal\n    });\n    this.editorDiv.addEventListener(\"input\", this.editorDivInput.bind(this), {\n      signal\n    });\n    this.editorDiv.addEventListener(\"paste\", this.editorDivPaste.bind(this), {\n      signal\n    });\n  }\n  disableEditMode() {\n    if (!this.isInEditMode()) {\n      return;\n    }\n    this.parent.setEditingState(true);\n    super.disableEditMode();\n    this.overlayDiv.classList.add(\"enabled\");\n    this.editorDiv.contentEditable = false;\n    this.div.setAttribute(\"aria-activedescendant\", this.#editorDivId);\n    this._isDraggable = true;\n    this.#editModeAC?.abort();\n    this.#editModeAC = null;\n    this.div.focus({\n      preventScroll: true\n    });\n    this.isEditing = false;\n    this.parent.div.classList.add(\"freetextEditing\");\n  }\n  focusin(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n    super.focusin(event);\n    if (event.target !== this.editorDiv) {\n      this.editorDiv.focus();\n    }\n  }\n  onceAdded() {\n    if (this.width) {\n      return;\n    }\n    this.enableEditMode();\n    this.editorDiv.focus();\n    if (this._initialOptions?.isCentered) {\n      this.center();\n    }\n    this._initialOptions = null;\n  }\n  isEmpty() {\n    return !this.editorDiv || this.editorDiv.innerText.trim() === \"\";\n  }\n  remove() {\n    this.isEditing = false;\n    if (this.parent) {\n      this.parent.setEditingState(true);\n      this.parent.div.classList.add(\"freetextEditing\");\n    }\n    super.remove();\n  }\n  #extractText() {\n    const buffer = [];\n    this.editorDiv.normalize();\n    for (const child of this.editorDiv.childNodes) {\n      buffer.push(FreeTextEditor.#getNodeContent(child));\n    }\n    return buffer.join(\"\\n\");\n  }\n  #setEditorDimensions() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    let rect;\n    if (this.isAttachedToDOM) {\n      rect = this.div.getBoundingClientRect();\n    } else {\n      const {\n        currentLayer,\n        div\n      } = this;\n      const savedDisplay = div.style.display;\n      const savedVisibility = div.classList.contains(\"hidden\");\n      div.classList.remove(\"hidden\");\n      div.style.display = \"hidden\";\n      currentLayer.div.append(this.div);\n      rect = div.getBoundingClientRect();\n      div.remove();\n      div.style.display = savedDisplay;\n      div.classList.toggle(\"hidden\", savedVisibility);\n    }\n    if (this.rotation % 180 === this.parentRotation % 180) {\n      this.width = rect.width / parentWidth;\n      this.height = rect.height / parentHeight;\n    } else {\n      this.width = rect.height / parentWidth;\n      this.height = rect.width / parentHeight;\n    }\n    this.fixAndSetPosition();\n  }\n  commit() {\n    if (!this.isInEditMode()) {\n      return;\n    }\n    super.commit();\n    this.disableEditMode();\n    const savedText = this.#content;\n    const newText = this.#content = this.#extractText().trimEnd();\n    if (savedText === newText) {\n      return;\n    }\n    const setText = text => {\n      this.#content = text;\n      if (!text) {\n        this.remove();\n        return;\n      }\n      this.#setContent();\n      this._uiManager.rebuild(this);\n      this.#setEditorDimensions();\n    };\n    this.addCommands({\n      cmd: () => {\n        setText(newText);\n      },\n      undo: () => {\n        setText(savedText);\n      },\n      mustExec: false\n    });\n    this.#setEditorDimensions();\n  }\n  shouldGetKeyboardEvents() {\n    return this.isInEditMode();\n  }\n  enterInEditMode() {\n    this.enableEditMode();\n    this.editorDiv.focus();\n  }\n  dblclick(event) {\n    this.enterInEditMode();\n  }\n  keydown(event) {\n    if (event.target === this.div && event.key === \"Enter\") {\n      this.enterInEditMode();\n      event.preventDefault();\n    }\n  }\n  editorDivKeydown(event) {\n    FreeTextEditor._keyboardManager.exec(this, event);\n  }\n  editorDivFocus(event) {\n    this.isEditing = true;\n  }\n  editorDivBlur(event) {\n    this.isEditing = false;\n  }\n  editorDivInput(event) {\n    this.parent.div.classList.toggle(\"freetextEditing\", this.isEmpty());\n  }\n  disableEditing() {\n    this.editorDiv.setAttribute(\"role\", \"comment\");\n    this.editorDiv.removeAttribute(\"aria-multiline\");\n  }\n  enableEditing() {\n    this.editorDiv.setAttribute(\"role\", \"textbox\");\n    this.editorDiv.setAttribute(\"aria-multiline\", true);\n  }\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n    let baseX, baseY;\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n    super.render();\n    this.editorDiv = document.createElement(\"div\");\n    this.editorDiv.className = \"internal\";\n    this.editorDiv.setAttribute(\"id\", this.#editorDivId);\n    this.editorDiv.setAttribute(\"data-l10n-id\", \"pdfjs-free-text\");\n    this.enableEditing();\n    AnnotationEditor._l10nPromise.get(\"pdfjs-free-text-default-content\").then(msg => this.editorDiv?.setAttribute(\"default-content\", msg));\n    this.editorDiv.contentEditable = true;\n    const {\n      style\n    } = this.editorDiv;\n    style.fontSize = `calc(${this.#fontSize}px * var(--scale-factor))`;\n    style.color = this.#color;\n    this.div.append(this.editorDiv);\n    this.overlayDiv = document.createElement(\"div\");\n    this.overlayDiv.classList.add(\"overlay\", \"enabled\");\n    this.div.append(this.overlayDiv);\n    bindEvents(this, this.div, [\"dblclick\", \"keydown\"]);\n    if (this.width) {\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      if (this.annotationElementId) {\n        const {\n          position\n        } = this.#initialData;\n        let [tx, ty] = this.getInitialTranslation();\n        [tx, ty] = this.pageTranslationToScreen(tx, ty);\n        const [pageWidth, pageHeight] = this.pageDimensions;\n        const [pageX, pageY] = this.pageTranslation;\n        let posX, posY;\n        switch (this.rotation) {\n          case 0:\n            posX = baseX + (position[0] - pageX) / pageWidth;\n            posY = baseY + this.height - (position[1] - pageY) / pageHeight;\n            break;\n          case 90:\n            posX = baseX + (position[0] - pageX) / pageWidth;\n            posY = baseY - (position[1] - pageY) / pageHeight;\n            [tx, ty] = [ty, -tx];\n            break;\n          case 180:\n            posX = baseX - this.width + (position[0] - pageX) / pageWidth;\n            posY = baseY - (position[1] - pageY) / pageHeight;\n            [tx, ty] = [-tx, -ty];\n            break;\n          case 270:\n            posX = baseX + (position[0] - pageX - this.height * pageHeight) / pageWidth;\n            posY = baseY + (position[1] - pageY - this.width * pageWidth) / pageHeight;\n            [tx, ty] = [-ty, tx];\n            break;\n        }\n        this.setAt(posX * parentWidth, posY * parentHeight, tx, ty);\n      } else {\n        this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n      }\n      this.#setContent();\n      this._isDraggable = true;\n      this.editorDiv.contentEditable = false;\n    } else {\n      this._isDraggable = false;\n      this.editorDiv.contentEditable = true;\n    }\n    return this.div;\n  }\n  static #getNodeContent(node) {\n    return (node.nodeType === Node.TEXT_NODE ? node.nodeValue : node.innerText).replaceAll(EOL_PATTERN, \"\");\n  }\n  editorDivPaste(event) {\n    const clipboardData = event.clipboardData || window.clipboardData;\n    const {\n      types\n    } = clipboardData;\n    if (types.length === 1 && types[0] === \"text/plain\") {\n      return;\n    }\n    event.preventDefault();\n    const paste = FreeTextEditor.#deserializeContent(clipboardData.getData(\"text\") || \"\").replaceAll(EOL_PATTERN, \"\\n\");\n    if (!paste) {\n      return;\n    }\n    const selection = window.getSelection();\n    if (!selection.rangeCount) {\n      return;\n    }\n    this.editorDiv.normalize();\n    selection.deleteFromDocument();\n    const range = selection.getRangeAt(0);\n    if (!paste.includes(\"\\n\")) {\n      range.insertNode(document.createTextNode(paste));\n      this.editorDiv.normalize();\n      selection.collapseToStart();\n      return;\n    }\n    const {\n      startContainer,\n      startOffset\n    } = range;\n    const bufferBefore = [];\n    const bufferAfter = [];\n    if (startContainer.nodeType === Node.TEXT_NODE) {\n      const parent = startContainer.parentElement;\n      bufferAfter.push(startContainer.nodeValue.slice(startOffset).replaceAll(EOL_PATTERN, \"\"));\n      if (parent !== this.editorDiv) {\n        let buffer = bufferBefore;\n        for (const child of this.editorDiv.childNodes) {\n          if (child === parent) {\n            buffer = bufferAfter;\n            continue;\n          }\n          buffer.push(FreeTextEditor.#getNodeContent(child));\n        }\n      }\n      bufferBefore.push(startContainer.nodeValue.slice(0, startOffset).replaceAll(EOL_PATTERN, \"\"));\n    } else if (startContainer === this.editorDiv) {\n      let buffer = bufferBefore;\n      let i = 0;\n      for (const child of this.editorDiv.childNodes) {\n        if (i++ === startOffset) {\n          buffer = bufferAfter;\n        }\n        buffer.push(FreeTextEditor.#getNodeContent(child));\n      }\n    }\n    this.#content = `${bufferBefore.join(\"\\n\")}${paste}${bufferAfter.join(\"\\n\")}`;\n    this.#setContent();\n    const newRange = new Range();\n    let beforeLength = bufferBefore.reduce((acc, line) => acc + line.length, 0);\n    for (const {\n      firstChild\n    } of this.editorDiv.childNodes) {\n      if (firstChild.nodeType === Node.TEXT_NODE) {\n        const length = firstChild.nodeValue.length;\n        if (beforeLength <= length) {\n          newRange.setStart(firstChild, beforeLength);\n          newRange.setEnd(firstChild, beforeLength);\n          break;\n        }\n        beforeLength -= length;\n      }\n    }\n    selection.removeAllRanges();\n    selection.addRange(newRange);\n  }\n  #setContent() {\n    this.editorDiv.replaceChildren();\n    if (!this.#content) {\n      return;\n    }\n    for (const line of this.#content.split(\"\\n\")) {\n      const div = document.createElement(\"div\");\n      div.append(line ? document.createTextNode(line) : document.createElement(\"br\"));\n      this.editorDiv.append(div);\n    }\n  }\n  #serializeContent() {\n    return this.#content.replaceAll(\"\\xa0\", \" \");\n  }\n  static #deserializeContent(content) {\n    return content.replaceAll(\" \", \"\\xa0\");\n  }\n  get contentDiv() {\n    return this.editorDiv;\n  }\n  static deserialize(data, parent, uiManager) {\n    let initialData = null;\n    if (data instanceof FreeTextAnnotationElement) {\n      const {\n        data: {\n          defaultAppearanceData: {\n            fontSize,\n            fontColor\n          },\n          rect,\n          rotation,\n          id\n        },\n        textContent,\n        textPosition,\n        parent: {\n          page: {\n            pageNumber\n          }\n        }\n      } = data;\n      if (!textContent || textContent.length === 0) {\n        return null;\n      }\n      initialData = data = {\n        annotationType: AnnotationEditorType.FREETEXT,\n        color: Array.from(fontColor),\n        fontSize,\n        value: textContent.join(\"\\n\"),\n        position: textPosition,\n        pageIndex: pageNumber - 1,\n        rect: rect.slice(0),\n        rotation,\n        id,\n        deleted: false\n      };\n    }\n    const editor = super.deserialize(data, parent, uiManager);\n    editor.#fontSize = data.fontSize;\n    editor.#color = Util.makeHexColor(...data.color);\n    editor.#content = FreeTextEditor.#deserializeContent(data.value);\n    editor.annotationElementId = data.id || null;\n    editor.#initialData = initialData;\n    return editor;\n  }\n  serialize(isForCopying = false) {\n    if (this.isEmpty()) {\n      return null;\n    }\n    if (this.deleted) {\n      return {\n        pageIndex: this.pageIndex,\n        id: this.annotationElementId,\n        deleted: true\n      };\n    }\n    const padding = FreeTextEditor._internalPadding * this.parentScale;\n    const rect = this.getRect(padding, padding);\n    const color = AnnotationEditor._colorManager.convert(this.isAttachedToDOM ? getComputedStyle(this.editorDiv).color : this.#color);\n    const serialized = {\n      annotationType: AnnotationEditorType.FREETEXT,\n      color,\n      fontSize: this.#fontSize,\n      value: this.#serializeContent(),\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.rotation,\n      structTreeParentId: this._structTreeParentId\n    };\n    if (isForCopying) {\n      return serialized;\n    }\n    if (this.annotationElementId && !this.#hasElementChanged(serialized)) {\n      return null;\n    }\n    serialized.id = this.annotationElementId;\n    return serialized;\n  }\n  #hasElementChanged(serialized) {\n    const {\n      value,\n      fontSize,\n      color,\n      pageIndex\n    } = this.#initialData;\n    return this._hasBeenMoved || serialized.value !== value || serialized.fontSize !== fontSize || serialized.color.some((c, i) => c !== color[i]) || serialized.pageIndex !== pageIndex;\n  }\n  renderAnnotationElement(annotation) {\n    const content = super.renderAnnotationElement(annotation);\n    if (this.deleted) {\n      return content;\n    }\n    const {\n      style\n    } = content;\n    style.fontSize = `calc(${this.#fontSize}px * var(--scale-factor))`;\n    style.color = this.#color;\n    content.replaceChildren();\n    for (const line of this.#content.split(\"\\n\")) {\n      const div = document.createElement(\"div\");\n      div.append(line ? document.createTextNode(line) : document.createElement(\"br\"));\n      content.append(div);\n    }\n    const padding = FreeTextEditor._internalPadding * this.parentScale;\n    annotation.updateEdited({\n      rect: this.getRect(padding, padding),\n      popupContent: this.#content\n    });\n    return content;\n  }\n  resetAnnotationElement(annotation) {\n    super.resetAnnotationElement(annotation);\n    annotation.resetEdited();\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/outliner.js\n\nclass Outliner {\n  #box;\n  #verticalEdges = [];\n  #intervals = [];\n  constructor(boxes, borderWidth = 0, innerMargin = 0, isLTR = true) {\n    let minX = Infinity;\n    let maxX = -Infinity;\n    let minY = Infinity;\n    let maxY = -Infinity;\n    const NUMBER_OF_DIGITS = 4;\n    const EPSILON = 10 ** -NUMBER_OF_DIGITS;\n    for (const {\n      x,\n      y,\n      width,\n      height\n    } of boxes) {\n      const x1 = Math.floor((x - borderWidth) / EPSILON) * EPSILON;\n      const x2 = Math.ceil((x + width + borderWidth) / EPSILON) * EPSILON;\n      const y1 = Math.floor((y - borderWidth) / EPSILON) * EPSILON;\n      const y2 = Math.ceil((y + height + borderWidth) / EPSILON) * EPSILON;\n      const left = [x1, y1, y2, true];\n      const right = [x2, y1, y2, false];\n      this.#verticalEdges.push(left, right);\n      minX = Math.min(minX, x1);\n      maxX = Math.max(maxX, x2);\n      minY = Math.min(minY, y1);\n      maxY = Math.max(maxY, y2);\n    }\n    const bboxWidth = maxX - minX + 2 * innerMargin;\n    const bboxHeight = maxY - minY + 2 * innerMargin;\n    const shiftedMinX = minX - innerMargin;\n    const shiftedMinY = minY - innerMargin;\n    const lastEdge = this.#verticalEdges.at(isLTR ? -1 : -2);\n    const lastPoint = [lastEdge[0], lastEdge[2]];\n    for (const edge of this.#verticalEdges) {\n      const [x, y1, y2] = edge;\n      edge[0] = (x - shiftedMinX) / bboxWidth;\n      edge[1] = (y1 - shiftedMinY) / bboxHeight;\n      edge[2] = (y2 - shiftedMinY) / bboxHeight;\n    }\n    this.#box = {\n      x: shiftedMinX,\n      y: shiftedMinY,\n      width: bboxWidth,\n      height: bboxHeight,\n      lastPoint\n    };\n  }\n  getOutlines() {\n    this.#verticalEdges.sort((a, b) => a[0] - b[0] || a[1] - b[1] || a[2] - b[2]);\n    const outlineVerticalEdges = [];\n    for (const edge of this.#verticalEdges) {\n      if (edge[3]) {\n        outlineVerticalEdges.push(...this.#breakEdge(edge));\n        this.#insert(edge);\n      } else {\n        this.#remove(edge);\n        outlineVerticalEdges.push(...this.#breakEdge(edge));\n      }\n    }\n    return this.#getOutlines(outlineVerticalEdges);\n  }\n  #getOutlines(outlineVerticalEdges) {\n    const edges = [];\n    const allEdges = new Set();\n    for (const edge of outlineVerticalEdges) {\n      const [x, y1, y2] = edge;\n      edges.push([x, y1, edge], [x, y2, edge]);\n    }\n    edges.sort((a, b) => a[1] - b[1] || a[0] - b[0]);\n    for (let i = 0, ii = edges.length; i < ii; i += 2) {\n      const edge1 = edges[i][2];\n      const edge2 = edges[i + 1][2];\n      edge1.push(edge2);\n      edge2.push(edge1);\n      allEdges.add(edge1);\n      allEdges.add(edge2);\n    }\n    const outlines = [];\n    let outline;\n    while (allEdges.size > 0) {\n      const edge = allEdges.values().next().value;\n      let [x, y1, y2, edge1, edge2] = edge;\n      allEdges.delete(edge);\n      let lastPointX = x;\n      let lastPointY = y1;\n      outline = [x, y2];\n      outlines.push(outline);\n      while (true) {\n        let e;\n        if (allEdges.has(edge1)) {\n          e = edge1;\n        } else if (allEdges.has(edge2)) {\n          e = edge2;\n        } else {\n          break;\n        }\n        allEdges.delete(e);\n        [x, y1, y2, edge1, edge2] = e;\n        if (lastPointX !== x) {\n          outline.push(lastPointX, lastPointY, x, lastPointY === y1 ? y1 : y2);\n          lastPointX = x;\n        }\n        lastPointY = lastPointY === y1 ? y2 : y1;\n      }\n      outline.push(lastPointX, lastPointY);\n    }\n    return new HighlightOutline(outlines, this.#box);\n  }\n  #binarySearch(y) {\n    const array = this.#intervals;\n    let start = 0;\n    let end = array.length - 1;\n    while (start <= end) {\n      const middle = start + end >> 1;\n      const y1 = array[middle][0];\n      if (y1 === y) {\n        return middle;\n      }\n      if (y1 < y) {\n        start = middle + 1;\n      } else {\n        end = middle - 1;\n      }\n    }\n    return end + 1;\n  }\n  #insert([, y1, y2]) {\n    const index = this.#binarySearch(y1);\n    this.#intervals.splice(index, 0, [y1, y2]);\n  }\n  #remove([, y1, y2]) {\n    const index = this.#binarySearch(y1);\n    for (let i = index; i < this.#intervals.length; i++) {\n      const [start, end] = this.#intervals[i];\n      if (start !== y1) {\n        break;\n      }\n      if (start === y1 && end === y2) {\n        this.#intervals.splice(i, 1);\n        return;\n      }\n    }\n    for (let i = index - 1; i >= 0; i--) {\n      const [start, end] = this.#intervals[i];\n      if (start !== y1) {\n        break;\n      }\n      if (start === y1 && end === y2) {\n        this.#intervals.splice(i, 1);\n        return;\n      }\n    }\n  }\n  #breakEdge(edge) {\n    const [x, y1, y2] = edge;\n    const results = [[x, y1, y2]];\n    const index = this.#binarySearch(y2);\n    for (let i = 0; i < index; i++) {\n      const [start, end] = this.#intervals[i];\n      for (let j = 0, jj = results.length; j < jj; j++) {\n        const [, y3, y4] = results[j];\n        if (end <= y3 || y4 <= start) {\n          continue;\n        }\n        if (y3 >= start) {\n          if (y4 > end) {\n            results[j][1] = end;\n          } else {\n            if (jj === 1) {\n              return [];\n            }\n            results.splice(j, 1);\n            j--;\n            jj--;\n          }\n          continue;\n        }\n        results[j][2] = start;\n        if (y4 > end) {\n          results.push([x, end, y4]);\n        }\n      }\n    }\n    return results;\n  }\n}\nclass Outline {\n  toSVGPath() {\n    throw new Error(\"Abstract method `toSVGPath` must be implemented.\");\n  }\n  get box() {\n    throw new Error(\"Abstract getter `box` must be implemented.\");\n  }\n  serialize(_bbox, _rotation) {\n    throw new Error(\"Abstract method `serialize` must be implemented.\");\n  }\n  get free() {\n    return this instanceof FreeHighlightOutline;\n  }\n}\nclass HighlightOutline extends Outline {\n  #box;\n  #outlines;\n  constructor(outlines, box) {\n    super();\n    this.#outlines = outlines;\n    this.#box = box;\n  }\n  toSVGPath() {\n    const buffer = [];\n    for (const polygon of this.#outlines) {\n      let [prevX, prevY] = polygon;\n      buffer.push(`M${prevX} ${prevY}`);\n      for (let i = 2; i < polygon.length; i += 2) {\n        const x = polygon[i];\n        const y = polygon[i + 1];\n        if (x === prevX) {\n          buffer.push(`V${y}`);\n          prevY = y;\n        } else if (y === prevY) {\n          buffer.push(`H${x}`);\n          prevX = x;\n        }\n      }\n      buffer.push(\"Z\");\n    }\n    return buffer.join(\" \");\n  }\n  serialize([blX, blY, trX, trY], _rotation) {\n    const outlines = [];\n    const width = trX - blX;\n    const height = trY - blY;\n    for (const outline of this.#outlines) {\n      const points = new Array(outline.length);\n      for (let i = 0; i < outline.length; i += 2) {\n        points[i] = blX + outline[i] * width;\n        points[i + 1] = trY - outline[i + 1] * height;\n      }\n      outlines.push(points);\n    }\n    return outlines;\n  }\n  get box() {\n    return this.#box;\n  }\n}\nclass FreeOutliner {\n  #box;\n  #bottom = [];\n  #innerMargin;\n  #isLTR;\n  #top = [];\n  #last = new Float64Array(18);\n  #lastX;\n  #lastY;\n  #min;\n  #min_dist;\n  #scaleFactor;\n  #thickness;\n  #points = [];\n  static #MIN_DIST = 8;\n  static #MIN_DIFF = 2;\n  static #MIN = FreeOutliner.#MIN_DIST + FreeOutliner.#MIN_DIFF;\n  constructor({\n    x,\n    y\n  }, box, scaleFactor, thickness, isLTR, innerMargin = 0) {\n    this.#box = box;\n    this.#thickness = thickness * scaleFactor;\n    this.#isLTR = isLTR;\n    this.#last.set([NaN, NaN, NaN, NaN, x, y], 6);\n    this.#innerMargin = innerMargin;\n    this.#min_dist = FreeOutliner.#MIN_DIST * scaleFactor;\n    this.#min = FreeOutliner.#MIN * scaleFactor;\n    this.#scaleFactor = scaleFactor;\n    this.#points.push(x, y);\n  }\n  get free() {\n    return true;\n  }\n  isEmpty() {\n    return isNaN(this.#last[8]);\n  }\n  #getLastCoords() {\n    const lastTop = this.#last.subarray(4, 6);\n    const lastBottom = this.#last.subarray(16, 18);\n    const [x, y, width, height] = this.#box;\n    return [(this.#lastX + (lastTop[0] - lastBottom[0]) / 2 - x) / width, (this.#lastY + (lastTop[1] - lastBottom[1]) / 2 - y) / height, (this.#lastX + (lastBottom[0] - lastTop[0]) / 2 - x) / width, (this.#lastY + (lastBottom[1] - lastTop[1]) / 2 - y) / height];\n  }\n  add({\n    x,\n    y\n  }) {\n    this.#lastX = x;\n    this.#lastY = y;\n    const [layerX, layerY, layerWidth, layerHeight] = this.#box;\n    let [x1, y1, x2, y2] = this.#last.subarray(8, 12);\n    const diffX = x - x2;\n    const diffY = y - y2;\n    const d = Math.hypot(diffX, diffY);\n    if (d < this.#min) {\n      return false;\n    }\n    const diffD = d - this.#min_dist;\n    const K = diffD / d;\n    const shiftX = K * diffX;\n    const shiftY = K * diffY;\n    let x0 = x1;\n    let y0 = y1;\n    x1 = x2;\n    y1 = y2;\n    x2 += shiftX;\n    y2 += shiftY;\n    this.#points?.push(x, y);\n    const nX = -shiftY / diffD;\n    const nY = shiftX / diffD;\n    const thX = nX * this.#thickness;\n    const thY = nY * this.#thickness;\n    this.#last.set(this.#last.subarray(2, 8), 0);\n    this.#last.set([x2 + thX, y2 + thY], 4);\n    this.#last.set(this.#last.subarray(14, 18), 12);\n    this.#last.set([x2 - thX, y2 - thY], 16);\n    if (isNaN(this.#last[6])) {\n      if (this.#top.length === 0) {\n        this.#last.set([x1 + thX, y1 + thY], 2);\n        this.#top.push(NaN, NaN, NaN, NaN, (x1 + thX - layerX) / layerWidth, (y1 + thY - layerY) / layerHeight);\n        this.#last.set([x1 - thX, y1 - thY], 14);\n        this.#bottom.push(NaN, NaN, NaN, NaN, (x1 - thX - layerX) / layerWidth, (y1 - thY - layerY) / layerHeight);\n      }\n      this.#last.set([x0, y0, x1, y1, x2, y2], 6);\n      return !this.isEmpty();\n    }\n    this.#last.set([x0, y0, x1, y1, x2, y2], 6);\n    const angle = Math.abs(Math.atan2(y0 - y1, x0 - x1) - Math.atan2(shiftY, shiftX));\n    if (angle < Math.PI / 2) {\n      [x1, y1, x2, y2] = this.#last.subarray(2, 6);\n      this.#top.push(NaN, NaN, NaN, NaN, ((x1 + x2) / 2 - layerX) / layerWidth, ((y1 + y2) / 2 - layerY) / layerHeight);\n      [x1, y1, x0, y0] = this.#last.subarray(14, 18);\n      this.#bottom.push(NaN, NaN, NaN, NaN, ((x0 + x1) / 2 - layerX) / layerWidth, ((y0 + y1) / 2 - layerY) / layerHeight);\n      return true;\n    }\n    [x0, y0, x1, y1, x2, y2] = this.#last.subarray(0, 6);\n    this.#top.push(((x0 + 5 * x1) / 6 - layerX) / layerWidth, ((y0 + 5 * y1) / 6 - layerY) / layerHeight, ((5 * x1 + x2) / 6 - layerX) / layerWidth, ((5 * y1 + y2) / 6 - layerY) / layerHeight, ((x1 + x2) / 2 - layerX) / layerWidth, ((y1 + y2) / 2 - layerY) / layerHeight);\n    [x2, y2, x1, y1, x0, y0] = this.#last.subarray(12, 18);\n    this.#bottom.push(((x0 + 5 * x1) / 6 - layerX) / layerWidth, ((y0 + 5 * y1) / 6 - layerY) / layerHeight, ((5 * x1 + x2) / 6 - layerX) / layerWidth, ((5 * y1 + y2) / 6 - layerY) / layerHeight, ((x1 + x2) / 2 - layerX) / layerWidth, ((y1 + y2) / 2 - layerY) / layerHeight);\n    return true;\n  }\n  toSVGPath() {\n    if (this.isEmpty()) {\n      return \"\";\n    }\n    const top = this.#top;\n    const bottom = this.#bottom;\n    const lastTop = this.#last.subarray(4, 6);\n    const lastBottom = this.#last.subarray(16, 18);\n    const [x, y, width, height] = this.#box;\n    const [lastTopX, lastTopY, lastBottomX, lastBottomY] = this.#getLastCoords();\n    if (isNaN(this.#last[6]) && !this.isEmpty()) {\n      return `M${(this.#last[2] - x) / width} ${(this.#last[3] - y) / height} L${(this.#last[4] - x) / width} ${(this.#last[5] - y) / height} L${lastTopX} ${lastTopY} L${lastBottomX} ${lastBottomY} L${(this.#last[16] - x) / width} ${(this.#last[17] - y) / height} L${(this.#last[14] - x) / width} ${(this.#last[15] - y) / height} Z`;\n    }\n    const buffer = [];\n    buffer.push(`M${top[4]} ${top[5]}`);\n    for (let i = 6; i < top.length; i += 6) {\n      if (isNaN(top[i])) {\n        buffer.push(`L${top[i + 4]} ${top[i + 5]}`);\n      } else {\n        buffer.push(`C${top[i]} ${top[i + 1]} ${top[i + 2]} ${top[i + 3]} ${top[i + 4]} ${top[i + 5]}`);\n      }\n    }\n    buffer.push(`L${(lastTop[0] - x) / width} ${(lastTop[1] - y) / height} L${lastTopX} ${lastTopY} L${lastBottomX} ${lastBottomY} L${(lastBottom[0] - x) / width} ${(lastBottom[1] - y) / height}`);\n    for (let i = bottom.length - 6; i >= 6; i -= 6) {\n      if (isNaN(bottom[i])) {\n        buffer.push(`L${bottom[i + 4]} ${bottom[i + 5]}`);\n      } else {\n        buffer.push(`C${bottom[i]} ${bottom[i + 1]} ${bottom[i + 2]} ${bottom[i + 3]} ${bottom[i + 4]} ${bottom[i + 5]}`);\n      }\n    }\n    buffer.push(`L${bottom[4]} ${bottom[5]} Z`);\n    return buffer.join(\" \");\n  }\n  getOutlines() {\n    const top = this.#top;\n    const bottom = this.#bottom;\n    const last = this.#last;\n    const lastTop = last.subarray(4, 6);\n    const lastBottom = last.subarray(16, 18);\n    const [layerX, layerY, layerWidth, layerHeight] = this.#box;\n    const points = new Float64Array((this.#points?.length ?? 0) + 2);\n    for (let i = 0, ii = points.length - 2; i < ii; i += 2) {\n      points[i] = (this.#points[i] - layerX) / layerWidth;\n      points[i + 1] = (this.#points[i + 1] - layerY) / layerHeight;\n    }\n    points[points.length - 2] = (this.#lastX - layerX) / layerWidth;\n    points[points.length - 1] = (this.#lastY - layerY) / layerHeight;\n    const [lastTopX, lastTopY, lastBottomX, lastBottomY] = this.#getLastCoords();\n    if (isNaN(last[6]) && !this.isEmpty()) {\n      const outline = new Float64Array(36);\n      outline.set([NaN, NaN, NaN, NaN, (last[2] - layerX) / layerWidth, (last[3] - layerY) / layerHeight, NaN, NaN, NaN, NaN, (last[4] - layerX) / layerWidth, (last[5] - layerY) / layerHeight, NaN, NaN, NaN, NaN, lastTopX, lastTopY, NaN, NaN, NaN, NaN, lastBottomX, lastBottomY, NaN, NaN, NaN, NaN, (last[16] - layerX) / layerWidth, (last[17] - layerY) / layerHeight, NaN, NaN, NaN, NaN, (last[14] - layerX) / layerWidth, (last[15] - layerY) / layerHeight], 0);\n      return new FreeHighlightOutline(outline, points, this.#box, this.#scaleFactor, this.#innerMargin, this.#isLTR);\n    }\n    const outline = new Float64Array(this.#top.length + 24 + this.#bottom.length);\n    let N = top.length;\n    for (let i = 0; i < N; i += 2) {\n      if (isNaN(top[i])) {\n        outline[i] = outline[i + 1] = NaN;\n        continue;\n      }\n      outline[i] = top[i];\n      outline[i + 1] = top[i + 1];\n    }\n    outline.set([NaN, NaN, NaN, NaN, (lastTop[0] - layerX) / layerWidth, (lastTop[1] - layerY) / layerHeight, NaN, NaN, NaN, NaN, lastTopX, lastTopY, NaN, NaN, NaN, NaN, lastBottomX, lastBottomY, NaN, NaN, NaN, NaN, (lastBottom[0] - layerX) / layerWidth, (lastBottom[1] - layerY) / layerHeight], N);\n    N += 24;\n    for (let i = bottom.length - 6; i >= 6; i -= 6) {\n      for (let j = 0; j < 6; j += 2) {\n        if (isNaN(bottom[i + j])) {\n          outline[N] = outline[N + 1] = NaN;\n          N += 2;\n          continue;\n        }\n        outline[N] = bottom[i + j];\n        outline[N + 1] = bottom[i + j + 1];\n        N += 2;\n      }\n    }\n    outline.set([NaN, NaN, NaN, NaN, bottom[4], bottom[5]], N);\n    return new FreeHighlightOutline(outline, points, this.#box, this.#scaleFactor, this.#innerMargin, this.#isLTR);\n  }\n}\nclass FreeHighlightOutline extends Outline {\n  #box;\n  #bbox = null;\n  #innerMargin;\n  #isLTR;\n  #points;\n  #scaleFactor;\n  #outline;\n  constructor(outline, points, box, scaleFactor, innerMargin, isLTR) {\n    super();\n    this.#outline = outline;\n    this.#points = points;\n    this.#box = box;\n    this.#scaleFactor = scaleFactor;\n    this.#innerMargin = innerMargin;\n    this.#isLTR = isLTR;\n    this.#computeMinMax(isLTR);\n    const {\n      x,\n      y,\n      width,\n      height\n    } = this.#bbox;\n    for (let i = 0, ii = outline.length; i < ii; i += 2) {\n      outline[i] = (outline[i] - x) / width;\n      outline[i + 1] = (outline[i + 1] - y) / height;\n    }\n    for (let i = 0, ii = points.length; i < ii; i += 2) {\n      points[i] = (points[i] - x) / width;\n      points[i + 1] = (points[i + 1] - y) / height;\n    }\n  }\n  toSVGPath() {\n    const buffer = [`M${this.#outline[4]} ${this.#outline[5]}`];\n    for (let i = 6, ii = this.#outline.length; i < ii; i += 6) {\n      if (isNaN(this.#outline[i])) {\n        buffer.push(`L${this.#outline[i + 4]} ${this.#outline[i + 5]}`);\n        continue;\n      }\n      buffer.push(`C${this.#outline[i]} ${this.#outline[i + 1]} ${this.#outline[i + 2]} ${this.#outline[i + 3]} ${this.#outline[i + 4]} ${this.#outline[i + 5]}`);\n    }\n    buffer.push(\"Z\");\n    return buffer.join(\" \");\n  }\n  serialize([blX, blY, trX, trY], rotation) {\n    const width = trX - blX;\n    const height = trY - blY;\n    let outline;\n    let points;\n    switch (rotation) {\n      case 0:\n        outline = this.#rescale(this.#outline, blX, trY, width, -height);\n        points = this.#rescale(this.#points, blX, trY, width, -height);\n        break;\n      case 90:\n        outline = this.#rescaleAndSwap(this.#outline, blX, blY, width, height);\n        points = this.#rescaleAndSwap(this.#points, blX, blY, width, height);\n        break;\n      case 180:\n        outline = this.#rescale(this.#outline, trX, blY, -width, height);\n        points = this.#rescale(this.#points, trX, blY, -width, height);\n        break;\n      case 270:\n        outline = this.#rescaleAndSwap(this.#outline, trX, trY, -width, -height);\n        points = this.#rescaleAndSwap(this.#points, trX, trY, -width, -height);\n        break;\n    }\n    return {\n      outline: Array.from(outline),\n      points: [Array.from(points)]\n    };\n  }\n  #rescale(src, tx, ty, sx, sy) {\n    const dest = new Float64Array(src.length);\n    for (let i = 0, ii = src.length; i < ii; i += 2) {\n      dest[i] = tx + src[i] * sx;\n      dest[i + 1] = ty + src[i + 1] * sy;\n    }\n    return dest;\n  }\n  #rescaleAndSwap(src, tx, ty, sx, sy) {\n    const dest = new Float64Array(src.length);\n    for (let i = 0, ii = src.length; i < ii; i += 2) {\n      dest[i] = tx + src[i + 1] * sx;\n      dest[i + 1] = ty + src[i] * sy;\n    }\n    return dest;\n  }\n  #computeMinMax(isLTR) {\n    const outline = this.#outline;\n    let lastX = outline[4];\n    let lastY = outline[5];\n    let minX = lastX;\n    let minY = lastY;\n    let maxX = lastX;\n    let maxY = lastY;\n    let lastPointX = lastX;\n    let lastPointY = lastY;\n    const ltrCallback = isLTR ? Math.max : Math.min;\n    for (let i = 6, ii = outline.length; i < ii; i += 6) {\n      if (isNaN(outline[i])) {\n        minX = Math.min(minX, outline[i + 4]);\n        minY = Math.min(minY, outline[i + 5]);\n        maxX = Math.max(maxX, outline[i + 4]);\n        maxY = Math.max(maxY, outline[i + 5]);\n        if (lastPointY < outline[i + 5]) {\n          lastPointX = outline[i + 4];\n          lastPointY = outline[i + 5];\n        } else if (lastPointY === outline[i + 5]) {\n          lastPointX = ltrCallback(lastPointX, outline[i + 4]);\n        }\n      } else {\n        const bbox = Util.bezierBoundingBox(lastX, lastY, ...outline.slice(i, i + 6));\n        minX = Math.min(minX, bbox[0]);\n        minY = Math.min(minY, bbox[1]);\n        maxX = Math.max(maxX, bbox[2]);\n        maxY = Math.max(maxY, bbox[3]);\n        if (lastPointY < bbox[3]) {\n          lastPointX = bbox[2];\n          lastPointY = bbox[3];\n        } else if (lastPointY === bbox[3]) {\n          lastPointX = ltrCallback(lastPointX, bbox[2]);\n        }\n      }\n      lastX = outline[i + 4];\n      lastY = outline[i + 5];\n    }\n    const x = minX - this.#innerMargin,\n      y = minY - this.#innerMargin,\n      width = maxX - minX + 2 * this.#innerMargin,\n      height = maxY - minY + 2 * this.#innerMargin;\n    this.#bbox = {\n      x,\n      y,\n      width,\n      height,\n      lastPoint: [lastPointX, lastPointY]\n    };\n  }\n  get box() {\n    return this.#bbox;\n  }\n  getNewOutline(thickness, innerMargin) {\n    const {\n      x,\n      y,\n      width,\n      height\n    } = this.#bbox;\n    const [layerX, layerY, layerWidth, layerHeight] = this.#box;\n    const sx = width * layerWidth;\n    const sy = height * layerHeight;\n    const tx = x * layerWidth + layerX;\n    const ty = y * layerHeight + layerY;\n    const outliner = new FreeOutliner({\n      x: this.#points[0] * sx + tx,\n      y: this.#points[1] * sy + ty\n    }, this.#box, this.#scaleFactor, thickness, this.#isLTR, innerMargin ?? this.#innerMargin);\n    for (let i = 2; i < this.#points.length; i += 2) {\n      outliner.add({\n        x: this.#points[i] * sx + tx,\n        y: this.#points[i + 1] * sy + ty\n      });\n    }\n    return outliner.getOutlines();\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/color_picker.js\n\n\n\nclass ColorPicker {\n  #boundKeyDown = this.#keyDown.bind(this);\n  #boundPointerDown = this.#pointerDown.bind(this);\n  #button = null;\n  #buttonSwatch = null;\n  #defaultColor;\n  #dropdown = null;\n  #dropdownWasFromKeyboard = false;\n  #isMainColorPicker = false;\n  #editor = null;\n  #eventBus;\n  #uiManager = null;\n  #type;\n  static get _keyboardManager() {\n    return shadow(this, \"_keyboardManager\", new KeyboardManager([[[\"Escape\", \"mac+Escape\"], ColorPicker.prototype._hideDropdownFromKeyboard], [[\" \", \"mac+ \"], ColorPicker.prototype._colorSelectFromKeyboard], [[\"ArrowDown\", \"ArrowRight\", \"mac+ArrowDown\", \"mac+ArrowRight\"], ColorPicker.prototype._moveToNext], [[\"ArrowUp\", \"ArrowLeft\", \"mac+ArrowUp\", \"mac+ArrowLeft\"], ColorPicker.prototype._moveToPrevious], [[\"Home\", \"mac+Home\"], ColorPicker.prototype._moveToBeginning], [[\"End\", \"mac+End\"], ColorPicker.prototype._moveToEnd]]));\n  }\n  constructor({\n    editor = null,\n    uiManager = null\n  }) {\n    if (editor) {\n      this.#isMainColorPicker = false;\n      this.#type = AnnotationEditorParamsType.HIGHLIGHT_COLOR;\n      this.#editor = editor;\n    } else {\n      this.#isMainColorPicker = true;\n      this.#type = AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR;\n    }\n    this.#uiManager = editor?._uiManager || uiManager;\n    this.#eventBus = this.#uiManager._eventBus;\n    this.#defaultColor = editor?.color || this.#uiManager?.highlightColors.values().next().value || \"#FFFF98\";\n  }\n  renderButton() {\n    const button = this.#button = document.createElement(\"button\");\n    button.className = \"colorPicker\";\n    button.tabIndex = \"0\";\n    button.setAttribute(\"data-l10n-id\", \"pdfjs-editor-colorpicker-button\");\n    button.setAttribute(\"aria-haspopup\", true);\n    const signal = this.#uiManager._signal;\n    button.addEventListener(\"click\", this.#openDropdown.bind(this), {\n      signal\n    });\n    button.addEventListener(\"keydown\", this.#boundKeyDown, {\n      signal\n    });\n    const swatch = this.#buttonSwatch = document.createElement(\"span\");\n    swatch.className = \"swatch\";\n    swatch.setAttribute(\"aria-hidden\", true);\n    swatch.style.backgroundColor = this.#defaultColor;\n    button.append(swatch);\n    return button;\n  }\n  renderMainDropdown() {\n    const dropdown = this.#dropdown = this.#getDropdownRoot();\n    dropdown.setAttribute(\"aria-orientation\", \"horizontal\");\n    dropdown.setAttribute(\"aria-labelledby\", \"highlightColorPickerLabel\");\n    return dropdown;\n  }\n  #getDropdownRoot() {\n    const div = document.createElement(\"div\");\n    const signal = this.#uiManager._signal;\n    div.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    div.className = \"dropdown\";\n    div.role = \"listbox\";\n    div.setAttribute(\"aria-multiselectable\", false);\n    div.setAttribute(\"aria-orientation\", \"vertical\");\n    div.setAttribute(\"data-l10n-id\", \"pdfjs-editor-colorpicker-dropdown\");\n    for (const [name, color] of this.#uiManager.highlightColors) {\n      const button = document.createElement(\"button\");\n      button.tabIndex = \"0\";\n      button.role = \"option\";\n      button.setAttribute(\"data-color\", color);\n      button.title = name;\n      button.setAttribute(\"data-l10n-id\", `pdfjs-editor-colorpicker-${name}`);\n      const swatch = document.createElement(\"span\");\n      button.append(swatch);\n      swatch.className = \"swatch\";\n      swatch.style.backgroundColor = color;\n      button.setAttribute(\"aria-selected\", color === this.#defaultColor);\n      button.addEventListener(\"click\", this.#colorSelect.bind(this, color), {\n        signal\n      });\n      div.append(button);\n    }\n    div.addEventListener(\"keydown\", this.#boundKeyDown, {\n      signal\n    });\n    return div;\n  }\n  #colorSelect(color, event) {\n    event.stopPropagation();\n    this.#eventBus.dispatch(\"switchannotationeditorparams\", {\n      source: this,\n      type: this.#type,\n      value: color\n    });\n  }\n  _colorSelectFromKeyboard(event) {\n    if (event.target === this.#button) {\n      this.#openDropdown(event);\n      return;\n    }\n    const color = event.target.getAttribute(\"data-color\");\n    if (!color) {\n      return;\n    }\n    this.#colorSelect(color, event);\n  }\n  _moveToNext(event) {\n    if (!this.#isDropdownVisible) {\n      this.#openDropdown(event);\n      return;\n    }\n    if (event.target === this.#button) {\n      this.#dropdown.firstChild?.focus();\n      return;\n    }\n    event.target.nextSibling?.focus();\n  }\n  _moveToPrevious(event) {\n    if (event.target === this.#dropdown?.firstChild || event.target === this.#button) {\n      if (this.#isDropdownVisible) {\n        this._hideDropdownFromKeyboard();\n      }\n      return;\n    }\n    if (!this.#isDropdownVisible) {\n      this.#openDropdown(event);\n    }\n    event.target.previousSibling?.focus();\n  }\n  _moveToBeginning(event) {\n    if (!this.#isDropdownVisible) {\n      this.#openDropdown(event);\n      return;\n    }\n    this.#dropdown.firstChild?.focus();\n  }\n  _moveToEnd(event) {\n    if (!this.#isDropdownVisible) {\n      this.#openDropdown(event);\n      return;\n    }\n    this.#dropdown.lastChild?.focus();\n  }\n  #keyDown(event) {\n    ColorPicker._keyboardManager.exec(this, event);\n  }\n  #openDropdown(event) {\n    if (this.#isDropdownVisible) {\n      this.hideDropdown();\n      return;\n    }\n    this.#dropdownWasFromKeyboard = event.detail === 0;\n    window.addEventListener(\"pointerdown\", this.#boundPointerDown, {\n      signal: this.#uiManager._signal\n    });\n    if (this.#dropdown) {\n      this.#dropdown.classList.remove(\"hidden\");\n      return;\n    }\n    const root = this.#dropdown = this.#getDropdownRoot();\n    this.#button.append(root);\n  }\n  #pointerDown(event) {\n    if (this.#dropdown?.contains(event.target)) {\n      return;\n    }\n    this.hideDropdown();\n  }\n  hideDropdown() {\n    this.#dropdown?.classList.add(\"hidden\");\n    window.removeEventListener(\"pointerdown\", this.#boundPointerDown);\n  }\n  get #isDropdownVisible() {\n    return this.#dropdown && !this.#dropdown.classList.contains(\"hidden\");\n  }\n  _hideDropdownFromKeyboard() {\n    if (this.#isMainColorPicker) {\n      return;\n    }\n    if (!this.#isDropdownVisible) {\n      this.#editor?.unselect();\n      return;\n    }\n    this.hideDropdown();\n    this.#button.focus({\n      preventScroll: true,\n      focusVisible: this.#dropdownWasFromKeyboard\n    });\n  }\n  updateColor(color) {\n    if (this.#buttonSwatch) {\n      this.#buttonSwatch.style.backgroundColor = color;\n    }\n    if (!this.#dropdown) {\n      return;\n    }\n    const i = this.#uiManager.highlightColors.values();\n    for (const child of this.#dropdown.children) {\n      child.setAttribute(\"aria-selected\", i.next().value === color);\n    }\n  }\n  destroy() {\n    this.#button?.remove();\n    this.#button = null;\n    this.#buttonSwatch = null;\n    this.#dropdown?.remove();\n    this.#dropdown = null;\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/highlight.js\n\n\n\n\n\n\nclass HighlightEditor extends AnnotationEditor {\n  #anchorNode = null;\n  #anchorOffset = 0;\n  #boxes;\n  #clipPathId = null;\n  #colorPicker = null;\n  #focusOutlines = null;\n  #focusNode = null;\n  #focusOffset = 0;\n  #highlightDiv = null;\n  #highlightOutlines = null;\n  #id = null;\n  #isFreeHighlight = false;\n  #lastPoint = null;\n  #opacity;\n  #outlineId = null;\n  #text = \"\";\n  #thickness;\n  #methodOfCreation = \"\";\n  static _defaultColor = null;\n  static _defaultOpacity = 1;\n  static _defaultThickness = 12;\n  static _l10nPromise;\n  static _type = \"highlight\";\n  static _editorType = AnnotationEditorType.HIGHLIGHT;\n  static _freeHighlightId = -1;\n  static _freeHighlight = null;\n  static _freeHighlightClipId = \"\";\n  static get _keyboardManager() {\n    const proto = HighlightEditor.prototype;\n    return shadow(this, \"_keyboardManager\", new KeyboardManager([[[\"ArrowLeft\", \"mac+ArrowLeft\"], proto._moveCaret, {\n      args: [0]\n    }], [[\"ArrowRight\", \"mac+ArrowRight\"], proto._moveCaret, {\n      args: [1]\n    }], [[\"ArrowUp\", \"mac+ArrowUp\"], proto._moveCaret, {\n      args: [2]\n    }], [[\"ArrowDown\", \"mac+ArrowDown\"], proto._moveCaret, {\n      args: [3]\n    }]]));\n  }\n  constructor(params) {\n    super({\n      ...params,\n      name: \"highlightEditor\"\n    });\n    this.color = params.color || HighlightEditor._defaultColor;\n    this.#thickness = params.thickness || HighlightEditor._defaultThickness;\n    this.#opacity = params.opacity || HighlightEditor._defaultOpacity;\n    this.#boxes = params.boxes || null;\n    this.#methodOfCreation = params.methodOfCreation || \"\";\n    this.#text = params.text || \"\";\n    this._isDraggable = false;\n    if (params.highlightId > -1) {\n      this.#isFreeHighlight = true;\n      this.#createFreeOutlines(params);\n      this.#addToDrawLayer();\n    } else {\n      this.#anchorNode = params.anchorNode;\n      this.#anchorOffset = params.anchorOffset;\n      this.#focusNode = params.focusNode;\n      this.#focusOffset = params.focusOffset;\n      this.#createOutlines();\n      this.#addToDrawLayer();\n      this.rotate(this.rotation);\n    }\n  }\n  get telemetryInitialData() {\n    return {\n      action: \"added\",\n      type: this.#isFreeHighlight ? \"free_highlight\" : \"highlight\",\n      color: this._uiManager.highlightColorNames.get(this.color),\n      thickness: this.#thickness,\n      methodOfCreation: this.#methodOfCreation\n    };\n  }\n  get telemetryFinalData() {\n    return {\n      type: \"highlight\",\n      color: this._uiManager.highlightColorNames.get(this.color)\n    };\n  }\n  static computeTelemetryFinalData(data) {\n    return {\n      numberOfColors: data.get(\"color\").size\n    };\n  }\n  #createOutlines() {\n    const outliner = new Outliner(this.#boxes, 0.001);\n    this.#highlightOutlines = outliner.getOutlines();\n    ({\n      x: this.x,\n      y: this.y,\n      width: this.width,\n      height: this.height\n    } = this.#highlightOutlines.box);\n    const outlinerForOutline = new Outliner(this.#boxes, 0.0025, 0.001, this._uiManager.direction === \"ltr\");\n    this.#focusOutlines = outlinerForOutline.getOutlines();\n    const {\n      lastPoint\n    } = this.#focusOutlines.box;\n    this.#lastPoint = [(lastPoint[0] - this.x) / this.width, (lastPoint[1] - this.y) / this.height];\n  }\n  #createFreeOutlines({\n    highlightOutlines,\n    highlightId,\n    clipPathId\n  }) {\n    this.#highlightOutlines = highlightOutlines;\n    const extraThickness = 1.5;\n    this.#focusOutlines = highlightOutlines.getNewOutline(this.#thickness / 2 + extraThickness, 0.0025);\n    if (highlightId >= 0) {\n      this.#id = highlightId;\n      this.#clipPathId = clipPathId;\n      this.parent.drawLayer.finalizeLine(highlightId, highlightOutlines);\n      this.#outlineId = this.parent.drawLayer.highlightOutline(this.#focusOutlines);\n    } else if (this.parent) {\n      const angle = this.parent.viewport.rotation;\n      this.parent.drawLayer.updateLine(this.#id, highlightOutlines);\n      this.parent.drawLayer.updateBox(this.#id, HighlightEditor.#rotateBbox(this.#highlightOutlines.box, (angle - this.rotation + 360) % 360));\n      this.parent.drawLayer.updateLine(this.#outlineId, this.#focusOutlines);\n      this.parent.drawLayer.updateBox(this.#outlineId, HighlightEditor.#rotateBbox(this.#focusOutlines.box, angle));\n    }\n    const {\n      x,\n      y,\n      width,\n      height\n    } = highlightOutlines.box;\n    switch (this.rotation) {\n      case 0:\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n        break;\n      case 90:\n        {\n          const [pageWidth, pageHeight] = this.parentDimensions;\n          this.x = y;\n          this.y = 1 - x;\n          this.width = width * pageHeight / pageWidth;\n          this.height = height * pageWidth / pageHeight;\n          break;\n        }\n      case 180:\n        this.x = 1 - x;\n        this.y = 1 - y;\n        this.width = width;\n        this.height = height;\n        break;\n      case 270:\n        {\n          const [pageWidth, pageHeight] = this.parentDimensions;\n          this.x = 1 - y;\n          this.y = x;\n          this.width = width * pageHeight / pageWidth;\n          this.height = height * pageWidth / pageHeight;\n          break;\n        }\n    }\n    const {\n      lastPoint\n    } = this.#focusOutlines.box;\n    this.#lastPoint = [(lastPoint[0] - x) / width, (lastPoint[1] - y) / height];\n  }\n  static initialize(l10n, uiManager) {\n    AnnotationEditor.initialize(l10n, uiManager);\n    HighlightEditor._defaultColor ||= uiManager.highlightColors?.values().next().value || \"#fff066\";\n  }\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:\n        HighlightEditor._defaultColor = value;\n        break;\n      case AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:\n        HighlightEditor._defaultThickness = value;\n        break;\n    }\n  }\n  translateInPage(x, y) {}\n  get toolbarPosition() {\n    return this.#lastPoint;\n  }\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.HIGHLIGHT_COLOR:\n        this.#updateColor(value);\n        break;\n      case AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:\n        this.#updateThickness(value);\n        break;\n    }\n  }\n  static get defaultPropertiesToUpdate() {\n    return [[AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR, HighlightEditor._defaultColor], [AnnotationEditorParamsType.HIGHLIGHT_THICKNESS, HighlightEditor._defaultThickness]];\n  }\n  get propertiesToUpdate() {\n    return [[AnnotationEditorParamsType.HIGHLIGHT_COLOR, this.color || HighlightEditor._defaultColor], [AnnotationEditorParamsType.HIGHLIGHT_THICKNESS, this.#thickness || HighlightEditor._defaultThickness], [AnnotationEditorParamsType.HIGHLIGHT_FREE, this.#isFreeHighlight]];\n  }\n  #updateColor(color) {\n    const setColor = col => {\n      this.color = col;\n      this.parent?.drawLayer.changeColor(this.#id, col);\n      this.#colorPicker?.updateColor(col);\n    };\n    const savedColor = this.color;\n    this.addCommands({\n      cmd: setColor.bind(this, color),\n      undo: setColor.bind(this, savedColor),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.HIGHLIGHT_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n    this._reportTelemetry({\n      action: \"color_changed\",\n      color: this._uiManager.highlightColorNames.get(color)\n    }, true);\n  }\n  #updateThickness(thickness) {\n    const savedThickness = this.#thickness;\n    const setThickness = th => {\n      this.#thickness = th;\n      this.#changeThickness(th);\n    };\n    this.addCommands({\n      cmd: setThickness.bind(this, thickness),\n      undo: setThickness.bind(this, savedThickness),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_THICKNESS,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n    this._reportTelemetry({\n      action: \"thickness_changed\",\n      thickness\n    }, true);\n  }\n  async addEditToolbar() {\n    const toolbar = await super.addEditToolbar();\n    if (!toolbar) {\n      return null;\n    }\n    if (this._uiManager.highlightColors) {\n      this.#colorPicker = new ColorPicker({\n        editor: this\n      });\n      toolbar.addColorPicker(this.#colorPicker);\n    }\n    return toolbar;\n  }\n  disableEditing() {\n    super.disableEditing();\n    this.div.classList.toggle(\"disabled\", true);\n  }\n  enableEditing() {\n    super.enableEditing();\n    this.div.classList.toggle(\"disabled\", false);\n  }\n  fixAndSetPosition() {\n    return super.fixAndSetPosition(this.#getRotation());\n  }\n  getBaseTranslation() {\n    return [0, 0];\n  }\n  getRect(tx, ty) {\n    return super.getRect(tx, ty, this.#getRotation());\n  }\n  onceAdded() {\n    this.parent.addUndoableEditor(this);\n    this.div.focus();\n  }\n  remove() {\n    this.#cleanDrawLayer();\n    this._reportTelemetry({\n      action: \"deleted\"\n    });\n    super.remove();\n  }\n  rebuild() {\n    if (!this.parent) {\n      return;\n    }\n    super.rebuild();\n    if (this.div === null) {\n      return;\n    }\n    this.#addToDrawLayer();\n    if (!this.isAttachedToDOM) {\n      this.parent.add(this);\n    }\n  }\n  setParent(parent) {\n    let mustBeSelected = false;\n    if (this.parent && !parent) {\n      this.#cleanDrawLayer();\n    } else if (parent) {\n      this.#addToDrawLayer(parent);\n      mustBeSelected = !this.parent && this.div?.classList.contains(\"selectedEditor\");\n    }\n    super.setParent(parent);\n    this.show(this._isVisible);\n    if (mustBeSelected) {\n      this.select();\n    }\n  }\n  #changeThickness(thickness) {\n    if (!this.#isFreeHighlight) {\n      return;\n    }\n    this.#createFreeOutlines({\n      highlightOutlines: this.#highlightOutlines.getNewOutline(thickness / 2)\n    });\n    this.fixAndSetPosition();\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.setDims(this.width * parentWidth, this.height * parentHeight);\n  }\n  #cleanDrawLayer() {\n    if (this.#id === null || !this.parent) {\n      return;\n    }\n    this.parent.drawLayer.remove(this.#id);\n    this.#id = null;\n    this.parent.drawLayer.remove(this.#outlineId);\n    this.#outlineId = null;\n  }\n  #addToDrawLayer(parent = this.parent) {\n    if (this.#id !== null) {\n      return;\n    }\n    ({\n      id: this.#id,\n      clipPathId: this.#clipPathId\n    } = parent.drawLayer.highlight(this.#highlightOutlines, this.color, this.#opacity));\n    this.#outlineId = parent.drawLayer.highlightOutline(this.#focusOutlines);\n    if (this.#highlightDiv) {\n      this.#highlightDiv.style.clipPath = this.#clipPathId;\n    }\n  }\n  static #rotateBbox({\n    x,\n    y,\n    width,\n    height\n  }, angle) {\n    switch (angle) {\n      case 90:\n        return {\n          x: 1 - y - height,\n          y: x,\n          width: height,\n          height: width\n        };\n      case 180:\n        return {\n          x: 1 - x - width,\n          y: 1 - y - height,\n          width,\n          height\n        };\n      case 270:\n        return {\n          x: y,\n          y: 1 - x - width,\n          width: height,\n          height: width\n        };\n    }\n    return {\n      x,\n      y,\n      width,\n      height\n    };\n  }\n  rotate(angle) {\n    const {\n      drawLayer\n    } = this.parent;\n    let box;\n    if (this.#isFreeHighlight) {\n      angle = (angle - this.rotation + 360) % 360;\n      box = HighlightEditor.#rotateBbox(this.#highlightOutlines.box, angle);\n    } else {\n      box = HighlightEditor.#rotateBbox(this, angle);\n    }\n    drawLayer.rotate(this.#id, angle);\n    drawLayer.rotate(this.#outlineId, angle);\n    drawLayer.updateBox(this.#id, box);\n    drawLayer.updateBox(this.#outlineId, HighlightEditor.#rotateBbox(this.#focusOutlines.box, angle));\n  }\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n    const div = super.render();\n    if (this.#text) {\n      div.setAttribute(\"aria-label\", this.#text);\n      div.setAttribute(\"role\", \"mark\");\n    }\n    if (this.#isFreeHighlight) {\n      div.classList.add(\"free\");\n    } else {\n      this.div.addEventListener(\"keydown\", this.#keydown.bind(this), {\n        signal: this._uiManager._signal\n      });\n    }\n    const highlightDiv = this.#highlightDiv = document.createElement(\"div\");\n    div.append(highlightDiv);\n    highlightDiv.setAttribute(\"aria-hidden\", \"true\");\n    highlightDiv.className = \"internal\";\n    highlightDiv.style.clipPath = this.#clipPathId;\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.setDims(this.width * parentWidth, this.height * parentHeight);\n    bindEvents(this, this.#highlightDiv, [\"pointerover\", \"pointerleave\"]);\n    this.enableEditing();\n    return div;\n  }\n  pointerover() {\n    this.parent.drawLayer.addClass(this.#outlineId, \"hovered\");\n  }\n  pointerleave() {\n    this.parent.drawLayer.removeClass(this.#outlineId, \"hovered\");\n  }\n  #keydown(event) {\n    HighlightEditor._keyboardManager.exec(this, event);\n  }\n  _moveCaret(direction) {\n    this.parent.unselect(this);\n    switch (direction) {\n      case 0:\n      case 2:\n        this.#setCaret(true);\n        break;\n      case 1:\n      case 3:\n        this.#setCaret(false);\n        break;\n    }\n  }\n  #setCaret(start) {\n    if (!this.#anchorNode) {\n      return;\n    }\n    const selection = window.getSelection();\n    if (start) {\n      selection.setPosition(this.#anchorNode, this.#anchorOffset);\n    } else {\n      selection.setPosition(this.#focusNode, this.#focusOffset);\n    }\n  }\n  select() {\n    super.select();\n    if (!this.#outlineId) {\n      return;\n    }\n    this.parent?.drawLayer.removeClass(this.#outlineId, \"hovered\");\n    this.parent?.drawLayer.addClass(this.#outlineId, \"selected\");\n  }\n  unselect() {\n    super.unselect();\n    if (!this.#outlineId) {\n      return;\n    }\n    this.parent?.drawLayer.removeClass(this.#outlineId, \"selected\");\n    if (!this.#isFreeHighlight) {\n      this.#setCaret(false);\n    }\n  }\n  get _mustFixPosition() {\n    return !this.#isFreeHighlight;\n  }\n  show(visible = this._isVisible) {\n    super.show(visible);\n    if (this.parent) {\n      this.parent.drawLayer.show(this.#id, visible);\n      this.parent.drawLayer.show(this.#outlineId, visible);\n    }\n  }\n  #getRotation() {\n    return this.#isFreeHighlight ? this.rotation : 0;\n  }\n  #serializeBoxes() {\n    if (this.#isFreeHighlight) {\n      return null;\n    }\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    const [pageX, pageY] = this.pageTranslation;\n    const boxes = this.#boxes;\n    const quadPoints = new Float32Array(boxes.length * 8);\n    let i = 0;\n    for (const {\n      x,\n      y,\n      width,\n      height\n    } of boxes) {\n      const sx = x * pageWidth + pageX;\n      const sy = (1 - y - height) * pageHeight + pageY;\n      quadPoints[i] = quadPoints[i + 4] = sx;\n      quadPoints[i + 1] = quadPoints[i + 3] = sy;\n      quadPoints[i + 2] = quadPoints[i + 6] = sx + width * pageWidth;\n      quadPoints[i + 5] = quadPoints[i + 7] = sy + height * pageHeight;\n      i += 8;\n    }\n    return quadPoints;\n  }\n  #serializeOutlines(rect) {\n    return this.#highlightOutlines.serialize(rect, this.#getRotation());\n  }\n  static startHighlighting(parent, isLTR, {\n    target: textLayer,\n    x,\n    y\n  }) {\n    const {\n      x: layerX,\n      y: layerY,\n      width: parentWidth,\n      height: parentHeight\n    } = textLayer.getBoundingClientRect();\n    const ac = new AbortController();\n    const signal = parent.combinedSignal(ac);\n    const pointerDown = e => {\n      e.preventDefault();\n      e.stopPropagation();\n    };\n    const pointerUpCallback = e => {\n      ac.abort();\n      this.#endHighlight(parent, e);\n    };\n    window.addEventListener(\"blur\", pointerUpCallback, {\n      signal\n    });\n    window.addEventListener(\"pointerup\", pointerUpCallback, {\n      signal\n    });\n    window.addEventListener(\"pointerdown\", pointerDown, {\n      capture: true,\n      passive: false,\n      signal\n    });\n    window.addEventListener(\"contextmenu\", noContextMenu, {\n      signal\n    });\n    textLayer.addEventListener(\"pointermove\", this.#highlightMove.bind(this, parent), {\n      signal\n    });\n    this._freeHighlight = new FreeOutliner({\n      x,\n      y\n    }, [layerX, layerY, parentWidth, parentHeight], parent.scale, this._defaultThickness / 2, isLTR, 0.001);\n    ({\n      id: this._freeHighlightId,\n      clipPathId: this._freeHighlightClipId\n    } = parent.drawLayer.highlight(this._freeHighlight, this._defaultColor, this._defaultOpacity, true));\n  }\n  static #highlightMove(parent, event) {\n    if (this._freeHighlight.add(event)) {\n      parent.drawLayer.updatePath(this._freeHighlightId, this._freeHighlight);\n    }\n  }\n  static #endHighlight(parent, event) {\n    if (!this._freeHighlight.isEmpty()) {\n      parent.createAndAddNewEditor(event, false, {\n        highlightId: this._freeHighlightId,\n        highlightOutlines: this._freeHighlight.getOutlines(),\n        clipPathId: this._freeHighlightClipId,\n        methodOfCreation: \"main_toolbar\"\n      });\n    } else {\n      parent.drawLayer.removeFreeHighlight(this._freeHighlightId);\n    }\n    this._freeHighlightId = -1;\n    this._freeHighlight = null;\n    this._freeHighlightClipId = \"\";\n  }\n  static deserialize(data, parent, uiManager) {\n    const editor = super.deserialize(data, parent, uiManager);\n    const {\n      rect: [blX, blY, trX, trY],\n      color,\n      quadPoints\n    } = data;\n    editor.color = Util.makeHexColor(...color);\n    editor.#opacity = data.opacity;\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    editor.width = (trX - blX) / pageWidth;\n    editor.height = (trY - blY) / pageHeight;\n    const boxes = editor.#boxes = [];\n    for (let i = 0; i < quadPoints.length; i += 8) {\n      boxes.push({\n        x: (quadPoints[4] - trX) / pageWidth,\n        y: (trY - (1 - quadPoints[i + 5])) / pageHeight,\n        width: (quadPoints[i + 2] - quadPoints[i]) / pageWidth,\n        height: (quadPoints[i + 5] - quadPoints[i + 1]) / pageHeight\n      });\n    }\n    editor.#createOutlines();\n    return editor;\n  }\n  serialize(isForCopying = false) {\n    if (this.isEmpty() || isForCopying) {\n      return null;\n    }\n    const rect = this.getRect(0, 0);\n    const color = AnnotationEditor._colorManager.convert(this.color);\n    return {\n      annotationType: AnnotationEditorType.HIGHLIGHT,\n      color,\n      opacity: this.#opacity,\n      thickness: this.#thickness,\n      quadPoints: this.#serializeBoxes(),\n      outlines: this.#serializeOutlines(rect),\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.#getRotation(),\n      structTreeParentId: this._structTreeParentId\n    };\n  }\n  static canCreateNewEmptyEditor() {\n    return false;\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/ink.js\n\n\n\n\n\nclass InkEditor extends AnnotationEditor {\n  #baseHeight = 0;\n  #baseWidth = 0;\n  #canvasContextMenuTimeoutId = null;\n  #currentPath2D = new Path2D();\n  #disableEditing = false;\n  #drawingAC = null;\n  #hasSomethingToDraw = false;\n  #isCanvasInitialized = false;\n  #observer = null;\n  #pointerdownAC = null;\n  #realWidth = 0;\n  #realHeight = 0;\n  #requestFrameCallback = null;\n  static _defaultColor = null;\n  static _defaultOpacity = 1;\n  static _defaultThickness = 1;\n  static _type = \"ink\";\n  static _editorType = AnnotationEditorType.INK;\n  constructor(params) {\n    super({\n      ...params,\n      name: \"inkEditor\"\n    });\n    this.color = params.color || null;\n    this.thickness = params.thickness || null;\n    this.opacity = params.opacity || null;\n    this.paths = [];\n    this.bezierPath2D = [];\n    this.allRawPaths = [];\n    this.currentPath = [];\n    this.scaleFactor = 1;\n    this.translationX = this.translationY = 0;\n    this.x = 0;\n    this.y = 0;\n    this._willKeepAspectRatio = true;\n  }\n  static initialize(l10n, uiManager) {\n    AnnotationEditor.initialize(l10n, uiManager);\n  }\n  static updateDefaultParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.INK_THICKNESS:\n        InkEditor._defaultThickness = value;\n        break;\n      case AnnotationEditorParamsType.INK_COLOR:\n        InkEditor._defaultColor = value;\n        break;\n      case AnnotationEditorParamsType.INK_OPACITY:\n        InkEditor._defaultOpacity = value / 100;\n        break;\n    }\n  }\n  updateParams(type, value) {\n    switch (type) {\n      case AnnotationEditorParamsType.INK_THICKNESS:\n        this.#updateThickness(value);\n        break;\n      case AnnotationEditorParamsType.INK_COLOR:\n        this.#updateColor(value);\n        break;\n      case AnnotationEditorParamsType.INK_OPACITY:\n        this.#updateOpacity(value);\n        break;\n    }\n  }\n  static get defaultPropertiesToUpdate() {\n    return [[AnnotationEditorParamsType.INK_THICKNESS, InkEditor._defaultThickness], [AnnotationEditorParamsType.INK_COLOR, InkEditor._defaultColor || AnnotationEditor._defaultLineColor], [AnnotationEditorParamsType.INK_OPACITY, Math.round(InkEditor._defaultOpacity * 100)]];\n  }\n  get propertiesToUpdate() {\n    return [[AnnotationEditorParamsType.INK_THICKNESS, this.thickness || InkEditor._defaultThickness], [AnnotationEditorParamsType.INK_COLOR, this.color || InkEditor._defaultColor || AnnotationEditor._defaultLineColor], [AnnotationEditorParamsType.INK_OPACITY, Math.round(100 * (this.opacity ?? InkEditor._defaultOpacity))]];\n  }\n  #updateThickness(thickness) {\n    const setThickness = th => {\n      this.thickness = th;\n      this.#fitToContent();\n    };\n    const savedThickness = this.thickness;\n    this.addCommands({\n      cmd: setThickness.bind(this, thickness),\n      undo: setThickness.bind(this, savedThickness),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_THICKNESS,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n  #updateColor(color) {\n    const setColor = col => {\n      this.color = col;\n      this.#redraw();\n    };\n    const savedColor = this.color;\n    this.addCommands({\n      cmd: setColor.bind(this, color),\n      undo: setColor.bind(this, savedColor),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_COLOR,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n  #updateOpacity(opacity) {\n    const setOpacity = op => {\n      this.opacity = op;\n      this.#redraw();\n    };\n    opacity /= 100;\n    const savedOpacity = this.opacity;\n    this.addCommands({\n      cmd: setOpacity.bind(this, opacity),\n      undo: setOpacity.bind(this, savedOpacity),\n      post: this._uiManager.updateUI.bind(this._uiManager, this),\n      mustExec: true,\n      type: AnnotationEditorParamsType.INK_OPACITY,\n      overwriteIfSameType: true,\n      keepUndo: true\n    });\n  }\n  rebuild() {\n    if (!this.parent) {\n      return;\n    }\n    super.rebuild();\n    if (this.div === null) {\n      return;\n    }\n    if (!this.canvas) {\n      this.#createCanvas();\n      this.#createObserver();\n    }\n    if (!this.isAttachedToDOM) {\n      this.parent.add(this);\n      this.#setCanvasDims();\n    }\n    this.#fitToContent();\n  }\n  remove() {\n    if (this.canvas === null) {\n      return;\n    }\n    if (!this.isEmpty()) {\n      this.commit();\n    }\n    this.canvas.width = this.canvas.height = 0;\n    this.canvas.remove();\n    this.canvas = null;\n    if (this.#canvasContextMenuTimeoutId) {\n      clearTimeout(this.#canvasContextMenuTimeoutId);\n      this.#canvasContextMenuTimeoutId = null;\n    }\n    this.#observer?.disconnect();\n    this.#observer = null;\n    super.remove();\n  }\n  setParent(parent) {\n    if (!this.parent && parent) {\n      this._uiManager.removeShouldRescale(this);\n    } else if (this.parent && parent === null) {\n      this._uiManager.addShouldRescale(this);\n    }\n    super.setParent(parent);\n  }\n  onScaleChanging() {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    const width = this.width * parentWidth;\n    const height = this.height * parentHeight;\n    this.setDimensions(width, height);\n  }\n  enableEditMode() {\n    if (this.#disableEditing || this.canvas === null) {\n      return;\n    }\n    super.enableEditMode();\n    this._isDraggable = false;\n    this.#addPointerdownListener();\n  }\n  disableEditMode() {\n    if (!this.isInEditMode() || this.canvas === null) {\n      return;\n    }\n    super.disableEditMode();\n    this._isDraggable = !this.isEmpty();\n    this.div.classList.remove(\"editing\");\n    this.#removePointerdownListener();\n  }\n  onceAdded() {\n    this._isDraggable = !this.isEmpty();\n  }\n  isEmpty() {\n    return this.paths.length === 0 || this.paths.length === 1 && this.paths[0].length === 0;\n  }\n  #getInitialBBox() {\n    const {\n      parentRotation,\n      parentDimensions: [width, height]\n    } = this;\n    switch (parentRotation) {\n      case 90:\n        return [0, height, height, width];\n      case 180:\n        return [width, height, width, height];\n      case 270:\n        return [width, 0, height, width];\n      default:\n        return [0, 0, width, height];\n    }\n  }\n  #setStroke() {\n    const {\n      ctx,\n      color,\n      opacity,\n      thickness,\n      parentScale,\n      scaleFactor\n    } = this;\n    ctx.lineWidth = thickness * parentScale / scaleFactor;\n    ctx.lineCap = \"round\";\n    ctx.lineJoin = \"round\";\n    ctx.miterLimit = 10;\n    ctx.strokeStyle = `${color}${opacityToHex(opacity)}`;\n  }\n  #startDrawing(x, y) {\n    this.canvas.addEventListener(\"contextmenu\", noContextMenu, {\n      signal: this._uiManager._signal\n    });\n    this.#removePointerdownListener();\n    this.#drawingAC = new AbortController();\n    const signal = this._uiManager.combinedSignal(this.#drawingAC);\n    this.canvas.addEventListener(\"pointerleave\", this.canvasPointerleave.bind(this), {\n      signal\n    });\n    this.canvas.addEventListener(\"pointermove\", this.canvasPointermove.bind(this), {\n      signal\n    });\n    this.canvas.addEventListener(\"pointerup\", this.canvasPointerup.bind(this), {\n      signal\n    });\n    this.isEditing = true;\n    if (!this.#isCanvasInitialized) {\n      this.#isCanvasInitialized = true;\n      this.#setCanvasDims();\n      this.thickness ||= InkEditor._defaultThickness;\n      this.color ||= InkEditor._defaultColor || AnnotationEditor._defaultLineColor;\n      this.opacity ??= InkEditor._defaultOpacity;\n    }\n    this.currentPath.push([x, y]);\n    this.#hasSomethingToDraw = false;\n    this.#setStroke();\n    this.#requestFrameCallback = () => {\n      this.#drawPoints();\n      if (this.#requestFrameCallback) {\n        window.requestAnimationFrame(this.#requestFrameCallback);\n      }\n    };\n    window.requestAnimationFrame(this.#requestFrameCallback);\n  }\n  #draw(x, y) {\n    const [lastX, lastY] = this.currentPath.at(-1);\n    if (this.currentPath.length > 1 && x === lastX && y === lastY) {\n      return;\n    }\n    const currentPath = this.currentPath;\n    let path2D = this.#currentPath2D;\n    currentPath.push([x, y]);\n    this.#hasSomethingToDraw = true;\n    if (currentPath.length <= 2) {\n      path2D.moveTo(...currentPath[0]);\n      path2D.lineTo(x, y);\n      return;\n    }\n    if (currentPath.length === 3) {\n      this.#currentPath2D = path2D = new Path2D();\n      path2D.moveTo(...currentPath[0]);\n    }\n    this.#makeBezierCurve(path2D, ...currentPath.at(-3), ...currentPath.at(-2), x, y);\n  }\n  #endPath() {\n    if (this.currentPath.length === 0) {\n      return;\n    }\n    const lastPoint = this.currentPath.at(-1);\n    this.#currentPath2D.lineTo(...lastPoint);\n  }\n  #stopDrawing(x, y) {\n    this.#requestFrameCallback = null;\n    x = Math.min(Math.max(x, 0), this.canvas.width);\n    y = Math.min(Math.max(y, 0), this.canvas.height);\n    this.#draw(x, y);\n    this.#endPath();\n    let bezier;\n    if (this.currentPath.length !== 1) {\n      bezier = this.#generateBezierPoints();\n    } else {\n      const xy = [x, y];\n      bezier = [[xy, xy.slice(), xy.slice(), xy]];\n    }\n    const path2D = this.#currentPath2D;\n    const currentPath = this.currentPath;\n    this.currentPath = [];\n    this.#currentPath2D = new Path2D();\n    const cmd = () => {\n      this.allRawPaths.push(currentPath);\n      this.paths.push(bezier);\n      this.bezierPath2D.push(path2D);\n      this._uiManager.rebuild(this);\n    };\n    const undo = () => {\n      this.allRawPaths.pop();\n      this.paths.pop();\n      this.bezierPath2D.pop();\n      if (this.paths.length === 0) {\n        this.remove();\n      } else {\n        if (!this.canvas) {\n          this.#createCanvas();\n          this.#createObserver();\n        }\n        this.#fitToContent();\n      }\n    };\n    this.addCommands({\n      cmd,\n      undo,\n      mustExec: true\n    });\n  }\n  #drawPoints() {\n    if (!this.#hasSomethingToDraw) {\n      return;\n    }\n    this.#hasSomethingToDraw = false;\n    const thickness = Math.ceil(this.thickness * this.parentScale);\n    const lastPoints = this.currentPath.slice(-3);\n    const x = lastPoints.map(xy => xy[0]);\n    const y = lastPoints.map(xy => xy[1]);\n    const xMin = Math.min(...x) - thickness;\n    const xMax = Math.max(...x) + thickness;\n    const yMin = Math.min(...y) - thickness;\n    const yMax = Math.max(...y) + thickness;\n    const {\n      ctx\n    } = this;\n    ctx.save();\n    ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    for (const path of this.bezierPath2D) {\n      ctx.stroke(path);\n    }\n    ctx.stroke(this.#currentPath2D);\n    ctx.restore();\n  }\n  #makeBezierCurve(path2D, x0, y0, x1, y1, x2, y2) {\n    const prevX = (x0 + x1) / 2;\n    const prevY = (y0 + y1) / 2;\n    const x3 = (x1 + x2) / 2;\n    const y3 = (y1 + y2) / 2;\n    path2D.bezierCurveTo(prevX + 2 * (x1 - prevX) / 3, prevY + 2 * (y1 - prevY) / 3, x3 + 2 * (x1 - x3) / 3, y3 + 2 * (y1 - y3) / 3, x3, y3);\n  }\n  #generateBezierPoints() {\n    const path = this.currentPath;\n    if (path.length <= 2) {\n      return [[path[0], path[0], path.at(-1), path.at(-1)]];\n    }\n    const bezierPoints = [];\n    let i;\n    let [x0, y0] = path[0];\n    for (i = 1; i < path.length - 2; i++) {\n      const [x1, y1] = path[i];\n      const [x2, y2] = path[i + 1];\n      const x3 = (x1 + x2) / 2;\n      const y3 = (y1 + y2) / 2;\n      const control1 = [x0 + 2 * (x1 - x0) / 3, y0 + 2 * (y1 - y0) / 3];\n      const control2 = [x3 + 2 * (x1 - x3) / 3, y3 + 2 * (y1 - y3) / 3];\n      bezierPoints.push([[x0, y0], control1, control2, [x3, y3]]);\n      [x0, y0] = [x3, y3];\n    }\n    const [x1, y1] = path[i];\n    const [x2, y2] = path[i + 1];\n    const control1 = [x0 + 2 * (x1 - x0) / 3, y0 + 2 * (y1 - y0) / 3];\n    const control2 = [x2 + 2 * (x1 - x2) / 3, y2 + 2 * (y1 - y2) / 3];\n    bezierPoints.push([[x0, y0], control1, control2, [x2, y2]]);\n    return bezierPoints;\n  }\n  #redraw() {\n    if (this.isEmpty()) {\n      this.#updateTransform();\n      return;\n    }\n    this.#setStroke();\n    const {\n      canvas,\n      ctx\n    } = this;\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    this.#updateTransform();\n    for (const path of this.bezierPath2D) {\n      ctx.stroke(path);\n    }\n  }\n  commit() {\n    if (this.#disableEditing) {\n      return;\n    }\n    super.commit();\n    this.isEditing = false;\n    this.disableEditMode();\n    this.setInForeground();\n    this.#disableEditing = true;\n    this.div.classList.add(\"disabled\");\n    this.#fitToContent(true);\n    this.select();\n    this.parent.addInkEditorIfNeeded(true);\n    this.moveInDOM();\n    this.div.focus({\n      preventScroll: true\n    });\n  }\n  focusin(event) {\n    if (!this._focusEventsAllowed) {\n      return;\n    }\n    super.focusin(event);\n    this.enableEditMode();\n  }\n  #addPointerdownListener() {\n    if (this.#pointerdownAC) {\n      return;\n    }\n    this.#pointerdownAC = new AbortController();\n    const signal = this._uiManager.combinedSignal(this.#pointerdownAC);\n    this.canvas.addEventListener(\"pointerdown\", this.canvasPointerdown.bind(this), {\n      signal\n    });\n  }\n  #removePointerdownListener() {\n    this.pointerdownAC?.abort();\n    this.pointerdownAC = null;\n  }\n  canvasPointerdown(event) {\n    if (event.button !== 0 || !this.isInEditMode() || this.#disableEditing) {\n      return;\n    }\n    this.setInForeground();\n    event.preventDefault();\n    if (!this.div.contains(document.activeElement)) {\n      this.div.focus({\n        preventScroll: true\n      });\n    }\n    this.#startDrawing(event.offsetX, event.offsetY);\n  }\n  canvasPointermove(event) {\n    event.preventDefault();\n    this.#draw(event.offsetX, event.offsetY);\n  }\n  canvasPointerup(event) {\n    event.preventDefault();\n    this.#endDrawing(event);\n  }\n  canvasPointerleave(event) {\n    this.#endDrawing(event);\n  }\n  #endDrawing(event) {\n    this.#drawingAC?.abort();\n    this.#drawingAC = null;\n    this.#addPointerdownListener();\n    if (this.#canvasContextMenuTimeoutId) {\n      clearTimeout(this.#canvasContextMenuTimeoutId);\n    }\n    this.#canvasContextMenuTimeoutId = setTimeout(() => {\n      this.#canvasContextMenuTimeoutId = null;\n      this.canvas.removeEventListener(\"contextmenu\", noContextMenu);\n    }, 10);\n    this.#stopDrawing(event.offsetX, event.offsetY);\n    this.addToAnnotationStorage();\n    this.setInBackground();\n  }\n  #createCanvas() {\n    this.canvas = document.createElement(\"canvas\");\n    this.canvas.width = this.canvas.height = 0;\n    this.canvas.className = \"inkEditorCanvas\";\n    this.canvas.setAttribute(\"data-l10n-id\", \"pdfjs-ink-canvas\");\n    this.div.append(this.canvas);\n    this.ctx = this.canvas.getContext(\"2d\");\n  }\n  #createObserver() {\n    this.#observer = new ResizeObserver(entries => {\n      const rect = entries[0].contentRect;\n      if (rect.width && rect.height) {\n        this.setDimensions(rect.width, rect.height);\n      }\n    });\n    this.#observer.observe(this.div);\n    this._uiManager._signal.addEventListener(\"abort\", () => {\n      this.#observer?.disconnect();\n      this.#observer = null;\n    }, {\n      once: true\n    });\n  }\n  get isResizable() {\n    return !this.isEmpty() && this.#disableEditing;\n  }\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n    let baseX, baseY;\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n    super.render();\n    this.div.setAttribute(\"data-l10n-id\", \"pdfjs-ink\");\n    const [x, y, w, h] = this.#getInitialBBox();\n    this.setAt(x, y, 0, 0);\n    this.setDims(w, h);\n    this.#createCanvas();\n    if (this.width) {\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      this.setAspectRatio(this.width * parentWidth, this.height * parentHeight);\n      this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n      this.#isCanvasInitialized = true;\n      this.#setCanvasDims();\n      this.setDims(this.width * parentWidth, this.height * parentHeight);\n      this.#redraw();\n      this.div.classList.add(\"disabled\");\n    } else {\n      this.div.classList.add(\"editing\");\n      this.enableEditMode();\n    }\n    this.#createObserver();\n    return this.div;\n  }\n  #setCanvasDims() {\n    if (!this.#isCanvasInitialized) {\n      return;\n    }\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.canvas.width = Math.ceil(this.width * parentWidth);\n    this.canvas.height = Math.ceil(this.height * parentHeight);\n    this.#updateTransform();\n  }\n  setDimensions(width, height) {\n    const roundedWidth = Math.round(width);\n    const roundedHeight = Math.round(height);\n    if (this.#realWidth === roundedWidth && this.#realHeight === roundedHeight) {\n      return;\n    }\n    this.#realWidth = roundedWidth;\n    this.#realHeight = roundedHeight;\n    this.canvas.style.visibility = \"hidden\";\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n    this.fixAndSetPosition();\n    if (this.#disableEditing) {\n      this.#setScaleFactor(width, height);\n    }\n    this.#setCanvasDims();\n    this.#redraw();\n    this.canvas.style.visibility = \"visible\";\n    this.fixDims();\n  }\n  #setScaleFactor(width, height) {\n    const padding = this.#getPadding();\n    const scaleFactorW = (width - padding) / this.#baseWidth;\n    const scaleFactorH = (height - padding) / this.#baseHeight;\n    this.scaleFactor = Math.min(scaleFactorW, scaleFactorH);\n  }\n  #updateTransform() {\n    const padding = this.#getPadding() / 2;\n    this.ctx.setTransform(this.scaleFactor, 0, 0, this.scaleFactor, this.translationX * this.scaleFactor + padding, this.translationY * this.scaleFactor + padding);\n  }\n  static #buildPath2D(bezier) {\n    const path2D = new Path2D();\n    for (let i = 0, ii = bezier.length; i < ii; i++) {\n      const [first, control1, control2, second] = bezier[i];\n      if (i === 0) {\n        path2D.moveTo(...first);\n      }\n      path2D.bezierCurveTo(control1[0], control1[1], control2[0], control2[1], second[0], second[1]);\n    }\n    return path2D;\n  }\n  static #toPDFCoordinates(points, rect, rotation) {\n    const [blX, blY, trX, trY] = rect;\n    switch (rotation) {\n      case 0:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] += blX;\n          points[i + 1] = trY - points[i + 1];\n        }\n        break;\n      case 90:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = points[i + 1] + blX;\n          points[i + 1] = x + blY;\n        }\n        break;\n      case 180:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] = trX - points[i];\n          points[i + 1] += blY;\n        }\n        break;\n      case 270:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = trX - points[i + 1];\n          points[i + 1] = trY - x;\n        }\n        break;\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n    return points;\n  }\n  static #fromPDFCoordinates(points, rect, rotation) {\n    const [blX, blY, trX, trY] = rect;\n    switch (rotation) {\n      case 0:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] -= blX;\n          points[i + 1] = trY - points[i + 1];\n        }\n        break;\n      case 90:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = points[i + 1] - blY;\n          points[i + 1] = x - blX;\n        }\n        break;\n      case 180:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          points[i] = trX - points[i];\n          points[i + 1] -= blY;\n        }\n        break;\n      case 270:\n        for (let i = 0, ii = points.length; i < ii; i += 2) {\n          const x = points[i];\n          points[i] = trY - points[i + 1];\n          points[i + 1] = trX - x;\n        }\n        break;\n      default:\n        throw new Error(\"Invalid rotation\");\n    }\n    return points;\n  }\n  #serializePaths(s, tx, ty, rect) {\n    const paths = [];\n    const padding = this.thickness / 2;\n    const shiftX = s * tx + padding;\n    const shiftY = s * ty + padding;\n    for (const bezier of this.paths) {\n      const buffer = [];\n      const points = [];\n      for (let j = 0, jj = bezier.length; j < jj; j++) {\n        const [first, control1, control2, second] = bezier[j];\n        if (first[0] === second[0] && first[1] === second[1] && jj === 1) {\n          const p0 = s * first[0] + shiftX;\n          const p1 = s * first[1] + shiftY;\n          buffer.push(p0, p1);\n          points.push(p0, p1);\n          break;\n        }\n        const p10 = s * first[0] + shiftX;\n        const p11 = s * first[1] + shiftY;\n        const p20 = s * control1[0] + shiftX;\n        const p21 = s * control1[1] + shiftY;\n        const p30 = s * control2[0] + shiftX;\n        const p31 = s * control2[1] + shiftY;\n        const p40 = s * second[0] + shiftX;\n        const p41 = s * second[1] + shiftY;\n        if (j === 0) {\n          buffer.push(p10, p11);\n          points.push(p10, p11);\n        }\n        buffer.push(p20, p21, p30, p31, p40, p41);\n        points.push(p20, p21);\n        if (j === jj - 1) {\n          points.push(p40, p41);\n        }\n      }\n      paths.push({\n        bezier: InkEditor.#toPDFCoordinates(buffer, rect, this.rotation),\n        points: InkEditor.#toPDFCoordinates(points, rect, this.rotation)\n      });\n    }\n    return paths;\n  }\n  #getBbox() {\n    let xMin = Infinity;\n    let xMax = -Infinity;\n    let yMin = Infinity;\n    let yMax = -Infinity;\n    for (const path of this.paths) {\n      for (const [first, control1, control2, second] of path) {\n        const bbox = Util.bezierBoundingBox(...first, ...control1, ...control2, ...second);\n        xMin = Math.min(xMin, bbox[0]);\n        yMin = Math.min(yMin, bbox[1]);\n        xMax = Math.max(xMax, bbox[2]);\n        yMax = Math.max(yMax, bbox[3]);\n      }\n    }\n    return [xMin, yMin, xMax, yMax];\n  }\n  #getPadding() {\n    return this.#disableEditing ? Math.ceil(this.thickness * this.parentScale) : 0;\n  }\n  #fitToContent(firstTime = false) {\n    if (this.isEmpty()) {\n      return;\n    }\n    if (!this.#disableEditing) {\n      this.#redraw();\n      return;\n    }\n    const bbox = this.#getBbox();\n    const padding = this.#getPadding();\n    this.#baseWidth = Math.max(AnnotationEditor.MIN_SIZE, bbox[2] - bbox[0]);\n    this.#baseHeight = Math.max(AnnotationEditor.MIN_SIZE, bbox[3] - bbox[1]);\n    const width = Math.ceil(padding + this.#baseWidth * this.scaleFactor);\n    const height = Math.ceil(padding + this.#baseHeight * this.scaleFactor);\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n    this.setAspectRatio(width, height);\n    const prevTranslationX = this.translationX;\n    const prevTranslationY = this.translationY;\n    this.translationX = -bbox[0];\n    this.translationY = -bbox[1];\n    this.#setCanvasDims();\n    this.#redraw();\n    this.#realWidth = width;\n    this.#realHeight = height;\n    this.setDims(width, height);\n    const unscaledPadding = firstTime ? padding / this.scaleFactor / 2 : 0;\n    this.translate(prevTranslationX - this.translationX - unscaledPadding, prevTranslationY - this.translationY - unscaledPadding);\n  }\n  static deserialize(data, parent, uiManager) {\n    if (data instanceof InkAnnotationElement) {\n      return null;\n    }\n    const editor = super.deserialize(data, parent, uiManager);\n    editor.thickness = data.thickness;\n    editor.color = Util.makeHexColor(...data.color);\n    editor.opacity = data.opacity;\n    const [pageWidth, pageHeight] = editor.pageDimensions;\n    const width = editor.width * pageWidth;\n    const height = editor.height * pageHeight;\n    const scaleFactor = editor.parentScale;\n    const padding = data.thickness / 2;\n    editor.#disableEditing = true;\n    editor.#realWidth = Math.round(width);\n    editor.#realHeight = Math.round(height);\n    const {\n      paths,\n      rect,\n      rotation\n    } = data;\n    for (let {\n      bezier\n    } of paths) {\n      bezier = InkEditor.#fromPDFCoordinates(bezier, rect, rotation);\n      const path = [];\n      editor.paths.push(path);\n      let p0 = scaleFactor * (bezier[0] - padding);\n      let p1 = scaleFactor * (bezier[1] - padding);\n      for (let i = 2, ii = bezier.length; i < ii; i += 6) {\n        const p10 = scaleFactor * (bezier[i] - padding);\n        const p11 = scaleFactor * (bezier[i + 1] - padding);\n        const p20 = scaleFactor * (bezier[i + 2] - padding);\n        const p21 = scaleFactor * (bezier[i + 3] - padding);\n        const p30 = scaleFactor * (bezier[i + 4] - padding);\n        const p31 = scaleFactor * (bezier[i + 5] - padding);\n        path.push([[p0, p1], [p10, p11], [p20, p21], [p30, p31]]);\n        p0 = p30;\n        p1 = p31;\n      }\n      const path2D = this.#buildPath2D(path);\n      editor.bezierPath2D.push(path2D);\n    }\n    const bbox = editor.#getBbox();\n    editor.#baseWidth = Math.max(AnnotationEditor.MIN_SIZE, bbox[2] - bbox[0]);\n    editor.#baseHeight = Math.max(AnnotationEditor.MIN_SIZE, bbox[3] - bbox[1]);\n    editor.#setScaleFactor(width, height);\n    return editor;\n  }\n  serialize() {\n    if (this.isEmpty()) {\n      return null;\n    }\n    const rect = this.getRect(0, 0);\n    const color = AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);\n    return {\n      annotationType: AnnotationEditorType.INK,\n      color,\n      thickness: this.thickness,\n      opacity: this.opacity,\n      paths: this.#serializePaths(this.scaleFactor / this.parentScale, this.translationX, this.translationY, rect),\n      pageIndex: this.pageIndex,\n      rect,\n      rotation: this.rotation,\n      structTreeParentId: this._structTreeParentId\n    };\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/stamp.js\n\n\n\n\nclass StampEditor extends AnnotationEditor {\n  #bitmap = null;\n  #bitmapId = null;\n  #bitmapPromise = null;\n  #bitmapUrl = null;\n  #bitmapFile = null;\n  #bitmapFileName = \"\";\n  #canvas = null;\n  #observer = null;\n  #resizeTimeoutId = null;\n  #isSvg = false;\n  #hasBeenAddedInUndoStack = false;\n  static _type = \"stamp\";\n  static _editorType = AnnotationEditorType.STAMP;\n  constructor(params) {\n    super({\n      ...params,\n      name: \"stampEditor\"\n    });\n    this.#bitmapUrl = params.bitmapUrl;\n    this.#bitmapFile = params.bitmapFile;\n  }\n  static initialize(l10n, uiManager) {\n    AnnotationEditor.initialize(l10n, uiManager);\n  }\n  static get supportedTypes() {\n    const types = [\"apng\", \"avif\", \"bmp\", \"gif\", \"jpeg\", \"png\", \"svg+xml\", \"webp\", \"x-icon\"];\n    return shadow(this, \"supportedTypes\", types.map(type => `image/${type}`));\n  }\n  static get supportedTypesStr() {\n    return shadow(this, \"supportedTypesStr\", this.supportedTypes.join(\",\"));\n  }\n  static isHandlingMimeForPasting(mime) {\n    return this.supportedTypes.includes(mime);\n  }\n  static paste(item, parent) {\n    parent.pasteEditor(AnnotationEditorType.STAMP, {\n      bitmapFile: item.getAsFile()\n    });\n  }\n  altTextFinish() {\n    if (this._uiManager.useNewAltTextFlow) {\n      this.div.hidden = false;\n    }\n    super.altTextFinish();\n  }\n  get telemetryFinalData() {\n    return {\n      type: \"stamp\",\n      hasAltText: !!this.altTextData?.altText\n    };\n  }\n  static computeTelemetryFinalData(data) {\n    const hasAltTextStats = data.get(\"hasAltText\");\n    return {\n      hasAltText: hasAltTextStats.get(true) ?? 0,\n      hasNoAltText: hasAltTextStats.get(false) ?? 0\n    };\n  }\n  #getBitmapFetched(data, fromId = false) {\n    if (!data) {\n      this.remove();\n      return;\n    }\n    this.#bitmap = data.bitmap;\n    if (!fromId) {\n      this.#bitmapId = data.id;\n      this.#isSvg = data.isSvg;\n    }\n    if (data.file) {\n      this.#bitmapFileName = data.file.name;\n    }\n    this.#createCanvas();\n  }\n  #getBitmapDone() {\n    this.#bitmapPromise = null;\n    this._uiManager.enableWaiting(false);\n    if (!this.#canvas) {\n      return;\n    }\n    if (this._uiManager.useNewAltTextWhenAddingImage && this._uiManager.useNewAltTextFlow && this.#bitmap) {\n      this._editToolbar.hide();\n      this._uiManager.editAltText(this, true);\n      return;\n    }\n    if (!this._uiManager.useNewAltTextWhenAddingImage && this._uiManager.useNewAltTextFlow && this.#bitmap) {\n      this._reportTelemetry({\n        action: \"pdfjs.image.image_added\",\n        data: {\n          alt_text_modal: false,\n          alt_text_type: \"empty\"\n        }\n      });\n      try {\n        this.mlGuessAltText();\n      } catch {}\n    }\n    this.div.focus();\n  }\n  async mlGuessAltText(imageData = null, updateAltTextData = true) {\n    if (this.hasAltTextData()) {\n      return null;\n    }\n    const {\n      mlManager\n    } = this._uiManager;\n    if (!mlManager) {\n      throw new Error(\"No ML.\");\n    }\n    if (!(await mlManager.isEnabledFor(\"altText\"))) {\n      throw new Error(\"ML isn't enabled for alt text.\");\n    }\n    const {\n      data,\n      width,\n      height\n    } = imageData || this.copyCanvas(null, true).imageData;\n    const response = await mlManager.guess({\n      name: \"altText\",\n      request: {\n        data,\n        width,\n        height,\n        channels: data.length / (width * height)\n      }\n    });\n    if (!response) {\n      throw new Error(\"No response from the AI service.\");\n    }\n    if (response.error) {\n      throw new Error(\"Error from the AI service.\");\n    }\n    if (response.cancel) {\n      return null;\n    }\n    if (!response.output) {\n      throw new Error(\"No valid response from the AI service.\");\n    }\n    const altText = response.output;\n    await this.setGuessedAltText(altText);\n    if (updateAltTextData && !this.hasAltTextData()) {\n      this.altTextData = {\n        alt: altText,\n        decorative: false\n      };\n    }\n    return altText;\n  }\n  #getBitmap() {\n    if (this.#bitmapId) {\n      this._uiManager.enableWaiting(true);\n      this._uiManager.imageManager.getFromId(this.#bitmapId).then(data => this.#getBitmapFetched(data, true)).finally(() => this.#getBitmapDone());\n      return;\n    }\n    if (this.#bitmapUrl) {\n      const url = this.#bitmapUrl;\n      this.#bitmapUrl = null;\n      this._uiManager.enableWaiting(true);\n      this.#bitmapPromise = this._uiManager.imageManager.getFromUrl(url).then(data => this.#getBitmapFetched(data)).finally(() => this.#getBitmapDone());\n      return;\n    }\n    if (this.#bitmapFile) {\n      const file = this.#bitmapFile;\n      this.#bitmapFile = null;\n      this._uiManager.enableWaiting(true);\n      this.#bitmapPromise = this._uiManager.imageManager.getFromFile(file).then(data => this.#getBitmapFetched(data)).finally(() => this.#getBitmapDone());\n      return;\n    }\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = StampEditor.supportedTypesStr;\n    const signal = this._uiManager._signal;\n    this.#bitmapPromise = new Promise(resolve => {\n      input.addEventListener(\"change\", async () => {\n        if (!input.files || input.files.length === 0) {\n          this.remove();\n        } else {\n          this._uiManager.enableWaiting(true);\n          const data = await this._uiManager.imageManager.getFromFile(input.files[0]);\n          this._reportTelemetry({\n            action: \"pdfjs.image.image_selected\",\n            data: {\n              alt_text_modal: this._uiManager.useNewAltTextFlow\n            }\n          });\n          this.#getBitmapFetched(data);\n        }\n        resolve();\n      }, {\n        signal\n      });\n      input.addEventListener(\"cancel\", () => {\n        this.remove();\n        resolve();\n      }, {\n        signal\n      });\n    }).finally(() => this.#getBitmapDone());\n    input.click();\n  }\n  remove() {\n    if (this.#bitmapId) {\n      this.#bitmap = null;\n      this._uiManager.imageManager.deleteId(this.#bitmapId);\n      this.#canvas?.remove();\n      this.#canvas = null;\n      this.#observer?.disconnect();\n      this.#observer = null;\n      if (this.#resizeTimeoutId) {\n        clearTimeout(this.#resizeTimeoutId);\n        this.#resizeTimeoutId = null;\n      }\n    }\n    super.remove();\n  }\n  rebuild() {\n    if (!this.parent) {\n      if (this.#bitmapId) {\n        this.#getBitmap();\n      }\n      return;\n    }\n    super.rebuild();\n    if (this.div === null) {\n      return;\n    }\n    if (this.#bitmapId && this.#canvas === null) {\n      this.#getBitmap();\n    }\n    if (!this.isAttachedToDOM) {\n      this.parent.add(this);\n    }\n  }\n  onceAdded() {\n    this._isDraggable = true;\n    this.div.focus();\n  }\n  isEmpty() {\n    return !(this.#bitmapPromise || this.#bitmap || this.#bitmapUrl || this.#bitmapFile || this.#bitmapId);\n  }\n  get isResizable() {\n    return true;\n  }\n  render() {\n    if (this.div) {\n      return this.div;\n    }\n    let baseX, baseY;\n    if (this.width) {\n      baseX = this.x;\n      baseY = this.y;\n    }\n    super.render();\n    this.div.hidden = true;\n    this.addAltTextButton();\n    if (this.#bitmap) {\n      this.#createCanvas();\n    } else {\n      this.#getBitmap();\n    }\n    if (this.width) {\n      const [parentWidth, parentHeight] = this.parentDimensions;\n      this.setAt(baseX * parentWidth, baseY * parentHeight, this.width * parentWidth, this.height * parentHeight);\n    }\n    return this.div;\n  }\n  #createCanvas() {\n    const {\n      div\n    } = this;\n    let {\n      width,\n      height\n    } = this.#bitmap;\n    const [pageWidth, pageHeight] = this.pageDimensions;\n    const MAX_RATIO = 0.75;\n    if (this.width) {\n      width = this.width * pageWidth;\n      height = this.height * pageHeight;\n    } else if (width > MAX_RATIO * pageWidth || height > MAX_RATIO * pageHeight) {\n      const factor = Math.min(MAX_RATIO * pageWidth / width, MAX_RATIO * pageHeight / height);\n      width *= factor;\n      height *= factor;\n    }\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.setDims(width * parentWidth / pageWidth, height * parentHeight / pageHeight);\n    this._uiManager.enableWaiting(false);\n    const canvas = this.#canvas = document.createElement(\"canvas\");\n    div.append(canvas);\n    if (!this._uiManager.useNewAltTextWhenAddingImage || !this._uiManager.useNewAltTextFlow) {\n      div.hidden = false;\n    }\n    this.#drawBitmap(width, height);\n    this.#createObserver();\n    if (!this.#hasBeenAddedInUndoStack) {\n      this.parent.addUndoableEditor(this);\n      this.#hasBeenAddedInUndoStack = true;\n    }\n    this._reportTelemetry({\n      action: \"inserted_image\"\n    });\n    if (this.#bitmapFileName) {\n      canvas.setAttribute(\"aria-label\", this.#bitmapFileName);\n    }\n  }\n  copyCanvas(maxDimension, createImageData = false) {\n    if (!maxDimension) {\n      maxDimension = 224;\n    }\n    const {\n      width: bitmapWidth,\n      height: bitmapHeight\n    } = this.#bitmap;\n    const canvas = document.createElement(\"canvas\");\n    let bitmap = this.#bitmap;\n    let width = bitmapWidth,\n      height = bitmapHeight;\n    if (bitmapWidth > maxDimension || bitmapHeight > maxDimension) {\n      const ratio = Math.min(maxDimension / bitmapWidth, maxDimension / bitmapHeight);\n      width = Math.floor(bitmapWidth * ratio);\n      height = Math.floor(bitmapHeight * ratio);\n      if (!this.#isSvg) {\n        bitmap = this.#scaleBitmap(width, height);\n      }\n    }\n    canvas.width = width;\n    canvas.height = height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.filter = this._uiManager.hcmFilter;\n    let white = \"white\",\n      black = \"#cfcfd8\";\n    if (this._uiManager.hcmFilter !== \"none\") {\n      black = \"black\";\n    } else if (window.matchMedia?.(\"(prefers-color-scheme: dark)\").matches) {\n      white = \"#8f8f9d\";\n      black = \"#42414d\";\n    }\n    const boxDim = 15;\n    const pattern = new OffscreenCanvas(boxDim * 2, boxDim * 2);\n    const patternCtx = pattern.getContext(\"2d\");\n    patternCtx.fillStyle = white;\n    patternCtx.fillRect(0, 0, boxDim * 2, boxDim * 2);\n    patternCtx.fillStyle = black;\n    patternCtx.fillRect(0, 0, boxDim, boxDim);\n    patternCtx.fillRect(boxDim, boxDim, boxDim, boxDim);\n    ctx.fillStyle = ctx.createPattern(pattern, \"repeat\");\n    ctx.fillRect(0, 0, width, height);\n    if (createImageData) {\n      const offscreen = new OffscreenCanvas(width, height);\n      const offscreenCtx = offscreen.getContext(\"2d\", {\n        willReadFrequently: true\n      });\n      offscreenCtx.drawImage(bitmap, 0, 0, bitmap.width, bitmap.height, 0, 0, width, height);\n      const data = offscreenCtx.getImageData(0, 0, width, height).data;\n      ctx.drawImage(offscreen, 0, 0);\n      return {\n        canvas,\n        imageData: {\n          width,\n          height,\n          data\n        }\n      };\n    }\n    ctx.drawImage(bitmap, 0, 0, bitmap.width, bitmap.height, 0, 0, width, height);\n    return {\n      canvas,\n      imageData: null\n    };\n  }\n  #setDimensions(width, height) {\n    const [parentWidth, parentHeight] = this.parentDimensions;\n    this.width = width / parentWidth;\n    this.height = height / parentHeight;\n    this.setDims(width, height);\n    if (this._initialOptions?.isCentered) {\n      this.center();\n    } else {\n      this.fixAndSetPosition();\n    }\n    this._initialOptions = null;\n    if (this.#resizeTimeoutId !== null) {\n      clearTimeout(this.#resizeTimeoutId);\n    }\n    const TIME_TO_WAIT = 200;\n    this.#resizeTimeoutId = setTimeout(() => {\n      this.#resizeTimeoutId = null;\n      this.#drawBitmap(width, height);\n    }, TIME_TO_WAIT);\n  }\n  #scaleBitmap(width, height) {\n    const {\n      width: bitmapWidth,\n      height: bitmapHeight\n    } = this.#bitmap;\n    let newWidth = bitmapWidth;\n    let newHeight = bitmapHeight;\n    let bitmap = this.#bitmap;\n    while (newWidth > 2 * width || newHeight > 2 * height) {\n      const prevWidth = newWidth;\n      const prevHeight = newHeight;\n      if (newWidth > 2 * width) {\n        newWidth = newWidth >= 16384 ? Math.floor(newWidth / 2) - 1 : Math.ceil(newWidth / 2);\n      }\n      if (newHeight > 2 * height) {\n        newHeight = newHeight >= 16384 ? Math.floor(newHeight / 2) - 1 : Math.ceil(newHeight / 2);\n      }\n      const offscreen = new OffscreenCanvas(newWidth, newHeight);\n      const ctx = offscreen.getContext(\"2d\");\n      ctx.drawImage(bitmap, 0, 0, prevWidth, prevHeight, 0, 0, newWidth, newHeight);\n      bitmap = offscreen.transferToImageBitmap();\n    }\n    return bitmap;\n  }\n  #drawBitmap(width, height) {\n    width = Math.ceil(width);\n    height = Math.ceil(height);\n    const canvas = this.#canvas;\n    if (!canvas || canvas.width === width && canvas.height === height) {\n      return;\n    }\n    canvas.width = width;\n    canvas.height = height;\n    const bitmap = this.#isSvg ? this.#bitmap : this.#scaleBitmap(width, height);\n    const ctx = canvas.getContext(\"2d\");\n    ctx.filter = this._uiManager.hcmFilter;\n    ctx.drawImage(bitmap, 0, 0, bitmap.width, bitmap.height, 0, 0, width, height);\n  }\n  getImageForAltText() {\n    return this.#canvas;\n  }\n  #serializeBitmap(toUrl) {\n    if (toUrl) {\n      if (this.#isSvg) {\n        const url = this._uiManager.imageManager.getSvgUrl(this.#bitmapId);\n        if (url) {\n          return url;\n        }\n      }\n      const canvas = document.createElement(\"canvas\");\n      ({\n        width: canvas.width,\n        height: canvas.height\n      } = this.#bitmap);\n      const ctx = canvas.getContext(\"2d\");\n      ctx.drawImage(this.#bitmap, 0, 0);\n      return canvas.toDataURL();\n    }\n    if (this.#isSvg) {\n      const [pageWidth, pageHeight] = this.pageDimensions;\n      const width = Math.round(this.width * pageWidth * PixelsPerInch.PDF_TO_CSS_UNITS);\n      const height = Math.round(this.height * pageHeight * PixelsPerInch.PDF_TO_CSS_UNITS);\n      const offscreen = new OffscreenCanvas(width, height);\n      const ctx = offscreen.getContext(\"2d\");\n      ctx.drawImage(this.#bitmap, 0, 0, this.#bitmap.width, this.#bitmap.height, 0, 0, width, height);\n      return offscreen.transferToImageBitmap();\n    }\n    return structuredClone(this.#bitmap);\n  }\n  #createObserver() {\n    if (!this._uiManager._signal) {\n      return;\n    }\n    this.#observer = new ResizeObserver(entries => {\n      const rect = entries[0].contentRect;\n      if (rect.width && rect.height) {\n        this.#setDimensions(rect.width, rect.height);\n      }\n    });\n    this.#observer.observe(this.div);\n    this._uiManager._signal.addEventListener(\"abort\", () => {\n      this.#observer?.disconnect();\n      this.#observer = null;\n    }, {\n      once: true\n    });\n  }\n  static deserialize(data, parent, uiManager) {\n    if (data instanceof StampAnnotationElement) {\n      return null;\n    }\n    const editor = super.deserialize(data, parent, uiManager);\n    const {\n      rect,\n      bitmapUrl,\n      bitmapId,\n      isSvg,\n      accessibilityData\n    } = data;\n    if (bitmapId && uiManager.imageManager.isValidId(bitmapId)) {\n      editor.#bitmapId = bitmapId;\n    } else {\n      editor.#bitmapUrl = bitmapUrl;\n    }\n    editor.#isSvg = isSvg;\n    const [parentWidth, parentHeight] = editor.pageDimensions;\n    editor.width = (rect[2] - rect[0]) / parentWidth;\n    editor.height = (rect[3] - rect[1]) / parentHeight;\n    if (accessibilityData) {\n      editor.altTextData = accessibilityData;\n    }\n    return editor;\n  }\n  serialize(isForCopying = false, context = null) {\n    if (this.isEmpty()) {\n      return null;\n    }\n    const serialized = {\n      annotationType: AnnotationEditorType.STAMP,\n      bitmapId: this.#bitmapId,\n      pageIndex: this.pageIndex,\n      rect: this.getRect(0, 0),\n      rotation: this.rotation,\n      isSvg: this.#isSvg,\n      structTreeParentId: this._structTreeParentId\n    };\n    if (isForCopying) {\n      serialized.bitmapUrl = this.#serializeBitmap(true);\n      serialized.accessibilityData = this.serializeAltText(true);\n      return serialized;\n    }\n    const {\n      decorative,\n      altText\n    } = this.serializeAltText(false);\n    if (!decorative && altText) {\n      serialized.accessibilityData = {\n        type: \"Figure\",\n        alt: altText\n      };\n    }\n    if (context === null) {\n      return serialized;\n    }\n    context.stamps ||= new Map();\n    const area = this.#isSvg ? (serialized.rect[2] - serialized.rect[0]) * (serialized.rect[3] - serialized.rect[1]) : null;\n    if (!context.stamps.has(this.#bitmapId)) {\n      context.stamps.set(this.#bitmapId, {\n        area,\n        serialized\n      });\n      serialized.bitmap = this.#serializeBitmap(false);\n    } else if (this.#isSvg) {\n      const prevData = context.stamps.get(this.#bitmapId);\n      if (area > prevData.area) {\n        prevData.area = area;\n        prevData.serialized.bitmap.close();\n        prevData.serialized.bitmap = this.#serializeBitmap(false);\n      }\n    }\n    return serialized;\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/editor/annotation_editor_layer.js\n\n\n\n\n\n\n\nclass AnnotationEditorLayer {\n  #accessibilityManager;\n  #allowClick = false;\n  #annotationLayer = null;\n  #clickAC = null;\n  #editorFocusTimeoutId = null;\n  #editors = new Map();\n  #hadPointerDown = false;\n  #isCleaningUp = false;\n  #isDisabling = false;\n  #textLayer = null;\n  #textSelectionAC = null;\n  #uiManager;\n  static _initialized = false;\n  static #editorTypes = new Map([FreeTextEditor, InkEditor, StampEditor, HighlightEditor].map(type => [type._editorType, type]));\n  constructor({\n    uiManager,\n    pageIndex,\n    div,\n    accessibilityManager,\n    annotationLayer,\n    drawLayer,\n    textLayer,\n    viewport,\n    l10n\n  }) {\n    const editorTypes = [...AnnotationEditorLayer.#editorTypes.values()];\n    if (!AnnotationEditorLayer._initialized) {\n      AnnotationEditorLayer._initialized = true;\n      for (const editorType of editorTypes) {\n        editorType.initialize(l10n, uiManager);\n      }\n    }\n    uiManager.registerEditorTypes(editorTypes);\n    this.#uiManager = uiManager;\n    this.pageIndex = pageIndex;\n    this.div = div;\n    this.#accessibilityManager = accessibilityManager;\n    this.#annotationLayer = annotationLayer;\n    this.viewport = viewport;\n    this.#textLayer = textLayer;\n    this.drawLayer = drawLayer;\n    this.#uiManager.addLayer(this);\n  }\n  get isEmpty() {\n    return this.#editors.size === 0;\n  }\n  get isInvisible() {\n    return this.isEmpty && this.#uiManager.getMode() === AnnotationEditorType.NONE;\n  }\n  updateToolbar(mode) {\n    this.#uiManager.updateToolbar(mode);\n  }\n  updateMode(mode = this.#uiManager.getMode()) {\n    this.#cleanup();\n    switch (mode) {\n      case AnnotationEditorType.NONE:\n        this.disableTextSelection();\n        this.togglePointerEvents(false);\n        this.toggleAnnotationLayerPointerEvents(true);\n        this.disableClick();\n        return;\n      case AnnotationEditorType.INK:\n        this.addInkEditorIfNeeded(false);\n        this.disableTextSelection();\n        this.togglePointerEvents(true);\n        this.disableClick();\n        break;\n      case AnnotationEditorType.HIGHLIGHT:\n        this.enableTextSelection();\n        this.togglePointerEvents(false);\n        this.disableClick();\n        break;\n      default:\n        this.disableTextSelection();\n        this.togglePointerEvents(true);\n        this.enableClick();\n    }\n    this.toggleAnnotationLayerPointerEvents(false);\n    const {\n      classList\n    } = this.div;\n    for (const editorType of AnnotationEditorLayer.#editorTypes.values()) {\n      classList.toggle(`${editorType._type}Editing`, mode === editorType._editorType);\n    }\n    this.div.hidden = false;\n  }\n  hasTextLayer(textLayer) {\n    return textLayer === this.#textLayer?.div;\n  }\n  addInkEditorIfNeeded(isCommitting) {\n    if (this.#uiManager.getMode() !== AnnotationEditorType.INK) {\n      return;\n    }\n    if (!isCommitting) {\n      for (const editor of this.#editors.values()) {\n        if (editor.isEmpty()) {\n          editor.setInBackground();\n          return;\n        }\n      }\n    }\n    const editor = this.createAndAddNewEditor({\n      offsetX: 0,\n      offsetY: 0\n    }, false);\n    editor.setInBackground();\n  }\n  setEditingState(isEditing) {\n    this.#uiManager.setEditingState(isEditing);\n  }\n  addCommands(params) {\n    this.#uiManager.addCommands(params);\n  }\n  toggleDrawing(enabled = false) {\n    this.div.classList.toggle(\"drawing\", !enabled);\n  }\n  togglePointerEvents(enabled = false) {\n    this.div.classList.toggle(\"disabled\", !enabled);\n  }\n  toggleAnnotationLayerPointerEvents(enabled = false) {\n    this.#annotationLayer?.div.classList.toggle(\"disabled\", !enabled);\n  }\n  enable() {\n    this.div.tabIndex = 0;\n    this.togglePointerEvents(true);\n    const annotationElementIds = new Set();\n    for (const editor of this.#editors.values()) {\n      editor.enableEditing();\n      editor.show(true);\n      if (editor.annotationElementId) {\n        this.#uiManager.removeChangedExistingAnnotation(editor);\n        annotationElementIds.add(editor.annotationElementId);\n      }\n    }\n    if (!this.#annotationLayer) {\n      return;\n    }\n    const editables = this.#annotationLayer.getEditableAnnotations();\n    for (const editable of editables) {\n      editable.hide();\n      if (this.#uiManager.isDeletedAnnotationElement(editable.data.id)) {\n        continue;\n      }\n      if (annotationElementIds.has(editable.data.id)) {\n        continue;\n      }\n      const editor = this.deserialize(editable);\n      if (!editor) {\n        continue;\n      }\n      this.addOrRebuild(editor);\n      editor.enableEditing();\n    }\n  }\n  disable() {\n    this.#isDisabling = true;\n    this.div.tabIndex = -1;\n    this.togglePointerEvents(false);\n    const changedAnnotations = new Map();\n    const resetAnnotations = new Map();\n    for (const editor of this.#editors.values()) {\n      editor.disableEditing();\n      if (!editor.annotationElementId) {\n        continue;\n      }\n      if (editor.serialize() !== null) {\n        changedAnnotations.set(editor.annotationElementId, editor);\n        continue;\n      } else {\n        resetAnnotations.set(editor.annotationElementId, editor);\n      }\n      this.getEditableAnnotation(editor.annotationElementId)?.show();\n      editor.remove();\n    }\n    if (this.#annotationLayer) {\n      const editables = this.#annotationLayer.getEditableAnnotations();\n      for (const editable of editables) {\n        const {\n          id\n        } = editable.data;\n        if (this.#uiManager.isDeletedAnnotationElement(id)) {\n          continue;\n        }\n        let editor = resetAnnotations.get(id);\n        if (editor) {\n          editor.resetAnnotationElement(editable);\n          editor.show(false);\n          editable.show();\n          continue;\n        }\n        editor = changedAnnotations.get(id);\n        if (editor) {\n          this.#uiManager.addChangedExistingAnnotation(editor);\n          editor.renderAnnotationElement(editable);\n          editor.show(false);\n        }\n        editable.show();\n      }\n    }\n    this.#cleanup();\n    if (this.isEmpty) {\n      this.div.hidden = true;\n    }\n    const {\n      classList\n    } = this.div;\n    for (const editorType of AnnotationEditorLayer.#editorTypes.values()) {\n      classList.remove(`${editorType._type}Editing`);\n    }\n    this.disableTextSelection();\n    this.toggleAnnotationLayerPointerEvents(true);\n    this.#isDisabling = false;\n  }\n  getEditableAnnotation(id) {\n    return this.#annotationLayer?.getEditableAnnotation(id) || null;\n  }\n  setActiveEditor(editor) {\n    const currentActive = this.#uiManager.getActive();\n    if (currentActive === editor) {\n      return;\n    }\n    this.#uiManager.setActiveEditor(editor);\n  }\n  enableTextSelection() {\n    this.div.tabIndex = -1;\n    if (this.#textLayer?.div && !this.#textSelectionAC) {\n      this.#textSelectionAC = new AbortController();\n      const signal = this.#uiManager.combinedSignal(this.#textSelectionAC);\n      this.#textLayer.div.addEventListener(\"pointerdown\", this.#textLayerPointerDown.bind(this), {\n        signal\n      });\n      this.#textLayer.div.classList.add(\"highlighting\");\n    }\n  }\n  disableTextSelection() {\n    this.div.tabIndex = 0;\n    if (this.#textLayer?.div && this.#textSelectionAC) {\n      this.#textSelectionAC.abort();\n      this.#textSelectionAC = null;\n      this.#textLayer.div.classList.remove(\"highlighting\");\n    }\n  }\n  #textLayerPointerDown(event) {\n    this.#uiManager.unselectAll();\n    const {\n      target\n    } = event;\n    if (target === this.#textLayer.div || target.classList.contains(\"endOfContent\") && this.#textLayer.div.contains(target)) {\n      const {\n        isMac\n      } = util_FeatureTest.platform;\n      if (event.button !== 0 || event.ctrlKey && isMac) {\n        return;\n      }\n      this.#uiManager.showAllEditors(\"highlight\", true, true);\n      this.#textLayer.div.classList.add(\"free\");\n      this.toggleDrawing();\n      HighlightEditor.startHighlighting(this, this.#uiManager.direction === \"ltr\", event);\n      this.#textLayer.div.addEventListener(\"pointerup\", () => {\n        this.#textLayer.div.classList.remove(\"free\");\n        this.toggleDrawing(true);\n      }, {\n        once: true,\n        signal: this.#uiManager._signal\n      });\n      event.preventDefault();\n    }\n  }\n  enableClick() {\n    if (this.#clickAC) {\n      return;\n    }\n    this.#clickAC = new AbortController();\n    const signal = this.#uiManager.combinedSignal(this.#clickAC);\n    this.div.addEventListener(\"pointerdown\", this.pointerdown.bind(this), {\n      signal\n    });\n    this.div.addEventListener(\"pointerup\", this.pointerup.bind(this), {\n      signal\n    });\n  }\n  disableClick() {\n    this.#clickAC?.abort();\n    this.#clickAC = null;\n  }\n  attach(editor) {\n    this.#editors.set(editor.id, editor);\n    const {\n      annotationElementId\n    } = editor;\n    if (annotationElementId && this.#uiManager.isDeletedAnnotationElement(annotationElementId)) {\n      this.#uiManager.removeDeletedAnnotationElement(editor);\n    }\n  }\n  detach(editor) {\n    this.#editors.delete(editor.id);\n    this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n    if (!this.#isDisabling && editor.annotationElementId) {\n      this.#uiManager.addDeletedAnnotationElement(editor);\n    }\n  }\n  remove(editor) {\n    this.detach(editor);\n    this.#uiManager.removeEditor(editor);\n    editor.div.remove();\n    editor.isAttachedToDOM = false;\n    if (!this.#isCleaningUp) {\n      this.addInkEditorIfNeeded(false);\n    }\n  }\n  changeParent(editor) {\n    if (editor.parent === this) {\n      return;\n    }\n    if (editor.parent && editor.annotationElementId) {\n      this.#uiManager.addDeletedAnnotationElement(editor.annotationElementId);\n      AnnotationEditor.deleteAnnotationElement(editor);\n      editor.annotationElementId = null;\n    }\n    this.attach(editor);\n    editor.parent?.detach(editor);\n    editor.setParent(this);\n    if (editor.div && editor.isAttachedToDOM) {\n      editor.div.remove();\n      this.div.append(editor.div);\n    }\n  }\n  add(editor) {\n    if (editor.parent === this && editor.isAttachedToDOM) {\n      return;\n    }\n    this.changeParent(editor);\n    this.#uiManager.addEditor(editor);\n    this.attach(editor);\n    if (!editor.isAttachedToDOM) {\n      const div = editor.render();\n      this.div.append(div);\n      editor.isAttachedToDOM = true;\n    }\n    editor.fixAndSetPosition();\n    editor.onceAdded();\n    this.#uiManager.addToAnnotationStorage(editor);\n    editor._reportTelemetry(editor.telemetryInitialData);\n  }\n  moveEditorInDOM(editor) {\n    if (!editor.isAttachedToDOM) {\n      return;\n    }\n    const {\n      activeElement\n    } = document;\n    if (editor.div.contains(activeElement) && !this.#editorFocusTimeoutId) {\n      editor._focusEventsAllowed = false;\n      this.#editorFocusTimeoutId = setTimeout(() => {\n        this.#editorFocusTimeoutId = null;\n        if (!editor.div.contains(document.activeElement)) {\n          editor.div.addEventListener(\"focusin\", () => {\n            editor._focusEventsAllowed = true;\n          }, {\n            once: true,\n            signal: this.#uiManager._signal\n          });\n          activeElement.focus();\n        } else {\n          editor._focusEventsAllowed = true;\n        }\n      }, 0);\n    }\n    editor._structTreeParentId = this.#accessibilityManager?.moveElementInDOM(this.div, editor.div, editor.contentDiv, true);\n  }\n  addOrRebuild(editor) {\n    if (editor.needsToBeRebuilt()) {\n      editor.parent ||= this;\n      editor.rebuild();\n      editor.show();\n    } else {\n      this.add(editor);\n    }\n  }\n  addUndoableEditor(editor) {\n    const cmd = () => editor._uiManager.rebuild(editor);\n    const undo = () => {\n      editor.remove();\n    };\n    this.addCommands({\n      cmd,\n      undo,\n      mustExec: false\n    });\n  }\n  getNextId() {\n    return this.#uiManager.getId();\n  }\n  get #currentEditorType() {\n    return AnnotationEditorLayer.#editorTypes.get(this.#uiManager.getMode());\n  }\n  combinedSignal(ac) {\n    return this.#uiManager.combinedSignal(ac);\n  }\n  #createNewEditor(params) {\n    const editorType = this.#currentEditorType;\n    return editorType ? new editorType.prototype.constructor(params) : null;\n  }\n  canCreateNewEmptyEditor() {\n    return this.#currentEditorType?.canCreateNewEmptyEditor();\n  }\n  pasteEditor(mode, params) {\n    this.#uiManager.updateToolbar(mode);\n    this.#uiManager.updateMode(mode);\n    const {\n      offsetX,\n      offsetY\n    } = this.#getCenterPoint();\n    const id = this.getNextId();\n    const editor = this.#createNewEditor({\n      parent: this,\n      id,\n      x: offsetX,\n      y: offsetY,\n      uiManager: this.#uiManager,\n      isCentered: true,\n      ...params\n    });\n    if (editor) {\n      this.add(editor);\n    }\n  }\n  deserialize(data) {\n    return AnnotationEditorLayer.#editorTypes.get(data.annotationType ?? data.annotationEditorType)?.deserialize(data, this, this.#uiManager) || null;\n  }\n  createAndAddNewEditor(event, isCentered, data = {}) {\n    const id = this.getNextId();\n    const editor = this.#createNewEditor({\n      parent: this,\n      id,\n      x: event.offsetX,\n      y: event.offsetY,\n      uiManager: this.#uiManager,\n      isCentered,\n      ...data\n    });\n    if (editor) {\n      this.add(editor);\n    }\n    return editor;\n  }\n  #getCenterPoint() {\n    const {\n      x,\n      y,\n      width,\n      height\n    } = this.div.getBoundingClientRect();\n    const tlX = Math.max(0, x);\n    const tlY = Math.max(0, y);\n    const brX = Math.min(window.innerWidth, x + width);\n    const brY = Math.min(window.innerHeight, y + height);\n    const centerX = (tlX + brX) / 2 - x;\n    const centerY = (tlY + brY) / 2 - y;\n    const [offsetX, offsetY] = this.viewport.rotation % 180 === 0 ? [centerX, centerY] : [centerY, centerX];\n    return {\n      offsetX,\n      offsetY\n    };\n  }\n  addNewEditor() {\n    this.createAndAddNewEditor(this.#getCenterPoint(), true);\n  }\n  setSelected(editor) {\n    this.#uiManager.setSelected(editor);\n  }\n  toggleSelected(editor) {\n    this.#uiManager.toggleSelected(editor);\n  }\n  isSelected(editor) {\n    return this.#uiManager.isSelected(editor);\n  }\n  unselect(editor) {\n    this.#uiManager.unselect(editor);\n  }\n  pointerup(event) {\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n    if (event.button !== 0 || event.ctrlKey && isMac) {\n      return;\n    }\n    if (event.target !== this.div) {\n      return;\n    }\n    if (!this.#hadPointerDown) {\n      return;\n    }\n    this.#hadPointerDown = false;\n    if (!this.#allowClick) {\n      this.#allowClick = true;\n      return;\n    }\n    if (this.#uiManager.getMode() === AnnotationEditorType.STAMP) {\n      this.#uiManager.unselectAll();\n      return;\n    }\n    this.createAndAddNewEditor(event, false);\n  }\n  pointerdown(event) {\n    if (this.#uiManager.getMode() === AnnotationEditorType.HIGHLIGHT) {\n      this.enableTextSelection();\n    }\n    if (this.#hadPointerDown) {\n      this.#hadPointerDown = false;\n      return;\n    }\n    const {\n      isMac\n    } = util_FeatureTest.platform;\n    if (event.button !== 0 || event.ctrlKey && isMac) {\n      return;\n    }\n    if (event.target !== this.div) {\n      return;\n    }\n    this.#hadPointerDown = true;\n    const editor = this.#uiManager.getActive();\n    this.#allowClick = !editor || editor.isEmpty();\n  }\n  findNewParent(editor, x, y) {\n    const layer = this.#uiManager.findParent(x, y);\n    if (layer === null || layer === this) {\n      return false;\n    }\n    layer.changeParent(editor);\n    return true;\n  }\n  destroy() {\n    if (this.#uiManager.getActive()?.parent === this) {\n      this.#uiManager.commitOrRemove();\n      this.#uiManager.setActiveEditor(null);\n    }\n    if (this.#editorFocusTimeoutId) {\n      clearTimeout(this.#editorFocusTimeoutId);\n      this.#editorFocusTimeoutId = null;\n    }\n    for (const editor of this.#editors.values()) {\n      this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv);\n      editor.setParent(null);\n      editor.isAttachedToDOM = false;\n      editor.div.remove();\n    }\n    this.div = null;\n    this.#editors.clear();\n    this.#uiManager.removeLayer(this);\n  }\n  #cleanup() {\n    this.#isCleaningUp = true;\n    for (const editor of this.#editors.values()) {\n      if (editor.isEmpty()) {\n        editor.remove();\n      }\n    }\n    this.#isCleaningUp = false;\n  }\n  render({\n    viewport\n  }) {\n    this.viewport = viewport;\n    setLayerDimensions(this.div, viewport);\n    for (const editor of this.#uiManager.getEditors(this.pageIndex)) {\n      this.add(editor);\n      editor.rebuild();\n    }\n    this.updateMode();\n  }\n  update({\n    viewport\n  }) {\n    this.#uiManager.commitOrRemove();\n    this.#cleanup();\n    const oldRotation = this.viewport.rotation;\n    const rotation = viewport.rotation;\n    this.viewport = viewport;\n    setLayerDimensions(this.div, {\n      rotation\n    });\n    if (oldRotation !== rotation) {\n      for (const editor of this.#editors.values()) {\n        editor.rotate(rotation);\n      }\n    }\n    this.addInkEditorIfNeeded(false);\n  }\n  get pageDimensions() {\n    const {\n      pageWidth,\n      pageHeight\n    } = this.viewport.rawDims;\n    return [pageWidth, pageHeight];\n  }\n  get scale() {\n    return this.#uiManager.viewParameters.realScale;\n  }\n}\n\n;// CONCATENATED MODULE: ./src/display/draw_layer.js\n\n\nclass DrawLayer {\n  #parent = null;\n  #id = 0;\n  #mapping = new Map();\n  #toUpdate = new Map();\n  constructor({\n    pageIndex\n  }) {\n    this.pageIndex = pageIndex;\n  }\n  setParent(parent) {\n    if (!this.#parent) {\n      this.#parent = parent;\n      return;\n    }\n    if (this.#parent !== parent) {\n      if (this.#mapping.size > 0) {\n        for (const root of this.#mapping.values()) {\n          root.remove();\n          parent.append(root);\n        }\n      }\n      this.#parent = parent;\n    }\n  }\n  static get _svgFactory() {\n    return shadow(this, \"_svgFactory\", new DOMSVGFactory());\n  }\n  static #setBox(element, {\n    x = 0,\n    y = 0,\n    width = 1,\n    height = 1\n  } = {}) {\n    const {\n      style\n    } = element;\n    style.top = `${100 * y}%`;\n    style.left = `${100 * x}%`;\n    style.width = `${100 * width}%`;\n    style.height = `${100 * height}%`;\n  }\n  #createSVG(box) {\n    const svg = DrawLayer._svgFactory.create(1, 1, true);\n    this.#parent.append(svg);\n    svg.setAttribute(\"aria-hidden\", true);\n    DrawLayer.#setBox(svg, box);\n    return svg;\n  }\n  #createClipPath(defs, pathId) {\n    const clipPath = DrawLayer._svgFactory.createElement(\"clipPath\");\n    defs.append(clipPath);\n    const clipPathId = `clip_${pathId}`;\n    clipPath.setAttribute(\"id\", clipPathId);\n    clipPath.setAttribute(\"clipPathUnits\", \"objectBoundingBox\");\n    const clipPathUse = DrawLayer._svgFactory.createElement(\"use\");\n    clipPath.append(clipPathUse);\n    clipPathUse.setAttribute(\"href\", `#${pathId}`);\n    clipPathUse.classList.add(\"clip\");\n    return clipPathId;\n  }\n  highlight(outlines, color, opacity, isPathUpdatable = false) {\n    const id = this.#id++;\n    const root = this.#createSVG(outlines.box);\n    root.classList.add(\"highlight\");\n    if (outlines.free) {\n      root.classList.add(\"free\");\n    }\n    const defs = DrawLayer._svgFactory.createElement(\"defs\");\n    root.append(defs);\n    const path = DrawLayer._svgFactory.createElement(\"path\");\n    defs.append(path);\n    const pathId = `path_p${this.pageIndex}_${id}`;\n    path.setAttribute(\"id\", pathId);\n    path.setAttribute(\"d\", outlines.toSVGPath());\n    if (isPathUpdatable) {\n      this.#toUpdate.set(id, path);\n    }\n    const clipPathId = this.#createClipPath(defs, pathId);\n    const use = DrawLayer._svgFactory.createElement(\"use\");\n    root.append(use);\n    root.setAttribute(\"fill\", color);\n    root.setAttribute(\"fill-opacity\", opacity);\n    use.setAttribute(\"href\", `#${pathId}`);\n    this.#mapping.set(id, root);\n    return {\n      id,\n      clipPathId: `url(#${clipPathId})`\n    };\n  }\n  highlightOutline(outlines) {\n    const id = this.#id++;\n    const root = this.#createSVG(outlines.box);\n    root.classList.add(\"highlightOutline\");\n    const defs = DrawLayer._svgFactory.createElement(\"defs\");\n    root.append(defs);\n    const path = DrawLayer._svgFactory.createElement(\"path\");\n    defs.append(path);\n    const pathId = `path_p${this.pageIndex}_${id}`;\n    path.setAttribute(\"id\", pathId);\n    path.setAttribute(\"d\", outlines.toSVGPath());\n    path.setAttribute(\"vector-effect\", \"non-scaling-stroke\");\n    let maskId;\n    if (outlines.free) {\n      root.classList.add(\"free\");\n      const mask = DrawLayer._svgFactory.createElement(\"mask\");\n      defs.append(mask);\n      maskId = `mask_p${this.pageIndex}_${id}`;\n      mask.setAttribute(\"id\", maskId);\n      mask.setAttribute(\"maskUnits\", \"objectBoundingBox\");\n      const rect = DrawLayer._svgFactory.createElement(\"rect\");\n      mask.append(rect);\n      rect.setAttribute(\"width\", \"1\");\n      rect.setAttribute(\"height\", \"1\");\n      rect.setAttribute(\"fill\", \"white\");\n      const use = DrawLayer._svgFactory.createElement(\"use\");\n      mask.append(use);\n      use.setAttribute(\"href\", `#${pathId}`);\n      use.setAttribute(\"stroke\", \"none\");\n      use.setAttribute(\"fill\", \"black\");\n      use.setAttribute(\"fill-rule\", \"nonzero\");\n      use.classList.add(\"mask\");\n    }\n    const use1 = DrawLayer._svgFactory.createElement(\"use\");\n    root.append(use1);\n    use1.setAttribute(\"href\", `#${pathId}`);\n    if (maskId) {\n      use1.setAttribute(\"mask\", `url(#${maskId})`);\n    }\n    const use2 = use1.cloneNode();\n    root.append(use2);\n    use1.classList.add(\"mainOutline\");\n    use2.classList.add(\"secondaryOutline\");\n    this.#mapping.set(id, root);\n    return id;\n  }\n  finalizeLine(id, line) {\n    const path = this.#toUpdate.get(id);\n    this.#toUpdate.delete(id);\n    this.updateBox(id, line.box);\n    path.setAttribute(\"d\", line.toSVGPath());\n  }\n  updateLine(id, line) {\n    const root = this.#mapping.get(id);\n    const defs = root.firstChild;\n    const path = defs.firstChild;\n    path.setAttribute(\"d\", line.toSVGPath());\n  }\n  removeFreeHighlight(id) {\n    this.remove(id);\n    this.#toUpdate.delete(id);\n  }\n  updatePath(id, line) {\n    this.#toUpdate.get(id).setAttribute(\"d\", line.toSVGPath());\n  }\n  updateBox(id, box) {\n    DrawLayer.#setBox(this.#mapping.get(id), box);\n  }\n  show(id, visible) {\n    this.#mapping.get(id).classList.toggle(\"hidden\", !visible);\n  }\n  rotate(id, angle) {\n    this.#mapping.get(id).setAttribute(\"data-main-rotation\", angle);\n  }\n  changeColor(id, color) {\n    this.#mapping.get(id).setAttribute(\"fill\", color);\n  }\n  changeOpacity(id, opacity) {\n    this.#mapping.get(id).setAttribute(\"fill-opacity\", opacity);\n  }\n  addClass(id, className) {\n    this.#mapping.get(id).classList.add(className);\n  }\n  removeClass(id, className) {\n    this.#mapping.get(id).classList.remove(className);\n  }\n  remove(id) {\n    if (this.#parent === null) {\n      return;\n    }\n    this.#mapping.get(id).remove();\n    this.#mapping.delete(id);\n  }\n  destroy() {\n    this.#parent = null;\n    for (const root of this.#mapping.values()) {\n      root.remove();\n    }\n    this.#mapping.clear();\n  }\n}\n\n;// CONCATENATED MODULE: ./src/pdf.js\n\n\n\n\n\n\n\n\n\n\n\n\nconst pdfjsVersion = \"4.6.82\";\nconst pdfjsBuild = \"9b541910f\";\n\nvar __webpack_exports__AbortException = __webpack_exports__.AbortException;\nvar __webpack_exports__AnnotationEditorLayer = __webpack_exports__.AnnotationEditorLayer;\nvar __webpack_exports__AnnotationEditorParamsType = __webpack_exports__.AnnotationEditorParamsType;\nvar __webpack_exports__AnnotationEditorType = __webpack_exports__.AnnotationEditorType;\nvar __webpack_exports__AnnotationEditorUIManager = __webpack_exports__.AnnotationEditorUIManager;\nvar __webpack_exports__AnnotationLayer = __webpack_exports__.AnnotationLayer;\nvar __webpack_exports__AnnotationMode = __webpack_exports__.AnnotationMode;\nvar __webpack_exports__CMapCompressionType = __webpack_exports__.CMapCompressionType;\nvar __webpack_exports__ColorPicker = __webpack_exports__.ColorPicker;\nvar __webpack_exports__DOMSVGFactory = __webpack_exports__.DOMSVGFactory;\nvar __webpack_exports__DrawLayer = __webpack_exports__.DrawLayer;\nvar __webpack_exports__FeatureTest = __webpack_exports__.FeatureTest;\nvar __webpack_exports__GlobalWorkerOptions = __webpack_exports__.GlobalWorkerOptions;\nvar __webpack_exports__ImageKind = __webpack_exports__.ImageKind;\nvar __webpack_exports__InvalidPDFException = __webpack_exports__.InvalidPDFException;\nvar __webpack_exports__MissingPDFException = __webpack_exports__.MissingPDFException;\nvar __webpack_exports__OPS = __webpack_exports__.OPS;\nvar __webpack_exports__PDFDataRangeTransport = __webpack_exports__.PDFDataRangeTransport;\nvar __webpack_exports__PDFDateString = __webpack_exports__.PDFDateString;\nvar __webpack_exports__PDFWorker = __webpack_exports__.PDFWorker;\nvar __webpack_exports__PasswordResponses = __webpack_exports__.PasswordResponses;\nvar __webpack_exports__PermissionFlag = __webpack_exports__.PermissionFlag;\nvar __webpack_exports__PixelsPerInch = __webpack_exports__.PixelsPerInch;\nvar __webpack_exports__RenderingCancelledException = __webpack_exports__.RenderingCancelledException;\nvar __webpack_exports__TextLayer = __webpack_exports__.TextLayer;\nvar __webpack_exports__UnexpectedResponseException = __webpack_exports__.UnexpectedResponseException;\nvar __webpack_exports__Util = __webpack_exports__.Util;\nvar __webpack_exports__VerbosityLevel = __webpack_exports__.VerbosityLevel;\nvar __webpack_exports__XfaLayer = __webpack_exports__.XfaLayer;\nvar __webpack_exports__build = __webpack_exports__.build;\nvar __webpack_exports__createValidAbsoluteUrl = __webpack_exports__.createValidAbsoluteUrl;\nvar __webpack_exports__fetchData = __webpack_exports__.fetchData;\nvar __webpack_exports__getDocument = __webpack_exports__.getDocument;\nvar __webpack_exports__getFilenameFromUrl = __webpack_exports__.getFilenameFromUrl;\nvar __webpack_exports__getPdfFilenameFromUrl = __webpack_exports__.getPdfFilenameFromUrl;\nvar __webpack_exports__getXfaPageViewport = __webpack_exports__.getXfaPageViewport;\nvar __webpack_exports__isDataScheme = __webpack_exports__.isDataScheme;\nvar __webpack_exports__isPdfFile = __webpack_exports__.isPdfFile;\nvar __webpack_exports__noContextMenu = __webpack_exports__.noContextMenu;\nvar __webpack_exports__normalizeUnicode = __webpack_exports__.normalizeUnicode;\nvar __webpack_exports__setLayerDimensions = __webpack_exports__.setLayerDimensions;\nvar __webpack_exports__shadow = __webpack_exports__.shadow;\nvar __webpack_exports__version = __webpack_exports__.version;\nexport { __webpack_exports__AbortException as AbortException, __webpack_exports__AnnotationEditorLayer as AnnotationEditorLayer, __webpack_exports__AnnotationEditorParamsType as AnnotationEditorParamsType, __webpack_exports__AnnotationEditorType as AnnotationEditorType, __webpack_exports__AnnotationEditorUIManager as AnnotationEditorUIManager, __webpack_exports__AnnotationLayer as AnnotationLayer, __webpack_exports__AnnotationMode as AnnotationMode, __webpack_exports__CMapCompressionType as CMapCompressionType, __webpack_exports__ColorPicker as ColorPicker, __webpack_exports__DOMSVGFactory as DOMSVGFactory, __webpack_exports__DrawLayer as DrawLayer, __webpack_exports__FeatureTest as FeatureTest, __webpack_exports__GlobalWorkerOptions as GlobalWorkerOptions, __webpack_exports__ImageKind as ImageKind, __webpack_exports__InvalidPDFException as InvalidPDFException, __webpack_exports__MissingPDFException as MissingPDFException, __webpack_exports__OPS as OPS, __webpack_exports__PDFDataRangeTransport as PDFDataRangeTransport, __webpack_exports__PDFDateString as PDFDateString, __webpack_exports__PDFWorker as PDFWorker, __webpack_exports__PasswordResponses as PasswordResponses, __webpack_exports__PermissionFlag as PermissionFlag, __webpack_exports__PixelsPerInch as PixelsPerInch, __webpack_exports__RenderingCancelledException as RenderingCancelledException, __webpack_exports__TextLayer as TextLayer, __webpack_exports__UnexpectedResponseException as UnexpectedResponseException, __webpack_exports__Util as Util, __webpack_exports__VerbosityLevel as VerbosityLevel, __webpack_exports__XfaLayer as XfaLayer, __webpack_exports__build as build, __webpack_exports__createValidAbsoluteUrl as createValidAbsoluteUrl, __webpack_exports__fetchData as fetchData, __webpack_exports__getDocument as getDocument, __webpack_exports__getFilenameFromUrl as getFilenameFromUrl, __webpack_exports__getPdfFilenameFromUrl as getPdfFilenameFromUrl, __webpack_exports__getXfaPageViewport as getXfaPageViewport, __webpack_exports__isDataScheme as isDataScheme, __webpack_exports__isPdfFile as isPdfFile, __webpack_exports__noContextMenu as noContextMenu, __webpack_exports__normalizeUnicode as normalizeUnicode, __webpack_exports__setLayerDimensions as setLayerDimensions, __webpack_exports__shadow as shadow, __webpack_exports__version as version };\n\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AAAS;;AACT;AAAS,IAAIA,mBAAmB,GAAG,EAA1B;AACT;;AACA;;AACA;;AAAS;;AACT;;AAAS,CAAC,MAAM;EAChB;EAAU;;EACV;EAAUA,mBAAmB,CAACC,CAApB,GAAwB,CAACC,OAAD,EAAUC,UAAV,KAAyB;IAC3D;IAAW,KAAI,IAAIC,GAAR,IAAeD,UAAf,EAA2B;MACtC;MAAY,IAAGH,mBAAmB,CAACK,CAApB,CAAsBF,UAAtB,EAAkCC,GAAlC,KAA0C,CAACJ,mBAAmB,CAACK,CAApB,CAAsBH,OAAtB,EAA+BE,GAA/B,CAA9C,EAAmF;QAC/F;QAAaE,MAAM,CAACC,cAAP,CAAsBL,OAAtB,EAA+BE,GAA/B,EAAoC;UAAEI,UAAU,EAAE,IAAd;UAAoBC,GAAG,EAAEN,UAAU,CAACC,GAAD;QAAnC,CAApC;QACb;MAAa;MACb;;IAAY;IACZ;;EAAW,CAND;EAOV;;AAAU,CATD;AAUT;;AACA;;AAAS;;AACT;;;AAAS,CAAC,MAAM;EAChB;EAAUJ,mBAAmB,CAACK,CAApB,GAAwB,CAACK,GAAD,EAAMC,IAAN,KAAgBL,MAAM,CAACM,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCJ,GAArC,EAA0CC,IAA1C,CAAxC;EACV;;AAAU,CAFD;AAGT;;AACA;;;AACA,IAAII,mBAAmB,GAAGC,UAAU,CAACC,QAAX,GAAsB,EAAhD,C,CAEA;;;AACAjB,mBAAmB,CAACC,CAApB,CAAsBc,mBAAtB,EAA2C;EACzCG,cAAc,EAAE;EAAO;EAAeA,cADG;EAEzCC,qBAAqB,EAAE;EAAO;EAAeA,qBAFJ;EAGzCC,0BAA0B,EAAE;EAAO;EAAeA,0BAHT;EAIzCC,oBAAoB,EAAE;EAAO;EAAeA,oBAJH;EAKzCC,yBAAyB,EAAE;EAAO;EAAeA,yBALR;EAMzCC,eAAe,EAAE;EAAO;EAAeA,eANE;EAOzCC,cAAc,EAAE;EAAO;EAAeA,cAPG;EAQzCC,mBAAmB,EAAE;EAAO;EAAeA,mBARF;EASzCC,WAAW,EAAE;EAAO;EAAeA,WATM;EAUzCC,aAAa,EAAE;EAAO;EAAeA,aAVI;EAWzCC,SAAS,EAAE;EAAO;EAAeA,SAXQ;EAYzCC,WAAW,EAAE;EAAO;EAAeC,gBAZM;EAazCC,mBAAmB,EAAE;EAAO;EAAeA,mBAbF;EAczCC,SAAS,EAAE;EAAO;EAAeC,cAdQ;EAezCC,mBAAmB,EAAE;EAAO;EAAeA,mBAfF;EAgBzCC,mBAAmB,EAAE;EAAO;EAAeA,mBAhBF;EAiBzCC,GAAG,EAAE;EAAO;EAAeA,GAjBc;EAkBzCC,qBAAqB,EAAE;EAAO;EAAeA,qBAlBJ;EAmBzCC,aAAa,EAAE;EAAO;EAAeA,aAnBI;EAoBzCC,SAAS,EAAE;EAAO;EAAeA,SApBQ;EAqBzCC,iBAAiB,EAAE;EAAO;EAAeA,iBArBA;EAsBzCC,cAAc,EAAE;EAAO;EAAeA,cAtBG;EAuBzCC,aAAa,EAAE;EAAO;EAAeA,aAvBI;EAwBzCC,2BAA2B,EAAE;EAAO;EAAeA,2BAxBV;EAyBzCC,SAAS,EAAE;EAAO;EAAeA,SAzBQ;EA0BzCC,2BAA2B,EAAE;EAAO;EAAeA,2BA1BV;EA2BzCC,IAAI,EAAE;EAAO;EAAeA,IA3Ba;EA4BzCC,cAAc,EAAE;EAAO;EAAeA,cA5BG;EA6BzCC,QAAQ,EAAE;EAAO;EAAeA,QA7BS;EA8BzCC,KAAK,EAAE;EAAO;EAAeA,KA9BY;EA+BzCC,sBAAsB,EAAE;EAAO;EAAeA,sBA/BL;EAgCzCC,SAAS,EAAE;EAAO;EAAeA,SAhCQ;EAiCzCC,WAAW,EAAE;EAAO;EAAeA,WAjCM;EAkCzCC,kBAAkB,EAAE;EAAO;EAAeA,kBAlCD;EAmCzCC,qBAAqB,EAAE;EAAO;EAAeA,qBAnCJ;EAoCzCC,kBAAkB,EAAE;EAAO;EAAeA,kBApCD;EAqCzCC,YAAY,EAAE;EAAO;EAAeA,YArCK;EAsCzCC,SAAS,EAAE;EAAO;EAAeA,SAtCQ;EAuCzCC,aAAa,EAAE;EAAO;EAAeA,aAvCI;EAwCzCC,gBAAgB,EAAE;EAAO;EAAeA,gBAxCC;EAyCzCC,kBAAkB,EAAE;EAAO;EAAeA,kBAzCD;EA0CzCC,MAAM,EAAE;EAAO;EAAeA,MA1CW;EA2CzCC,OAAO,EAAE;EAAO;EAAeA;AA3CU,CAA3C;;AA8CA,C,CAAC;;AACD,MAAMC,QAAQ,GAAG,OAAOC,OAAP,KAAmB,QAAnB,IAA+BA,OAAO,GAAG,EAAV,KAAiB,kBAAhD,IAAsE,CAACA,OAAO,CAACC,QAAR,CAAiBC,EAAxF,IAA8F,EAAEF,OAAO,CAACC,QAAR,CAAiBE,QAAjB,IAA6BH,OAAO,CAACI,IAArC,IAA6CJ,OAAO,CAACI,IAAR,KAAiB,SAAhE,CAA/G;AACA,MAAMC,eAAe,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CAAxB;AACA,MAAMC,oBAAoB,GAAG,CAAC,KAAD,EAAQ,CAAR,EAAW,CAAX,EAAc,KAAd,EAAqB,CAArB,EAAwB,CAAxB,CAA7B;AACA,MAAMC,uBAAuB,GAAG,IAAhC;AACA,MAAMC,WAAW,GAAG,IAApB;AACA,MAAMC,mBAAmB,GAAG,IAA5B;AACA,MAAMC,eAAe,GAAGD,mBAAmB,GAAGD,WAA9C;AACA,MAAMG,mBAAmB,GAAG;EAC1BC,GAAG,EAAE,IADqB;EAE1BC,OAAO,EAAE,IAFiB;EAG1BC,KAAK,EAAE,IAHmB;EAI1BC,IAAI,EAAE,IAJoB;EAK1BC,iBAAiB,EAAE,IALO;EAM1BC,mBAAmB,EAAE,IANK;EAO1BC,mBAAmB,EAAE,IAPK;EAQ1BC,UAAU,EAAE,IARc;EAS1BC,MAAM,EAAE;AATkB,CAA5B;AAWA,MAAM5D,cAAc,GAAG;EACrB6D,OAAO,EAAE,CADY;EAErBC,MAAM,EAAE,CAFa;EAGrBC,YAAY,EAAE,CAHO;EAIrBC,cAAc,EAAE;AAJK,CAAvB;AAMA,MAAMC,sBAAsB,GAAG,wBAA/B;AACA,MAAMpE,oBAAoB,GAAG;EAC3BgE,OAAO,EAAE,CAAC,CADiB;EAE3BK,IAAI,EAAE,CAFqB;EAG3BC,QAAQ,EAAE,CAHiB;EAI3BC,SAAS,EAAE,CAJgB;EAK3BC,KAAK,EAAE,EALoB;EAM3BC,GAAG,EAAE;AANsB,CAA7B;AAQA,MAAM1E,0BAA0B,GAAG;EACjC2E,MAAM,EAAE,CADyB;EAEjCC,MAAM,EAAE,CAFyB;EAGjCC,aAAa,EAAE,EAHkB;EAIjCC,cAAc,EAAE,EAJiB;EAKjCC,gBAAgB,EAAE,EALe;EAMjCC,SAAS,EAAE,EANsB;EAOjCC,aAAa,EAAE,EAPkB;EAQjCC,WAAW,EAAE,EARoB;EASjCC,eAAe,EAAE,EATgB;EAUjCC,uBAAuB,EAAE,EAVQ;EAWjCC,mBAAmB,EAAE,EAXY;EAYjCC,cAAc,EAAE,EAZiB;EAajCC,kBAAkB,EAAE;AAba,CAAnC;AAeA,MAAMlE,cAAc,GAAG;EACrBqC,KAAK,EAAE,IADc;EAErB8B,eAAe,EAAE,IAFI;EAGrBC,IAAI,EAAE,IAHe;EAIrBC,kBAAkB,EAAE,IAJC;EAKrBC,sBAAsB,EAAE,KALH;EAMrBC,sBAAsB,EAAE,KANH;EAOrBC,QAAQ,EAAE,KAPW;EAQrBC,kBAAkB,EAAE;AARC,CAAvB;AAUA,MAAMC,iBAAiB,GAAG;EACxBC,IAAI,EAAE,CADkB;EAExBC,MAAM,EAAE,CAFgB;EAGxBC,WAAW,EAAE,CAHW;EAIxBC,SAAS,EAAE,CAJa;EAKxBC,gBAAgB,EAAE,CALM;EAMxBC,kBAAkB,EAAE,CANI;EAOxBC,uBAAuB,EAAE,CAPD;EAQxBC,WAAW,EAAE,CARW;EASxBC,gBAAgB,EAAE,CATM;EAUxBC,gBAAgB,EAAE;AAVM,CAA1B;AAYA,MAAM5F,cAAc,GAAG;EACrB6F,cAAc,EAAE,CADK;EAErBC,SAAS,EAAE,CAFU;EAGrBC,UAAU,EAAE;AAHS,CAAvB;AAKA,MAAMC,cAAc,GAAG;EACrBC,IAAI,EAAE,CADe;EAErBC,IAAI,EAAE,CAFe;EAGrBxC,QAAQ,EAAE,CAHW;EAIrByC,IAAI,EAAE,CAJe;EAKrBC,MAAM,EAAE,CALa;EAMrBC,MAAM,EAAE,CANa;EAOrBC,OAAO,EAAE,CAPY;EAQrBC,QAAQ,EAAE,CARW;EASrB5C,SAAS,EAAE,CATU;EAUrB6C,SAAS,EAAE,EAVU;EAWrBC,QAAQ,EAAE,EAXW;EAYrBC,SAAS,EAAE,EAZU;EAarB9C,KAAK,EAAE,EAbc;EAcrB+C,KAAK,EAAE,EAdc;EAerB9C,GAAG,EAAE,EAfgB;EAgBrB+C,KAAK,EAAE,EAhBc;EAiBrBC,cAAc,EAAE,EAjBK;EAkBrBC,KAAK,EAAE,EAlBc;EAmBrBC,KAAK,EAAE,EAnBc;EAoBrBC,MAAM,EAAE,EApBa;EAqBrBC,MAAM,EAAE,EArBa;EAsBrBC,WAAW,EAAE,EAtBQ;EAuBrBC,OAAO,EAAE,EAvBY;EAwBrBC,SAAS,EAAE,EAxBU;EAyBrBC,MAAM,EAAE,EAzBa;EA0BrBC,MAAM,EAAE;AA1Ba,CAAvB;AA4BA,MAAMC,mBAAmB,GAAG;EAC1BC,KAAK,EAAE,OADmB;EAE1BC,KAAK,EAAE;AAFmB,CAA5B;AAIA,MAAMC,cAAc,GAAG;EACrBpC,SAAS,EAAE,IADU;EAErBqC,MAAM,EAAE,IAFa;EAGrB9E,KAAK,EAAE,IAHc;EAIrB+E,MAAM,EAAE,IAJa;EAKrBC,QAAQ,EAAE,IALW;EAMrBC,MAAM,EAAE,IANa;EAOrBC,QAAQ,EAAE,IAPW;EAQrBC,MAAM,EAAE,IARa;EASrBC,YAAY,EAAE,KATO;EAUrBC,cAAc,EAAE;AAVK,CAAvB;AAYA,MAAMC,mBAAmB,GAAG;EAC1BJ,QAAQ,EAAE,SADgB;EAE1BK,QAAQ,EAAE,SAFgB;EAG1BC,QAAQ,EAAE,SAHgB;EAI1BC,SAAS,EAAE,SAJe;EAK1BC,QAAQ,EAAE,SALgB;EAM1BC,aAAa,EAAE,SANW;EAO1BC,KAAK,EAAE,SAPmB;EAQ1BC,UAAU,EAAE,SARc;EAS1BC,KAAK,EAAE,SATmB;EAU1BC,IAAI,EAAE,SAVoB;EAW1BC,IAAI,EAAE,SAXoB;EAY1BC,UAAU,EAAE,SAZc;EAa1BC,WAAW,EAAE,SAba;EAc1BC,eAAe,EAAE,SAdS;EAe1BC,WAAW,EAAE,SAfa;EAgB1BC,IAAI,EAAE,SAhBoB;EAiB1BC,QAAQ,EAAE,SAjBgB;EAkB1BC,cAAc,EAAE,SAlBU;EAmB1BC,iBAAiB,EAAE;AAnBO,CAA5B;AAqBA,MAAMC,yBAAyB,GAAG;EAChCC,KAAK,EAAE,CADyB;EAEhCC,MAAM,EAAE,CAFwB;EAGhCC,OAAO,EAAE,CAHuB;EAIhCC,KAAK,EAAE,CAJyB;EAKhClD,SAAS,EAAE;AALqB,CAAlC;AAOA,MAAMmD,yBAAyB,GAAG;EAChCC,CAAC,EAAE,aAD6B;EAEhCC,CAAC,EAAE,YAF6B;EAGhCC,CAAC,EAAE,YAH6B;EAIhCC,CAAC,EAAE,UAJ6B;EAKhCC,EAAE,EAAE,OAL4B;EAMhCC,EAAE,EAAE,MAN4B;EAOhCC,EAAE,EAAE,UAP4B;EAQhCC,EAAE,EAAE,WAR4B;EAShCC,EAAE,EAAE,aAT4B;EAUhCC,EAAE,EAAE,eAV4B;EAWhCC,CAAC,EAAE,WAX6B;EAYhCC,CAAC,EAAE,QAZ6B;EAahCC,CAAC,EAAE,UAb6B;EAchCC,CAAC,EAAE;AAd6B,CAAlC;AAgBA,MAAMC,uBAAuB,GAAG;EAC9BC,EAAE,EAAE,WAD0B;EAE9BC,EAAE,EAAE,UAF0B;EAG9BC,EAAE,EAAE,SAH0B;EAI9BC,EAAE,EAAE,WAJ0B;EAK9BC,EAAE,EAAE;AAL0B,CAAhC;AAOA,MAAMC,mBAAmB,GAAG;EAC1BC,CAAC,EAAE,UADuB;EAE1BR,CAAC,EAAE;AAFuB,CAA5B;AAIA,MAAM3J,cAAc,GAAG;EACrBoK,MAAM,EAAE,CADa;EAErBC,QAAQ,EAAE,CAFW;EAGrBC,KAAK,EAAE;AAHc,CAAvB;AAKA,MAAM5L,mBAAmB,GAAG;EAC1BiE,IAAI,EAAE,CADoB;EAE1B4H,MAAM,EAAE;AAFkB,CAA5B;AAIA,MAAMlL,GAAG,GAAG;EACVmL,UAAU,EAAE,CADF;EAEVC,YAAY,EAAE,CAFJ;EAGVC,UAAU,EAAE,CAHF;EAIVC,WAAW,EAAE,CAJH;EAKVC,aAAa,EAAE,CALL;EAMVC,OAAO,EAAE,CANC;EAOVC,kBAAkB,EAAE,CAPV;EAQVC,WAAW,EAAE,CARH;EASVC,SAAS,EAAE,CATD;EAUVC,IAAI,EAAE,EAVI;EAWVC,OAAO,EAAE,EAXC;EAYVC,SAAS,EAAE,EAZD;EAaVC,MAAM,EAAE,EAbE;EAcVC,MAAM,EAAE,EAdE;EAeVC,OAAO,EAAE,EAfC;EAgBVC,QAAQ,EAAE,EAhBA;EAiBVC,QAAQ,EAAE,EAjBA;EAkBVC,SAAS,EAAE,EAlBD;EAmBVC,SAAS,EAAE,EAnBD;EAoBVC,MAAM,EAAE,EApBE;EAqBVC,WAAW,EAAE,EArBH;EAsBVC,IAAI,EAAE,EAtBI;EAuBVC,MAAM,EAAE,EAvBE;EAwBVC,UAAU,EAAE,EAxBF;EAyBVC,YAAY,EAAE,EAzBJ;EA0BVC,eAAe,EAAE,EA1BP;EA2BVC,iBAAiB,EAAE,EA3BT;EA4BVC,OAAO,EAAE,EA5BC;EA6BVC,IAAI,EAAE,EA7BI;EA8BVC,MAAM,EAAE,EA9BE;EA+BVC,SAAS,EAAE,EA/BD;EAgCVC,OAAO,EAAE,EAhCC;EAiCVC,cAAc,EAAE,EAjCN;EAkCVC,cAAc,EAAE,EAlCN;EAmCVC,SAAS,EAAE,EAnCD;EAoCVC,UAAU,EAAE,EApCF;EAqCVC,OAAO,EAAE,EArCC;EAsCVC,oBAAoB,EAAE,EAtCZ;EAuCVC,WAAW,EAAE,EAvCH;EAwCVC,QAAQ,EAAE,EAxCA;EAyCVC,kBAAkB,EAAE,EAzCV;EA0CVC,aAAa,EAAE,EA1CL;EA2CVC,QAAQ,EAAE,EA3CA;EA4CVC,QAAQ,EAAE,EA5CA;EA6CVC,cAAc,EAAE,EA7CN;EA8CVC,gBAAgB,EAAE,EA9CR;EA+CVC,0BAA0B,EAAE,EA/ClB;EAgDVC,YAAY,EAAE,EAhDJ;EAiDVC,qBAAqB,EAAE,EAjDb;EAkDVC,mBAAmB,EAAE,EAlDX;EAmDVC,iBAAiB,EAAE,EAnDT;EAoDVC,cAAc,EAAE,EApDN;EAqDVC,eAAe,EAAE,EArDP;EAsDVC,YAAY,EAAE,EAtDJ;EAuDVC,aAAa,EAAE,EAvDL;EAwDVC,aAAa,EAAE,EAxDL;EAyDVC,WAAW,EAAE,EAzDH;EA0DVC,iBAAiB,EAAE,EA1DT;EA2DVC,eAAe,EAAE,EA3DP;EA4DVC,kBAAkB,EAAE,EA5DV;EA6DVC,gBAAgB,EAAE,EA7DR;EA8DVC,WAAW,EAAE,EA9DH;EA+DVC,gBAAgB,EAAE,EA/DR;EAgEVC,cAAc,EAAE,EAhEN;EAiEVC,cAAc,EAAE,EAjEN;EAkEVC,YAAY,EAAE,EAlEJ;EAmEVC,SAAS,EAAE,EAnED;EAoEVC,cAAc,EAAE,EApEN;EAqEVC,kBAAkB,EAAE,EArEV;EAsEVC,uBAAuB,EAAE,EAtEf;EAuEVC,gBAAgB,EAAE,EAvER;EAwEVC,WAAW,EAAE,EAxEH;EAyEVC,SAAS,EAAE,EAzED;EA0EVC,qBAAqB,EAAE,EA1Eb;EA2EVC,mBAAmB,EAAE,EA3EX;EA4EVC,UAAU,EAAE,EA5EF;EA6EVC,QAAQ,EAAE,EA7EA;EA8EVC,eAAe,EAAE,EA9EP;EA+EVC,aAAa,EAAE,EA/EL;EAgFVC,qBAAqB,EAAE,EAhFb;EAiFVC,0BAA0B,EAAE,EAjFlB;EAkFVC,iBAAiB,EAAE,EAlFT;EAmFVC,uBAAuB,EAAE,EAnFf;EAoFVC,4BAA4B,EAAE,EApFpB;EAqFVC,uBAAuB,EAAE,EArFf;EAsFVC,2BAA2B,EAAE,EAtFnB;EAuFVC,wBAAwB,EAAE,EAvFhB;EAwFVC,aAAa,EAAE,EAxFL;EAyFVC,oBAAoB,EAAE,EAzFZ;EA0FVC,kBAAkB,EAAE;AA1FV,CAAZ;AA4FA,MAAMxQ,iBAAiB,GAAG;EACxByQ,aAAa,EAAE,CADS;EAExBC,kBAAkB,EAAE;AAFI,CAA1B;AAIA,IAAIC,SAAS,GAAGpQ,cAAc,CAACqK,QAA/B;;AACA,SAASgG,iBAAT,CAA2BC,KAA3B,EAAkC;EAChC,IAAIC,MAAM,CAACC,SAAP,CAAiBF,KAAjB,CAAJ,EAA6B;IAC3BF,SAAS,GAAGE,KAAZ;EACD;AACF;;AACD,SAASG,iBAAT,GAA6B;EAC3B,OAAOL,SAAP;AACD;;AACD,SAASM,IAAT,CAAcC,GAAd,EAAmB;EACjB,IAAIP,SAAS,IAAIpQ,cAAc,CAACsK,KAAhC,EAAuC;IACrCsG,OAAO,CAACC,GAAR,CAAa,SAAQF,GAAI,EAAzB;EACD;AACF;;AACD,SAASG,IAAT,CAAcH,GAAd,EAAmB;EACjB,IAAIP,SAAS,IAAIpQ,cAAc,CAACqK,QAAhC,EAA0C;IACxCuG,OAAO,CAACC,GAAR,CAAa,YAAWF,GAAI,EAA5B;EACD;AACF;;AACD,SAASI,WAAT,CAAqBJ,GAArB,EAA0B;EACxB,MAAM,IAAIK,KAAJ,CAAUL,GAAV,CAAN;AACD;;AACD,SAASM,MAAT,CAAgBC,IAAhB,EAAsBP,GAAtB,EAA2B;EACzB,IAAI,CAACO,IAAL,EAAW;IACTH,WAAW,CAACJ,GAAD,CAAX;EACD;AACF;;AACD,SAASQ,gBAAT,CAA0BC,GAA1B,EAA+B;EAC7B,QAAQA,GAAG,EAAEC,QAAb;IACE,KAAK,OAAL;IACA,KAAK,QAAL;IACA,KAAK,MAAL;IACA,KAAK,SAAL;IACA,KAAK,MAAL;MACE,OAAO,IAAP;;IACF;MACE,OAAO,KAAP;EARJ;AAUD;;AACD,SAASlR,sBAAT,CAAgCiR,GAAhC,EAAqCE,OAAO,GAAG,IAA/C,EAAqDC,OAAO,GAAG,IAA/D,EAAqE;EACnE,IAAI,CAACH,GAAL,EAAU;IACR,OAAO,IAAP;EACD;;EACD,IAAI;IACF,IAAIG,OAAO,IAAI,OAAOH,GAAP,KAAe,QAA9B,EAAwC;MACtC,IAAIG,OAAO,CAACC,kBAAR,IAA8BJ,GAAG,CAACK,UAAJ,CAAe,MAAf,CAAlC,EAA0D;QACxD,MAAMC,IAAI,GAAGN,GAAG,CAACO,KAAJ,CAAU,KAAV,CAAb;;QACA,IAAID,IAAI,EAAEE,MAAN,IAAgB,CAApB,EAAuB;UACrBR,GAAG,GAAI,UAASA,GAAI,EAApB;QACD;MACF;;MACD,IAAIG,OAAO,CAACM,kBAAZ,EAAgC;QAC9B,IAAI;UACFT,GAAG,GAAGU,kBAAkB,CAACV,GAAD,CAAxB;QACD,CAFD,CAEE,MAAM,CAAE;MACX;IACF;;IACD,MAAMW,WAAW,GAAGT,OAAO,GAAG,IAAIU,GAAJ,CAAQZ,GAAR,EAAaE,OAAb,CAAH,GAA2B,IAAIU,GAAJ,CAAQZ,GAAR,CAAtD;;IACA,IAAID,gBAAgB,CAACY,WAAD,CAApB,EAAmC;MACjC,OAAOA,WAAP;IACD;EACF,CAlBD,CAkBE,MAAM,CAAE;;EACV,OAAO,IAAP;AACD;;AACD,SAASjR,MAAT,CAAgBnD,GAAhB,EAAqBC,IAArB,EAA2BqU,KAA3B,EAAkCC,eAAe,GAAG,KAApD,EAA2D;EACzD3U,MAAM,CAACC,cAAP,CAAsBG,GAAtB,EAA2BC,IAA3B,EAAiC;IAC/BqU,KAD+B;IAE/BxU,UAAU,EAAE,CAACyU,eAFkB;IAG/BC,YAAY,EAAE,IAHiB;IAI/BC,QAAQ,EAAE;EAJqB,CAAjC;EAMA,OAAOH,KAAP;AACD;;AACD,MAAMI,aAAa,GAAG,SAASC,oBAAT,GAAgC;EACpD,SAASD,aAAT,CAAuBE,OAAvB,EAAgCC,IAAhC,EAAsC;IACpC,KAAKD,OAAL,GAAeA,OAAf;IACA,KAAKC,IAAL,GAAYA,IAAZ;EACD;;EACDH,aAAa,CAACxU,SAAd,GAA0B,IAAImT,KAAJ,EAA1B;EACAqB,aAAa,CAACI,WAAd,GAA4BJ,aAA5B;EACA,OAAOA,aAAP;AACD,CARqB,EAAtB;;AASA,MAAMK,iBAAN,SAAgCL,aAAhC,CAA8C;EAC5CI,WAAW,CAAC9B,GAAD,EAAMgC,IAAN,EAAY;IACrB,MAAMhC,GAAN,EAAW,mBAAX;IACA,KAAKgC,IAAL,GAAYA,IAAZ;EACD;;AAJ2C;;AAM9C,MAAMC,qBAAN,SAAoCP,aAApC,CAAkD;EAChDI,WAAW,CAAC9B,GAAD,EAAMkC,OAAN,EAAe;IACxB,MAAMlC,GAAN,EAAW,uBAAX;IACA,KAAKkC,OAAL,GAAeA,OAAf;EACD;;AAJ+C;;AAMlD,MAAM1T,mBAAN,SAAkCkT,aAAlC,CAAgD;EAC9CI,WAAW,CAAC9B,GAAD,EAAM;IACf,MAAMA,GAAN,EAAW,qBAAX;EACD;;AAH6C;;AAKhD,MAAMvR,mBAAN,SAAkCiT,aAAlC,CAAgD;EAC9CI,WAAW,CAAC9B,GAAD,EAAM;IACf,MAAMA,GAAN,EAAW,qBAAX;EACD;;AAH6C;;AAKhD,MAAM7Q,2BAAN,SAA0CuS,aAA1C,CAAwD;EACtDI,WAAW,CAAC9B,GAAD,EAAMmC,MAAN,EAAc;IACvB,MAAMnC,GAAN,EAAW,6BAAX;IACA,KAAKmC,MAAL,GAAcA,MAAd;EACD;;AAJqD;;AAMxD,MAAMC,WAAN,SAA0BV,aAA1B,CAAwC;EACtCI,WAAW,CAAC9B,GAAD,EAAM;IACf,MAAMA,GAAN,EAAW,aAAX;EACD;;AAHqC;;AAKxC,MAAMxS,cAAN,SAA6BkU,aAA7B,CAA2C;EACzCI,WAAW,CAAC9B,GAAD,EAAM;IACf,MAAMA,GAAN,EAAW,gBAAX;EACD;;AAHwC;;AAK3C,SAASqC,aAAT,CAAuBC,KAAvB,EAA8B;EAC5B,IAAI,OAAOA,KAAP,KAAiB,QAAjB,IAA6BA,KAAK,EAAErB,MAAP,KAAkBsB,SAAnD,EAA8D;IAC5DnC,WAAW,CAAC,oCAAD,CAAX;EACD;;EACD,MAAMa,MAAM,GAAGqB,KAAK,CAACrB,MAArB;EACA,MAAMuB,kBAAkB,GAAG,IAA3B;;EACA,IAAIvB,MAAM,GAAGuB,kBAAb,EAAiC;IAC/B,OAAOC,MAAM,CAACC,YAAP,CAAoBC,KAApB,CAA0B,IAA1B,EAAgCL,KAAhC,CAAP;EACD;;EACD,MAAMM,MAAM,GAAG,EAAf;;EACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5B,MAApB,EAA4B4B,CAAC,IAAIL,kBAAjC,EAAqD;IACnD,MAAMM,QAAQ,GAAGC,IAAI,CAACC,GAAL,CAASH,CAAC,GAAGL,kBAAb,EAAiCvB,MAAjC,CAAjB;IACA,MAAMgC,KAAK,GAAGX,KAAK,CAACY,QAAN,CAAeL,CAAf,EAAkBC,QAAlB,CAAd;IACAF,MAAM,CAACO,IAAP,CAAYV,MAAM,CAACC,YAAP,CAAoBC,KAApB,CAA0B,IAA1B,EAAgCM,KAAhC,CAAZ;EACD;;EACD,OAAOL,MAAM,CAACQ,IAAP,CAAY,EAAZ,CAAP;AACD;;AACD,SAASC,aAAT,CAAuBC,GAAvB,EAA4B;EAC1B,IAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;IAC3BlD,WAAW,CAAC,oCAAD,CAAX;EACD;;EACD,MAAMa,MAAM,GAAGqC,GAAG,CAACrC,MAAnB;EACA,MAAMqB,KAAK,GAAG,IAAIiB,UAAJ,CAAetC,MAAf,CAAd;;EACA,KAAK,IAAI4B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5B,MAApB,EAA4B,EAAE4B,CAA9B,EAAiC;IAC/BP,KAAK,CAACO,CAAD,CAAL,GAAWS,GAAG,CAACE,UAAJ,CAAeX,CAAf,IAAoB,IAA/B;EACD;;EACD,OAAOP,KAAP;AACD;;AACD,SAASmB,QAAT,CAAkBnC,KAAlB,EAAyB;EACvB,OAAOmB,MAAM,CAACC,YAAP,CAAoBpB,KAAK,IAAI,EAAT,GAAc,IAAlC,EAAwCA,KAAK,IAAI,EAAT,GAAc,IAAtD,EAA4DA,KAAK,IAAI,CAAT,GAAa,IAAzE,EAA+EA,KAAK,GAAG,IAAvF,CAAP;AACD;;AACD,SAASoC,UAAT,CAAoB1W,GAApB,EAAyB;EACvB,OAAOJ,MAAM,CAAC+W,IAAP,CAAY3W,GAAZ,EAAiBiU,MAAxB;AACD;;AACD,SAAS2C,aAAT,CAAuBC,GAAvB,EAA4B;EAC1B,MAAM7W,GAAG,GAAGJ,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAZ;;EACA,KAAK,MAAM,CAACpX,GAAD,EAAM4U,KAAN,CAAX,IAA2BuC,GAA3B,EAAgC;IAC9B7W,GAAG,CAACN,GAAD,CAAH,GAAW4U,KAAX;EACD;;EACD,OAAOtU,GAAP;AACD;;AACD,SAAS+W,cAAT,GAA0B;EACxB,MAAMC,OAAO,GAAG,IAAIT,UAAJ,CAAe,CAAf,CAAhB;EACAS,OAAO,CAAC,CAAD,CAAP,GAAa,CAAb;EACA,MAAMC,MAAM,GAAG,IAAIC,WAAJ,CAAgBF,OAAO,CAACG,MAAxB,EAAgC,CAAhC,EAAmC,CAAnC,CAAf;EACA,OAAOF,MAAM,CAAC,CAAD,CAAN,KAAc,CAArB;AACD;;AACD,SAASG,eAAT,GAA2B;EACzB,IAAI;IACF,IAAIC,QAAJ,CAAa,EAAb;IACA,OAAO,IAAP;EACD,CAHD,CAGE,MAAM;IACN,OAAO,KAAP;EACD;AACF;;AACD,MAAMjW,gBAAN,CAAuB;EACI,WAAd2V,cAAc,GAAG;IAC1B,OAAO5T,MAAM,CAAC,IAAD,EAAO,gBAAP,EAAyB4T,cAAc,EAAvC,CAAb;EACD;;EACyB,WAAfK,eAAe,GAAG;IAC3B,OAAOjU,MAAM,CAAC,IAAD,EAAO,iBAAP,EAA0BiU,eAAe,EAAzC,CAAb;EACD;;EACoC,WAA1BE,0BAA0B,GAAG;IACtC,OAAOnU,MAAM,CAAC,IAAD,EAAO,4BAAP,EAAqC,OAAOoU,eAAP,KAA2B,WAAhE,CAAb;EACD;;EACkB,WAARC,QAAQ,GAAG;IACpB,IAAI,OAAOC,SAAP,KAAqB,WAArB,IAAoC,OAAOA,SAAS,EAAED,QAAlB,KAA+B,QAAvE,EAAiF;MAC/E,OAAOrU,MAAM,CAAC,IAAD,EAAO,UAAP,EAAmB;QAC9BuU,KAAK,EAAED,SAAS,CAACD,QAAV,CAAmBG,QAAnB,CAA4B,KAA5B;MADuB,CAAnB,CAAb;IAGD;;IACD,OAAOxU,MAAM,CAAC,IAAD,EAAO,UAAP,EAAmB;MAC9BuU,KAAK,EAAE;IADuB,CAAnB,CAAb;EAGD;;EAC6B,WAAnBE,mBAAmB,GAAG;IAC/B,OAAOzU,MAAM,CAAC,IAAD,EAAO,qBAAP,EAA8B7C,UAAU,CAACuX,GAAX,EAAgBC,QAAhB,GAA2B,0BAA3B,CAA9B,CAAb;EACD;;AAtBoB;;AAwBvB,MAAMC,UAAU,GAAGC,KAAK,CAACC,IAAN,CAAWD,KAAK,CAAC,GAAD,CAAL,CAAWrB,IAAX,EAAX,EAA8BuB,CAAC,IAAIA,CAAC,CAACC,QAAF,CAAW,EAAX,EAAeC,QAAf,CAAwB,CAAxB,EAA2B,GAA3B,CAAnC,CAAnB;;AACA,MAAMhW,IAAN,CAAW;EACU,OAAZiW,YAAY,CAACC,CAAD,EAAIC,CAAJ,EAAOC,CAAP,EAAU;IAC3B,OAAQ,IAAGT,UAAU,CAACO,CAAD,CAAI,GAAEP,UAAU,CAACQ,CAAD,CAAI,GAAER,UAAU,CAACS,CAAD,CAAI,EAAzD;EACD;;EACiB,OAAXC,WAAW,CAACjL,SAAD,EAAYkL,MAAZ,EAAoB;IACpC,IAAIC,IAAJ;;IACA,IAAInL,SAAS,CAAC,CAAD,CAAb,EAAkB;MAChB,IAAIA,SAAS,CAAC,CAAD,CAAT,GAAe,CAAnB,EAAsB;QACpBmL,IAAI,GAAGD,MAAM,CAAC,CAAD,CAAb;QACAA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAlB;QACAA,MAAM,CAAC,CAAD,CAAN,GAAYC,IAAZ;MACD;;MACDD,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;MACAkL,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;;MACA,IAAIA,SAAS,CAAC,CAAD,CAAT,GAAe,CAAnB,EAAsB;QACpBmL,IAAI,GAAGD,MAAM,CAAC,CAAD,CAAb;QACAA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAlB;QACAA,MAAM,CAAC,CAAD,CAAN,GAAYC,IAAZ;MACD;;MACDD,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;MACAkL,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;IACD,CAfD,MAeO;MACLmL,IAAI,GAAGD,MAAM,CAAC,CAAD,CAAb;MACAA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAlB;MACAA,MAAM,CAAC,CAAD,CAAN,GAAYC,IAAZ;MACAA,IAAI,GAAGD,MAAM,CAAC,CAAD,CAAb;MACAA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAlB;MACAA,MAAM,CAAC,CAAD,CAAN,GAAYC,IAAZ;;MACA,IAAInL,SAAS,CAAC,CAAD,CAAT,GAAe,CAAnB,EAAsB;QACpBmL,IAAI,GAAGD,MAAM,CAAC,CAAD,CAAb;QACAA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAlB;QACAA,MAAM,CAAC,CAAD,CAAN,GAAYC,IAAZ;MACD;;MACDD,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;MACAkL,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;;MACA,IAAIA,SAAS,CAAC,CAAD,CAAT,GAAe,CAAnB,EAAsB;QACpBmL,IAAI,GAAGD,MAAM,CAAC,CAAD,CAAb;QACAA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAlB;QACAA,MAAM,CAAC,CAAD,CAAN,GAAYC,IAAZ;MACD;;MACDD,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;MACAkL,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;IACD;;IACDkL,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;IACAkL,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;IACAkL,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;IACAkL,MAAM,CAAC,CAAD,CAAN,IAAalL,SAAS,CAAC,CAAD,CAAtB;EACD;;EACe,OAATA,SAAS,CAACoL,EAAD,EAAKC,EAAL,EAAS;IACvB,OAAO,CAACD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgBD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAA3B,EAAgCD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgBD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAA1D,EAA+DD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgBD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAzF,EAA8FD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgBD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAxH,EAA6HD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgBD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAA1B,GAAgCD,EAAE,CAAC,CAAD,CAA/J,EAAoKA,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgBD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAA1B,GAAgCD,EAAE,CAAC,CAAD,CAAtM,CAAP;EACD;;EACoB,OAAdE,cAAc,CAACC,CAAD,EAAIC,CAAJ,EAAO;IAC1B,MAAMC,EAAE,GAAGF,CAAC,CAAC,CAAD,CAAD,GAAOC,CAAC,CAAC,CAAD,CAAR,GAAcD,CAAC,CAAC,CAAD,CAAD,GAAOC,CAAC,CAAC,CAAD,CAAtB,GAA4BA,CAAC,CAAC,CAAD,CAAxC;IACA,MAAME,EAAE,GAAGH,CAAC,CAAC,CAAD,CAAD,GAAOC,CAAC,CAAC,CAAD,CAAR,GAAcD,CAAC,CAAC,CAAD,CAAD,GAAOC,CAAC,CAAC,CAAD,CAAtB,GAA4BA,CAAC,CAAC,CAAD,CAAxC;IACA,OAAO,CAACC,EAAD,EAAKC,EAAL,CAAP;EACD;;EAC2B,OAArBC,qBAAqB,CAACJ,CAAD,EAAIC,CAAJ,EAAO;IACjC,MAAMzZ,CAAC,GAAGyZ,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAhC;IACA,MAAMC,EAAE,GAAG,CAACF,CAAC,CAAC,CAAD,CAAD,GAAOC,CAAC,CAAC,CAAD,CAAR,GAAcD,CAAC,CAAC,CAAD,CAAD,GAAOC,CAAC,CAAC,CAAD,CAAtB,GAA4BA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAApC,GAA0CA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAnD,IAA0DzZ,CAArE;IACA,MAAM2Z,EAAE,GAAG,CAAC,CAACH,CAAC,CAAC,CAAD,CAAF,GAAQC,CAAC,CAAC,CAAD,CAAT,GAAeD,CAAC,CAAC,CAAD,CAAD,GAAOC,CAAC,CAAC,CAAD,CAAvB,GAA6BA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAArC,GAA2CA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAApD,IAA2DzZ,CAAtE;IACA,OAAO,CAAC0Z,EAAD,EAAKC,EAAL,CAAP;EACD;;EACgC,OAA1BE,0BAA0B,CAACd,CAAD,EAAIU,CAAJ,EAAO;IACtC,MAAMK,EAAE,GAAG,KAAKP,cAAL,CAAoBR,CAApB,EAAuBU,CAAvB,CAAX;IACA,MAAMM,EAAE,GAAG,KAAKR,cAAL,CAAoBR,CAAC,CAACiB,KAAF,CAAQ,CAAR,EAAW,CAAX,CAApB,EAAmCP,CAAnC,CAAX;IACA,MAAMQ,EAAE,GAAG,KAAKV,cAAL,CAAoB,CAACR,CAAC,CAAC,CAAD,CAAF,EAAOA,CAAC,CAAC,CAAD,CAAR,CAApB,EAAkCU,CAAlC,CAAX;IACA,MAAMS,EAAE,GAAG,KAAKX,cAAL,CAAoB,CAACR,CAAC,CAAC,CAAD,CAAF,EAAOA,CAAC,CAAC,CAAD,CAAR,CAApB,EAAkCU,CAAlC,CAAX;IACA,OAAO,CAACjD,IAAI,CAACC,GAAL,CAASqD,EAAE,CAAC,CAAD,CAAX,EAAgBC,EAAE,CAAC,CAAD,CAAlB,EAAuBE,EAAE,CAAC,CAAD,CAAzB,EAA8BC,EAAE,CAAC,CAAD,CAAhC,CAAD,EAAuC1D,IAAI,CAACC,GAAL,CAASqD,EAAE,CAAC,CAAD,CAAX,EAAgBC,EAAE,CAAC,CAAD,CAAlB,EAAuBE,EAAE,CAAC,CAAD,CAAzB,EAA8BC,EAAE,CAAC,CAAD,CAAhC,CAAvC,EAA6E1D,IAAI,CAAC2D,GAAL,CAASL,EAAE,CAAC,CAAD,CAAX,EAAgBC,EAAE,CAAC,CAAD,CAAlB,EAAuBE,EAAE,CAAC,CAAD,CAAzB,EAA8BC,EAAE,CAAC,CAAD,CAAhC,CAA7E,EAAmH1D,IAAI,CAAC2D,GAAL,CAASL,EAAE,CAAC,CAAD,CAAX,EAAgBC,EAAE,CAAC,CAAD,CAAlB,EAAuBE,EAAE,CAAC,CAAD,CAAzB,EAA8BC,EAAE,CAAC,CAAD,CAAhC,CAAnH,CAAP;EACD;;EACsB,OAAhBE,gBAAgB,CAACX,CAAD,EAAI;IACzB,MAAMzZ,CAAC,GAAGyZ,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAhC;IACA,OAAO,CAACA,CAAC,CAAC,CAAD,CAAD,GAAOzZ,CAAR,EAAW,CAACyZ,CAAC,CAAC,CAAD,CAAF,GAAQzZ,CAAnB,EAAsB,CAACyZ,CAAC,CAAC,CAAD,CAAF,GAAQzZ,CAA9B,EAAiCyZ,CAAC,CAAC,CAAD,CAAD,GAAOzZ,CAAxC,EAA2C,CAACyZ,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAvB,IAA8BzZ,CAAzE,EAA4E,CAACyZ,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAvB,IAA8BzZ,CAA1G,CAAP;EACD;;EACmC,OAA7Bqa,6BAA6B,CAACZ,CAAD,EAAI;IACtC,MAAMa,SAAS,GAAG,CAACb,CAAC,CAAC,CAAD,CAAF,EAAOA,CAAC,CAAC,CAAD,CAAR,EAAaA,CAAC,CAAC,CAAD,CAAd,EAAmBA,CAAC,CAAC,CAAD,CAApB,CAAlB;IACA,MAAMc,CAAC,GAAGd,CAAC,CAAC,CAAD,CAAD,GAAOa,SAAS,CAAC,CAAD,CAAhB,GAAsBb,CAAC,CAAC,CAAD,CAAD,GAAOa,SAAS,CAAC,CAAD,CAAhD;IACA,MAAMrB,CAAC,GAAGQ,CAAC,CAAC,CAAD,CAAD,GAAOa,SAAS,CAAC,CAAD,CAAhB,GAAsBb,CAAC,CAAC,CAAD,CAAD,GAAOa,SAAS,CAAC,CAAD,CAAhD;IACA,MAAME,CAAC,GAAGf,CAAC,CAAC,CAAD,CAAD,GAAOa,SAAS,CAAC,CAAD,CAAhB,GAAsBb,CAAC,CAAC,CAAD,CAAD,GAAOa,SAAS,CAAC,CAAD,CAAhD;IACA,MAAMta,CAAC,GAAGyZ,CAAC,CAAC,CAAD,CAAD,GAAOa,SAAS,CAAC,CAAD,CAAhB,GAAsBb,CAAC,CAAC,CAAD,CAAD,GAAOa,SAAS,CAAC,CAAD,CAAhD;IACA,MAAMG,KAAK,GAAG,CAACF,CAAC,GAAGva,CAAL,IAAU,CAAxB;IACA,MAAM0a,MAAM,GAAGlE,IAAI,CAACmE,IAAL,CAAU,CAACJ,CAAC,GAAGva,CAAL,KAAW,CAAX,GAAe,KAAKua,CAAC,GAAGva,CAAJ,GAAQwa,CAAC,GAAGvB,CAAjB,CAAzB,IAAgD,CAA/D;IACA,MAAM2B,EAAE,GAAGH,KAAK,GAAGC,MAAR,IAAkB,CAA7B;IACA,MAAMG,EAAE,GAAGJ,KAAK,GAAGC,MAAR,IAAkB,CAA7B;IACA,OAAO,CAAClE,IAAI,CAACmE,IAAL,CAAUC,EAAV,CAAD,EAAgBpE,IAAI,CAACmE,IAAL,CAAUE,EAAV,CAAhB,CAAP;EACD;;EACmB,OAAbC,aAAa,CAACC,IAAD,EAAO;IACzB,MAAMhC,CAAC,GAAGgC,IAAI,CAACf,KAAL,CAAW,CAAX,CAAV;;IACA,IAAIe,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAlB,EAAuB;MACrBhC,CAAC,CAAC,CAAD,CAAD,GAAOgC,IAAI,CAAC,CAAD,CAAX;MACAhC,CAAC,CAAC,CAAD,CAAD,GAAOgC,IAAI,CAAC,CAAD,CAAX;IACD;;IACD,IAAIA,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAlB,EAAuB;MACrBhC,CAAC,CAAC,CAAD,CAAD,GAAOgC,IAAI,CAAC,CAAD,CAAX;MACAhC,CAAC,CAAC,CAAD,CAAD,GAAOgC,IAAI,CAAC,CAAD,CAAX;IACD;;IACD,OAAOhC,CAAP;EACD;;EACe,OAATiC,SAAS,CAACC,KAAD,EAAQC,KAAR,EAAe;IAC7B,MAAMC,IAAI,GAAG3E,IAAI,CAAC2D,GAAL,CAAS3D,IAAI,CAACC,GAAL,CAASwE,KAAK,CAAC,CAAD,CAAd,EAAmBA,KAAK,CAAC,CAAD,CAAxB,CAAT,EAAuCzE,IAAI,CAACC,GAAL,CAASyE,KAAK,CAAC,CAAD,CAAd,EAAmBA,KAAK,CAAC,CAAD,CAAxB,CAAvC,CAAb;IACA,MAAME,KAAK,GAAG5E,IAAI,CAACC,GAAL,CAASD,IAAI,CAAC2D,GAAL,CAASc,KAAK,CAAC,CAAD,CAAd,EAAmBA,KAAK,CAAC,CAAD,CAAxB,CAAT,EAAuCzE,IAAI,CAAC2D,GAAL,CAASe,KAAK,CAAC,CAAD,CAAd,EAAmBA,KAAK,CAAC,CAAD,CAAxB,CAAvC,CAAd;;IACA,IAAIC,IAAI,GAAGC,KAAX,EAAkB;MAChB,OAAO,IAAP;IACD;;IACD,MAAMC,IAAI,GAAG7E,IAAI,CAAC2D,GAAL,CAAS3D,IAAI,CAACC,GAAL,CAASwE,KAAK,CAAC,CAAD,CAAd,EAAmBA,KAAK,CAAC,CAAD,CAAxB,CAAT,EAAuCzE,IAAI,CAACC,GAAL,CAASyE,KAAK,CAAC,CAAD,CAAd,EAAmBA,KAAK,CAAC,CAAD,CAAxB,CAAvC,CAAb;IACA,MAAMI,KAAK,GAAG9E,IAAI,CAACC,GAAL,CAASD,IAAI,CAAC2D,GAAL,CAASc,KAAK,CAAC,CAAD,CAAd,EAAmBA,KAAK,CAAC,CAAD,CAAxB,CAAT,EAAuCzE,IAAI,CAAC2D,GAAL,CAASe,KAAK,CAAC,CAAD,CAAd,EAAmBA,KAAK,CAAC,CAAD,CAAxB,CAAvC,CAAd;;IACA,IAAIG,IAAI,GAAGC,KAAX,EAAkB;MAChB,OAAO,IAAP;IACD;;IACD,OAAO,CAACH,IAAD,EAAOE,IAAP,EAAaD,KAAb,EAAoBE,KAApB,CAAP;EACD;;EACyB,OAAnB,CAACC,kBAAkB,CAACC,EAAD,EAAKC,EAAL,EAASC,EAAT,EAAaC,EAAb,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyBC,EAAzB,EAA6BC,EAA7B,EAAiCC,CAAjC,EAAoC7C,MAApC,EAA4C;IACpE,IAAI6C,CAAC,IAAI,CAAL,IAAUA,CAAC,IAAI,CAAnB,EAAsB;MACpB;IACD;;IACD,MAAMC,EAAE,GAAG,IAAID,CAAf;IACA,MAAME,EAAE,GAAGF,CAAC,GAAGA,CAAf;IACA,MAAMG,GAAG,GAAGD,EAAE,GAAGF,CAAjB;IACA,MAAMI,CAAC,GAAGH,EAAE,IAAIA,EAAE,IAAIA,EAAE,GAAGT,EAAL,GAAU,IAAIQ,CAAJ,GAAQP,EAAtB,CAAF,GAA8B,IAAIS,EAAJ,GAASR,EAA3C,CAAF,GAAmDS,GAAG,GAAGR,EAAnE;IACA,MAAMU,CAAC,GAAGJ,EAAE,IAAIA,EAAE,IAAIA,EAAE,GAAGL,EAAL,GAAU,IAAII,CAAJ,GAAQH,EAAtB,CAAF,GAA8B,IAAIK,EAAJ,GAASJ,EAA3C,CAAF,GAAmDK,GAAG,GAAGJ,EAAnE;IACA5C,MAAM,CAAC,CAAD,CAAN,GAAY3C,IAAI,CAACC,GAAL,CAAS0C,MAAM,CAAC,CAAD,CAAf,EAAoBiD,CAApB,CAAZ;IACAjD,MAAM,CAAC,CAAD,CAAN,GAAY3C,IAAI,CAACC,GAAL,CAAS0C,MAAM,CAAC,CAAD,CAAf,EAAoBkD,CAApB,CAAZ;IACAlD,MAAM,CAAC,CAAD,CAAN,GAAY3C,IAAI,CAAC2D,GAAL,CAAShB,MAAM,CAAC,CAAD,CAAf,EAAoBiD,CAApB,CAAZ;IACAjD,MAAM,CAAC,CAAD,CAAN,GAAY3C,IAAI,CAAC2D,GAAL,CAAShB,MAAM,CAAC,CAAD,CAAf,EAAoBkD,CAApB,CAAZ;EACD;;EACkB,OAAZ,CAACC,WAAW,CAACd,EAAD,EAAKC,EAAL,EAASC,EAAT,EAAaC,EAAb,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyBC,EAAzB,EAA6BC,EAA7B,EAAiCxB,CAAjC,EAAoCtB,CAApC,EAAuCuB,CAAvC,EAA0CrB,MAA1C,EAAkD;IACnE,IAAI3C,IAAI,CAAC+F,GAAL,CAAShC,CAAT,IAAc,KAAlB,EAAyB;MACvB,IAAI/D,IAAI,CAAC+F,GAAL,CAAStD,CAAT,KAAe,KAAnB,EAA0B;QACxB,KAAK,CAACsC,kBAAN,CAAyBC,EAAzB,EAA6BC,EAA7B,EAAiCC,EAAjC,EAAqCC,EAArC,EAAyCC,EAAzC,EAA6CC,EAA7C,EAAiDC,EAAjD,EAAqDC,EAArD,EAAyD,CAACvB,CAAD,GAAKvB,CAA9D,EAAiEE,MAAjE;MACD;;MACD;IACD;;IACD,MAAMqD,KAAK,GAAGvD,CAAC,IAAI,CAAL,GAAS,IAAIuB,CAAJ,GAAQD,CAA/B;;IACA,IAAIiC,KAAK,GAAG,CAAZ,EAAe;MACb;IACD;;IACD,MAAMC,SAAS,GAAGjG,IAAI,CAACmE,IAAL,CAAU6B,KAAV,CAAlB;IACA,MAAME,EAAE,GAAG,IAAInC,CAAf;IACA,KAAK,CAACgB,kBAAN,CAAyBC,EAAzB,EAA6BC,EAA7B,EAAiCC,EAAjC,EAAqCC,EAArC,EAAyCC,EAAzC,EAA6CC,EAA7C,EAAiDC,EAAjD,EAAqDC,EAArD,EAAyD,CAAC,CAAC9C,CAAD,GAAKwD,SAAN,IAAmBC,EAA5E,EAAgFvD,MAAhF;IACA,KAAK,CAACoC,kBAAN,CAAyBC,EAAzB,EAA6BC,EAA7B,EAAiCC,EAAjC,EAAqCC,EAArC,EAAyCC,EAAzC,EAA6CC,EAA7C,EAAiDC,EAAjD,EAAqDC,EAArD,EAAyD,CAAC,CAAC9C,CAAD,GAAKwD,SAAN,IAAmBC,EAA5E,EAAgFvD,MAAhF;EACD;;EACuB,OAAjBwD,iBAAiB,CAACnB,EAAD,EAAKI,EAAL,EAASH,EAAT,EAAaI,EAAb,EAAiBH,EAAjB,EAAqBI,EAArB,EAAyBH,EAAzB,EAA6BI,EAA7B,EAAiC5C,MAAjC,EAAyC;IAC/D,IAAIA,MAAJ,EAAY;MACVA,MAAM,CAAC,CAAD,CAAN,GAAY3C,IAAI,CAACC,GAAL,CAAS0C,MAAM,CAAC,CAAD,CAAf,EAAoBqC,EAApB,EAAwBG,EAAxB,CAAZ;MACAxC,MAAM,CAAC,CAAD,CAAN,GAAY3C,IAAI,CAACC,GAAL,CAAS0C,MAAM,CAAC,CAAD,CAAf,EAAoByC,EAApB,EAAwBG,EAAxB,CAAZ;MACA5C,MAAM,CAAC,CAAD,CAAN,GAAY3C,IAAI,CAAC2D,GAAL,CAAShB,MAAM,CAAC,CAAD,CAAf,EAAoBqC,EAApB,EAAwBG,EAAxB,CAAZ;MACAxC,MAAM,CAAC,CAAD,CAAN,GAAY3C,IAAI,CAAC2D,GAAL,CAAShB,MAAM,CAAC,CAAD,CAAf,EAAoByC,EAApB,EAAwBG,EAAxB,CAAZ;IACD,CALD,MAKO;MACL5C,MAAM,GAAG,CAAC3C,IAAI,CAACC,GAAL,CAAS+E,EAAT,EAAaG,EAAb,CAAD,EAAmBnF,IAAI,CAACC,GAAL,CAASmF,EAAT,EAAaG,EAAb,CAAnB,EAAqCvF,IAAI,CAAC2D,GAAL,CAASqB,EAAT,EAAaG,EAAb,CAArC,EAAuDnF,IAAI,CAAC2D,GAAL,CAASyB,EAAT,EAAaG,EAAb,CAAvD,CAAT;IACD;;IACD,KAAK,CAACO,WAAN,CAAkBd,EAAlB,EAAsBC,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCC,EAAtC,EAA0CC,EAA1C,EAA8CC,EAA9C,EAAkD,KAAK,CAACP,EAAD,GAAM,KAAKC,EAAE,GAAGC,EAAV,CAAN,GAAsBC,EAA3B,CAAlD,EAAkF,KAAKH,EAAE,GAAG,IAAIC,EAAT,GAAcC,EAAnB,CAAlF,EAA0G,KAAKD,EAAE,GAAGD,EAAV,CAA1G,EAAyHrC,MAAzH;IACA,KAAK,CAACmD,WAAN,CAAkBd,EAAlB,EAAsBC,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCC,EAAtC,EAA0CC,EAA1C,EAA8CC,EAA9C,EAAkD,KAAK,CAACH,EAAD,GAAM,KAAKC,EAAE,GAAGC,EAAV,CAAN,GAAsBC,EAA3B,CAAlD,EAAkF,KAAKH,EAAE,GAAG,IAAIC,EAAT,GAAcC,EAAnB,CAAlF,EAA0G,KAAKD,EAAE,GAAGD,EAAV,CAA1G,EAAyHzC,MAAzH;IACA,OAAOA,MAAP;EACD;;AAxJQ;;AA0JX,MAAMyD,uBAAuB;AAAI;AAAsC,QAAS,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,CAArC,EAAwC,CAAxC,EAA2C,CAA3C,EAA8C,CAA9C,EAAiD,CAAjD,EAAoD,CAApD,EAAuD,CAAvD,EAA0D,CAA1D,EAA6D,CAA7D,EAAgE,CAAhE,EAAmE,CAAnE,EAAsE,CAAtE,EAAyE,KAAzE,EAAgF,KAAhF,EAAuF,KAAvF,EAA8F,KAA9F,EAAqG,KAArG,EAA4G,KAA5G,EAAmH,KAAnH,EAA0H,KAA1H,EAAiI,CAAjI,EAAoI,CAApI,EAAuI,CAAvI,EAA0I,CAA1I,EAA6I,CAA7I,EAAgJ,CAAhJ,EAAmJ,CAAnJ,EAAsJ,CAAtJ,EAAyJ,CAAzJ,EAA4J,CAA5J,EAA+J,CAA/J,EAAkK,CAAlK,EAAqK,CAArK,EAAwK,CAAxK,EAA2K,CAA3K,EAA8K,CAA9K,EAAiL,CAAjL,EAAoL,CAApL,EAAuL,CAAvL,EAA0L,CAA1L,EAA6L,CAA7L,EAAgM,CAAhM,EAAmM,CAAnM,EAAsM,CAAtM,EAAyM,CAAzM,EAA4M,CAA5M,EAA+M,CAA/M,EAAkN,CAAlN,EAAqN,CAArN,EAAwN,CAAxN,EAA2N,CAA3N,EAA8N,CAA9N,EAAiO,CAAjO,EAAoO,CAApO,EAAuO,CAAvO,EAA0O,CAA1O,EAA6O,CAA7O,EAAgP,CAAhP,EAAmP,CAAnP,EAAsP,CAAtP,EAAyP,CAAzP,EAA4P,CAA5P,EAA+P,CAA/P,EAAkQ,CAAlQ,EAAqQ,CAArQ,EAAwQ,CAAxQ,EAA2Q,CAA3Q,EAA8Q,CAA9Q,EAAiR,CAAjR,EAAoR,CAApR,EAAuR,CAAvR,EAA0R,CAA1R,EAA6R,CAA7R,EAAgS,CAAhS,EAAmS,CAAnS,EAAsS,CAAtS,EAAyS,CAAzS,EAA4S,CAA5S,EAA+S,CAA/S,EAAkT,CAAlT,EAAqT,CAArT,EAAwT,CAAxT,EAA2T,CAA3T,EAA8T,CAA9T,EAAiU,CAAjU,EAAoU,CAApU,EAAuU,CAAvU,EAA0U,CAA1U,EAA6U,CAA7U,EAAgV,CAAhV,EAAmV,CAAnV,EAAsV,CAAtV,EAAyV,CAAzV,EAA4V,CAA5V,EAA+V,CAA/V,EAAkW,CAAlW,EAAqW,CAArW,EAAwW,CAAxW,EAA2W,CAA3W,EAA8W,CAA9W,EAAiX,CAAjX,EAAoX,CAApX,EAAuX,CAAvX,EAA0X,CAA1X,EAA6X,CAA7X,EAAgY,CAAhY,EAAmY,CAAnY,EAAsY,CAAtY,EAAyY,CAAzY,EAA4Y,CAA5Y,EAA+Y,CAA/Y,EAAkZ,CAAlZ,EAAqZ,CAArZ,EAAwZ,CAAxZ,EAA2Z,CAA3Z,EAA8Z,CAA9Z,EAAia,MAAja,EAAya,MAAza,EAAib,MAAjb,EAAyb,MAAzb,EAAic,MAAjc,EAAyc,MAAzc,EAAid,KAAjd,EAAwd,MAAxd,EAAge,MAAhe,EAAwe,MAAxe,EAAgf,MAAhf,EAAwf,MAAxf,EAAggB,MAAhgB,EAAwgB,MAAxgB,EAAghB,MAAhhB,EAAwhB,MAAxhB,EAAgiB,MAAhiB,EAAwiB,MAAxiB,EAAgjB,MAAhjB,EAAwjB,MAAxjB,EAAgkB,MAAhkB,EAAwkB,KAAxkB,EAA+kB,KAA/kB,EAAslB,KAAtlB,EAA6lB,KAA7lB,EAAomB,KAApmB,EAA2mB,KAA3mB,EAAknB,KAAlnB,EAAynB,KAAznB,EAAgoB,KAAhoB,EAAuoB,KAAvoB,EAA8oB,CAA9oB,EAAipB,MAAjpB,CAAhF;;AACA,SAASC,iBAAT,CAA2B9F,GAA3B,EAAgC;EAC9B,IAAIA,GAAG,CAAC,CAAD,CAAH,IAAU,MAAd,EAAsB;IACpB,IAAI+F,QAAJ;;IACA,IAAI/F,GAAG,CAAC,CAAD,CAAH,KAAW,MAAX,IAAqBA,GAAG,CAAC,CAAD,CAAH,KAAW,MAApC,EAA4C;MAC1C+F,QAAQ,GAAG,UAAX;;MACA,IAAI/F,GAAG,CAACrC,MAAJ,GAAa,CAAb,KAAmB,CAAvB,EAA0B;QACxBqC,GAAG,GAAGA,GAAG,CAACiD,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,CAAN;MACD;IACF,CALD,MAKO,IAAIjD,GAAG,CAAC,CAAD,CAAH,KAAW,MAAX,IAAqBA,GAAG,CAAC,CAAD,CAAH,KAAW,MAApC,EAA4C;MACjD+F,QAAQ,GAAG,UAAX;;MACA,IAAI/F,GAAG,CAACrC,MAAJ,GAAa,CAAb,KAAmB,CAAvB,EAA0B;QACxBqC,GAAG,GAAGA,GAAG,CAACiD,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,CAAN;MACD;IACF,CALM,MAKA,IAAIjD,GAAG,CAAC,CAAD,CAAH,KAAW,MAAX,IAAqBA,GAAG,CAAC,CAAD,CAAH,KAAW,MAAhC,IAA0CA,GAAG,CAAC,CAAD,CAAH,KAAW,MAAzD,EAAiE;MACtE+F,QAAQ,GAAG,OAAX;IACD;;IACD,IAAIA,QAAJ,EAAc;MACZ,IAAI;QACF,MAAMC,OAAO,GAAG,IAAIC,WAAJ,CAAgBF,QAAhB,EAA0B;UACxCG,KAAK,EAAE;QADiC,CAA1B,CAAhB;QAGA,MAAMrF,MAAM,GAAGd,aAAa,CAACC,GAAD,CAA5B;QACA,MAAMmG,OAAO,GAAGH,OAAO,CAACI,MAAR,CAAevF,MAAf,CAAhB;;QACA,IAAI,CAACsF,OAAO,CAAC9E,QAAR,CAAiB,MAAjB,CAAL,EAA+B;UAC7B,OAAO8E,OAAP;QACD;;QACD,OAAOA,OAAO,CAACE,UAAR,CAAmB,yBAAnB,EAA8C,EAA9C,CAAP;MACD,CAVD,CAUE,OAAOC,EAAP,EAAW;QACXzJ,IAAI,CAAE,uBAAsByJ,EAAG,IAA3B,CAAJ;MACD;IACF;EACF;;EACD,MAAMhH,MAAM,GAAG,EAAf;;EACA,KAAK,IAAIC,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGvG,GAAG,CAACrC,MAAzB,EAAiC4B,CAAC,GAAGgH,EAArC,EAAyChH,CAAC,EAA1C,EAA8C;IAC5C,MAAMiH,QAAQ,GAAGxG,GAAG,CAACE,UAAJ,CAAeX,CAAf,CAAjB;;IACA,IAAIiH,QAAQ,KAAK,IAAjB,EAAuB;MACrB,OAAO,EAAEjH,CAAF,GAAMgH,EAAN,IAAYvG,GAAG,CAACE,UAAJ,CAAeX,CAAf,MAAsB,IAAzC,EAA+C,CAAE;;MACjD;IACD;;IACD,MAAMb,IAAI,GAAGmH,uBAAuB,CAACW,QAAD,CAApC;IACAlH,MAAM,CAACO,IAAP,CAAYnB,IAAI,GAAGS,MAAM,CAACC,YAAP,CAAoBV,IAApB,CAAH,GAA+BsB,GAAG,CAACyG,MAAJ,CAAWlH,CAAX,CAA/C;EACD;;EACD,OAAOD,MAAM,CAACQ,IAAP,CAAY,EAAZ,CAAP;AACD;;AACD,SAASjC,kBAAT,CAA4BmC,GAA5B,EAAiC;EAC/B,OAAO0G,kBAAkB,CAACC,MAAM,CAAC3G,GAAD,CAAP,CAAzB;AACD;;AACD,SAAS4G,kBAAT,CAA4B5G,GAA5B,EAAiC;EAC/B,OAAO6G,QAAQ,CAACC,kBAAkB,CAAC9G,GAAD,CAAnB,CAAf;AACD;;AACD,SAAS+G,YAAT,CAAsBC,IAAtB,EAA4BC,IAA5B,EAAkC;EAChC,IAAID,IAAI,CAACrJ,MAAL,KAAgBsJ,IAAI,CAACtJ,MAAzB,EAAiC;IAC/B,OAAO,KAAP;EACD;;EACD,KAAK,IAAI4B,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGS,IAAI,CAACrJ,MAA1B,EAAkC4B,CAAC,GAAGgH,EAAtC,EAA0ChH,CAAC,EAA3C,EAA+C;IAC7C,IAAIyH,IAAI,CAACzH,CAAD,CAAJ,KAAY0H,IAAI,CAAC1H,CAAD,CAApB,EAAyB;MACvB,OAAO,KAAP;IACD;EACF;;EACD,OAAO,IAAP;AACD;;AACD,SAAS2H,mBAAT,CAA6BC,IAAI,GAAG,IAAIC,IAAJ,EAApC,EAAgD;EAC9C,MAAMvG,MAAM,GAAG,CAACsG,IAAI,CAACE,cAAL,GAAsBxF,QAAtB,EAAD,EAAmC,CAACsF,IAAI,CAACG,WAAL,KAAqB,CAAtB,EAAyBzF,QAAzB,GAAoCC,QAApC,CAA6C,CAA7C,EAAgD,GAAhD,CAAnC,EAAyFqF,IAAI,CAACI,UAAL,GAAkB1F,QAAlB,GAA6BC,QAA7B,CAAsC,CAAtC,EAAyC,GAAzC,CAAzF,EAAwIqF,IAAI,CAACK,WAAL,GAAmB3F,QAAnB,GAA8BC,QAA9B,CAAuC,CAAvC,EAA0C,GAA1C,CAAxI,EAAwLqF,IAAI,CAACM,aAAL,GAAqB5F,QAArB,GAAgCC,QAAhC,CAAyC,CAAzC,EAA4C,GAA5C,CAAxL,EAA0OqF,IAAI,CAACO,aAAL,GAAqB7F,QAArB,GAAgCC,QAAhC,CAAyC,CAAzC,EAA4C,GAA5C,CAA1O,CAAf;EACA,OAAOjB,MAAM,CAACf,IAAP,CAAY,EAAZ,CAAP;AACD;;AACD,IAAI6H,cAAc,GAAG,IAArB;AACA,IAAIC,gBAAgB,GAAG,IAAvB;;AACA,SAASjb,gBAAT,CAA0BqT,GAA1B,EAA+B;EAC7B,IAAI,CAAC2H,cAAL,EAAqB;IACnBA,cAAc,GAAG,0UAAjB;IACAC,gBAAgB,GAAG,IAAIC,GAAJ,CAAQ,CAAC,CAAC,GAAD,EAAM,IAAN,CAAD,CAAR,CAAnB;EACD;;EACD,OAAO7H,GAAG,CAACqG,UAAJ,CAAesB,cAAf,EAA+B,CAACG,CAAD,EAAI/E,EAAJ,EAAQC,EAAR,KAAeD,EAAE,GAAGA,EAAE,CAACgF,SAAH,CAAa,MAAb,CAAH,GAA0BH,gBAAgB,CAACne,GAAjB,CAAqBuZ,EAArB,CAA1E,CAAP;AACD;;AACD,SAASgF,OAAT,GAAmB;EACjB,IAAI,OAAOC,MAAP,KAAkB,WAAlB,IAAiC,OAAOA,MAAM,EAAEC,UAAf,KAA8B,UAAnE,EAA+E;IAC7E,OAAOD,MAAM,CAACC,UAAP,EAAP;EACD;;EACD,MAAMC,GAAG,GAAG,IAAIlI,UAAJ,CAAe,EAAf,CAAZ;;EACA,IAAI,OAAOgI,MAAP,KAAkB,WAAlB,IAAiC,OAAOA,MAAM,EAAEG,eAAf,KAAmC,UAAxE,EAAoF;IAClFH,MAAM,CAACG,eAAP,CAAuBD,GAAvB;EACD,CAFD,MAEO;IACL,KAAK,IAAI5I,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;MAC3B4I,GAAG,CAAC5I,CAAD,CAAH,GAASE,IAAI,CAAC4I,KAAL,CAAW5I,IAAI,CAAC6I,MAAL,KAAgB,GAA3B,CAAT;IACD;EACF;;EACD,OAAOvJ,aAAa,CAACoJ,GAAD,CAApB;AACD;;AACD,MAAMI,gBAAgB,GAAG,oBAAzB;AACA,MAAMC,aAAa,GAAG;EACpBC,eAAe,EAAE,CADG;EAEpBC,OAAO,EAAE,CAFW;EAGpBC,OAAO,EAAE,CAHW;EAIpBC,kBAAkB,EAAE,CAJA;EAKpBC,OAAO,EAAE,CALW;EAMpB9a,IAAI,EAAE,CANc;EAOpB+a,KAAK,EAAE,CAPa;EAQpBC,SAAS,EAAE,CARS;EASpBC,SAAS,EAAE;AATS,CAAtB;AAYA,C,CAAC;;AAED,MAAMC,iBAAN,CAAwB;EACtBC,SAAS,CAACC,IAAD,EAAO;IACd,OAAO,MAAP;EACD;;EACDC,YAAY,CAACC,OAAD,EAAUC,OAAV,EAAmB;IAC7B,OAAO,MAAP;EACD;;EACDC,cAAc,CAAChJ,GAAD,EAAM;IAClB,OAAO,MAAP;EACD;;EACDiJ,mBAAmB,CAACjJ,GAAD,EAAM;IACvB,OAAO,MAAP;EACD;;EACDkJ,qBAAqB,CAACC,UAAD,EAAaL,OAAb,EAAsBC,OAAtB,EAA+BK,UAA/B,EAA2CC,UAA3C,EAAuD;IAC1E,OAAO,MAAP;EACD;;EACDC,OAAO,CAACC,OAAO,GAAG,KAAX,EAAkB,CAAE;;AAhBL;;AAkBxB,MAAMC,iBAAN,CAAwB;EACtB,CAACC,SAAD,GAAa,KAAb;;EACAxL,WAAW,CAAC;IACVwL,SAAS,GAAG;EADF,IAER,EAFO,EAEH;IACN,KAAK,CAACA,SAAN,GAAkBA,SAAlB;EACD;;EACDxJ,MAAM,CAACyJ,KAAD,EAAQC,MAAR,EAAgB;IACpB,IAAID,KAAK,IAAI,CAAT,IAAcC,MAAM,IAAI,CAA5B,EAA+B;MAC7B,MAAM,IAAInN,KAAJ,CAAU,qBAAV,CAAN;IACD;;IACD,MAAMoN,MAAM,GAAG,KAAKC,aAAL,CAAmBH,KAAnB,EAA0BC,MAA1B,CAAf;;IACA,OAAO;MACLC,MADK;MAELE,OAAO,EAAEF,MAAM,CAACG,UAAP,CAAkB,IAAlB,EAAwB;QAC/BC,kBAAkB,EAAE,CAAC,KAAK,CAACP;MADI,CAAxB;IAFJ,CAAP;EAMD;;EACDQ,KAAK,CAACC,gBAAD,EAAmBR,KAAnB,EAA0BC,MAA1B,EAAkC;IACrC,IAAI,CAACO,gBAAgB,CAACN,MAAtB,EAA8B;MAC5B,MAAM,IAAIpN,KAAJ,CAAU,yBAAV,CAAN;IACD;;IACD,IAAIkN,KAAK,IAAI,CAAT,IAAcC,MAAM,IAAI,CAA5B,EAA+B;MAC7B,MAAM,IAAInN,KAAJ,CAAU,qBAAV,CAAN;IACD;;IACD0N,gBAAgB,CAACN,MAAjB,CAAwBF,KAAxB,GAAgCA,KAAhC;IACAQ,gBAAgB,CAACN,MAAjB,CAAwBD,MAAxB,GAAiCA,MAAjC;EACD;;EACDL,OAAO,CAACY,gBAAD,EAAmB;IACxB,IAAI,CAACA,gBAAgB,CAACN,MAAtB,EAA8B;MAC5B,MAAM,IAAIpN,KAAJ,CAAU,yBAAV,CAAN;IACD;;IACD0N,gBAAgB,CAACN,MAAjB,CAAwBF,KAAxB,GAAgC,CAAhC;IACAQ,gBAAgB,CAACN,MAAjB,CAAwBD,MAAxB,GAAiC,CAAjC;IACAO,gBAAgB,CAACN,MAAjB,GAA0B,IAA1B;IACAM,gBAAgB,CAACJ,OAAjB,GAA2B,IAA3B;EACD;;EACDD,aAAa,CAACH,KAAD,EAAQC,MAAR,EAAgB;IAC3BpN,WAAW,CAAC,yCAAD,CAAX;EACD;;AAxCqB;;AA0CxB,MAAM4N,qBAAN,CAA4B;EAC1BlM,WAAW,CAAC;IACVnB,OAAO,GAAG,IADA;IAEVsN,YAAY,GAAG;EAFL,CAAD,EAGR;IACD,KAAKtN,OAAL,GAAeA,OAAf;IACA,KAAKsN,YAAL,GAAoBA,YAApB;EACD;;EACKC,KAAK,CAAC;IACVrM;EADU,CAAD,EAER;IAAA;;IAAA;MACD,IAAI,CAAC,KAAI,CAAClB,OAAV,EAAmB;QACjB,MAAM,IAAIN,KAAJ,CAAU,yEAAV,CAAN;MACD;;MACD,IAAI,CAACwB,IAAL,EAAW;QACT,MAAM,IAAIxB,KAAJ,CAAU,8BAAV,CAAN;MACD;;MACD,MAAMI,GAAG,GAAG,KAAI,CAACE,OAAL,GAAekB,IAAf,IAAuB,KAAI,CAACoM,YAAL,GAAoB,QAApB,GAA+B,EAAtD,CAAZ;MACA,MAAME,eAAe,GAAG,KAAI,CAACF,YAAL,GAAoBlgB,mBAAmB,CAAC6L,MAAxC,GAAiD7L,mBAAmB,CAACiE,IAA7F;MACA,OAAO,KAAI,CAACoc,UAAL,CAAgB3N,GAAhB,EAAqB0N,eAArB,EAAsCE,KAAtC,CAA4CC,MAAM,IAAI;QAC3D,MAAM,IAAIjO,KAAJ,CAAW,kBAAiB,KAAI,CAAC4N,YAAL,GAAoB,SAApB,GAAgC,EAAG,YAAWxN,GAAI,EAA9E,CAAN;MACD,CAFM,CAAP;IATC;EAYF;;EACD2N,UAAU,CAAC3N,GAAD,EAAM0N,eAAN,EAAuB;IAC/B/N,WAAW,CAAC,sCAAD,CAAX;EACD;;AAzByB;;AA2B5B,MAAMmO,2BAAN,CAAkC;EAChCzM,WAAW,CAAC;IACVnB,OAAO,GAAG;EADA,CAAD,EAER;IACD,KAAKA,OAAL,GAAeA,OAAf;EACD;;EACKuN,KAAK,CAAC;IACVM;EADU,CAAD,EAER;IAAA;;IAAA;MACD,IAAI,CAAC,MAAI,CAAC7N,OAAV,EAAmB;QACjB,MAAM,IAAIN,KAAJ,CAAU,kEAAV,CAAN;MACD;;MACD,IAAI,CAACmO,QAAL,EAAe;QACb,MAAM,IAAInO,KAAJ,CAAU,kCAAV,CAAN;MACD;;MACD,MAAMI,GAAG,GAAI,GAAE,MAAI,CAACE,OAAQ,GAAE6N,QAAS,EAAvC;MACA,OAAO,MAAI,CAACJ,UAAL,CAAgB3N,GAAhB,EAAqB4N,KAArB,CAA2BC,MAAM,IAAI;QAC1C,MAAM,IAAIjO,KAAJ,CAAW,gCAA+BI,GAAI,EAA9C,CAAN;MACD,CAFM,CAAP;IARC;EAWF;;EACD2N,UAAU,CAAC3N,GAAD,EAAM;IACdL,WAAW,CAAC,sCAAD,CAAX;EACD;;AAtB+B;;AAwBlC,MAAMqO,cAAN,CAAqB;EACnB3K,MAAM,CAACyJ,KAAD,EAAQC,MAAR,EAAgBkB,cAAc,GAAG,KAAjC,EAAwC;IAC5C,IAAInB,KAAK,IAAI,CAAT,IAAcC,MAAM,IAAI,CAA5B,EAA+B;MAC7B,MAAM,IAAInN,KAAJ,CAAU,wBAAV,CAAN;IACD;;IACD,MAAMsO,GAAG,GAAG,KAAKC,UAAL,CAAgB,SAAhB,CAAZ;;IACAD,GAAG,CAACE,YAAJ,CAAiB,SAAjB,EAA4B,KAA5B;;IACA,IAAI,CAACH,cAAL,EAAqB;MACnBC,GAAG,CAACE,YAAJ,CAAiB,OAAjB,EAA2B,GAAEtB,KAAM,IAAnC;MACAoB,GAAG,CAACE,YAAJ,CAAiB,QAAjB,EAA4B,GAAErB,MAAO,IAArC;IACD;;IACDmB,GAAG,CAACE,YAAJ,CAAiB,qBAAjB,EAAwC,MAAxC;IACAF,GAAG,CAACE,YAAJ,CAAiB,SAAjB,EAA6B,OAAMtB,KAAM,IAAGC,MAAO,EAAnD;IACA,OAAOmB,GAAP;EACD;;EACDG,aAAa,CAACpe,IAAD,EAAO;IAClB,IAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;MAC5B,MAAM,IAAI2P,KAAJ,CAAU,0BAAV,CAAN;IACD;;IACD,OAAO,KAAKuO,UAAL,CAAgBle,IAAhB,CAAP;EACD;;EACDke,UAAU,CAACle,IAAD,EAAO;IACf0P,WAAW,CAAC,sCAAD,CAAX;EACD;;AAvBkB;;AA0BrB,C,CAAC;;AAGD,MAAM2O,MAAM,GAAG,4BAAf;;AACA,MAAM/f,aAAN,CAAoB;EACR,OAAH6V,GAAG,GAAG,IAAH;EACA,OAAHmK,GAAG,GAAG,IAAH;EACa,OAAhBC,gBAAgB,GAAG,KAAKpK,GAAL,GAAW,KAAKmK,GAAnB;AAHL;;AAKpB,MAAME,gBAAN,SAA+B3C,iBAA/B,CAAiD;EAC/C,CAAC5L,OAAD;EACA,CAACwO,MAAD;EACA,CAACC,KAAD;EACA,CAACC,KAAD;EACA,CAACC,QAAD;EACA,CAACC,SAAD;EACA,CAACC,EAAD,GAAM,CAAN;;EACA1N,WAAW,CAAC;IACVuN,KADU;IAEVI,aAAa,GAAGniB,UAAU,CAACgiB;EAFjB,IAGR,EAHO,EAGH;IACN;IACA,KAAK,CAACD,KAAN,GAAcA,KAAd;IACA,KAAK,CAACC,QAAN,GAAiBG,aAAjB;EACD;;EACS,IAAN,CAACC,KAAK,GAAG;IACX,OAAO,KAAK,CAACP,MAAN,KAAiB,IAAIhE,GAAJ,EAAxB;EACD;;EACY,IAAT,CAACwE,QAAQ,GAAG;IACd,OAAO,KAAK,CAACJ,SAAN,KAAoB,IAAIpE,GAAJ,EAA3B;EACD;;EACQ,IAAL,CAACyE,IAAI,GAAG;IACV,IAAI,CAAC,KAAK,CAACR,KAAX,EAAkB;MAChB,MAAMS,GAAG,GAAG,KAAK,CAACP,QAAN,CAAeR,aAAf,CAA6B,KAA7B,CAAZ;MACA,MAAM;QACJgB;MADI,IAEFD,GAFJ;MAGAC,KAAK,CAACC,UAAN,GAAmB,QAAnB;MACAD,KAAK,CAACE,OAAN,GAAgB,QAAhB;MACAF,KAAK,CAACvC,KAAN,GAAcuC,KAAK,CAACtC,MAAN,GAAe,CAA7B;MACAsC,KAAK,CAACG,QAAN,GAAiB,UAAjB;MACAH,KAAK,CAACI,GAAN,GAAYJ,KAAK,CAACK,IAAN,GAAa,CAAzB;MACAL,KAAK,CAACM,MAAN,GAAe,CAAC,CAAhB;MACA,MAAMzB,GAAG,GAAG,KAAK,CAACW,QAAN,CAAee,eAAf,CAA+BtB,MAA/B,EAAuC,KAAvC,CAAZ;MACAJ,GAAG,CAACE,YAAJ,CAAiB,OAAjB,EAA0B,CAA1B;MACAF,GAAG,CAACE,YAAJ,CAAiB,QAAjB,EAA2B,CAA3B;MACA,KAAK,CAACO,KAAN,GAAc,KAAK,CAACE,QAAN,CAAee,eAAf,CAA+BtB,MAA/B,EAAuC,MAAvC,CAAd;MACAc,GAAG,CAACS,MAAJ,CAAW3B,GAAX;MACAA,GAAG,CAAC2B,MAAJ,CAAW,KAAK,CAAClB,KAAjB;MACA,KAAK,CAACE,QAAN,CAAeiB,IAAf,CAAoBD,MAApB,CAA2BT,GAA3B;IACD;;IACD,OAAO,KAAK,CAACT,KAAb;EACD;;EACD,CAACoB,YAAY,CAAC/D,IAAD,EAAO;IAClB,IAAIA,IAAI,CAACxL,MAAL,KAAgB,CAApB,EAAuB;MACrB,MAAMwP,IAAI,GAAGhE,IAAI,CAAC,CAAD,CAAjB;MACA,MAAMtI,MAAM,GAAG,IAAIa,KAAJ,CAAU,GAAV,CAAf;;MACA,KAAK,IAAInC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,GAApB,EAAyBA,CAAC,EAA1B,EAA8B;QAC5BsB,MAAM,CAACtB,CAAD,CAAN,GAAY4N,IAAI,CAAC5N,CAAD,CAAJ,GAAU,GAAtB;MACD;;MACD,MAAM6N,KAAK,GAAGvM,MAAM,CAACf,IAAP,CAAY,GAAZ,CAAd;MACA,OAAO,CAACsN,KAAD,EAAQA,KAAR,EAAeA,KAAf,CAAP;IACD;;IACD,MAAM,CAACD,IAAD,EAAOE,IAAP,EAAaC,IAAb,IAAqBnE,IAA3B;IACA,MAAMoE,OAAO,GAAG,IAAI7L,KAAJ,CAAU,GAAV,CAAhB;IACA,MAAM8L,OAAO,GAAG,IAAI9L,KAAJ,CAAU,GAAV,CAAhB;IACA,MAAM+L,OAAO,GAAG,IAAI/L,KAAJ,CAAU,GAAV,CAAhB;;IACA,KAAK,IAAInC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,GAApB,EAAyBA,CAAC,EAA1B,EAA8B;MAC5BgO,OAAO,CAAChO,CAAD,CAAP,GAAa4N,IAAI,CAAC5N,CAAD,CAAJ,GAAU,GAAvB;MACAiO,OAAO,CAACjO,CAAD,CAAP,GAAa8N,IAAI,CAAC9N,CAAD,CAAJ,GAAU,GAAvB;MACAkO,OAAO,CAAClO,CAAD,CAAP,GAAa+N,IAAI,CAAC/N,CAAD,CAAJ,GAAU,GAAvB;IACD;;IACD,OAAO,CAACgO,OAAO,CAACzN,IAAR,CAAa,GAAb,CAAD,EAAoB0N,OAAO,CAAC1N,IAAR,CAAa,GAAb,CAApB,EAAuC2N,OAAO,CAAC3N,IAAR,CAAa,GAAb,CAAvC,CAAP;EACD;;EACD,CAAC4N,SAAS,CAACxB,EAAD,EAAK;IACb,IAAI,KAAK,CAAC7O,OAAN,KAAkB4B,SAAtB,EAAiC;MAC/B,KAAK,CAAC5B,OAAN,GAAgB,EAAhB;MACA,MAAMF,GAAG,GAAG,KAAK,CAAC6O,QAAN,CAAejO,GAA3B;;MACA,IAAIZ,GAAG,KAAK,KAAK,CAAC6O,QAAN,CAAe2B,OAA3B,EAAoC;QAClC,IAAInhB,YAAY,CAAC2Q,GAAD,CAAhB,EAAuB;UACrBN,IAAI,CAAC,yDAAD,CAAJ;QACD,CAFD,MAEO;UACL,KAAK,CAACQ,OAAN,GAAgBF,GAAG,CAACyQ,KAAJ,CAAU,GAAV,EAAe,CAAf,EAAkB,CAAlB,CAAhB;QACD;MACF;IACF;;IACD,OAAQ,OAAM,KAAK,CAACvQ,OAAQ,IAAG6O,EAAG,GAAlC;EACD;;EACDhD,SAAS,CAACC,IAAD,EAAO;IACd,IAAI,CAACA,IAAL,EAAW;MACT,OAAO,MAAP;IACD;;IACD,IAAInL,KAAK,GAAG,KAAK,CAACoO,KAAN,CAAY3iB,GAAZ,CAAgB0f,IAAhB,CAAZ;;IACA,IAAInL,KAAJ,EAAW;MACT,OAAOA,KAAP;IACD;;IACD,MAAM,CAAC6P,MAAD,EAASC,MAAT,EAAiBC,MAAjB,IAA2B,KAAK,CAACb,YAAN,CAAmB/D,IAAnB,CAAjC;IACA,MAAM/f,GAAG,GAAG+f,IAAI,CAACxL,MAAL,KAAgB,CAAhB,GAAoBkQ,MAApB,GAA8B,GAAEA,MAAO,GAAEC,MAAO,GAAEC,MAAO,EAArE;IACA/P,KAAK,GAAG,KAAK,CAACoO,KAAN,CAAY3iB,GAAZ,CAAgBL,GAAhB,CAAR;;IACA,IAAI4U,KAAJ,EAAW;MACT,KAAK,CAACoO,KAAN,CAAY4B,GAAZ,CAAgB7E,IAAhB,EAAsBnL,KAAtB;MACA,OAAOA,KAAP;IACD;;IACD,MAAMkO,EAAE,GAAI,KAAI,KAAK,CAACH,KAAM,iBAAgB,KAAK,CAACG,EAAN,EAAW,EAAvD;IACA,MAAM/O,GAAG,GAAG,KAAK,CAACuQ,SAAN,CAAgBxB,EAAhB,CAAZ;IACA,KAAK,CAACE,KAAN,CAAY4B,GAAZ,CAAgB7E,IAAhB,EAAsBhM,GAAtB;IACA,KAAK,CAACiP,KAAN,CAAY4B,GAAZ,CAAgB5kB,GAAhB,EAAqB+T,GAArB;IACA,MAAM8Q,MAAM,GAAG,KAAK,CAACC,YAAN,CAAmBhC,EAAnB,CAAf;IACA,KAAK,CAACiC,wBAAN,CAA+BN,MAA/B,EAAuCC,MAAvC,EAA+CC,MAA/C,EAAuDE,MAAvD;IACA,OAAO9Q,GAAP;EACD;;EACDiM,YAAY,CAACC,OAAD,EAAUC,OAAV,EAAmB;IAC7B,MAAMlgB,GAAG,GAAI,GAAEigB,OAAQ,IAAGC,OAAQ,EAAlC;IACA,MAAMI,UAAU,GAAG,MAAnB;IACA,IAAIjN,IAAI,GAAG,KAAK,CAAC4P,QAAN,CAAe5iB,GAAf,CAAmBigB,UAAnB,CAAX;;IACA,IAAIjN,IAAI,EAAErT,GAAN,KAAcA,GAAlB,EAAuB;MACrB,OAAOqT,IAAI,CAACU,GAAZ;IACD;;IACD,IAAIV,IAAJ,EAAU;MACRA,IAAI,CAACwR,MAAL,EAAaG,MAAb;MACA3R,IAAI,CAACrT,GAAL,GAAWA,GAAX;MACAqT,IAAI,CAACU,GAAL,GAAW,MAAX;MACAV,IAAI,CAACwR,MAAL,GAAc,IAAd;IACD,CALD,MAKO;MACLxR,IAAI,GAAG;QACLrT,GADK;QAEL+T,GAAG,EAAE,MAFA;QAGL8Q,MAAM,EAAE;MAHH,CAAP;MAKA,KAAK,CAAC5B,QAAN,CAAe2B,GAAf,CAAmBtE,UAAnB,EAA+BjN,IAA/B;IACD;;IACD,IAAI,CAAC4M,OAAD,IAAY,CAACC,OAAjB,EAA0B;MACxB,OAAO7M,IAAI,CAACU,GAAZ;IACD;;IACD,MAAMkR,KAAK,GAAG,KAAK,CAACC,MAAN,CAAajF,OAAb,CAAd;IACAA,OAAO,GAAGvd,IAAI,CAACiW,YAAL,CAAkB,GAAGsM,KAArB,CAAV;IACA,MAAME,KAAK,GAAG,KAAK,CAACD,MAAN,CAAahF,OAAb,CAAd;IACAA,OAAO,GAAGxd,IAAI,CAACiW,YAAL,CAAkB,GAAGwM,KAArB,CAAV;IACA,KAAK,CAACjC,IAAN,CAAWE,KAAX,CAAiBgC,KAAjB,GAAyB,EAAzB;;IACA,IAAInF,OAAO,KAAK,SAAZ,IAAyBC,OAAO,KAAK,SAArC,IAAkDD,OAAO,KAAKC,OAAlE,EAA2E;MACzE,OAAO7M,IAAI,CAACU,GAAZ;IACD;;IACD,MAAMoD,GAAG,GAAG,IAAImB,KAAJ,CAAU,GAAV,CAAZ;;IACA,KAAK,IAAInC,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAI,GAArB,EAA0BA,CAAC,EAA3B,EAA+B;MAC7B,MAAM8F,CAAC,GAAG9F,CAAC,GAAG,GAAd;MACAgB,GAAG,CAAChB,CAAD,CAAH,GAAS8F,CAAC,IAAI,OAAL,GAAeA,CAAC,GAAG,KAAnB,GAA2B,CAAC,CAACA,CAAC,GAAG,KAAL,IAAc,KAAf,KAAyB,GAA7D;IACD;;IACD,MAAM+H,KAAK,GAAG7M,GAAG,CAACT,IAAJ,CAAS,GAAT,CAAd;IACA,MAAMoM,EAAE,GAAI,KAAI,KAAK,CAACH,KAAM,aAA5B;IACA,MAAMkC,MAAM,GAAGxR,IAAI,CAACwR,MAAL,GAAc,KAAK,CAACC,YAAN,CAAmBhC,EAAnB,CAA7B;IACA,KAAK,CAACiC,wBAAN,CAA+Bf,KAA/B,EAAsCA,KAAtC,EAA6CA,KAA7C,EAAoDa,MAApD;IACA,KAAK,CAACQ,iBAAN,CAAwBR,MAAxB;;IACA,MAAMS,QAAQ,GAAG,CAACjL,CAAD,EAAI7B,CAAJ,KAAU;MACzB,MAAM+M,KAAK,GAAGN,KAAK,CAAC5K,CAAD,CAAL,GAAW,GAAzB;MACA,MAAMmL,GAAG,GAAGL,KAAK,CAAC9K,CAAD,CAAL,GAAW,GAAvB;MACA,MAAMoL,GAAG,GAAG,IAAInN,KAAJ,CAAUE,CAAC,GAAG,CAAd,CAAZ;;MACA,KAAK,IAAIrC,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIqC,CAArB,EAAwBrC,CAAC,EAAzB,EAA6B;QAC3BsP,GAAG,CAACtP,CAAD,CAAH,GAASoP,KAAK,GAAGpP,CAAC,GAAGqC,CAAJ,IAASgN,GAAG,GAAGD,KAAf,CAAjB;MACD;;MACD,OAAOE,GAAG,CAAC/O,IAAJ,CAAS,GAAT,CAAP;IACD,CARD;;IASA,KAAK,CAACqO,wBAAN,CAA+BO,QAAQ,CAAC,CAAD,EAAI,CAAJ,CAAvC,EAA+CA,QAAQ,CAAC,CAAD,EAAI,CAAJ,CAAvD,EAA+DA,QAAQ,CAAC,CAAD,EAAI,CAAJ,CAAvE,EAA+ET,MAA/E;IACAxR,IAAI,CAACU,GAAL,GAAW,KAAK,CAACuQ,SAAN,CAAgBxB,EAAhB,CAAX;IACA,OAAOzP,IAAI,CAACU,GAAZ;EACD;;EACDoM,cAAc,CAAChJ,GAAD,EAAM;IAClB,IAAIvC,KAAK,GAAG,KAAK,CAACoO,KAAN,CAAY3iB,GAAZ,CAAgB8W,GAAhB,CAAZ;;IACA,IAAIvC,KAAJ,EAAW;MACT,OAAOA,KAAP;IACD;;IACD,MAAM,CAAC8Q,MAAD,IAAW,KAAK,CAAC5B,YAAN,CAAmB,CAAC3M,GAAD,CAAnB,CAAjB;IACA,MAAMnX,GAAG,GAAI,SAAQ0lB,MAAO,EAA5B;IACA9Q,KAAK,GAAG,KAAK,CAACoO,KAAN,CAAY3iB,GAAZ,CAAgBL,GAAhB,CAAR;;IACA,IAAI4U,KAAJ,EAAW;MACT,KAAK,CAACoO,KAAN,CAAY4B,GAAZ,CAAgBzN,GAAhB,EAAqBvC,KAArB;MACA,OAAOA,KAAP;IACD;;IACD,MAAMkO,EAAE,GAAI,KAAI,KAAK,CAACH,KAAM,cAAa,KAAK,CAACG,EAAN,EAAW,EAApD;IACA,MAAM/O,GAAG,GAAG,KAAK,CAACuQ,SAAN,CAAgBxB,EAAhB,CAAZ;IACA,KAAK,CAACE,KAAN,CAAY4B,GAAZ,CAAgBzN,GAAhB,EAAqBpD,GAArB;IACA,KAAK,CAACiP,KAAN,CAAY4B,GAAZ,CAAgB5kB,GAAhB,EAAqB+T,GAArB;IACA,MAAM8Q,MAAM,GAAG,KAAK,CAACC,YAAN,CAAmBhC,EAAnB,CAAf;IACA,KAAK,CAAC6C,6BAAN,CAAoCD,MAApC,EAA4Cb,MAA5C;IACA,OAAO9Q,GAAP;EACD;;EACDqM,mBAAmB,CAACjJ,GAAD,EAAM;IACvB,IAAIvC,KAAK,GAAG,KAAK,CAACoO,KAAN,CAAY3iB,GAAZ,CAAgB8W,GAAG,IAAI,YAAvB,CAAZ;;IACA,IAAIvC,KAAJ,EAAW;MACT,OAAOA,KAAP;IACD;;IACD,IAAI8Q,MAAJ,EAAY1lB,GAAZ;;IACA,IAAImX,GAAJ,EAAS;MACP,CAACuO,MAAD,IAAW,KAAK,CAAC5B,YAAN,CAAmB,CAAC3M,GAAD,CAAnB,CAAX;MACAnX,GAAG,GAAI,cAAa0lB,MAAO,EAA3B;IACD,CAHD,MAGO;MACL1lB,GAAG,GAAG,YAAN;IACD;;IACD4U,KAAK,GAAG,KAAK,CAACoO,KAAN,CAAY3iB,GAAZ,CAAgBL,GAAhB,CAAR;;IACA,IAAI4U,KAAJ,EAAW;MACT,KAAK,CAACoO,KAAN,CAAY4B,GAAZ,CAAgBzN,GAAhB,EAAqBvC,KAArB;MACA,OAAOA,KAAP;IACD;;IACD,MAAMkO,EAAE,GAAI,KAAI,KAAK,CAACH,KAAM,mBAAkB,KAAK,CAACG,EAAN,EAAW,EAAzD;IACA,MAAM/O,GAAG,GAAG,KAAK,CAACuQ,SAAN,CAAgBxB,EAAhB,CAAZ;IACA,KAAK,CAACE,KAAN,CAAY4B,GAAZ,CAAgBzN,GAAhB,EAAqBpD,GAArB;IACA,KAAK,CAACiP,KAAN,CAAY4B,GAAZ,CAAgB5kB,GAAhB,EAAqB+T,GAArB;IACA,MAAM8Q,MAAM,GAAG,KAAK,CAACC,YAAN,CAAmBhC,EAAnB,CAAf;IACA,KAAK,CAAC8C,uBAAN,CAA8Bf,MAA9B;;IACA,IAAI1N,GAAJ,EAAS;MACP,KAAK,CAACwO,6BAAN,CAAoCD,MAApC,EAA4Cb,MAA5C;IACD;;IACD,OAAO9Q,GAAP;EACD;;EACDsM,qBAAqB,CAACC,UAAD,EAAaL,OAAb,EAAsBC,OAAtB,EAA+BK,UAA/B,EAA2CC,UAA3C,EAAuD;IAC1E,MAAMxgB,GAAG,GAAI,GAAEigB,OAAQ,IAAGC,OAAQ,IAAGK,UAAW,IAAGC,UAAW,EAA9D;IACA,IAAInN,IAAI,GAAG,KAAK,CAAC4P,QAAN,CAAe5iB,GAAf,CAAmBigB,UAAnB,CAAX;;IACA,IAAIjN,IAAI,EAAErT,GAAN,KAAcA,GAAlB,EAAuB;MACrB,OAAOqT,IAAI,CAACU,GAAZ;IACD;;IACD,IAAIV,IAAJ,EAAU;MACRA,IAAI,CAACwR,MAAL,EAAaG,MAAb;MACA3R,IAAI,CAACrT,GAAL,GAAWA,GAAX;MACAqT,IAAI,CAACU,GAAL,GAAW,MAAX;MACAV,IAAI,CAACwR,MAAL,GAAc,IAAd;IACD,CALD,MAKO;MACLxR,IAAI,GAAG;QACLrT,GADK;QAEL+T,GAAG,EAAE,MAFA;QAGL8Q,MAAM,EAAE;MAHH,CAAP;MAKA,KAAK,CAAC5B,QAAN,CAAe2B,GAAf,CAAmBtE,UAAnB,EAA+BjN,IAA/B;IACD;;IACD,IAAI,CAAC4M,OAAD,IAAY,CAACC,OAAjB,EAA0B;MACxB,OAAO7M,IAAI,CAACU,GAAZ;IACD;;IACD,MAAM,CAACkR,KAAD,EAAQE,KAAR,IAAiB,CAAClF,OAAD,EAAUC,OAAV,EAAmB/I,GAAnB,CAAuB,KAAK,CAAC+N,MAAN,CAAaW,IAAb,CAAkB,IAAlB,CAAvB,CAAvB;IACA,IAAIC,MAAM,GAAGzP,IAAI,CAAC0P,KAAL,CAAW,SAASd,KAAK,CAAC,CAAD,CAAd,GAAoB,SAASA,KAAK,CAAC,CAAD,CAAlC,GAAwC,SAASA,KAAK,CAAC,CAAD,CAAjE,CAAb;IACA,IAAIe,MAAM,GAAG3P,IAAI,CAAC0P,KAAL,CAAW,SAASZ,KAAK,CAAC,CAAD,CAAd,GAAoB,SAASA,KAAK,CAAC,CAAD,CAAlC,GAAwC,SAASA,KAAK,CAAC,CAAD,CAAjE,CAAb;IACA,IAAI,CAACc,QAAD,EAAWC,QAAX,IAAuB,CAAC3F,UAAD,EAAaC,UAAb,EAAyBrJ,GAAzB,CAA6B,KAAK,CAAC+N,MAAN,CAAaW,IAAb,CAAkB,IAAlB,CAA7B,CAA3B;;IACA,IAAIG,MAAM,GAAGF,MAAb,EAAqB;MACnB,CAACA,MAAD,EAASE,MAAT,EAAiBC,QAAjB,EAA2BC,QAA3B,IAAuC,CAACF,MAAD,EAASF,MAAT,EAAiBI,QAAjB,EAA2BD,QAA3B,CAAvC;IACD;;IACD,KAAK,CAAC/C,IAAN,CAAWE,KAAX,CAAiBgC,KAAjB,GAAyB,EAAzB;;IACA,MAAME,QAAQ,GAAG,CAACa,EAAD,EAAKC,EAAL,EAAS5N,CAAT,KAAe;MAC9B,MAAMiN,GAAG,GAAG,IAAInN,KAAJ,CAAU,GAAV,CAAZ;MACA,MAAM+N,IAAI,GAAG,CAACL,MAAM,GAAGF,MAAV,IAAoBtN,CAAjC;MACA,MAAM8N,QAAQ,GAAGH,EAAE,GAAG,GAAtB;MACA,MAAMI,OAAO,GAAG,CAACH,EAAE,GAAGD,EAAN,KAAa,MAAM3N,CAAnB,CAAhB;MACA,IAAIgO,IAAI,GAAG,CAAX;;MACA,KAAK,IAAIrQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIqC,CAArB,EAAwBrC,CAAC,EAAzB,EAA6B;QAC3B,MAAMsQ,CAAC,GAAGpQ,IAAI,CAAC0P,KAAL,CAAWD,MAAM,GAAG3P,CAAC,GAAGkQ,IAAxB,CAAV;QACA,MAAMzR,KAAK,GAAG0R,QAAQ,GAAGnQ,CAAC,GAAGoQ,OAA7B;;QACA,KAAK,IAAIG,CAAC,GAAGF,IAAb,EAAmBE,CAAC,IAAID,CAAxB,EAA2BC,CAAC,EAA5B,EAAgC;UAC9BjB,GAAG,CAACiB,CAAD,CAAH,GAAS9R,KAAT;QACD;;QACD4R,IAAI,GAAGC,CAAC,GAAG,CAAX;MACD;;MACD,KAAK,IAAItQ,CAAC,GAAGqQ,IAAb,EAAmBrQ,CAAC,GAAG,GAAvB,EAA4BA,CAAC,EAA7B,EAAiC;QAC/BsP,GAAG,CAACtP,CAAD,CAAH,GAASsP,GAAG,CAACe,IAAI,GAAG,CAAR,CAAZ;MACD;;MACD,OAAOf,GAAG,CAAC/O,IAAJ,CAAS,GAAT,CAAP;IACD,CAlBD;;IAmBA,MAAMoM,EAAE,GAAI,KAAI,KAAK,CAACH,KAAM,QAAOrC,UAAW,SAA9C;IACA,MAAMuE,MAAM,GAAGxR,IAAI,CAACwR,MAAL,GAAc,KAAK,CAACC,YAAN,CAAmBhC,EAAnB,CAA7B;IACA,KAAK,CAACuC,iBAAN,CAAwBR,MAAxB;IACA,KAAK,CAACE,wBAAN,CAA+BO,QAAQ,CAACW,QAAQ,CAAC,CAAD,CAAT,EAAcC,QAAQ,CAAC,CAAD,CAAtB,EAA2B,CAA3B,CAAvC,EAAsEZ,QAAQ,CAACW,QAAQ,CAAC,CAAD,CAAT,EAAcC,QAAQ,CAAC,CAAD,CAAtB,EAA2B,CAA3B,CAA9E,EAA6GZ,QAAQ,CAACW,QAAQ,CAAC,CAAD,CAAT,EAAcC,QAAQ,CAAC,CAAD,CAAtB,EAA2B,CAA3B,CAArH,EAAoJrB,MAApJ;IACAxR,IAAI,CAACU,GAAL,GAAW,KAAK,CAACuQ,SAAN,CAAgBxB,EAAhB,CAAX;IACA,OAAOzP,IAAI,CAACU,GAAZ;EACD;;EACD0M,OAAO,CAACC,OAAO,GAAG,KAAX,EAAkB;IACvB,IAAIA,OAAO,IAAI,KAAK,CAACuC,QAAN,CAAe0D,IAAf,KAAwB,CAAvC,EAA0C;MACxC;IACD;;IACD,IAAI,KAAK,CAACjE,KAAV,EAAiB;MACf,KAAK,CAACA,KAAN,CAAYkE,UAAZ,CAAuBA,UAAvB,CAAkC5B,MAAlC;MACA,KAAK,CAACtC,KAAN,GAAc,IAAd;IACD;;IACD,IAAI,KAAK,CAACD,MAAV,EAAkB;MAChB,KAAK,CAACA,MAAN,CAAaoE,KAAb;MACA,KAAK,CAACpE,MAAN,GAAe,IAAf;IACD;;IACD,KAAK,CAACK,EAAN,GAAW,CAAX;EACD;;EACD,CAAC8C,uBAAuB,CAACf,MAAD,EAAS;IAC/B,MAAMiC,aAAa,GAAG,KAAK,CAAClE,QAAN,CAAee,eAAf,CAA+BtB,MAA/B,EAAuC,eAAvC,CAAtB;IACAyE,aAAa,CAAC3E,YAAd,CAA2B,MAA3B,EAAmC,QAAnC;IACA2E,aAAa,CAAC3E,YAAd,CAA2B,QAA3B,EAAqC,iDAArC;IACA0C,MAAM,CAACjB,MAAP,CAAckD,aAAd;EACD;;EACD,CAACzB,iBAAiB,CAACR,MAAD,EAAS;IACzB,MAAMiC,aAAa,GAAG,KAAK,CAAClE,QAAN,CAAee,eAAf,CAA+BtB,MAA/B,EAAuC,eAAvC,CAAtB;IACAyE,aAAa,CAAC3E,YAAd,CAA2B,MAA3B,EAAmC,QAAnC;IACA2E,aAAa,CAAC3E,YAAd,CAA2B,QAA3B,EAAqC,sFAArC;IACA0C,MAAM,CAACjB,MAAP,CAAckD,aAAd;EACD;;EACD,CAAChC,YAAY,CAAChC,EAAD,EAAK;IAChB,MAAM+B,MAAM,GAAG,KAAK,CAACjC,QAAN,CAAee,eAAf,CAA+BtB,MAA/B,EAAuC,QAAvC,CAAf;IACAwC,MAAM,CAAC1C,YAAP,CAAoB,6BAApB,EAAmD,MAAnD;IACA0C,MAAM,CAAC1C,YAAP,CAAoB,IAApB,EAA0BW,EAA1B;IACA,KAAK,CAACI,IAAN,CAAWU,MAAX,CAAkBiB,MAAlB;IACA,OAAOA,MAAP;EACD;;EACD,CAACkC,YAAY,CAACC,mBAAD,EAAsBC,IAAtB,EAA4BjD,KAA5B,EAAmC;IAC9C,MAAMkD,MAAM,GAAG,KAAK,CAACtE,QAAN,CAAee,eAAf,CAA+BtB,MAA/B,EAAuC4E,IAAvC,CAAf;IACAC,MAAM,CAAC/E,YAAP,CAAoB,MAApB,EAA4B,UAA5B;IACA+E,MAAM,CAAC/E,YAAP,CAAoB,aAApB,EAAmC6B,KAAnC;IACAgD,mBAAmB,CAACpD,MAApB,CAA2BsD,MAA3B;EACD;;EACD,CAACnC,wBAAwB,CAACoC,MAAD,EAASC,MAAT,EAAiBC,MAAjB,EAAyBxC,MAAzB,EAAiC;IACxD,MAAMmC,mBAAmB,GAAG,KAAK,CAACpE,QAAN,CAAee,eAAf,CAA+BtB,MAA/B,EAAuC,qBAAvC,CAA5B;IACAwC,MAAM,CAACjB,MAAP,CAAcoD,mBAAd;IACA,KAAK,CAACD,YAAN,CAAmBC,mBAAnB,EAAwC,SAAxC,EAAmDG,MAAnD;IACA,KAAK,CAACJ,YAAN,CAAmBC,mBAAnB,EAAwC,SAAxC,EAAmDI,MAAnD;IACA,KAAK,CAACL,YAAN,CAAmBC,mBAAnB,EAAwC,SAAxC,EAAmDK,MAAnD;EACD;;EACD,CAAC1B,6BAA6B,CAAC2B,MAAD,EAASzC,MAAT,EAAiB;IAC7C,MAAMmC,mBAAmB,GAAG,KAAK,CAACpE,QAAN,CAAee,eAAf,CAA+BtB,MAA/B,EAAuC,qBAAvC,CAA5B;IACAwC,MAAM,CAACjB,MAAP,CAAcoD,mBAAd;IACA,KAAK,CAACD,YAAN,CAAmBC,mBAAnB,EAAwC,SAAxC,EAAmDM,MAAnD;EACD;;EACD,CAACpC,MAAM,CAACE,KAAD,EAAQ;IACb,KAAK,CAAClC,IAAN,CAAWE,KAAX,CAAiBgC,KAAjB,GAAyBA,KAAzB;IACA,OAAOF,MAAM,CAACqC,gBAAgB,CAAC,KAAK,CAACrE,IAAP,CAAhB,CAA6BsE,gBAA7B,CAA8C,OAA9C,CAAD,CAAb;EACD;;AA1T8C;;AA4TjD,MAAMC,gBAAN,SAA+B9G,iBAA/B,CAAiD;EAC/CvL,WAAW,CAAC;IACV2N,aAAa,GAAGniB,UAAU,CAACgiB,QADjB;IAEVhC,SAAS,GAAG;EAFF,IAGR,EAHO,EAGH;IACN,MAAM;MACJA;IADI,CAAN;IAGA,KAAK8G,SAAL,GAAiB3E,aAAjB;EACD;;EACD/B,aAAa,CAACH,KAAD,EAAQC,MAAR,EAAgB;IAC3B,MAAMC,MAAM,GAAG,KAAK2G,SAAL,CAAetF,aAAf,CAA6B,QAA7B,CAAf;;IACArB,MAAM,CAACF,KAAP,GAAeA,KAAf;IACAE,MAAM,CAACD,MAAP,GAAgBA,MAAhB;IACA,OAAOC,MAAP;EACD;;AAf8C;;SAiBlChe,S;;;;;iCAAf,WAAyBgR,GAAzB,EAA8B/P,IAAI,GAAG,MAArC,EAA6C;IAC3C,IAAI2jB,eAAe,CAAC5T,GAAD,EAAM6O,QAAQ,CAAC2B,OAAf,CAAnB,EAA4C;MAC1C,MAAMqD,QAAQ,SAASpG,KAAK,CAACzN,GAAD,CAA5B;;MACA,IAAI,CAAC6T,QAAQ,CAACC,EAAd,EAAkB;QAChB,MAAM,IAAIlU,KAAJ,CAAUiU,QAAQ,CAACE,UAAnB,CAAN;MACD;;MACD,QAAQ9jB,IAAR;QACE,KAAK,aAAL;UACE,OAAO4jB,QAAQ,CAACG,WAAT,EAAP;;QACF,KAAK,MAAL;UACE,OAAOH,QAAQ,CAACI,IAAT,EAAP;;QACF,KAAK,MAAL;UACE,OAAOJ,QAAQ,CAACK,IAAT,EAAP;MANJ;;MAQA,OAAOL,QAAQ,CAACM,IAAT,EAAP;IACD;;IACD,OAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;MACtC,MAAMC,OAAO,GAAG,IAAIC,cAAJ,EAAhB;MACAD,OAAO,CAACE,IAAR,CAAa,KAAb,EAAoBzU,GAApB,EAAyB,IAAzB;MACAuU,OAAO,CAACG,YAAR,GAAuBzkB,IAAvB;;MACAskB,OAAO,CAACI,kBAAR,GAA6B,MAAM;QACjC,IAAIJ,OAAO,CAACK,UAAR,KAAuBJ,cAAc,CAACK,IAA1C,EAAgD;UAC9C;QACD;;QACD,IAAIN,OAAO,CAAC7S,MAAR,KAAmB,GAAnB,IAA0B6S,OAAO,CAAC7S,MAAR,KAAmB,CAAjD,EAAoD;UAClD,QAAQzR,IAAR;YACE,KAAK,aAAL;YACA,KAAK,MAAL;YACA,KAAK,MAAL;cACEokB,OAAO,CAACE,OAAO,CAACV,QAAT,CAAP;cACA;UALJ;;UAOAQ,OAAO,CAACE,OAAO,CAACO,YAAT,CAAP;UACA;QACD;;QACDR,MAAM,CAAC,IAAI1U,KAAJ,CAAU2U,OAAO,CAACR,UAAlB,CAAD,CAAN;MACD,CAhBD;;MAiBAQ,OAAO,CAACQ,IAAR,CAAa,IAAb;IACD,CAtBM,CAAP;EAuBD,C;;;;AACD,MAAMC,oBAAN,SAAmCzH,qBAAnC,CAAyD;EACvDI,UAAU,CAAC3N,GAAD,EAAM0N,eAAN,EAAuB;IAC/B,OAAO1e,SAAS,CAACgR,GAAD,EAAM,KAAKwN,YAAL,GAAoB,aAApB,GAAoC,MAA1C,CAAT,CAA2DyH,IAA3D,CAAgEC,IAAI,KAAK;MAC9EC,QAAQ,EAAED,IAAI,YAAYE,WAAhB,GAA8B,IAAItS,UAAJ,CAAeoS,IAAf,CAA9B,GAAqDtS,aAAa,CAACsS,IAAD,CADE;MAE9ExH;IAF8E,CAAL,CAApE,CAAP;EAID;;AANsD;;AAQzD,MAAM2H,0BAAN,SAAyCvH,2BAAzC,CAAqE;EACnEH,UAAU,CAAC3N,GAAD,EAAM;IACd,OAAOhR,SAAS,CAACgR,GAAD,EAAM,aAAN,CAAT,CAA8BiV,IAA9B,CAAmCC,IAAI,IAAI,IAAIpS,UAAJ,CAAeoS,IAAf,CAA3C,CAAP;EACD;;AAHkE;;AAKrE,MAAM1nB,aAAN,SAA4BwgB,cAA5B,CAA2C;EACzCG,UAAU,CAACle,IAAD,EAAO;IACf,OAAO4e,QAAQ,CAACe,eAAT,CAAyBtB,MAAzB,EAAiCre,IAAjC,CAAP;EACD;;AAHwC;;AAK3C,MAAMqlB,YAAN,CAAmB;EACjBjU,WAAW,CAAC;IACVkU,OADU;IAEVC,KAFU;IAGVC,QAHU;IAIVC,OAAO,GAAG,CAJA;IAKVC,OAAO,GAAG,CALA;IAMVC,QAAQ,GAAG;EAND,CAAD,EAOR;IACD,KAAKL,OAAL,GAAeA,OAAf;IACA,KAAKC,KAAL,GAAaA,KAAb;IACA,KAAKC,QAAL,GAAgBA,QAAhB;IACA,KAAKC,OAAL,GAAeA,OAAf;IACA,KAAKC,OAAL,GAAeA,OAAf;IACA,MAAME,OAAO,GAAG,CAACN,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,IAA4B,CAA5C;IACA,MAAMO,OAAO,GAAG,CAACP,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,IAA4B,CAA5C;IACA,IAAIQ,OAAJ,EAAaC,OAAb,EAAsBC,OAAtB,EAA+BC,OAA/B;IACAT,QAAQ,IAAI,GAAZ;;IACA,IAAIA,QAAQ,GAAG,CAAf,EAAkB;MAChBA,QAAQ,IAAI,GAAZ;IACD;;IACD,QAAQA,QAAR;MACE,KAAK,GAAL;QACEM,OAAO,GAAG,CAAC,CAAX;QACAC,OAAO,GAAG,CAAV;QACAC,OAAO,GAAG,CAAV;QACAC,OAAO,GAAG,CAAV;QACA;;MACF,KAAK,EAAL;QACEH,OAAO,GAAG,CAAV;QACAC,OAAO,GAAG,CAAV;QACAC,OAAO,GAAG,CAAV;QACAC,OAAO,GAAG,CAAV;QACA;;MACF,KAAK,GAAL;QACEH,OAAO,GAAG,CAAV;QACAC,OAAO,GAAG,CAAC,CAAX;QACAC,OAAO,GAAG,CAAC,CAAX;QACAC,OAAO,GAAG,CAAV;QACA;;MACF,KAAK,CAAL;QACEH,OAAO,GAAG,CAAV;QACAC,OAAO,GAAG,CAAV;QACAC,OAAO,GAAG,CAAV;QACAC,OAAO,GAAG,CAAC,CAAX;QACA;;MACF;QACE,MAAM,IAAItW,KAAJ,CAAU,mEAAV,CAAN;IA1BJ;;IA4BA,IAAIgW,QAAJ,EAAc;MACZK,OAAO,GAAG,CAACA,OAAX;MACAC,OAAO,GAAG,CAACA,OAAX;IACD;;IACD,IAAIC,aAAJ,EAAmBC,aAAnB;IACA,IAAItJ,KAAJ,EAAWC,MAAX;;IACA,IAAIgJ,OAAO,KAAK,CAAhB,EAAmB;MACjBI,aAAa,GAAG7T,IAAI,CAAC+F,GAAL,CAASyN,OAAO,GAAGP,OAAO,CAAC,CAAD,CAA1B,IAAiCC,KAAjC,GAAyCE,OAAzD;MACAU,aAAa,GAAG9T,IAAI,CAAC+F,GAAL,CAASwN,OAAO,GAAGN,OAAO,CAAC,CAAD,CAA1B,IAAiCC,KAAjC,GAAyCG,OAAzD;MACA7I,KAAK,GAAG,CAACyI,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,IAA4BC,KAApC;MACAzI,MAAM,GAAG,CAACwI,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,IAA4BC,KAArC;IACD,CALD,MAKO;MACLW,aAAa,GAAG7T,IAAI,CAAC+F,GAAL,CAASwN,OAAO,GAAGN,OAAO,CAAC,CAAD,CAA1B,IAAiCC,KAAjC,GAAyCE,OAAzD;MACAU,aAAa,GAAG9T,IAAI,CAAC+F,GAAL,CAASyN,OAAO,GAAGP,OAAO,CAAC,CAAD,CAA1B,IAAiCC,KAAjC,GAAyCG,OAAzD;MACA7I,KAAK,GAAG,CAACyI,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,IAA4BC,KAApC;MACAzI,MAAM,GAAG,CAACwI,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAArB,IAA4BC,KAArC;IACD;;IACD,KAAKzb,SAAL,GAAiB,CAACgc,OAAO,GAAGP,KAAX,EAAkBQ,OAAO,GAAGR,KAA5B,EAAmCS,OAAO,GAAGT,KAA7C,EAAoDU,OAAO,GAAGV,KAA9D,EAAqEW,aAAa,GAAGJ,OAAO,GAAGP,KAAV,GAAkBK,OAAlC,GAA4CI,OAAO,GAAGT,KAAV,GAAkBM,OAAnI,EAA4IM,aAAa,GAAGJ,OAAO,GAAGR,KAAV,GAAkBK,OAAlC,GAA4CK,OAAO,GAAGV,KAAV,GAAkBM,OAA1M,CAAjB;IACA,KAAKhJ,KAAL,GAAaA,KAAb;IACA,KAAKC,MAAL,GAAcA,MAAd;EACD;;EACU,IAAPsJ,OAAO,GAAG;IACZ,MAAM;MACJd;IADI,IAEF,IAFJ;IAGA,OAAO7lB,MAAM,CAAC,IAAD,EAAO,SAAP,EAAkB;MAC7B4mB,SAAS,EAAEf,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CADF;MAE7BgB,UAAU,EAAEhB,OAAO,CAAC,CAAD,CAAP,GAAaA,OAAO,CAAC,CAAD,CAFH;MAG7BiB,KAAK,EAAEjB,OAAO,CAAC,CAAD,CAHe;MAI7BkB,KAAK,EAAElB,OAAO,CAAC,CAAD;IAJe,CAAlB,CAAb;EAMD;;EACDmB,KAAK,CAAC;IACJlB,KAAK,GAAG,KAAKA,KADT;IAEJC,QAAQ,GAAG,KAAKA,QAFZ;IAGJC,OAAO,GAAG,KAAKA,OAHX;IAIJC,OAAO,GAAG,KAAKA,OAJX;IAKJC,QAAQ,GAAG;EALP,IAMF,EANC,EAMG;IACN,OAAO,IAAIN,YAAJ,CAAiB;MACtBC,OAAO,EAAE,KAAKA,OAAL,CAAazP,KAAb,EADa;MAEtB0P,KAFsB;MAGtBC,QAHsB;MAItBC,OAJsB;MAKtBC,OALsB;MAMtBC;IANsB,CAAjB,CAAP;EAQD;;EACDe,sBAAsB,CAACzO,CAAD,EAAIC,CAAJ,EAAO;IAC3B,OAAOxZ,IAAI,CAAC0W,cAAL,CAAoB,CAAC6C,CAAD,EAAIC,CAAJ,CAApB,EAA4B,KAAKpO,SAAjC,CAAP;EACD;;EACD6c,0BAA0B,CAAC/P,IAAD,EAAO;IAC/B,MAAMgQ,OAAO,GAAGloB,IAAI,CAAC0W,cAAL,CAAoB,CAACwB,IAAI,CAAC,CAAD,CAAL,EAAUA,IAAI,CAAC,CAAD,CAAd,CAApB,EAAwC,KAAK9M,SAA7C,CAAhB;IACA,MAAM+c,WAAW,GAAGnoB,IAAI,CAAC0W,cAAL,CAAoB,CAACwB,IAAI,CAAC,CAAD,CAAL,EAAUA,IAAI,CAAC,CAAD,CAAd,CAApB,EAAwC,KAAK9M,SAA7C,CAApB;IACA,OAAO,CAAC8c,OAAO,CAAC,CAAD,CAAR,EAAaA,OAAO,CAAC,CAAD,CAApB,EAAyBC,WAAW,CAAC,CAAD,CAApC,EAAyCA,WAAW,CAAC,CAAD,CAApD,CAAP;EACD;;EACDC,iBAAiB,CAAC7O,CAAD,EAAIC,CAAJ,EAAO;IACtB,OAAOxZ,IAAI,CAAC+W,qBAAL,CAA2B,CAACwC,CAAD,EAAIC,CAAJ,CAA3B,EAAmC,KAAKpO,SAAxC,CAAP;EACD;;AA3GgB;;AA6GnB,MAAMvL,2BAAN,SAA0CyS,aAA1C,CAAwD;EACtDI,WAAW,CAAC9B,GAAD,EAAMyX,UAAU,GAAG,CAAnB,EAAsB;IAC/B,MAAMzX,GAAN,EAAW,6BAAX;IACA,KAAKyX,UAAL,GAAkBA,UAAlB;EACD;;AAJqD;;AAMxD,SAAS3nB,YAAT,CAAsB2Q,GAAtB,EAA2B;EACzB,MAAMoJ,EAAE,GAAGpJ,GAAG,CAACQ,MAAf;EACA,IAAI4B,CAAC,GAAG,CAAR;;EACA,OAAOA,CAAC,GAAGgH,EAAJ,IAAUpJ,GAAG,CAACoC,CAAD,CAAH,CAAO6U,IAAP,OAAkB,EAAnC,EAAuC;IACrC7U,CAAC;EACF;;EACD,OAAOpC,GAAG,CAACkX,SAAJ,CAAc9U,CAAd,EAAiBA,CAAC,GAAG,CAArB,EAAwB+U,WAAxB,OAA0C,OAAjD;AACD;;AACD,SAAS7nB,SAAT,CAAmBye,QAAnB,EAA6B;EAC3B,OAAO,OAAOA,QAAP,KAAoB,QAApB,IAAgC,UAAUqJ,IAAV,CAAerJ,QAAf,CAAvC;AACD;;AACD,SAAS7e,kBAAT,CAA4B8Q,GAA5B,EAAiC;EAC/B,CAACA,GAAD,IAAQA,GAAG,CAACyQ,KAAJ,CAAU,MAAV,EAAkB,CAAlB,CAAR;EACA,OAAOzQ,GAAG,CAACkX,SAAJ,CAAclX,GAAG,CAACqX,WAAJ,CAAgB,GAAhB,IAAuB,CAArC,CAAP;AACD;;AACD,SAASloB,qBAAT,CAA+B6Q,GAA/B,EAAoCsX,eAAe,GAAG,cAAtD,EAAsE;EACpE,IAAI,OAAOtX,GAAP,KAAe,QAAnB,EAA6B;IAC3B,OAAOsX,eAAP;EACD;;EACD,IAAIjoB,YAAY,CAAC2Q,GAAD,CAAhB,EAAuB;IACrBN,IAAI,CAAC,oEAAD,CAAJ;IACA,OAAO4X,eAAP;EACD;;EACD,MAAMC,KAAK,GAAG,qDAAd;EACA,MAAMC,UAAU,GAAG,+BAAnB;EACA,MAAMC,QAAQ,GAAGF,KAAK,CAACG,IAAN,CAAW1X,GAAX,CAAjB;EACA,IAAI2X,iBAAiB,GAAGH,UAAU,CAACE,IAAX,CAAgBD,QAAQ,CAAC,CAAD,CAAxB,KAAgCD,UAAU,CAACE,IAAX,CAAgBD,QAAQ,CAAC,CAAD,CAAxB,CAAhC,IAAgED,UAAU,CAACE,IAAX,CAAgBD,QAAQ,CAAC,CAAD,CAAxB,CAAxF;;EACA,IAAIE,iBAAJ,EAAuB;IACrBA,iBAAiB,GAAGA,iBAAiB,CAAC,CAAD,CAArC;;IACA,IAAIA,iBAAiB,CAACzT,QAAlB,CAA2B,GAA3B,CAAJ,EAAqC;MACnC,IAAI;QACFyT,iBAAiB,GAAGH,UAAU,CAACE,IAAX,CAAgBnO,kBAAkB,CAACoO,iBAAD,CAAlC,EAAuD,CAAvD,CAApB;MACD,CAFD,CAEE,MAAM,CAAE;IACX;EACF;;EACD,OAAOA,iBAAiB,IAAIL,eAA5B;AACD;;AACD,MAAMM,SAAN,CAAgB;EACdC,OAAO,GAAG1rB,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAH;EACPyU,KAAK,GAAG,EAAH;;EACLC,IAAI,CAAC3W,IAAD,EAAO;IACT,IAAIA,IAAI,IAAI,KAAKyW,OAAjB,EAA0B;MACxBnY,IAAI,CAAE,gCAA+B0B,IAAK,EAAtC,CAAJ;IACD;;IACD,KAAKyW,OAAL,CAAazW,IAAb,IAAqB6I,IAAI,CAAC+N,GAAL,EAArB;EACD;;EACDC,OAAO,CAAC7W,IAAD,EAAO;IACZ,IAAI,EAAEA,IAAI,IAAI,KAAKyW,OAAf,CAAJ,EAA6B;MAC3BnY,IAAI,CAAE,kCAAiC0B,IAAK,EAAxC,CAAJ;IACD;;IACD,KAAK0W,KAAL,CAAWpV,IAAX,CAAgB;MACdtB,IADc;MAEdoQ,KAAK,EAAE,KAAKqG,OAAL,CAAazW,IAAb,CAFO;MAGdqQ,GAAG,EAAExH,IAAI,CAAC+N,GAAL;IAHS,CAAhB;IAKA,OAAO,KAAKH,OAAL,CAAazW,IAAb,CAAP;EACD;;EACDsD,QAAQ,GAAG;IACT,MAAMwT,MAAM,GAAG,EAAf;IACA,IAAIC,OAAO,GAAG,CAAd;;IACA,KAAK,MAAM;MACT/W;IADS,CAAX,IAEK,KAAK0W,KAFV,EAEiB;MACfK,OAAO,GAAG7V,IAAI,CAAC2D,GAAL,CAAS7E,IAAI,CAACZ,MAAd,EAAsB2X,OAAtB,CAAV;IACD;;IACD,KAAK,MAAM;MACT/W,IADS;MAEToQ,KAFS;MAGTC;IAHS,CAAX,IAIK,KAAKqG,KAJV,EAIiB;MACfI,MAAM,CAACxV,IAAP,CAAa,GAAEtB,IAAI,CAACgX,MAAL,CAAYD,OAAZ,CAAqB,IAAG1G,GAAG,GAAGD,KAAM,MAAnD;IACD;;IACD,OAAO0G,MAAM,CAACvV,IAAP,CAAY,EAAZ,CAAP;EACD;;AApCa;;AAsChB,SAASiR,eAAT,CAAyB5T,GAAzB,EAA8BE,OAA9B,EAAuC;EACrC,IAAI;IACF,MAAM;MACJD;IADI,IAEFC,OAAO,GAAG,IAAIU,GAAJ,CAAQZ,GAAR,EAAaE,OAAb,CAAH,GAA2B,IAAIU,GAAJ,CAAQZ,GAAR,CAFtC;IAGA,OAAOC,QAAQ,KAAK,OAAb,IAAwBA,QAAQ,KAAK,QAA5C;EACD,CALD,CAKE,MAAM;IACN,OAAO,KAAP;EACD;AACF;;AACD,SAAS1Q,aAAT,CAAuB8oB,CAAvB,EAA0B;EACxBA,CAAC,CAACC,cAAF;AACD;;AACD,SAASC,UAAT,CAAoB9W,OAApB,EAA6B;EAC3BjC,OAAO,CAACC,GAAR,CAAY,2BAA2BgC,OAAvC;AACD;;AACD,IAAI+W,kBAAJ;;AACA,MAAMrqB,aAAN,CAAoB;EACC,OAAZsqB,YAAY,CAACC,KAAD,EAAQ;IACzB,IAAI,CAACA,KAAD,IAAU,OAAOA,KAAP,KAAiB,QAA/B,EAAyC;MACvC,OAAO,IAAP;IACD;;IACDF,kBAAkB,KAAK,IAAIG,MAAJ,CAAW,QAAQ,UAAR,GAAqB,WAArB,GAAmC,WAAnC,GAAiD,WAAjD,GAA+D,WAA/D,GAA6E,WAA7E,GAA2F,YAA3F,GAA0G,WAA1G,GAAwH,IAAxH,GAA+H,WAA/H,GAA6I,IAAxJ,CAAvB;IACA,MAAMC,OAAO,GAAGJ,kBAAkB,CAACd,IAAnB,CAAwBgB,KAAxB,CAAhB;;IACA,IAAI,CAACE,OAAL,EAAc;MACZ,OAAO,IAAP;IACD;;IACD,MAAMC,IAAI,GAAGC,QAAQ,CAACF,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAArB;IACA,IAAIG,KAAK,GAAGD,QAAQ,CAACF,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAApB;IACAG,KAAK,GAAGA,KAAK,IAAI,CAAT,IAAcA,KAAK,IAAI,EAAvB,GAA4BA,KAAK,GAAG,CAApC,GAAwC,CAAhD;IACA,IAAIC,GAAG,GAAGF,QAAQ,CAACF,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAlB;IACAI,GAAG,GAAGA,GAAG,IAAI,CAAP,IAAYA,GAAG,IAAI,EAAnB,GAAwBA,GAAxB,GAA8B,CAApC;IACA,IAAIC,IAAI,GAAGH,QAAQ,CAACF,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAnB;IACAK,IAAI,GAAGA,IAAI,IAAI,CAAR,IAAaA,IAAI,IAAI,EAArB,GAA0BA,IAA1B,GAAiC,CAAxC;IACA,IAAIC,MAAM,GAAGJ,QAAQ,CAACF,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAArB;IACAM,MAAM,GAAGA,MAAM,IAAI,CAAV,IAAeA,MAAM,IAAI,EAAzB,GAA8BA,MAA9B,GAAuC,CAAhD;IACA,IAAI1S,MAAM,GAAGsS,QAAQ,CAACF,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAArB;IACApS,MAAM,GAAGA,MAAM,IAAI,CAAV,IAAeA,MAAM,IAAI,EAAzB,GAA8BA,MAA9B,GAAuC,CAAhD;IACA,MAAM2S,qBAAqB,GAAGP,OAAO,CAAC,CAAD,CAAP,IAAc,GAA5C;IACA,IAAIQ,UAAU,GAAGN,QAAQ,CAACF,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAzB;IACAQ,UAAU,GAAGA,UAAU,IAAI,CAAd,IAAmBA,UAAU,IAAI,EAAjC,GAAsCA,UAAtC,GAAmD,CAAhE;IACA,IAAIC,YAAY,GAAGP,QAAQ,CAACF,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CAAR,IAA4B,CAA/C;IACAS,YAAY,GAAGA,YAAY,IAAI,CAAhB,IAAqBA,YAAY,IAAI,EAArC,GAA0CA,YAA1C,GAAyD,CAAxE;;IACA,IAAIF,qBAAqB,KAAK,GAA9B,EAAmC;MACjCF,IAAI,IAAIG,UAAR;MACAF,MAAM,IAAIG,YAAV;IACD,CAHD,MAGO,IAAIF,qBAAqB,KAAK,GAA9B,EAAmC;MACxCF,IAAI,IAAIG,UAAR;MACAF,MAAM,IAAIG,YAAV;IACD;;IACD,OAAO,IAAIpP,IAAJ,CAASA,IAAI,CAACqP,GAAL,CAAST,IAAT,EAAeE,KAAf,EAAsBC,GAAtB,EAA2BC,IAA3B,EAAiCC,MAAjC,EAAyC1S,MAAzC,CAAT,CAAP;EACD;;AAlCiB;;AAoCpB,SAASpX,kBAAT,CAA4BmqB,OAA5B,EAAqC;EACnC/D,KAAK,GAAG,CAD2B;EAEnCC,QAAQ,GAAG;AAFwB,CAArC,EAGG;EACD,MAAM;IACJ3I,KADI;IAEJC;EAFI,IAGFwM,OAAO,CAACC,UAAR,CAAmBnK,KAHvB;EAIA,MAAMkG,OAAO,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAOuD,QAAQ,CAAChM,KAAD,CAAf,EAAwBgM,QAAQ,CAAC/L,MAAD,CAAhC,CAAhB;EACA,OAAO,IAAIuI,YAAJ,CAAiB;IACtBC,OADsB;IAEtBC,KAFsB;IAGtBC;EAHsB,CAAjB,CAAP;AAKD;;AACD,SAAStE,MAAT,CAAgBE,KAAhB,EAAuB;EACrB,IAAIA,KAAK,CAAChR,UAAN,CAAiB,GAAjB,CAAJ,EAA2B;IACzB,MAAMoZ,QAAQ,GAAGX,QAAQ,CAACzH,KAAK,CAACvL,KAAN,CAAY,CAAZ,CAAD,EAAiB,EAAjB,CAAzB;IACA,OAAO,CAAC,CAAC2T,QAAQ,GAAG,QAAZ,KAAyB,EAA1B,EAA8B,CAACA,QAAQ,GAAG,QAAZ,KAAyB,CAAvD,EAA0DA,QAAQ,GAAG,QAArE,CAAP;EACD;;EACD,IAAIpI,KAAK,CAAChR,UAAN,CAAiB,MAAjB,CAAJ,EAA8B;IAC5B,OAAOgR,KAAK,CAACvL,KAAN,CAAY,CAAZ,EAAe,CAAC,CAAhB,EAAmB2K,KAAnB,CAAyB,GAAzB,EAA8BrN,GAA9B,CAAkC8E,CAAC,IAAI4Q,QAAQ,CAAC5Q,CAAD,CAA/C,CAAP;EACD;;EACD,IAAImJ,KAAK,CAAChR,UAAN,CAAiB,OAAjB,CAAJ,EAA+B;IAC7B,OAAOgR,KAAK,CAACvL,KAAN,CAAY,CAAZ,EAAe,CAAC,CAAhB,EAAmB2K,KAAnB,CAAyB,GAAzB,EAA8BrN,GAA9B,CAAkC8E,CAAC,IAAI4Q,QAAQ,CAAC5Q,CAAD,CAA/C,EAAoDpC,KAApD,CAA0D,CAA1D,EAA6D,CAA7D,CAAP;EACD;;EACDpG,IAAI,CAAE,8BAA6B2R,KAAM,GAArC,CAAJ;EACA,OAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAP;AACD;;AACD,SAASqI,cAAT,CAAwBC,MAAxB,EAAgC;EAC9B,MAAMC,IAAI,GAAG/K,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAAb;EACAuL,IAAI,CAACvK,KAAL,CAAWC,UAAX,GAAwB,QAAxB;EACAT,QAAQ,CAACiB,IAAT,CAAcD,MAAd,CAAqB+J,IAArB;;EACA,KAAK,MAAMxY,IAAX,IAAmBuY,MAAM,CAACzW,IAAP,EAAnB,EAAkC;IAChC0W,IAAI,CAACvK,KAAL,CAAWgC,KAAX,GAAmBjQ,IAAnB;IACA,MAAMyY,aAAa,GAAGC,MAAM,CAACtG,gBAAP,CAAwBoG,IAAxB,EAA8BvI,KAApD;IACAsI,MAAM,CAAC9I,GAAP,CAAWzP,IAAX,EAAiB+P,MAAM,CAAC0I,aAAD,CAAvB;EACD;;EACDD,IAAI,CAAC3I,MAAL;AACD;;AACD,SAAS8I,mBAAT,CAA6BC,GAA7B,EAAkC;EAChC,MAAM;IACJ3T,CADI;IAEJtB,CAFI;IAGJuB,CAHI;IAIJxa,CAJI;IAKJusB,CALI;IAMJ4B;EANI,IAOFD,GAAG,CAACE,YAAJ,EAPJ;EAQA,OAAO,CAAC7T,CAAD,EAAItB,CAAJ,EAAOuB,CAAP,EAAUxa,CAAV,EAAausB,CAAb,EAAgB4B,CAAhB,CAAP;AACD;;AACD,SAASE,0BAAT,CAAoCH,GAApC,EAAyC;EACvC,MAAM;IACJ3T,CADI;IAEJtB,CAFI;IAGJuB,CAHI;IAIJxa,CAJI;IAKJusB,CALI;IAMJ4B;EANI,IAOFD,GAAG,CAACE,YAAJ,GAAmBE,UAAnB,EAPJ;EAQA,OAAO,CAAC/T,CAAD,EAAItB,CAAJ,EAAOuB,CAAP,EAAUxa,CAAV,EAAausB,CAAb,EAAgB4B,CAAhB,CAAP;AACD;;AACD,SAASxqB,kBAAT,CAA4B2f,GAA5B,EAAiCiL,QAAjC,EAA2CC,QAAQ,GAAG,KAAtD,EAA6DC,UAAU,GAAG,IAA1E,EAAgF;EAC9E,IAAIF,QAAQ,YAAY/E,YAAxB,EAAsC;IACpC,MAAM;MACJgB,SADI;MAEJC;IAFI,IAGF8D,QAAQ,CAAChE,OAHb;IAIA,MAAM;MACJhH;IADI,IAEFD,GAFJ;IAGA,MAAMoL,QAAQ,GAAG7sB,gBAAgB,CAACwW,mBAAlC;IACA,MAAMsW,CAAC,GAAI,yBAAwBnE,SAAU,IAA7C;IAAA,MACEoE,CAAC,GAAI,yBAAwBnE,UAAW,IAD1C;IAEA,MAAMoE,QAAQ,GAAGH,QAAQ,GAAI,SAAQC,CAAE,QAAd,GAAyB,QAAOA,CAAE,GAA3D;IAAA,MACEG,SAAS,GAAGJ,QAAQ,GAAI,SAAQE,CAAE,QAAd,GAAyB,QAAOA,CAAE,GADxD;;IAEA,IAAI,CAACJ,QAAD,IAAaD,QAAQ,CAAC5E,QAAT,GAAoB,GAApB,KAA4B,CAA7C,EAAgD;MAC9CpG,KAAK,CAACvC,KAAN,GAAc6N,QAAd;MACAtL,KAAK,CAACtC,MAAN,GAAe6N,SAAf;IACD,CAHD,MAGO;MACLvL,KAAK,CAACvC,KAAN,GAAc8N,SAAd;MACAvL,KAAK,CAACtC,MAAN,GAAe4N,QAAf;IACD;EACF;;EACD,IAAIJ,UAAJ,EAAgB;IACdnL,GAAG,CAAChB,YAAJ,CAAiB,oBAAjB,EAAuCiM,QAAQ,CAAC5E,QAAhD;EACD;AACF;;AAED,C,CAAC;;AAED,MAAMoF,aAAN,CAAoB;EAClB,CAACC,OAAD,GAAW,IAAX;EACA,CAACC,WAAD,GAAe,IAAf;EACA,CAACC,MAAD;EACA,CAACC,OAAD,GAAW,IAAX;EACA,CAACC,OAAD,GAAW,IAAX;EACA,OAAO,CAACC,UAAR,GAAqB,IAArB;;EACA9Z,WAAW,CAAC2Z,MAAD,EAAS;IAClB,KAAK,CAACA,MAAN,GAAeA,MAAf;IACAH,aAAa,CAAC,CAACM,UAAf,KAA8BhvB,MAAM,CAACivB,MAAP,CAAc;MAC1CC,QAAQ,EAAE,qCADgC;MAE1CC,SAAS,EAAE,sCAF+B;MAG1CC,GAAG,EAAE,gCAHqC;MAI1CC,KAAK,EAAE;IAJmC,CAAd,CAA9B;EAMD;;EACDC,MAAM,GAAG;IACP,MAAMC,WAAW,GAAG,KAAK,CAACZ,OAAN,GAAgBjM,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAApC;IACAqN,WAAW,CAACC,SAAZ,GAAwB,aAAxB;IACAD,WAAW,CAACtN,YAAZ,CAAyB,MAAzB,EAAiC,SAAjC;IACA,MAAMwN,MAAM,GAAG,KAAK,CAACZ,MAAN,CAAaa,UAAb,CAAwBC,OAAvC;IACAJ,WAAW,CAACK,gBAAZ,CAA6B,aAA7B,EAA4CxsB,aAA5C,EAA2D;MACzDqsB;IADyD,CAA3D;IAGAF,WAAW,CAACK,gBAAZ,CAA6B,aAA7B,EAA4ClB,aAAa,CAAC,CAACmB,WAA3D,EAAwE;MACtEJ;IADsE,CAAxE;IAGA,MAAMX,OAAO,GAAG,KAAK,CAACA,OAAN,GAAgBpM,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAhC;IACA4M,OAAO,CAACU,SAAR,GAAoB,SAApB;IACAD,WAAW,CAAC7L,MAAZ,CAAmBoL,OAAnB;IACA,MAAMzL,QAAQ,GAAG,KAAK,CAACwL,MAAN,CAAaiB,eAA9B;;IACA,IAAIzM,QAAJ,EAAc;MACZ,MAAM;QACJH;MADI,IAEFqM,WAFJ;MAGA,MAAMxT,CAAC,GAAG,KAAK,CAAC8S,MAAN,CAAaa,UAAb,CAAwBK,SAAxB,KAAsC,KAAtC,GAA8C,IAAI1M,QAAQ,CAAC,CAAD,CAA1D,GAAgEA,QAAQ,CAAC,CAAD,CAAlF;MACAH,KAAK,CAAC8M,cAAN,GAAwB,GAAE,MAAMjU,CAAE,GAAlC;MACAmH,KAAK,CAACI,GAAN,GAAa,QAAO,MAAMD,QAAQ,CAAC,CAAD,CAAI,wCAAtC;IACD;;IACD,KAAK,CAAC4M,eAAN;IACA,OAAOV,WAAP;EACD;;EACkB,OAAZ,CAACM,WAAW,CAAC3D,CAAD,EAAI;IACrBA,CAAC,CAACgE,eAAF;EACD;;EACD,CAACC,OAAO,CAACjE,CAAD,EAAI;IACV,KAAK,CAAC2C,MAAN,CAAauB,mBAAb,GAAmC,KAAnC;IACAlE,CAAC,CAACC,cAAF;IACAD,CAAC,CAACgE,eAAF;EACD;;EACD,CAACG,QAAQ,CAACnE,CAAD,EAAI;IACX,KAAK,CAAC2C,MAAN,CAAauB,mBAAb,GAAmC,IAAnC;IACAlE,CAAC,CAACC,cAAF;IACAD,CAAC,CAACgE,eAAF;EACD;;EACD,CAACI,qBAAqB,CAACC,OAAD,EAAU;IAC9B,MAAMd,MAAM,GAAG,KAAK,CAACZ,MAAN,CAAaa,UAAb,CAAwBC,OAAvC;IACAY,OAAO,CAACX,gBAAR,CAAyB,SAAzB,EAAoC,KAAK,CAACO,OAAN,CAAcxK,IAAd,CAAmB,IAAnB,CAApC,EAA8D;MAC5D6K,OAAO,EAAE,IADmD;MAE5Df;IAF4D,CAA9D;IAIAc,OAAO,CAACX,gBAAR,CAAyB,UAAzB,EAAqC,KAAK,CAACS,QAAN,CAAe1K,IAAf,CAAoB,IAApB,CAArC,EAAgE;MAC9D6K,OAAO,EAAE,IADqD;MAE9Df;IAF8D,CAAhE;IAIAc,OAAO,CAACX,gBAAR,CAAyB,aAAzB,EAAwCxsB,aAAxC,EAAuD;MACrDqsB;IADqD,CAAvD;EAGD;;EACDgB,IAAI,GAAG;IACL,KAAK,CAAC9B,OAAN,CAAc+B,SAAd,CAAwBC,GAAxB,CAA4B,QAA5B;IACA,KAAK,CAAC/B,WAAN,EAAmBgC,YAAnB;EACD;;EACDC,IAAI,GAAG;IACL,KAAK,CAAClC,OAAN,CAAc+B,SAAd,CAAwB5L,MAAxB,CAA+B,QAA/B;IACA,KAAK,CAACiK,OAAN,EAAe+B,KAAf;EACD;;EACD,CAACb,eAAe,GAAG;IACjB,MAAM;MACJc,UADI;MAEJrB;IAFI,IAGF,KAAK,CAACb,MAHV;IAIA,MAAMmC,MAAM,GAAGtO,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAf;IACA8O,MAAM,CAACxB,SAAP,GAAmB,QAAnB;IACAwB,MAAM,CAACC,QAAP,GAAkB,CAAlB;IACAD,MAAM,CAAC/O,YAAP,CAAoB,cAApB,EAAoCyM,aAAa,CAAC,CAACM,UAAf,CAA0B+B,UAA1B,CAApC;IACA,KAAK,CAACT,qBAAN,CAA4BU,MAA5B;IACAA,MAAM,CAACpB,gBAAP,CAAwB,OAAxB,EAAiC1D,CAAC,IAAI;MACpCwD,UAAU,CAACwB,MAAX;IACD,CAFD,EAEG;MACDzB,MAAM,EAAEC,UAAU,CAACC;IADlB,CAFH;IAKA,KAAK,CAACb,OAAN,CAAcpL,MAAd,CAAqBsN,MAArB;EACD;;EACW,IAAR,CAACG,OAAO,GAAG;IACb,MAAMA,OAAO,GAAGzO,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAhB;IACAiP,OAAO,CAAC3B,SAAR,GAAoB,SAApB;IACA,OAAO2B,OAAP;EACD;;EACKC,UAAU,CAACrC,OAAD,EAAU;IAAA;;IAAA;MACxB,MAAMiC,MAAM,SAASjC,OAAO,CAACO,MAAR,EAArB;;MACA,MAAI,CAAC,CAACgB,qBAAN,CAA4BU,MAA5B;;MACA,MAAI,CAAC,CAAClC,OAAN,CAAcuC,OAAd,CAAsBL,MAAtB,EAA8B,MAAI,CAAC,CAACG,OAApC;;MACA,MAAI,CAAC,CAACpC,OAAN,GAAgBA,OAAhB;IAJwB;EAKzB;;EACDuC,cAAc,CAAC1C,WAAD,EAAc;IAC1B,KAAK,CAACA,WAAN,GAAoBA,WAApB;IACA,MAAMoC,MAAM,GAAGpC,WAAW,CAAC2C,YAAZ,EAAf;IACA,KAAK,CAACjB,qBAAN,CAA4BU,MAA5B;IACA,KAAK,CAAClC,OAAN,CAAcuC,OAAd,CAAsBL,MAAtB,EAA8B,KAAK,CAACG,OAApC;EACD;;EACDrM,MAAM,GAAG;IACP,KAAK,CAAC6J,OAAN,CAAc7J,MAAd;IACA,KAAK,CAAC8J,WAAN,EAAmBrO,OAAnB;IACA,KAAK,CAACqO,WAAN,GAAoB,IAApB;EACD;;AAnHiB;;AAqHpB,MAAM4C,gBAAN,CAAuB;EACrB,CAAC1C,OAAD,GAAW,IAAX;EACA,CAACH,OAAD,GAAW,IAAX;EACA,CAAC8C,SAAD;;EACAvc,WAAW,CAACuc,SAAD,EAAY;IACrB,KAAK,CAACA,SAAN,GAAkBA,SAAlB;EACD;;EACD,CAACnC,MAAM,GAAG;IACR,MAAMC,WAAW,GAAG,KAAK,CAACZ,OAAN,GAAgBjM,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAApC;IACAqN,WAAW,CAACC,SAAZ,GAAwB,aAAxB;IACAD,WAAW,CAACtN,YAAZ,CAAyB,MAAzB,EAAiC,SAAjC;IACAsN,WAAW,CAACK,gBAAZ,CAA6B,aAA7B,EAA4CxsB,aAA5C,EAA2D;MACzDqsB,MAAM,EAAE,KAAK,CAACgC,SAAN,CAAgB9B;IADiC,CAA3D;IAGA,MAAMb,OAAO,GAAG,KAAK,CAACA,OAAN,GAAgBpM,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAhC;IACA4M,OAAO,CAACU,SAAR,GAAoB,SAApB;IACAD,WAAW,CAAC7L,MAAZ,CAAmBoL,OAAnB;IACA,KAAK,CAAC4C,kBAAN;IACA,OAAOnC,WAAP;EACD;;EACD,CAACoC,YAAY,CAACC,KAAD,EAAQC,KAAR,EAAe;IAC1B,IAAIC,KAAK,GAAG,CAAZ;IACA,IAAIC,KAAK,GAAG,CAAZ;;IACA,KAAK,MAAMC,GAAX,IAAkBJ,KAAlB,EAAyB;MACvB,MAAM5V,CAAC,GAAGgW,GAAG,CAAChW,CAAJ,GAAQgW,GAAG,CAACpR,MAAtB;;MACA,IAAI5E,CAAC,GAAG8V,KAAR,EAAe;QACb;MACD;;MACD,MAAM/V,CAAC,GAAGiW,GAAG,CAACjW,CAAJ,IAAS8V,KAAK,GAAGG,GAAG,CAACrR,KAAP,GAAe,CAA7B,CAAV;;MACA,IAAI3E,CAAC,GAAG8V,KAAR,EAAe;QACbC,KAAK,GAAGhW,CAAR;QACA+V,KAAK,GAAG9V,CAAR;QACA;MACD;;MACD,IAAI6V,KAAJ,EAAW;QACT,IAAI9V,CAAC,GAAGgW,KAAR,EAAe;UACbA,KAAK,GAAGhW,CAAR;QACD;MACF,CAJD,MAIO,IAAIA,CAAC,GAAGgW,KAAR,EAAe;QACpBA,KAAK,GAAGhW,CAAR;MACD;IACF;;IACD,OAAO,CAAC8V,KAAK,GAAG,IAAIE,KAAP,GAAeA,KAArB,EAA4BD,KAA5B,CAAP;EACD;;EACDjB,IAAI,CAACoB,MAAD,EAASL,KAAT,EAAgBC,KAAhB,EAAuB;IACzB,MAAM,CAAC9V,CAAD,EAAIC,CAAJ,IAAS,KAAK,CAAC2V,YAAN,CAAmBC,KAAnB,EAA0BC,KAA1B,CAAf;IACA,MAAM;MACJ3O;IADI,IAEF,KAAK,CAACyL,OAAN,KAAkB,KAAK,CAACW,MAAN,EAFtB;IAGA2C,MAAM,CAACvO,MAAP,CAAc,KAAK,CAACiL,OAApB;IACAzL,KAAK,CAAC8M,cAAN,GAAwB,GAAE,MAAMjU,CAAE,GAAlC;IACAmH,KAAK,CAACI,GAAN,GAAa,QAAO,MAAMtH,CAAE,wCAA5B;EACD;;EACDyU,IAAI,GAAG;IACL,KAAK,CAAC9B,OAAN,CAAc7J,MAAd;EACD;;EACD,CAAC4M,kBAAkB,GAAG;IACpB,MAAMV,MAAM,GAAGtO,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAf;IACA8O,MAAM,CAACxB,SAAP,GAAmB,iBAAnB;IACAwB,MAAM,CAACC,QAAP,GAAkB,CAAlB;IACAD,MAAM,CAAC/O,YAAP,CAAoB,cAApB,EAAqC,kCAArC;IACA,MAAMwL,IAAI,GAAG/K,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAAb;IACA8O,MAAM,CAACtN,MAAP,CAAc+J,IAAd;IACAA,IAAI,CAAC+B,SAAL,GAAiB,gBAAjB;IACA/B,IAAI,CAACxL,YAAL,CAAkB,cAAlB,EAAkC,uCAAlC;IACA,MAAMwN,MAAM,GAAG,KAAK,CAACgC,SAAN,CAAgB9B,OAA/B;IACAqB,MAAM,CAACpB,gBAAP,CAAwB,aAAxB,EAAuCxsB,aAAvC,EAAsD;MACpDqsB;IADoD,CAAtD;IAGAuB,MAAM,CAACpB,gBAAP,CAAwB,OAAxB,EAAiC,MAAM;MACrC,KAAK,CAAC6B,SAAN,CAAgBS,kBAAhB,CAAmC,iBAAnC;IACD,CAFD,EAEG;MACDzC;IADC,CAFH;IAKA,KAAK,CAACX,OAAN,CAAcpL,MAAd,CAAqBsN,MAArB;EACD;;AA3EoB;;AA8EvB,C,CAAC;;AAID,SAASmB,UAAT,CAAoB/xB,GAApB,EAAyBmwB,OAAzB,EAAkC6B,KAAlC,EAAyC;EACvC,KAAK,MAAMnd,IAAX,IAAmBmd,KAAnB,EAA0B;IACxB7B,OAAO,CAACX,gBAAR,CAAyB3a,IAAzB,EAA+B7U,GAAG,CAAC6U,IAAD,CAAH,CAAU0Q,IAAV,CAAevlB,GAAf,CAA/B;EACD;AACF;;AACD,SAASiyB,YAAT,CAAsBC,OAAtB,EAA+B;EAC7B,OAAOnc,IAAI,CAAC0P,KAAL,CAAW1P,IAAI,CAACC,GAAL,CAAS,GAAT,EAAcD,IAAI,CAAC2D,GAAL,CAAS,CAAT,EAAY,MAAMwY,OAAlB,CAAd,CAAX,EAAsD/Z,QAAtD,CAA+D,EAA/D,EAAmEC,QAAnE,CAA4E,CAA5E,EAA+E,GAA/E,CAAP;AACD;;AACD,MAAM+Z,SAAN,CAAgB;EACd,CAAC3P,EAAD,GAAM,CAAN;;EACM,IAAFA,EAAE,GAAG;IACP,OAAQ,GAAEzd,sBAAuB,GAAE,KAAK,CAACyd,EAAN,EAAW,EAA9C;EACD;;AAJa;;AAMhB,MAAM4P,YAAN,CAAmB;EACjB,CAACC,MAAD,GAAU/T,OAAO,EAAjB;EACA,CAACkE,EAAD,GAAM,CAAN;EACA,CAACE,KAAD,GAAS,IAAT;;EAC8B,WAAnB4P,mBAAmB,GAAG;IAC/B,MAAM3Q,GAAG,GAAI,sKAAb;IACA,MAAMlB,MAAM,GAAG,IAAIlJ,eAAJ,CAAoB,CAApB,EAAuB,CAAvB,CAAf;IACA,MAAMkW,GAAG,GAAGhN,MAAM,CAACG,UAAP,CAAkB,IAAlB,EAAwB;MAClCC,kBAAkB,EAAE;IADc,CAAxB,CAAZ;IAGA,MAAM0R,KAAK,GAAG,IAAIC,KAAJ,EAAd;IACAD,KAAK,CAACE,GAAN,GAAY9Q,GAAZ;IACA,MAAM+Q,OAAO,GAAGH,KAAK,CAAC7V,MAAN,GAAegM,IAAf,CAAoB,MAAM;MACxC+E,GAAG,CAACkF,SAAJ,CAAcJ,KAAd,EAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC,EAAuC,CAAvC,EAA0C,CAA1C;MACA,OAAO,IAAIrb,WAAJ,CAAgBuW,GAAG,CAACmF,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6BjK,IAA7B,CAAkCxR,MAAlD,EAA0D,CAA1D,MAAiE,CAAxE;IACD,CAHe,CAAhB;IAIA,OAAOhU,MAAM,CAAC,IAAD,EAAO,qBAAP,EAA8BuvB,OAA9B,CAAb;EACD;;EACK,CAAC3yB,GAAG,CAACL,GAAD,EAAMmzB,OAAN,EAAe;IAAA;;IAAA;MACvB,MAAI,CAAC,CAACnQ,KAAN,KAAgB,IAAIvE,GAAJ,EAAhB;;MACA,IAAIwK,IAAI,GAAG,MAAI,CAAC,CAACjG,KAAN,CAAY3iB,GAAZ,CAAgBL,GAAhB,CAAX;;MACA,IAAIipB,IAAI,KAAK,IAAb,EAAmB;QACjB,OAAO,IAAP;MACD;;MACD,IAAIA,IAAI,EAAEmK,MAAV,EAAkB;QAChBnK,IAAI,CAACoK,UAAL,IAAmB,CAAnB;QACA,OAAOpK,IAAP;MACD;;MACD,IAAI;QACFA,IAAI,KAAK;UACPmK,MAAM,EAAE,IADD;UAEPtQ,EAAE,EAAG,SAAQ,MAAI,CAAC,CAAC6P,MAAO,IAAG,MAAI,CAAC,CAAC7P,EAAN,EAAW,EAFjC;UAGPuQ,UAAU,EAAE,CAHL;UAIPC,KAAK,EAAE;QAJA,CAAT;QAMA,IAAIT,KAAJ;;QACA,IAAI,OAAOM,OAAP,KAAmB,QAAvB,EAAiC;UAC/BlK,IAAI,CAAClV,GAAL,GAAWof,OAAX;UACAN,KAAK,SAAS9vB,SAAS,CAACowB,OAAD,EAAU,MAAV,CAAvB;QACD,CAHD,MAGO;UACLN,KAAK,GAAG5J,IAAI,CAACsK,IAAL,GAAYJ,OAApB;QACD;;QACD,IAAIN,KAAK,CAAC7uB,IAAN,KAAe,eAAnB,EAAoC;UAClC,MAAMwvB,4BAA4B,GAAGd,YAAY,CAACE,mBAAlD;UACA,MAAMa,UAAU,GAAG,IAAIC,UAAJ,EAAnB;UACA,MAAMC,YAAY,GAAG,IAAIb,KAAJ,EAArB;UACA,MAAMc,YAAY,GAAG,IAAIzL,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;YACpDsL,YAAY,CAACE,MAAb,GAAsB,MAAM;cAC1B5K,IAAI,CAACmK,MAAL,GAAcO,YAAd;cACA1K,IAAI,CAACqK,KAAL,GAAa,IAAb;cACAlL,OAAO;YACR,CAJD;;YAKAqL,UAAU,CAACI,MAAX,kCAAoB,aAAY;cAC9B,MAAM9f,GAAG,GAAGkV,IAAI,CAAC6K,MAAL,GAAcL,UAAU,CAACM,MAArC;cACAJ,YAAY,CAACZ,GAAb,GAAmB,OAAOS,4BAAP,IAAwC,GAAEzf,GAAI,qCAA9C,GAAqFA,GAAxG;YACD,CAHD;YAIA4f,YAAY,CAACK,OAAb,GAAuBP,UAAU,CAACO,OAAX,GAAqB3L,MAA5C;UACD,CAXoB,CAArB;UAYAoL,UAAU,CAACQ,aAAX,CAAyBpB,KAAzB;UACA,MAAMe,YAAN;QACD,CAlBD,MAkBO;UACL3K,IAAI,CAACmK,MAAL,SAAoBc,iBAAiB,CAACrB,KAAD,CAArC;QACD;;QACD5J,IAAI,CAACoK,UAAL,GAAkB,CAAlB;MACD,CApCD,CAoCE,OAAOjH,CAAP,EAAU;QACV7Y,OAAO,CAAC4gB,KAAR,CAAc/H,CAAd;QACAnD,IAAI,GAAG,IAAP;MACD;;MACD,MAAI,CAAC,CAACjG,KAAN,CAAY4B,GAAZ,CAAgB5kB,GAAhB,EAAqBipB,IAArB;;MACA,IAAIA,IAAJ,EAAU;QACR,MAAI,CAAC,CAACjG,KAAN,CAAY4B,GAAZ,CAAgBqE,IAAI,CAACnG,EAArB,EAAyBmG,IAAzB;MACD;;MACD,OAAOA,IAAP;IAtDuB;EAuDxB;;EACKmL,WAAW,CAACb,IAAD,EAAO;IAAA;;IAAA;MACtB,MAAM;QACJc,YADI;QAEJlf,IAFI;QAGJwR,IAHI;QAIJ3iB;MAJI,IAKFuvB,IALJ;MAMA,OAAO,MAAI,CAAC,CAAClzB,GAAN,CAAW,GAAEg0B,YAAa,IAAGlf,IAAK,IAAGwR,IAAK,IAAG3iB,IAAK,EAAlD,EAAqDuvB,IAArD,CAAP;IAPsB;EAQvB;;EACKe,UAAU,CAACvgB,GAAD,EAAM;IAAA;;IAAA;MACpB,OAAO,MAAI,CAAC,CAAC1T,GAAN,CAAU0T,GAAV,EAAeA,GAAf,CAAP;IADoB;EAErB;;EACKwgB,SAAS,CAACzR,EAAD,EAAK;IAAA;;IAAA;MAClB,MAAI,CAAC,CAACE,KAAN,KAAgB,IAAIvE,GAAJ,EAAhB;;MACA,MAAMwK,IAAI,GAAG,MAAI,CAAC,CAACjG,KAAN,CAAY3iB,GAAZ,CAAgByiB,EAAhB,CAAb;;MACA,IAAI,CAACmG,IAAL,EAAW;QACT,OAAO,IAAP;MACD;;MACD,IAAIA,IAAI,CAACmK,MAAT,EAAiB;QACfnK,IAAI,CAACoK,UAAL,IAAmB,CAAnB;QACA,OAAOpK,IAAP;MACD;;MACD,IAAIA,IAAI,CAACsK,IAAT,EAAe;QACb,OAAO,MAAI,CAACa,WAAL,CAAiBnL,IAAI,CAACsK,IAAtB,CAAP;MACD;;MACD,OAAO,MAAI,CAACe,UAAL,CAAgBrL,IAAI,CAAClV,GAArB,CAAP;IAbkB;EAcnB;;EACDygB,SAAS,CAAC1R,EAAD,EAAK;IACZ,MAAMmG,IAAI,GAAG,KAAK,CAACjG,KAAN,CAAY3iB,GAAZ,CAAgByiB,EAAhB,CAAb;;IACA,IAAI,CAACmG,IAAI,EAAEqK,KAAX,EAAkB;MAChB,OAAO,IAAP;IACD;;IACD,OAAOrK,IAAI,CAAC6K,MAAZ;EACD;;EACDW,QAAQ,CAAC3R,EAAD,EAAK;IACX,KAAK,CAACE,KAAN,KAAgB,IAAIvE,GAAJ,EAAhB;IACA,MAAMwK,IAAI,GAAG,KAAK,CAACjG,KAAN,CAAY3iB,GAAZ,CAAgByiB,EAAhB,CAAb;;IACA,IAAI,CAACmG,IAAL,EAAW;MACT;IACD;;IACDA,IAAI,CAACoK,UAAL,IAAmB,CAAnB;;IACA,IAAIpK,IAAI,CAACoK,UAAL,KAAoB,CAAxB,EAA2B;MACzB;IACD;;IACDpK,IAAI,CAACmK,MAAL,GAAc,IAAd;EACD;;EACDsB,SAAS,CAAC5R,EAAD,EAAK;IACZ,OAAOA,EAAE,CAAC1O,UAAH,CAAe,SAAQ,KAAK,CAACue,MAAO,GAApC,CAAP;EACD;;AA1HgB;;AA4HnB,MAAMgC,cAAN,CAAqB;EACnB,CAACC,QAAD,GAAY,EAAZ;EACA,CAACC,MAAD,GAAU,KAAV;EACA,CAACC,OAAD;EACA,CAACvR,QAAD,GAAY,CAAC,CAAb;;EACAnO,WAAW,CAAC0f,OAAO,GAAG,GAAX,EAAgB;IACzB,KAAK,CAACA,OAAN,GAAgBA,OAAhB;EACD;;EACDjE,GAAG,CAAC;IACFkE,GADE;IAEFC,IAFE;IAGFC,IAHE;IAIFC,QAJE;IAKFlxB,IAAI,GAAGmxB,GALL;IAMFC,mBAAmB,GAAG,KANpB;IAOFC,QAAQ,GAAG;EAPT,CAAD,EAQA;IACD,IAAIH,QAAJ,EAAc;MACZH,GAAG;IACJ;;IACD,IAAI,KAAK,CAACF,MAAV,EAAkB;MAChB;IACD;;IACD,MAAMjnB,IAAI,GAAG;MACXmnB,GADW;MAEXC,IAFW;MAGXC,IAHW;MAIXjxB;IAJW,CAAb;;IAMA,IAAI,KAAK,CAACuf,QAAN,KAAmB,CAAC,CAAxB,EAA2B;MACzB,IAAI,KAAK,CAACqR,QAAN,CAAergB,MAAf,GAAwB,CAA5B,EAA+B;QAC7B,KAAK,CAACqgB,QAAN,CAAergB,MAAf,GAAwB,CAAxB;MACD;;MACD,KAAK,CAACgP,QAAN,GAAiB,CAAjB;MACA,KAAK,CAACqR,QAAN,CAAene,IAAf,CAAoB7I,IAApB;MACA;IACD;;IACD,IAAIwnB,mBAAmB,IAAI,KAAK,CAACR,QAAN,CAAe,KAAK,CAACrR,QAArB,EAA+Bvf,IAA/B,KAAwCA,IAAnE,EAAyE;MACvE,IAAIqxB,QAAJ,EAAc;QACZznB,IAAI,CAAConB,IAAL,GAAY,KAAK,CAACJ,QAAN,CAAe,KAAK,CAACrR,QAArB,EAA+ByR,IAA3C;MACD;;MACD,KAAK,CAACJ,QAAN,CAAe,KAAK,CAACrR,QAArB,IAAiC3V,IAAjC;MACA;IACD;;IACD,MAAM0nB,IAAI,GAAG,KAAK,CAAC/R,QAAN,GAAiB,CAA9B;;IACA,IAAI+R,IAAI,KAAK,KAAK,CAACR,OAAnB,EAA4B;MAC1B,KAAK,CAACF,QAAN,CAAeW,MAAf,CAAsB,CAAtB,EAAyB,CAAzB;IACD,CAFD,MAEO;MACL,KAAK,CAAChS,QAAN,GAAiB+R,IAAjB;;MACA,IAAIA,IAAI,GAAG,KAAK,CAACV,QAAN,CAAergB,MAA1B,EAAkC;QAChC,KAAK,CAACqgB,QAAN,CAAeW,MAAf,CAAsBD,IAAtB;MACD;IACF;;IACD,KAAK,CAACV,QAAN,CAAene,IAAf,CAAoB7I,IAApB;EACD;;EACDonB,IAAI,GAAG;IACL,IAAI,KAAK,CAACzR,QAAN,KAAmB,CAAC,CAAxB,EAA2B;MACzB;IACD;;IACD,KAAK,CAACsR,MAAN,GAAe,IAAf;IACA,MAAM;MACJG,IADI;MAEJC;IAFI,IAGF,KAAK,CAACL,QAAN,CAAe,KAAK,CAACrR,QAArB,CAHJ;IAIAyR,IAAI;IACJC,IAAI;IACJ,KAAK,CAACJ,MAAN,GAAe,KAAf;IACA,KAAK,CAACtR,QAAN,IAAkB,CAAlB;EACD;;EACDiS,IAAI,GAAG;IACL,IAAI,KAAK,CAACjS,QAAN,GAAiB,KAAK,CAACqR,QAAN,CAAergB,MAAf,GAAwB,CAA7C,EAAgD;MAC9C,KAAK,CAACgP,QAAN,IAAkB,CAAlB;MACA,KAAK,CAACsR,MAAN,GAAe,IAAf;MACA,MAAM;QACJE,GADI;QAEJE;MAFI,IAGF,KAAK,CAACL,QAAN,CAAe,KAAK,CAACrR,QAArB,CAHJ;MAIAwR,GAAG;MACHE,IAAI;MACJ,KAAK,CAACJ,MAAN,GAAe,KAAf;IACD;EACF;;EACDY,kBAAkB,GAAG;IACnB,OAAO,KAAK,CAAClS,QAAN,KAAmB,CAAC,CAA3B;EACD;;EACDmS,kBAAkB,GAAG;IACnB,OAAO,KAAK,CAACnS,QAAN,GAAiB,KAAK,CAACqR,QAAN,CAAergB,MAAf,GAAwB,CAAhD;EACD;;EACDkM,OAAO,GAAG;IACR,KAAK,CAACmU,QAAN,GAAiB,IAAjB;EACD;;AA1FkB;;AA4FrB,MAAMe,eAAN,CAAsB;EACpBvgB,WAAW,CAACwgB,SAAD,EAAY;IACrB,KAAKne,MAAL,GAAc,EAAd;IACA,KAAKme,SAAL,GAAiB,IAAInX,GAAJ,EAAjB;IACA,KAAKoX,OAAL,GAAe,IAAIC,GAAJ,EAAf;IACA,MAAM;MACJ9d;IADI,IAEFtW,gBAAgB,CAACoW,QAFrB;;IAGA,KAAK,MAAM,CAACb,IAAD,EAAO8e,QAAP,EAAiB7hB,OAAO,GAAG,EAA3B,CAAX,IAA6C0hB,SAA7C,EAAwD;MACtD,KAAK,MAAM51B,GAAX,IAAkBiX,IAAlB,EAAwB;QACtB,MAAM+e,QAAQ,GAAGh2B,GAAG,CAACoU,UAAJ,CAAe,MAAf,CAAjB;;QACA,IAAI4D,KAAK,IAAIge,QAAb,EAAuB;UACrB,KAAKJ,SAAL,CAAehR,GAAf,CAAmB5kB,GAAG,CAAC6Z,KAAJ,CAAU,CAAV,CAAnB,EAAiC;YAC/Bkc,QAD+B;YAE/B7hB;UAF+B,CAAjC;UAIA,KAAK2hB,OAAL,CAAahF,GAAb,CAAiB7wB,GAAG,CAACwkB,KAAJ,CAAU,GAAV,EAAeyR,EAAf,CAAkB,CAAC,CAAnB,CAAjB;QACD,CAND,MAMO,IAAI,CAACje,KAAD,IAAU,CAACge,QAAf,EAAyB;UAC9B,KAAKJ,SAAL,CAAehR,GAAf,CAAmB5kB,GAAnB,EAAwB;YACtB+1B,QADsB;YAEtB7hB;UAFsB,CAAxB;UAIA,KAAK2hB,OAAL,CAAahF,GAAb,CAAiB7wB,GAAG,CAACwkB,KAAJ,CAAU,GAAV,EAAeyR,EAAf,CAAkB,CAAC,CAAnB,CAAjB;QACD;MACF;IACF;EACF;;EACD,CAACC,SAAS,CAACC,KAAD,EAAQ;IAChB,IAAIA,KAAK,CAACC,MAAV,EAAkB;MAChB,KAAK3e,MAAL,CAAYhB,IAAZ,CAAiB,KAAjB;IACD;;IACD,IAAI0f,KAAK,CAACE,OAAV,EAAmB;MACjB,KAAK5e,MAAL,CAAYhB,IAAZ,CAAiB,MAAjB;IACD;;IACD,IAAI0f,KAAK,CAACG,OAAV,EAAmB;MACjB,KAAK7e,MAAL,CAAYhB,IAAZ,CAAiB,MAAjB;IACD;;IACD,IAAI0f,KAAK,CAACI,QAAV,EAAoB;MAClB,KAAK9e,MAAL,CAAYhB,IAAZ,CAAiB,OAAjB;IACD;;IACD,KAAKgB,MAAL,CAAYhB,IAAZ,CAAiB0f,KAAK,CAACn2B,GAAvB;IACA,MAAM4W,GAAG,GAAG,KAAKa,MAAL,CAAYf,IAAZ,CAAiB,GAAjB,CAAZ;IACA,KAAKe,MAAL,CAAYlD,MAAZ,GAAqB,CAArB;IACA,OAAOqC,GAAP;EACD;;EACD6U,IAAI,CAAC+K,IAAD,EAAOL,KAAP,EAAc;IAChB,IAAI,CAAC,KAAKN,OAAL,CAAaY,GAAb,CAAiBN,KAAK,CAACn2B,GAAvB,CAAL,EAAkC;MAChC;IACD;;IACD,MAAMqT,IAAI,GAAG,KAAKuiB,SAAL,CAAev1B,GAAf,CAAmB,KAAK,CAAC61B,SAAN,CAAgBC,KAAhB,CAAnB,CAAb;;IACA,IAAI,CAAC9iB,IAAL,EAAW;MACT;IACD;;IACD,MAAM;MACJ0iB,QADI;MAEJ7hB,OAAO,EAAE;QACPwiB,OAAO,GAAG,KADH;QAEPC,IAAI,GAAG,EAFA;QAGPC,OAAO,GAAG;MAHH;IAFL,IAOFvjB,IAPJ;;IAQA,IAAIujB,OAAO,IAAI,CAACA,OAAO,CAACJ,IAAD,EAAOL,KAAP,CAAvB,EAAsC;MACpC;IACD;;IACDJ,QAAQ,CAAClQ,IAAT,CAAc2Q,IAAd,EAAoB,GAAGG,IAAvB,EAA6BR,KAA7B;;IACA,IAAI,CAACO,OAAL,EAAc;MACZP,KAAK,CAAC/F,eAAN;MACA+F,KAAK,CAAC9J,cAAN;IACD;EACF;;AArEmB;;AAuEtB,MAAMwK,YAAN,CAAmB;EACI,OAAdC,cAAc,GAAG,IAAIrY,GAAJ,CAAQ,CAAC,CAAC,YAAD,EAAe,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAf,CAAD,EAA4B,CAAC,QAAD,EAAW,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAAX,CAA5B,CAAR,CAAH;;EACV,IAAPsY,OAAO,GAAG;IACZ,MAAMrJ,MAAM,GAAG,IAAIjP,GAAJ,CAAQ,CAAC,CAAC,YAAD,EAAe,IAAf,CAAD,EAAuB,CAAC,QAAD,EAAW,IAAX,CAAvB,CAAR,CAAf;IACAgP,cAAc,CAACC,MAAD,CAAd;IACA,OAAOjqB,MAAM,CAAC,IAAD,EAAO,SAAP,EAAkBiqB,MAAlB,CAAb;EACD;;EACDsJ,OAAO,CAAC5R,KAAD,EAAQ;IACb,MAAM6R,GAAG,GAAG/R,MAAM,CAACE,KAAD,CAAlB;;IACA,IAAI,CAACyI,MAAM,CAACqJ,UAAP,CAAkB,yBAAlB,EAA6CvK,OAAlD,EAA2D;MACzD,OAAOsK,GAAP;IACD;;IACD,KAAK,MAAM,CAAC9hB,IAAD,EAAOgiB,GAAP,CAAX,IAA0B,KAAKJ,OAA/B,EAAwC;MACtC,IAAII,GAAG,CAACC,KAAJ,CAAU,CAACnb,CAAD,EAAI9F,CAAJ,KAAU8F,CAAC,KAAKgb,GAAG,CAAC9gB,CAAD,CAA7B,CAAJ,EAAuC;QACrC,OAAO0gB,YAAY,CAACC,cAAb,CAA4Bz2B,GAA5B,CAAgC8U,IAAhC,CAAP;MACD;IACF;;IACD,OAAO8hB,GAAP;EACD;;EACDI,UAAU,CAACliB,IAAD,EAAO;IACf,MAAM8hB,GAAG,GAAG,KAAKF,OAAL,CAAa12B,GAAb,CAAiB8U,IAAjB,CAAZ;;IACA,IAAI,CAAC8hB,GAAL,EAAU;MACR,OAAO9hB,IAAP;IACD;;IACD,OAAOzS,IAAI,CAACiW,YAAL,CAAkB,GAAGse,GAArB,CAAP;EACD;;AAzBgB;;AA2BnB,MAAM/1B,yBAAN,CAAgC;EAC9B,CAACo2B,eAAD,GAAmB,IAAIC,eAAJ,EAAnB;EACA,CAACC,YAAD,GAAgB,IAAhB;EACA,CAACC,UAAD,GAAc,IAAIhZ,GAAJ,EAAd;EACA,CAACiZ,SAAD,GAAa,IAAIjZ,GAAJ,EAAb;EACA,CAACkZ,cAAD,GAAkB,IAAlB;EACA,CAACC,iBAAD,GAAqB,IAArB;EACA,CAACC,0BAAD,GAA8B,IAA9B;EACA,CAACC,cAAD,GAAkB,IAAInD,cAAJ,EAAlB;EACA,CAACoD,WAAD,GAAe,IAAf;EACA,CAACC,gBAAD,GAAoB,CAApB;EACA,CAACC,4BAAD,GAAgC,IAAInC,GAAJ,EAAhC;EACA,CAACoC,eAAD,GAAmB,IAAnB;EACA,CAACC,WAAD,GAAe,IAAf;EACA,CAACC,gBAAD,GAAoB,IAAItC,GAAJ,EAApB;EACA,CAACuC,6BAAD,GAAiC,KAAjC;EACA,CAACC,qBAAD,GAAyB,KAAzB;EACA,CAACC,+BAAD,GAAmC,KAAnC;EACA,CAACC,aAAD,GAAiB,IAAjB;EACA,CAACC,2BAAD,GAA+B,IAA/B;EACA,CAACC,cAAD,GAAkB,IAAlB;EACA,CAACC,eAAD,GAAmB,IAAnB;EACA,CAACC,oBAAD,GAAwB,KAAxB;EACA,CAACC,gBAAD,GAAoB,IAApB;EACA,CAACC,SAAD,GAAa,IAAIrG,SAAJ,EAAb;EACA,CAACsG,SAAD,GAAa,KAAb;EACA,CAACC,SAAD,GAAa,KAAb;EACA,CAACC,iBAAD,GAAqB,IAArB;EACA,CAACC,iBAAD,GAAqB,IAArB;EACA,CAACC,wBAAD,GAA4B,IAA5B;EACA,CAACC,SAAD,GAAa,IAAb;EACA,CAACC,IAAD,GAAQp4B,oBAAoB,CAACqE,IAA7B;EACA,CAACg0B,eAAD,GAAmB,IAAIxD,GAAJ,EAAnB;EACA,CAACyD,gBAAD,GAAoB,IAApB;EACA,CAACC,UAAD,GAAc,IAAd;EACA,CAACC,aAAD,GAAiB,IAAjB;EACA,CAACC,cAAD,GAAkB;IAChBC,SAAS,EAAE,KADK;IAEhBC,OAAO,EAAE,IAFO;IAGhBnE,kBAAkB,EAAE,KAHJ;IAIhBC,kBAAkB,EAAE,KAJJ;IAKhBmE,iBAAiB,EAAE,KALH;IAMhBC,eAAe,EAAE;EAND,CAAlB;EAQA,CAACC,WAAD,GAAe,CAAC,CAAD,EAAI,CAAJ,CAAf;EACA,CAACC,oBAAD,GAAwB,IAAxB;EACA,CAACC,SAAD,GAAa,IAAb;EACA,CAACC,MAAD,GAAU,IAAV;EACsB,OAAfC,eAAe,GAAG,CAAH;EACF,OAAbC,aAAa,GAAG,EAAH;;EACO,WAAhBC,gBAAgB,GAAG;IAC5B,MAAMC,KAAK,GAAGp5B,yBAAyB,CAACV,SAAxC;;IACA,MAAM+5B,YAAY,GAAG/D,IAAI,IAAIA,IAAI,CAAC,CAACyD,SAAN,CAAgBO,QAAhB,CAAyB5X,QAAQ,CAAC6X,aAAlC,KAAoD7X,QAAQ,CAAC6X,aAAT,CAAuBC,OAAvB,KAAmC,QAAvF,IAAmGlE,IAAI,CAACmE,qBAAL,EAAhI;;IACA,MAAMC,gBAAgB,GAAG,CAACC,KAAD,EAAQ;MAC/BC,MAAM,EAAEC;IADuB,CAAR,KAEnB;MACJ,IAAIA,EAAE,YAAYC,gBAAlB,EAAoC;QAClC,MAAM;UACJh3B;QADI,IAEF+2B,EAFJ;QAGA,OAAO/2B,IAAI,KAAK,MAAT,IAAmBA,IAAI,KAAK,QAAnC;MACD;;MACD,OAAO,IAAP;IACD,CAVD;;IAWA,MAAMi3B,KAAK,GAAG,KAAKd,eAAnB;IACA,MAAMe,GAAG,GAAG,KAAKd,aAAjB;IACA,OAAO32B,MAAM,CAAC,IAAD,EAAO,kBAAP,EAA2B,IAAIkyB,eAAJ,CAAoB,CAAC,CAAC,CAAC,QAAD,EAAW,YAAX,CAAD,EAA2B2E,KAAK,CAACa,SAAjC,EAA4C;MACvGvE,OAAO,EAAEgE;IAD8F,CAA5C,CAAD,EAExD,CAAC,CAAC,QAAD,EAAW,YAAX,CAAD,EAA2BN,KAAK,CAACtF,IAAjC,EAAuC;MACzC4B,OAAO,EAAEgE;IADgC,CAAvC,CAFwD,EAIxD,CAAC,CAAC,QAAD,EAAW,cAAX,EAA2B,kBAA3B,EAA+C,cAA/C,EAA+D,kBAA/D,CAAD,EAAqFN,KAAK,CAAC9E,IAA3F,EAAiG;MACnGoB,OAAO,EAAEgE;IAD0F,CAAjG,CAJwD,EAMxD,CAAC,CAAC,WAAD,EAAc,eAAd,EAA+B,gBAA/B,EAAiD,iBAAjD,EAAoE,eAApE,EAAqF,mBAArF,EAA0G,oBAA1G,EAAgI,QAAhI,EAA0I,aAA1I,EAAyJ,cAAzJ,EAAyK,YAAzK,CAAD,EAAyLN,KAAK,CAAClJ,MAA/L,EAAuM;MACzMwF,OAAO,EAAEgE;IADgM,CAAvM,CANwD,EAQxD,CAAC,CAAC,OAAD,EAAU,WAAV,CAAD,EAAyBN,KAAK,CAACc,wBAA/B,EAAyD;MAC3DxE,OAAO,EAAE,CAACJ,IAAD,EAAO;QACdsE,MAAM,EAAEC;MADM,CAAP,KAEH,EAAEA,EAAE,YAAYM,iBAAhB,KAAsC7E,IAAI,CAAC,CAACyD,SAAN,CAAgBO,QAAhB,CAAyBO,EAAzB,CAAtC,IAAsE,CAACvE,IAAI,CAAC8E;IAHvB,CAAzD,CARwD,EAYxD,CAAC,CAAC,GAAD,EAAM,OAAN,CAAD,EAAiBhB,KAAK,CAACc,wBAAvB,EAAiD;MACnDxE,OAAO,EAAE,CAACJ,IAAD,EAAO;QACdsE,MAAM,EAAEC;MADM,CAAP,KAEH,EAAEA,EAAE,YAAYM,iBAAhB,KAAsC7E,IAAI,CAAC,CAACyD,SAAN,CAAgBO,QAAhB,CAAyB5X,QAAQ,CAAC6X,aAAlC;IAHO,CAAjD,CAZwD,EAgBxD,CAAC,CAAC,QAAD,EAAW,YAAX,CAAD,EAA2BH,KAAK,CAACiB,WAAjC,CAhBwD,EAgBT,CAAC,CAAC,WAAD,EAAc,eAAd,CAAD,EAAiCjB,KAAK,CAACkB,wBAAvC,EAAiE;MAClH7E,IAAI,EAAE,CAAC,CAACsE,KAAF,EAAS,CAAT,CAD4G;MAElHrE,OAAO,EAAE2D;IAFyG,CAAjE,CAhBS,EAmBxD,CAAC,CAAC,gBAAD,EAAmB,qBAAnB,CAAD,EAA4CD,KAAK,CAACkB,wBAAlD,EAA4E;MAC9E7E,IAAI,EAAE,CAAC,CAACuE,GAAF,EAAO,CAAP,CADwE;MAE9EtE,OAAO,EAAE2D;IAFqE,CAA5E,CAnBwD,EAsBxD,CAAC,CAAC,YAAD,EAAe,gBAAf,CAAD,EAAmCD,KAAK,CAACkB,wBAAzC,EAAmE;MACrE7E,IAAI,EAAE,CAACsE,KAAD,EAAQ,CAAR,CAD+D;MAErErE,OAAO,EAAE2D;IAF4D,CAAnE,CAtBwD,EAyBxD,CAAC,CAAC,iBAAD,EAAoB,sBAApB,CAAD,EAA8CD,KAAK,CAACkB,wBAApD,EAA8E;MAChF7E,IAAI,EAAE,CAACuE,GAAD,EAAM,CAAN,CAD0E;MAEhFtE,OAAO,EAAE2D;IAFuE,CAA9E,CAzBwD,EA4BxD,CAAC,CAAC,SAAD,EAAY,aAAZ,CAAD,EAA6BD,KAAK,CAACkB,wBAAnC,EAA6D;MAC/D7E,IAAI,EAAE,CAAC,CAAD,EAAI,CAACsE,KAAL,CADyD;MAE/DrE,OAAO,EAAE2D;IAFsD,CAA7D,CA5BwD,EA+BxD,CAAC,CAAC,cAAD,EAAiB,mBAAjB,CAAD,EAAwCD,KAAK,CAACkB,wBAA9C,EAAwE;MAC1E7E,IAAI,EAAE,CAAC,CAAD,EAAI,CAACuE,GAAL,CADoE;MAE1EtE,OAAO,EAAE2D;IAFiE,CAAxE,CA/BwD,EAkCxD,CAAC,CAAC,WAAD,EAAc,eAAd,CAAD,EAAiCD,KAAK,CAACkB,wBAAvC,EAAiE;MACnE7E,IAAI,EAAE,CAAC,CAAD,EAAIsE,KAAJ,CAD6D;MAEnErE,OAAO,EAAE2D;IAF0D,CAAjE,CAlCwD,EAqCxD,CAAC,CAAC,gBAAD,EAAmB,qBAAnB,CAAD,EAA4CD,KAAK,CAACkB,wBAAlD,EAA4E;MAC9E7E,IAAI,EAAE,CAAC,CAAD,EAAIuE,GAAJ,CADwE;MAE9EtE,OAAO,EAAE2D;IAFqE,CAA5E,CArCwD,CAApB,CAA3B,CAAb;EAyCD;;EACDnlB,WAAW,CAAC6kB,SAAD,EAAYC,MAAZ,EAAoBvC,cAApB,EAAoC8D,QAApC,EAA8CC,WAA9C,EAA2DlC,UAA3D,EAAuEb,eAAvE,EAAwFN,6BAAxF,EAAuHC,qBAAvH,EAA8IC,+BAA9I,EAA+Ka,SAA/K,EAA0L;IACnM,MAAMzJ,MAAM,GAAG,KAAKE,OAAL,GAAe,KAAK,CAACyH,eAAN,CAAsB3H,MAApD;IACA,KAAK,CAACsK,SAAN,GAAkBA,SAAlB;IACA,KAAK,CAACC,MAAN,GAAeA,MAAf;IACA,KAAK,CAACvC,cAAN,GAAuBA,cAAvB;IACA,KAAKgE,SAAL,GAAiBF,QAAjB;;IACAA,QAAQ,CAACG,GAAT,CAAa,eAAb,EAA8B,KAAKC,eAAL,CAAqBhW,IAArB,CAA0B,IAA1B,CAA9B,EAA+D;MAC7D8J;IAD6D,CAA/D;;IAGA8L,QAAQ,CAACG,GAAT,CAAa,cAAb,EAA6B,KAAKE,cAAL,CAAoBjW,IAApB,CAAyB,IAAzB,CAA7B,EAA6D;MAC3D8J;IAD2D,CAA7D;;IAGA8L,QAAQ,CAACG,GAAT,CAAa,eAAb,EAA8B,KAAKG,eAAL,CAAqBlW,IAArB,CAA0B,IAA1B,CAA9B,EAA+D;MAC7D8J;IAD6D,CAA/D;;IAGA8L,QAAQ,CAACG,GAAT,CAAa,kBAAb,EAAiC,KAAKI,kBAAL,CAAwBnW,IAAxB,CAA6B,IAA7B,CAAjC,EAAqE;MACnE8J;IADmE,CAArE;;IAGA8L,QAAQ,CAACG,GAAT,CAAa,eAAb,EAA8B,KAAKK,eAAL,CAAqBpW,IAArB,CAA0B,IAA1B,CAA9B,EAA+D;MAC7D8J;IAD6D,CAA/D;;IAGA8L,QAAQ,CAACG,GAAT,CAAa,8BAAb,EAA6CM,GAAG,IAAI,KAAKC,YAAL,CAAkBD,GAAG,CAACl4B,IAAtB,EAA4Bk4B,GAAG,CAACtnB,KAAhC,CAApD,EAA4F;MAC1F+a;IAD0F,CAA5F;;IAGA,KAAK,CAACyM,oBAAN;IACA,KAAK,CAACC,uBAAN;IACA,KAAK,CAACC,kBAAN;IACA,KAAK,CAAC1E,iBAAN,GAA0B8D,WAAW,CAAC9D,iBAAtC;IACA,KAAK,CAACY,aAAN,GAAsBkD,WAAW,CAAClD,aAAlC;IACA,KAAK,CAACgB,UAAN,GAAmBA,UAAnB;IACA,KAAK,CAACb,eAAN,GAAwBA,eAAe,IAAI,IAA3C;IACA,KAAK,CAACN,6BAAN,GAAsCA,6BAAtC;IACA,KAAK,CAACC,qBAAN,GAA8BA,qBAA9B;IACA,KAAK,CAACC,+BAAN,GAAwCA,+BAAxC;IACA,KAAK,CAACa,SAAN,GAAkBA,SAAS,IAAI,IAA/B;IACA,KAAKmD,cAAL,GAAsB;MACpBC,SAAS,EAAEl6B,aAAa,CAACigB,gBADL;MAEpBiH,QAAQ,EAAE;IAFU,CAAtB;IAIA,KAAKiT,cAAL,GAAsB,KAAtB;EACD;;EACDhc,OAAO,GAAG;IACR,KAAK,CAAC6W,eAAN,EAAuBoF,KAAvB;IACA,KAAK,CAACpF,eAAN,GAAwB,IAAxB;IACA,KAAKzH,OAAL,GAAe,IAAf;;IACA,KAAK,MAAM8M,KAAX,IAAoB,KAAK,CAACjF,SAAN,CAAgBkF,MAAhB,EAApB,EAA8C;MAC5CD,KAAK,CAAClc,OAAN;IACD;;IACD,KAAK,CAACiX,SAAN,CAAgB7Q,KAAhB;IACA,KAAK,CAAC4Q,UAAN,CAAiB5Q,KAAjB;IACA,KAAK,CAACuR,gBAAN,CAAuBvR,KAAvB;IACA,KAAK,CAAC2Q,YAAN,GAAqB,IAArB;IACA,KAAK,CAAC8B,eAAN,CAAsBzS,KAAtB;IACA,KAAK,CAACiR,cAAN,CAAqBrX,OAArB;IACA,KAAK,CAACkX,cAAN,EAAsBlX,OAAtB;IACA,KAAK,CAACoY,gBAAN,EAAwBlI,IAAxB;IACA,KAAK,CAACkI,gBAAN,GAAyB,IAAzB;;IACA,IAAI,KAAK,CAACJ,2BAAV,EAAuC;MACrCoE,YAAY,CAAC,KAAK,CAACpE,2BAAP,CAAZ;MACA,KAAK,CAACA,2BAAN,GAAoC,IAApC;IACD;;IACD,IAAI,KAAK,CAACuB,oBAAV,EAAgC;MAC9B6C,YAAY,CAAC,KAAK,CAAC7C,oBAAP,CAAZ;MACA,KAAK,CAACA,oBAAN,GAA6B,IAA7B;IACD;EACF;;EACD8C,cAAc,CAACC,EAAD,EAAK;IACjB,OAAOC,WAAW,CAACC,GAAZ,CAAgB,CAAC,KAAKpN,OAAN,EAAekN,EAAE,CAACpN,MAAlB,CAAhB,CAAP;EACD;;EACY,IAATyJ,SAAS,GAAG;IACd,OAAO,KAAK,CAACA,SAAb;EACD;;EACoB,IAAjB8D,iBAAiB,GAAG;IACtB,OAAO,KAAK,CAAC5E,qBAAb;EACD;;EAC+B,IAA5B6E,4BAA4B,GAAG;IACjC,OAAO,KAAK,CAAC5E,+BAAb;EACD;;EACY,IAAT6E,SAAS,GAAG;IACd,OAAO35B,MAAM,CAAC,IAAD,EAAO,WAAP,EAAoB,KAAK,CAAC+1B,UAAN,GAAmB,KAAK,CAAChB,aAAN,CAAoBxY,YAApB,CAAiC,KAAK,CAACwZ,UAAN,CAAiB6D,UAAlD,EAA8D,KAAK,CAAC7D,UAAN,CAAiB8D,UAA/E,CAAnB,GAAgH,MAApI,CAAb;EACD;;EACY,IAATrN,SAAS,GAAG;IACd,OAAOxsB,MAAM,CAAC,IAAD,EAAO,WAAP,EAAoB8jB,gBAAgB,CAAC,KAAK,CAAC0S,SAAP,CAAhB,CAAkChK,SAAtD,CAAb;EACD;;EACkB,IAAf0I,eAAe,GAAG;IACpB,OAAOl1B,MAAM,CAAC,IAAD,EAAO,iBAAP,EAA0B,KAAK,CAACk1B,eAAN,GAAwB,IAAIla,GAAJ,CAAQ,KAAK,CAACka,eAAN,CAAsBnU,KAAtB,CAA4B,GAA5B,EAAiCrN,GAAjC,CAAqComB,IAAI,IAAIA,IAAI,CAAC/Y,KAAL,CAAW,GAAX,EAAgBrN,GAAhB,CAAoB8E,CAAC,IAAIA,CAAC,CAAC+O,IAAF,EAAzB,CAA7C,CAAR,CAAxB,GAAoH,IAA9I,CAAb;EACD;;EACsB,IAAnBwS,mBAAmB,GAAG;IACxB,OAAO/5B,MAAM,CAAC,IAAD,EAAO,qBAAP,EAA8B,KAAKk1B,eAAL,GAAuB,IAAIla,GAAJ,CAAQnG,KAAK,CAACC,IAAN,CAAW,KAAKogB,eAAhB,EAAiCvM,CAAC,IAAIA,CAAC,CAACqR,OAAF,EAAtC,CAAR,CAAvB,GAAqF,IAAnH,CAAb;EACD;;EACDC,2BAA2B,CAAC5O,WAAD,EAAc;IACvC,KAAK,CAACqK,wBAAN,GAAiCrK,WAAjC;EACD;;EACD6O,WAAW,CAAC5O,MAAD,EAAS6O,SAAS,GAAG,KAArB,EAA4B;IACrC,KAAK,CAACjG,cAAN,EAAsBgG,WAAtB,CAAkC,IAAlC,EAAwC5O,MAAxC,EAAgD6O,SAAhD;EACD;;EACDC,YAAY,CAACxE,IAAD,EAAOtD,QAAP,EAAiB;IAC3B,KAAK4F,SAAL,CAAemC,EAAf,CAAkB,6BAAlB,EAAiD/H,QAAjD,EAA2D;MACzDgI,IAAI,EAAE,IADmD;MAEzDpO,MAAM,EAAE,KAAKE;IAF4C,CAA3D;;IAIA,KAAK8L,SAAL,CAAeqC,QAAf,CAAwB,wBAAxB,EAAkD;MAChDC,MAAM,EAAE,IADwC;MAEhD5E;IAFgD,CAAlD;EAID;;EACD6E,aAAa,CAAC/oB,IAAD,EAAOP,KAAP,EAAc;IACzB,KAAK+mB,SAAL,CAAeqC,QAAf,CAAwB,eAAxB,EAAyC;MACvCC,MAAM,EAAE,IAD+B;MAEvC9oB,IAFuC;MAGvCP;IAHuC,CAAzC;EAKD;;EACDqnB,eAAe,CAAC;IACd9mB,IADc;IAEdP;EAFc,CAAD,EAGZ;IACD,QAAQO,IAAR;MACE,KAAK,iCAAL;QACE,KAAK,CAACojB,+BAAN,GAAwC3jB,KAAxC;QACA;IAHJ;EAKD;;EACDknB,cAAc,CAAC;IACbqC;EADa,CAAD,EAEX;IACD,KAAK,CAACnG,gBAAN,GAAyBmG,UAAU,GAAG,CAAtC;EACD;;EACDC,kBAAkB,GAAG;IACnB,KAAK,CAACnE,SAAN,CAAgBoE,KAAhB;EACD;;EACDC,UAAU,CAACriB,CAAD,EAAIC,CAAJ,EAAO;IACf,KAAK,MAAMygB,KAAX,IAAoB,KAAK,CAACjF,SAAN,CAAgBkF,MAAhB,EAApB,EAA8C;MAC5C,MAAM;QACJ3gB,CAAC,EAAEsiB,MADC;QAEJriB,CAAC,EAAEsiB,MAFC;QAGJ3d,KAHI;QAIJC;MAJI,IAKF6b,KAAK,CAACxZ,GAAN,CAAUsb,qBAAV,EALJ;;MAMA,IAAIxiB,CAAC,IAAIsiB,MAAL,IAAetiB,CAAC,IAAIsiB,MAAM,GAAG1d,KAA7B,IAAsC3E,CAAC,IAAIsiB,MAA3C,IAAqDtiB,CAAC,IAAIsiB,MAAM,GAAG1d,MAAvE,EAA+E;QAC7E,OAAO6b,KAAP;MACD;IACF;;IACD,OAAO,IAAP;EACD;;EACD+B,iBAAiB,CAAC9pB,KAAK,GAAG,KAAT,EAAgB;IAC/B,KAAK,CAACslB,MAAN,CAAatJ,SAAb,CAAuB+N,MAAvB,CAA8B,cAA9B,EAA8C/pB,KAA9C;EACD;;EACDgqB,gBAAgB,CAAC7P,MAAD,EAAS;IACvB,KAAK,CAACqJ,gBAAN,CAAuBvH,GAAvB,CAA2B9B,MAA3B;EACD;;EACD8P,mBAAmB,CAAC9P,MAAD,EAAS;IAC1B,KAAK,CAACqJ,gBAAN,CAAuBhH,MAAvB,CAA8BrC,MAA9B;EACD;;EACDgN,eAAe,CAAC;IACdxS;EADc,CAAD,EAEZ;IACD,KAAKuV,cAAL;IACA,KAAKvC,cAAL,CAAoBC,SAApB,GAAgCjT,KAAK,GAAGjnB,aAAa,CAACigB,gBAAtD;;IACA,KAAK,MAAMwM,MAAX,IAAqB,KAAK,CAACqJ,gBAA3B,EAA6C;MAC3CrJ,MAAM,CAACgN,eAAP;IACD;EACF;;EACDC,kBAAkB,CAAC;IACjB+C;EADiB,CAAD,EAEf;IACD,KAAKD,cAAL;IACA,KAAKvC,cAAL,CAAoB/S,QAApB,GAA+BuV,aAA/B;EACD;;EACD,CAACC,4BAA4B,CAAC;IAC5BC;EAD4B,CAAD,EAE1B;IACD,OAAOA,UAAU,CAACC,QAAX,KAAwBC,IAAI,CAACC,SAA7B,GAAyCH,UAAU,CAACI,aAApD,GAAoEJ,UAA3E;EACD;;EACD,CAACK,oBAAoB,CAACC,SAAD,EAAY;IAC/B,MAAM;MACJC;IADI,IAEF,IAFJ;;IAGA,IAAIA,YAAY,CAACC,YAAb,CAA0BF,SAA1B,CAAJ,EAA0C;MACxC,OAAOC,YAAP;IACD;;IACD,KAAK,MAAM7C,KAAX,IAAoB,KAAK,CAACjF,SAAN,CAAgBkF,MAAhB,EAApB,EAA8C;MAC5C,IAAID,KAAK,CAAC8C,YAAN,CAAmBF,SAAnB,CAAJ,EAAmC;QACjC,OAAO5C,KAAP;MACD;IACF;;IACD,OAAO,IAAP;EACD;;EACDvK,kBAAkB,CAACsN,gBAAgB,GAAG,EAApB,EAAwB;IACxC,MAAMC,SAAS,GAAG/c,QAAQ,CAACgd,YAAT,EAAlB;;IACA,IAAI,CAACD,SAAD,IAAcA,SAAS,CAACE,WAA5B,EAAyC;MACvC;IACD;;IACD,MAAM;MACJZ,UADI;MAEJa,YAFI;MAGJC,SAHI;MAIJC;IAJI,IAKFL,SALJ;IAMA,MAAMzX,IAAI,GAAGyX,SAAS,CAAClnB,QAAV,EAAb;IACA,MAAMwnB,aAAa,GAAG,KAAK,CAACjB,4BAAN,CAAmCW,SAAnC,CAAtB;IACA,MAAMJ,SAAS,GAAGU,aAAa,CAACC,OAAd,CAAsB,YAAtB,CAAlB;IACA,MAAMpO,KAAK,GAAG,KAAKqO,iBAAL,CAAuBZ,SAAvB,CAAd;;IACA,IAAI,CAACzN,KAAL,EAAY;MACV;IACD;;IACD6N,SAAS,CAACS,KAAV;IACA,MAAMzD,KAAK,GAAG,KAAK,CAAC2C,oBAAN,CAA2BC,SAA3B,CAAd;IACA,MAAMc,UAAU,GAAG,KAAK,CAAChH,IAAN,KAAep4B,oBAAoB,CAACqE,IAAvD;;IACA,MAAMywB,QAAQ,GAAG,MAAM;MACrB4G,KAAK,EAAE2D,qBAAP,CAA6B;QAC3BrkB,CAAC,EAAE,CADwB;QAE3BC,CAAC,EAAE;MAFwB,CAA7B,EAGG,KAHH,EAGU;QACRwjB,gBADQ;QAER5N,KAFQ;QAGRmN,UAHQ;QAIRa,YAJQ;QAKRC,SALQ;QAMRC,WANQ;QAOR9X;MAPQ,CAHV;;MAYA,IAAImY,UAAJ,EAAgB;QACd,KAAKE,cAAL,CAAoB,WAApB,EAAiC,IAAjC,EAAuC,IAAvC;MACD;IACF,CAhBD;;IAiBA,IAAIF,UAAJ,EAAgB;MACd,KAAKxC,YAAL,CAAkB58B,oBAAoB,CAACuE,SAAvC,EAAkDuwB,QAAlD;MACA;IACD;;IACDA,QAAQ;EACT;;EACD,CAACyK,uBAAuB,GAAG;IACzB,MAAMb,SAAS,GAAG/c,QAAQ,CAACgd,YAAT,EAAlB;;IACA,IAAI,CAACD,SAAD,IAAcA,SAAS,CAACE,WAA5B,EAAyC;MACvC;IACD;;IACD,MAAMI,aAAa,GAAG,KAAK,CAACjB,4BAAN,CAAmCW,SAAnC,CAAtB;IACA,MAAMJ,SAAS,GAAGU,aAAa,CAACC,OAAd,CAAsB,YAAtB,CAAlB;IACA,MAAMpO,KAAK,GAAG,KAAKqO,iBAAL,CAAuBZ,SAAvB,CAAd;;IACA,IAAI,CAACzN,KAAL,EAAY;MACV;IACD;;IACD,KAAK,CAAC+G,gBAAN,KAA2B,IAAInH,gBAAJ,CAAqB,IAArB,CAA3B;IACA,KAAK,CAACmH,gBAAN,CAAuB9H,IAAvB,CAA4BwO,SAA5B,EAAuCzN,KAAvC,EAA8C,KAAK7B,SAAL,KAAmB,KAAjE;EACD;;EACDwQ,sBAAsB,CAAC1R,MAAD,EAAS;IAC7B,IAAI,CAACA,MAAM,CAAC6K,OAAP,EAAD,IAAqB,KAAK,CAAChC,iBAA3B,IAAgD,CAAC,KAAK,CAACA,iBAAN,CAAwBnB,GAAxB,CAA4B1H,MAAM,CAACjM,EAAnC,CAArD,EAA6F;MAC3F,KAAK,CAAC8U,iBAAN,CAAwB8I,QAAxB,CAAiC3R,MAAM,CAACjM,EAAxC,EAA4CiM,MAA5C;IACD;EACF;;EACD,CAAC4R,eAAe,GAAG;IACjB,MAAMhB,SAAS,GAAG/c,QAAQ,CAACgd,YAAT,EAAlB;;IACA,IAAI,CAACD,SAAD,IAAcA,SAAS,CAACE,WAA5B,EAAyC;MACvC,IAAI,KAAK,CAACtG,gBAAV,EAA4B;QAC1B,KAAK,CAACV,gBAAN,EAAwBlI,IAAxB;QACA,KAAK,CAAC4I,gBAAN,GAAyB,IAAzB;QACA,KAAK,CAACqH,oBAAN,CAA2B;UACzB9G,eAAe,EAAE;QADQ,CAA3B;MAGD;;MACD;IACD;;IACD,MAAM;MACJmF;IADI,IAEFU,SAFJ;;IAGA,IAAIV,UAAU,KAAK,KAAK,CAAC1F,gBAAzB,EAA2C;MACzC;IACD;;IACD,MAAM0G,aAAa,GAAG,KAAK,CAACjB,4BAAN,CAAmCW,SAAnC,CAAtB;IACA,MAAMJ,SAAS,GAAGU,aAAa,CAACC,OAAd,CAAsB,YAAtB,CAAlB;;IACA,IAAI,CAACX,SAAL,EAAgB;MACd,IAAI,KAAK,CAAChG,gBAAV,EAA4B;QAC1B,KAAK,CAACV,gBAAN,EAAwBlI,IAAxB;QACA,KAAK,CAAC4I,gBAAN,GAAyB,IAAzB;QACA,KAAK,CAACqH,oBAAN,CAA2B;UACzB9G,eAAe,EAAE;QADQ,CAA3B;MAGD;;MACD;IACD;;IACD,KAAK,CAACjB,gBAAN,EAAwBlI,IAAxB;IACA,KAAK,CAAC4I,gBAAN,GAAyB0F,UAAzB;IACA,KAAK,CAAC2B,oBAAN,CAA2B;MACzB9G,eAAe,EAAE;IADQ,CAA3B;;IAGA,IAAI,KAAK,CAACT,IAAN,KAAep4B,oBAAoB,CAACuE,SAApC,IAAiD,KAAK,CAAC6zB,IAAN,KAAep4B,oBAAoB,CAACqE,IAAzF,EAA+F;MAC7F;IACD;;IACD,IAAI,KAAK,CAAC+zB,IAAN,KAAep4B,oBAAoB,CAACuE,SAAxC,EAAmD;MACjD,KAAK+6B,cAAL,CAAoB,WAApB,EAAiC,IAAjC,EAAuC,IAAvC;IACD;;IACD,KAAK,CAAC3H,oBAAN,GAA6B,KAAK6D,cAAlC;;IACA,IAAI,CAAC,KAAKA,cAAV,EAA0B;MACxB,MAAMoE,WAAW,GAAG,KAAK,CAACxH,IAAN,KAAep4B,oBAAoB,CAACuE,SAApC,GAAgD,KAAK,CAAC85B,oBAAN,CAA2BC,SAA3B,CAAhD,GAAwF,IAA5G;MACAsB,WAAW,EAAEC,aAAb;MACA,MAAM/D,EAAE,GAAG,IAAIxF,eAAJ,EAAX;MACA,MAAM5H,MAAM,GAAG,KAAKmN,cAAL,CAAoBC,EAApB,CAAf;;MACA,MAAMgE,SAAS,GAAG3U,CAAC,IAAI;QACrB,IAAIA,CAAC,CAACpoB,IAAF,KAAW,WAAX,IAA0BooB,CAAC,CAAC8E,MAAF,KAAa,CAA3C,EAA8C;UAC5C;QACD;;QACD6L,EAAE,CAACL,KAAH;QACAmE,WAAW,EAAEC,aAAb,CAA2B,IAA3B;;QACA,IAAI1U,CAAC,CAACpoB,IAAF,KAAW,WAAf,EAA4B;UAC1B,KAAK,CAACg9B,WAAN,CAAkB,cAAlB;QACD;MACF,CATD;;MAUAnT,MAAM,CAACiC,gBAAP,CAAwB,WAAxB,EAAqCiR,SAArC,EAAgD;QAC9CpR;MAD8C,CAAhD;MAGA9B,MAAM,CAACiC,gBAAP,CAAwB,MAAxB,EAAgCiR,SAAhC,EAA2C;QACzCpR;MADyC,CAA3C;IAGD;EACF;;EACD,CAACqR,WAAW,CAACtB,gBAAgB,GAAG,EAApB,EAAwB;IAClC,IAAI,KAAK,CAACrG,IAAN,KAAep4B,oBAAoB,CAACuE,SAAxC,EAAmD;MACjD,KAAK4sB,kBAAL,CAAwBsN,gBAAxB;IACD,CAFD,MAEO,IAAI,KAAK,CAACrH,6BAAV,EAAyC;MAC9C,KAAK,CAACmI,uBAAN;IACD;EACF;;EACD,CAACpE,oBAAoB,GAAG;IACtBxZ,QAAQ,CAACkN,gBAAT,CAA0B,iBAA1B,EAA6C,KAAK,CAAC6Q,eAAN,CAAsB9a,IAAtB,CAA2B,IAA3B,CAA7C,EAA+E;MAC7E8J,MAAM,EAAE,KAAKE;IADgE,CAA/E;EAGD;;EACD,CAACoR,eAAe,GAAG;IACjB,IAAI,KAAK,CAACvI,cAAV,EAA0B;MACxB;IACD;;IACD,KAAK,CAACA,cAAN,GAAuB,IAAInB,eAAJ,EAAvB;IACA,MAAM5H,MAAM,GAAG,KAAKmN,cAAL,CAAoB,KAAK,CAACpE,cAA1B,CAAf;IACA7K,MAAM,CAACiC,gBAAP,CAAwB,OAAxB,EAAiC,KAAKuO,KAAL,CAAWxY,IAAX,CAAgB,IAAhB,CAAjC,EAAwD;MACtD8J;IADsD,CAAxD;IAGA9B,MAAM,CAACiC,gBAAP,CAAwB,MAAxB,EAAgC,KAAKoR,IAAL,CAAUrb,IAAV,CAAe,IAAf,CAAhC,EAAsD;MACpD8J;IADoD,CAAtD;EAGD;;EACD,CAACwR,kBAAkB,GAAG;IACpB,KAAK,CAACzI,cAAN,EAAsBgE,KAAtB;IACA,KAAK,CAAChE,cAAN,GAAuB,IAAvB;EACD;;EACDwI,IAAI,GAAG;IACL,KAAKzE,cAAL,GAAsB,KAAtB;;IACA,IAAI,KAAK,CAAC7D,oBAAV,EAAgC;MAC9B,KAAK,CAACA,oBAAN,GAA6B,KAA7B;MACA,KAAK,CAACoI,WAAN,CAAkB,cAAlB;IACD;;IACD,IAAI,CAAC,KAAKI,YAAV,EAAwB;MACtB;IACD;;IACD,MAAM;MACJ3G;IADI,IAEF7X,QAFJ;;IAGA,KAAK,MAAMmM,MAAX,IAAqB,KAAK,CAACuK,eAA3B,EAA4C;MAC1C,IAAIvK,MAAM,CAAC5L,GAAP,CAAWqX,QAAX,CAAoBC,aAApB,CAAJ,EAAwC;QACtC,KAAK,CAACvB,iBAAN,GAA0B,CAACnK,MAAD,EAAS0L,aAAT,CAA1B;QACA1L,MAAM,CAACuB,mBAAP,GAA6B,KAA7B;QACA;MACD;IACF;EACF;;EACD+N,KAAK,GAAG;IACN,IAAI,CAAC,KAAK,CAACnF,iBAAX,EAA8B;MAC5B;IACD;;IACD,MAAM,CAACmI,UAAD,EAAanI,iBAAb,IAAkC,KAAK,CAACA,iBAA9C;IACA,KAAK,CAACA,iBAAN,GAA0B,IAA1B;IACAA,iBAAiB,CAACpJ,gBAAlB,CAAmC,SAAnC,EAA8C,MAAM;MAClDuR,UAAU,CAAC/Q,mBAAX,GAAiC,IAAjC;IACD,CAFD,EAEG;MACDyN,IAAI,EAAE,IADL;MAEDpO,MAAM,EAAE,KAAKE;IAFZ,CAFH;IAMAqJ,iBAAiB,CAACmF,KAAlB;EACD;;EACD,CAAC/B,kBAAkB,GAAG;IACpB,IAAI,KAAK,CAACrD,iBAAV,EAA6B;MAC3B;IACD;;IACD,KAAK,CAACA,iBAAN,GAA0B,IAAI1B,eAAJ,EAA1B;IACA,MAAM5H,MAAM,GAAG,KAAKmN,cAAL,CAAoB,KAAK,CAAC7D,iBAA1B,CAAf;IACApL,MAAM,CAACiC,gBAAP,CAAwB,SAAxB,EAAmC,KAAKwR,OAAL,CAAazb,IAAb,CAAkB,IAAlB,CAAnC,EAA4D;MAC1D8J;IAD0D,CAA5D;IAGA9B,MAAM,CAACiC,gBAAP,CAAwB,OAAxB,EAAiC,KAAKyR,KAAL,CAAW1b,IAAX,CAAgB,IAAhB,CAAjC,EAAwD;MACtD8J;IADsD,CAAxD;EAGD;;EACD,CAAC6R,qBAAqB,GAAG;IACvB,KAAK,CAACvI,iBAAN,EAAyByD,KAAzB;IACA,KAAK,CAACzD,iBAAN,GAA0B,IAA1B;EACD;;EACD,CAACwI,qBAAqB,GAAG;IACvB,IAAI,KAAK,CAAC1J,WAAV,EAAuB;MACrB;IACD;;IACD,KAAK,CAACA,WAAN,GAAoB,IAAIR,eAAJ,EAApB;IACA,MAAM5H,MAAM,GAAG,KAAKmN,cAAL,CAAoB,KAAK,CAAC/E,WAA1B,CAAf;IACAnV,QAAQ,CAACkN,gBAAT,CAA0B,MAA1B,EAAkC,KAAK4R,IAAL,CAAU7b,IAAV,CAAe,IAAf,CAAlC,EAAwD;MACtD8J;IADsD,CAAxD;IAGA/M,QAAQ,CAACkN,gBAAT,CAA0B,KAA1B,EAAiC,KAAK6R,GAAL,CAAS9b,IAAT,CAAc,IAAd,CAAjC,EAAsD;MACpD8J;IADoD,CAAtD;IAGA/M,QAAQ,CAACkN,gBAAT,CAA0B,OAA1B,EAAmC,KAAK8R,KAAL,CAAW/b,IAAX,CAAgB,IAAhB,CAAnC,EAA0D;MACxD8J;IADwD,CAA1D;EAGD;;EACD,CAACkS,wBAAwB,GAAG;IAC1B,KAAK,CAAC9J,WAAN,EAAmB2E,KAAnB;IACA,KAAK,CAAC3E,WAAN,GAAoB,IAApB;EACD;;EACD,CAACsE,uBAAuB,GAAG;IACzB,MAAM1M,MAAM,GAAG,KAAKE,OAApB;IACAjN,QAAQ,CAACkN,gBAAT,CAA0B,UAA1B,EAAsC,KAAKgS,QAAL,CAAcjc,IAAd,CAAmB,IAAnB,CAAtC,EAAgE;MAC9D8J;IAD8D,CAAhE;IAGA/M,QAAQ,CAACkN,gBAAT,CAA0B,MAA1B,EAAkC,KAAKiS,IAAL,CAAUlc,IAAV,CAAe,IAAf,CAAlC,EAAwD;MACtD8J;IADsD,CAAxD;EAGD;;EACDqS,gBAAgB,GAAG;IACjB,KAAK,CAAC1F,kBAAN;IACA,KAAK,CAACmF,qBAAN;EACD;;EACDQ,mBAAmB,GAAG;IACpB,KAAK,CAACT,qBAAN;IACA,KAAK,CAACK,wBAAN;EACD;;EACDC,QAAQ,CAAC3L,KAAD,EAAQ;IACd,KAAK,MAAM;MACTnyB;IADS,CAAX,IAEKmyB,KAAK,CAAC+L,YAAN,CAAmBC,KAFxB,EAE+B;MAC7B,KAAK,MAAMlR,UAAX,IAAyB,KAAK,CAACkH,WAA/B,EAA4C;QAC1C,IAAIlH,UAAU,CAACmR,wBAAX,CAAoCp+B,IAApC,CAAJ,EAA+C;UAC7CmyB,KAAK,CAAC+L,YAAN,CAAmBG,UAAnB,GAAgC,MAAhC;UACAlM,KAAK,CAAC9J,cAAN;UACA;QACD;MACF;IACF;EACF;;EACD0V,IAAI,CAAC5L,KAAD,EAAQ;IACV,KAAK,MAAMmM,IAAX,IAAmBnM,KAAK,CAAC+L,YAAN,CAAmBC,KAAtC,EAA6C;MAC3C,KAAK,MAAMlR,UAAX,IAAyB,KAAK,CAACkH,WAA/B,EAA4C;QAC1C,IAAIlH,UAAU,CAACmR,wBAAX,CAAoCE,IAAI,CAACt+B,IAAzC,CAAJ,EAAoD;UAClDitB,UAAU,CAAC2Q,KAAX,CAAiBU,IAAjB,EAAuB,KAAK9C,YAA5B;UACArJ,KAAK,CAAC9J,cAAN;UACA;QACD;MACF;IACF;EACF;;EACDqV,IAAI,CAACvL,KAAD,EAAQ;IACVA,KAAK,CAAC9J,cAAN;IACA,KAAK,CAACmL,YAAN,EAAoBsH,cAApB;;IACA,IAAI,CAAC,KAAKsC,YAAV,EAAwB;MACtB;IACD;;IACD,MAAMmB,OAAO,GAAG,EAAhB;;IACA,KAAK,MAAMxT,MAAX,IAAqB,KAAK,CAACuK,eAA3B,EAA4C;MAC1C,MAAMkJ,UAAU,GAAGzT,MAAM,CAACmH,SAAP,CAAiB,IAAjB,CAAnB;;MACA,IAAIsM,UAAJ,EAAgB;QACdD,OAAO,CAAC9rB,IAAR,CAAa+rB,UAAb;MACD;IACF;;IACD,IAAID,OAAO,CAAChuB,MAAR,KAAmB,CAAvB,EAA0B;MACxB;IACD;;IACD4hB,KAAK,CAACsM,aAAN,CAAoBC,OAApB,CAA4B,mBAA5B,EAAiDC,IAAI,CAACC,SAAL,CAAeL,OAAf,CAAjD;EACD;;EACDZ,GAAG,CAACxL,KAAD,EAAQ;IACT,KAAKuL,IAAL,CAAUvL,KAAV;IACA,KAAK/E,MAAL;EACD;;EACDwQ,KAAK,CAACzL,KAAD,EAAQ;IACXA,KAAK,CAAC9J,cAAN;IACA,MAAM;MACJoW;IADI,IAEFtM,KAFJ;;IAGA,KAAK,MAAMmM,IAAX,IAAmBG,aAAa,CAACN,KAAjC,EAAwC;MACtC,KAAK,MAAMlR,UAAX,IAAyB,KAAK,CAACkH,WAA/B,EAA4C;QAC1C,IAAIlH,UAAU,CAACmR,wBAAX,CAAoCE,IAAI,CAACt+B,IAAzC,CAAJ,EAAoD;UAClDitB,UAAU,CAAC2Q,KAAX,CAAiBU,IAAjB,EAAuB,KAAK9C,YAA5B;UACA;QACD;MACF;IACF;;IACD,IAAIvW,IAAI,GAAGwZ,aAAa,CAACI,OAAd,CAAsB,mBAAtB,CAAX;;IACA,IAAI,CAAC5Z,IAAL,EAAW;MACT;IACD;;IACD,IAAI;MACFA,IAAI,GAAG0Z,IAAI,CAACG,KAAL,CAAW7Z,IAAX,CAAP;IACD,CAFD,CAEE,OAAO/L,EAAP,EAAW;MACXzJ,IAAI,CAAE,WAAUyJ,EAAE,CAAChI,OAAQ,IAAvB,CAAJ;MACA;IACD;;IACD,IAAI,CAACoD,KAAK,CAACyqB,OAAN,CAAc9Z,IAAd,CAAL,EAA0B;MACxB;IACD;;IACD,KAAKsS,WAAL;IACA,MAAMoB,KAAK,GAAG,KAAK6C,YAAnB;;IACA,IAAI;MACF,MAAMwD,UAAU,GAAG,EAAnB;;MACA,KAAK,MAAMjU,MAAX,IAAqB9F,IAArB,EAA2B;QACzB,MAAMga,kBAAkB,GAAGtG,KAAK,CAACuG,WAAN,CAAkBnU,MAAlB,CAA3B;;QACA,IAAI,CAACkU,kBAAL,EAAyB;UACvB;QACD;;QACDD,UAAU,CAACvsB,IAAX,CAAgBwsB,kBAAhB;MACD;;MACD,MAAMlO,GAAG,GAAG,MAAM;QAChB,KAAK,MAAMhG,MAAX,IAAqBiU,UAArB,EAAiC;UAC/B,KAAK,CAACG,gBAAN,CAAuBpU,MAAvB;QACD;;QACD,KAAK,CAACqU,aAAN,CAAoBJ,UAApB;MACD,CALD;;MAMA,MAAMhO,IAAI,GAAG,MAAM;QACjB,KAAK,MAAMjG,MAAX,IAAqBiU,UAArB,EAAiC;UAC/BjU,MAAM,CAAC/J,MAAP;QACD;MACF,CAJD;;MAKA,KAAKqe,WAAL,CAAiB;QACftO,GADe;QAEfC,IAFe;QAGfE,QAAQ,EAAE;MAHK,CAAjB;IAKD,CAzBD,CAyBE,OAAOhY,EAAP,EAAW;MACXzJ,IAAI,CAAE,WAAUyJ,EAAE,CAAChI,OAAQ,IAAvB,CAAJ;IACD;EACF;;EACDosB,OAAO,CAACnL,KAAD,EAAQ;IACb,IAAI,CAAC,KAAKsG,cAAN,IAAwBtG,KAAK,CAACn2B,GAAN,KAAc,OAA1C,EAAmD;MACjD,KAAKy8B,cAAL,GAAsB,IAAtB;IACD;;IACD,IAAI,KAAK,CAACpD,IAAN,KAAep4B,oBAAoB,CAACqE,IAApC,IAA4C,CAAC,KAAKg+B,wBAAtD,EAAgF;MAC9EpiC,yBAAyB,CAACm5B,gBAA1B,CAA2C5O,IAA3C,CAAgD,IAAhD,EAAsD0K,KAAtD;IACD;EACF;;EACDoL,KAAK,CAACpL,KAAD,EAAQ;IACX,IAAI,KAAKsG,cAAL,IAAuBtG,KAAK,CAACn2B,GAAN,KAAc,OAAzC,EAAkD;MAChD,KAAKy8B,cAAL,GAAsB,KAAtB;;MACA,IAAI,KAAK,CAAC7D,oBAAV,EAAgC;QAC9B,KAAK,CAACA,oBAAN,GAA6B,KAA7B;QACA,KAAK,CAACoI,WAAN,CAAkB,cAAlB;MACD;IACF;EACF;;EACDnF,eAAe,CAAC;IACd1mB;EADc,CAAD,EAEZ;IACD,QAAQA,IAAR;MACE,KAAK,MAAL;MACA,KAAK,MAAL;MACA,KAAK,QAAL;MACA,KAAK,WAAL;QACE,KAAKA,IAAL;QACA;;MACF,KAAK,oBAAL;QACE,KAAKid,kBAAL,CAAwB,cAAxB;QACA;IATJ;EAWD;;EACD,CAACwO,oBAAoB,CAACprB,OAAD,EAAU;IAC7B,MAAM+tB,UAAU,GAAGrjC,MAAM,CAACsjC,OAAP,CAAehuB,OAAf,EAAwBiuB,IAAxB,CAA6B,CAAC,CAACzjC,GAAD,EAAM4U,KAAN,CAAD,KAAkB,KAAK,CAAC8kB,cAAN,CAAqB15B,GAArB,MAA8B4U,KAA7E,CAAnB;;IACA,IAAI2uB,UAAJ,EAAgB;MACd,KAAK5H,SAAL,CAAeqC,QAAf,CAAwB,+BAAxB,EAAyD;QACvDC,MAAM,EAAE,IAD+C;QAEvDzoB,OAAO,EAAEtV,MAAM,CAACwjC,MAAP,CAAc,KAAK,CAAChK,cAApB,EAAoClkB,OAApC;MAF8C,CAAzD;;MAIA,IAAI,KAAK,CAAC6jB,IAAN,KAAep4B,oBAAoB,CAACuE,SAApC,IAAiDgQ,OAAO,CAACqkB,iBAAR,KAA8B,KAAnF,EAA0F;QACxF,KAAK,CAAC8J,gBAAN,CAAuB,CAAC,CAAC3iC,0BAA0B,CAACsF,cAA5B,EAA4C,IAA5C,CAAD,CAAvB;MACD;IACF;EACF;;EACD,CAACq9B,gBAAgB,CAACnuB,OAAD,EAAU;IACzB,KAAKmmB,SAAL,CAAeqC,QAAf,CAAwB,+BAAxB,EAAyD;MACvDC,MAAM,EAAE,IAD+C;MAEvDzoB;IAFuD,CAAzD;EAID;;EACDouB,eAAe,CAACjK,SAAD,EAAY;IACzB,IAAIA,SAAJ,EAAe;MACb,KAAK,CAACsH,eAAN;MACA,KAAK,CAACQ,qBAAN;MACA,KAAK,CAACb,oBAAN,CAA2B;QACzBjH,SAAS,EAAE,KAAK,CAACN,IAAN,KAAep4B,oBAAoB,CAACqE,IADtB;QAEzBs0B,OAAO,EAAE,KAAK,CAACA,OAAN,EAFgB;QAGzBnE,kBAAkB,EAAE,KAAK,CAACqC,cAAN,CAAqBrC,kBAArB,EAHK;QAIzBC,kBAAkB,EAAE,KAAK,CAACoC,cAAN,CAAqBpC,kBAArB,EAJK;QAKzBmE,iBAAiB,EAAE;MALM,CAA3B;IAOD,CAVD,MAUO;MACL,KAAK,CAACsH,kBAAN;MACA,KAAK,CAACU,wBAAN;MACA,KAAK,CAACjB,oBAAN,CAA2B;QACzBjH,SAAS,EAAE;MADc,CAA3B;MAGA,KAAK+E,iBAAL,CAAuB,KAAvB;IACD;EACF;;EACDmF,mBAAmB,CAACC,KAAD,EAAQ;IACzB,IAAI,KAAK,CAAC3L,WAAV,EAAuB;MACrB;IACD;;IACD,KAAK,CAACA,WAAN,GAAoB2L,KAApB;;IACA,KAAK,MAAM7S,UAAX,IAAyB,KAAK,CAACkH,WAA/B,EAA4C;MAC1C,KAAK,CAACwL,gBAAN,CAAuB1S,UAAU,CAAC8S,yBAAlC;IACD;EACF;;EACDC,KAAK,GAAG;IACN,OAAO,KAAK,CAAClL,SAAN,CAAgBhW,EAAvB;EACD;;EACe,IAAZ0c,YAAY,GAAG;IACjB,OAAO,KAAK,CAAC9H,SAAN,CAAgBr3B,GAAhB,CAAoB,KAAK,CAAC23B,gBAA1B,CAAP;EACD;;EACDiM,QAAQ,CAACC,SAAD,EAAY;IAClB,OAAO,KAAK,CAACxM,SAAN,CAAgBr3B,GAAhB,CAAoB6jC,SAApB,CAAP;EACD;;EACmB,IAAhBlM,gBAAgB,GAAG;IACrB,OAAO,KAAK,CAACA,gBAAb;EACD;;EACDmM,QAAQ,CAACxH,KAAD,EAAQ;IACd,KAAK,CAACjF,SAAN,CAAgB9S,GAAhB,CAAoB+X,KAAK,CAACuH,SAA1B,EAAqCvH,KAArC;;IACA,IAAI,KAAK,CAAC5D,SAAV,EAAqB;MACnB4D,KAAK,CAACyH,MAAN;IACD,CAFD,MAEO;MACLzH,KAAK,CAAC0H,OAAN;IACD;EACF;;EACDC,WAAW,CAAC3H,KAAD,EAAQ;IACjB,KAAK,CAACjF,SAAN,CAAgBtG,MAAhB,CAAuBuL,KAAK,CAACuH,SAA7B;EACD;;EACDK,UAAU,CAAClL,IAAD,EAAOmL,MAAM,GAAG,IAAhB,EAAsBC,cAAc,GAAG,KAAvC,EAA8C;IACtD,IAAI,KAAK,CAACpL,IAAN,KAAeA,IAAnB,EAAyB;MACvB;IACD;;IACD,KAAK,CAACA,IAAN,GAAaA,IAAb;;IACA,IAAIA,IAAI,KAAKp4B,oBAAoB,CAACqE,IAAlC,EAAwC;MACtC,KAAKs+B,eAAL,CAAqB,KAArB;MACA,KAAK,CAACc,UAAN;MACA;IACD;;IACD,KAAKd,eAAL,CAAqB,IAArB;IACA,KAAK,CAACe,SAAN;IACA,KAAKpJ,WAAL;;IACA,KAAK,MAAMoB,KAAX,IAAoB,KAAK,CAACjF,SAAN,CAAgBkF,MAAhB,EAApB,EAA8C;MAC5CD,KAAK,CAAC4H,UAAN,CAAiBlL,IAAjB;IACD;;IACD,IAAI,CAACmL,MAAD,IAAWC,cAAf,EAA+B;MAC7B,KAAKrJ,wBAAL;MACA;IACD;;IACD,IAAI,CAACoJ,MAAL,EAAa;MACX;IACD;;IACD,KAAK,MAAMzV,MAAX,IAAqB,KAAK,CAAC0I,UAAN,CAAiBmF,MAAjB,EAArB,EAAgD;MAC9C,IAAI7N,MAAM,CAAC6V,mBAAP,KAA+BJ,MAAnC,EAA2C;QACzC,KAAKK,WAAL,CAAiB9V,MAAjB;QACAA,MAAM,CAAC+V,eAAP;QACA;MACD;IACF;EACF;;EACD1J,wBAAwB,GAAG;IACzB,IAAI,KAAKoE,YAAL,CAAkBuF,uBAAlB,EAAJ,EAAiD;MAC/C,KAAKvF,YAAL,CAAkBwF,YAAlB;IACD;EACF;;EACDC,aAAa,CAAC5L,IAAD,EAAO;IAClB,IAAIA,IAAI,KAAK,KAAK,CAACA,IAAnB,EAAyB;MACvB;IACD;;IACD,KAAKsC,SAAL,CAAeqC,QAAf,CAAwB,4BAAxB,EAAsD;MACpDC,MAAM,EAAE,IAD4C;MAEpD5E;IAFoD,CAAtD;EAID;;EACD8C,YAAY,CAACn4B,IAAD,EAAO4Q,KAAP,EAAc;IACxB,IAAI,CAAC,KAAK,CAACujB,WAAX,EAAwB;MACtB;IACD;;IACD,QAAQn0B,IAAR;MACE,KAAKhD,0BAA0B,CAAC4E,MAAhC;QACE,KAAK45B,YAAL,CAAkBwF,YAAlB;QACA;;MACF,KAAKhkC,0BAA0B,CAACoF,uBAAhC;QACE,KAAK,CAAC+yB,wBAAN,EAAgC+L,WAAhC,CAA4CtwB,KAA5C;QACA;;MACF,KAAK5T,0BAA0B,CAACuF,kBAAhC;QACE,KAAKo1B,SAAL,CAAeqC,QAAf,CAAwB,iBAAxB,EAA2C;UACzCC,MAAM,EAAE,IADiC;UAEzCzoB,OAAO,EAAE;YACPxR,IAAI,EAAE,SADC;YAEPilB,IAAI,EAAE;cACJjlB,IAAI,EAAE,WADF;cAEJmhC,MAAM,EAAE;YAFJ;UAFC;QAFgC,CAA3C;;QAUA,CAAC,KAAK,CAAC1L,aAAN,KAAwB,IAAIhb,GAAJ,EAAzB,EAAoCmG,GAApC,CAAwC5gB,IAAxC,EAA8C4Q,KAA9C;QACA,KAAK2rB,cAAL,CAAoB,WAApB,EAAiC3rB,KAAjC;QACA;IApBJ;;IAsBA,KAAK,MAAMma,MAAX,IAAqB,KAAK,CAACuK,eAA3B,EAA4C;MAC1CvK,MAAM,CAACoN,YAAP,CAAoBn4B,IAApB,EAA0B4Q,KAA1B;IACD;;IACD,KAAK,MAAMqc,UAAX,IAAyB,KAAK,CAACkH,WAA/B,EAA4C;MAC1ClH,UAAU,CAACmU,mBAAX,CAA+BphC,IAA/B,EAAqC4Q,KAArC;IACD;EACF;;EACD2rB,cAAc,CAACv8B,IAAD,EAAOqhC,OAAP,EAAgBC,YAAY,GAAG,KAA/B,EAAsC;IAClD,KAAK,MAAMvW,MAAX,IAAqB,KAAK,CAAC0I,UAAN,CAAiBmF,MAAjB,EAArB,EAAgD;MAC9C,IAAI7N,MAAM,CAACkC,UAAP,KAAsBjtB,IAA1B,EAAgC;QAC9B+qB,MAAM,CAACgC,IAAP,CAAYsU,OAAZ;MACD;IACF;;IACD,MAAME,KAAK,GAAG,KAAK,CAAC9L,aAAN,EAAqBp5B,GAArB,CAAyBW,0BAA0B,CAACuF,kBAApD,KAA2E,IAAzF;;IACA,IAAIg/B,KAAK,KAAKF,OAAd,EAAuB;MACrB,KAAK,CAAC1B,gBAAN,CAAuB,CAAC,CAAC3iC,0BAA0B,CAACuF,kBAA5B,EAAgD8+B,OAAhD,CAAD,CAAvB;IACD;EACF;;EACDG,aAAa,CAACC,QAAQ,GAAG,KAAZ,EAAmB;IAC9B,IAAI,KAAK,CAACzM,SAAN,KAAoByM,QAAxB,EAAkC;MAChC;IACD;;IACD,KAAK,CAACzM,SAAN,GAAkByM,QAAlB;;IACA,KAAK,MAAM9I,KAAX,IAAoB,KAAK,CAACjF,SAAN,CAAgBkF,MAAhB,EAApB,EAA8C;MAC5C,IAAI6I,QAAJ,EAAc;QACZ9I,KAAK,CAAC+I,YAAN;MACD,CAFD,MAEO;QACL/I,KAAK,CAACgJ,WAAN;MACD;;MACDhJ,KAAK,CAACxZ,GAAN,CAAUyN,SAAV,CAAoB+N,MAApB,CAA2B,SAA3B,EAAsC8G,QAAtC;IACD;EACF;;EACD,CAACd,SAAS,GAAG;IACX,IAAI,CAAC,KAAK,CAAC5L,SAAX,EAAsB;MACpB,KAAK,CAACA,SAAN,GAAkB,IAAlB;;MACA,KAAK,MAAM4D,KAAX,IAAoB,KAAK,CAACjF,SAAN,CAAgBkF,MAAhB,EAApB,EAA8C;QAC5CD,KAAK,CAACyH,MAAN;MACD;;MACD,KAAK,MAAMrV,MAAX,IAAqB,KAAK,CAAC0I,UAAN,CAAiBmF,MAAjB,EAArB,EAAgD;QAC9C7N,MAAM,CAACqV,MAAP;MACD;IACF;EACF;;EACD,CAACM,UAAU,GAAG;IACZ,KAAKnJ,WAAL;;IACA,IAAI,KAAK,CAACxC,SAAV,EAAqB;MACnB,KAAK,CAACA,SAAN,GAAkB,KAAlB;;MACA,KAAK,MAAM4D,KAAX,IAAoB,KAAK,CAACjF,SAAN,CAAgBkF,MAAhB,EAApB,EAA8C;QAC5CD,KAAK,CAAC0H,OAAN;MACD;;MACD,KAAK,MAAMtV,MAAX,IAAqB,KAAK,CAAC0I,UAAN,CAAiBmF,MAAjB,EAArB,EAAgD;QAC9C7N,MAAM,CAACsV,OAAP;MACD;IACF;EACF;;EACDuB,UAAU,CAAC1B,SAAD,EAAY;IACpB,MAAM3B,OAAO,GAAG,EAAhB;;IACA,KAAK,MAAMxT,MAAX,IAAqB,KAAK,CAAC0I,UAAN,CAAiBmF,MAAjB,EAArB,EAAgD;MAC9C,IAAI7N,MAAM,CAACmV,SAAP,KAAqBA,SAAzB,EAAoC;QAClC3B,OAAO,CAAC9rB,IAAR,CAAasY,MAAb;MACD;IACF;;IACD,OAAOwT,OAAP;EACD;;EACDsD,SAAS,CAAC/iB,EAAD,EAAK;IACZ,OAAO,KAAK,CAAC2U,UAAN,CAAiBp3B,GAAjB,CAAqByiB,EAArB,CAAP;EACD;;EACDgjB,SAAS,CAAC/W,MAAD,EAAS;IAChB,KAAK,CAAC0I,UAAN,CAAiB7S,GAAjB,CAAqBmK,MAAM,CAACjM,EAA5B,EAAgCiM,MAAhC;EACD;;EACDgX,YAAY,CAAChX,MAAD,EAAS;IACnB,IAAIA,MAAM,CAAC5L,GAAP,CAAWqX,QAAX,CAAoB5X,QAAQ,CAAC6X,aAA7B,CAAJ,EAAiD;MAC/C,IAAI,KAAK,CAAChC,2BAAV,EAAuC;QACrCoE,YAAY,CAAC,KAAK,CAACpE,2BAAP,CAAZ;MACD;;MACD,KAAK,CAACA,2BAAN,GAAoCuN,UAAU,CAAC,MAAM;QACnD,KAAK5H,kBAAL;QACA,KAAK,CAAC3F,2BAAN,GAAoC,IAApC;MACD,CAH6C,EAG3C,CAH2C,CAA9C;IAID;;IACD,KAAK,CAAChB,UAAN,CAAiBrG,MAAjB,CAAwBrC,MAAM,CAACjM,EAA/B;IACA,KAAKmjB,QAAL,CAAclX,MAAd;;IACA,IAAI,CAACA,MAAM,CAAC6V,mBAAR,IAA+B,CAAC,KAAK,CAAC3M,4BAAN,CAAmCxB,GAAnC,CAAuC1H,MAAM,CAAC6V,mBAA9C,CAApC,EAAwG;MACtG,KAAK,CAAChN,iBAAN,EAAyB5S,MAAzB,CAAgC+J,MAAM,CAACjM,EAAvC;IACD;EACF;;EACDojB,2BAA2B,CAACnX,MAAD,EAAS;IAClC,KAAK,CAACkJ,4BAAN,CAAmCpH,GAAnC,CAAuC9B,MAAM,CAAC6V,mBAA9C;IACA,KAAKuB,4BAAL,CAAkCpX,MAAlC;IACAA,MAAM,CAACqX,OAAP,GAAiB,IAAjB;EACD;;EACDC,0BAA0B,CAACzB,mBAAD,EAAsB;IAC9C,OAAO,KAAK,CAAC3M,4BAAN,CAAmCxB,GAAnC,CAAuCmO,mBAAvC,CAAP;EACD;;EACD0B,8BAA8B,CAACvX,MAAD,EAAS;IACrC,KAAK,CAACkJ,4BAAN,CAAmC7G,MAAnC,CAA0CrC,MAAM,CAAC6V,mBAAjD;IACA,KAAK2B,+BAAL,CAAqCxX,MAArC;IACAA,MAAM,CAACqX,OAAP,GAAiB,KAAjB;EACD;;EACD,CAACjD,gBAAgB,CAACpU,MAAD,EAAS;IACxB,MAAM4N,KAAK,GAAG,KAAK,CAACjF,SAAN,CAAgBr3B,GAAhB,CAAoB0uB,MAAM,CAACmV,SAA3B,CAAd;;IACA,IAAIvH,KAAJ,EAAW;MACTA,KAAK,CAAC6J,YAAN,CAAmBzX,MAAnB;IACD,CAFD,MAEO;MACL,KAAK+W,SAAL,CAAe/W,MAAf;MACA,KAAK0R,sBAAL,CAA4B1R,MAA5B;IACD;EACF;;EACD0X,eAAe,CAAC1X,MAAD,EAAS;IACtB,IAAI,KAAK,CAACyI,YAAN,KAAuBzI,MAA3B,EAAmC;MACjC;IACD;;IACD,KAAK,CAACyI,YAAN,GAAqBzI,MAArB;;IACA,IAAIA,MAAJ,EAAY;MACV,KAAK,CAAC4U,gBAAN,CAAuB5U,MAAM,CAAC2X,kBAA9B;IACD;EACF;;EACsB,IAAnB,CAACC,kBAAkB,GAAG;IACxB,IAAIC,EAAE,GAAG,IAAT;;IACA,KAAKA,EAAL,IAAW,KAAK,CAACtN,eAAjB,EAAkC,CAAE;;IACpC,OAAOsN,EAAP;EACD;;EACDC,QAAQ,CAAC9X,MAAD,EAAS;IACf,IAAI,KAAK,CAAC4X,kBAAN,KAA6B5X,MAAjC,EAAyC;MACvC,KAAK,CAAC4U,gBAAN,CAAuB5U,MAAM,CAAC2X,kBAA9B;IACD;EACF;;EACDI,cAAc,CAAC/X,MAAD,EAAS;IACrB,IAAI,KAAK,CAACuK,eAAN,CAAsB7C,GAAtB,CAA0B1H,MAA1B,CAAJ,EAAuC;MACrC,KAAK,CAACuK,eAAN,CAAsBlI,MAAtB,CAA6BrC,MAA7B;MACAA,MAAM,CAACkX,QAAP;MACA,KAAK,CAACrF,oBAAN,CAA2B;QACzB/G,iBAAiB,EAAE,KAAKuH;MADC,CAA3B;MAGA;IACD;;IACD,KAAK,CAAC9H,eAAN,CAAsBzI,GAAtB,CAA0B9B,MAA1B;IACAA,MAAM,CAACgY,MAAP;IACA,KAAK,CAACpD,gBAAN,CAAuB5U,MAAM,CAAC2X,kBAA9B;IACA,KAAK,CAAC9F,oBAAN,CAA2B;MACzB/G,iBAAiB,EAAE;IADM,CAA3B;EAGD;;EACDgL,WAAW,CAAC9V,MAAD,EAAS;IAClB,KAAK,MAAM6X,EAAX,IAAiB,KAAK,CAACtN,eAAvB,EAAwC;MACtC,IAAIsN,EAAE,KAAK7X,MAAX,EAAmB;QACjB6X,EAAE,CAACX,QAAH;MACD;IACF;;IACD,KAAK,CAAC3M,eAAN,CAAsBzS,KAAtB;IACA,KAAK,CAACyS,eAAN,CAAsBzI,GAAtB,CAA0B9B,MAA1B;IACAA,MAAM,CAACgY,MAAP;IACA,KAAK,CAACpD,gBAAN,CAAuB5U,MAAM,CAAC2X,kBAA9B;IACA,KAAK,CAAC9F,oBAAN,CAA2B;MACzB/G,iBAAiB,EAAE;IADM,CAA3B;EAGD;;EACDmN,UAAU,CAACjY,MAAD,EAAS;IACjB,OAAO,KAAK,CAACuK,eAAN,CAAsB7C,GAAtB,CAA0B1H,MAA1B,CAAP;EACD;;EACsB,IAAnBkY,mBAAmB,GAAG;IACxB,OAAO,KAAK,CAAC3N,eAAN,CAAsBsD,MAAtB,GAA+BtH,IAA/B,GAAsC1gB,KAA7C;EACD;;EACDqxB,QAAQ,CAAClX,MAAD,EAAS;IACfA,MAAM,CAACkX,QAAP;IACA,KAAK,CAAC3M,eAAN,CAAsBlI,MAAtB,CAA6BrC,MAA7B;IACA,KAAK,CAAC6R,oBAAN,CAA2B;MACzB/G,iBAAiB,EAAE,KAAKuH;IADC,CAA3B;EAGD;;EACe,IAAZA,YAAY,GAAG;IACjB,OAAO,KAAK,CAAC9H,eAAN,CAAsB3S,IAAtB,KAA+B,CAAtC;EACD;;EACiB,IAAd2U,cAAc,GAAG;IACnB,OAAO,KAAK,CAAChC,eAAN,CAAsB3S,IAAtB,KAA+B,CAA/B,IAAoC,KAAKsgB,mBAAL,CAAyB3L,cAApE;EACD;;EACDtG,IAAI,GAAG;IACL,KAAK,CAAC8C,cAAN,CAAqB9C,IAArB;IACA,KAAK,CAAC4L,oBAAN,CAA2B;MACzBnL,kBAAkB,EAAE,KAAK,CAACqC,cAAN,CAAqBrC,kBAArB,EADK;MAEzBC,kBAAkB,EAAE,IAFK;MAGzBkE,OAAO,EAAE,KAAK,CAACA,OAAN;IAHgB,CAA3B;EAKD;;EACDpE,IAAI,GAAG;IACL,KAAK,CAACsC,cAAN,CAAqBtC,IAArB;IACA,KAAK,CAACoL,oBAAN,CAA2B;MACzBnL,kBAAkB,EAAE,IADK;MAEzBC,kBAAkB,EAAE,KAAK,CAACoC,cAAN,CAAqBpC,kBAArB,EAFK;MAGzBkE,OAAO,EAAE,KAAK,CAACA,OAAN;IAHgB,CAA3B;EAKD;;EACDyJ,WAAW,CAAC6D,MAAD,EAAS;IAClB,KAAK,CAACpP,cAAN,CAAqBjH,GAArB,CAAyBqW,MAAzB;IACA,KAAK,CAACtG,oBAAN,CAA2B;MACzBnL,kBAAkB,EAAE,IADK;MAEzBC,kBAAkB,EAAE,KAFK;MAGzBkE,OAAO,EAAE,KAAK,CAACA,OAAN;IAHgB,CAA3B;EAKD;;EACD,CAACA,OAAO,GAAG;IACT,IAAI,KAAK,CAACnC,UAAN,CAAiB9Q,IAAjB,KAA0B,CAA9B,EAAiC;MAC/B,OAAO,IAAP;IACD;;IACD,IAAI,KAAK,CAAC8Q,UAAN,CAAiB9Q,IAAjB,KAA0B,CAA9B,EAAiC;MAC/B,KAAK,MAAMoI,MAAX,IAAqB,KAAK,CAAC0I,UAAN,CAAiBmF,MAAjB,EAArB,EAAgD;QAC9C,OAAO7N,MAAM,CAAC6K,OAAP,EAAP;MACD;IACF;;IACD,OAAO,KAAP;EACD;;EACDxI,MAAM,GAAG;IACP,KAAK0N,cAAL;;IACA,IAAI,CAAC,KAAKsC,YAAV,EAAwB;MACtB;IACD;;IACD,MAAMmB,OAAO,GAAG,CAAC,GAAG,KAAK,CAACjJ,eAAV,CAAhB;;IACA,MAAMvE,GAAG,GAAG,MAAM;MAChB,KAAK,MAAMhG,MAAX,IAAqBwT,OAArB,EAA8B;QAC5BxT,MAAM,CAAC/J,MAAP;MACD;IACF,CAJD;;IAKA,MAAMgQ,IAAI,GAAG,MAAM;MACjB,KAAK,MAAMjG,MAAX,IAAqBwT,OAArB,EAA8B;QAC5B,KAAK,CAACY,gBAAN,CAAuBpU,MAAvB;MACD;IACF,CAJD;;IAKA,KAAKsU,WAAL,CAAiB;MACftO,GADe;MAEfC,IAFe;MAGfE,QAAQ,EAAE;IAHK,CAAjB;EAKD;;EACD4J,cAAc,GAAG;IACf,KAAK,CAACtH,YAAN,EAAoBsH,cAApB;EACD;;EACDnE,qBAAqB,GAAG;IACtB,OAAO,KAAK,CAACnD,YAAN,IAAsB,KAAK4J,YAAlC;EACD;;EACD,CAACgC,aAAa,CAACb,OAAD,EAAU;IACtB,KAAK,MAAMxT,MAAX,IAAqB,KAAK,CAACuK,eAA3B,EAA4C;MAC1CvK,MAAM,CAACkX,QAAP;IACD;;IACD,KAAK,CAAC3M,eAAN,CAAsBzS,KAAtB;;IACA,KAAK,MAAMkI,MAAX,IAAqBwT,OAArB,EAA8B;MAC5B,IAAIxT,MAAM,CAAC6K,OAAP,EAAJ,EAAsB;QACpB;MACD;;MACD,KAAK,CAACN,eAAN,CAAsBzI,GAAtB,CAA0B9B,MAA1B;MACAA,MAAM,CAACgY,MAAP;IACD;;IACD,KAAK,CAACnG,oBAAN,CAA2B;MACzB/G,iBAAiB,EAAE,KAAKuH;IADC,CAA3B;EAGD;;EACDjG,SAAS,GAAG;IACV,KAAK,MAAMpM,MAAX,IAAqB,KAAK,CAACuK,eAA3B,EAA4C;MAC1CvK,MAAM,CAACoY,MAAP;IACD;;IACD,KAAK,CAAC/D,aAAN,CAAoB,KAAK,CAAC3L,UAAN,CAAiBmF,MAAjB,EAApB;EACD;;EACDrB,WAAW,GAAG;IACZ,IAAI,KAAK,CAAC/D,YAAV,EAAwB;MACtB,KAAK,CAACA,YAAN,CAAmBsH,cAAnB;;MACA,IAAI,KAAK,CAACzF,IAAN,KAAep4B,oBAAoB,CAACqE,IAAxC,EAA8C;QAC5C;MACD;IACF;;IACD,IAAI,CAAC,KAAK87B,YAAV,EAAwB;MACtB;IACD;;IACD,KAAK,MAAMrS,MAAX,IAAqB,KAAK,CAACuK,eAA3B,EAA4C;MAC1CvK,MAAM,CAACkX,QAAP;IACD;;IACD,KAAK,CAAC3M,eAAN,CAAsBzS,KAAtB;IACA,KAAK,CAAC+Z,oBAAN,CAA2B;MACzB/G,iBAAiB,EAAE;IADM,CAA3B;EAGD;;EACD2B,wBAAwB,CAACvf,CAAD,EAAIC,CAAJ,EAAOkrB,QAAQ,GAAG,KAAlB,EAAyB;IAC/C,IAAI,CAACA,QAAL,EAAe;MACb,KAAKtI,cAAL;IACD;;IACD,IAAI,CAAC,KAAKsC,YAAV,EAAwB;MACtB;IACD;;IACD,KAAK,CAACrH,WAAN,CAAkB,CAAlB,KAAwB9d,CAAxB;IACA,KAAK,CAAC8d,WAAN,CAAkB,CAAlB,KAAwB7d,CAAxB;IACA,MAAM,CAACmrB,MAAD,EAASC,MAAT,IAAmB,KAAK,CAACvN,WAA/B;IACA,MAAMwI,OAAO,GAAG,CAAC,GAAG,KAAK,CAACjJ,eAAV,CAAhB;IACA,MAAMiO,YAAY,GAAG,IAArB;;IACA,IAAI,KAAK,CAACvN,oBAAV,EAAgC;MAC9B6C,YAAY,CAAC,KAAK,CAAC7C,oBAAP,CAAZ;IACD;;IACD,KAAK,CAACA,oBAAN,GAA6BgM,UAAU,CAAC,MAAM;MAC5C,KAAK,CAAChM,oBAAN,GAA6B,IAA7B;MACA,KAAK,CAACD,WAAN,CAAkB,CAAlB,IAAuB,KAAK,CAACA,WAAN,CAAkB,CAAlB,IAAuB,CAA9C;MACA,KAAKsJ,WAAL,CAAiB;QACftO,GAAG,EAAE,MAAM;UACT,KAAK,MAAMhG,MAAX,IAAqBwT,OAArB,EAA8B;YAC5B,IAAI,KAAK,CAAC9K,UAAN,CAAiBhB,GAAjB,CAAqB1H,MAAM,CAACjM,EAA5B,CAAJ,EAAqC;cACnCiM,MAAM,CAACyY,eAAP,CAAuBH,MAAvB,EAA+BC,MAA/B;YACD;UACF;QACF,CAPc;QAQftS,IAAI,EAAE,MAAM;UACV,KAAK,MAAMjG,MAAX,IAAqBwT,OAArB,EAA8B;YAC5B,IAAI,KAAK,CAAC9K,UAAN,CAAiBhB,GAAjB,CAAqB1H,MAAM,CAACjM,EAA5B,CAAJ,EAAqC;cACnCiM,MAAM,CAACyY,eAAP,CAAuB,CAACH,MAAxB,EAAgC,CAACC,MAAjC;YACD;UACF;QACF,CAdc;QAefpS,QAAQ,EAAE;MAfK,CAAjB;IAiBD,CApBsC,EAoBpCqS,YApBoC,CAAvC;;IAqBA,KAAK,MAAMxY,MAAX,IAAqBwT,OAArB,EAA8B;MAC5BxT,MAAM,CAACyY,eAAP,CAAuBvrB,CAAvB,EAA0BC,CAA1B;IACD;EACF;;EACDurB,gBAAgB,GAAG;IACjB,IAAI,CAAC,KAAKrG,YAAV,EAAwB;MACtB;IACD;;IACD,KAAK1C,iBAAL,CAAuB,IAAvB;IACA,KAAK,CAACxG,eAAN,GAAwB,IAAIzZ,GAAJ,EAAxB;;IACA,KAAK,MAAMsQ,MAAX,IAAqB,KAAK,CAACuK,eAA3B,EAA4C;MAC1C,KAAK,CAACpB,eAAN,CAAsBtT,GAAtB,CAA0BmK,MAA1B,EAAkC;QAChC2Y,MAAM,EAAE3Y,MAAM,CAAC9S,CADiB;QAEhC0rB,MAAM,EAAE5Y,MAAM,CAAC7S,CAFiB;QAGhC0rB,cAAc,EAAE7Y,MAAM,CAACmV,SAHS;QAIhC2D,IAAI,EAAE,CAJ0B;QAKhCC,IAAI,EAAE,CAL0B;QAMhCC,YAAY,EAAE,CAAC;MANiB,CAAlC;IAQD;EACF;;EACDC,cAAc,GAAG;IACf,IAAI,CAAC,KAAK,CAAC9P,eAAX,EAA4B;MAC1B,OAAO,KAAP;IACD;;IACD,KAAKwG,iBAAL,CAAuB,KAAvB;IACA,MAAMvnB,GAAG,GAAG,KAAK,CAAC+gB,eAAlB;IACA,KAAK,CAACA,eAAN,GAAwB,IAAxB;IACA,IAAI+P,sBAAsB,GAAG,KAA7B;;IACA,KAAK,MAAM,CAAC;MACVhsB,CADU;MAEVC,CAFU;MAGVgoB;IAHU,CAAD,EAIRtvB,KAJQ,CAAX,IAIauC,GAJb,EAIkB;MAChBvC,KAAK,CAACizB,IAAN,GAAa5rB,CAAb;MACArH,KAAK,CAACkzB,IAAN,GAAa5rB,CAAb;MACAtH,KAAK,CAACmzB,YAAN,GAAqB7D,SAArB;MACA+D,sBAAsB,KAAKhsB,CAAC,KAAKrH,KAAK,CAAC8yB,MAAZ,IAAsBxrB,CAAC,KAAKtH,KAAK,CAAC+yB,MAAlC,IAA4CzD,SAAS,KAAKtvB,KAAK,CAACgzB,cAA3F;IACD;;IACD,IAAI,CAACK,sBAAL,EAA6B;MAC3B,OAAO,KAAP;IACD;;IACD,MAAMC,IAAI,GAAG,CAACnZ,MAAD,EAAS9S,CAAT,EAAYC,CAAZ,EAAegoB,SAAf,KAA6B;MACxC,IAAI,KAAK,CAACzM,UAAN,CAAiBhB,GAAjB,CAAqB1H,MAAM,CAACjM,EAA5B,CAAJ,EAAqC;QACnC,MAAMqP,MAAM,GAAG,KAAK,CAACuF,SAAN,CAAgBr3B,GAAhB,CAAoB6jC,SAApB,CAAf;;QACA,IAAI/R,MAAJ,EAAY;UACVpD,MAAM,CAACoZ,qBAAP,CAA6BhW,MAA7B,EAAqClW,CAArC,EAAwCC,CAAxC;QACD,CAFD,MAEO;UACL6S,MAAM,CAACmV,SAAP,GAAmBA,SAAnB;UACAnV,MAAM,CAAC9S,CAAP,GAAWA,CAAX;UACA8S,MAAM,CAAC7S,CAAP,GAAWA,CAAX;QACD;MACF;IACF,CAXD;;IAYA,KAAKmnB,WAAL,CAAiB;MACftO,GAAG,EAAE,MAAM;QACT,KAAK,MAAM,CAAChG,MAAD,EAAS;UAClB8Y,IADkB;UAElBC,IAFkB;UAGlBC;QAHkB,CAAT,CAAX,IAIM5wB,GAJN,EAIW;UACT+wB,IAAI,CAACnZ,MAAD,EAAS8Y,IAAT,EAAeC,IAAf,EAAqBC,YAArB,CAAJ;QACD;MACF,CATc;MAUf/S,IAAI,EAAE,MAAM;QACV,KAAK,MAAM,CAACjG,MAAD,EAAS;UAClB2Y,MADkB;UAElBC,MAFkB;UAGlBC;QAHkB,CAAT,CAAX,IAIMzwB,GAJN,EAIW;UACT+wB,IAAI,CAACnZ,MAAD,EAAS2Y,MAAT,EAAiBC,MAAjB,EAAyBC,cAAzB,CAAJ;QACD;MACF,CAlBc;MAmBf1S,QAAQ,EAAE;IAnBK,CAAjB;IAqBA,OAAO,IAAP;EACD;;EACDkT,mBAAmB,CAACC,EAAD,EAAKC,EAAL,EAAS;IAC1B,IAAI,CAAC,KAAK,CAACpQ,eAAX,EAA4B;MAC1B;IACD;;IACD,KAAK,MAAMnJ,MAAX,IAAqB,KAAK,CAACmJ,eAAN,CAAsBjhB,IAAtB,EAArB,EAAmD;MACjD8X,MAAM,CAACwZ,IAAP,CAAYF,EAAZ,EAAgBC,EAAhB;IACD;EACF;;EACDE,OAAO,CAACzZ,MAAD,EAAS;IACd,IAAIA,MAAM,CAACoD,MAAP,KAAkB,IAAtB,EAA4B;MAC1B,MAAMA,MAAM,GAAG,KAAK8R,QAAL,CAAclV,MAAM,CAACmV,SAArB,CAAf;;MACA,IAAI/R,MAAJ,EAAY;QACVA,MAAM,CAACsW,YAAP,CAAoB1Z,MAApB;QACAoD,MAAM,CAACqU,YAAP,CAAoBzX,MAApB;MACD,CAHD,MAGO;QACL,KAAK+W,SAAL,CAAe/W,MAAf;QACA,KAAK0R,sBAAL,CAA4B1R,MAA5B;QACAA,MAAM,CAACyZ,OAAP;MACD;IACF,CAVD,MAUO;MACLzZ,MAAM,CAACoD,MAAP,CAAcqU,YAAd,CAA2BzX,MAA3B;IACD;EACF;;EAC2B,IAAxBuU,wBAAwB,GAAG;IAC7B,OAAO,KAAKoF,SAAL,IAAkBC,uBAAlB,MAA+C,KAAK,CAACrP,eAAN,CAAsB3S,IAAtB,KAA+B,CAA/B,IAAoC,KAAKsgB,mBAAL,CAAyB0B,uBAAzB,EAA1F;EACD;;EACDC,QAAQ,CAAC7Z,MAAD,EAAS;IACf,OAAO,KAAK,CAACyI,YAAN,KAAuBzI,MAA9B;EACD;;EACD2Z,SAAS,GAAG;IACV,OAAO,KAAK,CAAClR,YAAb;EACD;;EACDqR,OAAO,GAAG;IACR,OAAO,KAAK,CAACxP,IAAb;EACD;;EACe,IAAZyP,YAAY,GAAG;IACjB,OAAOrlC,MAAM,CAAC,IAAD,EAAO,cAAP,EAAuB,IAAIivB,YAAJ,EAAvB,CAAb;EACD;;EACDyN,iBAAiB,CAACZ,SAAD,EAAY;IAC3B,IAAI,CAACA,SAAL,EAAgB;MACd,OAAO,IAAP;IACD;;IACD,MAAMI,SAAS,GAAG/c,QAAQ,CAACgd,YAAT,EAAlB;;IACA,KAAK,IAAIzpB,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGwiB,SAAS,CAACoJ,UAA/B,EAA2C5yB,CAAC,GAAGgH,EAA/C,EAAmDhH,CAAC,EAApD,EAAwD;MACtD,IAAI,CAACopB,SAAS,CAAC/E,QAAV,CAAmBmF,SAAS,CAACqJ,UAAV,CAAqB7yB,CAArB,EAAwB8yB,uBAA3C,CAAL,EAA0E;QACxE,OAAO,IAAP;MACD;IACF;;IACD,MAAM;MACJhtB,CAAC,EAAEsiB,MADC;MAEJriB,CAAC,EAAEsiB,MAFC;MAGJ3d,KAAK,EAAEqoB,WAHH;MAIJpoB,MAAM,EAAEqoB;IAJJ,IAKF5J,SAAS,CAACd,qBAAV,EALJ;IAMA,IAAI2K,OAAJ;;IACA,QAAQ7J,SAAS,CAAC8J,YAAV,CAAuB,oBAAvB,CAAR;MACE,KAAK,IAAL;QACED,OAAO,GAAG,CAACntB,CAAD,EAAIC,CAAJ,EAAOsS,CAAP,EAAUC,CAAV,MAAiB;UACzBxS,CAAC,EAAE,CAACC,CAAC,GAAGsiB,MAAL,IAAe2K,YADO;UAEzBjtB,CAAC,EAAE,IAAI,CAACD,CAAC,GAAGuS,CAAJ,GAAQ+P,MAAT,IAAmB2K,WAFD;UAGzBroB,KAAK,EAAE4N,CAAC,GAAG0a,YAHc;UAIzBroB,MAAM,EAAE0N,CAAC,GAAG0a;QAJa,CAAjB,CAAV;;QAMA;;MACF,KAAK,KAAL;QACEE,OAAO,GAAG,CAACntB,CAAD,EAAIC,CAAJ,EAAOsS,CAAP,EAAUC,CAAV,MAAiB;UACzBxS,CAAC,EAAE,IAAI,CAACA,CAAC,GAAGuS,CAAJ,GAAQ+P,MAAT,IAAmB2K,WADD;UAEzBhtB,CAAC,EAAE,IAAI,CAACA,CAAC,GAAGuS,CAAJ,GAAQ+P,MAAT,IAAmB2K,YAFD;UAGzBtoB,KAAK,EAAE2N,CAAC,GAAG0a,WAHc;UAIzBpoB,MAAM,EAAE2N,CAAC,GAAG0a;QAJa,CAAjB,CAAV;;QAMA;;MACF,KAAK,KAAL;QACEC,OAAO,GAAG,CAACntB,CAAD,EAAIC,CAAJ,EAAOsS,CAAP,EAAUC,CAAV,MAAiB;UACzBxS,CAAC,EAAE,IAAI,CAACC,CAAC,GAAGuS,CAAJ,GAAQ+P,MAAT,IAAmB2K,YADD;UAEzBjtB,CAAC,EAAE,CAACD,CAAC,GAAGsiB,MAAL,IAAe2K,WAFO;UAGzBroB,KAAK,EAAE4N,CAAC,GAAG0a,YAHc;UAIzBroB,MAAM,EAAE0N,CAAC,GAAG0a;QAJa,CAAjB,CAAV;;QAMA;;MACF;QACEE,OAAO,GAAG,CAACntB,CAAD,EAAIC,CAAJ,EAAOsS,CAAP,EAAUC,CAAV,MAAiB;UACzBxS,CAAC,EAAE,CAACA,CAAC,GAAGsiB,MAAL,IAAe2K,WADO;UAEzBhtB,CAAC,EAAE,CAACA,CAAC,GAAGsiB,MAAL,IAAe2K,YAFO;UAGzBtoB,KAAK,EAAE2N,CAAC,GAAG0a,WAHc;UAIzBpoB,MAAM,EAAE2N,CAAC,GAAG0a;QAJa,CAAjB,CAAV;;QAMA;IAhCJ;;IAkCA,MAAMrX,KAAK,GAAG,EAAd;;IACA,KAAK,IAAI3b,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGwiB,SAAS,CAACoJ,UAA/B,EAA2C5yB,CAAC,GAAGgH,EAA/C,EAAmDhH,CAAC,EAApD,EAAwD;MACtD,MAAMmzB,KAAK,GAAG3J,SAAS,CAACqJ,UAAV,CAAqB7yB,CAArB,CAAd;;MACA,IAAImzB,KAAK,CAACC,SAAV,EAAqB;QACnB;MACD;;MACD,KAAK,MAAM;QACTttB,CADS;QAETC,CAFS;QAGT2E,KAHS;QAITC;MAJS,CAAX,IAKKwoB,KAAK,CAACE,cAAN,EALL,EAK6B;QAC3B,IAAI3oB,KAAK,KAAK,CAAV,IAAeC,MAAM,KAAK,CAA9B,EAAiC;UAC/B;QACD;;QACDgR,KAAK,CAACrb,IAAN,CAAW2yB,OAAO,CAACntB,CAAD,EAAIC,CAAJ,EAAO2E,KAAP,EAAcC,MAAd,CAAlB;MACD;IACF;;IACD,OAAOgR,KAAK,CAACvd,MAAN,KAAiB,CAAjB,GAAqB,IAArB,GAA4Bud,KAAnC;EACD;;EACDqU,4BAA4B,CAAC;IAC3BvB,mBAD2B;IAE3B9hB;EAF2B,CAAD,EAGzB;IACD,CAAC,KAAK,CAAC+U,0BAAN,KAAqC,IAAIpZ,GAAJ,EAAtC,EAAiDmG,GAAjD,CAAqDggB,mBAArD,EAA0E9hB,EAA1E;EACD;;EACDyjB,+BAA+B,CAAC;IAC9B3B;EAD8B,CAAD,EAE5B;IACD,KAAK,CAAC/M,0BAAN,EAAkCzG,MAAlC,CAAyCwT,mBAAzC;EACD;;EACD6E,uBAAuB,CAACC,UAAD,EAAa;IAClC,MAAMC,QAAQ,GAAG,KAAK,CAAC9R,0BAAN,EAAkCx3B,GAAlC,CAAsCqpC,UAAU,CAACzgB,IAAX,CAAgBnG,EAAtD,CAAjB;;IACA,IAAI,CAAC6mB,QAAL,EAAe;MACb;IACD;;IACD,MAAM5a,MAAM,GAAG,KAAK,CAAC6I,iBAAN,CAAwBgS,WAAxB,CAAoCD,QAApC,CAAf;;IACA,IAAI,CAAC5a,MAAL,EAAa;MACX;IACD;;IACD,IAAI,KAAK,CAACsK,IAAN,KAAep4B,oBAAoB,CAACqE,IAApC,IAA4C,CAACypB,MAAM,CAAC8a,eAAxD,EAAyE;MACvE;IACD;;IACD9a,MAAM,CAAC0a,uBAAP,CAA+BC,UAA/B;EACD;;AA9zC6B;;AAi0ChC,C,CAAC;;AAED,MAAMI,OAAN,CAAc;EACZ,CAAC7a,OAAD,GAAW,IAAX;EACA,CAAC8a,iBAAD,GAAqB,KAArB;EACA,CAACC,aAAD,GAAiB,IAAjB;EACA,CAACC,cAAD,GAAkB,IAAlB;EACA,CAACC,qBAAD,GAAyB,IAAzB;EACA,CAACC,sBAAD,GAA0B,KAA1B;EACA,CAACC,KAAD,GAAS,IAAT;EACA,CAACrb,MAAD,GAAU,IAAV;EACA,CAACsb,WAAD,GAAe,IAAf;EACA,CAACC,kBAAD,GAAsB,IAAtB;EACA,CAACpN,iBAAD,GAAqB,KAArB;EACmB,OAAZqN,YAAY,GAAG,IAAH;;EACnBn1B,WAAW,CAAC2Z,MAAD,EAAS;IAClB,KAAK,CAACA,MAAN,GAAeA,MAAf;IACA,KAAK,CAACmO,iBAAN,GAA0BnO,MAAM,CAACa,UAAP,CAAkBsN,iBAA5C;EACD;;EACgB,OAAVsN,UAAU,CAACC,WAAD,EAAc;IAC7BX,OAAO,CAACS,YAAR,KAAyBE,WAAzB;EACD;;EACKjb,MAAM,GAAG;IAAA;;IAAA;MACb,MAAMP,OAAO,GAAG,MAAI,CAAC,CAAC+a,aAAN,GAAsBpnB,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAtC;MACA6M,OAAO,CAACS,SAAR,GAAoB,SAApB;MACA,IAAIpc,GAAJ;;MACA,IAAI,MAAI,CAAC,CAAC4pB,iBAAV,EAA6B;QAC3BjO,OAAO,CAAC2B,SAAR,CAAkBC,GAAlB,CAAsB,KAAtB;QACAvd,GAAG,SAASw2B,OAAO,CAACS,YAAR,CAAqBlqC,GAArB,CAAyB,gDAAzB,CAAZ;MACD,CAHD,MAGO;QACLiT,GAAG,SAASw2B,OAAO,CAACS,YAAR,CAAqBlqC,GAArB,CAAyB,oCAAzB,CAAZ;MACD;;MACD4uB,OAAO,CAACyb,WAAR,GAAsBp3B,GAAtB;MACA2b,OAAO,CAAC9M,YAAR,CAAqB,YAArB,EAAmC7O,GAAnC;MACA2b,OAAO,CAACkC,QAAR,GAAmB,GAAnB;MACA,MAAMxB,MAAM,GAAG,MAAI,CAAC,CAACZ,MAAN,CAAaa,UAAb,CAAwBC,OAAvC;MACAZ,OAAO,CAACa,gBAAR,CAAyB,aAAzB,EAAwCxsB,aAAxC,EAAuD;QACrDqsB;MADqD,CAAvD;MAGAV,OAAO,CAACa,gBAAR,CAAyB,aAAzB,EAAwCqG,KAAK,IAAIA,KAAK,CAAC/F,eAAN,EAAjD,EAA0E;QACxET;MADwE,CAA1E;;MAGA,MAAMgb,OAAO,GAAGxU,KAAK,IAAI;QACvBA,KAAK,CAAC9J,cAAN;;QACA,MAAI,CAAC,CAAC0C,MAAN,CAAaa,UAAb,CAAwB+N,WAAxB,CAAoC,MAAI,CAAC,CAAC5O,MAA1C;;QACA,IAAI,MAAI,CAAC,CAACmO,iBAAV,EAA6B;UAC3B,MAAI,CAAC,CAACnO,MAAN,CAAa6b,gBAAb,CAA8B;YAC5BzF,MAAM,EAAE,iDADoB;YAE5Blc,IAAI,EAAE;cACJ4hB,KAAK,EAAE,MAAI,CAAC,CAACA;YADT;UAFsB,CAA9B;QAMD;MACF,CAXD;;MAYA5b,OAAO,CAACa,gBAAR,CAAyB,OAAzB,EAAkC6a,OAAlC,EAA2C;QACzCja,OAAO,EAAE,IADgC;QAEzCf;MAFyC,CAA3C;MAIAV,OAAO,CAACa,gBAAR,CAAyB,SAAzB,EAAoCqG,KAAK,IAAI;QAC3C,IAAIA,KAAK,CAAC2E,MAAN,KAAiB7L,OAAjB,IAA4BkH,KAAK,CAACn2B,GAAN,KAAc,OAA9C,EAAuD;UACrD,MAAI,CAAC,CAACmqC,sBAAN,GAA+B,IAA/B;UACAQ,OAAO,CAACxU,KAAD,CAAP;QACD;MACF,CALD,EAKG;QACDxG;MADC,CALH;MAQA,MAAM,MAAI,CAAC,CAACmb,QAAN,EAAN;MACA,OAAO7b,OAAP;IA7Ca;EA8Cd;;EACS,IAAN,CAAC4b,KAAK,GAAG;IACX,OAAO,KAAK,CAAC5b,OAAN,IAAiB,OAAjB,IAA4B,KAAK,CAACA,OAAN,KAAkB,IAAlB,IAA0B,KAAKob,WAA/B,IAA8C,QAA1E,IAAsF,SAA7F;EACD;;EACDU,MAAM,GAAG;IACP,IAAI,CAAC,KAAK,CAACf,aAAX,EAA0B;MACxB;IACD;;IACD,KAAK,CAACA,aAAN,CAAoB3L,KAApB,CAA0B;MACxB2M,YAAY,EAAE,KAAK,CAACb;IADI,CAA1B;IAGA,KAAK,CAACA,sBAAN,GAA+B,KAA/B;EACD;;EACDvQ,OAAO,GAAG;IACR,IAAI,KAAK,CAACsD,iBAAV,EAA6B;MAC3B,OAAO,KAAK,CAACjO,OAAN,KAAkB,IAAzB;IACD;;IACD,OAAO,CAAC,KAAK,CAACA,OAAP,IAAkB,CAAC,KAAK,CAAC8a,iBAAhC;EACD;;EACDkB,OAAO,GAAG;IACR,IAAI,KAAK,CAAC/N,iBAAV,EAA6B;MAC3B,OAAO,KAAK,CAACjO,OAAN,KAAkB,IAAlB,IAA0B,CAAC,CAAC,KAAK,CAACob,WAAzC;IACD;;IACD,OAAO,KAAKzQ,OAAL,EAAP;EACD;;EACc,IAAXyQ,WAAW,GAAG;IAChB,OAAO,KAAK,CAACA,WAAb;EACD;;EACKa,cAAc,CAACb,WAAD,EAAc;IAAA;;IAAA;MAChC,IAAI,MAAI,CAAC,CAACpb,OAAN,KAAkB,IAAtB,EAA4B;QAC1B;MACD;;MACD,MAAI,CAAC,CAACob,WAAN,GAAoBA,WAApB;MACA,MAAI,CAAC,CAACC,kBAAN,SAAiCR,OAAO,CAACS,YAAR,CAAqBlqC,GAArB,CAAyB,8DAAzB,EAAyF;QACxH8qC,gBAAgB,EAAEd;MADsG,CAAzF,CAAjC;;MAGA,MAAI,CAAC,CAACS,QAAN;IARgC;EASjC;;EACDM,kBAAkB,CAAC/nB,UAAU,GAAG,KAAd,EAAqB;IACrC,IAAI,CAAC,KAAK,CAAC6Z,iBAAP,IAA4B,KAAK,CAACjO,OAAtC,EAA+C;MAC7C,KAAK,CAACmb,KAAN,EAAaplB,MAAb;MACA,KAAK,CAAColB,KAAN,GAAc,IAAd;MACA;IACD;;IACD,IAAI,CAAC,KAAK,CAACA,KAAX,EAAkB;MAChB,MAAMA,KAAK,GAAG,KAAK,CAACA,KAAN,GAAcxnB,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAA5B;MACAgoB,KAAK,CAAC1a,SAAN,GAAkB,gBAAlB;MACA,KAAK,CAACX,MAAN,CAAa5L,GAAb,CAAiBS,MAAjB,CAAwBwmB,KAAxB;IACD;;IACD,KAAK,CAACA,KAAN,CAAYxZ,SAAZ,CAAsB+N,MAAtB,CAA6B,QAA7B,EAAuC,CAACtb,UAAxC;EACD;;EACD6S,SAAS,CAACmV,YAAD,EAAe;IACtB,IAAIpc,OAAO,GAAG,KAAK,CAACA,OAApB;;IACA,IAAI,CAACoc,YAAD,IAAiB,KAAK,CAAChB,WAAN,KAAsBpb,OAA3C,EAAoD;MAClDA,OAAO,GAAG,KAAK,CAACqb,kBAAhB;IACD;;IACD,OAAO;MACLrb,OADK;MAELqc,UAAU,EAAE,KAAK,CAACvB,iBAFb;MAGLM,WAAW,EAAE,KAAK,CAACA,WAHd;MAILC,kBAAkB,EAAE,KAAK,CAACA;IAJrB,CAAP;EAMD;;EACO,IAAJrhB,IAAI,GAAG;IACT,OAAO;MACLgG,OAAO,EAAE,KAAK,CAACA,OADV;MAELqc,UAAU,EAAE,KAAK,CAACvB;IAFb,CAAP;EAID;;EACO,IAAJ9gB,IAAI,CAAC;IACPgG,OADO;IAEPqc,UAFO;IAGPjB,WAHO;IAIPC,kBAJO;IAKPiB,MAAM,GAAG;EALF,CAAD,EAML;IACD,IAAIlB,WAAJ,EAAiB;MACf,KAAK,CAACA,WAAN,GAAoBA,WAApB;MACA,KAAK,CAACC,kBAAN,GAA2BA,kBAA3B;IACD;;IACD,IAAI,KAAK,CAACrb,OAAN,KAAkBA,OAAlB,IAA6B,KAAK,CAAC8a,iBAAN,KAA4BuB,UAA7D,EAAyE;MACvE;IACD;;IACD,IAAI,CAACC,MAAL,EAAa;MACX,KAAK,CAACtc,OAAN,GAAgBA,OAAhB;MACA,KAAK,CAAC8a,iBAAN,GAA0BuB,UAA1B;IACD;;IACD,KAAK,CAACR,QAAN;EACD;;EACDnM,MAAM,CAAC6M,OAAO,GAAG,KAAX,EAAkB;IACtB,IAAI,CAAC,KAAK,CAACxB,aAAX,EAA0B;MACxB;IACD;;IACD,IAAI,CAACwB,OAAD,IAAY,KAAK,CAACtB,qBAAtB,EAA6C;MAC3CrN,YAAY,CAAC,KAAK,CAACqN,qBAAP,CAAZ;MACA,KAAK,CAACA,qBAAN,GAA8B,IAA9B;IACD;;IACD,KAAK,CAACF,aAAN,CAAoByB,QAApB,GAA+B,CAACD,OAAhC;EACD;;EACDxa,KAAK,GAAG;IACN,KAAK,CAACjC,MAAN,CAAa6b,gBAAb,CAA8B;MAC5BzF,MAAM,EAAE,mDADoB;MAE5Blc,IAAI,EAAE;QACJ4hB,KAAK,EAAE,KAAK,CAACA;MADT;IAFsB,CAA9B;EAMD;;EACDpqB,OAAO,GAAG;IACR,KAAK,CAACupB,aAAN,EAAqBhlB,MAArB;IACA,KAAK,CAACglB,aAAN,GAAsB,IAAtB;IACA,KAAK,CAACC,cAAN,GAAuB,IAAvB;IACA,KAAK,CAACG,KAAN,EAAaplB,MAAb;IACA,KAAK,CAAColB,KAAN,GAAc,IAAd;EACD;;EACK,CAACU,QAAQ,GAAG;IAAA;;IAAA;MAChB,MAAM5Z,MAAM,GAAG,OAAI,CAAC,CAAC8Y,aAArB;;MACA,IAAI,CAAC9Y,MAAL,EAAa;QACX;MACD;;MACD,IAAI,OAAI,CAAC,CAACgM,iBAAV,EAA6B;QAC3B,MAAM2N,KAAK,GAAG,OAAI,CAAC,CAACA,KAApB;QACA,MAAM7mC,IAAI,GAAG6mC,KAAK,KAAK,QAAV,GAAqB,WAArB,GAAmCA,KAAhD;QACA3Z,MAAM,CAACN,SAAP,CAAiB+N,MAAjB,CAAwB,MAAxB,EAAgC,CAAC,CAAC,OAAI,CAAC,CAAC1P,OAAxC;;QACA6a,OAAO,CAACS,YAAR,CAAqBlqC,GAArB,CAA0B,6BAA4B2D,IAAK,eAA3D,EAA2EglB,IAA3E,CAAgF1V,GAAG,IAAI;UACrF4d,MAAM,CAAC/O,YAAP,CAAoB,YAApB,EAAkC7O,GAAlC;;UACA,KAAK,MAAMo4B,KAAX,IAAoBxa,MAAM,CAACya,UAA3B,EAAuC;YACrC,IAAID,KAAK,CAACxM,QAAN,KAAmBC,IAAI,CAACC,SAA5B,EAAuC;cACrCsM,KAAK,CAAChB,WAAN,GAAoBp3B,GAApB;cACA;YACD;UACF;QACF,CARD;;QASA,IAAI,CAAC,OAAI,CAAC,CAAC2b,OAAX,EAAoB;UAClB,OAAI,CAAC,CAACgb,cAAN,EAAsBjlB,MAAtB;UACA;QACD;MACF,CAjBD,MAiBO;QACL,IAAI,CAAC,OAAI,CAAC,CAACiK,OAAP,IAAkB,CAAC,OAAI,CAAC,CAAC8a,iBAA7B,EAAgD;UAC9C7Y,MAAM,CAACN,SAAP,CAAiB5L,MAAjB,CAAwB,MAAxB;UACA,OAAI,CAAC,CAACilB,cAAN,EAAsBjlB,MAAtB;UACA;QACD;;QACDkM,MAAM,CAACN,SAAP,CAAiBC,GAAjB,CAAqB,MAArB;;QACAiZ,OAAO,CAACS,YAAR,CAAqBlqC,GAArB,CAAyB,yCAAzB,EAAoE2oB,IAApE,CAAyE1V,GAAG,IAAI;UAC9E4d,MAAM,CAAC/O,YAAP,CAAoB,YAApB,EAAkC7O,GAAlC;QACD,CAFD;MAGD;;MACD,IAAIs4B,OAAO,GAAG,OAAI,CAAC,CAAC3B,cAApB;;MACA,IAAI,CAAC2B,OAAL,EAAc;QACZ,OAAI,CAAC,CAAC3B,cAAN,GAAuB2B,OAAO,GAAGhpB,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAAjC;QACAwpB,OAAO,CAAClc,SAAR,GAAoB,SAApB;QACAkc,OAAO,CAACzpB,YAAR,CAAqB,MAArB,EAA6B,SAA7B;QACA,MAAMW,EAAE,GAAG8oB,OAAO,CAAC9oB,EAAR,GAAc,oBAAmB,OAAI,CAAC,CAACiM,MAAN,CAAajM,EAAG,EAA5D;QACAoO,MAAM,CAAC/O,YAAP,CAAoB,kBAApB,EAAwCW,EAAxC;QACA,MAAM+oB,qBAAqB,GAAG,GAA9B;QACA,MAAMlc,MAAM,GAAG,OAAI,CAAC,CAACZ,MAAN,CAAaa,UAAb,CAAwBC,OAAvC;QACAF,MAAM,CAACG,gBAAP,CAAwB,OAAxB,EAAiC,MAAM;UACrC+M,YAAY,CAAC,OAAI,CAAC,CAACqN,qBAAP,CAAZ;UACA,OAAI,CAAC,CAACA,qBAAN,GAA8B,IAA9B;QACD,CAHD,EAGG;UACDnM,IAAI,EAAE;QADL,CAHH;QAMA7M,MAAM,CAACpB,gBAAP,CAAwB,YAAxB,EAAsC,MAAM;UAC1C,OAAI,CAAC,CAACoa,qBAAN,GAA8BlE,UAAU,CAAC,MAAM;YAC7C,OAAI,CAAC,CAACkE,qBAAN,GAA8B,IAA9B;;YACA,OAAI,CAAC,CAACD,cAAN,CAAqBrZ,SAArB,CAA+BC,GAA/B,CAAmC,MAAnC;;YACA,OAAI,CAAC,CAAC9B,MAAN,CAAa6b,gBAAb,CAA8B;cAC5BzF,MAAM,EAAE;YADoB,CAA9B;UAGD,CANuC,EAMrC0G,qBANqC,CAAxC;QAOD,CARD,EAQG;UACDlc;QADC,CARH;QAWAuB,MAAM,CAACpB,gBAAP,CAAwB,YAAxB,EAAsC,MAAM;UAC1C,IAAI,OAAI,CAAC,CAACoa,qBAAV,EAAiC;YAC/BrN,YAAY,CAAC,OAAI,CAAC,CAACqN,qBAAP,CAAZ;YACA,OAAI,CAAC,CAACA,qBAAN,GAA8B,IAA9B;UACD;;UACD,OAAI,CAAC,CAACD,cAAN,EAAsBrZ,SAAtB,CAAgC5L,MAAhC,CAAuC,MAAvC;QACD,CAND,EAMG;UACD2K;QADC,CANH;MASD;;MACDic,OAAO,CAACE,SAAR,GAAoB,OAAI,CAAC,CAAC/B,iBAAN,SAAgCD,OAAO,CAACS,YAAR,CAAqBlqC,GAArB,CAAyB,0CAAzB,CAAhC,GAAuG,OAAI,CAAC,CAAC4uB,OAAjI;;MACA,IAAI,CAAC2c,OAAO,CAAChlB,UAAb,EAAyB;QACvBsK,MAAM,CAACtN,MAAP,CAAcgoB,OAAd;MACD;;MACD,MAAMnb,OAAO,GAAG,OAAI,CAAC,CAAC1B,MAAN,CAAagd,kBAAb,EAAhB;;MACAtb,OAAO,EAAEtO,YAAT,CAAsB,kBAAtB,EAA0CypB,OAAO,CAAC9oB,EAAlD;IA1EgB;EA2EjB;;AA/PW;;AAkQd,C,CAAC;;AAMD,MAAMkpB,gBAAN,CAAuB;EACrB,CAACC,iBAAD,GAAqB,IAArB;EACA,CAACC,cAAD,GAAkB,IAAlB;EACA,CAACjd,OAAD,GAAW,IAAX;EACA,CAACwc,QAAD,GAAY,KAAZ;EACA,CAACU,eAAD,GAAmB,KAAnB;EACA,CAACC,WAAD,GAAe,IAAf;EACA,CAACC,eAAD,GAAmB,IAAnB;EACA,CAACC,OAAD,GAAW,IAAX;EACA,CAACC,kBAAD,GAAsB,EAAtB;EACA,CAACC,cAAD,GAAkB,KAAlB;EACA,CAACC,eAAD,GAAmB,IAAnB;EACA,CAAC9S,SAAD,GAAa,KAAb;EACA,CAAC+S,YAAD,GAAgB,KAAhB;EACA,CAACC,2BAAD,GAA+B,KAA/B;EACA,CAACC,gBAAD,GAAoB,IAApB;EACA,CAACC,SAAD,GAAa,CAAb;EACA,CAACC,SAAD,GAAa,CAAb;EACA,CAACC,iBAAD,GAAqB,IAArB;EACAC,YAAY,GAAG,IAAH;EACZC,eAAe,GAAG/sC,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAH;EACf81B,UAAU,GAAG,IAAH;EACVtd,UAAU,GAAG,IAAH;EACVU,mBAAmB,GAAG,IAAH;EACA,OAAZia,YAAY,GAAG,IAAH;EACA,OAAZ4C,YAAY,GAAG,IAAH;EACnB,CAACC,WAAD,GAAe,KAAf;EACA,CAAC1pB,MAAD,GAAUsoB,gBAAgB,CAACqB,OAAjB,EAAV;EACuB,OAAhBC,gBAAgB,GAAG,CAAC,CAAJ;EACH,OAAbC,aAAa,GAAG,IAAI1W,YAAJ,EAAH;EACN,OAAPwW,OAAO,GAAG,CAAH;EACU,OAAjBG,iBAAiB,GAAG,IAAH;;EACU,WAAvBC,uBAAuB,GAAG;IACnC,MAAMC,MAAM,GAAG1B,gBAAgB,CAACxrC,SAAjB,CAA2BmtC,mBAA1C;IACA,MAAM1S,KAAK,GAAG/5B,yBAAyB,CAACi5B,eAAxC;IACA,MAAMe,GAAG,GAAGh6B,yBAAyB,CAACk5B,aAAtC;IACA,OAAO32B,MAAM,CAAC,IAAD,EAAO,yBAAP,EAAkC,IAAIkyB,eAAJ,CAAoB,CAAC,CAAC,CAAC,WAAD,EAAc,eAAd,CAAD,EAAiC+X,MAAjC,EAAyC;MAC3G/W,IAAI,EAAE,CAAC,CAACsE,KAAF,EAAS,CAAT;IADqG,CAAzC,CAAD,EAE/D,CAAC,CAAC,gBAAD,EAAmB,qBAAnB,CAAD,EAA4CyS,MAA5C,EAAoD;MACtD/W,IAAI,EAAE,CAAC,CAACuE,GAAF,EAAO,CAAP;IADgD,CAApD,CAF+D,EAI/D,CAAC,CAAC,YAAD,EAAe,gBAAf,CAAD,EAAmCwS,MAAnC,EAA2C;MAC7C/W,IAAI,EAAE,CAACsE,KAAD,EAAQ,CAAR;IADuC,CAA3C,CAJ+D,EAM/D,CAAC,CAAC,iBAAD,EAAoB,sBAApB,CAAD,EAA8CyS,MAA9C,EAAsD;MACxD/W,IAAI,EAAE,CAACuE,GAAD,EAAM,CAAN;IADkD,CAAtD,CAN+D,EAQ/D,CAAC,CAAC,SAAD,EAAY,aAAZ,CAAD,EAA6BwS,MAA7B,EAAqC;MACvC/W,IAAI,EAAE,CAAC,CAAD,EAAI,CAACsE,KAAL;IADiC,CAArC,CAR+D,EAU/D,CAAC,CAAC,cAAD,EAAiB,mBAAjB,CAAD,EAAwCyS,MAAxC,EAAgD;MAClD/W,IAAI,EAAE,CAAC,CAAD,EAAI,CAACuE,GAAL;IAD4C,CAAhD,CAV+D,EAY/D,CAAC,CAAC,WAAD,EAAc,eAAd,CAAD,EAAiCwS,MAAjC,EAAyC;MAC3C/W,IAAI,EAAE,CAAC,CAAD,EAAIsE,KAAJ;IADqC,CAAzC,CAZ+D,EAc/D,CAAC,CAAC,gBAAD,EAAmB,qBAAnB,CAAD,EAA4CyS,MAA5C,EAAoD;MACtD/W,IAAI,EAAE,CAAC,CAAD,EAAIuE,GAAJ;IADgD,CAApD,CAd+D,EAgB/D,CAAC,CAAC,QAAD,EAAW,YAAX,CAAD,EAA2B8Q,gBAAgB,CAACxrC,SAAjB,CAA2BotC,yBAAtD,CAhB+D,CAApB,CAAlC,CAAb;EAiBD;;EACDx4B,WAAW,CAACy4B,UAAD,EAAa;IACtB,KAAK1b,MAAL,GAAc0b,UAAU,CAAC1b,MAAzB;IACA,KAAKrP,EAAL,GAAU+qB,UAAU,CAAC/qB,EAArB;IACA,KAAKjC,KAAL,GAAa,KAAKC,MAAL,GAAc,IAA3B;IACA,KAAKojB,SAAL,GAAiB2J,UAAU,CAAC1b,MAAX,CAAkB+R,SAAnC;IACA,KAAK/uB,IAAL,GAAY04B,UAAU,CAAC14B,IAAvB;IACA,KAAKgO,GAAL,GAAW,IAAX;IACA,KAAKyM,UAAL,GAAkBie,UAAU,CAAClc,SAA7B;IACA,KAAKiT,mBAAL,GAA2B,IAA3B;IACA,KAAKkJ,oBAAL,GAA4B,KAA5B;IACA,KAAKb,eAAL,CAAqBc,UAArB,GAAkCF,UAAU,CAACE,UAA7C;IACA,KAAKC,mBAAL,GAA2B,IAA3B;IACA,MAAM;MACJxkB,QADI;MAEJY,OAAO,EAAE;QACPC,SADO;QAEPC,UAFO;QAGPC,KAHO;QAIPC;MAJO;IAFL,IAQF,KAAK2H,MAAL,CAAY/D,QARhB;IASA,KAAK5E,QAAL,GAAgBA,QAAhB;IACA,KAAKykB,YAAL,GAAoB,CAAC,MAAMzkB,QAAN,GAAiB,KAAKoG,UAAL,CAAgB2M,cAAhB,CAA+B/S,QAAjD,IAA6D,GAAjF;IACA,KAAK0kB,cAAL,GAAsB,CAAC7jB,SAAD,EAAYC,UAAZ,CAAtB;IACA,KAAK6jB,eAAL,GAAuB,CAAC5jB,KAAD,EAAQC,KAAR,CAAvB;IACA,MAAM,CAAC3J,KAAD,EAAQC,MAAR,IAAkB,KAAKstB,gBAA7B;IACA,KAAKnyB,CAAL,GAAS4xB,UAAU,CAAC5xB,CAAX,GAAe4E,KAAxB;IACA,KAAK3E,CAAL,GAAS2xB,UAAU,CAAC3xB,CAAX,GAAe4E,MAAxB;IACA,KAAKutB,eAAL,GAAuB,KAAvB;IACA,KAAKjI,OAAL,GAAe,KAAf;EACD;;EACa,IAAVnV,UAAU,GAAG;IACf,OAAO/wB,MAAM,CAACouC,cAAP,CAAsB,IAAtB,EAA4Bl5B,WAA5B,CAAwCm5B,KAA/C;EACD;;EAC2B,WAAjBC,iBAAiB,GAAG;IAC7B,OAAO/qC,MAAM,CAAC,IAAD,EAAO,mBAAP,EAA4B,KAAK8pC,aAAL,CAAmBlW,UAAnB,CAA8B,YAA9B,CAA5B,CAAb;EACD;;EAC6B,OAAvBoX,uBAAuB,CAAC1f,MAAD,EAAS;IACrC,MAAM2f,UAAU,GAAG,IAAIC,UAAJ,CAAe;MAChC7rB,EAAE,EAAEiM,MAAM,CAACoD,MAAP,CAAcyc,SAAd,EAD4B;MAEhCzc,MAAM,EAAEpD,MAAM,CAACoD,MAFiB;MAGhCR,SAAS,EAAE5C,MAAM,CAACa;IAHc,CAAf,CAAnB;IAKA8e,UAAU,CAAC9J,mBAAX,GAAiC7V,MAAM,CAAC6V,mBAAxC;IACA8J,UAAU,CAACtI,OAAX,GAAqB,IAArB;;IACAsI,UAAU,CAAC9e,UAAX,CAAsB6Q,sBAAtB,CAA6CiO,UAA7C;EACD;;EACgB,OAAVlE,UAAU,CAACqE,IAAD,EAAOjf,UAAP,EAAmB1b,OAAnB,EAA4B;IAC3C83B,gBAAgB,CAACmB,YAAjB,KAAkCjtC,MAAM,CAACivB,MAAP,CAAc;MAC9CvE,OAAO,EAAE,+BADqC;MAE9CkkB,SAAS,EAAE,iCAFmC;MAG9CC,QAAQ,EAAE,gCAHoC;MAI9CC,WAAW,EAAE,mCAJiC;MAK9CnkB,WAAW,EAAE,mCALiC;MAM9CokB,YAAY,EAAE,oCANgC;MAO9CC,UAAU,EAAE,kCAPkC;MAQ9CC,UAAU,EAAE;IARkC,CAAd,CAAlC;IAUAnD,gBAAgB,CAACzB,YAAjB,KAAkC,IAAI9rB,GAAJ,CAAQ,CAAC,GAAG,CAAC,oCAAD,EAAuC,yCAAvC,EAAkF,0CAAlF,EAA8H,8CAA9H,EAA8K,gDAA9K,EAAgO,kDAAhO,EAAoRtH,GAApR,CAAwRP,GAAG,IAAI,CAACA,GAAD,EAAMi4B,IAAI,CAACxuC,GAAL,CAASuW,GAAT,CAAN,CAA/R,CAAJ,EAA0T,GAAG,CAAC,8DAAD,EAAiEO,GAAjE,CAAqEP,GAAG,IAAI,CAACA,GAAD,EAAMi4B,IAAI,CAACxuC,GAAL,CAASwlB,IAAT,CAAcgpB,IAAd,EAAoBj4B,GAApB,CAAN,CAA5E,CAA7T,CAAR,CAAlC;;IACA,IAAI1C,OAAO,EAAEk7B,OAAb,EAAsB;MACpB,KAAK,MAAMx4B,GAAX,IAAkB1C,OAAO,CAACk7B,OAA1B,EAAmC;QACjCpD,gBAAgB,CAACzB,YAAjB,CAA8B3lB,GAA9B,CAAkChO,GAAlC,EAAuCi4B,IAAI,CAACxuC,GAAL,CAASuW,GAAT,CAAvC;MACD;IACF;;IACD,IAAIo1B,gBAAgB,CAACsB,gBAAjB,KAAsC,CAAC,CAA3C,EAA8C;MAC5C;IACD;;IACD,MAAMlqB,KAAK,GAAGmE,gBAAgB,CAAC3E,QAAQ,CAACysB,eAAV,CAA9B;IACArD,gBAAgB,CAACsB,gBAAjB,GAAoCgC,UAAU,CAAClsB,KAAK,CAACoE,gBAAN,CAAuB,iBAAvB,CAAD,CAAV,IAAyD,CAA7F;EACD;;EACyB,OAAnB4d,mBAAmB,CAACmJ,KAAD,EAAQgB,MAAR,EAAgB,CAAE;;EACR,WAAzBxL,yBAAyB,GAAG;IACrC,OAAO,EAAP;EACD;;EAC8B,OAAxB3B,wBAAwB,CAACoN,IAAD,EAAO;IACpC,OAAO,KAAP;EACD;;EACW,OAAL5N,KAAK,CAACU,IAAD,EAAOnQ,MAAP,EAAe;IACzBze,WAAW,CAAC,iBAAD,CAAX;EACD;;EACqB,IAAlBgzB,kBAAkB,GAAG;IACvB,OAAO,EAAP;EACD;;EACe,IAAZ+I,YAAY,GAAG;IACjB,OAAO,KAAK,CAACrC,WAAb;EACD;;EACe,IAAZqC,YAAY,CAAC76B,KAAD,EAAQ;IACtB,KAAK,CAACw4B,WAAN,GAAoBx4B,KAApB;IACA,KAAKuO,GAAL,EAAUyN,SAAV,CAAoB+N,MAApB,CAA2B,WAA3B,EAAwC/pB,KAAxC;EACD;;EACiB,IAAd0mB,cAAc,GAAG;IACnB,OAAO,IAAP;EACD;;EACDoU,MAAM,GAAG;IACP,MAAM,CAACrlB,SAAD,EAAYC,UAAZ,IAA0B,KAAK4jB,cAArC;;IACA,QAAQ,KAAKyB,cAAb;MACE,KAAK,EAAL;QACE,KAAK1zB,CAAL,IAAU,KAAK6E,MAAL,GAAcwJ,UAAd,IAA4BD,SAAS,GAAG,CAAxC,CAAV;QACA,KAAKnO,CAAL,IAAU,KAAK2E,KAAL,GAAawJ,SAAb,IAA0BC,UAAU,GAAG,CAAvC,CAAV;QACA;;MACF,KAAK,GAAL;QACE,KAAKrO,CAAL,IAAU,KAAK4E,KAAL,GAAa,CAAvB;QACA,KAAK3E,CAAL,IAAU,KAAK4E,MAAL,GAAc,CAAxB;QACA;;MACF,KAAK,GAAL;QACE,KAAK7E,CAAL,IAAU,KAAK6E,MAAL,GAAcwJ,UAAd,IAA4BD,SAAS,GAAG,CAAxC,CAAV;QACA,KAAKnO,CAAL,IAAU,KAAK2E,KAAL,GAAawJ,SAAb,IAA0BC,UAAU,GAAG,CAAvC,CAAV;QACA;;MACF;QACE,KAAKrO,CAAL,IAAU,KAAK4E,KAAL,GAAa,CAAvB;QACA,KAAK3E,CAAL,IAAU,KAAK4E,MAAL,GAAc,CAAxB;QACA;IAhBJ;;IAkBA,KAAK8uB,iBAAL;EACD;;EACDvM,WAAW,CAAC6D,MAAD,EAAS;IAClB,KAAKtX,UAAL,CAAgByT,WAAhB,CAA4B6D,MAA5B;EACD;;EACe,IAAZ1H,YAAY,GAAG;IACjB,OAAO,KAAK5P,UAAL,CAAgB4P,YAAvB;EACD;;EACDqQ,eAAe,GAAG;IAChB,KAAK1sB,GAAL,CAASC,KAAT,CAAeM,MAAf,GAAwB,CAAxB;EACD;;EACDosB,eAAe,GAAG;IAChB,KAAK3sB,GAAL,CAASC,KAAT,CAAeM,MAAf,GAAwB,KAAK,CAACA,MAA9B;EACD;;EACDqsB,SAAS,CAAC5d,MAAD,EAAS;IAChB,IAAIA,MAAM,KAAK,IAAf,EAAqB;MACnB,KAAK+R,SAAL,GAAiB/R,MAAM,CAAC+R,SAAxB;MACA,KAAKgK,cAAL,GAAsB/b,MAAM,CAAC+b,cAA7B;IACD,CAHD,MAGO;MACL,KAAK,CAAC8B,YAAN;IACD;;IACD,KAAK7d,MAAL,GAAcA,MAAd;EACD;;EACD8d,OAAO,CAAC9Z,KAAD,EAAQ;IACb,IAAI,CAAC,KAAK7F,mBAAV,EAA+B;MAC7B;IACD;;IACD,IAAI,CAAC,KAAK,CAACkc,cAAX,EAA2B;MACzB,KAAKra,MAAL,CAAY0S,WAAZ,CAAwB,IAAxB;IACD,CAFD,MAEO;MACL,KAAK,CAAC2H,cAAN,GAAuB,KAAvB;IACD;EACF;;EACD0D,QAAQ,CAAC/Z,KAAD,EAAQ;IACd,IAAI,CAAC,KAAK7F,mBAAV,EAA+B;MAC7B;IACD;;IACD,IAAI,CAAC,KAAK+d,eAAV,EAA2B;MACzB;IACD;;IACD,MAAMvT,MAAM,GAAG3E,KAAK,CAACga,aAArB;;IACA,IAAIrV,MAAM,EAAEoF,OAAR,CAAiB,IAAG,KAAKpd,EAAG,EAA5B,CAAJ,EAAoC;MAClC;IACD;;IACDqT,KAAK,CAAC9J,cAAN;;IACA,IAAI,CAAC,KAAK8F,MAAL,EAAaie,mBAAlB,EAAuC;MACrC,KAAKtR,cAAL;IACD;EACF;;EACDA,cAAc,GAAG;IACf,IAAI,KAAKlF,OAAL,EAAJ,EAAoB;MAClB,KAAK5U,MAAL;IACD,CAFD,MAEO;MACL,KAAKmiB,MAAL;IACD;EACF;;EACDA,MAAM,GAAG;IACP,KAAK1G,sBAAL;EACD;;EACDA,sBAAsB,GAAG;IACvB,KAAK7Q,UAAL,CAAgB6Q,sBAAhB,CAAuC,IAAvC;EACD;;EACD4P,KAAK,CAACp0B,CAAD,EAAIC,CAAJ,EAAOmsB,EAAP,EAAWC,EAAX,EAAe;IAClB,MAAM,CAACznB,KAAD,EAAQC,MAAR,IAAkB,KAAKstB,gBAA7B;IACA,CAAC/F,EAAD,EAAKC,EAAL,IAAW,KAAKgI,uBAAL,CAA6BjI,EAA7B,EAAiCC,EAAjC,CAAX;IACA,KAAKrsB,CAAL,GAAS,CAACA,CAAC,GAAGosB,EAAL,IAAWxnB,KAApB;IACA,KAAK3E,CAAL,GAAS,CAACA,CAAC,GAAGosB,EAAL,IAAWxnB,MAApB;IACA,KAAK8uB,iBAAL;EACD;;EACD,CAACW,SAAS,CAAC,CAAC1vB,KAAD,EAAQC,MAAR,CAAD,EAAkB7E,CAAlB,EAAqBC,CAArB,EAAwB;IAChC,CAACD,CAAD,EAAIC,CAAJ,IAAS,KAAKo0B,uBAAL,CAA6Br0B,CAA7B,EAAgCC,CAAhC,CAAT;IACA,KAAKD,CAAL,IAAUA,CAAC,GAAG4E,KAAd;IACA,KAAK3E,CAAL,IAAUA,CAAC,GAAG4E,MAAd;IACA,KAAK8uB,iBAAL;EACD;;EACDW,SAAS,CAACt0B,CAAD,EAAIC,CAAJ,EAAO;IACd,KAAK,CAACq0B,SAAN,CAAgB,KAAKnC,gBAArB,EAAuCnyB,CAAvC,EAA0CC,CAA1C;EACD;;EACDsrB,eAAe,CAACvrB,CAAD,EAAIC,CAAJ,EAAO;IACpB,KAAK,CAACuwB,eAAN,KAA0B,CAAC,KAAKxwB,CAAN,EAAS,KAAKC,CAAd,CAA1B;IACA,KAAK,CAACq0B,SAAN,CAAgB,KAAKrC,cAArB,EAAqCjyB,CAArC,EAAwCC,CAAxC;IACA,KAAKiH,GAAL,CAASqtB,cAAT,CAAwB;MACtBC,KAAK,EAAE;IADe,CAAxB;EAGD;;EACDlI,IAAI,CAACF,EAAD,EAAKC,EAAL,EAAS;IACX,KAAK,CAACmE,eAAN,KAA0B,CAAC,KAAKxwB,CAAN,EAAS,KAAKC,CAAd,CAA1B;IACA,MAAM,CAACgtB,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,KAAKnyB,CAAL,IAAUosB,EAAE,GAAGa,WAAf;IACA,KAAKhtB,CAAL,IAAUosB,EAAE,GAAGa,YAAf;;IACA,IAAI,KAAKhX,MAAL,KAAgB,KAAKlW,CAAL,GAAS,CAAT,IAAc,KAAKA,CAAL,GAAS,CAAvB,IAA4B,KAAKC,CAAL,GAAS,CAArC,IAA0C,KAAKA,CAAL,GAAS,CAAnE,CAAJ,EAA2E;MACzE,MAAM;QACJD,CADI;QAEJC;MAFI,IAGF,KAAKiH,GAAL,CAASsb,qBAAT,EAHJ;;MAIA,IAAI,KAAKtM,MAAL,CAAYue,aAAZ,CAA0B,IAA1B,EAAgCz0B,CAAhC,EAAmCC,CAAnC,CAAJ,EAA2C;QACzC,KAAKD,CAAL,IAAU5F,IAAI,CAAC4I,KAAL,CAAW,KAAKhD,CAAhB,CAAV;QACA,KAAKC,CAAL,IAAU7F,IAAI,CAAC4I,KAAL,CAAW,KAAK/C,CAAhB,CAAV;MACD;IACF;;IACD,IAAI;MACFD,CADE;MAEFC;IAFE,IAGA,IAHJ;IAIA,MAAM,CAACy0B,EAAD,EAAKC,EAAL,IAAW,KAAKC,kBAAL,EAAjB;IACA50B,CAAC,IAAI00B,EAAL;IACAz0B,CAAC,IAAI00B,EAAL;IACA,KAAKztB,GAAL,CAASC,KAAT,CAAeK,IAAf,GAAuB,GAAE,CAAC,MAAMxH,CAAP,EAAU60B,OAAV,CAAkB,CAAlB,CAAqB,GAA9C;IACA,KAAK3tB,GAAL,CAASC,KAAT,CAAeI,GAAf,GAAsB,GAAE,CAAC,MAAMtH,CAAP,EAAU40B,OAAV,CAAkB,CAAlB,CAAqB,GAA7C;IACA,KAAK3tB,GAAL,CAASqtB,cAAT,CAAwB;MACtBC,KAAK,EAAE;IADe,CAAxB;EAGD;;EACgB,IAAbM,aAAa,GAAG;IAClB,OAAO,CAAC,CAAC,KAAK,CAACtE,eAAR,KAA4B,KAAK,CAACA,eAAN,CAAsB,CAAtB,MAA6B,KAAKxwB,CAAlC,IAAuC,KAAK,CAACwwB,eAAN,CAAsB,CAAtB,MAA6B,KAAKvwB,CAArG,CAAP;EACD;;EACD20B,kBAAkB,GAAG;IACnB,MAAM,CAAC3H,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,MAAM;MACJd;IADI,IAEFtB,gBAFJ;IAGA,MAAM/vB,CAAC,GAAGqxB,gBAAgB,GAAGpE,WAA7B;IACA,MAAMhtB,CAAC,GAAGoxB,gBAAgB,GAAGnE,YAA7B;;IACA,QAAQ,KAAK3f,QAAb;MACE,KAAK,EAAL;QACE,OAAO,CAAC,CAACvN,CAAF,EAAKC,CAAL,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAACD,CAAD,EAAIC,CAAJ,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAACD,CAAD,EAAI,CAACC,CAAL,CAAP;;MACF;QACE,OAAO,CAAC,CAACD,CAAF,EAAK,CAACC,CAAN,CAAP;IARJ;EAUD;;EACmB,IAAhB80B,gBAAgB,GAAG;IACrB,OAAO,IAAP;EACD;;EACDpB,iBAAiB,CAACpmB,QAAQ,GAAG,KAAKA,QAAjB,EAA2B;IAC1C,MAAM,CAACa,SAAD,EAAYC,UAAZ,IAA0B,KAAK4jB,cAArC;IACA,IAAI;MACFjyB,CADE;MAEFC,CAFE;MAGF2E,KAHE;MAIFC;IAJE,IAKA,IALJ;IAMAD,KAAK,IAAIwJ,SAAT;IACAvJ,MAAM,IAAIwJ,UAAV;IACArO,CAAC,IAAIoO,SAAL;IACAnO,CAAC,IAAIoO,UAAL;;IACA,IAAI,KAAK0mB,gBAAT,EAA2B;MACzB,QAAQxnB,QAAR;QACE,KAAK,CAAL;UACEvN,CAAC,GAAG5F,IAAI,CAAC2D,GAAL,CAAS,CAAT,EAAY3D,IAAI,CAACC,GAAL,CAAS+T,SAAS,GAAGxJ,KAArB,EAA4B5E,CAA5B,CAAZ,CAAJ;UACAC,CAAC,GAAG7F,IAAI,CAAC2D,GAAL,CAAS,CAAT,EAAY3D,IAAI,CAACC,GAAL,CAASgU,UAAU,GAAGxJ,MAAtB,EAA8B5E,CAA9B,CAAZ,CAAJ;UACA;;QACF,KAAK,EAAL;UACED,CAAC,GAAG5F,IAAI,CAAC2D,GAAL,CAAS,CAAT,EAAY3D,IAAI,CAACC,GAAL,CAAS+T,SAAS,GAAGvJ,MAArB,EAA6B7E,CAA7B,CAAZ,CAAJ;UACAC,CAAC,GAAG7F,IAAI,CAACC,GAAL,CAASgU,UAAT,EAAqBjU,IAAI,CAAC2D,GAAL,CAAS6G,KAAT,EAAgB3E,CAAhB,CAArB,CAAJ;UACA;;QACF,KAAK,GAAL;UACED,CAAC,GAAG5F,IAAI,CAACC,GAAL,CAAS+T,SAAT,EAAoBhU,IAAI,CAAC2D,GAAL,CAAS6G,KAAT,EAAgB5E,CAAhB,CAApB,CAAJ;UACAC,CAAC,GAAG7F,IAAI,CAACC,GAAL,CAASgU,UAAT,EAAqBjU,IAAI,CAAC2D,GAAL,CAAS8G,MAAT,EAAiB5E,CAAjB,CAArB,CAAJ;UACA;;QACF,KAAK,GAAL;UACED,CAAC,GAAG5F,IAAI,CAACC,GAAL,CAAS+T,SAAT,EAAoBhU,IAAI,CAAC2D,GAAL,CAAS8G,MAAT,EAAiB7E,CAAjB,CAApB,CAAJ;UACAC,CAAC,GAAG7F,IAAI,CAAC2D,GAAL,CAAS,CAAT,EAAY3D,IAAI,CAACC,GAAL,CAASgU,UAAU,GAAGzJ,KAAtB,EAA6B3E,CAA7B,CAAZ,CAAJ;UACA;MAhBJ;IAkBD;;IACD,KAAKD,CAAL,GAASA,CAAC,IAAIoO,SAAd;IACA,KAAKnO,CAAL,GAASA,CAAC,IAAIoO,UAAd;IACA,MAAM,CAACqmB,EAAD,EAAKC,EAAL,IAAW,KAAKC,kBAAL,EAAjB;IACA50B,CAAC,IAAI00B,EAAL;IACAz0B,CAAC,IAAI00B,EAAL;IACA,MAAM;MACJxtB;IADI,IAEF,KAAKD,GAFT;IAGAC,KAAK,CAACK,IAAN,GAAc,GAAE,CAAC,MAAMxH,CAAP,EAAU60B,OAAV,CAAkB,CAAlB,CAAqB,GAArC;IACA1tB,KAAK,CAACI,GAAN,GAAa,GAAE,CAAC,MAAMtH,CAAP,EAAU40B,OAAV,CAAkB,CAAlB,CAAqB,GAApC;IACA,KAAKG,SAAL;EACD;;EACkB,OAAZ,CAACC,WAAW,CAACj1B,CAAD,EAAIC,CAAJ,EAAOi1B,KAAP,EAAc;IAC/B,QAAQA,KAAR;MACE,KAAK,EAAL;QACE,OAAO,CAACj1B,CAAD,EAAI,CAACD,CAAL,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAAC,CAACA,CAAF,EAAK,CAACC,CAAN,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAAC,CAACA,CAAF,EAAKD,CAAL,CAAP;;MACF;QACE,OAAO,CAACA,CAAD,EAAIC,CAAJ,CAAP;IARJ;EAUD;;EACDo0B,uBAAuB,CAACr0B,CAAD,EAAIC,CAAJ,EAAO;IAC5B,OAAO8vB,gBAAgB,CAAC,CAACkF,WAAlB,CAA8Bj1B,CAA9B,EAAiCC,CAAjC,EAAoC,KAAKyzB,cAAzC,CAAP;EACD;;EACDyB,uBAAuB,CAACn1B,CAAD,EAAIC,CAAJ,EAAO;IAC5B,OAAO8vB,gBAAgB,CAAC,CAACkF,WAAlB,CAA8Bj1B,CAA9B,EAAiCC,CAAjC,EAAoC,MAAM,KAAKyzB,cAA/C,CAAP;EACD;;EACD,CAAC0B,iBAAiB,CAAC7nB,QAAD,EAAW;IAC3B,QAAQA,QAAR;MACE,KAAK,EAAL;QACE;UACE,MAAM,CAACa,SAAD,EAAYC,UAAZ,IAA0B,KAAK4jB,cAArC;UACA,OAAO,CAAC,CAAD,EAAI,CAAC7jB,SAAD,GAAaC,UAAjB,EAA6BA,UAAU,GAAGD,SAA1C,EAAqD,CAArD,CAAP;QACD;;MACH,KAAK,GAAL;QACE,OAAO,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAC,CAAZ,CAAP;;MACF,KAAK,GAAL;QACE;UACE,MAAM,CAACA,SAAD,EAAYC,UAAZ,IAA0B,KAAK4jB,cAArC;UACA,OAAO,CAAC,CAAD,EAAI7jB,SAAS,GAAGC,UAAhB,EAA4B,CAACA,UAAD,GAAcD,SAA1C,EAAqD,CAArD,CAAP;QACD;;MACH;QACE,OAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAP;IAdJ;EAgBD;;EACc,IAAXinB,WAAW,GAAG;IAChB,OAAO,KAAK1hB,UAAL,CAAgB2M,cAAhB,CAA+BC,SAAtC;EACD;;EACiB,IAAdmT,cAAc,GAAG;IACnB,OAAO,CAAC,KAAK/f,UAAL,CAAgB2M,cAAhB,CAA+B/S,QAA/B,GAA0C,KAAKykB,YAAhD,IAAgE,GAAvE;EACD;;EACmB,IAAhBG,gBAAgB,GAAG;IACrB,MAAM;MACJkD,WADI;MAEJpD,cAAc,EAAE,CAAC7jB,SAAD,EAAYC,UAAZ;IAFZ,IAGF,IAHJ;IAIA,MAAMinB,WAAW,GAAGlnB,SAAS,GAAGinB,WAAhC;IACA,MAAME,YAAY,GAAGlnB,UAAU,GAAGgnB,WAAlC;IACA,OAAO5vC,gBAAgB,CAACwW,mBAAjB,GAAuC,CAAC7B,IAAI,CAAC0P,KAAL,CAAWwrB,WAAX,CAAD,EAA0Bl7B,IAAI,CAAC0P,KAAL,CAAWyrB,YAAX,CAA1B,CAAvC,GAA6F,CAACD,WAAD,EAAcC,YAAd,CAApG;EACD;;EACDC,OAAO,CAAC5wB,KAAD,EAAQC,MAAR,EAAgB;IACrB,MAAM,CAACooB,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,KAAKjrB,GAAL,CAASC,KAAT,CAAevC,KAAf,GAAwB,GAAE,CAAC,MAAMA,KAAN,GAAcqoB,WAAf,EAA4B4H,OAA5B,CAAoC,CAApC,CAAuC,GAAjE;;IACA,IAAI,CAAC,KAAK,CAAC3E,eAAX,EAA4B;MAC1B,KAAKhpB,GAAL,CAASC,KAAT,CAAetC,MAAf,GAAyB,GAAE,CAAC,MAAMA,MAAN,GAAeqoB,YAAhB,EAA8B2H,OAA9B,CAAsC,CAAtC,CAAyC,GAApE;IACD;EACF;;EACDY,OAAO,GAAG;IACR,MAAM;MACJtuB;IADI,IAEF,KAAKD,GAFT;IAGA,MAAM;MACJrC,MADI;MAEJD;IAFI,IAGFuC,KAHJ;IAIA,MAAMuuB,YAAY,GAAG9wB,KAAK,CAAC+wB,QAAN,CAAe,GAAf,CAArB;IACA,MAAMC,aAAa,GAAG,CAAC,KAAK,CAAC1F,eAAP,IAA0BrrB,MAAM,CAAC8wB,QAAP,CAAgB,GAAhB,CAAhD;;IACA,IAAID,YAAY,IAAIE,aAApB,EAAmC;MACjC;IACD;;IACD,MAAM,CAAC3I,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;;IACA,IAAI,CAACuD,YAAL,EAAmB;MACjBvuB,KAAK,CAACvC,KAAN,GAAe,GAAE,CAAC,MAAMyuB,UAAU,CAACzuB,KAAD,CAAhB,GAA0BqoB,WAA3B,EAAwC4H,OAAxC,CAAgD,CAAhD,CAAmD,GAApE;IACD;;IACD,IAAI,CAAC,KAAK,CAAC3E,eAAP,IAA0B,CAAC0F,aAA/B,EAA8C;MAC5CzuB,KAAK,CAACtC,MAAN,GAAgB,GAAE,CAAC,MAAMwuB,UAAU,CAACxuB,MAAD,CAAhB,GAA2BqoB,YAA5B,EAA0C2H,OAA1C,CAAkD,CAAlD,CAAqD,GAAvE;IACD;EACF;;EACDgB,qBAAqB,GAAG;IACtB,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;EACD;;EACD,CAACC,cAAc,GAAG;IAChB,IAAI,KAAK,CAAC3F,WAAV,EAAuB;MACrB;IACD;;IACD,KAAK,CAACA,WAAN,GAAoBxpB,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAApB;IACA,KAAK,CAACgqB,WAAN,CAAkBxb,SAAlB,CAA4BC,GAA5B,CAAgC,UAAhC;IACA,MAAMmhB,OAAO,GAAG,KAAKlE,oBAAL,GAA4B,CAAC,SAAD,EAAY,UAAZ,EAAwB,aAAxB,EAAuC,YAAvC,CAA5B,GAAmF,CAAC,SAAD,EAAY,WAAZ,EAAyB,UAAzB,EAAqC,aAArC,EAAoD,aAApD,EAAmE,cAAnE,EAAmF,YAAnF,EAAiG,YAAjG,CAAnG;IACA,MAAMne,MAAM,GAAG,KAAKC,UAAL,CAAgBC,OAA/B;;IACA,KAAK,MAAM1a,IAAX,IAAmB68B,OAAnB,EAA4B;MAC1B,MAAM7uB,GAAG,GAAGP,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAZ;MACA,KAAK,CAACgqB,WAAN,CAAkBxoB,MAAlB,CAAyBT,GAAzB;MACAA,GAAG,CAACyN,SAAJ,CAAcC,GAAd,CAAkB,SAAlB,EAA6B1b,IAA7B;MACAgO,GAAG,CAAChB,YAAJ,CAAiB,mBAAjB,EAAsChN,IAAtC;MACAgO,GAAG,CAAC2M,gBAAJ,CAAqB,aAArB,EAAoC,KAAK,CAACmiB,kBAAN,CAAyBpsB,IAAzB,CAA8B,IAA9B,EAAoC1Q,IAApC,CAApC,EAA+E;QAC7Ewa;MAD6E,CAA/E;MAGAxM,GAAG,CAAC2M,gBAAJ,CAAqB,aAArB,EAAoCxsB,aAApC,EAAmD;QACjDqsB;MADiD,CAAnD;MAGAxM,GAAG,CAACgO,QAAJ,GAAe,CAAC,CAAhB;IACD;;IACD,KAAKhO,GAAL,CAASoO,OAAT,CAAiB,KAAK,CAAC6a,WAAvB;EACD;;EACD,CAAC6F,kBAAkB,CAAC98B,IAAD,EAAOghB,KAAP,EAAc;IAC/BA,KAAK,CAAC9J,cAAN;IACA,MAAM;MACJrU;IADI,IAEFtW,gBAAgB,CAACoW,QAFrB;;IAGA,IAAIqe,KAAK,CAACjF,MAAN,KAAiB,CAAjB,IAAsBiF,KAAK,CAACE,OAAN,IAAiBre,KAA3C,EAAkD;MAChD;IACD;;IACD,KAAK,CAACiX,OAAN,EAAe0P,MAAf,CAAsB,KAAtB;IACA,MAAMuT,cAAc,GAAG,KAAKzC,YAA5B;IACA,KAAKA,YAAL,GAAoB,KAApB;IACA,MAAM1S,EAAE,GAAG,IAAIxF,eAAJ,EAAX;;IACA,MAAM5H,MAAM,GAAG,KAAKC,UAAL,CAAgBkN,cAAhB,CAA+BC,EAA/B,CAAf;;IACA,KAAK5K,MAAL,CAAYggB,mBAAZ,CAAgC,KAAhC;IACAtkB,MAAM,CAACiC,gBAAP,CAAwB,aAAxB,EAAuC,KAAK,CAACsiB,kBAAN,CAAyBvsB,IAAzB,CAA8B,IAA9B,EAAoC1Q,IAApC,CAAvC,EAAkF;MAChFk9B,OAAO,EAAE,IADuE;MAEhF3hB,OAAO,EAAE,IAFuE;MAGhFf;IAHgF,CAAlF;IAKA9B,MAAM,CAACiC,gBAAP,CAAwB,aAAxB,EAAuCxsB,aAAvC,EAAsD;MACpDqsB;IADoD,CAAtD;IAGA,MAAM+X,MAAM,GAAG,KAAKzrB,CAApB;IACA,MAAM0rB,MAAM,GAAG,KAAKzrB,CAApB;IACA,MAAMo2B,UAAU,GAAG,KAAKzxB,KAAxB;IACA,MAAM0xB,WAAW,GAAG,KAAKzxB,MAAzB;IACA,MAAM0xB,iBAAiB,GAAG,KAAKrgB,MAAL,CAAYhP,GAAZ,CAAgBC,KAAhB,CAAsBqvB,MAAhD;IACA,MAAMC,WAAW,GAAG,KAAKvvB,GAAL,CAASC,KAAT,CAAeqvB,MAAnC;IACA,KAAKtvB,GAAL,CAASC,KAAT,CAAeqvB,MAAf,GAAwB,KAAKtgB,MAAL,CAAYhP,GAAZ,CAAgBC,KAAhB,CAAsBqvB,MAAtB,GAA+B5kB,MAAM,CAACtG,gBAAP,CAAwB4O,KAAK,CAAC2E,MAA9B,EAAsC2X,MAA7F;;IACA,MAAME,iBAAiB,GAAG,MAAM;MAC9B5V,EAAE,CAACL,KAAH;MACA,KAAKvK,MAAL,CAAYggB,mBAAZ,CAAgC,IAAhC;MACA,KAAK,CAACljB,OAAN,EAAe0P,MAAf,CAAsB,IAAtB;MACA,KAAK8Q,YAAL,GAAoByC,cAApB;MACA,KAAK/f,MAAL,CAAYhP,GAAZ,CAAgBC,KAAhB,CAAsBqvB,MAAtB,GAA+BD,iBAA/B;MACA,KAAKrvB,GAAL,CAASC,KAAT,CAAeqvB,MAAf,GAAwBC,WAAxB;MACA,KAAK,CAACE,oBAAN,CAA2BlL,MAA3B,EAAmCC,MAAnC,EAA2C2K,UAA3C,EAAuDC,WAAvD;IACD,CARD;;IASA1kB,MAAM,CAACiC,gBAAP,CAAwB,WAAxB,EAAqC6iB,iBAArC,EAAwD;MACtDhjB;IADsD,CAAxD;IAGA9B,MAAM,CAACiC,gBAAP,CAAwB,MAAxB,EAAgC6iB,iBAAhC,EAAmD;MACjDhjB;IADiD,CAAnD;EAGD;;EACD,CAACijB,oBAAoB,CAAClL,MAAD,EAASC,MAAT,EAAiB2K,UAAjB,EAA6BC,WAA7B,EAA0C;IAC7D,MAAM1K,IAAI,GAAG,KAAK5rB,CAAlB;IACA,MAAM6rB,IAAI,GAAG,KAAK5rB,CAAlB;IACA,MAAM22B,QAAQ,GAAG,KAAKhyB,KAAtB;IACA,MAAMiyB,SAAS,GAAG,KAAKhyB,MAAvB;;IACA,IAAI+mB,IAAI,KAAKH,MAAT,IAAmBI,IAAI,KAAKH,MAA5B,IAAsCkL,QAAQ,KAAKP,UAAnD,IAAiEQ,SAAS,KAAKP,WAAnF,EAAgG;MAC9F;IACD;;IACD,KAAKlP,WAAL,CAAiB;MACftO,GAAG,EAAE,MAAM;QACT,KAAKlU,KAAL,GAAagyB,QAAb;QACA,KAAK/xB,MAAL,GAAcgyB,SAAd;QACA,KAAK72B,CAAL,GAAS4rB,IAAT;QACA,KAAK3rB,CAAL,GAAS4rB,IAAT;QACA,MAAM,CAACoB,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;QACA,KAAKqD,OAAL,CAAavI,WAAW,GAAG2J,QAA3B,EAAqC1J,YAAY,GAAG2J,SAApD;QACA,KAAKlD,iBAAL;MACD,CATc;MAUf5a,IAAI,EAAE,MAAM;QACV,KAAKnU,KAAL,GAAayxB,UAAb;QACA,KAAKxxB,MAAL,GAAcyxB,WAAd;QACA,KAAKt2B,CAAL,GAASyrB,MAAT;QACA,KAAKxrB,CAAL,GAASyrB,MAAT;QACA,MAAM,CAACuB,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;QACA,KAAKqD,OAAL,CAAavI,WAAW,GAAGoJ,UAA3B,EAAuCnJ,YAAY,GAAGoJ,WAAtD;QACA,KAAK3C,iBAAL;MACD,CAlBc;MAmBf1a,QAAQ,EAAE;IAnBK,CAAjB;EAqBD;;EACD,CAACkd,kBAAkB,CAACj9B,IAAD,EAAOghB,KAAP,EAAc;IAC/B,MAAM,CAAC+S,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,MAAM1G,MAAM,GAAG,KAAKzrB,CAApB;IACA,MAAM0rB,MAAM,GAAG,KAAKzrB,CAApB;IACA,MAAMo2B,UAAU,GAAG,KAAKzxB,KAAxB;IACA,MAAM0xB,WAAW,GAAG,KAAKzxB,MAAzB;IACA,MAAMiyB,QAAQ,GAAG/G,gBAAgB,CAACgH,QAAjB,GAA4B9J,WAA7C;IACA,MAAM+J,SAAS,GAAGjH,gBAAgB,CAACgH,QAAjB,GAA4B7J,YAA9C;;IACA,MAAMpjB,KAAK,GAAG9J,CAAC,IAAI5F,IAAI,CAAC0P,KAAL,CAAW9J,CAAC,GAAG,KAAf,IAAwB,KAA3C;;IACA,MAAMi3B,cAAc,GAAG,KAAK,CAAC7B,iBAAN,CAAwB,KAAK7nB,QAA7B,CAAvB;;IACA,MAAM2pB,MAAM,GAAG,CAACl3B,CAAD,EAAIC,CAAJ,KAAU,CAACg3B,cAAc,CAAC,CAAD,CAAd,GAAoBj3B,CAApB,GAAwBi3B,cAAc,CAAC,CAAD,CAAd,GAAoBh3B,CAA7C,EAAgDg3B,cAAc,CAAC,CAAD,CAAd,GAAoBj3B,CAApB,GAAwBi3B,cAAc,CAAC,CAAD,CAAd,GAAoBh3B,CAA5F,CAAzB;;IACA,MAAMk3B,iBAAiB,GAAG,KAAK,CAAC/B,iBAAN,CAAwB,MAAM,KAAK7nB,QAAnC,CAA1B;;IACA,MAAM6pB,SAAS,GAAG,CAACp3B,CAAD,EAAIC,CAAJ,KAAU,CAACk3B,iBAAiB,CAAC,CAAD,CAAjB,GAAuBn3B,CAAvB,GAA2Bm3B,iBAAiB,CAAC,CAAD,CAAjB,GAAuBl3B,CAAnD,EAAsDk3B,iBAAiB,CAAC,CAAD,CAAjB,GAAuBn3B,CAAvB,GAA2Bm3B,iBAAiB,CAAC,CAAD,CAAjB,GAAuBl3B,CAAxG,CAA5B;;IACA,IAAIo3B,QAAJ;IACA,IAAIC,WAAJ;IACA,IAAIC,UAAU,GAAG,KAAjB;IACA,IAAIC,YAAY,GAAG,KAAnB;;IACA,QAAQt+B,IAAR;MACE,KAAK,SAAL;QACEq+B,UAAU,GAAG,IAAb;;QACAF,QAAQ,GAAG,CAAC9kB,CAAD,EAAIC,CAAJ,KAAU,CAAC,CAAD,EAAI,CAAJ,CAArB;;QACA8kB,WAAW,GAAG,CAAC/kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAD,EAAIC,CAAJ,CAAxB;;QACA;;MACF,KAAK,WAAL;QACE6kB,QAAQ,GAAG,CAAC9kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAC,GAAG,CAAL,EAAQ,CAAR,CAArB;;QACA+kB,WAAW,GAAG,CAAC/kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAC,GAAG,CAAL,EAAQC,CAAR,CAAxB;;QACA;;MACF,KAAK,UAAL;QACE+kB,UAAU,GAAG,IAAb;;QACAF,QAAQ,GAAG,CAAC9kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAD,EAAI,CAAJ,CAArB;;QACA+kB,WAAW,GAAG,CAAC/kB,CAAD,EAAIC,CAAJ,KAAU,CAAC,CAAD,EAAIA,CAAJ,CAAxB;;QACA;;MACF,KAAK,aAAL;QACEglB,YAAY,GAAG,IAAf;;QACAH,QAAQ,GAAG,CAAC9kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAD,EAAIC,CAAC,GAAG,CAAR,CAArB;;QACA8kB,WAAW,GAAG,CAAC/kB,CAAD,EAAIC,CAAJ,KAAU,CAAC,CAAD,EAAIA,CAAC,GAAG,CAAR,CAAxB;;QACA;;MACF,KAAK,aAAL;QACE+kB,UAAU,GAAG,IAAb;;QACAF,QAAQ,GAAG,CAAC9kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAD,EAAIC,CAAJ,CAArB;;QACA8kB,WAAW,GAAG,CAAC/kB,CAAD,EAAIC,CAAJ,KAAU,CAAC,CAAD,EAAI,CAAJ,CAAxB;;QACA;;MACF,KAAK,cAAL;QACE6kB,QAAQ,GAAG,CAAC9kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAC,GAAG,CAAL,EAAQC,CAAR,CAArB;;QACA8kB,WAAW,GAAG,CAAC/kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAC,GAAG,CAAL,EAAQ,CAAR,CAAxB;;QACA;;MACF,KAAK,YAAL;QACEglB,UAAU,GAAG,IAAb;;QACAF,QAAQ,GAAG,CAAC9kB,CAAD,EAAIC,CAAJ,KAAU,CAAC,CAAD,EAAIA,CAAJ,CAArB;;QACA8kB,WAAW,GAAG,CAAC/kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAD,EAAI,CAAJ,CAAxB;;QACA;;MACF,KAAK,YAAL;QACEilB,YAAY,GAAG,IAAf;;QACAH,QAAQ,GAAG,CAAC9kB,CAAD,EAAIC,CAAJ,KAAU,CAAC,CAAD,EAAIA,CAAC,GAAG,CAAR,CAArB;;QACA8kB,WAAW,GAAG,CAAC/kB,CAAD,EAAIC,CAAJ,KAAU,CAACD,CAAD,EAAIC,CAAC,GAAG,CAAR,CAAxB;;QACA;IAtCJ;;IAwCA,MAAMilB,KAAK,GAAGJ,QAAQ,CAAChB,UAAD,EAAaC,WAAb,CAAtB;IACA,MAAMoB,aAAa,GAAGJ,WAAW,CAACjB,UAAD,EAAaC,WAAb,CAAjC;IACA,IAAIqB,mBAAmB,GAAGT,MAAM,CAAC,GAAGQ,aAAJ,CAAhC;IACA,MAAME,SAAS,GAAG9tB,KAAK,CAAC2hB,MAAM,GAAGkM,mBAAmB,CAAC,CAAD,CAA7B,CAAvB;IACA,MAAME,SAAS,GAAG/tB,KAAK,CAAC4hB,MAAM,GAAGiM,mBAAmB,CAAC,CAAD,CAA7B,CAAvB;IACA,IAAIG,MAAM,GAAG,CAAb;IACA,IAAIC,MAAM,GAAG,CAAb;IACA,IAAI,CAACC,MAAD,EAASC,MAAT,IAAmB,KAAK5D,uBAAL,CAA6Bna,KAAK,CAACge,SAAnC,EAA8Che,KAAK,CAACie,SAApD,CAAvB;IACA,CAACH,MAAD,EAASC,MAAT,IAAmBb,SAAS,CAACY,MAAM,GAAG/K,WAAV,EAAuBgL,MAAM,GAAG/K,YAAhC,CAA5B;;IACA,IAAIqK,UAAJ,EAAgB;MACd,MAAMa,OAAO,GAAGh+B,IAAI,CAACi+B,KAAL,CAAWhC,UAAX,EAAuBC,WAAvB,CAAhB;MACAwB,MAAM,GAAGC,MAAM,GAAG39B,IAAI,CAAC2D,GAAL,CAAS3D,IAAI,CAACC,GAAL,CAASD,IAAI,CAACi+B,KAAL,CAAWX,aAAa,CAAC,CAAD,CAAb,GAAmBD,KAAK,CAAC,CAAD,CAAxB,GAA8BO,MAAzC,EAAiDN,aAAa,CAAC,CAAD,CAAb,GAAmBD,KAAK,CAAC,CAAD,CAAxB,GAA8BQ,MAA/E,IAAyFG,OAAlG,EAA2G,IAAI/B,UAA/G,EAA2H,IAAIC,WAA/H,CAAT,EAAsJQ,QAAQ,GAAGT,UAAjK,EAA6KW,SAAS,GAAGV,WAAzL,CAAlB;IACD,CAHD,MAGO,IAAIkB,YAAJ,EAAkB;MACvBM,MAAM,GAAG19B,IAAI,CAAC2D,GAAL,CAAS+4B,QAAT,EAAmB18B,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYD,IAAI,CAAC+F,GAAL,CAASu3B,aAAa,CAAC,CAAD,CAAb,GAAmBD,KAAK,CAAC,CAAD,CAAxB,GAA8BO,MAAvC,CAAZ,CAAnB,IAAkF3B,UAA3F;IACD,CAFM,MAEA;MACL0B,MAAM,GAAG39B,IAAI,CAAC2D,GAAL,CAASi5B,SAAT,EAAoB58B,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYD,IAAI,CAAC+F,GAAL,CAASu3B,aAAa,CAAC,CAAD,CAAb,GAAmBD,KAAK,CAAC,CAAD,CAAxB,GAA8BQ,MAAvC,CAAZ,CAApB,IAAmF3B,WAA5F;IACD;;IACD,MAAMM,QAAQ,GAAG9sB,KAAK,CAACusB,UAAU,GAAGyB,MAAd,CAAtB;IACA,MAAMjB,SAAS,GAAG/sB,KAAK,CAACwsB,WAAW,GAAGyB,MAAf,CAAvB;IACAJ,mBAAmB,GAAGT,MAAM,CAAC,GAAGI,WAAW,CAACV,QAAD,EAAWC,SAAX,CAAf,CAA5B;IACA,MAAMjL,IAAI,GAAGgM,SAAS,GAAGD,mBAAmB,CAAC,CAAD,CAA5C;IACA,MAAM9L,IAAI,GAAGgM,SAAS,GAAGF,mBAAmB,CAAC,CAAD,CAA5C;IACA,KAAK/yB,KAAL,GAAagyB,QAAb;IACA,KAAK/xB,MAAL,GAAcgyB,SAAd;IACA,KAAK72B,CAAL,GAAS4rB,IAAT;IACA,KAAK3rB,CAAL,GAAS4rB,IAAT;IACA,KAAK2J,OAAL,CAAavI,WAAW,GAAG2J,QAA3B,EAAqC1J,YAAY,GAAG2J,SAApD;IACA,KAAKlD,iBAAL;EACD;;EACD2E,aAAa,GAAG;IACd,KAAK,CAACtlB,OAAN,EAAe8b,MAAf;EACD;;EACKyJ,cAAc,GAAG;IAAA;;IAAA;MACrB,IAAI,OAAI,CAACxH,YAAL,IAAqB,OAAI,CAAC,CAACN,YAA/B,EAA6C;QAC3C,OAAO,OAAI,CAACM,YAAZ;MACD;;MACD,OAAI,CAACA,YAAL,GAAoB,IAAIpe,aAAJ,CAAkB,OAAlB,CAApB;;MACA,OAAI,CAACzL,GAAL,CAASS,MAAT,CAAgB,OAAI,CAACopB,YAAL,CAAkBxd,MAAlB,EAAhB;;MACA,IAAI,OAAI,CAAC,CAACP,OAAV,EAAmB;QACjB,MAAM,OAAI,CAAC+d,YAAL,CAAkB1b,UAAlB,CAA6B,OAAI,CAAC,CAACrC,OAAnC,CAAN;MACD;;MACD,OAAO,OAAI,CAAC+d,YAAZ;IATqB;EAUtB;;EACDyH,iBAAiB,GAAG;IAClB,IAAI,CAAC,KAAKzH,YAAV,EAAwB;MACtB;IACD;;IACD,KAAKA,YAAL,CAAkBhoB,MAAlB;;IACA,KAAKgoB,YAAL,GAAoB,IAApB;IACA,KAAK,CAAC/d,OAAN,EAAexO,OAAf;EACD;;EACDi0B,mBAAmB,GAAG;IACpB,OAAO,KAAKvxB,GAAL,CAASsb,qBAAT,EAAP;EACD;;EACKkW,gBAAgB,GAAG;IAAA;;IAAA;MACvB,IAAI,OAAI,CAAC,CAAC1lB,OAAV,EAAmB;QACjB;MACD;;MACD6a,OAAO,CAACU,UAAR,CAAmBwB,gBAAgB,CAACzB,YAApC;MACA,OAAI,CAAC,CAACtb,OAAN,GAAgB,IAAI6a,OAAJ,CAAY,OAAZ,CAAhB;;MACA,IAAI,OAAI,CAAC,CAACmC,iBAAV,EAA6B;QAC3B,OAAI,CAAC,CAAChd,OAAN,CAAchG,IAAd,GAAqB,OAAI,CAAC,CAACgjB,iBAA3B;QACA,OAAI,CAAC,CAACA,iBAAN,GAA0B,IAA1B;MACD;;MACD,MAAM,OAAI,CAACuI,cAAL,EAAN;IAVuB;EAWxB;;EACc,IAAXI,WAAW,GAAG;IAChB,OAAO,KAAK,CAAC3lB,OAAN,EAAehG,IAAtB;EACD;;EACc,IAAX2rB,WAAW,CAAC3rB,IAAD,EAAO;IACpB,IAAI,CAAC,KAAK,CAACgG,OAAX,EAAoB;MAClB;IACD;;IACD,KAAK,CAACA,OAAN,CAAchG,IAAd,GAAqBA,IAArB;EACD;;EACiB,IAAd4rB,cAAc,GAAG;IACnB,OAAO,KAAK,CAAC5lB,OAAN,EAAeob,WAAtB;EACD;;EACKyK,iBAAiB,CAAC5sB,IAAD,EAAO;IAAA;;IAAA;MAC5B,MAAM,OAAI,CAAC,CAAC+G,OAAN,EAAeic,cAAf,CAA8BhjB,IAA9B,CAAN;IAD4B;EAE7B;;EACD6sB,gBAAgB,CAAC1J,YAAD,EAAe;IAC7B,OAAO,KAAK,CAACpc,OAAN,EAAeiH,SAAf,CAAyBmV,YAAzB,CAAP;EACD;;EACD2J,UAAU,GAAG;IACX,OAAO,CAAC,CAAC,KAAK,CAAC/lB,OAAR,IAAmB,CAAC,KAAK,CAACA,OAAN,CAAc2K,OAAd,EAA3B;EACD;;EACDqb,cAAc,GAAG;IACf,OAAO,KAAK,CAAChmB,OAAN,EAAegc,OAAf,MAA4B,KAAnC;EACD;;EACDzb,MAAM,GAAG;IACP,KAAKrM,GAAL,GAAWP,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAX;IACA,KAAKe,GAAL,CAAShB,YAAT,CAAsB,sBAAtB,EAA8C,CAAC,MAAM,KAAKqH,QAAZ,IAAwB,GAAtE;IACA,KAAKrG,GAAL,CAASuM,SAAT,GAAqB,KAAKva,IAA1B;IACA,KAAKgO,GAAL,CAAShB,YAAT,CAAsB,IAAtB,EAA4B,KAAKW,EAAjC;IACA,KAAKK,GAAL,CAASgO,QAAT,GAAoB,KAAK,CAACsa,QAAN,GAAiB,CAAC,CAAlB,GAAsB,CAA1C;;IACA,IAAI,CAAC,KAAKyB,UAAV,EAAsB;MACpB,KAAK/pB,GAAL,CAASyN,SAAT,CAAmBC,GAAnB,CAAuB,QAAvB;IACD;;IACD,KAAKif,eAAL;IACA,KAAK,CAACoF,iBAAN;IACA,MAAM,CAAChM,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;;IACA,IAAI,KAAKuB,cAAL,GAAsB,GAAtB,KAA8B,CAAlC,EAAqC;MACnC,KAAKxsB,GAAL,CAASC,KAAT,CAAe+xB,QAAf,GAA2B,GAAE,CAAC,MAAMhM,YAAN,GAAqBD,WAAtB,EAAmC4H,OAAnC,CAA2C,CAA3C,CAA8C,GAA3E;MACA,KAAK3tB,GAAL,CAASC,KAAT,CAAegyB,SAAf,GAA4B,GAAE,CAAC,MAAMlM,WAAN,GAAoBC,YAArB,EAAmC2H,OAAnC,CAA2C,CAA3C,CAA8C,GAA5E;IACD;;IACD,MAAM,CAACzI,EAAD,EAAKC,EAAL,IAAW,KAAKwJ,qBAAL,EAAjB;IACA,KAAKvB,SAAL,CAAelI,EAAf,EAAmBC,EAAnB;IACAjW,UAAU,CAAC,IAAD,EAAO,KAAKlP,GAAZ,EAAiB,CAAC,aAAD,CAAjB,CAAV;IACA,OAAO,KAAKA,GAAZ;EACD;;EACDkyB,WAAW,CAAClf,KAAD,EAAQ;IACjB,MAAM;MACJne;IADI,IAEFtW,gBAAgB,CAACoW,QAFrB;;IAGA,IAAIqe,KAAK,CAACjF,MAAN,KAAiB,CAAjB,IAAsBiF,KAAK,CAACE,OAAN,IAAiBre,KAA3C,EAAkD;MAChDme,KAAK,CAAC9J,cAAN;MACA;IACD;;IACD,KAAK,CAACmgB,cAAN,GAAuB,IAAvB;;IACA,IAAI,KAAKiD,YAAT,EAAuB;MACrB,KAAK,CAAChI,gBAAN,CAAuBtR,KAAvB;MACA;IACD;;IACD,KAAK,CAACmf,oBAAN,CAA2Bnf,KAA3B;EACD;;EACD,CAACmf,oBAAoB,CAACnf,KAAD,EAAQ;IAC3B,MAAM;MACJne;IADI,IAEFtW,gBAAgB,CAACoW,QAFrB;;IAGA,IAAIqe,KAAK,CAACE,OAAN,IAAiB,CAACre,KAAlB,IAA2Bme,KAAK,CAACI,QAAjC,IAA6CJ,KAAK,CAACG,OAAN,IAAiBte,KAAlE,EAAyE;MACvE,KAAKma,MAAL,CAAY2U,cAAZ,CAA2B,IAA3B;IACD,CAFD,MAEO;MACL,KAAK3U,MAAL,CAAY0S,WAAZ,CAAwB,IAAxB;IACD;EACF;;EACD,CAAC4C,gBAAgB,CAACtR,KAAD,EAAQ;IACvB,MAAM6Q,UAAU,GAAG,KAAKpX,UAAL,CAAgBoX,UAAhB,CAA2B,IAA3B,CAAnB;;IACA,KAAKpX,UAAL,CAAgB6X,gBAAhB;;IACA,MAAM1K,EAAE,GAAG,IAAIxF,eAAJ,EAAX;;IACA,MAAM5H,MAAM,GAAG,KAAKC,UAAL,CAAgBkN,cAAhB,CAA+BC,EAA/B,CAAf;;IACA,IAAIiK,UAAJ,EAAgB;MACd,KAAK7jB,GAAL,CAASyN,SAAT,CAAmBC,GAAnB,CAAuB,QAAvB;MACA,KAAK,CAACgc,SAAN,GAAkB1W,KAAK,CAACof,OAAxB;MACA,KAAK,CAACzI,SAAN,GAAkB3W,KAAK,CAACqf,OAAxB;;MACA,MAAMC,mBAAmB,GAAGrpB,CAAC,IAAI;QAC/B,MAAM;UACJmpB,OAAO,EAAEt5B,CADL;UAEJu5B,OAAO,EAAEt5B;QAFL,IAGFkQ,CAHJ;QAIA,MAAM,CAACic,EAAD,EAAKC,EAAL,IAAW,KAAKgI,uBAAL,CAA6Br0B,CAAC,GAAG,KAAK,CAAC4wB,SAAvC,EAAkD3wB,CAAC,GAAG,KAAK,CAAC4wB,SAA5D,CAAjB;QACA,KAAK,CAACD,SAAN,GAAkB5wB,CAAlB;QACA,KAAK,CAAC6wB,SAAN,GAAkB5wB,CAAlB;;QACA,KAAK0T,UAAL,CAAgBwY,mBAAhB,CAAoCC,EAApC,EAAwCC,EAAxC;MACD,CATD;;MAUAza,MAAM,CAACiC,gBAAP,CAAwB,aAAxB,EAAuC2lB,mBAAvC,EAA4D;QAC1DpD,OAAO,EAAE,IADiD;QAE1D3hB,OAAO,EAAE,IAFiD;QAG1Df;MAH0D,CAA5D;IAKD;;IACD,MAAMgjB,iBAAiB,GAAG,MAAM;MAC9B5V,EAAE,CAACL,KAAH;;MACA,IAAIsK,UAAJ,EAAgB;QACd,KAAK7jB,GAAL,CAASyN,SAAT,CAAmB5L,MAAnB,CAA0B,QAA1B;MACD;;MACD,KAAK,CAACwnB,cAAN,GAAuB,KAAvB;;MACA,IAAI,CAAC,KAAK5c,UAAL,CAAgBoY,cAAhB,EAAL,EAAuC;QACrC,KAAK,CAACsN,oBAAN,CAA2Bnf,KAA3B;MACD;IACF,CATD;;IAUAtI,MAAM,CAACiC,gBAAP,CAAwB,WAAxB,EAAqC6iB,iBAArC,EAAwD;MACtDhjB;IADsD,CAAxD;IAGA9B,MAAM,CAACiC,gBAAP,CAAwB,MAAxB,EAAgC6iB,iBAAhC,EAAmD;MACjDhjB;IADiD,CAAnD;EAGD;;EACDshB,SAAS,GAAG;IACV,IAAI,KAAK,CAACrE,gBAAV,EAA4B;MAC1B/P,YAAY,CAAC,KAAK,CAAC+P,gBAAP,CAAZ;IACD;;IACD,KAAK,CAACA,gBAAN,GAAyB5G,UAAU,CAAC,MAAM;MACxC,KAAK,CAAC4G,gBAAN,GAAyB,IAAzB;MACA,KAAKza,MAAL,EAAaujB,eAAb,CAA6B,IAA7B;IACD,CAHkC,EAGhC,CAHgC,CAAnC;EAID;;EACDvN,qBAAqB,CAAChW,MAAD,EAASlW,CAAT,EAAYC,CAAZ,EAAe;IAClCiW,MAAM,CAACsW,YAAP,CAAoB,IAApB;IACA,KAAKxsB,CAAL,GAASA,CAAT;IACA,KAAKC,CAAL,GAASA,CAAT;IACA,KAAK0zB,iBAAL;EACD;;EACD+F,OAAO,CAACtN,EAAD,EAAKC,EAAL,EAAS9e,QAAQ,GAAG,KAAKA,QAAzB,EAAmC;IACxC,MAAMD,KAAK,GAAG,KAAK+nB,WAAnB;IACA,MAAM,CAACjnB,SAAD,EAAYC,UAAZ,IAA0B,KAAK4jB,cAArC;IACA,MAAM,CAAC3jB,KAAD,EAAQC,KAAR,IAAiB,KAAK2jB,eAA5B;IACA,MAAMyH,MAAM,GAAGvN,EAAE,GAAG9e,KAApB;IACA,MAAMssB,MAAM,GAAGvN,EAAE,GAAG/e,KAApB;IACA,MAAMtN,CAAC,GAAG,KAAKA,CAAL,GAASoO,SAAnB;IACA,MAAMnO,CAAC,GAAG,KAAKA,CAAL,GAASoO,UAAnB;IACA,MAAMzJ,KAAK,GAAG,KAAKA,KAAL,GAAawJ,SAA3B;IACA,MAAMvJ,MAAM,GAAG,KAAKA,MAAL,GAAcwJ,UAA7B;;IACA,QAAQd,QAAR;MACE,KAAK,CAAL;QACE,OAAO,CAACvN,CAAC,GAAG25B,MAAJ,GAAarrB,KAAd,EAAqBD,UAAU,GAAGpO,CAAb,GAAiB25B,MAAjB,GAA0B/0B,MAA1B,GAAmC0J,KAAxD,EAA+DvO,CAAC,GAAG25B,MAAJ,GAAa/0B,KAAb,GAAqB0J,KAApF,EAA2FD,UAAU,GAAGpO,CAAb,GAAiB25B,MAAjB,GAA0BrrB,KAArH,CAAP;;MACF,KAAK,EAAL;QACE,OAAO,CAACvO,CAAC,GAAG45B,MAAJ,GAAatrB,KAAd,EAAqBD,UAAU,GAAGpO,CAAb,GAAiB05B,MAAjB,GAA0BprB,KAA/C,EAAsDvO,CAAC,GAAG45B,MAAJ,GAAa/0B,MAAb,GAAsByJ,KAA5E,EAAmFD,UAAU,GAAGpO,CAAb,GAAiB05B,MAAjB,GAA0B/0B,KAA1B,GAAkC2J,KAArH,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAACvO,CAAC,GAAG25B,MAAJ,GAAa/0B,KAAb,GAAqB0J,KAAtB,EAA6BD,UAAU,GAAGpO,CAAb,GAAiB25B,MAAjB,GAA0BrrB,KAAvD,EAA8DvO,CAAC,GAAG25B,MAAJ,GAAarrB,KAA3E,EAAkFD,UAAU,GAAGpO,CAAb,GAAiB25B,MAAjB,GAA0B/0B,MAA1B,GAAmC0J,KAArH,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAACvO,CAAC,GAAG45B,MAAJ,GAAa/0B,MAAb,GAAsByJ,KAAvB,EAA8BD,UAAU,GAAGpO,CAAb,GAAiB05B,MAAjB,GAA0B/0B,KAA1B,GAAkC2J,KAAhE,EAAuEvO,CAAC,GAAG45B,MAAJ,GAAatrB,KAApF,EAA2FD,UAAU,GAAGpO,CAAb,GAAiB05B,MAAjB,GAA0BprB,KAArH,CAAP;;MACF;QACE,MAAM,IAAI7W,KAAJ,CAAU,kBAAV,CAAN;IAVJ;EAYD;;EACDmiC,sBAAsB,CAACl7B,IAAD,EAAO0P,UAAP,EAAmB;IACvC,MAAM,CAAChP,EAAD,EAAKI,EAAL,EAASH,EAAT,EAAaI,EAAb,IAAmBf,IAAzB;IACA,MAAMiG,KAAK,GAAGtF,EAAE,GAAGD,EAAnB;IACA,MAAMwF,MAAM,GAAGnF,EAAE,GAAGD,EAApB;;IACA,QAAQ,KAAK8N,QAAb;MACE,KAAK,CAAL;QACE,OAAO,CAAClO,EAAD,EAAKgP,UAAU,GAAG3O,EAAlB,EAAsBkF,KAAtB,EAA6BC,MAA7B,CAAP;;MACF,KAAK,EAAL;QACE,OAAO,CAACxF,EAAD,EAAKgP,UAAU,GAAG5O,EAAlB,EAAsBoF,MAAtB,EAA8BD,KAA9B,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAACtF,EAAD,EAAK+O,UAAU,GAAG5O,EAAlB,EAAsBmF,KAAtB,EAA6BC,MAA7B,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAACvF,EAAD,EAAK+O,UAAU,GAAG3O,EAAlB,EAAsBmF,MAAtB,EAA8BD,KAA9B,CAAP;;MACF;QACE,MAAM,IAAIlN,KAAJ,CAAU,kBAAV,CAAN;IAVJ;EAYD;;EACDoiC,SAAS,GAAG,CAAE;;EACdnc,OAAO,GAAG;IACR,OAAO,KAAP;EACD;;EACDoc,cAAc,GAAG;IACf,KAAK,CAACtJ,YAAN,GAAqB,IAArB;EACD;;EACDuJ,eAAe,GAAG;IAChB,KAAK,CAACvJ,YAAN,GAAqB,KAArB;EACD;;EACDA,YAAY,GAAG;IACb,OAAO,KAAK,CAACA,YAAb;EACD;;EACD/D,uBAAuB,GAAG;IACxB,OAAO,KAAK,CAACgE,2BAAb;EACD;;EACDuJ,gBAAgB,GAAG;IACjB,OAAO,KAAK/yB,GAAL,IAAY,CAAC,KAAKkrB,eAAzB;EACD;;EACD,CAAC6G,iBAAiB,GAAG;IACnB,IAAI,KAAK,CAAC5I,OAAN,IAAiB,CAAC,KAAKnpB,GAA3B,EAAgC;MAC9B;IACD;;IACD,KAAK,CAACmpB,OAAN,GAAgB,IAAI/U,eAAJ,EAAhB;;IACA,MAAM5H,MAAM,GAAG,KAAKC,UAAL,CAAgBkN,cAAhB,CAA+B,KAAK,CAACwP,OAArC,CAAf;;IACA,KAAKnpB,GAAL,CAAS2M,gBAAT,CAA0B,SAA1B,EAAqC,KAAKmgB,OAAL,CAAapqB,IAAb,CAAkB,IAAlB,CAArC,EAA8D;MAC5D8J;IAD4D,CAA9D;IAGA,KAAKxM,GAAL,CAAS2M,gBAAT,CAA0B,UAA1B,EAAsC,KAAKogB,QAAL,CAAcrqB,IAAd,CAAmB,IAAnB,CAAtC,EAAgE;MAC9D8J;IAD8D,CAAhE;EAGD;;EACD6Y,OAAO,GAAG;IACR,KAAK,CAAC0M,iBAAN;EACD;;EACDiB,MAAM,CAACC,MAAD,EAAS,CAAE;;EACjBlgB,SAAS,CAACmV,YAAY,GAAG,KAAhB,EAAuBpqB,OAAO,GAAG,IAAjC,EAAuC;IAC9CvN,WAAW,CAAC,gCAAD,CAAX;EACD;;EACiB,OAAXwvB,WAAW,CAACja,IAAD,EAAOkJ,MAAP,EAAeR,SAAf,EAA0B;IAC1C,MAAM5C,MAAM,GAAG,IAAI,KAAKvuB,SAAL,CAAe4U,WAAnB,CAA+B;MAC5C+c,MAD4C;MAE5CrP,EAAE,EAAEqP,MAAM,CAACyc,SAAP,EAFwC;MAG5Cjd;IAH4C,CAA/B,CAAf;IAKA5C,MAAM,CAACvF,QAAP,GAAkBP,IAAI,CAACO,QAAvB;IACAuF,MAAM,CAAC,CAACkd,iBAAR,GAA4BhjB,IAAI,CAACgjB,iBAAjC;IACA,MAAM,CAAC5hB,SAAD,EAAYC,UAAZ,IAA0ByE,MAAM,CAACmf,cAAvC;IACA,MAAM,CAACjyB,CAAD,EAAIC,CAAJ,EAAO2E,KAAP,EAAcC,MAAd,IAAwBiO,MAAM,CAAC+mB,sBAAP,CAA8B7sB,IAAI,CAACrO,IAAnC,EAAyC0P,UAAzC,CAA9B;IACAyE,MAAM,CAAC9S,CAAP,GAAWA,CAAC,GAAGoO,SAAf;IACA0E,MAAM,CAAC7S,CAAP,GAAWA,CAAC,GAAGoO,UAAf;IACAyE,MAAM,CAAClO,KAAP,GAAeA,KAAK,GAAGwJ,SAAvB;IACA0E,MAAM,CAACjO,MAAP,GAAgBA,MAAM,GAAGwJ,UAAzB;IACA,OAAOyE,MAAP;EACD;;EACkB,IAAf8a,eAAe,GAAG;IACpB,OAAO,CAAC,CAAC,KAAKjF,mBAAP,KAA+B,KAAKwB,OAAL,IAAgB,KAAKlQ,SAAL,OAAqB,IAApE,CAAP;EACD;;EACDlR,MAAM,GAAG;IACP,KAAK,CAACsnB,OAAN,EAAe5P,KAAf;IACA,KAAK,CAAC4P,OAAN,GAAgB,IAAhB;;IACA,IAAI,CAAC,KAAK1S,OAAL,EAAL,EAAqB;MACnB,KAAKuN,MAAL;IACD;;IACD,IAAI,KAAKhV,MAAT,EAAiB;MACf,KAAKA,MAAL,CAAYnN,MAAZ,CAAmB,IAAnB;IACD,CAFD,MAEO;MACL,KAAK4K,UAAL,CAAgBmW,YAAhB,CAA6B,IAA7B;IACD;;IACD,IAAI,KAAK,CAAC6G,gBAAV,EAA4B;MAC1B/P,YAAY,CAAC,KAAK,CAAC+P,gBAAP,CAAZ;MACA,KAAK,CAACA,gBAAN,GAAyB,IAAzB;IACD;;IACD,KAAK,CAACoD,YAAN;IACA,KAAKyE,iBAAL;;IACA,IAAI,KAAK,CAAC1H,iBAAV,EAA6B;MAC3B,KAAK,MAAMsJ,OAAX,IAAsB,KAAK,CAACtJ,iBAAN,CAAwBnQ,MAAxB,EAAtB,EAAwD;QACtDC,YAAY,CAACwZ,OAAD,CAAZ;MACD;;MACD,KAAK,CAACtJ,iBAAN,GAA0B,IAA1B;IACD;;IACD,KAAK5a,MAAL,GAAc,IAAd;EACD;;EACc,IAAXmkB,WAAW,GAAG;IAChB,OAAO,KAAP;EACD;;EACDC,aAAa,GAAG;IACd,IAAI,KAAKD,WAAT,EAAsB;MACpB,KAAK,CAACvE,cAAN;MACA,KAAK,CAAC3F,WAAN,CAAkBxb,SAAlB,CAA4B5L,MAA5B,CAAmC,QAAnC;MACAqN,UAAU,CAAC,IAAD,EAAO,KAAKlP,GAAZ,EAAiB,CAAC,SAAD,CAAjB,CAAV;IACD;EACF;;EACkB,IAAf6M,eAAe,GAAG;IACpB,OAAO,IAAP;EACD;;EACDsR,OAAO,CAACnL,KAAD,EAAQ;IACb,IAAI,CAAC,KAAKmgB,WAAN,IAAqBngB,KAAK,CAAC2E,MAAN,KAAiB,KAAK3X,GAA3C,IAAkDgT,KAAK,CAACn2B,GAAN,KAAc,OAApE,EAA6E;MAC3E;IACD;;IACD,KAAK4vB,UAAL,CAAgBiV,WAAhB,CAA4B,IAA5B;;IACA,KAAK,CAACwH,eAAN,GAAwB;MACtB3E,MAAM,EAAE,KAAKzrB,CADS;MAEtB0rB,MAAM,EAAE,KAAKzrB,CAFS;MAGtBo2B,UAAU,EAAE,KAAKzxB,KAHK;MAItB0xB,WAAW,EAAE,KAAKzxB;IAJI,CAAxB;IAMA,MAAM01B,QAAQ,GAAG,KAAK,CAACpK,WAAN,CAAkBoK,QAAnC;;IACA,IAAI,CAAC,KAAK,CAACtK,cAAX,EAA2B;MACzB,KAAK,CAACA,cAAN,GAAuB5zB,KAAK,CAACC,IAAN,CAAWi+B,QAAX,CAAvB;MACA,MAAMC,mBAAmB,GAAG,KAAK,CAACC,cAAN,CAAqB7wB,IAArB,CAA0B,IAA1B,CAA5B;MACA,MAAM8wB,gBAAgB,GAAG,KAAK,CAACC,WAAN,CAAkB/wB,IAAlB,CAAuB,IAAvB,CAAzB;MACA,MAAM8J,MAAM,GAAG,KAAKC,UAAL,CAAgBC,OAA/B;;MACA,KAAK,MAAM1M,GAAX,IAAkB,KAAK,CAAC+oB,cAAxB,EAAwC;QACtC,MAAM/2B,IAAI,GAAGgO,GAAG,CAACkmB,YAAJ,CAAiB,mBAAjB,CAAb;QACAlmB,GAAG,CAAChB,YAAJ,CAAiB,MAAjB,EAAyB,YAAzB;QACAgB,GAAG,CAAC2M,gBAAJ,CAAqB,SAArB,EAAgC2mB,mBAAhC,EAAqD;UACnD9mB;QADmD,CAArD;QAGAxM,GAAG,CAAC2M,gBAAJ,CAAqB,MAArB,EAA6B6mB,gBAA7B,EAA+C;UAC7ChnB;QAD6C,CAA/C;QAGAxM,GAAG,CAAC2M,gBAAJ,CAAqB,OAArB,EAA8B,KAAK,CAAC+mB,YAAN,CAAmBhxB,IAAnB,CAAwB,IAAxB,EAA8B1Q,IAA9B,CAA9B,EAAmE;UACjEwa;QADiE,CAAnE;QAGAxM,GAAG,CAAChB,YAAJ,CAAiB,cAAjB,EAAiC6pB,gBAAgB,CAACmB,YAAjB,CAA8Bh4B,IAA9B,CAAjC;MACD;IACF;;IACD,MAAMmF,KAAK,GAAG,KAAK,CAAC4xB,cAAN,CAAqB,CAArB,CAAd;IACA,IAAI4K,aAAa,GAAG,CAApB;;IACA,KAAK,MAAM3zB,GAAX,IAAkBqzB,QAAlB,EAA4B;MAC1B,IAAIrzB,GAAG,KAAK7I,KAAZ,EAAmB;QACjB;MACD;;MACDw8B,aAAa;IACd;;IACD,MAAMC,iBAAiB,GAAG,CAAC,MAAM,KAAKvtB,QAAX,GAAsB,KAAKmmB,cAA5B,IAA8C,GAA9C,GAAoD,EAApD,IAA0D,KAAK,CAACzD,cAAN,CAAqB33B,MAArB,GAA8B,CAAxF,CAA1B;;IACA,IAAIwiC,iBAAiB,KAAKD,aAA1B,EAAyC;MACvC,IAAIC,iBAAiB,GAAGD,aAAxB,EAAuC;QACrC,KAAK,IAAI3gC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2gC,aAAa,GAAGC,iBAApC,EAAuD5gC,CAAC,EAAxD,EAA4D;UAC1D,KAAK,CAACi2B,WAAN,CAAkBxoB,MAAlB,CAAyB,KAAK,CAACwoB,WAAN,CAAkB4K,UAA3C;QACD;MACF,CAJD,MAIO,IAAID,iBAAiB,GAAGD,aAAxB,EAAuC;QAC5C,KAAK,IAAI3gC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4gC,iBAAiB,GAAGD,aAAxC,EAAuD3gC,CAAC,EAAxD,EAA4D;UAC1D,KAAK,CAACi2B,WAAN,CAAkB4K,UAAlB,CAA6BC,MAA7B,CAAoC,KAAK,CAAC7K,WAAN,CAAkB8K,SAAtD;QACD;MACF;;MACD,IAAI/gC,CAAC,GAAG,CAAR;;MACA,KAAK,MAAMu1B,KAAX,IAAoB8K,QAApB,EAA8B;QAC5B,MAAMrzB,GAAG,GAAG,KAAK,CAAC+oB,cAAN,CAAqB/1B,CAAC,EAAtB,CAAZ;QACA,MAAMhB,IAAI,GAAGgO,GAAG,CAACkmB,YAAJ,CAAiB,mBAAjB,CAAb;QACAqC,KAAK,CAACvpB,YAAN,CAAmB,cAAnB,EAAmC6pB,gBAAgB,CAACmB,YAAjB,CAA8Bh4B,IAA9B,CAAnC;MACD;IACF;;IACD,KAAK,CAACgiC,kBAAN,CAAyB,CAAzB;IACA,KAAK,CAACxK,2BAAN,GAAoC,IAApC;IACA,KAAK,CAACP,WAAN,CAAkB4K,UAAlB,CAA6B3Y,KAA7B,CAAmC;MACjC2M,YAAY,EAAE;IADmB,CAAnC;IAGA7U,KAAK,CAAC9J,cAAN;IACA8J,KAAK,CAACihB,wBAAN;EACD;;EACD,CAACV,cAAc,CAACvgB,KAAD,EAAQ;IACrB6V,gBAAgB,CAACyB,uBAAjB,CAAyChiB,IAAzC,CAA8C,IAA9C,EAAoD0K,KAApD;EACD;;EACD,CAACygB,WAAW,CAACzgB,KAAD,EAAQ;IAClB,IAAI,KAAK,CAACwW,2BAAN,IAAqCxW,KAAK,CAACga,aAAN,EAAqBvpB,UAArB,KAAoC,KAAK,CAACwlB,WAAnF,EAAgG;MAC9F,KAAK,CAAC4D,YAAN;IACD;EACF;;EACD,CAAC6G,YAAY,CAAC1hC,IAAD,EAAO;IAClB,KAAK,CAACo3B,kBAAN,GAA2B,KAAK,CAACI,2BAAN,GAAoCx3B,IAApC,GAA2C,EAAtE;EACD;;EACD,CAACgiC,kBAAkB,CAACviC,KAAD,EAAQ;IACzB,IAAI,CAAC,KAAK,CAACs3B,cAAX,EAA2B;MACzB;IACD;;IACD,KAAK,MAAM/oB,GAAX,IAAkB,KAAK,CAAC+oB,cAAxB,EAAwC;MACtC/oB,GAAG,CAACgO,QAAJ,GAAevc,KAAf;IACD;EACF;;EACD+4B,mBAAmB,CAAC1xB,CAAD,EAAIC,CAAJ,EAAO;IACxB,IAAI,CAAC,KAAK,CAACywB,2BAAX,EAAwC;MACtC;IACD;;IACD,KAAK,CAACyF,kBAAN,CAAyB,KAAK,CAAC7F,kBAA/B,EAAmD;MACjD4H,SAAS,EAAEl4B,CADsC;MAEjDm4B,SAAS,EAAEl4B;IAFsC,CAAnD;EAID;;EACD,CAAC8zB,YAAY,GAAG;IACd,KAAK,CAACrD,2BAAN,GAAoC,KAApC;IACA,KAAK,CAACwK,kBAAN,CAAyB,CAAC,CAA1B;;IACA,IAAI,KAAK,CAAC9K,eAAV,EAA2B;MACzB,MAAM;QACJ3E,MADI;QAEJC,MAFI;QAGJ2K,UAHI;QAIJC;MAJI,IAKF,KAAK,CAAClG,eALV;MAMA,KAAK,CAACuG,oBAAN,CAA2BlL,MAA3B,EAAmCC,MAAnC,EAA2C2K,UAA3C,EAAuDC,WAAvD;MACA,KAAK,CAAClG,eAAN,GAAwB,IAAxB;IACD;EACF;;EACDuB,yBAAyB,GAAG;IAC1B,KAAK,CAACoC,YAAN;IACA,KAAK7sB,GAAL,CAASkb,KAAT;EACD;;EACD0I,MAAM,GAAG;IACP,KAAKwP,aAAL;IACA,KAAKpzB,GAAL,EAAUyN,SAAV,CAAoBC,GAApB,CAAwB,gBAAxB;;IACA,IAAI,CAAC,KAAKmc,YAAV,EAAwB;MACtB,KAAKwH,cAAL,GAAsBxrB,IAAtB,CAA2B,MAAM;QAC/B,IAAI,KAAK7F,GAAL,EAAUyN,SAAV,CAAoB4J,QAApB,CAA6B,gBAA7B,CAAJ,EAAoD;UAClD,KAAKwS,YAAL,EAAmBjc,IAAnB;QACD;MACF,CAJD;MAKA;IACD;;IACD,KAAKic,YAAL,EAAmBjc,IAAnB;IACA,KAAK,CAAC9B,OAAN,EAAemc,kBAAf,CAAkC,KAAlC;EACD;;EACDnF,QAAQ,GAAG;IACT,KAAK,CAACmG,WAAN,EAAmBxb,SAAnB,CAA6BC,GAA7B,CAAiC,QAAjC;IACA,KAAK1N,GAAL,EAAUyN,SAAV,CAAoB5L,MAApB,CAA2B,gBAA3B;;IACA,IAAI,KAAK7B,GAAL,EAAUqX,QAAV,CAAmB5X,QAAQ,CAAC6X,aAA5B,CAAJ,EAAgD;MAC9C,KAAK7K,UAAL,CAAgB4P,YAAhB,CAA6Brc,GAA7B,CAAiCkb,KAAjC,CAAuC;QACrCgZ,aAAa,EAAE;MADsB,CAAvC;IAGD;;IACD,KAAKrK,YAAL,EAAmBrc,IAAnB;IACA,KAAK,CAAC1B,OAAN,EAAemc,kBAAf,CAAkC,IAAlC;EACD;;EACDjP,YAAY,CAACn4B,IAAD,EAAO4Q,KAAP,EAAc,CAAE;;EAC5B0iC,cAAc,GAAG,CAAE;;EACnBC,aAAa,GAAG,CAAE;;EAClBzS,eAAe,GAAG,CAAE;;EACpBiH,kBAAkB,GAAG;IACnB,OAAO,IAAP;EACD;;EACa,IAAVyL,UAAU,GAAG;IACf,OAAO,KAAKr0B,GAAZ;EACD;;EACY,IAATwW,SAAS,GAAG;IACd,OAAO,KAAK,CAACA,SAAb;EACD;;EACY,IAATA,SAAS,CAAC/kB,KAAD,EAAQ;IACnB,KAAK,CAAC+kB,SAAN,GAAkB/kB,KAAlB;;IACA,IAAI,CAAC,KAAKud,MAAV,EAAkB;MAChB;IACD;;IACD,IAAIvd,KAAJ,EAAW;MACT,KAAKud,MAAL,CAAY0S,WAAZ,CAAwB,IAAxB;MACA,KAAK1S,MAAL,CAAYsU,eAAZ,CAA4B,IAA5B;IACD,CAHD,MAGO;MACL,KAAKtU,MAAL,CAAYsU,eAAZ,CAA4B,IAA5B;IACD;EACF;;EACDgR,cAAc,CAAC52B,KAAD,EAAQC,MAAR,EAAgB;IAC5B,KAAK,CAACqrB,eAAN,GAAwB,IAAxB;IACA,MAAMuL,WAAW,GAAG72B,KAAK,GAAGC,MAA5B;IACA,MAAM;MACJsC;IADI,IAEF,KAAKD,GAFT;IAGAC,KAAK,CAACs0B,WAAN,GAAoBA,WAApB;IACAt0B,KAAK,CAACtC,MAAN,GAAe,MAAf;EACD;;EACkB,WAARkyB,QAAQ,GAAG;IACpB,OAAO,EAAP;EACD;;EAC6B,OAAvBjO,uBAAuB,GAAG;IAC/B,OAAO,IAAP;EACD;;EACuB,IAApB4S,oBAAoB,GAAG;IACzB,OAAO;MACLxS,MAAM,EAAE;IADH,CAAP;EAGD;;EACqB,IAAlByS,kBAAkB,GAAG;IACvB,OAAO,IAAP;EACD;;EACDhN,gBAAgB,CAAC3hB,IAAD,EAAOwc,QAAQ,GAAG,KAAlB,EAAyB;IACvC,IAAIA,QAAJ,EAAc;MACZ,KAAK,CAACsH,iBAAN,KAA4B,IAAItuB,GAAJ,EAA5B;MACA,MAAM;QACJ0mB;MADI,IAEFlc,IAFJ;MAGA,IAAIotB,OAAO,GAAG,KAAK,CAACtJ,iBAAN,CAAwB1sC,GAAxB,CAA4B8kC,MAA5B,CAAd;;MACA,IAAIkR,OAAJ,EAAa;QACXxZ,YAAY,CAACwZ,OAAD,CAAZ;MACD;;MACDA,OAAO,GAAGrQ,UAAU,CAAC,MAAM;QACzB,KAAK4E,gBAAL,CAAsB3hB,IAAtB;;QACA,KAAK,CAAC8jB,iBAAN,CAAwB3b,MAAxB,CAA+B+T,MAA/B;;QACA,IAAI,KAAK,CAAC4H,iBAAN,CAAwBpmB,IAAxB,KAAiC,CAArC,EAAwC;UACtC,KAAK,CAAComB,iBAAN,GAA0B,IAA1B;QACD;MACF,CANmB,EAMjBf,gBAAgB,CAACwB,iBANA,CAApB;MAOA,KAAK,CAACT,iBAAN,CAAwBnoB,GAAxB,CAA4BugB,MAA5B,EAAoCkR,OAApC;MACA;IACD;;IACDptB,IAAI,CAACjlB,IAAL,KAAc,KAAKitB,UAAnB;;IACA,KAAKrB,UAAL,CAAgB+L,SAAhB,CAA0BqC,QAA1B,CAAmC,iBAAnC,EAAsD;MACpDC,MAAM,EAAE,IAD4C;MAEpDzoB,OAAO,EAAE;QACPxR,IAAI,EAAE,SADC;QAEPilB;MAFO;IAF2C,CAAtD;EAOD;;EACD8H,IAAI,CAACsU,OAAO,GAAG,KAAK6H,UAAhB,EAA4B;IAC9B,KAAK/pB,GAAL,CAASyN,SAAT,CAAmB+N,MAAnB,CAA0B,QAA1B,EAAoC,CAAC0G,OAArC;IACA,KAAK6H,UAAL,GAAkB7H,OAAlB;EACD;;EACDjB,MAAM,GAAG;IACP,IAAI,KAAKjhB,GAAT,EAAc;MACZ,KAAKA,GAAL,CAASgO,QAAT,GAAoB,CAApB;IACD;;IACD,KAAK,CAACsa,QAAN,GAAiB,KAAjB;EACD;;EACDpH,OAAO,GAAG;IACR,IAAI,KAAKlhB,GAAT,EAAc;MACZ,KAAKA,GAAL,CAASgO,QAAT,GAAoB,CAAC,CAArB;IACD;;IACD,KAAK,CAACsa,QAAN,GAAiB,IAAjB;EACD;;EACDhC,uBAAuB,CAACC,UAAD,EAAa;IAClC,IAAImO,OAAO,GAAGnO,UAAU,CAACzP,SAAX,CAAqB6d,aAArB,CAAmC,oBAAnC,CAAd;;IACA,IAAI,CAACD,OAAL,EAAc;MACZA,OAAO,GAAGj1B,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAV;MACAy1B,OAAO,CAACjnB,SAAR,CAAkBC,GAAlB,CAAsB,mBAAtB,EAA2C,KAAKI,UAAhD;MACAyY,UAAU,CAACzP,SAAX,CAAqB1I,OAArB,CAA6BsmB,OAA7B;IACD,CAJD,MAIO,IAAIA,OAAO,CAACE,QAAR,KAAqB,QAAzB,EAAmC;MACxC,MAAMh3B,MAAM,GAAG82B,OAAf;MACAA,OAAO,GAAGj1B,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAV;MACAy1B,OAAO,CAACjnB,SAAR,CAAkBC,GAAlB,CAAsB,mBAAtB,EAA2C,KAAKI,UAAhD;MACAlQ,MAAM,CAACk2B,MAAP,CAAcY,OAAd;IACD;;IACD,OAAOA,OAAP;EACD;;EACDG,sBAAsB,CAACtO,UAAD,EAAa;IACjC,MAAM;MACJsN;IADI,IAEFtN,UAAU,CAACzP,SAFf;;IAGA,IAAI+c,UAAU,CAACe,QAAX,KAAwB,KAAxB,IAAiCf,UAAU,CAACpmB,SAAX,CAAqB4J,QAArB,CAA8B,mBAA9B,CAArC,EAAyF;MACvFwc,UAAU,CAAChyB,MAAX;IACD;EACF;;AA7oCoB;;AA+oCvB,MAAM2pB,UAAN,SAAyB3C,gBAAzB,CAA0C;EACxC52B,WAAW,CAAC8xB,MAAD,EAAS;IAClB,MAAMA,MAAN;IACA,KAAKtC,mBAAL,GAA2BsC,MAAM,CAACtC,mBAAlC;IACA,KAAKwB,OAAL,GAAe,IAAf;EACD;;EACDlQ,SAAS,GAAG;IACV,OAAO;MACLpT,EAAE,EAAE,KAAK8hB,mBADJ;MAELwB,OAAO,EAAE,IAFJ;MAGLlC,SAAS,EAAE,KAAKA;IAHX,CAAP;EAKD;;AAZuC;;AAe1C,C,CAAC;;AACD,MAAM+T,IAAI,GAAG,UAAb;AACA,MAAMC,SAAS,GAAG,UAAlB;AACA,MAAMC,QAAQ,GAAG,MAAjB;;AACA,MAAMC,cAAN,CAAqB;EACnBhjC,WAAW,CAACijC,IAAD,EAAO;IAChB,KAAKC,EAAL,GAAUD,IAAI,GAAGA,IAAI,GAAG,UAAV,GAAuBJ,IAArC;IACA,KAAKM,EAAL,GAAUF,IAAI,GAAGA,IAAI,GAAG,UAAV,GAAuBJ,IAArC;EACD;;EACDO,MAAM,CAAC/rB,KAAD,EAAQ;IACZ,IAAIxD,IAAJ,EAAU1U,MAAV;;IACA,IAAI,OAAOkY,KAAP,KAAiB,QAArB,EAA+B;MAC7BxD,IAAI,GAAG,IAAIpS,UAAJ,CAAe4V,KAAK,CAAClY,MAAN,GAAe,CAA9B,CAAP;MACAA,MAAM,GAAG,CAAT;;MACA,KAAK,IAAI4B,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGsP,KAAK,CAAClY,MAA3B,EAAmC4B,CAAC,GAAGgH,EAAvC,EAA2ChH,CAAC,EAA5C,EAAgD;QAC9C,MAAMb,IAAI,GAAGmX,KAAK,CAAC3V,UAAN,CAAiBX,CAAjB,CAAb;;QACA,IAAIb,IAAI,IAAI,IAAZ,EAAkB;UAChB2T,IAAI,CAAC1U,MAAM,EAAP,CAAJ,GAAiBe,IAAjB;QACD,CAFD,MAEO;UACL2T,IAAI,CAAC1U,MAAM,EAAP,CAAJ,GAAiBe,IAAI,KAAK,CAA1B;UACA2T,IAAI,CAAC1U,MAAM,EAAP,CAAJ,GAAiBe,IAAI,GAAG,IAAxB;QACD;MACF;IACF,CAZD,MAYO,IAAI6T,WAAW,CAACsvB,MAAZ,CAAmBhsB,KAAnB,CAAJ,EAA+B;MACpCxD,IAAI,GAAGwD,KAAK,CAAC5S,KAAN,EAAP;MACAtF,MAAM,GAAG0U,IAAI,CAACyvB,UAAd;IACD,CAHM,MAGA;MACL,MAAM,IAAI/kC,KAAJ,CAAU,sDAAV,CAAN;IACD;;IACD,MAAMglC,WAAW,GAAGpkC,MAAM,IAAI,CAA9B;IACA,MAAMqkC,UAAU,GAAGrkC,MAAM,GAAGokC,WAAW,GAAG,CAA1C;IACA,MAAME,UAAU,GAAG,IAAIrhC,WAAJ,CAAgByR,IAAI,CAACxR,MAArB,EAA6B,CAA7B,EAAgCkhC,WAAhC,CAAnB;IACA,IAAIG,EAAE,GAAG,CAAT;IAAA,IACEC,EAAE,GAAG,CADP;IAEA,IAAIT,EAAE,GAAG,KAAKA,EAAd;IAAA,IACEC,EAAE,GAAG,KAAKA,EADZ;IAEA,MAAMS,EAAE,GAAG,UAAX;IAAA,MACEC,EAAE,GAAG,UADP;IAEA,MAAMC,MAAM,GAAGF,EAAE,GAAGb,QAApB;IAAA,MACEgB,MAAM,GAAGF,EAAE,GAAGd,QADhB;;IAEA,KAAK,IAAIhiC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwiC,WAApB,EAAiCxiC,CAAC,EAAlC,EAAsC;MACpC,IAAIA,CAAC,GAAG,CAAR,EAAW;QACT2iC,EAAE,GAAGD,UAAU,CAAC1iC,CAAD,CAAf;QACA2iC,EAAE,GAAGA,EAAE,GAAGE,EAAL,GAAUd,SAAV,GAAsBY,EAAE,GAAGI,MAAL,GAAcf,QAAzC;QACAW,EAAE,GAAGA,EAAE,IAAI,EAAN,GAAWA,EAAE,KAAK,EAAvB;QACAA,EAAE,GAAGA,EAAE,GAAGG,EAAL,GAAUf,SAAV,GAAsBY,EAAE,GAAGK,MAAL,GAAchB,QAAzC;QACAG,EAAE,IAAIQ,EAAN;QACAR,EAAE,GAAGA,EAAE,IAAI,EAAN,GAAWA,EAAE,KAAK,EAAvB;QACAA,EAAE,GAAGA,EAAE,GAAG,CAAL,GAAS,UAAd;MACD,CARD,MAQO;QACLS,EAAE,GAAGF,UAAU,CAAC1iC,CAAD,CAAf;QACA4iC,EAAE,GAAGA,EAAE,GAAGC,EAAL,GAAUd,SAAV,GAAsBa,EAAE,GAAGG,MAAL,GAAcf,QAAzC;QACAY,EAAE,GAAGA,EAAE,IAAI,EAAN,GAAWA,EAAE,KAAK,EAAvB;QACAA,EAAE,GAAGA,EAAE,GAAGE,EAAL,GAAUf,SAAV,GAAsBa,EAAE,GAAGI,MAAL,GAAchB,QAAzC;QACAI,EAAE,IAAIQ,EAAN;QACAR,EAAE,GAAGA,EAAE,IAAI,EAAN,GAAWA,EAAE,KAAK,EAAvB;QACAA,EAAE,GAAGA,EAAE,GAAG,CAAL,GAAS,UAAd;MACD;IACF;;IACDO,EAAE,GAAG,CAAL;;IACA,QAAQF,UAAR;MACE,KAAK,CAAL;QACEE,EAAE,IAAI7vB,IAAI,CAAC0vB,WAAW,GAAG,CAAd,GAAkB,CAAnB,CAAJ,IAA6B,EAAnC;;MACF,KAAK,CAAL;QACEG,EAAE,IAAI7vB,IAAI,CAAC0vB,WAAW,GAAG,CAAd,GAAkB,CAAnB,CAAJ,IAA6B,CAAnC;;MACF,KAAK,CAAL;QACEG,EAAE,IAAI7vB,IAAI,CAAC0vB,WAAW,GAAG,CAAf,CAAV;QACAG,EAAE,GAAGA,EAAE,GAAGE,EAAL,GAAUd,SAAV,GAAsBY,EAAE,GAAGI,MAAL,GAAcf,QAAzC;QACAW,EAAE,GAAGA,EAAE,IAAI,EAAN,GAAWA,EAAE,KAAK,EAAvB;QACAA,EAAE,GAAGA,EAAE,GAAGG,EAAL,GAAUf,SAAV,GAAsBY,EAAE,GAAGK,MAAL,GAAchB,QAAzC;;QACA,IAAIQ,WAAW,GAAG,CAAlB,EAAqB;UACnBL,EAAE,IAAIQ,EAAN;QACD,CAFD,MAEO;UACLP,EAAE,IAAIO,EAAN;QACD;;IAdL;;IAgBA,KAAKR,EAAL,GAAUA,EAAV;IACA,KAAKC,EAAL,GAAUA,EAAV;EACD;;EACDa,SAAS,GAAG;IACV,IAAId,EAAE,GAAG,KAAKA,EAAd;IAAA,IACEC,EAAE,GAAG,KAAKA,EADZ;IAEAD,EAAE,IAAIC,EAAE,KAAK,CAAb;IACAD,EAAE,GAAGA,EAAE,GAAG,UAAL,GAAkBJ,SAAlB,GAA8BI,EAAE,GAAG,MAAL,GAAcH,QAAjD;IACAI,EAAE,GAAGA,EAAE,GAAG,UAAL,GAAkBL,SAAlB,GAA8B,CAAC,CAACK,EAAE,IAAI,EAAN,GAAWD,EAAE,KAAK,EAAnB,IAAyB,UAAzB,GAAsCJ,SAAvC,MAAsD,EAAzF;IACAI,EAAE,IAAIC,EAAE,KAAK,CAAb;IACAD,EAAE,GAAGA,EAAE,GAAG,UAAL,GAAkBJ,SAAlB,GAA8BI,EAAE,GAAG,MAAL,GAAcH,QAAjD;IACAI,EAAE,GAAGA,EAAE,GAAG,UAAL,GAAkBL,SAAlB,GAA8B,CAAC,CAACK,EAAE,IAAI,EAAN,GAAWD,EAAE,KAAK,EAAnB,IAAyB,UAAzB,GAAsCJ,SAAvC,MAAsD,EAAzF;IACAI,EAAE,IAAIC,EAAE,KAAK,CAAb;IACA,OAAO,CAACD,EAAE,KAAK,CAAR,EAAW7/B,QAAX,CAAoB,EAApB,EAAwBC,QAAxB,CAAiC,CAAjC,EAAoC,GAApC,IAA2C,CAAC6/B,EAAE,KAAK,CAAR,EAAW9/B,QAAX,CAAoB,EAApB,EAAwBC,QAAxB,CAAiC,CAAjC,EAAoC,GAApC,CAAlD;EACD;;AAtFkB;;AAyFrB,C,CAAC;;AAID,MAAM2gC,iBAAiB,GAAGn5C,MAAM,CAACivB,MAAP,CAAc;EACtChY,GAAG,EAAE,IADiC;EAEtCmiC,IAAI,EAAE,EAFgC;EAGtCC,QAAQ,EAAE1jC;AAH4B,CAAd,CAA1B;;AAKA,MAAM2jC,iBAAN,CAAwB;EACtB,CAACC,QAAD,GAAY,KAAZ;EACA,CAACC,WAAD,GAAe,IAAf;EACA,CAACC,OAAD,GAAW,IAAIl7B,GAAJ,EAAX;;EACArJ,WAAW,GAAG;IACZ,KAAKwkC,aAAL,GAAqB,IAArB;IACA,KAAKC,eAAL,GAAuB,IAAvB;IACA,KAAKC,kBAAL,GAA0B,IAA1B;EACD;;EACDC,QAAQ,CAAC/5C,GAAD,EAAMg6C,YAAN,EAAoB;IAC1B,MAAMplC,KAAK,GAAG,KAAK,CAAC+kC,OAAN,CAAct5C,GAAd,CAAkBL,GAAlB,CAAd;;IACA,IAAI4U,KAAK,KAAKiB,SAAd,EAAyB;MACvB,OAAOmkC,YAAP;IACD;;IACD,OAAO95C,MAAM,CAACwjC,MAAP,CAAcsW,YAAd,EAA4BplC,KAA5B,CAAP;EACD;;EACDg1B,WAAW,CAAC5pC,GAAD,EAAM;IACf,OAAO,KAAK,CAAC25C,OAAN,CAAct5C,GAAd,CAAkBL,GAAlB,CAAP;EACD;;EACDglB,MAAM,CAAChlB,GAAD,EAAM;IACV,KAAK,CAAC25C,OAAN,CAAcvoB,MAAd,CAAqBpxB,GAArB;;IACA,IAAI,KAAK,CAAC25C,OAAN,CAAchzB,IAAd,KAAuB,CAA3B,EAA8B;MAC5B,KAAKszB,aAAL;IACD;;IACD,IAAI,OAAO,KAAKH,kBAAZ,KAAmC,UAAvC,EAAmD;MACjD,KAAK,MAAMllC,KAAX,IAAoB,KAAK,CAAC+kC,OAAN,CAAc/c,MAAd,EAApB,EAA4C;QAC1C,IAAIhoB,KAAK,YAAYo3B,gBAArB,EAAuC;UACrC;QACD;MACF;;MACD,KAAK8N,kBAAL,CAAwB,IAAxB;IACD;EACF;;EACDpZ,QAAQ,CAAC1gC,GAAD,EAAM4U,KAAN,EAAa;IACnB,MAAMtU,GAAG,GAAG,KAAK,CAACq5C,OAAN,CAAct5C,GAAd,CAAkBL,GAAlB,CAAZ;IACA,IAAIy5C,QAAQ,GAAG,KAAf;;IACA,IAAIn5C,GAAG,KAAKuV,SAAZ,EAAuB;MACrB,KAAK,MAAM,CAACqkC,KAAD,EAAQC,GAAR,CAAX,IAA2Bj6C,MAAM,CAACsjC,OAAP,CAAe5uB,KAAf,CAA3B,EAAkD;QAChD,IAAItU,GAAG,CAAC45C,KAAD,CAAH,KAAeC,GAAnB,EAAwB;UACtBV,QAAQ,GAAG,IAAX;UACAn5C,GAAG,CAAC45C,KAAD,CAAH,GAAaC,GAAb;QACD;MACF;IACF,CAPD,MAOO;MACLV,QAAQ,GAAG,IAAX;MACA,KAAK,CAACE,OAAN,CAAc/0B,GAAd,CAAkB5kB,GAAlB,EAAuB4U,KAAvB;IACD;;IACD,IAAI6kC,QAAJ,EAAc;MACZ,KAAK,CAACW,WAAN;IACD;;IACD,IAAIxlC,KAAK,YAAYo3B,gBAAjB,IAAqC,OAAO,KAAK8N,kBAAZ,KAAmC,UAA5E,EAAwF;MACtF,KAAKA,kBAAL,CAAwBllC,KAAK,CAACQ,WAAN,CAAkBm5B,KAA1C;IACD;EACF;;EACD9X,GAAG,CAACz2B,GAAD,EAAM;IACP,OAAO,KAAK,CAAC25C,OAAN,CAAcljB,GAAd,CAAkBz2B,GAAlB,CAAP;EACD;;EACDq6C,MAAM,GAAG;IACP,OAAO,KAAK,CAACV,OAAN,CAAchzB,IAAd,GAAqB,CAArB,GAAyBzP,aAAa,CAAC,KAAK,CAACyiC,OAAP,CAAtC,GAAwD,IAA/D;EACD;;EACDW,MAAM,CAACh6C,GAAD,EAAM;IACV,KAAK,MAAM,CAACN,GAAD,EAAMm6C,GAAN,CAAX,IAAyBj6C,MAAM,CAACsjC,OAAP,CAAeljC,GAAf,CAAzB,EAA8C;MAC5C,KAAKogC,QAAL,CAAc1gC,GAAd,EAAmBm6C,GAAnB;IACD;EACF;;EACO,IAAJxzB,IAAI,GAAG;IACT,OAAO,KAAK,CAACgzB,OAAN,CAAchzB,IAArB;EACD;;EACD,CAACyzB,WAAW,GAAG;IACb,IAAI,CAAC,KAAK,CAACX,QAAX,EAAqB;MACnB,KAAK,CAACA,QAAN,GAAiB,IAAjB;;MACA,IAAI,OAAO,KAAKG,aAAZ,KAA8B,UAAlC,EAA8C;QAC5C,KAAKA,aAAL;MACD;IACF;EACF;;EACDK,aAAa,GAAG;IACd,IAAI,KAAK,CAACR,QAAV,EAAoB;MAClB,KAAK,CAACA,QAAN,GAAiB,KAAjB;;MACA,IAAI,OAAO,KAAKI,eAAZ,KAAgC,UAApC,EAAgD;QAC9C,KAAKA,eAAL;MACD;IACF;EACF;;EACQ,IAALU,KAAK,GAAG;IACV,OAAO,IAAIC,sBAAJ,CAA2B,IAA3B,CAAP;EACD;;EACe,IAAZC,YAAY,GAAG;IACjB,IAAI,KAAK,CAACd,OAAN,CAAchzB,IAAd,KAAuB,CAA3B,EAA8B;MAC5B,OAAO0yB,iBAAP;IACD;;IACD,MAAMliC,GAAG,GAAG,IAAIsH,GAAJ,EAAZ;IAAA,MACE66B,IAAI,GAAG,IAAIlB,cAAJ,EADT;IAAA,MAEEmB,QAAQ,GAAG,EAFb;IAGA,MAAMt4B,OAAO,GAAG/gB,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAhB;IACA,IAAIsjC,SAAS,GAAG,KAAhB;;IACA,KAAK,MAAM,CAAC16C,GAAD,EAAMm6C,GAAN,CAAX,IAAyB,KAAK,CAACR,OAA/B,EAAwC;MACtC,MAAMnX,UAAU,GAAG2X,GAAG,YAAYnO,gBAAf,GAAkCmO,GAAG,CAACjkB,SAAJ,CAAc,KAAd,EAAqBjV,OAArB,CAAlC,GAAkEk5B,GAArF;;MACA,IAAI3X,UAAJ,EAAgB;QACdrrB,GAAG,CAACyN,GAAJ,CAAQ5kB,GAAR,EAAawiC,UAAb;QACA8W,IAAI,CAACd,MAAL,CAAa,GAAEx4C,GAAI,IAAG2iC,IAAI,CAACC,SAAL,CAAeJ,UAAf,CAA2B,EAAjD;QACAkY,SAAS,KAAK,CAAC,CAAClY,UAAU,CAACpP,MAA3B;MACD;IACF;;IACD,IAAIsnB,SAAJ,EAAe;MACb,KAAK,MAAM9lC,KAAX,IAAoBuC,GAAG,CAACylB,MAAJ,EAApB,EAAkC;QAChC,IAAIhoB,KAAK,CAACwe,MAAV,EAAkB;UAChBmmB,QAAQ,CAAC9iC,IAAT,CAAc7B,KAAK,CAACwe,MAApB;QACD;MACF;IACF;;IACD,OAAOjc,GAAG,CAACwP,IAAJ,GAAW,CAAX,GAAe;MACpBxP,GADoB;MAEpBmiC,IAAI,EAAEA,IAAI,CAACF,SAAL,EAFc;MAGpBG;IAHoB,CAAf,GAIHF,iBAJJ;EAKD;;EACc,IAAXsB,WAAW,GAAG;IAChB,IAAIC,KAAK,GAAG,IAAZ;IACA,MAAMC,YAAY,GAAG,IAAIp8B,GAAJ,EAArB;;IACA,KAAK,MAAM7J,KAAX,IAAoB,KAAK,CAAC+kC,OAAN,CAAc/c,MAAd,EAApB,EAA4C;MAC1C,IAAI,EAAEhoB,KAAK,YAAYo3B,gBAAnB,CAAJ,EAA0C;QACxC;MACD;;MACD,MAAM2O,WAAW,GAAG/lC,KAAK,CAACgjC,kBAA1B;;MACA,IAAI,CAAC+C,WAAL,EAAkB;QAChB;MACD;;MACD,MAAM;QACJ32C;MADI,IAEF22C,WAFJ;;MAGA,IAAI,CAACE,YAAY,CAACpkB,GAAb,CAAiBzyB,IAAjB,CAAL,EAA6B;QAC3B62C,YAAY,CAACj2B,GAAb,CAAiB5gB,IAAjB,EAAuB9D,MAAM,CAACouC,cAAP,CAAsB15B,KAAtB,EAA6BQ,WAApD;MACD;;MACDwlC,KAAK,KAAK16C,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAV;MACA,MAAMD,GAAG,GAAGyjC,KAAK,CAAC52C,IAAD,CAAL,KAAgB,IAAIya,GAAJ,EAA5B;;MACA,KAAK,MAAM,CAACze,GAAD,EAAMm6C,GAAN,CAAX,IAAyBj6C,MAAM,CAACsjC,OAAP,CAAemX,WAAf,CAAzB,EAAsD;QACpD,IAAI36C,GAAG,KAAK,MAAZ,EAAoB;UAClB;QACD;;QACD,IAAI86C,QAAQ,GAAG3jC,GAAG,CAAC9W,GAAJ,CAAQL,GAAR,CAAf;;QACA,IAAI,CAAC86C,QAAL,EAAe;UACbA,QAAQ,GAAG,IAAIr8B,GAAJ,EAAX;UACAtH,GAAG,CAACyN,GAAJ,CAAQ5kB,GAAR,EAAa86C,QAAb;QACD;;QACD,MAAMC,KAAK,GAAGD,QAAQ,CAACz6C,GAAT,CAAa85C,GAAb,KAAqB,CAAnC;QACAW,QAAQ,CAACl2B,GAAT,CAAau1B,GAAb,EAAkBY,KAAK,GAAG,CAA1B;MACD;IACF;;IACD,KAAK,MAAM,CAAC/2C,IAAD,EAAO+qB,MAAP,CAAX,IAA6B8rB,YAA7B,EAA2C;MACzCD,KAAK,CAAC52C,IAAD,CAAL,GAAc+qB,MAAM,CAACisB,yBAAP,CAAiCJ,KAAK,CAAC52C,IAAD,CAAtC,CAAd;IACD;;IACD,OAAO42C,KAAP;EACD;;EACDK,gBAAgB,GAAG;IACjB,KAAK,CAACvB,WAAN,GAAoB,IAApB;EACD;;EACc,IAAXA,WAAW,GAAG;IAChB,IAAI,KAAK,CAACA,WAAV,EAAuB;MACrB,OAAO,KAAK,CAACA,WAAb;IACD;;IACD,MAAMwB,GAAG,GAAG,EAAZ;;IACA,KAAK,MAAMtmC,KAAX,IAAoB,KAAK,CAAC+kC,OAAN,CAAc/c,MAAd,EAApB,EAA4C;MAC1C,IAAI,EAAEhoB,KAAK,YAAYo3B,gBAAnB,KAAwC,CAACp3B,KAAK,CAACgwB,mBAA/C,IAAsE,CAAChwB,KAAK,CAACshB,SAAN,EAA3E,EAA8F;QAC5F;MACD;;MACDglB,GAAG,CAACzkC,IAAJ,CAAS7B,KAAK,CAACgwB,mBAAf;IACD;;IACD,OAAO,KAAK,CAAC8U,WAAN,GAAoB;MACzBwB,GAAG,EAAE,IAAIplB,GAAJ,CAAQolB,GAAR,CADoB;MAEzB5B,IAAI,EAAE4B,GAAG,CAACxkC,IAAJ,CAAS,GAAT;IAFmB,CAA3B;EAID;;AA5KqB;;AA8KxB,MAAM8jC,sBAAN,SAAqChB,iBAArC,CAAuD;EACrD,CAACiB,YAAD;;EACArlC,WAAW,CAAC+c,MAAD,EAAS;IAClB;IACA,MAAM;MACJhb,GADI;MAEJmiC,IAFI;MAGJC;IAHI,IAIFpnB,MAAM,CAACsoB,YAJX;IAKA,MAAMhwB,KAAK,GAAG0wB,eAAe,CAAChkC,GAAD,EAAMoiC,QAAQ,GAAG;MAC5CA;IAD4C,CAAH,GAEvC,IAFyB,CAA7B;IAGA,KAAK,CAACkB,YAAN,GAAqB;MACnBtjC,GAAG,EAAEsT,KADc;MAEnB6uB,IAFmB;MAGnBC;IAHmB,CAArB;EAKD;;EACQ,IAALgB,KAAK,GAAG;IACV7mC,WAAW,CAAC,8CAAD,CAAX;EACD;;EACe,IAAZ+mC,YAAY,GAAG;IACjB,OAAO,KAAK,CAACA,YAAb;EACD;;EACc,IAAXf,WAAW,GAAG;IAChB,OAAOj2C,MAAM,CAAC,IAAD,EAAO,aAAP,EAAsB;MACjCy3C,GAAG,EAAE,IAAIplB,GAAJ,EAD4B;MAEjCwjB,IAAI,EAAE;IAF2B,CAAtB,CAAb;EAID;;AA7BoD;;AAgCvD,C,CAAC;;AAED,MAAM8B,UAAN,CAAiB;EACf,CAACC,WAAD,GAAe,IAAIvlB,GAAJ,EAAf;;EACA1gB,WAAW,CAAC;IACV2N,aAAa,GAAGniB,UAAU,CAACgiB,QADjB;IAEV04B,YAAY,GAAG;EAFL,CAAD,EAGR;IACD,KAAK5zB,SAAL,GAAiB3E,aAAjB;IACA,KAAKw4B,eAAL,GAAuB,IAAIzlB,GAAJ,EAAvB;IACA,KAAKwlB,YAAL,GAAoB,IAApB;IACA,KAAKE,eAAL,GAAuB,EAAvB;IACA,KAAKC,cAAL,GAAsB,CAAtB;EACD;;EACDC,iBAAiB,CAACC,cAAD,EAAiB;IAChC,KAAKJ,eAAL,CAAqB1qB,GAArB,CAAyB8qB,cAAzB;;IACA,KAAKj0B,SAAL,CAAek0B,KAAf,CAAqB/qB,GAArB,CAAyB8qB,cAAzB;EACD;;EACDE,oBAAoB,CAACF,cAAD,EAAiB;IACnC,KAAKJ,eAAL,CAAqBnqB,MAArB,CAA4BuqB,cAA5B;;IACA,KAAKj0B,SAAL,CAAek0B,KAAf,CAAqBxqB,MAArB,CAA4BuqB,cAA5B;EACD;;EACDG,UAAU,CAACC,IAAD,EAAO;IACf,IAAI,CAAC,KAAKT,YAAV,EAAwB;MACtB,KAAKA,YAAL,GAAoB,KAAK5zB,SAAL,CAAetF,aAAf,CAA6B,OAA7B,CAApB;;MACA,KAAKsF,SAAL,CAAe2nB,eAAf,CAA+B2M,oBAA/B,CAAoD,MAApD,EAA4D,CAA5D,EAA+Dp4B,MAA/D,CAAsE,KAAK03B,YAA3E;IACD;;IACD,MAAMW,UAAU,GAAG,KAAKX,YAAL,CAAkBY,KAArC;IACAD,UAAU,CAACH,UAAX,CAAsBC,IAAtB,EAA4BE,UAAU,CAACE,QAAX,CAAoB5nC,MAAhD;EACD;;EACDsS,KAAK,GAAG;IACN,KAAK,MAAM80B,cAAX,IAA6B,KAAKJ,eAAlC,EAAmD;MACjD,KAAK7zB,SAAL,CAAek0B,KAAf,CAAqBxqB,MAArB,CAA4BuqB,cAA5B;IACD;;IACD,KAAKJ,eAAL,CAAqB10B,KAArB;IACA,KAAK,CAACw0B,WAAN,CAAkBx0B,KAAlB;;IACA,IAAI,KAAKy0B,YAAT,EAAuB;MACrB,KAAKA,YAAL,CAAkBt2B,MAAlB;MACA,KAAKs2B,YAAL,GAAoB,IAApB;IACD;EACF;;EACKc,cAAc,CAAC;IACnBC,cAAc,EAAEhpC,IADG;IAEnBipC;EAFmB,CAAD,EAGjB;IAAA;;IAAA;MACD,IAAI,CAACjpC,IAAD,IAAS,OAAI,CAAC,CAACgoC,WAAN,CAAkB5kB,GAAlB,CAAsBpjB,IAAI,CAACkpC,UAA3B,CAAb,EAAqD;QACnD;MACD;;MACD3oC,MAAM,CAAC,CAAC,OAAI,CAAC4oC,eAAP,EAAwB,mEAAxB,CAAN;;MACA,IAAI,OAAI,CAACC,yBAAT,EAAoC;QAClC,MAAM;UACJF,UADI;UAEJxpB,GAFI;UAGJ3P;QAHI,IAIF/P,IAJJ;QAKA,MAAMqpC,QAAQ,GAAG,IAAIC,QAAJ,CAAaJ,UAAb,EAAyBxpB,GAAzB,EAA8B3P,KAA9B,CAAjB;;QACA,OAAI,CAACs4B,iBAAL,CAAuBgB,QAAvB;;QACA,IAAI;UACF,MAAMA,QAAQ,CAACE,IAAT,EAAN;;UACA,OAAI,CAAC,CAACvB,WAAN,CAAkBxqB,GAAlB,CAAsB0rB,UAAtB;;UACAD,YAAY,GAAGjpC,IAAH,CAAZ;QACD,CAJD,CAIE,MAAM;UACNI,IAAI,CAAE,4BAA2BJ,IAAI,CAACwpC,YAAa,sDAA/C,CAAJ;;UACA,OAAI,CAAChB,oBAAL,CAA0Ba,QAA1B;QACD;;QACD;MACD;;MACDhpC,WAAW,CAAC,+DAAD,CAAX;IAvBC;EAwBF;;EACKmS,IAAI,CAACi3B,IAAD,EAAO;IAAA;;IAAA;MACf,IAAIA,IAAI,CAACC,QAAL,IAAiBD,IAAI,CAACE,WAAL,IAAoB,CAACF,IAAI,CAACT,cAA/C,EAA+D;QAC7D;MACD;;MACDS,IAAI,CAACC,QAAL,GAAgB,IAAhB;;MACA,IAAID,IAAI,CAACT,cAAT,EAAyB;QACvB,MAAM,OAAI,CAACD,cAAL,CAAoBU,IAApB,CAAN;QACA;MACD;;MACD,IAAI,OAAI,CAACL,yBAAT,EAAoC;QAClC,MAAMd,cAAc,GAAGmB,IAAI,CAACG,oBAAL,EAAvB;;QACA,IAAItB,cAAJ,EAAoB;UAClB,OAAI,CAACD,iBAAL,CAAuBC,cAAvB;;UACA,IAAI;YACF,MAAMA,cAAc,CAACuB,MAArB;UACD,CAFD,CAEE,OAAOhgC,EAAP,EAAW;YACXzJ,IAAI,CAAE,wBAAuBkoC,cAAc,CAACwB,MAAO,OAAMjgC,EAAG,IAAxD,CAAJ;YACA4/B,IAAI,CAACN,eAAL,GAAuB,IAAvB;YACA,MAAMt/B,EAAN;UACD;QACF;;QACD;MACD;;MACD,MAAM6+B,IAAI,GAAGe,IAAI,CAACM,kBAAL,EAAb;;MACA,IAAIrB,IAAJ,EAAU;QACR,OAAI,CAACD,UAAL,CAAgBC,IAAhB;;QACA,IAAI,OAAI,CAACsB,0BAAT,EAAqC;UACnC;QACD;;QACD,MAAM,IAAIl1B,OAAJ,CAAYC,OAAO,IAAI;UAC3B,MAAME,OAAO,GAAG,OAAI,CAACg1B,qBAAL,CAA2Bl1B,OAA3B,CAAhB;;UACA,OAAI,CAACm1B,qBAAL,CAA2BT,IAA3B,EAAiCx0B,OAAjC;QACD,CAHK,CAAN;MAID;IAjCc;EAkChB;;EAC4B,IAAzBm0B,yBAAyB,GAAG;IAC9B,MAAMe,QAAQ,GAAG,CAAC,CAAC,KAAK91B,SAAL,EAAgBk0B,KAAnC;IACA,OAAOn4C,MAAM,CAAC,IAAD,EAAO,2BAAP,EAAoC+5C,QAApC,CAAb;EACD;;EAC6B,IAA1BH,0BAA0B,GAAG;IAC/B,IAAII,SAAS,GAAG,KAAhB;;IACA,IAAI95C,QAAJ,EAAc;MACZ85C,SAAS,GAAG,IAAZ;IACD,CAFD,MAEO,IAAI,OAAO1lC,SAAP,KAAqB,WAArB,IAAoC,OAAOA,SAAS,EAAE2lC,SAAlB,KAAgC,QAApE,IAAgF,iCAAiCvyB,IAAjC,CAAsCpT,SAAS,CAAC2lC,SAAhD,CAApF,EAAgJ;MACrJD,SAAS,GAAG,IAAZ;IACD;;IACD,OAAOh6C,MAAM,CAAC,IAAD,EAAO,4BAAP,EAAqCg6C,SAArC,CAAb;EACD;;EACDH,qBAAqB,CAACvnB,QAAD,EAAW;IAC9B,SAAS4nB,eAAT,GAA2B;MACzB/pC,MAAM,CAAC,CAAC0U,OAAO,CAACs1B,IAAV,EAAgB,2CAAhB,CAAN;MACAt1B,OAAO,CAACs1B,IAAR,GAAe,IAAf;;MACA,OAAOpC,eAAe,CAACjnC,MAAhB,GAAyB,CAAzB,IAA8BinC,eAAe,CAAC,CAAD,CAAf,CAAmBoC,IAAxD,EAA8D;QAC5D,MAAMC,YAAY,GAAGrC,eAAe,CAACsC,KAAhB,EAArB;QACA9X,UAAU,CAAC6X,YAAY,CAAC9nB,QAAd,EAAwB,CAAxB,CAAV;MACD;IACF;;IACD,MAAM;MACJylB;IADI,IAEF,IAFJ;IAGA,MAAMlzB,OAAO,GAAG;MACds1B,IAAI,EAAE,KADQ;MAEdG,QAAQ,EAAEJ,eAFI;MAGd5nB;IAHc,CAAhB;IAKAylB,eAAe,CAAC/kC,IAAhB,CAAqB6R,OAArB;IACA,OAAOA,OAAP;EACD;;EACgB,IAAb01B,aAAa,GAAG;IAClB,MAAMC,QAAQ,GAAGC,IAAI,CAAC,yEAAyE,sEAAzE,GAAkJ,sEAAlJ,GAA2N,sEAA3N,GAAoS,sEAApS,GAA6W,sEAA7W,GAAsb,sEAAtb,GAA+f,sEAA/f,GAAwkB,sEAAxkB,GAAipB,sEAAjpB,GAA0tB,sEAA1tB,GAAmyB,sEAAnyB,GAA42B,sEAA52B,GAAq7B,sEAAr7B,GAA8/B,sEAA9/B,GAAukC,sEAAvkC,GAAgpC,sEAAhpC,GAAytC,sEAAztC,GAAkyC,sEAAlyC,GAA22C,sEAA32C,GAAo7C,sEAAp7C,GAA6/C,sEAA9/C,CAArB;IACA,OAAOz6C,MAAM,CAAC,IAAD,EAAO,eAAP,EAAwBw6C,QAAxB,CAAb;EACD;;EACDV,qBAAqB,CAACT,IAAD,EAAOx0B,OAAP,EAAgB;IACnC,SAAS61B,KAAT,CAAel1B,IAAf,EAAqBm1B,MAArB,EAA6B;MAC3B,OAAOn1B,IAAI,CAACnS,UAAL,CAAgBsnC,MAAhB,KAA2B,EAA3B,GAAgCn1B,IAAI,CAACnS,UAAL,CAAgBsnC,MAAM,GAAG,CAAzB,KAA+B,EAA/D,GAAoEn1B,IAAI,CAACnS,UAAL,CAAgBsnC,MAAM,GAAG,CAAzB,KAA+B,CAAnG,GAAuGn1B,IAAI,CAACnS,UAAL,CAAgBsnC,MAAM,GAAG,CAAzB,IAA8B,IAA5I;IACD;;IACD,SAASC,YAAT,CAAsBC,CAAtB,EAAyBF,MAAzB,EAAiCp5B,MAAjC,EAAyCu5B,MAAzC,EAAiD;MAC/C,MAAMC,MAAM,GAAGF,CAAC,CAACrzB,SAAF,CAAY,CAAZ,EAAemzB,MAAf,CAAf;MACA,MAAMK,MAAM,GAAGH,CAAC,CAACrzB,SAAF,CAAYmzB,MAAM,GAAGp5B,MAArB,CAAf;MACA,OAAOw5B,MAAM,GAAGD,MAAT,GAAkBE,MAAzB;IACD;;IACD,IAAItoC,CAAJ,EAAOgH,EAAP;;IACA,MAAM4D,MAAM,GAAG,KAAK2G,SAAL,CAAetF,aAAf,CAA6B,QAA7B,CAAf;;IACArB,MAAM,CAACF,KAAP,GAAe,CAAf;IACAE,MAAM,CAACD,MAAP,GAAgB,CAAhB;IACA,MAAMiN,GAAG,GAAGhN,MAAM,CAACG,UAAP,CAAkB,IAAlB,CAAZ;IACA,IAAIw9B,MAAM,GAAG,CAAb;;IACA,SAASC,WAAT,CAAqBxpC,IAArB,EAA2B4gB,QAA3B,EAAqC;MACnC,IAAI,EAAE2oB,MAAF,GAAW,EAAf,EAAmB;QACjBjrC,IAAI,CAAC,8BAAD,CAAJ;QACAsiB,QAAQ;QACR;MACD;;MACDhI,GAAG,CAAC+uB,IAAJ,GAAW,UAAU3nC,IAArB;MACA4Y,GAAG,CAAC6wB,QAAJ,CAAa,GAAb,EAAkB,CAAlB,EAAqB,EAArB;MACA,MAAMC,SAAS,GAAG9wB,GAAG,CAACmF,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAAlB;;MACA,IAAI2rB,SAAS,CAAC51B,IAAV,CAAe,CAAf,IAAoB,CAAxB,EAA2B;QACzB8M,QAAQ;QACR;MACD;;MACDiQ,UAAU,CAAC2Y,WAAW,CAAC94B,IAAZ,CAAiB,IAAjB,EAAuB1Q,IAAvB,EAA6B4gB,QAA7B,CAAD,CAAV;IACD;;IACD,MAAM0lB,cAAc,GAAI,KAAIz9B,IAAI,CAAC+N,GAAL,EAAW,GAAE,KAAK0vB,cAAL,EAAsB,EAA/D;IACA,IAAIxyB,IAAI,GAAG,KAAK+0B,aAAhB;IACA,MAAMc,cAAc,GAAG,GAAvB;IACA71B,IAAI,GAAGo1B,YAAY,CAACp1B,IAAD,EAAO61B,cAAP,EAAuBrD,cAAc,CAAClnC,MAAtC,EAA8CknC,cAA9C,CAAnB;IACA,MAAMsD,mBAAmB,GAAG,EAA5B;IACA,MAAMC,UAAU,GAAG,UAAnB;IACA,IAAIC,QAAQ,GAAGd,KAAK,CAACl1B,IAAD,EAAO81B,mBAAP,CAApB;;IACA,KAAK5oC,CAAC,GAAG,CAAJ,EAAOgH,EAAE,GAAGs+B,cAAc,CAAClnC,MAAf,GAAwB,CAAzC,EAA4C4B,CAAC,GAAGgH,EAAhD,EAAoDhH,CAAC,IAAI,CAAzD,EAA4D;MAC1D8oC,QAAQ,GAAGA,QAAQ,GAAGD,UAAX,GAAwBb,KAAK,CAAC1C,cAAD,EAAiBtlC,CAAjB,CAA7B,GAAmD,CAA9D;IACD;;IACD,IAAIA,CAAC,GAAGslC,cAAc,CAAClnC,MAAvB,EAA+B;MAC7B0qC,QAAQ,GAAGA,QAAQ,GAAGD,UAAX,GAAwBb,KAAK,CAAC1C,cAAc,GAAG,KAAlB,EAAyBtlC,CAAzB,CAA7B,GAA2D,CAAtE;IACD;;IACD8S,IAAI,GAAGo1B,YAAY,CAACp1B,IAAD,EAAO81B,mBAAP,EAA4B,CAA5B,EAA+BhoC,QAAQ,CAACkoC,QAAD,CAAvC,CAAnB;IACA,MAAMlrC,GAAG,GAAI,iCAAgCmrC,IAAI,CAACj2B,IAAD,CAAO,IAAxD;IACA,MAAM8yB,IAAI,GAAI,4BAA2BN,cAAe,SAAQ1nC,GAAI,GAApE;IACA,KAAK+nC,UAAL,CAAgBC,IAAhB;;IACA,MAAM54B,GAAG,GAAG,KAAKuE,SAAL,CAAetF,aAAf,CAA6B,KAA7B,CAAZ;;IACAe,GAAG,CAACC,KAAJ,CAAUC,UAAV,GAAuB,QAAvB;IACAF,GAAG,CAACC,KAAJ,CAAUvC,KAAV,GAAkBsC,GAAG,CAACC,KAAJ,CAAUtC,MAAV,GAAmB,MAArC;IACAqC,GAAG,CAACC,KAAJ,CAAUG,QAAV,GAAqB,UAArB;IACAJ,GAAG,CAACC,KAAJ,CAAUI,GAAV,GAAgBL,GAAG,CAACC,KAAJ,CAAUK,IAAV,GAAiB,KAAjC;;IACA,KAAK,MAAMtO,IAAX,IAAmB,CAAC2nC,IAAI,CAACP,UAAN,EAAkBd,cAAlB,CAAnB,EAAsD;MACpD,MAAM9tB,IAAI,GAAG,KAAKjG,SAAL,CAAetF,aAAf,CAA6B,MAA7B,CAAb;;MACAuL,IAAI,CAAC+c,WAAL,GAAmB,IAAnB;MACA/c,IAAI,CAACvK,KAAL,CAAW+7B,UAAX,GAAwBhqC,IAAxB;MACAgO,GAAG,CAACS,MAAJ,CAAW+J,IAAX;IACD;;IACD,KAAKjG,SAAL,CAAe7D,IAAf,CAAoBD,MAApB,CAA2BT,GAA3B;;IACAw7B,WAAW,CAAClD,cAAD,EAAiB,MAAM;MAChCt4B,GAAG,CAAC6B,MAAJ;MACAsD,OAAO,CAACy1B,QAAR;IACD,CAHU,CAAX;EAID;;AA1Mc;;AA4MjB,MAAMqB,cAAN,CAAqB;EACnBhqC,WAAW,CAACiqC,cAAD,EAAiB;IAC1B7C,eAAe,GAAG,KADQ;IAE1B8C,WAAW,GAAG;EAFY,CAAjB,EAGR;IACD,KAAKC,cAAL,GAAsBr/C,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAtB;;IACA,KAAK,MAAMjB,CAAX,IAAgBkpC,cAAhB,EAAgC;MAC9B,KAAKlpC,CAAL,IAAUkpC,cAAc,CAAClpC,CAAD,CAAxB;IACD;;IACD,KAAKqmC,eAAL,GAAuBA,eAAe,KAAK,IAA3C;IACA,KAAKF,YAAL,GAAoBgD,WAApB;EACD;;EACDrC,oBAAoB,GAAG;IACrB,IAAI,CAAC,KAAKh0B,IAAN,IAAc,KAAKuzB,eAAvB,EAAwC;MACtC,OAAO,IAAP;IACD;;IACD,IAAIb,cAAJ;;IACA,IAAI,CAAC,KAAK6D,WAAV,EAAuB;MACrB7D,cAAc,GAAG,IAAIgB,QAAJ,CAAa,KAAKJ,UAAlB,EAA8B,KAAKtzB,IAAnC,EAAyC,EAAzC,CAAjB;IACD,CAFD,MAEO;MACL,MAAMw2B,GAAG,GAAG;QACVC,MAAM,EAAE,KAAKF,WAAL,CAAiBG;MADf,CAAZ;;MAGA,IAAI,KAAKH,WAAL,CAAiBI,WAArB,EAAkC;QAChCH,GAAG,CAACr8B,KAAJ,GAAa,WAAU,KAAKo8B,WAAL,CAAiBI,WAAY,KAApD;MACD;;MACDjE,cAAc,GAAG,IAAIgB,QAAJ,CAAa,KAAK6C,WAAL,CAAiBL,UAA9B,EAA0C,KAAKl2B,IAA/C,EAAqDw2B,GAArD,CAAjB;IACD;;IACD,KAAKnD,YAAL,GAAoB,IAApB;IACA,OAAOX,cAAP;EACD;;EACDyB,kBAAkB,GAAG;IACnB,IAAI,CAAC,KAAKn0B,IAAN,IAAc,KAAKuzB,eAAvB,EAAwC;MACtC,OAAO,IAAP;IACD;;IACD,MAAMvzB,IAAI,GAAGtT,aAAa,CAAC,KAAKsT,IAAN,CAA1B;IACA,MAAMlV,GAAG,GAAI,YAAW,KAAK8rC,QAAS,WAAUX,IAAI,CAACj2B,IAAD,CAAO,IAA3D;IACA,IAAI8yB,IAAJ;;IACA,IAAI,CAAC,KAAKyD,WAAV,EAAuB;MACrBzD,IAAI,GAAI,4BAA2B,KAAKQ,UAAW,SAAQxoC,GAAI,GAA/D;IACD,CAFD,MAEO;MACL,IAAI0rC,GAAG,GAAI,gBAAe,KAAKD,WAAL,CAAiBG,UAAW,GAAtD;;MACA,IAAI,KAAKH,WAAL,CAAiBI,WAArB,EAAkC;QAChCH,GAAG,IAAK,uBAAsB,KAAKD,WAAL,CAAiBI,WAAY,MAA3D;MACD;;MACD7D,IAAI,GAAI,4BAA2B,KAAKyD,WAAL,CAAiBL,UAAW,KAAIM,GAAI,OAAM1rC,GAAI,GAAjF;IACD;;IACD,KAAKuoC,YAAL,GAAoB,IAApB,EAA0BvoC,GAA1B;IACA,OAAOgoC,IAAP;EACD;;EACD+D,gBAAgB,CAACC,IAAD,EAAOC,SAAP,EAAkB;IAChC,IAAI,KAAKT,cAAL,CAAoBS,SAApB,MAAmCnqC,SAAvC,EAAkD;MAChD,OAAO,KAAK0pC,cAAL,CAAoBS,SAApB,CAAP;IACD;;IACD,IAAIC,IAAJ;;IACA,IAAI;MACFA,IAAI,GAAGF,IAAI,CAAC1/C,GAAL,CAAS,KAAKk8C,UAAL,GAAkB,QAAlB,GAA6ByD,SAAtC,CAAP;IACD,CAFD,CAEE,OAAO9iC,EAAP,EAAW;MACXzJ,IAAI,CAAE,2CAA0CyJ,EAAG,IAA/C,CAAJ;IACD;;IACD,IAAI,CAAC5E,KAAK,CAACyqB,OAAN,CAAckd,IAAd,CAAD,IAAwBA,IAAI,CAAC1rC,MAAL,KAAgB,CAA5C,EAA+C;MAC7C,OAAO,KAAKgrC,cAAL,CAAoBS,SAApB,IAAiC,UAAU3lC,CAAV,EAAasM,IAAb,EAAmB,CAAE,CAA7D;IACD;;IACD,MAAMiO,QAAQ,GAAG,EAAjB;;IACA,KAAK,IAAIze,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAG8iC,IAAI,CAAC1rC,MAA1B,EAAkC4B,CAAC,GAAGgH,EAAtC,GAA2C;MACzC,QAAQ8iC,IAAI,CAAC9pC,CAAC,EAAF,CAAZ;QACE,KAAKiJ,aAAa,CAACC,eAAnB;UACE;YACE,MAAM,CAACjF,CAAD,EAAItB,CAAJ,EAAOuB,CAAP,EAAUxa,CAAV,EAAausB,CAAb,EAAgB4B,CAAhB,IAAqBiyB,IAAI,CAACpmC,KAAL,CAAW1D,CAAX,EAAcA,CAAC,GAAG,CAAlB,CAA3B;YACAye,QAAQ,CAACne,IAAT,CAAcsX,GAAG,IAAIA,GAAG,CAACmyB,aAAJ,CAAkB9lC,CAAlB,EAAqBtB,CAArB,EAAwBuB,CAAxB,EAA2Bxa,CAA3B,EAA8BusB,CAA9B,EAAiC4B,CAAjC,CAArB;YACA7X,CAAC,IAAI,CAAL;UACD;UACD;;QACF,KAAKiJ,aAAa,CAACE,OAAnB;UACE;YACE,MAAM,CAAClF,CAAD,EAAItB,CAAJ,IAASmnC,IAAI,CAACpmC,KAAL,CAAW1D,CAAX,EAAcA,CAAC,GAAG,CAAlB,CAAf;YACAye,QAAQ,CAACne,IAAT,CAAcsX,GAAG,IAAIA,GAAG,CAAChgB,MAAJ,CAAWqM,CAAX,EAActB,CAAd,CAArB;YACA3C,CAAC,IAAI,CAAL;UACD;UACD;;QACF,KAAKiJ,aAAa,CAACG,OAAnB;UACE;YACE,MAAM,CAACnF,CAAD,EAAItB,CAAJ,IAASmnC,IAAI,CAACpmC,KAAL,CAAW1D,CAAX,EAAcA,CAAC,GAAG,CAAlB,CAAf;YACAye,QAAQ,CAACne,IAAT,CAAcsX,GAAG,IAAIA,GAAG,CAAC/f,MAAJ,CAAWoM,CAAX,EAActB,CAAd,CAArB;YACA3C,CAAC,IAAI,CAAL;UACD;UACD;;QACF,KAAKiJ,aAAa,CAACI,kBAAnB;UACE;YACE,MAAM,CAACpF,CAAD,EAAItB,CAAJ,EAAOuB,CAAP,EAAUxa,CAAV,IAAeogD,IAAI,CAACpmC,KAAL,CAAW1D,CAAX,EAAcA,CAAC,GAAG,CAAlB,CAArB;YACAye,QAAQ,CAACne,IAAT,CAAcsX,GAAG,IAAIA,GAAG,CAACoyB,gBAAJ,CAAqB/lC,CAArB,EAAwBtB,CAAxB,EAA2BuB,CAA3B,EAA8Bxa,CAA9B,CAArB;YACAsW,CAAC,IAAI,CAAL;UACD;UACD;;QACF,KAAKiJ,aAAa,CAACK,OAAnB;UACEmV,QAAQ,CAACne,IAAT,CAAcsX,GAAG,IAAIA,GAAG,CAAClgB,OAAJ,EAArB;UACA;;QACF,KAAKuR,aAAa,CAACza,IAAnB;UACEiwB,QAAQ,CAACne,IAAT,CAAcsX,GAAG,IAAIA,GAAG,CAACngB,IAAJ,EAArB;UACA;;QACF,KAAKwR,aAAa,CAACM,KAAnB;UACE9L,MAAM,CAACghB,QAAQ,CAACrgB,MAAT,KAAoB,CAArB,EAAwB,oDAAxB,CAAN;UACA;;QACF,KAAK6K,aAAa,CAACO,SAAnB;UACE;YACE,MAAM,CAACvF,CAAD,EAAItB,CAAJ,EAAOuB,CAAP,EAAUxa,CAAV,EAAausB,CAAb,EAAgB4B,CAAhB,IAAqBiyB,IAAI,CAACpmC,KAAL,CAAW1D,CAAX,EAAcA,CAAC,GAAG,CAAlB,CAA3B;YACAye,QAAQ,CAACne,IAAT,CAAcsX,GAAG,IAAIA,GAAG,CAACjgB,SAAJ,CAAcsM,CAAd,EAAiBtB,CAAjB,EAAoBuB,CAApB,EAAuBxa,CAAvB,EAA0BusB,CAA1B,EAA6B4B,CAA7B,CAArB;YACA7X,CAAC,IAAI,CAAL;UACD;UACD;;QACF,KAAKiJ,aAAa,CAACQ,SAAnB;UACE;YACE,MAAM,CAACxF,CAAD,EAAItB,CAAJ,IAASmnC,IAAI,CAACpmC,KAAL,CAAW1D,CAAX,EAAcA,CAAC,GAAG,CAAlB,CAAf;YACAye,QAAQ,CAACne,IAAT,CAAcsX,GAAG,IAAIA,GAAG,CAACwiB,SAAJ,CAAcn2B,CAAd,EAAiBtB,CAAjB,CAArB;YACA3C,CAAC,IAAI,CAAL;UACD;UACD;MAnDJ;IAqDD;;IACD,OAAO,KAAKopC,cAAL,CAAoBS,SAApB,IAAiC,SAASI,WAAT,CAAqBryB,GAArB,EAA0BpH,IAA1B,EAAgC;MACtEiO,QAAQ,CAAC,CAAD,CAAR,CAAY7G,GAAZ;MACA6G,QAAQ,CAAC,CAAD,CAAR,CAAY7G,GAAZ;MACAA,GAAG,CAACxE,KAAJ,CAAU5C,IAAV,EAAgB,CAACA,IAAjB;;MACA,KAAK,IAAIxQ,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGyX,QAAQ,CAACrgB,MAA9B,EAAsC4B,CAAC,GAAGgH,EAA1C,EAA8ChH,CAAC,EAA/C,EAAmD;QACjDye,QAAQ,CAACze,CAAD,CAAR,CAAY4X,GAAZ;MACD;IACF,CAPD;EAQD;;AA/HkB;;AAkIrB,C,CAAC;;AAGD,IAAIpqB,QAAJ,EAAc;EACZ,IAAI08C,iBAAiB,GAAGl4B,OAAO,CAACm4B,aAAR,EAAxB;EACA,IAAIC,UAAU,GAAG,IAAjB;;EACA,MAAMC,YAAY;IAAA,8BAAG,aAAY;MAC/B,MAAMC,EAAE,SAAS;MAAQ;MAAuB,IAA/B,CAAjB;MAAA,MACEC,IAAI,SAAS;MAAQ;MAAuB,MAA/B,CADf;MAAA,MAEEC,KAAK,SAAS;MAAQ;MAAuB,OAA/B,CAFhB;MAAA,MAGE5sC,GAAG,SAAS;MAAQ;MAAuB,KAA/B,CAHd;MAIA,IAAIgN,MAAJ,EAAY6/B,MAAZ;MACA,OAAO,IAAIniC,GAAJ,CAAQve,MAAM,CAACsjC,OAAP,CAAe;QAC5Bid,EAD4B;QAE5BC,IAF4B;QAG5BC,KAH4B;QAI5B5sC,GAJ4B;QAK5BgN,MAL4B;QAM5B6/B;MAN4B,CAAf,CAAR,CAAP;IAQD,CAdiB;;IAAA,gBAAZJ,YAAY;MAAA;IAAA;EAAA,GAAlB;;EAeAA,YAAY,GAAGx3B,IAAf,CAAoB7R,GAAG,IAAI;IACzBopC,UAAU,GAAGppC,GAAb;IACAkpC,iBAAiB,CAACj4B,OAAlB;EACD,CAHD,EAGGxG,MAAM,IAAI;IACXnO,IAAI,CAAE,iBAAgBmO,MAAO,EAAzB,CAAJ;IACA2+B,UAAU,GAAG,IAAI9hC,GAAJ,EAAb;IACA4hC,iBAAiB,CAACj4B,OAAlB;EACD,CAPD;AAQD;;AACD,MAAMy4B,YAAN,CAAmB;EACC,WAAP7tB,OAAO,GAAG;IACnB,OAAOqtB,iBAAiB,CAACrtB,OAAzB;EACD;;EACS,OAAH3yB,GAAG,CAAC8U,IAAD,EAAO;IACf,OAAOorC,UAAU,EAAElgD,GAAZ,CAAgB8U,IAAhB,CAAP;EACD;;AANgB;;AAQnB,MAAM2rC,oBAAoB,GAAG,UAAU/sC,GAAV,EAAe;EAC1C,MAAM0sC,EAAE,GAAGI,YAAY,CAACxgD,GAAb,CAAiB,IAAjB,CAAX;EACA,OAAOogD,EAAE,CAACM,QAAH,CAAYC,QAAZ,CAAqBjtC,GAArB,EAA0BiV,IAA1B,CAA+BC,IAAI,IAAI,IAAIpS,UAAJ,CAAeoS,IAAf,CAAvC,CAAP;AACD,CAHD;;AAIA,MAAMg4B,iBAAN,SAAgCphC,iBAAhC,CAAkD;;AAClD,MAAMqhC,iBAAN,SAAgCvgC,iBAAhC,CAAkD;EAChDK,aAAa,CAACH,KAAD,EAAQC,MAAR,EAAgB;IAC3B,MAAMC,MAAM,GAAG8/B,YAAY,CAACxgD,GAAb,CAAiB,QAAjB,CAAf;IACA,OAAO0gB,MAAM,CAACogC,YAAP,CAAoBtgC,KAApB,EAA2BC,MAA3B,CAAP;EACD;;AAJ+C;;AAMlD,MAAMsgC,qBAAN,SAAoC9/B,qBAApC,CAA0D;EACxDI,UAAU,CAAC3N,GAAD,EAAM0N,eAAN,EAAuB;IAC/B,OAAOq/B,oBAAoB,CAAC/sC,GAAD,CAApB,CAA0BiV,IAA1B,CAA+BC,IAAI,KAAK;MAC7CC,QAAQ,EAAED,IADmC;MAE7CxH;IAF6C,CAAL,CAAnC,CAAP;EAID;;AANuD;;AAQ1D,MAAM4/B,2BAAN,SAA0Cx/B,2BAA1C,CAAsE;EACpEH,UAAU,CAAC3N,GAAD,EAAM;IACd,OAAO+sC,oBAAoB,CAAC/sC,GAAD,CAA3B;EACD;;AAHmE;;AAMtE,C,CAAC;;AAGD,MAAMutC,QAAQ,GAAG;EACft6C,IAAI,EAAE,MADS;EAEfC,MAAM,EAAE,QAFO;EAGfs6C,OAAO,EAAE;AAHM,CAAjB;;AAKA,SAASC,gBAAT,CAA0BzzB,GAA1B,EAA+B0zB,IAA/B,EAAqC;EACnC,IAAI,CAACA,IAAL,EAAW;IACT;EACD;;EACD,MAAM5gC,KAAK,GAAG4gC,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAA5B;EACA,MAAM3gC,MAAM,GAAG2gC,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAA7B;EACA,MAAMC,MAAM,GAAG,IAAIC,MAAJ,EAAf;EACAD,MAAM,CAAC9mC,IAAP,CAAY6mC,IAAI,CAAC,CAAD,CAAhB,EAAqBA,IAAI,CAAC,CAAD,CAAzB,EAA8B5gC,KAA9B,EAAqCC,MAArC;EACAiN,GAAG,CAAChf,IAAJ,CAAS2yC,MAAT;AACD;;AACD,MAAME,kBAAN,CAAyB;EACvBC,UAAU,GAAG;IACXnuC,WAAW,CAAC,sCAAD,CAAX;EACD;;AAHsB;;AAKzB,MAAMouC,yBAAN,SAAwCF,kBAAxC,CAA2D;EACzDxsC,WAAW,CAAC2sC,EAAD,EAAK;IACd;IACA,KAAKxT,KAAL,GAAawT,EAAE,CAAC,CAAD,CAAf;IACA,KAAKC,KAAL,GAAaD,EAAE,CAAC,CAAD,CAAf;IACA,KAAKE,WAAL,GAAmBF,EAAE,CAAC,CAAD,CAArB;IACA,KAAKG,GAAL,GAAWH,EAAE,CAAC,CAAD,CAAb;IACA,KAAKI,GAAL,GAAWJ,EAAE,CAAC,CAAD,CAAb;IACA,KAAKK,GAAL,GAAWL,EAAE,CAAC,CAAD,CAAb;IACA,KAAKM,GAAL,GAAWN,EAAE,CAAC,CAAD,CAAb;IACA,KAAKO,MAAL,GAAc,IAAd;EACD;;EACDC,eAAe,CAACx0B,GAAD,EAAM;IACnB,IAAIy0B,IAAJ;;IACA,IAAI,KAAKjU,KAAL,KAAe,OAAnB,EAA4B;MAC1BiU,IAAI,GAAGz0B,GAAG,CAAC00B,oBAAJ,CAAyB,KAAKP,GAAL,CAAS,CAAT,CAAzB,EAAsC,KAAKA,GAAL,CAAS,CAAT,CAAtC,EAAmD,KAAKC,GAAL,CAAS,CAAT,CAAnD,EAAgE,KAAKA,GAAL,CAAS,CAAT,CAAhE,CAAP;IACD,CAFD,MAEO,IAAI,KAAK5T,KAAL,KAAe,QAAnB,EAA6B;MAClCiU,IAAI,GAAGz0B,GAAG,CAAC20B,oBAAJ,CAAyB,KAAKR,GAAL,CAAS,CAAT,CAAzB,EAAsC,KAAKA,GAAL,CAAS,CAAT,CAAtC,EAAmD,KAAKE,GAAxD,EAA6D,KAAKD,GAAL,CAAS,CAAT,CAA7D,EAA0E,KAAKA,GAAL,CAAS,CAAT,CAA1E,EAAuF,KAAKE,GAA5F,CAAP;IACD;;IACD,KAAK,MAAMM,SAAX,IAAwB,KAAKV,WAA7B,EAA0C;MACxCO,IAAI,CAACI,YAAL,CAAkBD,SAAS,CAAC,CAAD,CAA3B,EAAgCA,SAAS,CAAC,CAAD,CAAzC;IACD;;IACD,OAAOH,IAAP;EACD;;EACDX,UAAU,CAAC9zB,GAAD,EAAM80B,KAAN,EAAaC,OAAb,EAAsBC,QAAtB,EAAgC;IACxC,IAAIC,OAAJ;;IACA,IAAID,QAAQ,KAAKzB,QAAQ,CAACr6C,MAAtB,IAAgC87C,QAAQ,KAAKzB,QAAQ,CAACt6C,IAA1D,EAAgE;MAC9D,MAAMi8C,SAAS,GAAGJ,KAAK,CAACK,OAAN,CAAcC,yBAAd,CAAwCJ,QAAxC,EAAkDj1B,mBAAmB,CAACC,GAAD,CAArE,KAA+E,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAjG;MACA,MAAMlN,KAAK,GAAGxK,IAAI,CAAC+sC,IAAL,CAAUH,SAAS,CAAC,CAAD,CAAT,GAAeA,SAAS,CAAC,CAAD,CAAlC,KAA0C,CAAxD;MACA,MAAMniC,MAAM,GAAGzK,IAAI,CAAC+sC,IAAL,CAAUH,SAAS,CAAC,CAAD,CAAT,GAAeA,SAAS,CAAC,CAAD,CAAlC,KAA0C,CAAzD;MACA,MAAMI,SAAS,GAAGR,KAAK,CAACS,cAAN,CAAqBC,SAArB,CAA+B,SAA/B,EAA0C1iC,KAA1C,EAAiDC,MAAjD,EAAyD,IAAzD,CAAlB;MACA,MAAM0iC,MAAM,GAAGH,SAAS,CAACpiC,OAAzB;MACAuiC,MAAM,CAACC,SAAP,CAAiB,CAAjB,EAAoB,CAApB,EAAuBD,MAAM,CAACziC,MAAP,CAAcF,KAArC,EAA4C2iC,MAAM,CAACziC,MAAP,CAAcD,MAA1D;MACA0iC,MAAM,CAACE,SAAP;MACAF,MAAM,CAAC5oC,IAAP,CAAY,CAAZ,EAAe,CAAf,EAAkB4oC,MAAM,CAACziC,MAAP,CAAcF,KAAhC,EAAuC2iC,MAAM,CAACziC,MAAP,CAAcD,MAArD;MACA0iC,MAAM,CAACjT,SAAP,CAAiB,CAAC0S,SAAS,CAAC,CAAD,CAA3B,EAAgC,CAACA,SAAS,CAAC,CAAD,CAA1C;MACAH,OAAO,GAAGpgD,IAAI,CAACoL,SAAL,CAAeg1C,OAAf,EAAwB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAaG,SAAS,CAAC,CAAD,CAAtB,EAA2BA,SAAS,CAAC,CAAD,CAApC,CAAxB,CAAV;MACAO,MAAM,CAAC11C,SAAP,CAAiB,GAAG+0C,KAAK,CAACc,aAA1B;;MACA,IAAI,KAAKrB,MAAT,EAAiB;QACfkB,MAAM,CAAC11C,SAAP,CAAiB,GAAG,KAAKw0C,MAAzB;MACD;;MACDd,gBAAgB,CAACgC,MAAD,EAAS,KAAKxB,KAAd,CAAhB;MACAwB,MAAM,CAACI,SAAP,GAAmB,KAAKrB,eAAL,CAAqBiB,MAArB,CAAnB;MACAA,MAAM,CAACh1C,IAAP;MACAw0C,OAAO,GAAGj1B,GAAG,CAAC81B,aAAJ,CAAkBR,SAAS,CAACtiC,MAA5B,EAAoC,WAApC,CAAV;MACA,MAAM+iC,SAAS,GAAG,IAAIC,SAAJ,CAAcjB,OAAd,CAAlB;MACAE,OAAO,CAACgB,YAAR,CAAqBF,SAArB;IACD,CArBD,MAqBO;MACLtC,gBAAgB,CAACzzB,GAAD,EAAM,KAAKi0B,KAAX,CAAhB;MACAgB,OAAO,GAAG,KAAKT,eAAL,CAAqBx0B,GAArB,CAAV;IACD;;IACD,OAAOi1B,OAAP;EACD;;AApDwD;;AAsD3D,SAASiB,YAAT,CAAsBh7B,IAAtB,EAA4BhI,OAA5B,EAAqCtH,EAArC,EAAyCC,EAAzC,EAA6CE,EAA7C,EAAiDoqC,EAAjD,EAAqDC,EAArD,EAAyDC,EAAzD,EAA6D;EAC3D,MAAMC,MAAM,GAAGpjC,OAAO,CAACojC,MAAvB;EAAA,MACE32B,MAAM,GAAGzM,OAAO,CAACyM,MADnB;EAEA,MAAM9X,KAAK,GAAGqT,IAAI,CAACA,IAAnB;EAAA,MACEq7B,OAAO,GAAGr7B,IAAI,CAACpI,KAAL,GAAa,CADzB;EAEA,IAAI0jC,GAAJ;;EACA,IAAIF,MAAM,CAAC1qC,EAAE,GAAG,CAAN,CAAN,GAAiB0qC,MAAM,CAACzqC,EAAE,GAAG,CAAN,CAA3B,EAAqC;IACnC2qC,GAAG,GAAG5qC,EAAN;IACAA,EAAE,GAAGC,EAAL;IACAA,EAAE,GAAG2qC,GAAL;IACAA,GAAG,GAAGL,EAAN;IACAA,EAAE,GAAGC,EAAL;IACAA,EAAE,GAAGI,GAAL;EACD;;EACD,IAAIF,MAAM,CAACzqC,EAAE,GAAG,CAAN,CAAN,GAAiByqC,MAAM,CAACvqC,EAAE,GAAG,CAAN,CAA3B,EAAqC;IACnCyqC,GAAG,GAAG3qC,EAAN;IACAA,EAAE,GAAGE,EAAL;IACAA,EAAE,GAAGyqC,GAAL;IACAA,GAAG,GAAGJ,EAAN;IACAA,EAAE,GAAGC,EAAL;IACAA,EAAE,GAAGG,GAAL;EACD;;EACD,IAAIF,MAAM,CAAC1qC,EAAE,GAAG,CAAN,CAAN,GAAiB0qC,MAAM,CAACzqC,EAAE,GAAG,CAAN,CAA3B,EAAqC;IACnC2qC,GAAG,GAAG5qC,EAAN;IACAA,EAAE,GAAGC,EAAL;IACAA,EAAE,GAAG2qC,GAAL;IACAA,GAAG,GAAGL,EAAN;IACAA,EAAE,GAAGC,EAAL;IACAA,EAAE,GAAGI,GAAL;EACD;;EACD,MAAMjpC,EAAE,GAAG,CAAC+oC,MAAM,CAAC1qC,EAAD,CAAN,GAAasH,OAAO,CAACwI,OAAtB,IAAiCxI,OAAO,CAACujC,MAApD;EACA,MAAM9oC,EAAE,GAAG,CAAC2oC,MAAM,CAAC1qC,EAAE,GAAG,CAAN,CAAN,GAAiBsH,OAAO,CAACyI,OAA1B,IAAqCzI,OAAO,CAACwjC,MAAxD;EACA,MAAMlpC,EAAE,GAAG,CAAC8oC,MAAM,CAACzqC,EAAD,CAAN,GAAaqH,OAAO,CAACwI,OAAtB,IAAiCxI,OAAO,CAACujC,MAApD;EACA,MAAM7oC,EAAE,GAAG,CAAC0oC,MAAM,CAACzqC,EAAE,GAAG,CAAN,CAAN,GAAiBqH,OAAO,CAACyI,OAA1B,IAAqCzI,OAAO,CAACwjC,MAAxD;EACA,MAAMjpC,EAAE,GAAG,CAAC6oC,MAAM,CAACvqC,EAAD,CAAN,GAAamH,OAAO,CAACwI,OAAtB,IAAiCxI,OAAO,CAACujC,MAApD;EACA,MAAM5oC,EAAE,GAAG,CAACyoC,MAAM,CAACvqC,EAAE,GAAG,CAAN,CAAN,GAAiBmH,OAAO,CAACyI,OAA1B,IAAqCzI,OAAO,CAACwjC,MAAxD;;EACA,IAAI/oC,EAAE,IAAIE,EAAV,EAAc;IACZ;EACD;;EACD,MAAM8oC,GAAG,GAAGh3B,MAAM,CAACw2B,EAAD,CAAlB;EAAA,MACES,GAAG,GAAGj3B,MAAM,CAACw2B,EAAE,GAAG,CAAN,CADd;EAAA,MAEEU,GAAG,GAAGl3B,MAAM,CAACw2B,EAAE,GAAG,CAAN,CAFd;EAGA,MAAMW,GAAG,GAAGn3B,MAAM,CAACy2B,EAAD,CAAlB;EAAA,MACEW,GAAG,GAAGp3B,MAAM,CAACy2B,EAAE,GAAG,CAAN,CADd;EAAA,MAEEY,GAAG,GAAGr3B,MAAM,CAACy2B,EAAE,GAAG,CAAN,CAFd;EAGA,MAAMa,GAAG,GAAGt3B,MAAM,CAAC02B,EAAD,CAAlB;EAAA,MACEa,GAAG,GAAGv3B,MAAM,CAAC02B,EAAE,GAAG,CAAN,CADd;EAAA,MAEEc,GAAG,GAAGx3B,MAAM,CAAC02B,EAAE,GAAG,CAAN,CAFd;EAGA,MAAMe,IAAI,GAAG9uC,IAAI,CAAC0P,KAAL,CAAWrK,EAAX,CAAb;EAAA,MACE0pC,IAAI,GAAG/uC,IAAI,CAAC0P,KAAL,CAAWnK,EAAX,CADT;EAEA,IAAIypC,EAAJ,EAAQC,GAAR,EAAaC,GAAb,EAAkBC,GAAlB;EACA,IAAIC,EAAJ,EAAQC,GAAR,EAAaC,GAAb,EAAkBC,GAAlB;;EACA,KAAK,IAAI1pC,CAAC,GAAGipC,IAAb,EAAmBjpC,CAAC,IAAIkpC,IAAxB,EAA8BlpC,CAAC,EAA/B,EAAmC;IACjC,IAAIA,CAAC,GAAGP,EAAR,EAAY;MACV,MAAM8K,CAAC,GAAGvK,CAAC,GAAGR,EAAJ,GAAS,CAAT,GAAa,CAACA,EAAE,GAAGQ,CAAN,KAAYR,EAAE,GAAGC,EAAjB,CAAvB;MACA0pC,EAAE,GAAG/pC,EAAE,GAAG,CAACA,EAAE,GAAGC,EAAN,IAAYkL,CAAtB;MACA6+B,GAAG,GAAGZ,GAAG,GAAG,CAACA,GAAG,GAAGG,GAAP,IAAcp+B,CAA1B;MACA8+B,GAAG,GAAGZ,GAAG,GAAG,CAACA,GAAG,GAAGG,GAAP,IAAcr+B,CAA1B;MACA++B,GAAG,GAAGZ,GAAG,GAAG,CAACA,GAAG,GAAGG,GAAP,IAAct+B,CAA1B;IACD,CAND,MAMO;MACL,IAAIA,CAAJ;;MACA,IAAIvK,CAAC,GAAGN,EAAR,EAAY;QACV6K,CAAC,GAAG,CAAJ;MACD,CAFD,MAEO,IAAI9K,EAAE,KAAKC,EAAX,EAAe;QACpB6K,CAAC,GAAG,CAAJ;MACD,CAFM,MAEA;QACLA,CAAC,GAAG,CAAC9K,EAAE,GAAGO,CAAN,KAAYP,EAAE,GAAGC,EAAjB,CAAJ;MACD;;MACDypC,EAAE,GAAG9pC,EAAE,GAAG,CAACA,EAAE,GAAGC,EAAN,IAAYiL,CAAtB;MACA6+B,GAAG,GAAGT,GAAG,GAAG,CAACA,GAAG,GAAGG,GAAP,IAAcv+B,CAA1B;MACA8+B,GAAG,GAAGT,GAAG,GAAG,CAACA,GAAG,GAAGG,GAAP,IAAcx+B,CAA1B;MACA++B,GAAG,GAAGT,GAAG,GAAG,CAACA,GAAG,GAAGG,GAAP,IAAcz+B,CAA1B;IACD;;IACD,IAAIA,CAAJ;;IACA,IAAIvK,CAAC,GAAGR,EAAR,EAAY;MACV+K,CAAC,GAAG,CAAJ;IACD,CAFD,MAEO,IAAIvK,CAAC,GAAGN,EAAR,EAAY;MACjB6K,CAAC,GAAG,CAAJ;IACD,CAFM,MAEA;MACLA,CAAC,GAAG,CAAC/K,EAAE,GAAGQ,CAAN,KAAYR,EAAE,GAAGE,EAAjB,CAAJ;IACD;;IACD6pC,EAAE,GAAGnqC,EAAE,GAAG,CAACA,EAAE,GAAGE,EAAN,IAAYiL,CAAtB;IACAi/B,GAAG,GAAGhB,GAAG,GAAG,CAACA,GAAG,GAAGM,GAAP,IAAcv+B,CAA1B;IACAk/B,GAAG,GAAGhB,GAAG,GAAG,CAACA,GAAG,GAAGM,GAAP,IAAcx+B,CAA1B;IACAm/B,GAAG,GAAGhB,GAAG,GAAG,CAACA,GAAG,GAAGM,GAAP,IAAcz+B,CAA1B;IACA,MAAMo/B,GAAG,GAAGxvC,IAAI,CAAC0P,KAAL,CAAW1P,IAAI,CAACC,GAAL,CAAS+uC,EAAT,EAAaI,EAAb,CAAX,CAAZ;IACA,MAAMK,GAAG,GAAGzvC,IAAI,CAAC0P,KAAL,CAAW1P,IAAI,CAAC2D,GAAL,CAASqrC,EAAT,EAAaI,EAAb,CAAX,CAAZ;IACA,IAAI/+B,CAAC,GAAG49B,OAAO,GAAGpoC,CAAV,GAAc2pC,GAAG,GAAG,CAA5B;;IACA,KAAK,IAAI5pC,CAAC,GAAG4pC,GAAb,EAAkB5pC,CAAC,IAAI6pC,GAAvB,EAA4B7pC,CAAC,EAA7B,EAAiC;MAC/BwK,CAAC,GAAG,CAAC4+B,EAAE,GAAGppC,CAAN,KAAYopC,EAAE,GAAGI,EAAjB,CAAJ;;MACA,IAAIh/B,CAAC,GAAG,CAAR,EAAW;QACTA,CAAC,GAAG,CAAJ;MACD,CAFD,MAEO,IAAIA,CAAC,GAAG,CAAR,EAAW;QAChBA,CAAC,GAAG,CAAJ;MACD;;MACD7Q,KAAK,CAAC8Q,CAAC,EAAF,CAAL,GAAa4+B,GAAG,GAAG,CAACA,GAAG,GAAGI,GAAP,IAAcj/B,CAApB,GAAwB,CAArC;MACA7Q,KAAK,CAAC8Q,CAAC,EAAF,CAAL,GAAa6+B,GAAG,GAAG,CAACA,GAAG,GAAGI,GAAP,IAAcl/B,CAApB,GAAwB,CAArC;MACA7Q,KAAK,CAAC8Q,CAAC,EAAF,CAAL,GAAa8+B,GAAG,GAAG,CAACA,GAAG,GAAGI,GAAP,IAAcn/B,CAApB,GAAwB,CAArC;MACA7Q,KAAK,CAAC8Q,CAAC,EAAF,CAAL,GAAa,GAAb;IACD;EACF;AACF;;AACD,SAASq/B,UAAT,CAAoB98B,IAApB,EAA0B+8B,MAA1B,EAAkC/kC,OAAlC,EAA2C;EACzC,MAAMglC,EAAE,GAAGD,MAAM,CAAC3B,MAAlB;EACA,MAAM6B,EAAE,GAAGF,MAAM,CAACt4B,MAAlB;EACA,IAAIvX,CAAJ,EAAOgH,EAAP;;EACA,QAAQ6oC,MAAM,CAAChiD,IAAf;IACE,KAAK,SAAL;MACE,MAAMmiD,cAAc,GAAGH,MAAM,CAACG,cAA9B;MACA,MAAMC,IAAI,GAAG/vC,IAAI,CAAC4I,KAAL,CAAWgnC,EAAE,CAAC1xC,MAAH,GAAY4xC,cAAvB,IAAyC,CAAtD;MACA,MAAME,IAAI,GAAGF,cAAc,GAAG,CAA9B;;MACA,KAAKhwC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGiwC,IAAhB,EAAsBjwC,CAAC,EAAvB,EAA2B;QACzB,IAAImwC,CAAC,GAAGnwC,CAAC,GAAGgwC,cAAZ;;QACA,KAAK,IAAIz/B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2/B,IAApB,EAA0B3/B,CAAC,IAAI4/B,CAAC,EAAhC,EAAoC;UAClCrC,YAAY,CAACh7B,IAAD,EAAOhI,OAAP,EAAgBglC,EAAE,CAACK,CAAD,CAAlB,EAAuBL,EAAE,CAACK,CAAC,GAAG,CAAL,CAAzB,EAAkCL,EAAE,CAACK,CAAC,GAAGH,cAAL,CAApC,EAA0DD,EAAE,CAACI,CAAD,CAA5D,EAAiEJ,EAAE,CAACI,CAAC,GAAG,CAAL,CAAnE,EAA4EJ,EAAE,CAACI,CAAC,GAAGH,cAAL,CAA9E,CAAZ;UACAlC,YAAY,CAACh7B,IAAD,EAAOhI,OAAP,EAAgBglC,EAAE,CAACK,CAAC,GAAGH,cAAJ,GAAqB,CAAtB,CAAlB,EAA4CF,EAAE,CAACK,CAAC,GAAG,CAAL,CAA9C,EAAuDL,EAAE,CAACK,CAAC,GAAGH,cAAL,CAAzD,EAA+ED,EAAE,CAACI,CAAC,GAAGH,cAAJ,GAAqB,CAAtB,CAAjF,EAA2GD,EAAE,CAACI,CAAC,GAAG,CAAL,CAA7G,EAAsHJ,EAAE,CAACI,CAAC,GAAGH,cAAL,CAAxH,CAAZ;QACD;MACF;;MACD;;IACF,KAAK,WAAL;MACE,KAAKhwC,CAAC,GAAG,CAAJ,EAAOgH,EAAE,GAAG8oC,EAAE,CAAC1xC,MAApB,EAA4B4B,CAAC,GAAGgH,EAAhC,EAAoChH,CAAC,IAAI,CAAzC,EAA4C;QAC1C8tC,YAAY,CAACh7B,IAAD,EAAOhI,OAAP,EAAgBglC,EAAE,CAAC9vC,CAAD,CAAlB,EAAuB8vC,EAAE,CAAC9vC,CAAC,GAAG,CAAL,CAAzB,EAAkC8vC,EAAE,CAAC9vC,CAAC,GAAG,CAAL,CAApC,EAA6C+vC,EAAE,CAAC/vC,CAAD,CAA/C,EAAoD+vC,EAAE,CAAC/vC,CAAC,GAAG,CAAL,CAAtD,EAA+D+vC,EAAE,CAAC/vC,CAAC,GAAG,CAAL,CAAjE,CAAZ;MACD;;MACD;;IACF;MACE,MAAM,IAAIxC,KAAJ,CAAU,gBAAV,CAAN;EAnBJ;AAqBD;;AACD,MAAM4yC,kBAAN,SAAiC3E,kBAAjC,CAAoD;EAClDxsC,WAAW,CAAC2sC,EAAD,EAAK;IACd;IACA,KAAKyE,OAAL,GAAezE,EAAE,CAAC,CAAD,CAAjB;IACA,KAAKhrB,OAAL,GAAegrB,EAAE,CAAC,CAAD,CAAjB;IACA,KAAK0E,QAAL,GAAgB1E,EAAE,CAAC,CAAD,CAAlB;IACA,KAAK2E,OAAL,GAAe3E,EAAE,CAAC,CAAD,CAAjB;IACA,KAAKC,KAAL,GAAaD,EAAE,CAAC,CAAD,CAAf;IACA,KAAK4E,WAAL,GAAmB5E,EAAE,CAAC,CAAD,CAArB;IACA,KAAKO,MAAL,GAAc,IAAd;EACD;;EACDsE,iBAAiB,CAACC,aAAD,EAAgBC,eAAhB,EAAiCxD,cAAjC,EAAiD;IAChE,MAAMyD,cAAc,GAAG,GAAvB;IACA,MAAMC,gBAAgB,GAAG,IAAzB;IACA,MAAMC,WAAW,GAAG,CAApB;IACA,MAAMx9B,OAAO,GAAGpT,IAAI,CAAC4I,KAAL,CAAW,KAAKynC,OAAL,CAAa,CAAb,CAAX,CAAhB;IACA,MAAMh9B,OAAO,GAAGrT,IAAI,CAAC4I,KAAL,CAAW,KAAKynC,OAAL,CAAa,CAAb,CAAX,CAAhB;IACA,MAAMQ,WAAW,GAAG7wC,IAAI,CAAC+sC,IAAL,CAAU,KAAKsD,OAAL,CAAa,CAAb,CAAV,IAA6Bj9B,OAAjD;IACA,MAAM09B,YAAY,GAAG9wC,IAAI,CAAC+sC,IAAL,CAAU,KAAKsD,OAAL,CAAa,CAAb,CAAV,IAA6Bh9B,OAAlD;IACA,MAAM7I,KAAK,GAAGxK,IAAI,CAACC,GAAL,CAASD,IAAI,CAAC+sC,IAAL,CAAU/sC,IAAI,CAAC+F,GAAL,CAAS8qC,WAAW,GAAGL,aAAa,CAAC,CAAD,CAA3B,GAAiCE,cAA1C,CAAV,CAAT,EAA+EC,gBAA/E,CAAd;IACA,MAAMlmC,MAAM,GAAGzK,IAAI,CAACC,GAAL,CAASD,IAAI,CAAC+sC,IAAL,CAAU/sC,IAAI,CAAC+F,GAAL,CAAS+qC,YAAY,GAAGN,aAAa,CAAC,CAAD,CAA5B,GAAkCE,cAA3C,CAAV,CAAT,EAAgFC,gBAAhF,CAAf;IACA,MAAMxC,MAAM,GAAG0C,WAAW,GAAGrmC,KAA7B;IACA,MAAM4jC,MAAM,GAAG0C,YAAY,GAAGrmC,MAA9B;IACA,MAAMG,OAAO,GAAG;MACdojC,MAAM,EAAE,KAAKmC,OADC;MAEd94B,MAAM,EAAE,KAAKqJ,OAFC;MAGdtN,OAAO,EAAE,CAACA,OAHI;MAIdC,OAAO,EAAE,CAACA,OAJI;MAKd86B,MAAM,EAAE,IAAIA,MALE;MAMdC,MAAM,EAAE,IAAIA;IANE,CAAhB;IAQA,MAAM2C,WAAW,GAAGvmC,KAAK,GAAGomC,WAAW,GAAG,CAA1C;IACA,MAAMI,YAAY,GAAGvmC,MAAM,GAAGmmC,WAAW,GAAG,CAA5C;IACA,MAAM5D,SAAS,GAAGC,cAAc,CAACC,SAAf,CAAyB,MAAzB,EAAiC6D,WAAjC,EAA8CC,YAA9C,EAA4D,KAA5D,CAAlB;IACA,MAAM7D,MAAM,GAAGH,SAAS,CAACpiC,OAAzB;IACA,MAAMgI,IAAI,GAAGu6B,MAAM,CAAC8D,eAAP,CAAuBzmC,KAAvB,EAA8BC,MAA9B,CAAb;;IACA,IAAIgmC,eAAJ,EAAqB;MACnB,MAAMlxC,KAAK,GAAGqT,IAAI,CAACA,IAAnB;;MACA,KAAK,IAAI9S,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGvH,KAAK,CAACrB,MAA3B,EAAmC4B,CAAC,GAAGgH,EAAvC,EAA2ChH,CAAC,IAAI,CAAhD,EAAmD;QACjDP,KAAK,CAACO,CAAD,CAAL,GAAW2wC,eAAe,CAAC,CAAD,CAA1B;QACAlxC,KAAK,CAACO,CAAC,GAAG,CAAL,CAAL,GAAe2wC,eAAe,CAAC,CAAD,CAA9B;QACAlxC,KAAK,CAACO,CAAC,GAAG,CAAL,CAAL,GAAe2wC,eAAe,CAAC,CAAD,CAA9B;QACAlxC,KAAK,CAACO,CAAC,GAAG,CAAL,CAAL,GAAe,GAAf;MACD;IACF;;IACD,KAAK,MAAM6vC,MAAX,IAAqB,KAAKS,QAA1B,EAAoC;MAClCV,UAAU,CAAC98B,IAAD,EAAO+8B,MAAP,EAAe/kC,OAAf,CAAV;IACD;;IACDuiC,MAAM,CAAC+D,YAAP,CAAoBt+B,IAApB,EAA0Bg+B,WAA1B,EAAuCA,WAAvC;IACA,MAAMlmC,MAAM,GAAGsiC,SAAS,CAACtiC,MAAzB;IACA,OAAO;MACLA,MADK;MAEL0I,OAAO,EAAEA,OAAO,GAAGw9B,WAAW,GAAGzC,MAF5B;MAGL96B,OAAO,EAAEA,OAAO,GAAGu9B,WAAW,GAAGxC,MAH5B;MAILD,MAJK;MAKLC;IALK,CAAP;EAOD;;EACD5C,UAAU,CAAC9zB,GAAD,EAAM80B,KAAN,EAAaC,OAAb,EAAsBC,QAAtB,EAAgC;IACxCvB,gBAAgB,CAACzzB,GAAD,EAAM,KAAKi0B,KAAX,CAAhB;IACA,IAAIz4B,KAAJ;;IACA,IAAIw5B,QAAQ,KAAKzB,QAAQ,CAACC,OAA1B,EAAmC;MACjCh4B,KAAK,GAAG7mB,IAAI,CAACwX,6BAAL,CAAmC4T,mBAAmB,CAACC,GAAD,CAAtD,CAAR;IACD,CAFD,MAEO;MACLxE,KAAK,GAAG7mB,IAAI,CAACwX,6BAAL,CAAmC2oC,KAAK,CAACc,aAAzC,CAAR;;MACA,IAAI,KAAKrB,MAAT,EAAiB;QACf,MAAMkF,WAAW,GAAG9kD,IAAI,CAACwX,6BAAL,CAAmC,KAAKooC,MAAxC,CAApB;QACA/4B,KAAK,GAAG,CAACA,KAAK,CAAC,CAAD,CAAL,GAAWi+B,WAAW,CAAC,CAAD,CAAvB,EAA4Bj+B,KAAK,CAAC,CAAD,CAAL,GAAWi+B,WAAW,CAAC,CAAD,CAAlD,CAAR;MACD;IACF;;IACD,MAAMC,sBAAsB,GAAG,KAAKb,iBAAL,CAAuBr9B,KAAvB,EAA8Bw5B,QAAQ,KAAKzB,QAAQ,CAACC,OAAtB,GAAgC,IAAhC,GAAuC,KAAKoF,WAA1E,EAAuF9D,KAAK,CAACS,cAA7F,CAA/B;;IACA,IAAIP,QAAQ,KAAKzB,QAAQ,CAACC,OAA1B,EAAmC;MACjCxzB,GAAG,CAACi2B,YAAJ,CAAiB,GAAGnB,KAAK,CAACc,aAA1B;;MACA,IAAI,KAAKrB,MAAT,EAAiB;QACfv0B,GAAG,CAACjgB,SAAJ,CAAc,GAAG,KAAKw0C,MAAtB;MACD;IACF;;IACDv0B,GAAG,CAACwiB,SAAJ,CAAckX,sBAAsB,CAACh+B,OAArC,EAA8Cg+B,sBAAsB,CAAC/9B,OAArE;IACAqE,GAAG,CAACxE,KAAJ,CAAUk+B,sBAAsB,CAACjD,MAAjC,EAAyCiD,sBAAsB,CAAChD,MAAhE;IACA,OAAO12B,GAAG,CAAC81B,aAAJ,CAAkB4D,sBAAsB,CAAC1mC,MAAzC,EAAiD,WAAjD,CAAP;EACD;;AAhFiD;;AAkFpD,MAAM2mC,mBAAN,SAAkC9F,kBAAlC,CAAqD;EACnDC,UAAU,GAAG;IACX,OAAO,SAAP;EACD;;AAHkD;;AAKrD,SAAS8F,iBAAT,CAA2B5F,EAA3B,EAA+B;EAC7B,QAAQA,EAAE,CAAC,CAAD,CAAV;IACE,KAAK,aAAL;MACE,OAAO,IAAID,yBAAJ,CAA8BC,EAA9B,CAAP;;IACF,KAAK,MAAL;MACE,OAAO,IAAIwE,kBAAJ,CAAuBxE,EAAvB,CAAP;;IACF,KAAK,OAAL;MACE,OAAO,IAAI2F,mBAAJ,EAAP;EANJ;;EAQA,MAAM,IAAI/zC,KAAJ,CAAW,oBAAmBouC,EAAE,CAAC,CAAD,CAAI,EAApC,CAAN;AACD;;AACD,MAAM6F,SAAS,GAAG;EAChBC,OAAO,EAAE,CADO;EAEhBC,SAAS,EAAE;AAFK,CAAlB;;AAIA,MAAMC,aAAN,CAAoB;EACK,OAAhBf,gBAAgB,GAAG,IAAH;;EACvB5xC,WAAW,CAAC2sC,EAAD,EAAK38B,KAAL,EAAY2I,GAAZ,EAAiBi6B,qBAAjB,EAAwCrE,aAAxC,EAAuD;IAChE,KAAKsE,YAAL,GAAoBlG,EAAE,CAAC,CAAD,CAAtB;IACA,KAAKO,MAAL,GAAcP,EAAE,CAAC,CAAD,CAAhB;IACA,KAAKN,IAAL,GAAYM,EAAE,CAAC,CAAD,CAAd;IACA,KAAKmG,KAAL,GAAanG,EAAE,CAAC,CAAD,CAAf;IACA,KAAKoG,KAAL,GAAapG,EAAE,CAAC,CAAD,CAAf;IACA,KAAKqG,SAAL,GAAiBrG,EAAE,CAAC,CAAD,CAAnB;IACA,KAAKsG,UAAL,GAAkBtG,EAAE,CAAC,CAAD,CAApB;IACA,KAAK38B,KAAL,GAAaA,KAAb;IACA,KAAK2I,GAAL,GAAWA,GAAX;IACA,KAAKi6B,qBAAL,GAA6BA,qBAA7B;IACA,KAAKrE,aAAL,GAAqBA,aAArB;EACD;;EACD2E,mBAAmB,CAACzF,KAAD,EAAQ;IACzB,MAAMoF,YAAY,GAAG,KAAKA,YAA1B;IACA,MAAMxG,IAAI,GAAG,KAAKA,IAAlB;IACA,MAAMyG,KAAK,GAAG,KAAKA,KAAnB;IACA,MAAMC,KAAK,GAAG,KAAKA,KAAnB;IACA,MAAMC,SAAS,GAAG,KAAKA,SAAvB;IACA,MAAMC,UAAU,GAAG,KAAKA,UAAxB;IACA,MAAMjjC,KAAK,GAAG,KAAKA,KAAnB;IACA,MAAM4iC,qBAAqB,GAAG,KAAKA,qBAAnC;IACA30C,IAAI,CAAC,iBAAiBg1C,UAAlB,CAAJ;IACA,MAAMhtC,EAAE,GAAGomC,IAAI,CAAC,CAAD,CAAf;IAAA,MACEhmC,EAAE,GAAGgmC,IAAI,CAAC,CAAD,CADX;IAAA,MAEEnmC,EAAE,GAAGmmC,IAAI,CAAC,CAAD,CAFX;IAAA,MAGE/lC,EAAE,GAAG+lC,IAAI,CAAC,CAAD,CAHX;IAIA,MAAM+F,WAAW,GAAG9kD,IAAI,CAACwX,6BAAL,CAAmC,KAAKooC,MAAxC,CAApB;IACA,MAAMiG,cAAc,GAAG7lD,IAAI,CAACwX,6BAAL,CAAmC,KAAKypC,aAAxC,CAAvB;IACA,MAAMkD,aAAa,GAAG,CAACW,WAAW,CAAC,CAAD,CAAX,GAAiBe,cAAc,CAAC,CAAD,CAAhC,EAAqCf,WAAW,CAAC,CAAD,CAAX,GAAiBe,cAAc,CAAC,CAAD,CAApE,CAAtB;IACA,MAAMC,IAAI,GAAG,KAAKC,eAAL,CAAqBP,KAArB,EAA4B,KAAKn6B,GAAL,CAAShN,MAAT,CAAgBF,KAA5C,EAAmDgmC,aAAa,CAAC,CAAD,CAAhE,CAAb;IACA,MAAM6B,IAAI,GAAG,KAAKD,eAAL,CAAqBN,KAArB,EAA4B,KAAKp6B,GAAL,CAAShN,MAAT,CAAgBD,MAA5C,EAAoD+lC,aAAa,CAAC,CAAD,CAAjE,CAAb;IACA,MAAMxD,SAAS,GAAGR,KAAK,CAACS,cAAN,CAAqBC,SAArB,CAA+B,SAA/B,EAA0CiF,IAAI,CAAC7hC,IAA/C,EAAqD+hC,IAAI,CAAC/hC,IAA1D,EAAgE,IAAhE,CAAlB;IACA,MAAM68B,MAAM,GAAGH,SAAS,CAACpiC,OAAzB;IACA,MAAM0nC,QAAQ,GAAGX,qBAAqB,CAACY,oBAAtB,CAA2CpF,MAA3C,CAAjB;IACAmF,QAAQ,CAACE,UAAT,GAAsBhG,KAAK,CAACgG,UAA5B;IACA,KAAKC,8BAAL,CAAoCH,QAApC,EAA8CP,SAA9C,EAAyDhjC,KAAzD;IACA,IAAI2jC,UAAU,GAAG1tC,EAAjB;IACA,IAAI2tC,UAAU,GAAGvtC,EAAjB;IACA,IAAIwtC,UAAU,GAAG3tC,EAAjB;IACA,IAAI4tC,UAAU,GAAGxtC,EAAjB;;IACA,IAAIL,EAAE,GAAG,CAAT,EAAY;MACV0tC,UAAU,GAAG,CAAb;MACAE,UAAU,IAAI5yC,IAAI,CAAC+F,GAAL,CAASf,EAAT,CAAd;IACD;;IACD,IAAII,EAAE,GAAG,CAAT,EAAY;MACVutC,UAAU,GAAG,CAAb;MACAE,UAAU,IAAI7yC,IAAI,CAAC+F,GAAL,CAASX,EAAT,CAAd;IACD;;IACD+nC,MAAM,CAACjT,SAAP,CAAiB,EAAEiY,IAAI,CAACj/B,KAAL,GAAaw/B,UAAf,CAAjB,EAA6C,EAAEL,IAAI,CAACn/B,KAAL,GAAay/B,UAAf,CAA7C;IACAL,QAAQ,CAAC76C,SAAT,CAAmB06C,IAAI,CAACj/B,KAAxB,EAA+B,CAA/B,EAAkC,CAAlC,EAAqCm/B,IAAI,CAACn/B,KAA1C,EAAiD,CAAjD,EAAoD,CAApD;IACAi6B,MAAM,CAAC51C,IAAP;IACA,KAAKu7C,QAAL,CAAcR,QAAd,EAAwBI,UAAxB,EAAoCC,UAApC,EAAgDC,UAAhD,EAA4DC,UAA5D;IACAP,QAAQ,CAAChF,aAAT,GAAyB71B,mBAAmB,CAAC66B,QAAQ,CAAC56B,GAAV,CAA5C;IACA46B,QAAQ,CAACS,mBAAT,CAA6BnB,YAA7B;IACAU,QAAQ,CAACU,UAAT;IACA,OAAO;MACLtoC,MAAM,EAAEsiC,SAAS,CAACtiC,MADb;MAELyjC,MAAM,EAAEgE,IAAI,CAACj/B,KAFR;MAGLk7B,MAAM,EAAEiE,IAAI,CAACn/B,KAHR;MAILE,OAAO,EAAEs/B,UAJJ;MAKLr/B,OAAO,EAAEs/B;IALJ,CAAP;EAOD;;EACDP,eAAe,CAACpiC,IAAD,EAAOijC,cAAP,EAAuB//B,KAAvB,EAA8B;IAC3ClD,IAAI,GAAGhQ,IAAI,CAAC+F,GAAL,CAASiK,IAAT,CAAP;IACA,MAAMyO,OAAO,GAAGze,IAAI,CAAC2D,GAAL,CAAS+tC,aAAa,CAACf,gBAAvB,EAAyCsC,cAAzC,CAAhB;IACA,IAAI3iC,IAAI,GAAGtQ,IAAI,CAAC+sC,IAAL,CAAU/8B,IAAI,GAAGkD,KAAjB,CAAX;;IACA,IAAI5C,IAAI,IAAImO,OAAZ,EAAqB;MACnBnO,IAAI,GAAGmO,OAAP;IACD,CAFD,MAEO;MACLvL,KAAK,GAAG5C,IAAI,GAAGN,IAAf;IACD;;IACD,OAAO;MACLkD,KADK;MAEL5C;IAFK,CAAP;EAID;;EACDwiC,QAAQ,CAACR,QAAD,EAAWttC,EAAX,EAAeI,EAAf,EAAmBH,EAAnB,EAAuBI,EAAvB,EAA2B;IACjC,MAAM6tC,SAAS,GAAGjuC,EAAE,GAAGD,EAAvB;IACA,MAAMmuC,UAAU,GAAG9tC,EAAE,GAAGD,EAAxB;IACAktC,QAAQ,CAAC56B,GAAT,CAAanT,IAAb,CAAkBS,EAAlB,EAAsBI,EAAtB,EAA0B8tC,SAA1B,EAAqCC,UAArC;IACAb,QAAQ,CAACzF,OAAT,CAAiBuG,gBAAjB,CAAkC37B,mBAAmB,CAAC66B,QAAQ,CAAC56B,GAAV,CAArD,EAAqE,CAAC1S,EAAD,EAAKI,EAAL,EAASH,EAAT,EAAaI,EAAb,CAArE;IACAitC,QAAQ,CAAC55C,IAAT;IACA45C,QAAQ,CAAC75C,OAAT;EACD;;EACDg6C,8BAA8B,CAACH,QAAD,EAAWP,SAAX,EAAsBhjC,KAAtB,EAA6B;IACzD,MAAMnE,OAAO,GAAG0nC,QAAQ,CAAC56B,GAAzB;IAAA,MACEm1B,OAAO,GAAGyF,QAAQ,CAACzF,OADrB;;IAEA,QAAQkF,SAAR;MACE,KAAKR,SAAS,CAACC,OAAf;QACE,MAAM95B,GAAG,GAAG,KAAKA,GAAjB;QACA9M,OAAO,CAAC2iC,SAAR,GAAoB71B,GAAG,CAAC61B,SAAxB;QACA3iC,OAAO,CAACyoC,WAAR,GAAsB37B,GAAG,CAAC27B,WAA1B;QACAxG,OAAO,CAACyG,SAAR,GAAoB57B,GAAG,CAAC61B,SAAxB;QACAV,OAAO,CAAC0G,WAAR,GAAsB77B,GAAG,CAAC27B,WAA1B;QACA;;MACF,KAAK9B,SAAS,CAACE,SAAf;QACE,MAAM+B,QAAQ,GAAGnnD,IAAI,CAACiW,YAAL,CAAkByM,KAAK,CAAC,CAAD,CAAvB,EAA4BA,KAAK,CAAC,CAAD,CAAjC,EAAsCA,KAAK,CAAC,CAAD,CAA3C,CAAjB;QACAnE,OAAO,CAAC2iC,SAAR,GAAoBiG,QAApB;QACA5oC,OAAO,CAACyoC,WAAR,GAAsBG,QAAtB;QACA3G,OAAO,CAACyG,SAAR,GAAoBE,QAApB;QACA3G,OAAO,CAAC0G,WAAR,GAAsBC,QAAtB;QACA;;MACF;QACE,MAAM,IAAIn0C,WAAJ,CAAiB,2BAA0B0yC,SAAU,EAArD,CAAN;IAhBJ;EAkBD;;EACDvG,UAAU,CAAC9zB,GAAD,EAAM80B,KAAN,EAAaC,OAAb,EAAsBC,QAAtB,EAAgC;IACxC,IAAIT,MAAM,GAAGQ,OAAb;;IACA,IAAIC,QAAQ,KAAKzB,QAAQ,CAACC,OAA1B,EAAmC;MACjCe,MAAM,GAAG5/C,IAAI,CAACoL,SAAL,CAAew0C,MAAf,EAAuBO,KAAK,CAACc,aAA7B,CAAT;;MACA,IAAI,KAAKrB,MAAT,EAAiB;QACfA,MAAM,GAAG5/C,IAAI,CAACoL,SAAL,CAAew0C,MAAf,EAAuB,KAAKA,MAA5B,CAAT;MACD;IACF;;IACD,MAAMmF,sBAAsB,GAAG,KAAKa,mBAAL,CAAyBzF,KAAzB,CAA/B;IACA,IAAIiB,SAAS,GAAG,IAAIC,SAAJ,CAAczB,MAAd,CAAhB;IACAwB,SAAS,GAAGA,SAAS,CAACvT,SAAV,CAAoBkX,sBAAsB,CAACh+B,OAA3C,EAAoDg+B,sBAAsB,CAAC/9B,OAA3E,CAAZ;IACAo6B,SAAS,GAAGA,SAAS,CAACv6B,KAAV,CAAgB,IAAIk+B,sBAAsB,CAACjD,MAA3C,EAAmD,IAAIiD,sBAAsB,CAAChD,MAA9E,CAAZ;IACA,MAAMzB,OAAO,GAAGj1B,GAAG,CAAC81B,aAAJ,CAAkB4D,sBAAsB,CAAC1mC,MAAzC,EAAiD,QAAjD,CAAhB;IACAiiC,OAAO,CAACgB,YAAR,CAAqBF,SAArB;IACA,OAAOd,OAAP;EACD;;AA7HiB;;AAgIpB,C,CAAC;;AAED,SAAS8G,aAAT,CAAuB5iB,MAAvB,EAA+B;EAC7B,QAAQA,MAAM,CAAC6iB,IAAf;IACE,KAAKnoD,SAAS,CAAC8F,cAAf;MACE,OAAOsiD,0BAA0B,CAAC9iB,MAAD,CAAjC;;IACF,KAAKtlC,SAAS,CAAC+F,SAAf;MACE,OAAOsiD,gBAAgB,CAAC/iB,MAAD,CAAvB;EAJJ;;EAMA,OAAO,IAAP;AACD;;AACD,SAAS8iB,0BAAT,CAAoC;EAClCj3B,GADkC;EAElCm3B,MAAM,GAAG,CAFyB;EAGlCC,IAHkC;EAIlCtpC,KAJkC;EAKlCC,MALkC;EAMlCspC,aAAa,GAAG,UANkB;EAOlCC,aAAa,GAAG;AAPkB,CAApC,EAQG;EACD,MAAMC,KAAK,GAAG5oD,gBAAgB,CAAC2V,cAAjB,GAAkC,UAAlC,GAA+C,UAA7D;EACA,MAAM,CAACkzC,WAAD,EAAcC,UAAd,IAA4BH,aAAa,GAAG,CAACD,aAAD,EAAgBE,KAAhB,CAAH,GAA4B,CAACA,KAAD,EAAQF,aAAR,CAA3E;EACA,MAAMK,aAAa,GAAG5pC,KAAK,IAAI,CAA/B;EACA,MAAM6pC,cAAc,GAAG7pC,KAAK,GAAG,CAA/B;EACA,MAAM8pC,SAAS,GAAG53B,GAAG,CAACxe,MAAtB;EACA41C,IAAI,GAAG,IAAI3yC,WAAJ,CAAgB2yC,IAAI,CAAC1yC,MAArB,CAAP;EACA,IAAImzC,OAAO,GAAG,CAAd;;EACA,KAAK,IAAIz0C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2K,MAApB,EAA4B3K,CAAC,EAA7B,EAAiC;IAC/B,KAAK,MAAM6D,GAAG,GAAGkwC,MAAM,GAAGO,aAA1B,EAAyCP,MAAM,GAAGlwC,GAAlD,EAAuDkwC,MAAM,EAA7D,EAAiE;MAC/D,MAAMW,IAAI,GAAGX,MAAM,GAAGS,SAAT,GAAqB53B,GAAG,CAACm3B,MAAD,CAAxB,GAAmC,GAAhD;MACAC,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkBC,IAAI,GAAG,UAAP,GAAoBL,UAApB,GAAiCD,WAAnD;MACAJ,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkBC,IAAI,GAAG,SAAP,GAAmBL,UAAnB,GAAgCD,WAAlD;MACAJ,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkBC,IAAI,GAAG,QAAP,GAAkBL,UAAlB,GAA+BD,WAAjD;MACAJ,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkBC,IAAI,GAAG,OAAP,GAAiBL,UAAjB,GAA8BD,WAAhD;MACAJ,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkBC,IAAI,GAAG,MAAP,GAAgBL,UAAhB,GAA6BD,WAA/C;MACAJ,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkBC,IAAI,GAAG,KAAP,GAAeL,UAAf,GAA4BD,WAA9C;MACAJ,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkBC,IAAI,GAAG,IAAP,GAAcL,UAAd,GAA2BD,WAA7C;MACAJ,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkBC,IAAI,GAAG,GAAP,GAAaL,UAAb,GAA0BD,WAA5C;IACD;;IACD,IAAIG,cAAc,KAAK,CAAvB,EAA0B;MACxB;IACD;;IACD,MAAMG,IAAI,GAAGX,MAAM,GAAGS,SAAT,GAAqB53B,GAAG,CAACm3B,MAAM,EAAP,CAAxB,GAAqC,GAAlD;;IACA,KAAK,IAAIxjC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgkC,cAApB,EAAoChkC,CAAC,EAArC,EAAyC;MACvCyjC,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkBC,IAAI,GAAG,KAAK,IAAInkC,CAAhB,GAAoB8jC,UAApB,GAAiCD,WAAnD;IACD;EACF;;EACD,OAAO;IACLL,MADK;IAELU;EAFK,CAAP;AAID;;AACD,SAASX,gBAAT,CAA0B;EACxBl3B,GADwB;EAExBm3B,MAAM,GAAG,CAFe;EAGxBC,IAHwB;EAIxBS,OAAO,GAAG,CAJc;EAKxB/pC,KALwB;EAMxBC;AANwB,CAA1B,EAOG;EACD,IAAI3K,CAAC,GAAG,CAAR;EACA,MAAM20C,KAAK,GAAG/3B,GAAG,CAACxe,MAAJ,IAAc,CAA5B;EACA,MAAMw2C,KAAK,GAAG,IAAIvzC,WAAJ,CAAgBub,GAAG,CAACtb,MAApB,EAA4ByyC,MAA5B,EAAoCY,KAApC,CAAd;;EACA,IAAIrpD,WAAW,CAAC4V,cAAhB,EAAgC;IAC9B,OAAOlB,CAAC,GAAG20C,KAAK,GAAG,CAAnB,EAAsB30C,CAAC,IAAI,CAAL,EAAQy0C,OAAO,IAAI,CAAzC,EAA4C;MAC1C,MAAMI,EAAE,GAAGD,KAAK,CAAC50C,CAAD,CAAhB;MACA,MAAM80C,EAAE,GAAGF,KAAK,CAAC50C,CAAC,GAAG,CAAL,CAAhB;MACA,MAAM+0C,EAAE,GAAGH,KAAK,CAAC50C,CAAC,GAAG,CAAL,CAAhB;MACAg0C,IAAI,CAACS,OAAD,CAAJ,GAAgBI,EAAE,GAAG,UAArB;MACAb,IAAI,CAACS,OAAO,GAAG,CAAX,CAAJ,GAAoBI,EAAE,KAAK,EAAP,GAAYC,EAAE,IAAI,CAAlB,GAAsB,UAA1C;MACAd,IAAI,CAACS,OAAO,GAAG,CAAX,CAAJ,GAAoBK,EAAE,KAAK,EAAP,GAAYC,EAAE,IAAI,EAAlB,GAAuB,UAA3C;MACAf,IAAI,CAACS,OAAO,GAAG,CAAX,CAAJ,GAAoBM,EAAE,KAAK,CAAP,GAAW,UAA/B;IACD;;IACD,KAAK,IAAIxkC,CAAC,GAAGvQ,CAAC,GAAG,CAAZ,EAAeg1C,EAAE,GAAGp4B,GAAG,CAACxe,MAA7B,EAAqCmS,CAAC,GAAGykC,EAAzC,EAA6CzkC,CAAC,IAAI,CAAlD,EAAqD;MACnDyjC,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkB73B,GAAG,CAACrM,CAAD,CAAH,GAASqM,GAAG,CAACrM,CAAC,GAAG,CAAL,CAAH,IAAc,CAAvB,GAA2BqM,GAAG,CAACrM,CAAC,GAAG,CAAL,CAAH,IAAc,EAAzC,GAA8C,UAAhE;IACD;EACF,CAbD,MAaO;IACL,OAAOvQ,CAAC,GAAG20C,KAAK,GAAG,CAAnB,EAAsB30C,CAAC,IAAI,CAAL,EAAQy0C,OAAO,IAAI,CAAzC,EAA4C;MAC1C,MAAMI,EAAE,GAAGD,KAAK,CAAC50C,CAAD,CAAhB;MACA,MAAM80C,EAAE,GAAGF,KAAK,CAAC50C,CAAC,GAAG,CAAL,CAAhB;MACA,MAAM+0C,EAAE,GAAGH,KAAK,CAAC50C,CAAC,GAAG,CAAL,CAAhB;MACAg0C,IAAI,CAACS,OAAD,CAAJ,GAAgBI,EAAE,GAAG,IAArB;MACAb,IAAI,CAACS,OAAO,GAAG,CAAX,CAAJ,GAAoBI,EAAE,IAAI,EAAN,GAAWC,EAAE,KAAK,CAAlB,GAAsB,IAA1C;MACAd,IAAI,CAACS,OAAO,GAAG,CAAX,CAAJ,GAAoBK,EAAE,IAAI,EAAN,GAAWC,EAAE,KAAK,EAAlB,GAAuB,IAA3C;MACAf,IAAI,CAACS,OAAO,GAAG,CAAX,CAAJ,GAAoBM,EAAE,IAAI,CAAN,GAAU,IAA9B;IACD;;IACD,KAAK,IAAIxkC,CAAC,GAAGvQ,CAAC,GAAG,CAAZ,EAAeg1C,EAAE,GAAGp4B,GAAG,CAACxe,MAA7B,EAAqCmS,CAAC,GAAGykC,EAAzC,EAA6CzkC,CAAC,IAAI,CAAlD,EAAqD;MACnDyjC,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkB73B,GAAG,CAACrM,CAAD,CAAH,IAAU,EAAV,GAAeqM,GAAG,CAACrM,CAAC,GAAG,CAAL,CAAH,IAAc,EAA7B,GAAkCqM,GAAG,CAACrM,CAAC,GAAG,CAAL,CAAH,IAAc,CAAhD,GAAoD,IAAtE;IACD;EACF;;EACD,OAAO;IACLwjC,MADK;IAELU;EAFK,CAAP;AAID;;AACD,SAASQ,UAAT,CAAoBr4B,GAApB,EAAyBo3B,IAAzB,EAA+B;EAC7B,IAAI1oD,WAAW,CAAC4V,cAAhB,EAAgC;IAC9B,KAAK,IAAIlB,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAG4V,GAAG,CAACxe,MAAzB,EAAiC4B,CAAC,GAAGgH,EAArC,EAAyChH,CAAC,EAA1C,EAA8C;MAC5Cg0C,IAAI,CAACh0C,CAAD,CAAJ,GAAU4c,GAAG,CAAC5c,CAAD,CAAH,GAAS,OAAT,GAAmB,UAA7B;IACD;EACF,CAJD,MAIO;IACL,KAAK,IAAIA,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAG4V,GAAG,CAACxe,MAAzB,EAAiC4B,CAAC,GAAGgH,EAArC,EAAyChH,CAAC,EAA1C,EAA8C;MAC5Cg0C,IAAI,CAACh0C,CAAD,CAAJ,GAAU4c,GAAG,CAAC5c,CAAD,CAAH,GAAS,SAAT,GAAqB,UAA/B;IACD;EACF;AACF;;AAED,C,CAAC;;AAKD,MAAMk1C,aAAa,GAAG,EAAtB;AACA,MAAMC,aAAa,GAAG,GAAtB;AACA,MAAMC,cAAc,GAAG,EAAvB;AACA,MAAMC,eAAe,GAAG,EAAxB;AACA,MAAMC,mBAAmB,GAAG,IAA5B;AACA,MAAMC,iBAAiB,GAAG,EAA1B;;AACA,SAASC,uBAAT,CAAiC59B,GAAjC,EAAsC69B,OAAtC,EAA+C;EAC7C,IAAI79B,GAAG,CAAC89B,gBAAR,EAA0B;IACxB,MAAM,IAAIl4C,KAAJ,CAAU,2CAAV,CAAN;EACD;;EACDoa,GAAG,CAAC+9B,cAAJ,GAAqB/9B,GAAG,CAACngB,IAAzB;EACAmgB,GAAG,CAACg+B,iBAAJ,GAAwBh+B,GAAG,CAAClgB,OAA5B;EACAkgB,GAAG,CAACi+B,gBAAJ,GAAuBj+B,GAAG,CAACooB,MAA3B;EACApoB,GAAG,CAACk+B,eAAJ,GAAsBl+B,GAAG,CAACxE,KAA1B;EACAwE,GAAG,CAACm+B,mBAAJ,GAA0Bn+B,GAAG,CAACwiB,SAA9B;EACAxiB,GAAG,CAACo+B,mBAAJ,GAA0Bp+B,GAAG,CAACjgB,SAA9B;EACAigB,GAAG,CAACq+B,sBAAJ,GAA6Br+B,GAAG,CAACi2B,YAAjC;EACAj2B,GAAG,CAACs+B,wBAAJ,GAA+Bt+B,GAAG,CAACu+B,cAAnC;EACAv+B,GAAG,CAACw+B,cAAJ,GAAqBx+B,GAAG,CAAChf,IAAzB;EACAgf,GAAG,CAACy+B,gBAAJ,GAAuBz+B,GAAG,CAAChgB,MAA3B;EACAggB,GAAG,CAAC0+B,gBAAJ,GAAuB1+B,GAAG,CAAC/f,MAA3B;EACA+f,GAAG,CAAC2+B,uBAAJ,GAA8B3+B,GAAG,CAACmyB,aAAlC;EACAnyB,GAAG,CAAC4+B,cAAJ,GAAqB5+B,GAAG,CAACnT,IAAzB;EACAmT,GAAG,CAAC6+B,mBAAJ,GAA0B7+B,GAAG,CAAC3f,SAA9B;EACA2f,GAAG,CAAC8+B,mBAAJ,GAA0B9+B,GAAG,CAAC21B,SAA9B;;EACA31B,GAAG,CAAC89B,gBAAJ,GAAuB,MAAM;IAC3B99B,GAAG,CAACngB,IAAJ,GAAWmgB,GAAG,CAAC+9B,cAAf;IACA/9B,GAAG,CAAClgB,OAAJ,GAAckgB,GAAG,CAACg+B,iBAAlB;IACAh+B,GAAG,CAACooB,MAAJ,GAAapoB,GAAG,CAACi+B,gBAAjB;IACAj+B,GAAG,CAACxE,KAAJ,GAAYwE,GAAG,CAACk+B,eAAhB;IACAl+B,GAAG,CAACwiB,SAAJ,GAAgBxiB,GAAG,CAACm+B,mBAApB;IACAn+B,GAAG,CAACjgB,SAAJ,GAAgBigB,GAAG,CAACo+B,mBAApB;IACAp+B,GAAG,CAACi2B,YAAJ,GAAmBj2B,GAAG,CAACq+B,sBAAvB;IACAr+B,GAAG,CAACu+B,cAAJ,GAAqBv+B,GAAG,CAACs+B,wBAAzB;IACAt+B,GAAG,CAAChf,IAAJ,GAAWgf,GAAG,CAACw+B,cAAf;IACAx+B,GAAG,CAAChgB,MAAJ,GAAaggB,GAAG,CAACy+B,gBAAjB;IACAz+B,GAAG,CAAC/f,MAAJ,GAAa+f,GAAG,CAAC0+B,gBAAjB;IACA1+B,GAAG,CAACmyB,aAAJ,GAAoBnyB,GAAG,CAAC2+B,uBAAxB;IACA3+B,GAAG,CAACnT,IAAJ,GAAWmT,GAAG,CAAC4+B,cAAf;IACA5+B,GAAG,CAAC3f,SAAJ,GAAgB2f,GAAG,CAAC6+B,mBAApB;IACA7+B,GAAG,CAAC21B,SAAJ,GAAgB31B,GAAG,CAAC8+B,mBAApB;IACA,OAAO9+B,GAAG,CAAC89B,gBAAX;EACD,CAjBD;;EAkBA99B,GAAG,CAACngB,IAAJ,GAAW,SAASk/C,OAAT,GAAmB;IAC5BlB,OAAO,CAACh+C,IAAR;;IACA,KAAKk+C,cAAL;EACD,CAHD;;EAIA/9B,GAAG,CAAClgB,OAAJ,GAAc,SAASk/C,UAAT,GAAsB;IAClCnB,OAAO,CAAC/9C,OAAR;;IACA,KAAKk+C,iBAAL;EACD,CAHD;;EAIAh+B,GAAG,CAACwiB,SAAJ,GAAgB,SAASyc,YAAT,CAAsB/wC,CAAtB,EAAyBC,CAAzB,EAA4B;IAC1C0vC,OAAO,CAACrb,SAAR,CAAkBt0B,CAAlB,EAAqBC,CAArB;;IACA,KAAKgwC,mBAAL,CAAyBjwC,CAAzB,EAA4BC,CAA5B;EACD,CAHD;;EAIA6R,GAAG,CAACxE,KAAJ,GAAY,SAAS0jC,QAAT,CAAkBhxC,CAAlB,EAAqBC,CAArB,EAAwB;IAClC0vC,OAAO,CAACriC,KAAR,CAActN,CAAd,EAAiBC,CAAjB;;IACA,KAAK+vC,eAAL,CAAqBhwC,CAArB,EAAwBC,CAAxB;EACD,CAHD;;EAIA6R,GAAG,CAACjgB,SAAJ,GAAgB,SAASo/C,YAAT,CAAsB9yC,CAAtB,EAAyBtB,CAAzB,EAA4BuB,CAA5B,EAA+Bxa,CAA/B,EAAkCusB,CAAlC,EAAqC4B,CAArC,EAAwC;IACtD49B,OAAO,CAAC99C,SAAR,CAAkBsM,CAAlB,EAAqBtB,CAArB,EAAwBuB,CAAxB,EAA2Bxa,CAA3B,EAA8BusB,CAA9B,EAAiC4B,CAAjC;;IACA,KAAKm+B,mBAAL,CAAyB/xC,CAAzB,EAA4BtB,CAA5B,EAA+BuB,CAA/B,EAAkCxa,CAAlC,EAAqCusB,CAArC,EAAwC4B,CAAxC;EACD,CAHD;;EAIAD,GAAG,CAACi2B,YAAJ,GAAmB,SAASmJ,eAAT,CAAyB/yC,CAAzB,EAA4BtB,CAA5B,EAA+BuB,CAA/B,EAAkCxa,CAAlC,EAAqCusB,CAArC,EAAwC4B,CAAxC,EAA2C;IAC5D49B,OAAO,CAAC5H,YAAR,CAAqB5pC,CAArB,EAAwBtB,CAAxB,EAA2BuB,CAA3B,EAA8Bxa,CAA9B,EAAiCusB,CAAjC,EAAoC4B,CAApC;;IACA,KAAKo+B,sBAAL,CAA4BhyC,CAA5B,EAA+BtB,CAA/B,EAAkCuB,CAAlC,EAAqCxa,CAArC,EAAwCusB,CAAxC,EAA2C4B,CAA3C;EACD,CAHD;;EAIAD,GAAG,CAACu+B,cAAJ,GAAqB,SAASc,iBAAT,GAA6B;IAChDxB,OAAO,CAACU,cAAR;;IACA,KAAKD,wBAAL;EACD,CAHD;;EAIAt+B,GAAG,CAACooB,MAAJ,GAAa,SAASkX,SAAT,CAAmBlc,KAAnB,EAA0B;IACrCya,OAAO,CAACzV,MAAR,CAAehF,KAAf;;IACA,KAAK6a,gBAAL,CAAsB7a,KAAtB;EACD,CAHD;;EAIApjB,GAAG,CAAChf,IAAJ,GAAW,SAASs+C,SAAT,CAAmBtR,IAAnB,EAAyB;IAClC6P,OAAO,CAAC78C,IAAR,CAAagtC,IAAb;;IACA,KAAKwQ,cAAL,CAAoBxQ,IAApB;EACD,CAHD;;EAIAhuB,GAAG,CAAChgB,MAAJ,GAAa,UAAUkO,CAAV,EAAaC,CAAb,EAAgB;IAC3B0vC,OAAO,CAAC79C,MAAR,CAAekO,CAAf,EAAkBC,CAAlB;;IACA,KAAKswC,gBAAL,CAAsBvwC,CAAtB,EAAyBC,CAAzB;EACD,CAHD;;EAIA6R,GAAG,CAAC/f,MAAJ,GAAa,UAAUiO,CAAV,EAAaC,CAAb,EAAgB;IAC3B0vC,OAAO,CAAC59C,MAAR,CAAeiO,CAAf,EAAkBC,CAAlB;;IACA,KAAKuwC,gBAAL,CAAsBxwC,CAAtB,EAAyBC,CAAzB;EACD,CAHD;;EAIA6R,GAAG,CAACmyB,aAAJ,GAAoB,UAAUoN,IAAV,EAAgBC,IAAhB,EAAsBC,IAAtB,EAA4BC,IAA5B,EAAkCxxC,CAAlC,EAAqCC,CAArC,EAAwC;IAC1D0vC,OAAO,CAAC1L,aAAR,CAAsBoN,IAAtB,EAA4BC,IAA5B,EAAkCC,IAAlC,EAAwCC,IAAxC,EAA8CxxC,CAA9C,EAAiDC,CAAjD;;IACA,KAAKwwC,uBAAL,CAA6BY,IAA7B,EAAmCC,IAAnC,EAAyCC,IAAzC,EAA+CC,IAA/C,EAAqDxxC,CAArD,EAAwDC,CAAxD;EACD,CAHD;;EAIA6R,GAAG,CAACnT,IAAJ,GAAW,UAAUqB,CAAV,EAAaC,CAAb,EAAgB2E,KAAhB,EAAuBC,MAAvB,EAA+B;IACxC8qC,OAAO,CAAChxC,IAAR,CAAaqB,CAAb,EAAgBC,CAAhB,EAAmB2E,KAAnB,EAA0BC,MAA1B;;IACA,KAAK6rC,cAAL,CAAoB1wC,CAApB,EAAuBC,CAAvB,EAA0B2E,KAA1B,EAAiCC,MAAjC;EACD,CAHD;;EAIAiN,GAAG,CAAC3f,SAAJ,GAAgB,YAAY;IAC1Bw9C,OAAO,CAACx9C,SAAR;;IACA,KAAKw+C,mBAAL;EACD,CAHD;;EAIA7+B,GAAG,CAAC21B,SAAJ,GAAgB,YAAY;IAC1BkI,OAAO,CAAClI,SAAR;;IACA,KAAKmJ,mBAAL;EACD,CAHD;AAID;;AACD,MAAMa,cAAN,CAAqB;EACnBt4C,WAAW,CAACu4C,aAAD,EAAgB;IACzB,KAAKA,aAAL,GAAqBA,aAArB;IACA,KAAK3qC,KAAL,GAAa9iB,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAb;EACD;;EACDmsC,SAAS,CAACzgC,EAAD,EAAKjC,KAAL,EAAYC,MAAZ,EAAoB;IAC3B,IAAI8sC,WAAJ;;IACA,IAAI,KAAK5qC,KAAL,CAAWF,EAAX,MAAmBjN,SAAvB,EAAkC;MAChC+3C,WAAW,GAAG,KAAK5qC,KAAL,CAAWF,EAAX,CAAd;MACA,KAAK6qC,aAAL,CAAmBvsC,KAAnB,CAAyBwsC,WAAzB,EAAsC/sC,KAAtC,EAA6CC,MAA7C;IACD,CAHD,MAGO;MACL8sC,WAAW,GAAG,KAAKD,aAAL,CAAmBv2C,MAAnB,CAA0ByJ,KAA1B,EAAiCC,MAAjC,CAAd;MACA,KAAKkC,KAAL,CAAWF,EAAX,IAAiB8qC,WAAjB;IACD;;IACD,OAAOA,WAAP;EACD;;EACDx8B,MAAM,CAACtO,EAAD,EAAK;IACT,OAAO,KAAKE,KAAL,CAAWF,EAAX,CAAP;EACD;;EACD+D,KAAK,GAAG;IACN,KAAK,MAAM/D,EAAX,IAAiB,KAAKE,KAAtB,EAA6B;MAC3B,MAAM4qC,WAAW,GAAG,KAAK5qC,KAAL,CAAWF,EAAX,CAApB;MACA,KAAK6qC,aAAL,CAAmBltC,OAAnB,CAA2BmtC,WAA3B;MACA,OAAO,KAAK5qC,KAAL,CAAWF,EAAX,CAAP;IACD;EACF;;AAzBkB;;AA2BrB,SAAS+qC,wBAAT,CAAkC9/B,GAAlC,EAAuC+/B,MAAvC,EAA+CC,IAA/C,EAAqDC,IAArD,EAA2DC,IAA3D,EAAiEC,IAAjE,EAAuEC,KAAvE,EAA8EC,KAA9E,EAAqFC,KAArF,EAA4FC,KAA5F,EAAmG;EACjG,MAAM,CAACl0C,CAAD,EAAItB,CAAJ,EAAOuB,CAAP,EAAUxa,CAAV,EAAawoC,EAAb,EAAiBC,EAAjB,IAAuBxa,mBAAmB,CAACC,GAAD,CAAhD;;EACA,IAAIjV,CAAC,KAAK,CAAN,IAAWuB,CAAC,KAAK,CAArB,EAAwB;IACtB,MAAMk0C,GAAG,GAAGJ,KAAK,GAAG/zC,CAAR,GAAYiuB,EAAxB;IACA,MAAMmmB,IAAI,GAAGn4C,IAAI,CAAC0P,KAAL,CAAWwoC,GAAX,CAAb;IACA,MAAME,GAAG,GAAGL,KAAK,GAAGvuD,CAAR,GAAYyoC,EAAxB;IACA,MAAMomB,IAAI,GAAGr4C,IAAI,CAAC0P,KAAL,CAAW0oC,GAAX,CAAb;IACA,MAAME,GAAG,GAAG,CAACR,KAAK,GAAGE,KAAT,IAAkBj0C,CAAlB,GAAsBiuB,EAAlC;IACA,MAAMumB,MAAM,GAAGv4C,IAAI,CAAC+F,GAAL,CAAS/F,IAAI,CAAC0P,KAAL,CAAW4oC,GAAX,IAAkBH,IAA3B,KAAoC,CAAnD;IACA,MAAMK,GAAG,GAAG,CAACT,KAAK,GAAGE,KAAT,IAAkBzuD,CAAlB,GAAsByoC,EAAlC;IACA,MAAMwmB,OAAO,GAAGz4C,IAAI,CAAC+F,GAAL,CAAS/F,IAAI,CAAC0P,KAAL,CAAW8oC,GAAX,IAAkBH,IAA3B,KAAoC,CAApD;IACA3gC,GAAG,CAACi2B,YAAJ,CAAiB3tC,IAAI,CAAC04C,IAAL,CAAU30C,CAAV,CAAjB,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC/D,IAAI,CAAC04C,IAAL,CAAUlvD,CAAV,CAArC,EAAmD2uD,IAAnD,EAAyDE,IAAzD;IACA3gC,GAAG,CAACkF,SAAJ,CAAc66B,MAAd,EAAsBC,IAAtB,EAA4BC,IAA5B,EAAkCC,IAAlC,EAAwCC,IAAxC,EAA8C,CAA9C,EAAiD,CAAjD,EAAoDU,MAApD,EAA4DE,OAA5D;IACA/gC,GAAG,CAACi2B,YAAJ,CAAiB5pC,CAAjB,EAAoBtB,CAApB,EAAuBuB,CAAvB,EAA0Bxa,CAA1B,EAA6BwoC,EAA7B,EAAiCC,EAAjC;IACA,OAAO,CAACsmB,MAAD,EAASE,OAAT,CAAP;EACD;;EACD,IAAI10C,CAAC,KAAK,CAAN,IAAWva,CAAC,KAAK,CAArB,EAAwB;IACtB,MAAM0uD,GAAG,GAAGH,KAAK,GAAG/zC,CAAR,GAAYguB,EAAxB;IACA,MAAMmmB,IAAI,GAAGn4C,IAAI,CAAC0P,KAAL,CAAWwoC,GAAX,CAAb;IACA,MAAME,GAAG,GAAGN,KAAK,GAAGr1C,CAAR,GAAYwvB,EAAxB;IACA,MAAMomB,IAAI,GAAGr4C,IAAI,CAAC0P,KAAL,CAAW0oC,GAAX,CAAb;IACA,MAAME,GAAG,GAAG,CAACP,KAAK,GAAGE,KAAT,IAAkBj0C,CAAlB,GAAsBguB,EAAlC;IACA,MAAMumB,MAAM,GAAGv4C,IAAI,CAAC+F,GAAL,CAAS/F,IAAI,CAAC0P,KAAL,CAAW4oC,GAAX,IAAkBH,IAA3B,KAAoC,CAAnD;IACA,MAAMK,GAAG,GAAG,CAACV,KAAK,GAAGE,KAAT,IAAkBv1C,CAAlB,GAAsBwvB,EAAlC;IACA,MAAMwmB,OAAO,GAAGz4C,IAAI,CAAC+F,GAAL,CAAS/F,IAAI,CAAC0P,KAAL,CAAW8oC,GAAX,IAAkBH,IAA3B,KAAoC,CAApD;IACA3gC,GAAG,CAACi2B,YAAJ,CAAiB,CAAjB,EAAoB3tC,IAAI,CAAC04C,IAAL,CAAUj2C,CAAV,CAApB,EAAkCzC,IAAI,CAAC04C,IAAL,CAAU10C,CAAV,CAAlC,EAAgD,CAAhD,EAAmDm0C,IAAnD,EAAyDE,IAAzD;IACA3gC,GAAG,CAACkF,SAAJ,CAAc66B,MAAd,EAAsBC,IAAtB,EAA4BC,IAA5B,EAAkCC,IAAlC,EAAwCC,IAAxC,EAA8C,CAA9C,EAAiD,CAAjD,EAAoDY,OAApD,EAA6DF,MAA7D;IACA7gC,GAAG,CAACi2B,YAAJ,CAAiB5pC,CAAjB,EAAoBtB,CAApB,EAAuBuB,CAAvB,EAA0Bxa,CAA1B,EAA6BwoC,EAA7B,EAAiCC,EAAjC;IACA,OAAO,CAACwmB,OAAD,EAAUF,MAAV,CAAP;EACD;;EACD7gC,GAAG,CAACkF,SAAJ,CAAc66B,MAAd,EAAsBC,IAAtB,EAA4BC,IAA5B,EAAkCC,IAAlC,EAAwCC,IAAxC,EAA8CC,KAA9C,EAAqDC,KAArD,EAA4DC,KAA5D,EAAmEC,KAAnE;EACA,MAAM9J,MAAM,GAAGnuC,IAAI,CAACi+B,KAAL,CAAWl6B,CAAX,EAActB,CAAd,CAAf;EACA,MAAM2rC,MAAM,GAAGpuC,IAAI,CAACi+B,KAAL,CAAWj6B,CAAX,EAAcxa,CAAd,CAAf;EACA,OAAO,CAAC2kD,MAAM,GAAG6J,KAAV,EAAiB5J,MAAM,GAAG6J,KAA1B,CAAP;AACD;;AACD,SAASU,iBAAT,CAA2BC,OAA3B,EAAoC;EAClC,MAAM;IACJpuC,KADI;IAEJC;EAFI,IAGFmuC,OAHJ;;EAIA,IAAIpuC,KAAK,GAAG4qC,mBAAR,IAA+B3qC,MAAM,GAAG2qC,mBAA5C,EAAiE;IAC/D,OAAO,IAAP;EACD;;EACD,MAAMyD,sBAAsB,GAAG,IAA/B;EACA,MAAMC,WAAW,GAAG,IAAIt4C,UAAJ,CAAe,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4B,EAA5B,EAAgC,CAAhC,EAAmC,CAAnC,EAAsC,CAAtC,EAAyC,CAAzC,EAA4C,CAA5C,EAA+C,CAA/C,CAAf,CAApB;EACA,MAAMu4C,MAAM,GAAGvuC,KAAK,GAAG,CAAvB;EACA,IAAIwuC,MAAM,GAAG,IAAIx4C,UAAJ,CAAeu4C,MAAM,IAAItuC,MAAM,GAAG,CAAb,CAArB,CAAb;EACA,IAAI3K,CAAJ,EAAOuQ,CAAP,EAAU4oC,EAAV;EACA,MAAMC,QAAQ,GAAG1uC,KAAK,GAAG,CAAR,GAAY,CAAC,CAA9B;EACA,IAAIoI,IAAI,GAAG,IAAIpS,UAAJ,CAAe04C,QAAQ,GAAGzuC,MAA1B,CAAX;EAAA,IACE0uC,GAAG,GAAG,CADR;;EAEA,KAAK,MAAM3E,IAAX,IAAmBoE,OAAO,CAAChmC,IAA3B,EAAiC;IAC/B,IAAIwmC,IAAI,GAAG,GAAX;;IACA,OAAOA,IAAI,GAAG,CAAd,EAAiB;MACfxmC,IAAI,CAACumC,GAAG,EAAJ,CAAJ,GAAc3E,IAAI,GAAG4E,IAAP,GAAc,CAAd,GAAkB,GAAhC;MACAA,IAAI,KAAK,CAAT;IACD;EACF;;EACD,IAAI1U,KAAK,GAAG,CAAZ;EACAyU,GAAG,GAAG,CAAN;;EACA,IAAIvmC,IAAI,CAACumC,GAAD,CAAJ,KAAc,CAAlB,EAAqB;IACnBH,MAAM,CAAC,CAAD,CAAN,GAAY,CAAZ;IACA,EAAEtU,KAAF;EACD;;EACD,KAAKr0B,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG7F,KAAhB,EAAuB6F,CAAC,EAAxB,EAA4B;IAC1B,IAAIuC,IAAI,CAACumC,GAAD,CAAJ,KAAcvmC,IAAI,CAACumC,GAAG,GAAG,CAAP,CAAtB,EAAiC;MAC/BH,MAAM,CAAC3oC,CAAD,CAAN,GAAYuC,IAAI,CAACumC,GAAD,CAAJ,GAAY,CAAZ,GAAgB,CAA5B;MACA,EAAEzU,KAAF;IACD;;IACDyU,GAAG;EACJ;;EACD,IAAIvmC,IAAI,CAACumC,GAAD,CAAJ,KAAc,CAAlB,EAAqB;IACnBH,MAAM,CAAC3oC,CAAD,CAAN,GAAY,CAAZ;IACA,EAAEq0B,KAAF;EACD;;EACD,KAAK5kC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG2K,MAAhB,EAAwB3K,CAAC,EAAzB,EAA6B;IAC3Bq5C,GAAG,GAAGr5C,CAAC,GAAGo5C,QAAV;IACAD,EAAE,GAAGn5C,CAAC,GAAGi5C,MAAT;;IACA,IAAInmC,IAAI,CAACumC,GAAG,GAAGD,QAAP,CAAJ,KAAyBtmC,IAAI,CAACumC,GAAD,CAAjC,EAAwC;MACtCH,MAAM,CAACC,EAAD,CAAN,GAAarmC,IAAI,CAACumC,GAAD,CAAJ,GAAY,CAAZ,GAAgB,CAA7B;MACA,EAAEzU,KAAF;IACD;;IACD,IAAI2U,GAAG,GAAG,CAACzmC,IAAI,CAACumC,GAAD,CAAJ,GAAY,CAAZ,GAAgB,CAAjB,KAAuBvmC,IAAI,CAACumC,GAAG,GAAGD,QAAP,CAAJ,GAAuB,CAAvB,GAA2B,CAAlD,CAAV;;IACA,KAAK7oC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG7F,KAAhB,EAAuB6F,CAAC,EAAxB,EAA4B;MAC1BgpC,GAAG,GAAG,CAACA,GAAG,IAAI,CAAR,KAAczmC,IAAI,CAACumC,GAAG,GAAG,CAAP,CAAJ,GAAgB,CAAhB,GAAoB,CAAlC,KAAwCvmC,IAAI,CAACumC,GAAG,GAAGD,QAAN,GAAiB,CAAlB,CAAJ,GAA2B,CAA3B,GAA+B,CAAvE,CAAN;;MACA,IAAIJ,WAAW,CAACO,GAAD,CAAf,EAAsB;QACpBL,MAAM,CAACC,EAAE,GAAG5oC,CAAN,CAAN,GAAiByoC,WAAW,CAACO,GAAD,CAA5B;QACA,EAAE3U,KAAF;MACD;;MACDyU,GAAG;IACJ;;IACD,IAAIvmC,IAAI,CAACumC,GAAG,GAAGD,QAAP,CAAJ,KAAyBtmC,IAAI,CAACumC,GAAD,CAAjC,EAAwC;MACtCH,MAAM,CAACC,EAAE,GAAG5oC,CAAN,CAAN,GAAiBuC,IAAI,CAACumC,GAAD,CAAJ,GAAY,CAAZ,GAAgB,CAAjC;MACA,EAAEzU,KAAF;IACD;;IACD,IAAIA,KAAK,GAAGmU,sBAAZ,EAAoC;MAClC,OAAO,IAAP;IACD;EACF;;EACDM,GAAG,GAAGD,QAAQ,IAAIzuC,MAAM,GAAG,CAAb,CAAd;EACAwuC,EAAE,GAAGn5C,CAAC,GAAGi5C,MAAT;;EACA,IAAInmC,IAAI,CAACumC,GAAD,CAAJ,KAAc,CAAlB,EAAqB;IACnBH,MAAM,CAACC,EAAD,CAAN,GAAa,CAAb;IACA,EAAEvU,KAAF;EACD;;EACD,KAAKr0B,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG7F,KAAhB,EAAuB6F,CAAC,EAAxB,EAA4B;IAC1B,IAAIuC,IAAI,CAACumC,GAAD,CAAJ,KAAcvmC,IAAI,CAACumC,GAAG,GAAG,CAAP,CAAtB,EAAiC;MAC/BH,MAAM,CAACC,EAAE,GAAG5oC,CAAN,CAAN,GAAiBuC,IAAI,CAACumC,GAAD,CAAJ,GAAY,CAAZ,GAAgB,CAAjC;MACA,EAAEzU,KAAF;IACD;;IACDyU,GAAG;EACJ;;EACD,IAAIvmC,IAAI,CAACumC,GAAD,CAAJ,KAAc,CAAlB,EAAqB;IACnBH,MAAM,CAACC,EAAE,GAAG5oC,CAAN,CAAN,GAAiB,CAAjB;IACA,EAAEq0B,KAAF;EACD;;EACD,IAAIA,KAAK,GAAGmU,sBAAZ,EAAoC;IAClC,OAAO,IAAP;EACD;;EACD,MAAMS,KAAK,GAAG,IAAIC,UAAJ,CAAe,CAAC,CAAD,EAAIR,MAAJ,EAAY,CAAC,CAAb,EAAgB,CAAhB,EAAmB,CAACA,MAApB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,CAArC,CAAf,CAAd;EACA,MAAMS,IAAI,GAAG,IAAIlO,MAAJ,EAAb;;EACA,KAAKxrC,CAAC,GAAG,CAAT,EAAY4kC,KAAK,IAAI5kC,CAAC,IAAI2K,MAA1B,EAAkC3K,CAAC,EAAnC,EAAuC;IACrC,IAAIkD,CAAC,GAAGlD,CAAC,GAAGi5C,MAAZ;IACA,MAAM5pC,GAAG,GAAGnM,CAAC,GAAGwH,KAAhB;;IACA,OAAOxH,CAAC,GAAGmM,GAAJ,IAAW,CAAC6pC,MAAM,CAACh2C,CAAD,CAAzB,EAA8B;MAC5BA,CAAC;IACF;;IACD,IAAIA,CAAC,KAAKmM,GAAV,EAAe;MACb;IACD;;IACDqqC,IAAI,CAAC9hD,MAAL,CAAYsL,CAAC,GAAG+1C,MAAhB,EAAwBj5C,CAAxB;IACA,MAAM25C,EAAE,GAAGz2C,CAAX;IACA,IAAIrV,IAAI,GAAGqrD,MAAM,CAACh2C,CAAD,CAAjB;;IACA,GAAG;MACD,MAAMgN,IAAI,GAAGspC,KAAK,CAAC3rD,IAAD,CAAlB;;MACA,GAAG;QACDqV,CAAC,IAAIgN,IAAL;MACD,CAFD,QAES,CAACgpC,MAAM,CAACh2C,CAAD,CAFhB;;MAGA,MAAM02C,EAAE,GAAGV,MAAM,CAACh2C,CAAD,CAAjB;;MACA,IAAI02C,EAAE,KAAK,CAAP,IAAYA,EAAE,KAAK,EAAvB,EAA2B;QACzB/rD,IAAI,GAAG+rD,EAAP;QACAV,MAAM,CAACh2C,CAAD,CAAN,GAAY,CAAZ;MACD,CAHD,MAGO;QACLrV,IAAI,GAAG+rD,EAAE,GAAG,OAAO/rD,IAAP,IAAe,CAA3B;QACAqrD,MAAM,CAACh2C,CAAD,CAAN,IAAarV,IAAI,IAAI,CAAR,GAAYA,IAAI,IAAI,CAAjC;MACD;;MACD6rD,IAAI,CAAC7hD,MAAL,CAAYqL,CAAC,GAAG+1C,MAAhB,EAAwB/1C,CAAC,GAAG+1C,MAAJ,GAAa,CAArC;;MACA,IAAI,CAACC,MAAM,CAACh2C,CAAD,CAAX,EAAgB;QACd,EAAE0hC,KAAF;MACD;IACF,CAjBD,QAiBS+U,EAAE,KAAKz2C,CAjBhB;;IAkBA,EAAElD,CAAF;EACD;;EACD8S,IAAI,GAAG,IAAP;EACAomC,MAAM,GAAG,IAAT;;EACA,MAAMW,WAAW,GAAG,UAAU31C,CAAV,EAAa;IAC/BA,CAAC,CAACzM,IAAF;IACAyM,CAAC,CAACkP,KAAF,CAAQ,IAAI1I,KAAZ,EAAmB,CAAC,CAAD,GAAKC,MAAxB;IACAzG,CAAC,CAACk2B,SAAF,CAAY,CAAZ,EAAe,CAACzvB,MAAhB;IACAzG,CAAC,CAAC7L,IAAF,CAAOqhD,IAAP;IACAx1C,CAAC,CAACqpC,SAAF;IACArpC,CAAC,CAACxM,OAAF;EACD,CAPD;;EAQA,OAAOmiD,WAAP;AACD;;AACD,MAAMC,gBAAN,CAAuB;EACrB76C,WAAW,CAACyL,KAAD,EAAQC,MAAR,EAAgB;IACzB,KAAKovC,YAAL,GAAoB,KAApB;IACA,KAAKC,QAAL,GAAgB,CAAhB;IACA,KAAKC,aAAL,GAAqB,CAArB;IACA,KAAKC,UAAL,GAAkBpsD,eAAlB;IACA,KAAKqsD,eAAL,GAAuB,CAAvB;IACA,KAAKC,UAAL,GAAkBrsD,oBAAlB;IACA,KAAKssD,OAAL,GAAe,CAAf;IACA,KAAKv0C,CAAL,GAAS,CAAT;IACA,KAAKC,CAAL,GAAS,CAAT;IACA,KAAKu0C,KAAL,GAAa,CAAb;IACA,KAAKC,KAAL,GAAa,CAAb;IACA,KAAKC,WAAL,GAAmB,CAAnB;IACA,KAAKC,WAAL,GAAmB,CAAnB;IACA,KAAKC,UAAL,GAAkB,CAAlB;IACA,KAAKC,iBAAL,GAAyB/pD,iBAAiB,CAACC,IAA3C;IACA,KAAK+pD,QAAL,GAAgB,CAAhB;IACA,KAAKpH,SAAL,GAAiB,SAAjB;IACA,KAAKC,WAAL,GAAmB,SAAnB;IACA,KAAKoH,WAAL,GAAmB,KAAnB;IACA,KAAKC,SAAL,GAAiB,CAAjB;IACA,KAAKC,WAAL,GAAmB,CAAnB;IACA,KAAKC,SAAL,GAAiB,CAAjB;IACA,KAAKC,WAAL,GAAmB,IAAnB;IACA,KAAKC,YAAL,GAAoB,MAApB;IACA,KAAKC,sBAAL,CAA4B,CAAC,CAAD,EAAI,CAAJ,EAAOzwC,KAAP,EAAcC,MAAd,CAA5B;EACD;;EACD2J,KAAK,GAAG;IACN,MAAMA,KAAK,GAAGvqB,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAd;IACAqT,KAAK,CAAC8mC,OAAN,GAAgB,KAAKA,OAAL,CAAa13C,KAAb,EAAhB;IACA,OAAO4Q,KAAP;EACD;;EACD+mC,eAAe,CAACv1C,CAAD,EAAIC,CAAJ,EAAO;IACpB,KAAKD,CAAL,GAASA,CAAT;IACA,KAAKC,CAAL,GAASA,CAAT;EACD;;EACDu1C,gBAAgB,CAAC3jD,SAAD,EAAYmO,CAAZ,EAAeC,CAAf,EAAkB;IAChC,CAACD,CAAD,EAAIC,CAAJ,IAASxZ,IAAI,CAAC0W,cAAL,CAAoB,CAAC6C,CAAD,EAAIC,CAAJ,CAApB,EAA4BpO,SAA5B,CAAT;IACA,KAAK4jD,IAAL,GAAYr7C,IAAI,CAACC,GAAL,CAAS,KAAKo7C,IAAd,EAAoBz1C,CAApB,CAAZ;IACA,KAAKkpC,IAAL,GAAY9uC,IAAI,CAACC,GAAL,CAAS,KAAK6uC,IAAd,EAAoBjpC,CAApB,CAAZ;IACA,KAAKy1C,IAAL,GAAYt7C,IAAI,CAAC2D,GAAL,CAAS,KAAK23C,IAAd,EAAoB11C,CAApB,CAAZ;IACA,KAAKmpC,IAAL,GAAY/uC,IAAI,CAAC2D,GAAL,CAAS,KAAKorC,IAAd,EAAoBlpC,CAApB,CAAZ;EACD;;EACDutC,gBAAgB,CAAC37C,SAAD,EAAY8M,IAAZ,EAAkB;IAChC,MAAMjB,EAAE,GAAGjX,IAAI,CAAC0W,cAAL,CAAoBwB,IAApB,EAA0B9M,SAA1B,CAAX;IACA,MAAM8L,EAAE,GAAGlX,IAAI,CAAC0W,cAAL,CAAoBwB,IAAI,CAACf,KAAL,CAAW,CAAX,CAApB,EAAmC/L,SAAnC,CAAX;IACA,MAAMgM,EAAE,GAAGpX,IAAI,CAAC0W,cAAL,CAAoB,CAACwB,IAAI,CAAC,CAAD,CAAL,EAAUA,IAAI,CAAC,CAAD,CAAd,CAApB,EAAwC9M,SAAxC,CAAX;IACA,MAAMiM,EAAE,GAAGrX,IAAI,CAAC0W,cAAL,CAAoB,CAACwB,IAAI,CAAC,CAAD,CAAL,EAAUA,IAAI,CAAC,CAAD,CAAd,CAApB,EAAwC9M,SAAxC,CAAX;IACA,KAAK4jD,IAAL,GAAYr7C,IAAI,CAACC,GAAL,CAAS,KAAKo7C,IAAd,EAAoB/3C,EAAE,CAAC,CAAD,CAAtB,EAA2BC,EAAE,CAAC,CAAD,CAA7B,EAAkCE,EAAE,CAAC,CAAD,CAApC,EAAyCC,EAAE,CAAC,CAAD,CAA3C,CAAZ;IACA,KAAKorC,IAAL,GAAY9uC,IAAI,CAACC,GAAL,CAAS,KAAK6uC,IAAd,EAAoBxrC,EAAE,CAAC,CAAD,CAAtB,EAA2BC,EAAE,CAAC,CAAD,CAA7B,EAAkCE,EAAE,CAAC,CAAD,CAApC,EAAyCC,EAAE,CAAC,CAAD,CAA3C,CAAZ;IACA,KAAK43C,IAAL,GAAYt7C,IAAI,CAAC2D,GAAL,CAAS,KAAK23C,IAAd,EAAoBh4C,EAAE,CAAC,CAAD,CAAtB,EAA2BC,EAAE,CAAC,CAAD,CAA7B,EAAkCE,EAAE,CAAC,CAAD,CAApC,EAAyCC,EAAE,CAAC,CAAD,CAA3C,CAAZ;IACA,KAAKqrC,IAAL,GAAY/uC,IAAI,CAAC2D,GAAL,CAAS,KAAKorC,IAAd,EAAoBzrC,EAAE,CAAC,CAAD,CAAtB,EAA2BC,EAAE,CAAC,CAAD,CAA7B,EAAkCE,EAAE,CAAC,CAAD,CAApC,EAAyCC,EAAE,CAAC,CAAD,CAA3C,CAAZ;EACD;;EACD63C,uBAAuB,CAAC9jD,SAAD,EAAYkL,MAAZ,EAAoB;IACzCtW,IAAI,CAACqW,WAAL,CAAiBjL,SAAjB,EAA4BkL,MAA5B;IACA,KAAK04C,IAAL,GAAYr7C,IAAI,CAACC,GAAL,CAAS,KAAKo7C,IAAd,EAAoB14C,MAAM,CAAC,CAAD,CAA1B,CAAZ;IACA,KAAKmsC,IAAL,GAAY9uC,IAAI,CAACC,GAAL,CAAS,KAAK6uC,IAAd,EAAoBnsC,MAAM,CAAC,CAAD,CAA1B,CAAZ;IACA,KAAK24C,IAAL,GAAYt7C,IAAI,CAAC2D,GAAL,CAAS,KAAK23C,IAAd,EAAoB34C,MAAM,CAAC,CAAD,CAA1B,CAAZ;IACA,KAAKosC,IAAL,GAAY/uC,IAAI,CAAC2D,GAAL,CAAS,KAAKorC,IAAd,EAAoBpsC,MAAM,CAAC,CAAD,CAA1B,CAAZ;EACD;;EACD64C,qBAAqB,CAAC/jD,SAAD,EAAYuN,EAAZ,EAAgBI,EAAhB,EAAoBH,EAApB,EAAwBI,EAAxB,EAA4BH,EAA5B,EAAgCI,EAAhC,EAAoCH,EAApC,EAAwCI,EAAxC,EAA4C5C,MAA5C,EAAoD;IACvE,MAAMkZ,GAAG,GAAGxvB,IAAI,CAAC8Z,iBAAL,CAAuBnB,EAAvB,EAA2BI,EAA3B,EAA+BH,EAA/B,EAAmCI,EAAnC,EAAuCH,EAAvC,EAA2CI,EAA3C,EAA+CH,EAA/C,EAAmDI,EAAnD,EAAuD5C,MAAvD,CAAZ;;IACA,IAAIA,MAAJ,EAAY;MACV;IACD;;IACD,KAAKywC,gBAAL,CAAsB37C,SAAtB,EAAiCokB,GAAjC;EACD;;EACD4/B,kBAAkB,CAAC/O,QAAQ,GAAGzB,QAAQ,CAACt6C,IAArB,EAA2B8G,SAAS,GAAG,IAAvC,EAA6C;IAC7D,MAAMokB,GAAG,GAAG,CAAC,KAAKw/B,IAAN,EAAY,KAAKvM,IAAjB,EAAuB,KAAKwM,IAA5B,EAAkC,KAAKvM,IAAvC,CAAZ;;IACA,IAAIrC,QAAQ,KAAKzB,QAAQ,CAACr6C,MAA1B,EAAkC;MAChC,IAAI,CAAC6G,SAAL,EAAgB;QACd4F,WAAW,CAAC,6CAAD,CAAX;MACD;;MACD,MAAM6V,KAAK,GAAG7mB,IAAI,CAACwX,6BAAL,CAAmCpM,SAAnC,CAAd;MACA,MAAMikD,UAAU,GAAGxoC,KAAK,CAAC,CAAD,CAAL,GAAW,KAAK4nC,SAAhB,GAA4B,CAA/C;MACA,MAAMa,UAAU,GAAGzoC,KAAK,CAAC,CAAD,CAAL,GAAW,KAAK4nC,SAAhB,GAA4B,CAA/C;MACAj/B,GAAG,CAAC,CAAD,CAAH,IAAU6/B,UAAV;MACA7/B,GAAG,CAAC,CAAD,CAAH,IAAU8/B,UAAV;MACA9/B,GAAG,CAAC,CAAD,CAAH,IAAU6/B,UAAV;MACA7/B,GAAG,CAAC,CAAD,CAAH,IAAU8/B,UAAV;IACD;;IACD,OAAO9/B,GAAP;EACD;;EACD+/B,kBAAkB,GAAG;IACnB,MAAMp3C,SAAS,GAAGnY,IAAI,CAACmY,SAAL,CAAe,KAAK02C,OAApB,EAA6B,KAAKO,kBAAL,EAA7B,CAAlB;IACA,KAAKR,sBAAL,CAA4Bz2C,SAAS,IAAI,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAzC;EACD;;EACDq3C,WAAW,GAAG;IACZ,OAAO,KAAKR,IAAL,KAAcS,QAArB;EACD;;EACDb,sBAAsB,CAACp/B,GAAD,EAAM;IAC1B,KAAKq/B,OAAL,GAAer/B,GAAf;IACA,KAAKw/B,IAAL,GAAYS,QAAZ;IACA,KAAKhN,IAAL,GAAYgN,QAAZ;IACA,KAAKR,IAAL,GAAY,CAAZ;IACA,KAAKvM,IAAL,GAAY,CAAZ;EACD;;EACDjC,yBAAyB,CAACJ,QAAQ,GAAGzB,QAAQ,CAACt6C,IAArB,EAA2B8G,SAAS,GAAG,IAAvC,EAA6C;IACpE,OAAOpL,IAAI,CAACmY,SAAL,CAAe,KAAK02C,OAApB,EAA6B,KAAKO,kBAAL,CAAwB/O,QAAxB,EAAkCj1C,SAAlC,CAA7B,CAAP;EACD;;AApGoB;;AAsGvB,SAASskD,kBAAT,CAA4BrkC,GAA5B,EAAiCkhC,OAAjC,EAA0C;EACxC,IAAI,OAAOoD,SAAP,KAAqB,WAArB,IAAoCpD,OAAO,YAAYoD,SAA3D,EAAsE;IACpEtkC,GAAG,CAACw5B,YAAJ,CAAiB0H,OAAjB,EAA0B,CAA1B,EAA6B,CAA7B;IACA;EACD;;EACD,MAAMnuC,MAAM,GAAGmuC,OAAO,CAACnuC,MAAvB;EAAA,MACED,KAAK,GAAGouC,OAAO,CAACpuC,KADlB;EAEA,MAAMyxC,kBAAkB,GAAGxxC,MAAM,GAAG4qC,iBAApC;EACA,MAAM6G,UAAU,GAAG,CAACzxC,MAAM,GAAGwxC,kBAAV,IAAgC5G,iBAAnD;EACA,MAAM8G,WAAW,GAAGF,kBAAkB,KAAK,CAAvB,GAA2BC,UAA3B,GAAwCA,UAAU,GAAG,CAAzE;EACA,MAAME,YAAY,GAAG1kC,GAAG,CAACu5B,eAAJ,CAAoBzmC,KAApB,EAA2B6qC,iBAA3B,CAArB;EACA,IAAIxB,MAAM,GAAG,CAAb;EAAA,IACEU,OADF;EAEA,MAAM73B,GAAG,GAAGk8B,OAAO,CAAChmC,IAApB;EACA,MAAMkhC,IAAI,GAAGsI,YAAY,CAACxpC,IAA1B;EACA,IAAI9S,CAAJ,EAAOuQ,CAAP,EAAUgsC,eAAV,EAA2BC,gBAA3B;;EACA,IAAI1D,OAAO,CAAClF,IAAR,KAAiBloD,cAAc,CAAC6F,cAApC,EAAoD;IAClD,MAAMijD,SAAS,GAAG53B,GAAG,CAAC2lB,UAAtB;IACA,MAAMka,MAAM,GAAG,IAAIp7C,WAAJ,CAAgB2yC,IAAI,CAAC1yC,MAArB,EAA6B,CAA7B,EAAgC0yC,IAAI,CAACzR,UAAL,IAAmB,CAAnD,CAAf;IACA,MAAMma,gBAAgB,GAAGD,MAAM,CAACr+C,MAAhC;IACA,MAAMu+C,WAAW,GAAGjyC,KAAK,GAAG,CAAR,IAAa,CAAjC;IACA,MAAMkyC,KAAK,GAAG,UAAd;IACA,MAAMzI,KAAK,GAAG5oD,gBAAgB,CAAC2V,cAAjB,GAAkC,UAAlC,GAA+C,UAA7D;;IACA,KAAKlB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGq8C,WAAhB,EAA6Br8C,CAAC,EAA9B,EAAkC;MAChCu8C,eAAe,GAAGv8C,CAAC,GAAGo8C,UAAJ,GAAiB7G,iBAAjB,GAAqC4G,kBAAvD;MACA1H,OAAO,GAAG,CAAV;;MACA,KAAKlkC,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGgsC,eAAhB,EAAiChsC,CAAC,EAAlC,EAAsC;QACpC,MAAMssC,OAAO,GAAGrI,SAAS,GAAGT,MAA5B;QACA,IAAIzjC,CAAC,GAAG,CAAR;QACA,MAAMwsC,IAAI,GAAGD,OAAO,GAAGF,WAAV,GAAwBjyC,KAAxB,GAAgCmyC,OAAO,GAAG,CAAV,GAAc,CAA3D;QACA,MAAME,YAAY,GAAGD,IAAI,GAAG,CAAC,CAA7B;QACA,IAAIxD,IAAI,GAAG,CAAX;QACA,IAAI0D,OAAO,GAAG,CAAd;;QACA,OAAO1sC,CAAC,GAAGysC,YAAX,EAAyBzsC,CAAC,IAAI,CAA9B,EAAiC;UAC/B0sC,OAAO,GAAGpgC,GAAG,CAACm3B,MAAM,EAAP,CAAb;UACA0I,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoBuI,OAAO,GAAG,GAAV,GAAgBJ,KAAhB,GAAwBzI,KAA5C;UACAsI,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoBuI,OAAO,GAAG,EAAV,GAAeJ,KAAf,GAAuBzI,KAA3C;UACAsI,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoBuI,OAAO,GAAG,EAAV,GAAeJ,KAAf,GAAuBzI,KAA3C;UACAsI,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoBuI,OAAO,GAAG,EAAV,GAAeJ,KAAf,GAAuBzI,KAA3C;UACAsI,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoBuI,OAAO,GAAG,CAAV,GAAcJ,KAAd,GAAsBzI,KAA1C;UACAsI,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoBuI,OAAO,GAAG,CAAV,GAAcJ,KAAd,GAAsBzI,KAA1C;UACAsI,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoBuI,OAAO,GAAG,CAAV,GAAcJ,KAAd,GAAsBzI,KAA1C;UACAsI,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoBuI,OAAO,GAAG,CAAV,GAAcJ,KAAd,GAAsBzI,KAA1C;QACD;;QACD,OAAO7jC,CAAC,GAAGwsC,IAAX,EAAiBxsC,CAAC,EAAlB,EAAsB;UACpB,IAAIgpC,IAAI,KAAK,CAAb,EAAgB;YACd0D,OAAO,GAAGpgC,GAAG,CAACm3B,MAAM,EAAP,CAAb;YACAuF,IAAI,GAAG,GAAP;UACD;;UACDmD,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoBuI,OAAO,GAAG1D,IAAV,GAAiBsD,KAAjB,GAAyBzI,KAA7C;UACAmF,IAAI,KAAK,CAAT;QACD;MACF;;MACD,OAAO7E,OAAO,GAAGiI,gBAAjB,EAAmC;QACjCD,MAAM,CAAChI,OAAO,EAAR,CAAN,GAAoB,CAApB;MACD;;MACD78B,GAAG,CAACw5B,YAAJ,CAAiBkL,YAAjB,EAA+B,CAA/B,EAAkCt8C,CAAC,GAAGu1C,iBAAtC;IACD;EACF,CA1CD,MA0CO,IAAIuD,OAAO,CAAClF,IAAR,KAAiBloD,cAAc,CAAC+F,UAApC,EAAgD;IACrD8e,CAAC,GAAG,CAAJ;IACAisC,gBAAgB,GAAG9xC,KAAK,GAAG6qC,iBAAR,GAA4B,CAA/C;;IACA,KAAKv1C,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGo8C,UAAhB,EAA4Bp8C,CAAC,EAA7B,EAAiC;MAC/Bg0C,IAAI,CAACvlC,GAAL,CAASmO,GAAG,CAACvc,QAAJ,CAAa0zC,MAAb,EAAqBA,MAAM,GAAGyI,gBAA9B,CAAT;MACAzI,MAAM,IAAIyI,gBAAV;MACA5kC,GAAG,CAACw5B,YAAJ,CAAiBkL,YAAjB,EAA+B,CAA/B,EAAkC/rC,CAAlC;MACAA,CAAC,IAAIglC,iBAAL;IACD;;IACD,IAAIv1C,CAAC,GAAGq8C,WAAR,EAAqB;MACnBG,gBAAgB,GAAG9xC,KAAK,GAAGyxC,kBAAR,GAA6B,CAAhD;MACAnI,IAAI,CAACvlC,GAAL,CAASmO,GAAG,CAACvc,QAAJ,CAAa0zC,MAAb,EAAqBA,MAAM,GAAGyI,gBAA9B,CAAT;MACA5kC,GAAG,CAACw5B,YAAJ,CAAiBkL,YAAjB,EAA+B,CAA/B,EAAkC/rC,CAAlC;IACD;EACF,CAdM,MAcA,IAAIuoC,OAAO,CAAClF,IAAR,KAAiBloD,cAAc,CAAC8F,SAApC,EAA+C;IACpD+qD,eAAe,GAAGhH,iBAAlB;IACAiH,gBAAgB,GAAG9xC,KAAK,GAAG6xC,eAA3B;;IACA,KAAKv8C,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGq8C,WAAhB,EAA6Br8C,CAAC,EAA9B,EAAkC;MAChC,IAAIA,CAAC,IAAIo8C,UAAT,EAAqB;QACnBG,eAAe,GAAGJ,kBAAlB;QACAK,gBAAgB,GAAG9xC,KAAK,GAAG6xC,eAA3B;MACD;;MACD9H,OAAO,GAAG,CAAV;;MACA,KAAKlkC,CAAC,GAAGisC,gBAAT,EAA2BjsC,CAAC,EAA5B,GAAiC;QAC/ByjC,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkB73B,GAAG,CAACm3B,MAAM,EAAP,CAArB;QACAC,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkB73B,GAAG,CAACm3B,MAAM,EAAP,CAArB;QACAC,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkB73B,GAAG,CAACm3B,MAAM,EAAP,CAArB;QACAC,IAAI,CAACS,OAAO,EAAR,CAAJ,GAAkB,GAAlB;MACD;;MACD78B,GAAG,CAACw5B,YAAJ,CAAiBkL,YAAjB,EAA+B,CAA/B,EAAkCt8C,CAAC,GAAGu1C,iBAAtC;IACD;EACF,CAjBM,MAiBA;IACL,MAAM,IAAI/3C,KAAJ,CAAW,mBAAkBs7C,OAAO,CAAClF,IAAK,EAA1C,CAAN;EACD;AACF;;AACD,SAASqJ,kBAAT,CAA4BrlC,GAA5B,EAAiCkhC,OAAjC,EAA0C;EACxC,IAAIA,OAAO,CAAC77B,MAAZ,EAAoB;IAClBrF,GAAG,CAACkF,SAAJ,CAAcg8B,OAAO,CAAC77B,MAAtB,EAA8B,CAA9B,EAAiC,CAAjC;IACA;EACD;;EACD,MAAMtS,MAAM,GAAGmuC,OAAO,CAACnuC,MAAvB;EAAA,MACED,KAAK,GAAGouC,OAAO,CAACpuC,KADlB;EAEA,MAAMyxC,kBAAkB,GAAGxxC,MAAM,GAAG4qC,iBAApC;EACA,MAAM6G,UAAU,GAAG,CAACzxC,MAAM,GAAGwxC,kBAAV,IAAgC5G,iBAAnD;EACA,MAAM8G,WAAW,GAAGF,kBAAkB,KAAK,CAAvB,GAA2BC,UAA3B,GAAwCA,UAAU,GAAG,CAAzE;EACA,MAAME,YAAY,GAAG1kC,GAAG,CAACu5B,eAAJ,CAAoBzmC,KAApB,EAA2B6qC,iBAA3B,CAArB;EACA,IAAIxB,MAAM,GAAG,CAAb;EACA,MAAMn3B,GAAG,GAAGk8B,OAAO,CAAChmC,IAApB;EACA,MAAMkhC,IAAI,GAAGsI,YAAY,CAACxpC,IAA1B;;EACA,KAAK,IAAI9S,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGq8C,WAApB,EAAiCr8C,CAAC,EAAlC,EAAsC;IACpC,MAAMu8C,eAAe,GAAGv8C,CAAC,GAAGo8C,UAAJ,GAAiB7G,iBAAjB,GAAqC4G,kBAA7D;IACA,CAAC;MACCpI;IADD,IAEGF,0BAA0B,CAAC;MAC7Bj3B,GAD6B;MAE7Bm3B,MAF6B;MAG7BC,IAH6B;MAI7BtpC,KAJ6B;MAK7BC,MAAM,EAAE4xC,eALqB;MAM7BtI,aAAa,EAAE;IANc,CAAD,CAF9B;IAUAr8B,GAAG,CAACw5B,YAAJ,CAAiBkL,YAAjB,EAA+B,CAA/B,EAAkCt8C,CAAC,GAAGu1C,iBAAtC;EACD;AACF;;AACD,SAAS2H,YAAT,CAAsBC,SAAtB,EAAiC1H,OAAjC,EAA0C;EACxC,MAAM2H,UAAU,GAAG,CAAC,aAAD,EAAgB,WAAhB,EAA6B,UAA7B,EAAyC,aAAzC,EAAwD,WAAxD,EAAqE,SAArE,EAAgF,UAAhF,EAA4F,YAA5F,EAA0G,0BAA1G,EAAsI,MAAtI,EAA8I,QAA9I,CAAnB;;EACA,KAAK,MAAMC,QAAX,IAAuBD,UAAvB,EAAmC;IACjC,IAAID,SAAS,CAACE,QAAD,CAAT,KAAwB39C,SAA5B,EAAuC;MACrC+1C,OAAO,CAAC4H,QAAD,CAAP,GAAoBF,SAAS,CAACE,QAAD,CAA7B;IACD;EACF;;EACD,IAAIF,SAAS,CAACG,WAAV,KAA0B59C,SAA9B,EAAyC;IACvC+1C,OAAO,CAAC6H,WAAR,CAAoBH,SAAS,CAACI,WAAV,EAApB;IACA9H,OAAO,CAAC+H,cAAR,GAAyBL,SAAS,CAACK,cAAnC;EACD;AACF;;AACD,SAASC,iBAAT,CAA2B7lC,GAA3B,EAAgC;EAC9BA,GAAG,CAAC27B,WAAJ,GAAkB37B,GAAG,CAAC61B,SAAJ,GAAgB,SAAlC;EACA71B,GAAG,CAAC8lC,QAAJ,GAAe,SAAf;EACA9lC,GAAG,CAAC+lC,WAAJ,GAAkB,CAAlB;EACA/lC,GAAG,CAACojC,SAAJ,GAAgB,CAAhB;EACApjC,GAAG,CAACgmC,OAAJ,GAAc,MAAd;EACAhmC,GAAG,CAACimC,QAAJ,GAAe,OAAf;EACAjmC,GAAG,CAACkmC,UAAJ,GAAiB,EAAjB;EACAlmC,GAAG,CAACmmC,wBAAJ,GAA+B,aAA/B;EACAnmC,GAAG,CAAC+uB,IAAJ,GAAW,iBAAX;;EACA,IAAI/uB,GAAG,CAAC0lC,WAAJ,KAAoB59C,SAAxB,EAAmC;IACjCkY,GAAG,CAAC0lC,WAAJ,CAAgB,EAAhB;IACA1lC,GAAG,CAAC4lC,cAAJ,GAAqB,CAArB;EACD;;EACD,IAAI,CAAChwD,QAAL,EAAe;IACb,MAAM;MACJkhB;IADI,IAEFkJ,GAFJ;;IAGA,IAAIlJ,MAAM,KAAK,MAAX,IAAqBA,MAAM,KAAK,EAApC,EAAwC;MACtCkJ,GAAG,CAAClJ,MAAJ,GAAa,MAAb;IACD;EACF;AACF;;AACD,SAASsvC,wBAAT,CAAkCrmD,SAAlC,EAA6CsmD,WAA7C,EAA0D;EACxD,IAAIA,WAAJ,EAAiB;IACf,OAAO,IAAP;EACD;;EACD,MAAM7qC,KAAK,GAAG7mB,IAAI,CAACwX,6BAAL,CAAmCpM,SAAnC,CAAd;EACAyb,KAAK,CAAC,CAAD,CAAL,GAAWlT,IAAI,CAACg+C,MAAL,CAAY9qC,KAAK,CAAC,CAAD,CAAjB,CAAX;EACAA,KAAK,CAAC,CAAD,CAAL,GAAWlT,IAAI,CAACg+C,MAAL,CAAY9qC,KAAK,CAAC,CAAD,CAAjB,CAAX;EACA,MAAM+qC,WAAW,GAAGj+C,IAAI,CAACg+C,MAAL,CAAY,CAACzzD,UAAU,CAAC2zD,gBAAX,IAA+B,CAAhC,IAAqCjyD,aAAa,CAACigB,gBAA/D,CAApB;EACA,OAAOgH,KAAK,CAAC,CAAD,CAAL,IAAY+qC,WAAZ,IAA2B/qC,KAAK,CAAC,CAAD,CAAL,IAAY+qC,WAA9C;AACD;;AACD,MAAME,eAAe,GAAG,CAAC,MAAD,EAAS,OAAT,EAAkB,QAAlB,CAAxB;AACA,MAAMC,gBAAgB,GAAG,CAAC,OAAD,EAAU,OAAV,EAAmB,OAAnB,CAAzB;AACA,MAAMC,WAAW,GAAG,EAApB;AACA,MAAMC,OAAO,GAAG,EAAhB;;AACA,MAAMC,cAAN,CAAqB;EACnBx/C,WAAW,CAACy/C,SAAD,EAAYC,UAAZ,EAAwB/U,IAAxB,EAA8B4N,aAA9B,EAA6Cn1B,aAA7C,EAA4D;IACrEu8B,qBADqE;IAErEC,kBAAkB,GAAG;EAFgD,CAA5D,EAGRC,mBAHQ,EAGaz7B,UAHb,EAGyB;IAClC,KAAKzL,GAAL,GAAW8mC,SAAX;IACA,KAAK3R,OAAL,GAAe,IAAI+M,gBAAJ,CAAqB,KAAKliC,GAAL,CAAShN,MAAT,CAAgBF,KAArC,EAA4C,KAAKkN,GAAL,CAAShN,MAAT,CAAgBD,MAA5D,CAAf;IACA,KAAKo0C,UAAL,GAAkB,EAAlB;IACA,KAAKC,WAAL,GAAmB,IAAnB;IACA,KAAKC,aAAL,GAAqB,KAArB;IACA,KAAKC,GAAL,GAAW,IAAX;IACA,KAAKC,KAAL,GAAa,IAAb;IACA,KAAKR,UAAL,GAAkBA,UAAlB;IACA,KAAK/U,IAAL,GAAYA,IAAZ;IACA,KAAK4N,aAAL,GAAqBA,aAArB;IACA,KAAKn1B,aAAL,GAAqBA,aAArB;IACA,KAAK+8B,UAAL,GAAkB,EAAlB;IACA,KAAKC,eAAL,GAAuB,IAAvB;IACA,KAAK7R,aAAL,GAAqB,IAArB;IACA,KAAK8R,kBAAL,GAA0B,EAA1B;IACA,KAAK5M,UAAL,GAAkB,CAAlB;IACA,KAAK6M,UAAL,GAAkB,EAAlB;IACA,KAAKC,YAAL,GAAoB,CAApB;IACA,KAAKC,SAAL,GAAiB,IAAjB;IACA,KAAKC,YAAL,GAAoB,IAApB;IACA,KAAKC,cAAL,GAAsB,IAAtB;IACA,KAAKd,kBAAL,GAA0BA,kBAAkB,IAAI,EAAhD;IACA,KAAKD,qBAAL,GAA6BA,qBAA7B;IACA,KAAKzR,cAAL,GAAsB,IAAIoK,cAAJ,CAAmB,KAAKC,aAAxB,CAAtB;IACA,KAAKoI,cAAL,GAAsB,IAAIt3C,GAAJ,EAAtB;IACA,KAAKw2C,mBAAL,GAA2BA,mBAA3B;IACA,KAAKe,aAAL,GAAqB,CAArB;IACA,KAAKC,YAAL,GAAoB,CAApB;IACA,KAAKC,YAAL,GAAoB,CAApB;IACA,KAAK18B,UAAL,GAAkBA,UAAlB;IACA,KAAK28B,uBAAL,GAA+B,CAAC,CAAC,CAAF,EAAK,CAAL,CAA/B;IACA,KAAKC,0BAAL,GAAkC,IAAlC;IACA,KAAKC,iBAAL,GAAyB,IAAI53C,GAAJ,EAAzB;EACD;;EACD63C,SAAS,CAACrtC,IAAD,EAAOstC,QAAQ,GAAG,IAAlB,EAAwB;IAC/B,IAAI,OAAOttC,IAAP,KAAgB,QAApB,EAA8B;MAC5B,OAAOA,IAAI,CAAC7U,UAAL,CAAgB,IAAhB,IAAwB,KAAK0gD,UAAL,CAAgBz0D,GAAhB,CAAoB4oB,IAApB,CAAxB,GAAoD,KAAK82B,IAAL,CAAU1/C,GAAV,CAAc4oB,IAAd,CAA3D;IACD;;IACD,OAAOstC,QAAP;EACD;;EACDC,YAAY,CAAC;IACX1oD,SADW;IAEXsgB,QAFW;IAGXqoC,YAAY,GAAG,KAHJ;IAIXn5B,UAAU,GAAG;EAJF,CAAD,EAKT;IACD,MAAMzc,KAAK,GAAG,KAAKkN,GAAL,CAAShN,MAAT,CAAgBF,KAA9B;IACA,MAAMC,MAAM,GAAG,KAAKiN,GAAL,CAAShN,MAAT,CAAgBD,MAA/B;IACA,MAAM41C,cAAc,GAAG,KAAK3oC,GAAL,CAAS61B,SAAhC;IACA,KAAK71B,GAAL,CAAS61B,SAAT,GAAqBtmB,UAAU,IAAI,SAAnC;IACA,KAAKvP,GAAL,CAAS4oC,QAAT,CAAkB,CAAlB,EAAqB,CAArB,EAAwB91C,KAAxB,EAA+BC,MAA/B;IACA,KAAKiN,GAAL,CAAS61B,SAAT,GAAqB8S,cAArB;;IACA,IAAID,YAAJ,EAAkB;MAChB,MAAMG,iBAAiB,GAAG,KAAKtT,cAAL,CAAoBC,SAApB,CAA8B,aAA9B,EAA6C1iC,KAA7C,EAAoDC,MAApD,CAA1B;MACA,KAAK+1C,YAAL,GAAoB,KAAK9oC,GAAzB;MACA,KAAK6oC,iBAAL,GAAyBA,iBAAiB,CAAC71C,MAA3C;MACA,KAAKgN,GAAL,GAAW6oC,iBAAiB,CAAC31C,OAA7B;MACA,KAAK8M,GAAL,CAASngB,IAAT;MACA,KAAKmgB,GAAL,CAASjgB,SAAT,CAAmB,GAAGggB,mBAAmB,CAAC,KAAK+oC,YAAN,CAAzC;IACD;;IACD,KAAK9oC,GAAL,CAASngB,IAAT;IACAgmD,iBAAiB,CAAC,KAAK7lC,GAAN,CAAjB;;IACA,IAAIjgB,SAAJ,EAAe;MACb,KAAKigB,GAAL,CAASjgB,SAAT,CAAmB,GAAGA,SAAtB;MACA,KAAKmoD,YAAL,GAAoBnoD,SAAS,CAAC,CAAD,CAA7B;MACA,KAAKooD,YAAL,GAAoBpoD,SAAS,CAAC,CAAD,CAA7B;IACD;;IACD,KAAKigB,GAAL,CAASjgB,SAAT,CAAmB,GAAGsgB,QAAQ,CAACtgB,SAA/B;IACA,KAAKkoD,aAAL,GAAqB5nC,QAAQ,CAAC7E,KAA9B;IACA,KAAKo6B,aAAL,GAAqB71B,mBAAmB,CAAC,KAAKC,GAAN,CAAxC;EACD;;EACDq7B,mBAAmB,CAACnB,YAAD,EAAe6O,iBAAf,EAAkCC,gBAAlC,EAAoDC,OAApD,EAA6D;IAC9E,MAAMC,SAAS,GAAGhP,YAAY,CAACgP,SAA/B;IACA,MAAMC,OAAO,GAAGjP,YAAY,CAACiP,OAA7B;IACA,IAAI/gD,CAAC,GAAG2gD,iBAAiB,IAAI,CAA7B;IACA,MAAMK,YAAY,GAAGF,SAAS,CAAC1iD,MAA/B;;IACA,IAAI4iD,YAAY,KAAKhhD,CAArB,EAAwB;MACtB,OAAOA,CAAP;IACD;;IACD,MAAMihD,eAAe,GAAGD,YAAY,GAAGhhD,CAAf,GAAmBq1C,eAAnB,IAAsC,OAAOuL,gBAAP,KAA4B,UAA1F;IACA,MAAMM,OAAO,GAAGD,eAAe,GAAGp5C,IAAI,CAAC+N,GAAL,KAAaw/B,cAAhB,GAAiC,CAAhE;IACA,IAAIoE,KAAK,GAAG,CAAZ;IACA,MAAMmF,UAAU,GAAG,KAAKA,UAAxB;IACA,MAAM/U,IAAI,GAAG,KAAKA,IAAlB;IACA,IAAIuX,IAAJ;;IACA,OAAO,IAAP,EAAa;MACX,IAAIN,OAAO,KAAKnhD,SAAZ,IAAyBM,CAAC,KAAK6gD,OAAO,CAACO,cAA3C,EAA2D;QACzDP,OAAO,CAACQ,OAAR,CAAgBrhD,CAAhB,EAAmB4gD,gBAAnB;QACA,OAAO5gD,CAAP;MACD;;MACDmhD,IAAI,GAAGJ,OAAO,CAAC/gD,CAAD,CAAd;;MACA,IAAImhD,IAAI,KAAKt1D,GAAG,CAACmL,UAAjB,EAA6B;QAC3B,KAAKmqD,IAAL,EAAWrhD,KAAX,CAAiB,IAAjB,EAAuBghD,SAAS,CAAC9gD,CAAD,CAAhC;MACD,CAFD,MAEO;QACL,KAAK,MAAMshD,QAAX,IAAuBR,SAAS,CAAC9gD,CAAD,CAAhC,EAAqC;UACnC,MAAMuhD,QAAQ,GAAGD,QAAQ,CAACrjD,UAAT,CAAoB,IAApB,IAA4B0gD,UAA5B,GAAyC/U,IAA1D;;UACA,IAAI,CAAC2X,QAAQ,CAACjhC,GAAT,CAAaghC,QAAb,CAAL,EAA6B;YAC3BC,QAAQ,CAACr3D,GAAT,CAAao3D,QAAb,EAAuBV,gBAAvB;YACA,OAAO5gD,CAAP;UACD;QACF;MACF;;MACDA,CAAC;;MACD,IAAIA,CAAC,KAAKghD,YAAV,EAAwB;QACtB,OAAOhhD,CAAP;MACD;;MACD,IAAIihD,eAAe,IAAI,EAAEzH,KAAF,GAAUnE,eAAjC,EAAkD;QAChD,IAAIxtC,IAAI,CAAC+N,GAAL,KAAasrC,OAAjB,EAA0B;UACxBN,gBAAgB;UAChB,OAAO5gD,CAAP;QACD;;QACDw5C,KAAK,GAAG,CAAR;MACD;IACF;EACF;;EACD,CAACgI,mBAAmB,GAAG;IACrB,OAAO,KAAKzC,UAAL,CAAgB3gD,MAAhB,IAA0B,KAAKqjD,WAAtC,EAAmD;MACjD,KAAK/pD,OAAL;IACD;;IACD,KAAKq1C,OAAL,CAAakO,WAAb,GAA2B,IAA3B;IACA,KAAKrjC,GAAL,CAASlgB,OAAT;;IACA,IAAI,KAAK+oD,iBAAT,EAA4B;MAC1B,KAAK7oC,GAAL,GAAW,KAAK8oC,YAAhB;MACA,KAAK9oC,GAAL,CAASngB,IAAT;MACA,KAAKmgB,GAAL,CAASi2B,YAAT,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,CAArC;MACA,KAAKj2B,GAAL,CAASkF,SAAT,CAAmB,KAAK2jC,iBAAxB,EAA2C,CAA3C,EAA8C,CAA9C;MACA,KAAK7oC,GAAL,CAASlgB,OAAT;MACA,KAAK+oD,iBAAL,GAAyB,IAAzB;IACD;EACF;;EACDvN,UAAU,GAAG;IACX,KAAK,CAACsO,mBAAN;IACA,KAAKrU,cAAL,CAAoBz8B,KAApB;IACA,KAAKkvC,cAAL,CAAoBlvC,KAApB;;IACA,KAAK,MAAM7D,KAAX,IAAoB,KAAKqzC,iBAAL,CAAuBz5B,MAAvB,EAApB,EAAqD;MACnD,KAAK,MAAM7b,MAAX,IAAqBiC,KAAK,CAAC4Z,MAAN,EAArB,EAAqC;QACnC,IAAI,OAAOi7B,iBAAP,KAA6B,WAA7B,IAA4C92C,MAAM,YAAY82C,iBAAlE,EAAqF;UACnF92C,MAAM,CAACF,KAAP,GAAeE,MAAM,CAACD,MAAP,GAAgB,CAA/B;QACD;MACF;;MACDkC,KAAK,CAAC6D,KAAN;IACD;;IACD,KAAKwvC,iBAAL,CAAuBxvC,KAAvB;;IACA,KAAK,CAACixC,UAAN;EACD;;EACD,CAACA,UAAU,GAAG;IACZ,IAAI,KAAKt+B,UAAT,EAAqB;MACnB,MAAMu+B,WAAW,GAAG,KAAKv/B,aAAL,CAAmBxY,YAAnB,CAAgC,KAAKwZ,UAAL,CAAgB6D,UAAhD,EAA4D,KAAK7D,UAAL,CAAgB8D,UAA5E,CAApB;;MACA,IAAIy6B,WAAW,KAAK,MAApB,EAA4B;QAC1B,MAAMC,WAAW,GAAG,KAAKjqC,GAAL,CAASlJ,MAA7B;QACA,KAAKkJ,GAAL,CAASlJ,MAAT,GAAkBkzC,WAAlB;QACA,KAAKhqC,GAAL,CAASkF,SAAT,CAAmB,KAAKlF,GAAL,CAAShN,MAA5B,EAAoC,CAApC,EAAuC,CAAvC;QACA,KAAKgN,GAAL,CAASlJ,MAAT,GAAkBmzC,WAAlB;MACD;IACF;EACF;;EACDC,WAAW,CAACC,GAAD,EAAMj+C,gBAAN,EAAwB;IACjC,MAAM4G,KAAK,GAAGq3C,GAAG,CAACr3C,KAAlB;IACA,MAAMC,MAAM,GAAGo3C,GAAG,CAACp3C,MAAnB;IACA,IAAIq3C,UAAU,GAAG9hD,IAAI,CAAC2D,GAAL,CAAS3D,IAAI,CAACi+B,KAAL,CAAWr6B,gBAAgB,CAAC,CAAD,CAA3B,EAAgCA,gBAAgB,CAAC,CAAD,CAAhD,CAAT,EAA+D,CAA/D,CAAjB;IACA,IAAIm+C,WAAW,GAAG/hD,IAAI,CAAC2D,GAAL,CAAS3D,IAAI,CAACi+B,KAAL,CAAWr6B,gBAAgB,CAAC,CAAD,CAA3B,EAAgCA,gBAAgB,CAAC,CAAD,CAAhD,CAAT,EAA+D,CAA/D,CAAlB;IACA,IAAIo+C,UAAU,GAAGx3C,KAAjB;IAAA,IACEy3C,WAAW,GAAGx3C,MADhB;IAEA,IAAIy3C,WAAW,GAAG,WAAlB;IACA,IAAIlV,SAAJ,EAAeG,MAAf;;IACA,OAAO2U,UAAU,GAAG,CAAb,IAAkBE,UAAU,GAAG,CAA/B,IAAoCD,WAAW,GAAG,CAAd,IAAmBE,WAAW,GAAG,CAA5E,EAA+E;MAC7E,IAAIzlB,QAAQ,GAAGwlB,UAAf;MAAA,IACEvlB,SAAS,GAAGwlB,WADd;;MAEA,IAAIH,UAAU,GAAG,CAAb,IAAkBE,UAAU,GAAG,CAAnC,EAAsC;QACpCxlB,QAAQ,GAAGwlB,UAAU,IAAI,KAAd,GAAsBhiD,IAAI,CAAC4I,KAAL,CAAWo5C,UAAU,GAAG,CAAxB,IAA6B,CAA7B,IAAkC,CAAxD,GAA4DhiD,IAAI,CAAC+sC,IAAL,CAAUiV,UAAU,GAAG,CAAvB,CAAvE;QACAF,UAAU,IAAIE,UAAU,GAAGxlB,QAA3B;MACD;;MACD,IAAIulB,WAAW,GAAG,CAAd,IAAmBE,WAAW,GAAG,CAArC,EAAwC;QACtCxlB,SAAS,GAAGwlB,WAAW,IAAI,KAAf,GAAuBjiD,IAAI,CAAC4I,KAAL,CAAWq5C,WAAW,GAAG,CAAzB,IAA8B,CAA9B,IAAmC,CAA1D,GAA8DjiD,IAAI,CAAC+sC,IAAL,CAAUkV,WAAV,IAAyB,CAAnG;QACAF,WAAW,IAAIE,WAAW,GAAGxlB,SAA7B;MACD;;MACDuQ,SAAS,GAAG,KAAKC,cAAL,CAAoBC,SAApB,CAA8BgV,WAA9B,EAA2C1lB,QAA3C,EAAqDC,SAArD,CAAZ;MACA0Q,MAAM,GAAGH,SAAS,CAACpiC,OAAnB;MACAuiC,MAAM,CAACC,SAAP,CAAiB,CAAjB,EAAoB,CAApB,EAAuB5Q,QAAvB,EAAiCC,SAAjC;MACA0Q,MAAM,CAACvwB,SAAP,CAAiBilC,GAAjB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4BG,UAA5B,EAAwCC,WAAxC,EAAqD,CAArD,EAAwD,CAAxD,EAA2DzlB,QAA3D,EAAqEC,SAArE;MACAolB,GAAG,GAAG7U,SAAS,CAACtiC,MAAhB;MACAs3C,UAAU,GAAGxlB,QAAb;MACAylB,WAAW,GAAGxlB,SAAd;MACAylB,WAAW,GAAGA,WAAW,KAAK,WAAhB,GAA8B,WAA9B,GAA4C,WAA1D;IACD;;IACD,OAAO;MACLL,GADK;MAELG,UAFK;MAGLC;IAHK,CAAP;EAKD;;EACDE,iBAAiB,CAACN,GAAD,EAAM;IACrB,MAAMnqC,GAAG,GAAG,KAAKA,GAAjB;IACA,MAAM;MACJlN,KADI;MAEJC;IAFI,IAGFo3C,GAHJ;IAIA,MAAMvO,SAAS,GAAG,KAAKzG,OAAL,CAAayG,SAA/B;IACA,MAAM8O,aAAa,GAAG,KAAKvV,OAAL,CAAa8N,WAAnC;IACA,MAAM0H,gBAAgB,GAAG5qC,mBAAmB,CAACC,GAAD,CAA5C;IACA,IAAI/K,KAAJ,EAAW21C,QAAX,EAAqBC,MAArB,EAA6BC,UAA7B;;IACA,IAAI,CAACX,GAAG,CAAC9kC,MAAJ,IAAc8kC,GAAG,CAACjvC,IAAnB,KAA4BivC,GAAG,CAACnd,KAAJ,GAAY,CAA5C,EAA+C;MAC7C,MAAM+d,OAAO,GAAGZ,GAAG,CAAC9kC,MAAJ,IAAc8kC,GAAG,CAACjvC,IAAJ,CAASxR,MAAvC;MACAkhD,QAAQ,GAAGh2B,IAAI,CAACC,SAAL,CAAe61B,aAAa,GAAGC,gBAAH,GAAsB,CAACA,gBAAgB,CAAC7+C,KAAjB,CAAuB,CAAvB,EAA0B,CAA1B,CAAD,EAA+B8vC,SAA/B,CAAlD,CAAX;MACA3mC,KAAK,GAAG,KAAKqzC,iBAAL,CAAuBh2D,GAAvB,CAA2By4D,OAA3B,CAAR;;MACA,IAAI,CAAC91C,KAAL,EAAY;QACVA,KAAK,GAAG,IAAIvE,GAAJ,EAAR;;QACA,KAAK43C,iBAAL,CAAuBzxC,GAAvB,CAA2Bk0C,OAA3B,EAAoC91C,KAApC;MACD;;MACD,MAAM+1C,WAAW,GAAG/1C,KAAK,CAAC3iB,GAAN,CAAUs4D,QAAV,CAApB;;MACA,IAAII,WAAW,IAAI,CAACN,aAApB,EAAmC;QACjC,MAAMhvC,OAAO,GAAGpT,IAAI,CAAC0P,KAAL,CAAW1P,IAAI,CAACC,GAAL,CAASoiD,gBAAgB,CAAC,CAAD,CAAzB,EAA8BA,gBAAgB,CAAC,CAAD,CAA9C,IAAqDA,gBAAgB,CAAC,CAAD,CAAhF,CAAhB;QACA,MAAMhvC,OAAO,GAAGrT,IAAI,CAAC0P,KAAL,CAAW1P,IAAI,CAACC,GAAL,CAASoiD,gBAAgB,CAAC,CAAD,CAAzB,EAA8BA,gBAAgB,CAAC,CAAD,CAA9C,IAAqDA,gBAAgB,CAAC,CAAD,CAAhF,CAAhB;QACA,OAAO;UACL33C,MAAM,EAAEg4C,WADH;UAELtvC,OAFK;UAGLC;QAHK,CAAP;MAKD;;MACDkvC,MAAM,GAAGG,WAAT;IACD;;IACD,IAAI,CAACH,MAAL,EAAa;MACXC,UAAU,GAAG,KAAKvV,cAAL,CAAoBC,SAApB,CAA8B,YAA9B,EAA4C1iC,KAA5C,EAAmDC,MAAnD,CAAb;MACAsyC,kBAAkB,CAACyF,UAAU,CAAC53C,OAAZ,EAAqBi3C,GAArB,CAAlB;IACD;;IACD,IAAIc,YAAY,GAAGt2D,IAAI,CAACoL,SAAL,CAAe4qD,gBAAf,EAAiC,CAAC,IAAI73C,KAAL,EAAY,CAAZ,EAAe,CAAf,EAAkB,CAAC,CAAD,GAAKC,MAAvB,EAA+B,CAA/B,EAAkC,CAAlC,CAAjC,CAAnB;IACAk4C,YAAY,GAAGt2D,IAAI,CAACoL,SAAL,CAAekrD,YAAf,EAA6B,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAACl4C,MAAjB,CAA7B,CAAf;IACA,MAAM,CAAC4wC,IAAD,EAAOvM,IAAP,EAAawM,IAAb,EAAmBvM,IAAnB,IAA2B1iD,IAAI,CAACgX,0BAAL,CAAgC,CAAC,CAAD,EAAI,CAAJ,EAAOmH,KAAP,EAAcC,MAAd,CAAhC,EAAuDk4C,YAAvD,CAAjC;IACA,MAAMC,UAAU,GAAG5iD,IAAI,CAAC0P,KAAL,CAAW4rC,IAAI,GAAGD,IAAlB,KAA2B,CAA9C;IACA,MAAMwH,WAAW,GAAG7iD,IAAI,CAAC0P,KAAL,CAAWq/B,IAAI,GAAGD,IAAlB,KAA2B,CAA/C;IACA,MAAMgU,UAAU,GAAG,KAAK7V,cAAL,CAAoBC,SAApB,CAA8B,YAA9B,EAA4C0V,UAA5C,EAAwDC,WAAxD,CAAnB;IACA,MAAME,OAAO,GAAGD,UAAU,CAACl4C,OAA3B;IACA,MAAMwI,OAAO,GAAGioC,IAAhB;IACA,MAAMhoC,OAAO,GAAGy7B,IAAhB;IACAiU,OAAO,CAAC7oB,SAAR,CAAkB,CAAC9mB,OAAnB,EAA4B,CAACC,OAA7B;IACA0vC,OAAO,CAACtrD,SAAR,CAAkB,GAAGkrD,YAArB;;IACA,IAAI,CAACJ,MAAL,EAAa;MACXA,MAAM,GAAG,KAAKX,WAAL,CAAiBY,UAAU,CAAC93C,MAA5B,EAAoCmN,0BAA0B,CAACkrC,OAAD,CAA9D,CAAT;MACAR,MAAM,GAAGA,MAAM,CAACV,GAAhB;;MACA,IAAIl1C,KAAK,IAAIy1C,aAAb,EAA4B;QAC1Bz1C,KAAK,CAAC4B,GAAN,CAAU+zC,QAAV,EAAoBC,MAApB;MACD;IACF;;IACDQ,OAAO,CAACC,qBAAR,GAAgClF,wBAAwB,CAACrmC,mBAAmB,CAACsrC,OAAD,CAApB,EAA+BlB,GAAG,CAAC9D,WAAnC,CAAxD;IACAvG,wBAAwB,CAACuL,OAAD,EAAUR,MAAV,EAAkB,CAAlB,EAAqB,CAArB,EAAwBA,MAAM,CAAC/3C,KAA/B,EAAsC+3C,MAAM,CAAC93C,MAA7C,EAAqD,CAArD,EAAwD,CAAxD,EAA2DD,KAA3D,EAAkEC,MAAlE,CAAxB;IACAs4C,OAAO,CAAClF,wBAAR,GAAmC,WAAnC;IACA,MAAMpR,OAAO,GAAGpgD,IAAI,CAACoL,SAAL,CAAeogB,0BAA0B,CAACkrC,OAAD,CAAzC,EAAoD,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAC3vC,OAAd,EAAuB,CAACC,OAAxB,CAApD,CAAhB;IACA0vC,OAAO,CAACxV,SAAR,GAAoB6U,aAAa,GAAG9O,SAAS,CAAC9H,UAAV,CAAqB9zB,GAArB,EAA0B,IAA1B,EAAgC+0B,OAAhC,EAAyCxB,QAAQ,CAACt6C,IAAlD,CAAH,GAA6D2iD,SAA9F;IACAyP,OAAO,CAACzC,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuB91C,KAAvB,EAA8BC,MAA9B;;IACA,IAAIkC,KAAK,IAAI,CAACy1C,aAAd,EAA6B;MAC3B,KAAKnV,cAAL,CAAoBlyB,MAApB,CAA2B,YAA3B;MACApO,KAAK,CAAC4B,GAAN,CAAU+zC,QAAV,EAAoBQ,UAAU,CAACp4C,MAA/B;IACD;;IACD,OAAO;MACLA,MAAM,EAAEo4C,UAAU,CAACp4C,MADd;MAEL0I,OAAO,EAAEpT,IAAI,CAAC0P,KAAL,CAAW0D,OAAX,CAFJ;MAGLC,OAAO,EAAErT,IAAI,CAAC0P,KAAL,CAAW2D,OAAX;IAHJ,CAAP;EAKD;;EACDtc,YAAY,CAACyT,KAAD,EAAQ;IAClB,IAAIA,KAAK,KAAK,KAAKqiC,OAAL,CAAaiO,SAA3B,EAAsC;MACpC,KAAKgF,uBAAL,CAA6B,CAA7B,IAAkC,CAAC,CAAnC;IACD;;IACD,KAAKjT,OAAL,CAAaiO,SAAb,GAAyBtwC,KAAzB;IACA,KAAKkN,GAAL,CAASojC,SAAT,GAAqBtwC,KAArB;EACD;;EACDxT,UAAU,CAAC+V,KAAD,EAAQ;IAChB,KAAK2K,GAAL,CAASgmC,OAAT,GAAmBS,eAAe,CAACpxC,KAAD,CAAlC;EACD;;EACD9V,WAAW,CAAC8V,KAAD,EAAQ;IACjB,KAAK2K,GAAL,CAASimC,QAAT,GAAoBS,gBAAgB,CAACrxC,KAAD,CAApC;EACD;;EACD7V,aAAa,CAAC+rD,KAAD,EAAQ;IACnB,KAAKvrC,GAAL,CAASkmC,UAAT,GAAsBqF,KAAtB;EACD;;EACD9rD,OAAO,CAAC+rD,SAAD,EAAYC,SAAZ,EAAuB;IAC5B,MAAMzrC,GAAG,GAAG,KAAKA,GAAjB;;IACA,IAAIA,GAAG,CAAC0lC,WAAJ,KAAoB59C,SAAxB,EAAmC;MACjCkY,GAAG,CAAC0lC,WAAJ,CAAgB8F,SAAhB;MACAxrC,GAAG,CAAC4lC,cAAJ,GAAqB6F,SAArB;IACD;EACF;;EACD/rD,kBAAkB,CAACgsD,MAAD,EAAS,CAAE;;EAC7B/rD,WAAW,CAACgsD,QAAD,EAAW,CAAE;;EACxB/rD,SAAS,CAACgsD,MAAD,EAAS;IAChB,KAAK,MAAM,CAAC35D,GAAD,EAAM4U,KAAN,CAAX,IAA2B+kD,MAA3B,EAAmC;MACjC,QAAQ35D,GAAR;QACE,KAAK,IAAL;UACE,KAAKoN,YAAL,CAAkBwH,KAAlB;UACA;;QACF,KAAK,IAAL;UACE,KAAKvH,UAAL,CAAgBuH,KAAhB;UACA;;QACF,KAAK,IAAL;UACE,KAAKtH,WAAL,CAAiBsH,KAAjB;UACA;;QACF,KAAK,IAAL;UACE,KAAKrH,aAAL,CAAmBqH,KAAnB;UACA;;QACF,KAAK,GAAL;UACE,KAAKpH,OAAL,CAAaoH,KAAK,CAAC,CAAD,CAAlB,EAAuBA,KAAK,CAAC,CAAD,CAA5B;UACA;;QACF,KAAK,IAAL;UACE,KAAKnH,kBAAL,CAAwBmH,KAAxB;UACA;;QACF,KAAK,IAAL;UACE,KAAKlH,WAAL,CAAiBkH,KAAjB;UACA;;QACF,KAAK,MAAL;UACE,KAAKrF,OAAL,CAAaqF,KAAK,CAAC,CAAD,CAAlB,EAAuBA,KAAK,CAAC,CAAD,CAA5B;UACA;;QACF,KAAK,IAAL;UACE,KAAKsuC,OAAL,CAAagO,WAAb,GAA2Bt8C,KAA3B;UACA;;QACF,KAAK,IAAL;UACE,KAAKsuC,OAAL,CAAa+N,SAAb,GAAyBr8C,KAAzB;UACA,KAAKmZ,GAAL,CAAS+lC,WAAT,GAAuBl/C,KAAvB;UACA;;QACF,KAAK,IAAL;UACE,KAAKmZ,GAAL,CAASmmC,wBAAT,GAAoCt/C,KAApC;UACA;;QACF,KAAK,OAAL;UACE,KAAKsuC,OAAL,CAAakO,WAAb,GAA2Bx8C,KAAK,GAAG,KAAKghD,SAAR,GAAoB,IAApD;UACA,KAAKA,SAAL,GAAiB,IAAjB;UACA,KAAKgE,eAAL;UACA;;QACF,KAAK,IAAL;UACE,KAAK7rC,GAAL,CAASlJ,MAAT,GAAkB,KAAKq+B,OAAL,CAAamO,YAAb,GAA4B,KAAK74B,aAAL,CAAmB1Y,SAAnB,CAA6BlL,KAA7B,CAA9C;UACA;MA1CJ;IA4CD;EACF;;EACc,IAAXgjD,WAAW,GAAG;IAChB,OAAO,CAAC,CAAC,KAAK/B,YAAd;EACD;;EACD+D,eAAe,GAAG;IAChB,MAAMhC,WAAW,GAAG,KAAKA,WAAzB;;IACA,IAAI,KAAK1U,OAAL,CAAakO,WAAb,IAA4B,CAACwG,WAAjC,EAA8C;MAC5C,KAAKiC,cAAL;IACD,CAFD,MAEO,IAAI,CAAC,KAAK3W,OAAL,CAAakO,WAAd,IAA6BwG,WAAjC,EAA8C;MACnD,KAAKkC,YAAL;IACD;EACF;;EACDD,cAAc,GAAG;IACf,IAAI,KAAKjC,WAAT,EAAsB;MACpB,MAAM,IAAIjkD,KAAJ,CAAU,mDAAV,CAAN;IACD;;IACD,MAAMslD,UAAU,GAAG,KAAKlrC,GAAL,CAAShN,MAAT,CAAgBF,KAAnC;IACA,MAAMq4C,WAAW,GAAG,KAAKnrC,GAAL,CAAShN,MAAT,CAAgBD,MAApC;IACA,MAAMi5C,OAAO,GAAG,iBAAiB,KAAKlR,UAAtC;IACA,MAAMmR,aAAa,GAAG,KAAK1W,cAAL,CAAoBC,SAApB,CAA8BwW,OAA9B,EAAuCd,UAAvC,EAAmDC,WAAnD,CAAtB;IACA,KAAKrD,YAAL,GAAoB,KAAK9nC,GAAzB;IACA,KAAKA,GAAL,GAAWisC,aAAa,CAAC/4C,OAAzB;IACA,MAAM8M,GAAG,GAAG,KAAKA,GAAjB;IACAA,GAAG,CAACi2B,YAAJ,CAAiB,GAAGl2B,mBAAmB,CAAC,KAAK+nC,YAAN,CAAvC;IACAxC,YAAY,CAAC,KAAKwC,YAAN,EAAoB9nC,GAApB,CAAZ;IACA49B,uBAAuB,CAAC59B,GAAD,EAAM,KAAK8nC,YAAX,CAAvB;IACA,KAAKloD,SAAL,CAAe,CAAC,CAAC,IAAD,EAAO,aAAP,CAAD,EAAwB,CAAC,IAAD,EAAO,CAAP,CAAxB,EAAmC,CAAC,IAAD,EAAO,CAAP,CAAnC,CAAf;EACD;;EACDmsD,YAAY,GAAG;IACb,IAAI,CAAC,KAAKlC,WAAV,EAAuB;MACrB,MAAM,IAAIjkD,KAAJ,CAAU,6CAAV,CAAN;IACD;;IACD,KAAKoa,GAAL,CAAS89B,gBAAT;;IACAwH,YAAY,CAAC,KAAKtlC,GAAN,EAAW,KAAK8nC,YAAhB,CAAZ;IACA,KAAK9nC,GAAL,GAAW,KAAK8nC,YAAhB;IACA,KAAKA,YAAL,GAAoB,IAApB;EACD;;EACDoE,OAAO,CAACC,QAAD,EAAW;IAChB,IAAI,CAAC,KAAKhX,OAAL,CAAakO,WAAlB,EAA+B;MAC7B;IACD;;IACD,IAAI,CAAC8I,QAAL,EAAe;MACbA,QAAQ,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,KAAKnsC,GAAL,CAAShN,MAAT,CAAgBF,KAAvB,EAA8B,KAAKkN,GAAL,CAAShN,MAAT,CAAgBD,MAA9C,CAAX;IACD,CAFD,MAEO;MACLo5C,QAAQ,CAAC,CAAD,CAAR,GAAc7jD,IAAI,CAAC4I,KAAL,CAAWi7C,QAAQ,CAAC,CAAD,CAAnB,CAAd;MACAA,QAAQ,CAAC,CAAD,CAAR,GAAc7jD,IAAI,CAAC4I,KAAL,CAAWi7C,QAAQ,CAAC,CAAD,CAAnB,CAAd;MACAA,QAAQ,CAAC,CAAD,CAAR,GAAc7jD,IAAI,CAAC+sC,IAAL,CAAU8W,QAAQ,CAAC,CAAD,CAAlB,CAAd;MACAA,QAAQ,CAAC,CAAD,CAAR,GAAc7jD,IAAI,CAAC+sC,IAAL,CAAU8W,QAAQ,CAAC,CAAD,CAAlB,CAAd;IACD;;IACD,MAAMC,KAAK,GAAG,KAAKjX,OAAL,CAAakO,WAA3B;IACA,MAAMyE,YAAY,GAAG,KAAKA,YAA1B;IACA,KAAKuE,YAAL,CAAkBvE,YAAlB,EAAgCsE,KAAhC,EAAuC,KAAKpsC,GAA5C,EAAiDmsC,QAAjD;IACA,KAAKnsC,GAAL,CAASngB,IAAT;IACA,KAAKmgB,GAAL,CAASi2B,YAAT,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,CAArC;IACA,KAAKj2B,GAAL,CAAS01B,SAAT,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,KAAK11B,GAAL,CAAShN,MAAT,CAAgBF,KAAzC,EAAgD,KAAKkN,GAAL,CAAShN,MAAT,CAAgBD,MAAhE;IACA,KAAKiN,GAAL,CAASlgB,OAAT;EACD;;EACDusD,YAAY,CAACrsC,GAAD,EAAMosC,KAAN,EAAaE,QAAb,EAAuBC,QAAvB,EAAiC;IAC3C,MAAMC,YAAY,GAAGD,QAAQ,CAAC,CAAD,CAA7B;IACA,MAAME,YAAY,GAAGF,QAAQ,CAAC,CAAD,CAA7B;IACA,MAAMG,UAAU,GAAGH,QAAQ,CAAC,CAAD,CAAR,GAAcC,YAAjC;IACA,MAAMG,WAAW,GAAGJ,QAAQ,CAAC,CAAD,CAAR,GAAcE,YAAlC;;IACA,IAAIC,UAAU,KAAK,CAAf,IAAoBC,WAAW,KAAK,CAAxC,EAA2C;MACzC;IACD;;IACD,KAAKC,mBAAL,CAAyBR,KAAK,CAACl5C,OAA/B,EAAwCo5C,QAAxC,EAAkDI,UAAlD,EAA8DC,WAA9D,EAA2EP,KAAK,CAACS,OAAjF,EAA0FT,KAAK,CAACU,QAAhG,EAA0GV,KAAK,CAACW,WAAhH,EAA6HP,YAA7H,EAA2IC,YAA3I,EAAyJL,KAAK,CAAC1wC,OAA/J,EAAwK0wC,KAAK,CAACzwC,OAA9K;IACAqE,GAAG,CAACngB,IAAJ;IACAmgB,GAAG,CAAC+lC,WAAJ,GAAkB,CAAlB;IACA/lC,GAAG,CAACmmC,wBAAJ,GAA+B,aAA/B;IACAnmC,GAAG,CAACi2B,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B,EAAgC,CAAhC;IACAj2B,GAAG,CAACkF,SAAJ,CAAconC,QAAQ,CAACt5C,MAAvB,EAA+B,CAA/B,EAAkC,CAAlC;IACAgN,GAAG,CAAClgB,OAAJ;EACD;;EACD8sD,mBAAmB,CAACI,OAAD,EAAUV,QAAV,EAAoBx5C,KAApB,EAA2BC,MAA3B,EAAmC85C,OAAnC,EAA4CC,QAA5C,EAAsDC,WAAtD,EAAmEP,YAAnE,EAAiFC,YAAjF,EAA+FQ,WAA/F,EAA4GC,WAA5G,EAAyH;IAC1I,IAAIpC,UAAU,GAAGkC,OAAO,CAACh6C,MAAzB;IACA,IAAIm6C,KAAK,GAAGX,YAAY,GAAGS,WAA3B;IACA,IAAIG,KAAK,GAAGX,YAAY,GAAGS,WAA3B;;IACA,IAAIJ,QAAJ,EAAc;MACZ,IAAIK,KAAK,GAAG,CAAR,IAAaC,KAAK,GAAG,CAArB,IAA0BD,KAAK,GAAGr6C,KAAR,GAAgBg4C,UAAU,CAACh4C,KAArD,IAA8Ds6C,KAAK,GAAGr6C,MAAR,GAAiB+3C,UAAU,CAAC/3C,MAA9F,EAAsG;QACpG,MAAMC,MAAM,GAAG,KAAKuiC,cAAL,CAAoBC,SAApB,CAA8B,eAA9B,EAA+C1iC,KAA/C,EAAsDC,MAAtD,CAAf;QACA,MAAMiN,GAAG,GAAGhN,MAAM,CAACE,OAAnB;QACA8M,GAAG,CAACkF,SAAJ,CAAc4lC,UAAd,EAA0B,CAACqC,KAA3B,EAAkC,CAACC,KAAnC;;QACA,IAAIN,QAAQ,CAACp3B,IAAT,CAAcppB,CAAC,IAAIA,CAAC,KAAK,CAAzB,CAAJ,EAAiC;UAC/B0T,GAAG,CAACmmC,wBAAJ,GAA+B,kBAA/B;UACAnmC,GAAG,CAAC61B,SAAJ,GAAgBlhD,IAAI,CAACiW,YAAL,CAAkB,GAAGkiD,QAArB,CAAhB;UACA9sC,GAAG,CAAC4oC,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB91C,KAAnB,EAA0BC,MAA1B;UACAiN,GAAG,CAACmmC,wBAAJ,GAA+B,aAA/B;QACD;;QACD2E,UAAU,GAAG93C,MAAM,CAACA,MAApB;QACAm6C,KAAK,GAAGC,KAAK,GAAG,CAAhB;MACD,CAZD,MAYO,IAAIN,QAAQ,CAACp3B,IAAT,CAAcppB,CAAC,IAAIA,CAAC,KAAK,CAAzB,CAAJ,EAAiC;QACtC0gD,OAAO,CAACntD,IAAR;QACAmtD,OAAO,CAACjH,WAAR,GAAsB,CAAtB;QACAiH,OAAO,CAAC/W,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC;QACA,MAAMj1C,IAAI,GAAG,IAAI4yC,MAAJ,EAAb;QACA5yC,IAAI,CAAC6L,IAAL,CAAUsgD,KAAV,EAAiBC,KAAjB,EAAwBt6C,KAAxB,EAA+BC,MAA/B;QACAi6C,OAAO,CAAChsD,IAAR,CAAaA,IAAb;QACAgsD,OAAO,CAAC7G,wBAAR,GAAmC,kBAAnC;QACA6G,OAAO,CAACnX,SAAR,GAAoBlhD,IAAI,CAACiW,YAAL,CAAkB,GAAGkiD,QAArB,CAApB;QACAE,OAAO,CAACpE,QAAR,CAAiBuE,KAAjB,EAAwBC,KAAxB,EAA+Bt6C,KAA/B,EAAsCC,MAAtC;QACAi6C,OAAO,CAACltD,OAAR;MACD;IACF;;IACDwsD,QAAQ,CAACzsD,IAAT;IACAysD,QAAQ,CAACvG,WAAT,GAAuB,CAAvB;IACAuG,QAAQ,CAACrW,YAAT,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,CAArC;;IACA,IAAI4W,OAAO,KAAK,OAAZ,IAAuBE,WAA3B,EAAwC;MACtCT,QAAQ,CAACx1C,MAAT,GAAkB,KAAK2T,aAAL,CAAmBrY,cAAnB,CAAkC26C,WAAlC,CAAlB;IACD,CAFD,MAEO,IAAIF,OAAO,KAAK,YAAhB,EAA8B;MACnCP,QAAQ,CAACx1C,MAAT,GAAkB,KAAK2T,aAAL,CAAmBpY,mBAAnB,CAAuC06C,WAAvC,CAAlB;IACD;;IACD,MAAM/rD,IAAI,GAAG,IAAI4yC,MAAJ,EAAb;IACA5yC,IAAI,CAAC6L,IAAL,CAAU2/C,YAAV,EAAwBC,YAAxB,EAAsC35C,KAAtC,EAA6CC,MAA7C;IACAu5C,QAAQ,CAACtrD,IAAT,CAAcA,IAAd;IACAsrD,QAAQ,CAACnG,wBAAT,GAAoC,gBAApC;IACAmG,QAAQ,CAACpnC,SAAT,CAAmB4lC,UAAnB,EAA+BqC,KAA/B,EAAsCC,KAAtC,EAA6Ct6C,KAA7C,EAAoDC,MAApD,EAA4Dy5C,YAA5D,EAA0EC,YAA1E,EAAwF35C,KAAxF,EAA+FC,MAA/F;IACAu5C,QAAQ,CAACxsD,OAAT;EACD;;EACDD,IAAI,GAAG;IACL,IAAI,KAAKgqD,WAAT,EAAsB;MACpBvE,YAAY,CAAC,KAAKtlC,GAAN,EAAW,KAAK8nC,YAAhB,CAAZ;MACA,KAAKA,YAAL,CAAkBjoD,IAAlB;IACD,CAHD,MAGO;MACL,KAAKmgB,GAAL,CAASngB,IAAT;IACD;;IACD,MAAMwtD,GAAG,GAAG,KAAKlY,OAAjB;IACA,KAAKgS,UAAL,CAAgBz+C,IAAhB,CAAqB2kD,GAArB;IACA,KAAKlY,OAAL,GAAekY,GAAG,CAAC3wC,KAAJ,EAAf;EACD;;EACD5c,OAAO,GAAG;IACR,IAAI,KAAKqnD,UAAL,CAAgB3gD,MAAhB,KAA2B,CAA3B,IAAgC,KAAKqjD,WAAzC,EAAsD;MACpD,KAAKkC,YAAL;IACD;;IACD,IAAI,KAAK5E,UAAL,CAAgB3gD,MAAhB,KAA2B,CAA/B,EAAkC;MAChC,KAAK2uC,OAAL,GAAe,KAAKgS,UAAL,CAAgBmG,GAAhB,EAAf;;MACA,IAAI,KAAKzD,WAAT,EAAsB;QACpB,KAAK/B,YAAL,CAAkBhoD,OAAlB;QACAwlD,YAAY,CAAC,KAAKwC,YAAN,EAAoB,KAAK9nC,GAAzB,CAAZ;MACD,CAHD,MAGO;QACL,KAAKA,GAAL,CAASlgB,OAAT;MACD;;MACD,KAAK+rD,eAAL;MACA,KAAKzE,WAAL,GAAmB,IAAnB;MACA,KAAKgB,uBAAL,CAA6B,CAA7B,IAAkC,CAAC,CAAnC;MACA,KAAKC,0BAAL,GAAkC,IAAlC;IACD;EACF;;EACDtoD,SAAS,CAACsM,CAAD,EAAItB,CAAJ,EAAOuB,CAAP,EAAUxa,CAAV,EAAausB,CAAb,EAAgB4B,CAAhB,EAAmB;IAC1B,KAAKD,GAAL,CAASjgB,SAAT,CAAmBsM,CAAnB,EAAsBtB,CAAtB,EAAyBuB,CAAzB,EAA4Bxa,CAA5B,EAA+BusB,CAA/B,EAAkC4B,CAAlC;IACA,KAAKmoC,uBAAL,CAA6B,CAA7B,IAAkC,CAAC,CAAnC;IACA,KAAKC,0BAAL,GAAkC,IAAlC;EACD;;EACD1jD,aAAa,CAAC4oD,GAAD,EAAM3kC,IAAN,EAAY3d,MAAZ,EAAoB;IAC/B,MAAM+U,GAAG,GAAG,KAAKA,GAAjB;IACA,MAAMm1B,OAAO,GAAG,KAAKA,OAArB;IACA,IAAIjnC,CAAC,GAAGinC,OAAO,CAACjnC,CAAhB;IAAA,IACEC,CAAC,GAAGgnC,OAAO,CAAChnC,CADd;IAEA,IAAIq/C,MAAJ,EAAYC,MAAZ;IACA,MAAM9C,gBAAgB,GAAG5qC,mBAAmB,CAACC,GAAD,CAA5C;IACA,MAAM0tC,eAAe,GAAG/C,gBAAgB,CAAC,CAAD,CAAhB,KAAwB,CAAxB,IAA6BA,gBAAgB,CAAC,CAAD,CAAhB,KAAwB,CAArD,IAA0DA,gBAAgB,CAAC,CAAD,CAAhB,KAAwB,CAAxB,IAA6BA,gBAAgB,CAAC,CAAD,CAAhB,KAAwB,CAAvI;IACA,MAAMgD,eAAe,GAAGD,eAAe,GAAGziD,MAAM,CAACa,KAAP,CAAa,CAAb,CAAH,GAAqB,IAA5D;;IACA,KAAK,IAAI1D,CAAC,GAAG,CAAR,EAAWuQ,CAAC,GAAG,CAAf,EAAkBvJ,EAAE,GAAGm+C,GAAG,CAAC/mD,MAAhC,EAAwC4B,CAAC,GAAGgH,EAA5C,EAAgDhH,CAAC,EAAjD,EAAqD;MACnD,QAAQmlD,GAAG,CAACnlD,CAAD,CAAH,GAAS,CAAjB;QACE,KAAKnU,GAAG,CAACqM,SAAT;UACE4N,CAAC,GAAG0a,IAAI,CAACjQ,CAAC,EAAF,CAAR;UACAxK,CAAC,GAAGya,IAAI,CAACjQ,CAAC,EAAF,CAAR;UACA,MAAM7F,KAAK,GAAG8V,IAAI,CAACjQ,CAAC,EAAF,CAAlB;UACA,MAAM5F,MAAM,GAAG6V,IAAI,CAACjQ,CAAC,EAAF,CAAnB;UACA,MAAMi1C,EAAE,GAAG1/C,CAAC,GAAG4E,KAAf;UACA,MAAM+6C,EAAE,GAAG1/C,CAAC,GAAG4E,MAAf;UACAiN,GAAG,CAAChgB,MAAJ,CAAWkO,CAAX,EAAcC,CAAd;;UACA,IAAI2E,KAAK,KAAK,CAAV,IAAeC,MAAM,KAAK,CAA9B,EAAiC;YAC/BiN,GAAG,CAAC/f,MAAJ,CAAW2tD,EAAX,EAAeC,EAAf;UACD,CAFD,MAEO;YACL7tC,GAAG,CAAC/f,MAAJ,CAAW2tD,EAAX,EAAez/C,CAAf;YACA6R,GAAG,CAAC/f,MAAJ,CAAW2tD,EAAX,EAAeC,EAAf;YACA7tC,GAAG,CAAC/f,MAAJ,CAAWiO,CAAX,EAAc2/C,EAAd;UACD;;UACD,IAAI,CAACH,eAAL,EAAsB;YACpBvY,OAAO,CAACuG,gBAAR,CAAyBiP,gBAAzB,EAA2C,CAACz8C,CAAD,EAAIC,CAAJ,EAAOy/C,EAAP,EAAWC,EAAX,CAA3C;UACD;;UACD7tC,GAAG,CAAC3f,SAAJ;UACA;;QACF,KAAKpM,GAAG,CAAC+L,MAAT;UACEkO,CAAC,GAAG0a,IAAI,CAACjQ,CAAC,EAAF,CAAR;UACAxK,CAAC,GAAGya,IAAI,CAACjQ,CAAC,EAAF,CAAR;UACAqH,GAAG,CAAChgB,MAAJ,CAAWkO,CAAX,EAAcC,CAAd;;UACA,IAAI,CAACu/C,eAAL,EAAsB;YACpBvY,OAAO,CAACuO,gBAAR,CAAyBiH,gBAAzB,EAA2Cz8C,CAA3C,EAA8CC,CAA9C;UACD;;UACD;;QACF,KAAKla,GAAG,CAACgM,MAAT;UACEiO,CAAC,GAAG0a,IAAI,CAACjQ,CAAC,EAAF,CAAR;UACAxK,CAAC,GAAGya,IAAI,CAACjQ,CAAC,EAAF,CAAR;UACAqH,GAAG,CAAC/f,MAAJ,CAAWiO,CAAX,EAAcC,CAAd;;UACA,IAAI,CAACu/C,eAAL,EAAsB;YACpBvY,OAAO,CAACuO,gBAAR,CAAyBiH,gBAAzB,EAA2Cz8C,CAA3C,EAA8CC,CAA9C;UACD;;UACD;;QACF,KAAKla,GAAG,CAACiM,OAAT;UACEstD,MAAM,GAAGt/C,CAAT;UACAu/C,MAAM,GAAGt/C,CAAT;UACAD,CAAC,GAAG0a,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAR;UACAxK,CAAC,GAAGya,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAR;UACAqH,GAAG,CAACmyB,aAAJ,CAAkBvpB,IAAI,CAACjQ,CAAD,CAAtB,EAA2BiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAA/B,EAAwCiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAA5C,EAAqDiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAzD,EAAkEzK,CAAlE,EAAqEC,CAArE;UACAgnC,OAAO,CAAC2O,qBAAR,CAA8B6G,gBAA9B,EAAgD6C,MAAhD,EAAwDC,MAAxD,EAAgE7kC,IAAI,CAACjQ,CAAD,CAApE,EAAyEiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAA7E,EAAsFiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAA1F,EAAmGiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAvG,EAAgHzK,CAAhH,EAAmHC,CAAnH,EAAsHw/C,eAAtH;UACAh1C,CAAC,IAAI,CAAL;UACA;;QACF,KAAK1kB,GAAG,CAACkM,QAAT;UACEqtD,MAAM,GAAGt/C,CAAT;UACAu/C,MAAM,GAAGt/C,CAAT;UACA6R,GAAG,CAACmyB,aAAJ,CAAkBjkC,CAAlB,EAAqBC,CAArB,EAAwBya,IAAI,CAACjQ,CAAD,CAA5B,EAAiCiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAArC,EAA8CiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAlD,EAA2DiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAA/D;UACAw8B,OAAO,CAAC2O,qBAAR,CAA8B6G,gBAA9B,EAAgD6C,MAAhD,EAAwDC,MAAxD,EAAgEv/C,CAAhE,EAAmEC,CAAnE,EAAsEya,IAAI,CAACjQ,CAAD,CAA1E,EAA+EiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAnF,EAA4FiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAhG,EAAyGiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAA7G,EAAsHg1C,eAAtH;UACAz/C,CAAC,GAAG0a,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAR;UACAxK,CAAC,GAAGya,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAR;UACAA,CAAC,IAAI,CAAL;UACA;;QACF,KAAK1kB,GAAG,CAACmM,QAAT;UACEotD,MAAM,GAAGt/C,CAAT;UACAu/C,MAAM,GAAGt/C,CAAT;UACAD,CAAC,GAAG0a,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAR;UACAxK,CAAC,GAAGya,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAAR;UACAqH,GAAG,CAACmyB,aAAJ,CAAkBvpB,IAAI,CAACjQ,CAAD,CAAtB,EAA2BiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAA/B,EAAwCzK,CAAxC,EAA2CC,CAA3C,EAA8CD,CAA9C,EAAiDC,CAAjD;UACAgnC,OAAO,CAAC2O,qBAAR,CAA8B6G,gBAA9B,EAAgD6C,MAAhD,EAAwDC,MAAxD,EAAgE7kC,IAAI,CAACjQ,CAAD,CAApE,EAAyEiQ,IAAI,CAACjQ,CAAC,GAAG,CAAL,CAA7E,EAAsFzK,CAAtF,EAAyFC,CAAzF,EAA4FD,CAA5F,EAA+FC,CAA/F,EAAkGw/C,eAAlG;UACAh1C,CAAC,IAAI,CAAL;UACA;;QACF,KAAK1kB,GAAG,CAACoM,SAAT;UACE2f,GAAG,CAAC3f,SAAJ;UACA;MAlEJ;IAoED;;IACD,IAAIqtD,eAAJ,EAAqB;MACnBvY,OAAO,CAAC0O,uBAAR,CAAgC8G,gBAAhC,EAAkDgD,eAAlD;IACD;;IACDxY,OAAO,CAACsO,eAAR,CAAwBv1C,CAAxB,EAA2BC,CAA3B;EACD;;EACD9N,SAAS,GAAG;IACV,KAAK2f,GAAL,CAAS3f,SAAT;EACD;;EACDE,MAAM,CAACutD,WAAW,GAAG,IAAf,EAAqB;IACzB,MAAM9tC,GAAG,GAAG,KAAKA,GAAjB;IACA,MAAM67B,WAAW,GAAG,KAAK1G,OAAL,CAAa0G,WAAjC;IACA77B,GAAG,CAAC+lC,WAAJ,GAAkB,KAAK5Q,OAAL,CAAagO,WAA/B;;IACA,IAAI,KAAK4E,cAAT,EAAyB;MACvB,IAAI,OAAOlM,WAAP,KAAuB,QAAvB,IAAmCA,WAAW,EAAE/H,UAApD,EAAgE;QAC9D9zB,GAAG,CAACngB,IAAJ;QACAmgB,GAAG,CAAC27B,WAAJ,GAAkBE,WAAW,CAAC/H,UAAZ,CAAuB9zB,GAAvB,EAA4B,IAA5B,EAAkCG,0BAA0B,CAACH,GAAD,CAA5D,EAAmEuzB,QAAQ,CAACr6C,MAA5E,CAAlB;QACA,KAAK60D,gBAAL,CAAsB,KAAtB;QACA/tC,GAAG,CAAClgB,OAAJ;MACD,CALD,MAKO;QACL,KAAKiuD,gBAAL,CAAsB,IAAtB;MACD;IACF;;IACD,IAAID,WAAJ,EAAiB;MACf,KAAKA,WAAL,CAAiB,KAAK3Y,OAAL,CAAaC,yBAAb,EAAjB;IACD;;IACDp1B,GAAG,CAAC+lC,WAAJ,GAAkB,KAAK5Q,OAAL,CAAa+N,SAA/B;EACD;;EACD1iD,WAAW,GAAG;IACZ,KAAKH,SAAL;IACA,KAAKE,MAAL;EACD;;EACDE,IAAI,CAACqtD,WAAW,GAAG,IAAf,EAAqB;IACvB,MAAM9tC,GAAG,GAAG,KAAKA,GAAjB;IACA,MAAM47B,SAAS,GAAG,KAAKzG,OAAL,CAAayG,SAA/B;IACA,MAAM8O,aAAa,GAAG,KAAKvV,OAAL,CAAa8N,WAAnC;IACA,IAAI+K,WAAW,GAAG,KAAlB;;IACA,IAAItD,aAAJ,EAAmB;MACjB1qC,GAAG,CAACngB,IAAJ;MACAmgB,GAAG,CAAC61B,SAAJ,GAAgB+F,SAAS,CAAC9H,UAAV,CAAqB9zB,GAArB,EAA0B,IAA1B,EAAgCG,0BAA0B,CAACH,GAAD,CAA1D,EAAiEuzB,QAAQ,CAACt6C,IAA1E,CAAhB;MACA+0D,WAAW,GAAG,IAAd;IACD;;IACD,MAAMlhD,SAAS,GAAG,KAAKqoC,OAAL,CAAaC,yBAAb,EAAlB;;IACA,IAAI,KAAK2S,cAAL,IAAuBj7C,SAAS,KAAK,IAAzC,EAA+C;MAC7C,IAAI,KAAKu6C,aAAT,EAAwB;QACtBrnC,GAAG,CAACvf,IAAJ,CAAS,SAAT;QACA,KAAK4mD,aAAL,GAAqB,KAArB;MACD,CAHD,MAGO;QACLrnC,GAAG,CAACvf,IAAJ;MACD;IACF;;IACD,IAAIutD,WAAJ,EAAiB;MACfhuC,GAAG,CAAClgB,OAAJ;IACD;;IACD,IAAIguD,WAAJ,EAAiB;MACf,KAAKA,WAAL,CAAiBhhD,SAAjB;IACD;EACF;;EACDpM,MAAM,GAAG;IACP,KAAK2mD,aAAL,GAAqB,IAArB;IACA,KAAK5mD,IAAL;EACD;;EACDE,UAAU,GAAG;IACX,KAAKF,IAAL,CAAU,KAAV;IACA,KAAKF,MAAL,CAAY,KAAZ;IACA,KAAKutD,WAAL;EACD;;EACDltD,YAAY,GAAG;IACb,KAAKymD,aAAL,GAAqB,IAArB;IACA,KAAK1mD,UAAL;EACD;;EACDE,eAAe,GAAG;IAChB,KAAKR,SAAL;IACA,KAAKM,UAAL;EACD;;EACDG,iBAAiB,GAAG;IAClB,KAAKumD,aAAL,GAAqB,IAArB;IACA,KAAKhnD,SAAL;IACA,KAAKM,UAAL;EACD;;EACDI,OAAO,GAAG;IACR,KAAK+sD,WAAL;EACD;;EACD9sD,IAAI,GAAG;IACL,KAAKomD,WAAL,GAAmBT,WAAnB;EACD;;EACD1lD,MAAM,GAAG;IACP,KAAKmmD,WAAL,GAAmBR,OAAnB;EACD;;EACD1lD,SAAS,GAAG;IACV,KAAKi0C,OAAL,CAAamN,UAAb,GAA0BpsD,eAA1B;IACA,KAAKi/C,OAAL,CAAaoN,eAAb,GAA+B,CAA/B;IACA,KAAKpN,OAAL,CAAajnC,CAAb,GAAiB,KAAKinC,OAAL,CAAauN,KAAb,GAAqB,CAAtC;IACA,KAAKvN,OAAL,CAAahnC,CAAb,GAAiB,KAAKgnC,OAAL,CAAawN,KAAb,GAAqB,CAAtC;EACD;;EACDxhD,OAAO,GAAG;IACR,MAAM8sD,KAAK,GAAG,KAAKC,gBAAnB;IACA,MAAMluC,GAAG,GAAG,KAAKA,GAAjB;;IACA,IAAIiuC,KAAK,KAAKnmD,SAAd,EAAyB;MACvBkY,GAAG,CAAC21B,SAAJ;MACA;IACD;;IACD31B,GAAG,CAACngB,IAAJ;IACAmgB,GAAG,CAAC21B,SAAJ;;IACA,KAAK,MAAMmM,IAAX,IAAmBmM,KAAnB,EAA0B;MACxBjuC,GAAG,CAACi2B,YAAJ,CAAiB,GAAG6L,IAAI,CAAC/hD,SAAzB;MACAigB,GAAG,CAACwiB,SAAJ,CAAcsf,IAAI,CAAC5zC,CAAnB,EAAsB4zC,IAAI,CAAC3zC,CAA3B;MACA2zC,IAAI,CAACqM,SAAL,CAAenuC,GAAf,EAAoB8hC,IAAI,CAACM,QAAzB;IACD;;IACDpiC,GAAG,CAAClgB,OAAJ;IACAkgB,GAAG,CAAChf,IAAJ;IACAgf,GAAG,CAAC21B,SAAJ;IACA,OAAO,KAAKuY,gBAAZ;EACD;;EACD9sD,cAAc,CAACgtD,OAAD,EAAU;IACtB,KAAKjZ,OAAL,CAAayN,WAAb,GAA2BwL,OAA3B;EACD;;EACD/sD,cAAc,CAAC+sD,OAAD,EAAU;IACtB,KAAKjZ,OAAL,CAAa0N,WAAb,GAA2BuL,OAA3B;EACD;;EACD9sD,SAAS,CAACka,KAAD,EAAQ;IACf,KAAK25B,OAAL,CAAa2N,UAAb,GAA0BtnC,KAAK,GAAG,GAAlC;EACD;;EACDja,UAAU,CAACkhD,OAAD,EAAU;IAClB,KAAKtN,OAAL,CAAasN,OAAb,GAAuB,CAACA,OAAxB;EACD;;EACDjhD,OAAO,CAAC6sD,WAAD,EAAcz1C,IAAd,EAAoB;IACzB,MAAM01C,OAAO,GAAG,KAAKvH,UAAL,CAAgBz0D,GAAhB,CAAoB+7D,WAApB,CAAhB;IACA,MAAMlZ,OAAO,GAAG,KAAKA,OAArB;;IACA,IAAI,CAACmZ,OAAL,EAAc;MACZ,MAAM,IAAI1oD,KAAJ,CAAW,uBAAsByoD,WAAY,EAA7C,CAAN;IACD;;IACDlZ,OAAO,CAACqN,UAAR,GAAqB8L,OAAO,CAAC9L,UAAR,IAAsBrsD,oBAA3C;;IACA,IAAIg/C,OAAO,CAACqN,UAAR,CAAmB,CAAnB,MAA0B,CAA1B,IAA+BrN,OAAO,CAACqN,UAAR,CAAmB,CAAnB,MAA0B,CAA7D,EAAgE;MAC9D98C,IAAI,CAAC,kCAAkC2oD,WAAnC,CAAJ;IACD;;IACD,IAAIz1C,IAAI,GAAG,CAAX,EAAc;MACZA,IAAI,GAAG,CAACA,IAAR;MACAu8B,OAAO,CAACoZ,aAAR,GAAwB,CAAC,CAAzB;IACD,CAHD,MAGO;MACLpZ,OAAO,CAACoZ,aAAR,GAAwB,CAAxB;IACD;;IACD,KAAKpZ,OAAL,CAAapG,IAAb,GAAoBuf,OAApB;IACA,KAAKnZ,OAAL,CAAaiN,QAAb,GAAwBxpC,IAAxB;;IACA,IAAI01C,OAAO,CAACE,WAAZ,EAAyB;MACvB;IACD;;IACD,MAAMpnD,IAAI,GAAGknD,OAAO,CAAC9f,UAAR,IAAsB,YAAnC;IACA,MAAMigB,QAAQ,GAAGH,OAAO,CAAChgB,cAAR,EAAwBoD,GAAxB,IAAgC,IAAGtqC,IAAK,MAAKknD,OAAO,CAACI,YAAa,EAAnF;IACA,IAAIC,IAAI,GAAG,QAAX;;IACA,IAAIL,OAAO,CAAC/R,KAAZ,EAAmB;MACjBoS,IAAI,GAAG,KAAP;IACD,CAFD,MAEO,IAAIL,OAAO,CAACK,IAAZ,EAAkB;MACvBA,IAAI,GAAG,MAAP;IACD;;IACD,MAAMC,MAAM,GAAGN,OAAO,CAACM,MAAR,GAAiB,QAAjB,GAA4B,QAA3C;IACA,IAAIC,eAAe,GAAGj2C,IAAtB;;IACA,IAAIA,IAAI,GAAG0kC,aAAX,EAA0B;MACxBuR,eAAe,GAAGvR,aAAlB;IACD,CAFD,MAEO,IAAI1kC,IAAI,GAAG2kC,aAAX,EAA0B;MAC/BsR,eAAe,GAAGtR,aAAlB;IACD;;IACD,KAAKpI,OAAL,CAAakN,aAAb,GAA6BzpC,IAAI,GAAGi2C,eAApC;IACA,KAAK7uC,GAAL,CAAS+uB,IAAT,GAAiB,GAAE6f,MAAO,IAAGD,IAAK,IAAGE,eAAgB,MAAKJ,QAAS,EAAnE;EACD;;EACDhtD,oBAAoB,CAAC6pB,IAAD,EAAO;IACzB,KAAK6pB,OAAL,CAAa4N,iBAAb,GAAiCz3B,IAAjC;EACD;;EACD5pB,WAAW,CAACotD,IAAD,EAAO;IAChB,KAAK3Z,OAAL,CAAa6N,QAAb,GAAwB8L,IAAxB;EACD;;EACDntD,QAAQ,CAACuM,CAAD,EAAIC,CAAJ,EAAO;IACb,KAAKgnC,OAAL,CAAajnC,CAAb,GAAiB,KAAKinC,OAAL,CAAauN,KAAb,IAAsBx0C,CAAvC;IACA,KAAKinC,OAAL,CAAahnC,CAAb,GAAiB,KAAKgnC,OAAL,CAAawN,KAAb,IAAsBx0C,CAAvC;EACD;;EACDvM,kBAAkB,CAACsM,CAAD,EAAIC,CAAJ,EAAO;IACvB,KAAK5M,UAAL,CAAgB,CAAC4M,CAAjB;IACA,KAAKxM,QAAL,CAAcuM,CAAd,EAAiBC,CAAjB;EACD;;EACDtM,aAAa,CAACwK,CAAD,EAAItB,CAAJ,EAAOuB,CAAP,EAAUxa,CAAV,EAAausB,CAAb,EAAgB4B,CAAhB,EAAmB;IAC9B,KAAKk1B,OAAL,CAAamN,UAAb,GAA0B,CAACj2C,CAAD,EAAItB,CAAJ,EAAOuB,CAAP,EAAUxa,CAAV,EAAausB,CAAb,EAAgB4B,CAAhB,CAA1B;IACA,KAAKk1B,OAAL,CAAaoN,eAAb,GAA+Bj6C,IAAI,CAACi+B,KAAL,CAAWl6B,CAAX,EAActB,CAAd,CAA/B;IACA,KAAKoqC,OAAL,CAAajnC,CAAb,GAAiB,KAAKinC,OAAL,CAAauN,KAAb,GAAqB,CAAtC;IACA,KAAKvN,OAAL,CAAahnC,CAAb,GAAiB,KAAKgnC,OAAL,CAAawN,KAAb,GAAqB,CAAtC;EACD;;EACD7gD,QAAQ,GAAG;IACT,KAAKH,QAAL,CAAc,CAAd,EAAiB,KAAKwzC,OAAL,CAAasN,OAA9B;EACD;;EACDsM,SAAS,CAAC9c,SAAD,EAAY/jC,CAAZ,EAAeC,CAAf,EAAkB6gD,gBAAlB,EAAoC;IAC3C,MAAMhvC,GAAG,GAAG,KAAKA,GAAjB;IACA,MAAMm1B,OAAO,GAAG,KAAKA,OAArB;IACA,MAAMpG,IAAI,GAAGoG,OAAO,CAACpG,IAArB;IACA,MAAMgU,iBAAiB,GAAG5N,OAAO,CAAC4N,iBAAlC;IACA,MAAMX,QAAQ,GAAGjN,OAAO,CAACiN,QAAR,GAAmBjN,OAAO,CAACkN,aAA5C;IACA,MAAM4M,cAAc,GAAGlM,iBAAiB,GAAG/pD,iBAAiB,CAACS,gBAA7D;IACA,MAAMy1D,cAAc,GAAG,CAAC,EAAEnM,iBAAiB,GAAG/pD,iBAAiB,CAACU,gBAAxC,CAAxB;IACA,MAAMupD,WAAW,GAAG9N,OAAO,CAAC8N,WAAR,IAAuB,CAAClU,IAAI,CAACE,WAAjD;IACA,IAAIkf,SAAJ;;IACA,IAAIpf,IAAI,CAACN,eAAL,IAAwBygB,cAAxB,IAA0CjM,WAA9C,EAA2D;MACzDkL,SAAS,GAAGpf,IAAI,CAACgD,gBAAL,CAAsB,KAAKgV,UAA3B,EAAuC9U,SAAvC,CAAZ;IACD;;IACD,IAAIlD,IAAI,CAACN,eAAL,IAAwBwU,WAA5B,EAAyC;MACvCjjC,GAAG,CAACngB,IAAJ;MACAmgB,GAAG,CAACwiB,SAAJ,CAAct0B,CAAd,EAAiBC,CAAjB;MACA6R,GAAG,CAAC21B,SAAJ;MACAwY,SAAS,CAACnuC,GAAD,EAAMoiC,QAAN,CAAT;;MACA,IAAI4M,gBAAJ,EAAsB;QACpBhvC,GAAG,CAACi2B,YAAJ,CAAiB,GAAG+Y,gBAApB;MACD;;MACD,IAAIC,cAAc,KAAKj2D,iBAAiB,CAACC,IAArC,IAA6Cg2D,cAAc,KAAKj2D,iBAAiB,CAACG,WAAtF,EAAmG;QACjG6mB,GAAG,CAACvf,IAAJ;MACD;;MACD,IAAIwuD,cAAc,KAAKj2D,iBAAiB,CAACE,MAArC,IAA+C+1D,cAAc,KAAKj2D,iBAAiB,CAACG,WAAxF,EAAqG;QACnG6mB,GAAG,CAACzf,MAAJ;MACD;;MACDyf,GAAG,CAAClgB,OAAJ;IACD,CAfD,MAeO;MACL,IAAImvD,cAAc,KAAKj2D,iBAAiB,CAACC,IAArC,IAA6Cg2D,cAAc,KAAKj2D,iBAAiB,CAACG,WAAtF,EAAmG;QACjG6mB,GAAG,CAAC6wB,QAAJ,CAAaoB,SAAb,EAAwB/jC,CAAxB,EAA2BC,CAA3B;MACD;;MACD,IAAI8gD,cAAc,KAAKj2D,iBAAiB,CAACE,MAArC,IAA+C+1D,cAAc,KAAKj2D,iBAAiB,CAACG,WAAxF,EAAqG;QACnG6mB,GAAG,CAACmvC,UAAJ,CAAeld,SAAf,EAA0B/jC,CAA1B,EAA6BC,CAA7B;MACD;IACF;;IACD,IAAI+gD,cAAJ,EAAoB;MAClB,MAAMjB,KAAK,GAAG,KAAKC,gBAAL,KAA0B,EAAxC;MACAD,KAAK,CAACvlD,IAAN,CAAW;QACT3I,SAAS,EAAEggB,mBAAmB,CAACC,GAAD,CADrB;QAET9R,CAFS;QAGTC,CAHS;QAITi0C,QAJS;QAKT+L;MALS,CAAX;IAOD;EACF;;EAC0B,IAAvBiB,uBAAuB,GAAG;IAC5B,MAAM;MACJl8C,OAAO,EAAE8M;IADL,IAEF,KAAKu1B,cAAL,CAAoBC,SAApB,CAA8B,yBAA9B,EAAyD,EAAzD,EAA6D,EAA7D,CAFJ;IAGAx1B,GAAG,CAACxE,KAAJ,CAAU,GAAV,EAAe,CAAf;IACAwE,GAAG,CAAC6wB,QAAJ,CAAa,GAAb,EAAkB,CAAlB,EAAqB,EAArB;IACA,MAAM31B,IAAI,GAAG8E,GAAG,CAACmF,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,EAAvB,EAA2B,EAA3B,EAA+BjK,IAA5C;IACA,IAAIuiB,OAAO,GAAG,KAAd;;IACA,KAAK,IAAIr1B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8S,IAAI,CAAC1U,MAAzB,EAAiC4B,CAAC,IAAI,CAAtC,EAAyC;MACvC,IAAI8S,IAAI,CAAC9S,CAAD,CAAJ,GAAU,CAAV,IAAe8S,IAAI,CAAC9S,CAAD,CAAJ,GAAU,GAA7B,EAAkC;QAChCq1B,OAAO,GAAG,IAAV;QACA;MACD;IACF;;IACD,OAAO/nC,MAAM,CAAC,IAAD,EAAO,yBAAP,EAAkC+nC,OAAlC,CAAb;EACD;;EACD17B,QAAQ,CAACstD,MAAD,EAAS;IACf,MAAMla,OAAO,GAAG,KAAKA,OAArB;IACA,MAAMpG,IAAI,GAAGoG,OAAO,CAACpG,IAArB;;IACA,IAAIA,IAAI,CAACyf,WAAT,EAAsB;MACpB,OAAO,KAAKc,aAAL,CAAmBD,MAAnB,CAAP;IACD;;IACD,MAAMjN,QAAQ,GAAGjN,OAAO,CAACiN,QAAzB;;IACA,IAAIA,QAAQ,KAAK,CAAjB,EAAoB;MAClB,OAAOt6C,SAAP;IACD;;IACD,MAAMkY,GAAG,GAAG,KAAKA,GAAjB;IACA,MAAMqiC,aAAa,GAAGlN,OAAO,CAACkN,aAA9B;IACA,MAAMO,WAAW,GAAGzN,OAAO,CAACyN,WAA5B;IACA,MAAMC,WAAW,GAAG1N,OAAO,CAAC0N,WAA5B;IACA,MAAM0L,aAAa,GAAGpZ,OAAO,CAACoZ,aAA9B;IACA,MAAMzL,UAAU,GAAG3N,OAAO,CAAC2N,UAAR,GAAqByL,aAAxC;IACA,MAAMgB,YAAY,GAAGF,MAAM,CAAC7oD,MAA5B;IACA,MAAMgpD,QAAQ,GAAGzgB,IAAI,CAACygB,QAAtB;IACA,MAAMC,UAAU,GAAGD,QAAQ,GAAG,CAAH,GAAO,CAAC,CAAnC;IACA,MAAME,eAAe,GAAG3gB,IAAI,CAAC2gB,eAA7B;IACA,MAAMC,iBAAiB,GAAGvN,QAAQ,GAAGjN,OAAO,CAACqN,UAAR,CAAmB,CAAnB,CAArC;IACA,MAAMoN,cAAc,GAAGza,OAAO,CAAC4N,iBAAR,KAA8B/pD,iBAAiB,CAACC,IAAhD,IAAwD,CAAC81C,IAAI,CAACN,eAA9D,IAAiF,CAAC0G,OAAO,CAAC8N,WAAjH;IACAjjC,GAAG,CAACngB,IAAJ;IACAmgB,GAAG,CAACjgB,SAAJ,CAAc,GAAGo1C,OAAO,CAACmN,UAAzB;IACAtiC,GAAG,CAACwiB,SAAJ,CAAc2S,OAAO,CAACjnC,CAAtB,EAAyBinC,OAAO,CAAChnC,CAAR,GAAYgnC,OAAO,CAAC6N,QAA7C;;IACA,IAAIuL,aAAa,GAAG,CAApB,EAAuB;MACrBvuC,GAAG,CAACxE,KAAJ,CAAUsnC,UAAV,EAAsB,CAAC,CAAvB;IACD,CAFD,MAEO;MACL9iC,GAAG,CAACxE,KAAJ,CAAUsnC,UAAV,EAAsB,CAAtB;IACD;;IACD,IAAIkM,gBAAJ;;IACA,IAAI7Z,OAAO,CAAC8N,WAAZ,EAAyB;MACvBjjC,GAAG,CAACngB,IAAJ;MACA,MAAMo1C,OAAO,GAAGE,OAAO,CAACyG,SAAR,CAAkB9H,UAAlB,CAA6B9zB,GAA7B,EAAkC,IAAlC,EAAwCG,0BAA0B,CAACH,GAAD,CAAlE,EAAyEuzB,QAAQ,CAACt6C,IAAlF,CAAhB;MACA+1D,gBAAgB,GAAGjvC,mBAAmB,CAACC,GAAD,CAAtC;MACAA,GAAG,CAAClgB,OAAJ;MACAkgB,GAAG,CAAC61B,SAAJ,GAAgBZ,OAAhB;IACD;;IACD,IAAImO,SAAS,GAAGjO,OAAO,CAACiO,SAAxB;IACA,MAAM5nC,KAAK,GAAG25B,OAAO,CAACoN,eAAtB;;IACA,IAAI/mC,KAAK,KAAK,CAAV,IAAe4nC,SAAS,KAAK,CAAjC,EAAoC;MAClC,MAAM6L,cAAc,GAAG9Z,OAAO,CAAC4N,iBAAR,GAA4B/pD,iBAAiB,CAACS,gBAArE;;MACA,IAAIw1D,cAAc,KAAKj2D,iBAAiB,CAACE,MAArC,IAA+C+1D,cAAc,KAAKj2D,iBAAiB,CAACG,WAAxF,EAAqG;QACnGiqD,SAAS,GAAG,KAAKyM,mBAAL,EAAZ;MACD;IACF,CALD,MAKO;MACLzM,SAAS,IAAI5nC,KAAb;IACD;;IACD,IAAI6mC,aAAa,KAAK,GAAtB,EAA2B;MACzBriC,GAAG,CAACxE,KAAJ,CAAU6mC,aAAV,EAAyBA,aAAzB;MACAe,SAAS,IAAIf,aAAb;IACD;;IACDriC,GAAG,CAACojC,SAAJ,GAAgBA,SAAhB;;IACA,IAAIrU,IAAI,CAAC+gB,kBAAT,EAA6B;MAC3B,MAAMC,KAAK,GAAG,EAAd;MACA,IAAIj9C,KAAK,GAAG,CAAZ;;MACA,KAAK,MAAMk9C,KAAX,IAAoBX,MAApB,EAA4B;QAC1BU,KAAK,CAACrnD,IAAN,CAAWsnD,KAAK,CAACC,OAAjB;QACAn9C,KAAK,IAAIk9C,KAAK,CAACl9C,KAAf;MACD;;MACDkN,GAAG,CAAC6wB,QAAJ,CAAakf,KAAK,CAACpnD,IAAN,CAAW,EAAX,CAAb,EAA6B,CAA7B,EAAgC,CAAhC;MACAwsC,OAAO,CAACjnC,CAAR,IAAa4E,KAAK,GAAG68C,iBAAR,GAA4B7M,UAAzC;MACA9iC,GAAG,CAAClgB,OAAJ;MACA,KAAKosD,OAAL;MACA,OAAOpkD,SAAP;IACD;;IACD,IAAIoG,CAAC,GAAG,CAAR;IAAA,IACE9F,CADF;;IAEA,KAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGmnD,YAAhB,EAA8B,EAAEnnD,CAAhC,EAAmC;MACjC,MAAM4nD,KAAK,GAAGX,MAAM,CAACjnD,CAAD,CAApB;;MACA,IAAI,OAAO4nD,KAAP,KAAiB,QAArB,EAA+B;QAC7B9hD,CAAC,IAAIuhD,UAAU,GAAGO,KAAb,GAAqB5N,QAArB,GAAgC,IAArC;QACA;MACD;;MACD,IAAI8N,aAAa,GAAG,KAApB;MACA,MAAM9B,OAAO,GAAG,CAAC4B,KAAK,CAACG,OAAN,GAAgBtN,WAAhB,GAA8B,CAA/B,IAAoCD,WAApD;MACA,MAAM3Q,SAAS,GAAG+d,KAAK,CAACI,QAAxB;MACA,MAAMC,MAAM,GAAGL,KAAK,CAACK,MAArB;MACA,IAAIC,OAAJ,EAAaC,OAAb;MACA,IAAIz9C,KAAK,GAAGk9C,KAAK,CAACl9C,KAAlB;;MACA,IAAI08C,QAAJ,EAAc;QACZ,MAAMgB,OAAO,GAAGR,KAAK,CAACQ,OAAN,IAAiBd,eAAjC;QACA,MAAMe,EAAE,GAAG,EAAET,KAAK,CAACQ,OAAN,GAAgBA,OAAO,CAAC,CAAD,CAAvB,GAA6B19C,KAAK,GAAG,GAAvC,IAA8C68C,iBAAzD;QACA,MAAMe,EAAE,GAAGF,OAAO,CAAC,CAAD,CAAP,GAAab,iBAAxB;QACA78C,KAAK,GAAG09C,OAAO,GAAG,CAACA,OAAO,CAAC,CAAD,CAAX,GAAiB19C,KAAhC;QACAw9C,OAAO,GAAGG,EAAE,GAAGpO,aAAf;QACAkO,OAAO,GAAG,CAACriD,CAAC,GAAGwiD,EAAL,IAAWrO,aAArB;MACD,CAPD,MAOO;QACLiO,OAAO,GAAGpiD,CAAC,GAAGm0C,aAAd;QACAkO,OAAO,GAAG,CAAV;MACD;;MACD,IAAIxhB,IAAI,CAAC4hB,SAAL,IAAkB79C,KAAK,GAAG,CAA9B,EAAiC;QAC/B,MAAM89C,aAAa,GAAG5wC,GAAG,CAAC6wC,WAAJ,CAAgB5e,SAAhB,EAA2Bn/B,KAA3B,GAAmC,IAAnC,GAA0CsvC,QAA1C,GAAqDC,aAA3E;;QACA,IAAIvvC,KAAK,GAAG89C,aAAR,IAAyB,KAAKxB,uBAAlC,EAA2D;UACzD,MAAM0B,eAAe,GAAGh+C,KAAK,GAAG89C,aAAhC;UACAV,aAAa,GAAG,IAAhB;UACAlwC,GAAG,CAACngB,IAAJ;UACAmgB,GAAG,CAACxE,KAAJ,CAAUs1C,eAAV,EAA2B,CAA3B;UACAR,OAAO,IAAIQ,eAAX;QACD,CAND,MAMO,IAAIh+C,KAAK,KAAK89C,aAAd,EAA6B;UAClCN,OAAO,IAAI,CAACx9C,KAAK,GAAG89C,aAAT,IAA0B,IAA1B,GAAiCxO,QAAjC,GAA4CC,aAAvD;QACD;MACF;;MACD,IAAI,KAAK0F,cAAL,KAAwBiI,KAAK,CAACe,QAAN,IAAkBhiB,IAAI,CAACE,WAA/C,CAAJ,EAAiE;QAC/D,IAAI2gB,cAAc,IAAI,CAACS,MAAvB,EAA+B;UAC7BrwC,GAAG,CAAC6wB,QAAJ,CAAaoB,SAAb,EAAwBqe,OAAxB,EAAiCC,OAAjC;QACD,CAFD,MAEO;UACL,KAAKxB,SAAL,CAAe9c,SAAf,EAA0Bqe,OAA1B,EAAmCC,OAAnC,EAA4CvB,gBAA5C;;UACA,IAAIqB,MAAJ,EAAY;YACV,MAAMW,aAAa,GAAGV,OAAO,GAAGlO,QAAQ,GAAGiO,MAAM,CAAChgB,MAAP,CAAcniC,CAAzB,GAA6Bm0C,aAA7D;YACA,MAAM4O,aAAa,GAAGV,OAAO,GAAGnO,QAAQ,GAAGiO,MAAM,CAAChgB,MAAP,CAAcliC,CAAzB,GAA6Bk0C,aAA7D;YACA,KAAK0M,SAAL,CAAesB,MAAM,CAACD,QAAtB,EAAgCY,aAAhC,EAA+CC,aAA/C,EAA8DjC,gBAA9D;UACD;QACF;MACF;;MACD,MAAMkC,SAAS,GAAG1B,QAAQ,GAAG18C,KAAK,GAAG68C,iBAAR,GAA4BvB,OAAO,GAAGG,aAAzC,GAAyDz7C,KAAK,GAAG68C,iBAAR,GAA4BvB,OAAO,GAAGG,aAAzH;MACArgD,CAAC,IAAIgjD,SAAL;;MACA,IAAIhB,aAAJ,EAAmB;QACjBlwC,GAAG,CAAClgB,OAAJ;MACD;IACF;;IACD,IAAI0vD,QAAJ,EAAc;MACZra,OAAO,CAAChnC,CAAR,IAAaD,CAAb;IACD,CAFD,MAEO;MACLinC,OAAO,CAACjnC,CAAR,IAAaA,CAAC,GAAG40C,UAAjB;IACD;;IACD9iC,GAAG,CAAClgB,OAAJ;IACA,KAAKosD,OAAL;IACA,OAAOpkD,SAAP;EACD;;EACDwnD,aAAa,CAACD,MAAD,EAAS;IACpB,MAAMrvC,GAAG,GAAG,KAAKA,GAAjB;IACA,MAAMm1B,OAAO,GAAG,KAAKA,OAArB;IACA,MAAMpG,IAAI,GAAGoG,OAAO,CAACpG,IAArB;IACA,MAAMqT,QAAQ,GAAGjN,OAAO,CAACiN,QAAzB;IACA,MAAMmM,aAAa,GAAGpZ,OAAO,CAACoZ,aAA9B;IACA,MAAMkB,UAAU,GAAG1gB,IAAI,CAACygB,QAAL,GAAgB,CAAhB,GAAoB,CAAC,CAAxC;IACA,MAAM5M,WAAW,GAAGzN,OAAO,CAACyN,WAA5B;IACA,MAAMC,WAAW,GAAG1N,OAAO,CAAC0N,WAA5B;IACA,MAAMC,UAAU,GAAG3N,OAAO,CAAC2N,UAAR,GAAqByL,aAAxC;IACA,MAAM/L,UAAU,GAAGrN,OAAO,CAACqN,UAAR,IAAsBrsD,oBAAzC;IACA,MAAMo5D,YAAY,GAAGF,MAAM,CAAC7oD,MAA5B;IACA,MAAM2qD,eAAe,GAAGhc,OAAO,CAAC4N,iBAAR,KAA8B/pD,iBAAiB,CAACI,SAAxE;IACA,IAAIgP,CAAJ,EAAO4nD,KAAP,EAAcl9C,KAAd,EAAqBs+C,aAArB;;IACA,IAAID,eAAe,IAAI/O,QAAQ,KAAK,CAApC,EAAuC;MACrC;IACD;;IACD,KAAKgG,uBAAL,CAA6B,CAA7B,IAAkC,CAAC,CAAnC;IACA,KAAKC,0BAAL,GAAkC,IAAlC;IACAroC,GAAG,CAACngB,IAAJ;IACAmgB,GAAG,CAACjgB,SAAJ,CAAc,GAAGo1C,OAAO,CAACmN,UAAzB;IACAtiC,GAAG,CAACwiB,SAAJ,CAAc2S,OAAO,CAACjnC,CAAtB,EAAyBinC,OAAO,CAAChnC,CAAjC;IACA6R,GAAG,CAACxE,KAAJ,CAAUsnC,UAAV,EAAsByL,aAAtB;;IACA,KAAKnmD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGmnD,YAAhB,EAA8B,EAAEnnD,CAAhC,EAAmC;MACjC4nD,KAAK,GAAGX,MAAM,CAACjnD,CAAD,CAAd;;MACA,IAAI,OAAO4nD,KAAP,KAAiB,QAArB,EAA+B;QAC7BoB,aAAa,GAAG3B,UAAU,GAAGO,KAAb,GAAqB5N,QAArB,GAAgC,IAAhD;QACA,KAAKpiC,GAAL,CAASwiB,SAAT,CAAmB4uB,aAAnB,EAAkC,CAAlC;QACAjc,OAAO,CAACjnC,CAAR,IAAakjD,aAAa,GAAGtO,UAA7B;QACA;MACD;;MACD,MAAMsL,OAAO,GAAG,CAAC4B,KAAK,CAACG,OAAN,GAAgBtN,WAAhB,GAA8B,CAA/B,IAAoCD,WAApD;MACA,MAAM1I,YAAY,GAAGnL,IAAI,CAACsiB,oBAAL,CAA0BrB,KAAK,CAACsB,cAAhC,CAArB;;MACA,IAAI,CAACpX,YAAL,EAAmB;QACjBx0C,IAAI,CAAE,oBAAmBsqD,KAAK,CAACsB,cAAe,qBAA1C,CAAJ;QACA;MACD;;MACD,IAAI,KAAKvJ,cAAT,EAAyB;QACvB,KAAKN,eAAL,GAAuBuI,KAAvB;QACA,KAAKnwD,IAAL;QACAmgB,GAAG,CAACxE,KAAJ,CAAU4mC,QAAV,EAAoBA,QAApB;QACApiC,GAAG,CAACjgB,SAAJ,CAAc,GAAGyiD,UAAjB;QACA,KAAKnH,mBAAL,CAAyBnB,YAAzB;QACA,KAAKp6C,OAAL;MACD;;MACD,MAAMyxD,WAAW,GAAG58D,IAAI,CAAC0W,cAAL,CAAoB,CAAC2kD,KAAK,CAACl9C,KAAP,EAAc,CAAd,CAApB,EAAsC0vC,UAAtC,CAApB;MACA1vC,KAAK,GAAGy+C,WAAW,CAAC,CAAD,CAAX,GAAiBnP,QAAjB,GAA4BgM,OAApC;MACApuC,GAAG,CAACwiB,SAAJ,CAAc1vB,KAAd,EAAqB,CAArB;MACAqiC,OAAO,CAACjnC,CAAR,IAAa4E,KAAK,GAAGgwC,UAArB;IACD;;IACD9iC,GAAG,CAAClgB,OAAJ;IACA,KAAK2nD,eAAL,GAAuB,IAAvB;EACD;;EACDtlD,YAAY,CAACqvD,MAAD,EAASC,MAAT,EAAiB,CAAE;;EAC/BrvD,qBAAqB,CAACovD,MAAD,EAASC,MAAT,EAAiBC,GAAjB,EAAsBC,GAAtB,EAA2BC,GAA3B,EAAgCC,GAAhC,EAAqC;IACxD,KAAK7xC,GAAL,CAASnT,IAAT,CAAc6kD,GAAd,EAAmBC,GAAnB,EAAwBC,GAAG,GAAGF,GAA9B,EAAmCG,GAAG,GAAGF,GAAzC;IACA,KAAK3xC,GAAL,CAAShf,IAAT;IACA,KAAKD,OAAL;EACD;;EACD+wD,iBAAiB,CAAC9d,EAAD,EAAK;IACpB,IAAIiB,OAAJ;;IACA,IAAIjB,EAAE,CAAC,CAAD,CAAF,KAAU,eAAd,EAA+B;MAC7B,MAAM38B,KAAK,GAAG28B,EAAE,CAAC,CAAD,CAAhB;MACA,MAAM4B,aAAa,GAAG,KAAKA,aAAL,IAAsB71B,mBAAmB,CAAC,KAAKC,GAAN,CAA/D;MACA,MAAMi6B,qBAAqB,GAAG;QAC5BY,oBAAoB,EAAE76B,GAAG,IAAI,IAAI6mC,cAAJ,CAAmB7mC,GAAnB,EAAwB,KAAK+mC,UAA7B,EAAyC,KAAK/U,IAA9C,EAAoD,KAAK4N,aAAzD,EAAwE,KAAKn1B,aAA7E,EAA4F;UACvHu8B,qBAAqB,EAAE,KAAKA,qBAD2F;UAEvHC,kBAAkB,EAAE,KAAKA;QAF8F,CAA5F;MADD,CAA9B;MAMAhS,OAAO,GAAG,IAAI+E,aAAJ,CAAkBhG,EAAlB,EAAsB38B,KAAtB,EAA6B,KAAK2I,GAAlC,EAAuCi6B,qBAAvC,EAA8DrE,aAA9D,CAAV;IACD,CAVD,MAUO;MACLX,OAAO,GAAG,KAAK8c,WAAL,CAAiB/d,EAAE,CAAC,CAAD,CAAnB,EAAwBA,EAAE,CAAC,CAAD,CAA1B,CAAV;IACD;;IACD,OAAOiB,OAAP;EACD;;EACDzyC,eAAe,GAAG;IAChB,KAAK2yC,OAAL,CAAa0G,WAAb,GAA2B,KAAKiW,iBAAL,CAAuBE,SAAvB,CAA3B;EACD;;EACDtvD,aAAa,GAAG;IACd,KAAKyyC,OAAL,CAAayG,SAAb,GAAyB,KAAKkW,iBAAL,CAAuBE,SAAvB,CAAzB;IACA,KAAK7c,OAAL,CAAa8N,WAAb,GAA2B,IAA3B;EACD;;EACDpgD,iBAAiB,CAACgI,CAAD,EAAIC,CAAJ,EAAOC,CAAP,EAAU;IACzB,KAAKiV,GAAL,CAAS27B,WAAT,GAAuB,KAAKxG,OAAL,CAAa0G,WAAb,GAA2BlnD,IAAI,CAACiW,YAAL,CAAkBC,CAAlB,EAAqBC,CAArB,EAAwBC,CAAxB,CAAlD;EACD;;EACDnG,oBAAoB,GAAG;IACrB,KAAKob,GAAL,CAAS27B,WAAT,GAAuB,KAAKxG,OAAL,CAAa0G,WAAb,GAA2B,aAAlD;EACD;;EACD/4C,eAAe,CAAC+H,CAAD,EAAIC,CAAJ,EAAOC,CAAP,EAAU;IACvB,KAAKiV,GAAL,CAAS61B,SAAT,GAAqB,KAAKV,OAAL,CAAayG,SAAb,GAAyBjnD,IAAI,CAACiW,YAAL,CAAkBC,CAAlB,EAAqBC,CAArB,EAAwBC,CAAxB,CAA9C;IACA,KAAKoqC,OAAL,CAAa8N,WAAb,GAA2B,KAA3B;EACD;;EACDp+C,kBAAkB,GAAG;IACnB,KAAKmb,GAAL,CAAS61B,SAAT,GAAqB,KAAKV,OAAL,CAAayG,SAAb,GAAyB,aAA9C;IACA,KAAKzG,OAAL,CAAa8N,WAAb,GAA2B,KAA3B;EACD;;EACD8O,WAAW,CAACE,KAAD,EAAQ1d,MAAM,GAAG,IAAjB,EAAuB;IAChC,IAAIU,OAAJ;;IACA,IAAI,KAAK+S,cAAL,CAAoBt/B,GAApB,CAAwBupC,KAAxB,CAAJ,EAAoC;MAClChd,OAAO,GAAG,KAAK+S,cAAL,CAAoB11D,GAApB,CAAwB2/D,KAAxB,CAAV;IACD,CAFD,MAEO;MACLhd,OAAO,GAAG2E,iBAAiB,CAAC,KAAK2O,SAAL,CAAe0J,KAAf,CAAD,CAA3B;MACA,KAAKjK,cAAL,CAAoBnxC,GAApB,CAAwBo7C,KAAxB,EAA+Bhd,OAA/B;IACD;;IACD,IAAIV,MAAJ,EAAY;MACVU,OAAO,CAACV,MAAR,GAAiBA,MAAjB;IACD;;IACD,OAAOU,OAAP;EACD;;EACDhyC,WAAW,CAACgvD,KAAD,EAAQ;IACjB,IAAI,CAAC,KAAKlK,cAAV,EAA0B;MACxB;IACD;;IACD,MAAM/nC,GAAG,GAAG,KAAKA,GAAjB;IACA,KAAKngB,IAAL;;IACA,MAAMo1C,OAAO,GAAG,KAAK8c,WAAL,CAAiBE,KAAjB,CAAhB;;IACAjyC,GAAG,CAAC61B,SAAJ,GAAgBZ,OAAO,CAACnB,UAAR,CAAmB9zB,GAAnB,EAAwB,IAAxB,EAA8BG,0BAA0B,CAACH,GAAD,CAAxD,EAA+DuzB,QAAQ,CAACC,OAAxE,CAAhB;IACA,MAAM0e,GAAG,GAAG/xC,0BAA0B,CAACH,GAAD,CAAtC;;IACA,IAAIkyC,GAAJ,EAAS;MACP,MAAM;QACJp/C,KADI;QAEJC;MAFI,IAGFiN,GAAG,CAAChN,MAHR;MAIA,MAAM,CAAC1F,EAAD,EAAKI,EAAL,EAASH,EAAT,EAAaI,EAAb,IAAmBhZ,IAAI,CAACgX,0BAAL,CAAgC,CAAC,CAAD,EAAI,CAAJ,EAAOmH,KAAP,EAAcC,MAAd,CAAhC,EAAuDm/C,GAAvD,CAAzB;MACA,KAAKlyC,GAAL,CAAS4oC,QAAT,CAAkBt7C,EAAlB,EAAsBI,EAAtB,EAA0BH,EAAE,GAAGD,EAA/B,EAAmCK,EAAE,GAAGD,EAAxC;IACD,CAPD,MAOO;MACL,KAAKsS,GAAL,CAAS4oC,QAAT,CAAkB,CAAC,IAAnB,EAAyB,CAAC,IAA1B,EAAgC,IAAhC,EAAsC,IAAtC;IACD;;IACD,KAAKsD,OAAL,CAAa,KAAK/W,OAAL,CAAaC,yBAAb,EAAb;IACA,KAAKt1C,OAAL;EACD;;EACDoD,gBAAgB,GAAG;IACjByC,WAAW,CAAC,kCAAD,CAAX;EACD;;EACDxC,cAAc,GAAG;IACfwC,WAAW,CAAC,gCAAD,CAAX;EACD;;EACD9B,qBAAqB,CAAC0wC,MAAD,EAASb,IAAT,EAAe;IAClC,IAAI,CAAC,KAAKqU,cAAV,EAA0B;MACxB;IACD;;IACD,KAAKloD,IAAL;IACA,KAAK6nD,kBAAL,CAAwBh/C,IAAxB,CAA6B,KAAKktC,aAAlC;;IACA,IAAIrB,MAAJ,EAAY;MACV,KAAKx0C,SAAL,CAAe,GAAGw0C,MAAlB;IACD;;IACD,KAAKqB,aAAL,GAAqB71B,mBAAmB,CAAC,KAAKC,GAAN,CAAxC;;IACA,IAAI0zB,IAAJ,EAAU;MACR,MAAM5gC,KAAK,GAAG4gC,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAA5B;MACA,MAAM3gC,MAAM,GAAG2gC,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAA7B;MACA,KAAK1zB,GAAL,CAASnT,IAAT,CAAc6mC,IAAI,CAAC,CAAD,CAAlB,EAAuBA,IAAI,CAAC,CAAD,CAA3B,EAAgC5gC,KAAhC,EAAuCC,MAAvC;MACA,KAAKoiC,OAAL,CAAauG,gBAAb,CAA8B37B,mBAAmB,CAAC,KAAKC,GAAN,CAAjD,EAA6D0zB,IAA7D;MACA,KAAK1yC,IAAL;MACA,KAAKD,OAAL;IACD;EACF;;EACD+C,mBAAmB,GAAG;IACpB,IAAI,CAAC,KAAKikD,cAAV,EAA0B;MACxB;IACD;;IACD,KAAKjoD,OAAL;IACA,KAAK81C,aAAL,GAAqB,KAAK8R,kBAAL,CAAwB4F,GAAxB,EAArB;EACD;;EACDvpD,UAAU,CAACouD,KAAD,EAAQ;IAChB,IAAI,CAAC,KAAKpK,cAAV,EAA0B;MACxB;IACD;;IACD,KAAKloD,IAAL;;IACA,IAAI,KAAKgqD,WAAT,EAAsB;MACpB,KAAKkC,YAAL;MACA,KAAK5W,OAAL,CAAakO,WAAb,GAA2B,IAA3B;IACD;;IACD,MAAM+O,UAAU,GAAG,KAAKpyC,GAAxB;;IACA,IAAI,CAACmyC,KAAK,CAACE,QAAX,EAAqB;MACnB/sD,IAAI,CAAC,oCAAD,CAAJ;IACD;;IACD,IAAI6sD,KAAK,CAACG,QAAV,EAAoB;MAClB5sD,IAAI,CAAC,gCAAD,CAAJ;IACD;;IACD,MAAMilD,gBAAgB,GAAG5qC,mBAAmB,CAACqyC,UAAD,CAA5C;;IACA,IAAID,KAAK,CAAC5d,MAAV,EAAkB;MAChB6d,UAAU,CAACryD,SAAX,CAAqB,GAAGoyD,KAAK,CAAC5d,MAA9B;IACD;;IACD,IAAI,CAAC4d,KAAK,CAACze,IAAX,EAAiB;MACf,MAAM,IAAI9tC,KAAJ,CAAU,2BAAV,CAAN;IACD;;IACD,IAAI2sD,MAAM,GAAG59D,IAAI,CAACgX,0BAAL,CAAgCwmD,KAAK,CAACze,IAAtC,EAA4C3zB,mBAAmB,CAACqyC,UAAD,CAA/D,CAAb;IACA,MAAMI,YAAY,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAOJ,UAAU,CAACp/C,MAAX,CAAkBF,KAAzB,EAAgCs/C,UAAU,CAACp/C,MAAX,CAAkBD,MAAlD,CAArB;IACAw/C,MAAM,GAAG59D,IAAI,CAACmY,SAAL,CAAeylD,MAAf,EAAuBC,YAAvB,KAAwC,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAjD;IACA,MAAM92C,OAAO,GAAGpT,IAAI,CAAC4I,KAAL,CAAWqhD,MAAM,CAAC,CAAD,CAAjB,CAAhB;IACA,MAAM52C,OAAO,GAAGrT,IAAI,CAAC4I,KAAL,CAAWqhD,MAAM,CAAC,CAAD,CAAjB,CAAhB;IACA,MAAMrH,UAAU,GAAG5iD,IAAI,CAAC2D,GAAL,CAAS3D,IAAI,CAAC+sC,IAAL,CAAUkd,MAAM,CAAC,CAAD,CAAhB,IAAuB72C,OAAhC,EAAyC,CAAzC,CAAnB;IACA,MAAMyvC,WAAW,GAAG7iD,IAAI,CAAC2D,GAAL,CAAS3D,IAAI,CAAC+sC,IAAL,CAAUkd,MAAM,CAAC,CAAD,CAAhB,IAAuB52C,OAAhC,EAAyC,CAAzC,CAApB;IACA,KAAKw5B,OAAL,CAAaoO,sBAAb,CAAoC,CAAC,CAAD,EAAI,CAAJ,EAAO2H,UAAP,EAAmBC,WAAnB,CAApC;IACA,IAAIa,OAAO,GAAG,YAAY,KAAKlR,UAA/B;;IACA,IAAIqX,KAAK,CAAC/F,KAAV,EAAiB;MACfJ,OAAO,IAAI,YAAY,KAAKpE,YAAL,KAAsB,CAA7C;IACD;;IACD,MAAMqE,aAAa,GAAG,KAAK1W,cAAL,CAAoBC,SAApB,CAA8BwW,OAA9B,EAAuCd,UAAvC,EAAmDC,WAAnD,CAAtB;IACA,MAAMsH,QAAQ,GAAGxG,aAAa,CAAC/4C,OAA/B;IACAu/C,QAAQ,CAACjwB,SAAT,CAAmB,CAAC9mB,OAApB,EAA6B,CAACC,OAA9B;IACA82C,QAAQ,CAAC1yD,SAAT,CAAmB,GAAG4qD,gBAAtB;;IACA,IAAIwH,KAAK,CAAC/F,KAAV,EAAiB;MACf,KAAKzE,UAAL,CAAgBj/C,IAAhB,CAAqB;QACnBsK,MAAM,EAAEi5C,aAAa,CAACj5C,MADH;QAEnBE,OAAO,EAAEu/C,QAFU;QAGnB/2C,OAHmB;QAInBC,OAJmB;QAKnBkxC,OAAO,EAAEsF,KAAK,CAAC/F,KAAN,CAAYS,OALF;QAMnBC,QAAQ,EAAEqF,KAAK,CAAC/F,KAAN,CAAYU,QANH;QAOnBC,WAAW,EAAEoF,KAAK,CAAC/F,KAAN,CAAYW,WAAZ,IAA2B,IAPrB;QAQnB2F,qBAAqB,EAAE;MARJ,CAArB;IAUD,CAXD,MAWO;MACLN,UAAU,CAACnc,YAAX,CAAwB,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAApC,EAAuC,CAAvC;MACAmc,UAAU,CAAC5vB,SAAX,CAAqB9mB,OAArB,EAA8BC,OAA9B;MACAy2C,UAAU,CAACvyD,IAAX;IACD;;IACDylD,YAAY,CAAC8M,UAAD,EAAaK,QAAb,CAAZ;IACA,KAAKzyC,GAAL,GAAWyyC,QAAX;IACA,KAAK7yD,SAAL,CAAe,CAAC,CAAC,IAAD,EAAO,aAAP,CAAD,EAAwB,CAAC,IAAD,EAAO,CAAP,CAAxB,EAAmC,CAAC,IAAD,EAAO,CAAP,CAAnC,CAAf;IACA,KAAK4nD,UAAL,CAAgB9+C,IAAhB,CAAqB0pD,UAArB;IACA,KAAKtX,UAAL;EACD;;EACD92C,QAAQ,CAACmuD,KAAD,EAAQ;IACd,IAAI,CAAC,KAAKpK,cAAV,EAA0B;MACxB;IACD;;IACD,KAAKjN,UAAL;IACA,MAAM2X,QAAQ,GAAG,KAAKzyC,GAAtB;IACA,MAAMA,GAAG,GAAG,KAAKwnC,UAAL,CAAgB8F,GAAhB,EAAZ;IACA,KAAKttC,GAAL,GAAWA,GAAX;IACA,KAAKA,GAAL,CAASsrC,qBAAT,GAAiC,KAAjC;;IACA,IAAI6G,KAAK,CAAC/F,KAAV,EAAiB;MACf,KAAKvE,SAAL,GAAiB,KAAKF,UAAL,CAAgB2F,GAAhB,EAAjB;MACA,KAAKxtD,OAAL;IACD,CAHD,MAGO;MACL,KAAKkgB,GAAL,CAASlgB,OAAT;MACA,MAAM6yD,UAAU,GAAG5yC,mBAAmB,CAAC,KAAKC,GAAN,CAAtC;MACA,KAAKlgB,OAAL;MACA,KAAKkgB,GAAL,CAASngB,IAAT;MACA,KAAKmgB,GAAL,CAASi2B,YAAT,CAAsB,GAAG0c,UAAzB;MACA,MAAMxG,QAAQ,GAAGx3D,IAAI,CAACgX,0BAAL,CAAgC,CAAC,CAAD,EAAI,CAAJ,EAAO8mD,QAAQ,CAACz/C,MAAT,CAAgBF,KAAvB,EAA8B2/C,QAAQ,CAACz/C,MAAT,CAAgBD,MAA9C,CAAhC,EAAuF4/C,UAAvF,CAAjB;MACA,KAAK3yC,GAAL,CAASkF,SAAT,CAAmButC,QAAQ,CAACz/C,MAA5B,EAAoC,CAApC,EAAuC,CAAvC;MACA,KAAKgN,GAAL,CAASlgB,OAAT;MACA,KAAKosD,OAAL,CAAaC,QAAb;IACD;EACF;;EACDloD,eAAe,CAAC8Q,EAAD,EAAKlI,IAAL,EAAW9M,SAAX,EAAsBw0C,MAAtB,EAA8Bqe,YAA9B,EAA4C;IACzD,KAAK,CAAChJ,mBAAN;IACA/D,iBAAiB,CAAC,KAAK7lC,GAAN,CAAjB;IACA,KAAKA,GAAL,CAASngB,IAAT;IACA,KAAKA,IAAL;;IACA,IAAI,KAAK+1C,aAAT,EAAwB;MACtB,KAAK51B,GAAL,CAASi2B,YAAT,CAAsB,GAAG,KAAKL,aAA9B;IACD;;IACD,IAAI/oC,IAAJ,EAAU;MACR,MAAMiG,KAAK,GAAGjG,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAA5B;MACA,MAAMkG,MAAM,GAAGlG,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAA7B;;MACA,IAAI+lD,YAAY,IAAI,KAAK1L,mBAAzB,EAA8C;QAC5CnnD,SAAS,GAAGA,SAAS,CAAC+L,KAAV,EAAZ;QACA/L,SAAS,CAAC,CAAD,CAAT,IAAgB8M,IAAI,CAAC,CAAD,CAApB;QACA9M,SAAS,CAAC,CAAD,CAAT,IAAgB8M,IAAI,CAAC,CAAD,CAApB;QACAA,IAAI,GAAGA,IAAI,CAACf,KAAL,EAAP;QACAe,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAJ,GAAU,CAApB;QACAA,IAAI,CAAC,CAAD,CAAJ,GAAUiG,KAAV;QACAjG,IAAI,CAAC,CAAD,CAAJ,GAAUkG,MAAV;QACA,MAAM,CAAC0jC,MAAD,EAASC,MAAT,IAAmB/hD,IAAI,CAACwX,6BAAL,CAAmC4T,mBAAmB,CAAC,KAAKC,GAAN,CAAtD,CAAzB;QACA,MAAM;UACJioC;QADI,IAEF,IAFJ;QAGA,MAAM4K,WAAW,GAAGvqD,IAAI,CAAC+sC,IAAL,CAAUviC,KAAK,GAAG,KAAKo1C,YAAb,GAA4BD,aAAtC,CAApB;QACA,MAAM6K,YAAY,GAAGxqD,IAAI,CAAC+sC,IAAL,CAAUtiC,MAAM,GAAG,KAAKo1C,YAAd,GAA6BF,aAAvC,CAArB;QACA,KAAK8K,gBAAL,GAAwB,KAAKnT,aAAL,CAAmBv2C,MAAnB,CAA0BwpD,WAA1B,EAAuCC,YAAvC,CAAxB;QACA,MAAM;UACJ9/C,MADI;UAEJE;QAFI,IAGF,KAAK6/C,gBAHT;QAIA,KAAK7L,mBAAL,CAAyBrwC,GAAzB,CAA6B9B,EAA7B,EAAiC/B,MAAjC;QACA,KAAK+/C,gBAAL,CAAsBC,QAAtB,GAAiC,KAAKhzC,GAAtC;QACA,KAAKA,GAAL,GAAW9M,OAAX;QACA,KAAK8M,GAAL,CAASngB,IAAT;QACA,KAAKmgB,GAAL,CAASi2B,YAAT,CAAsBQ,MAAtB,EAA8B,CAA9B,EAAiC,CAAjC,EAAoC,CAACC,MAArC,EAA6C,CAA7C,EAAgD3jC,MAAM,GAAG2jC,MAAzD;QACAmP,iBAAiB,CAAC,KAAK7lC,GAAN,CAAjB;MACD,CAzBD,MAyBO;QACL6lC,iBAAiB,CAAC,KAAK7lC,GAAN,CAAjB;QACA,KAAKA,GAAL,CAASnT,IAAT,CAAcA,IAAI,CAAC,CAAD,CAAlB,EAAuBA,IAAI,CAAC,CAAD,CAA3B,EAAgCiG,KAAhC,EAAuCC,MAAvC;QACA,KAAKiN,GAAL,CAAShf,IAAT;QACA,KAAKD,OAAL;MACD;IACF;;IACD,KAAKo0C,OAAL,GAAe,IAAI+M,gBAAJ,CAAqB,KAAKliC,GAAL,CAAShN,MAAT,CAAgBF,KAArC,EAA4C,KAAKkN,GAAL,CAAShN,MAAT,CAAgBD,MAA5D,CAAf;IACA,KAAKhT,SAAL,CAAe,GAAGA,SAAlB;IACA,KAAKA,SAAL,CAAe,GAAGw0C,MAAlB;EACD;;EACDrwC,aAAa,GAAG;IACd,IAAI,KAAK6uD,gBAAT,EAA2B;MACzB,KAAK/yC,GAAL,CAASlgB,OAAT;MACA,KAAK,CAACiqD,UAAN;MACA,KAAK/pC,GAAL,GAAW,KAAK+yC,gBAAL,CAAsBC,QAAjC;MACA,OAAO,KAAKD,gBAAL,CAAsBC,QAA7B;MACA,OAAO,KAAKD,gBAAZ;IACD;EACF;;EACD5uD,qBAAqB,CAACgmD,GAAD,EAAM;IACzB,IAAI,CAAC,KAAKpC,cAAV,EAA0B;MACxB;IACD;;IACD,MAAM/a,KAAK,GAAGmd,GAAG,CAACnd,KAAlB;IACAmd,GAAG,GAAG,KAAK5B,SAAL,CAAe4B,GAAG,CAACjvC,IAAnB,EAAyBivC,GAAzB,CAAN;IACAA,GAAG,CAACnd,KAAJ,GAAYA,KAAZ;IACA,MAAMhtB,GAAG,GAAG,KAAKA,GAAjB;IACA,MAAMgwC,KAAK,GAAG,KAAKvI,eAAnB;;IACA,IAAIuI,KAAJ,EAAW;MACT,IAAIA,KAAK,CAACiD,QAAN,KAAmBnrD,SAAvB,EAAkC;QAChCkoD,KAAK,CAACiD,QAAN,GAAiBhS,iBAAiB,CAACkJ,GAAD,CAAlC;MACD;;MACD,IAAI6F,KAAK,CAACiD,QAAV,EAAoB;QAClBjD,KAAK,CAACiD,QAAN,CAAejzC,GAAf;QACA;MACD;IACF;;IACD,MAAM0hC,IAAI,GAAG,KAAK+I,iBAAL,CAAuBN,GAAvB,CAAb;;IACA,MAAMW,UAAU,GAAGpJ,IAAI,CAAC1uC,MAAxB;IACAgN,GAAG,CAACngB,IAAJ;IACAmgB,GAAG,CAACi2B,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B,EAAgC,CAAhC;IACAj2B,GAAG,CAACkF,SAAJ,CAAc4lC,UAAd,EAA0BpJ,IAAI,CAAChmC,OAA/B,EAAwCgmC,IAAI,CAAC/lC,OAA7C;IACAqE,GAAG,CAAClgB,OAAJ;IACA,KAAKosD,OAAL;EACD;;EACDznD,2BAA2B,CAAC0lD,GAAD,EAAM1T,MAAN,EAAcyc,KAAK,GAAG,CAAtB,EAAyBC,KAAK,GAAG,CAAjC,EAAoCzc,MAApC,EAA4C0c,SAA5C,EAAuD;IAChF,IAAI,CAAC,KAAKrL,cAAV,EAA0B;MACxB;IACD;;IACDoC,GAAG,GAAG,KAAK5B,SAAL,CAAe4B,GAAG,CAACjvC,IAAnB,EAAyBivC,GAAzB,CAAN;IACA,MAAMnqC,GAAG,GAAG,KAAKA,GAAjB;IACAA,GAAG,CAACngB,IAAJ;IACA,MAAM8qD,gBAAgB,GAAG5qC,mBAAmB,CAACC,GAAD,CAA5C;IACAA,GAAG,CAACjgB,SAAJ,CAAc02C,MAAd,EAAsByc,KAAtB,EAA6BC,KAA7B,EAAoCzc,MAApC,EAA4C,CAA5C,EAA+C,CAA/C;;IACA,MAAMgL,IAAI,GAAG,KAAK+I,iBAAL,CAAuBN,GAAvB,CAAb;;IACAnqC,GAAG,CAACi2B,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6ByL,IAAI,CAAChmC,OAAL,GAAeivC,gBAAgB,CAAC,CAAD,CAA5D,EAAiEjJ,IAAI,CAAC/lC,OAAL,GAAegvC,gBAAgB,CAAC,CAAD,CAAhG;;IACA,KAAK,IAAIviD,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGgkD,SAAS,CAAC5sD,MAA/B,EAAuC4B,CAAC,GAAGgH,EAA3C,EAA+ChH,CAAC,IAAI,CAApD,EAAuD;MACrD,MAAMirD,KAAK,GAAG1+D,IAAI,CAACoL,SAAL,CAAe4qD,gBAAf,EAAiC,CAAClU,MAAD,EAASyc,KAAT,EAAgBC,KAAhB,EAAuBzc,MAAvB,EAA+B0c,SAAS,CAAChrD,CAAD,CAAxC,EAA6CgrD,SAAS,CAAChrD,CAAC,GAAG,CAAL,CAAtD,CAAjC,CAAd;MACA,MAAM,CAAC8F,CAAD,EAAIC,CAAJ,IAASxZ,IAAI,CAAC0W,cAAL,CAAoB,CAAC,CAAD,EAAI,CAAJ,CAApB,EAA4BgoD,KAA5B,CAAf;MACArzC,GAAG,CAACkF,SAAJ,CAAcw8B,IAAI,CAAC1uC,MAAnB,EAA2B9E,CAA3B,EAA8BC,CAA9B;IACD;;IACD6R,GAAG,CAAClgB,OAAJ;IACA,KAAKosD,OAAL;EACD;;EACD9nD,0BAA0B,CAACkvD,MAAD,EAAS;IACjC,IAAI,CAAC,KAAKvL,cAAV,EAA0B;MACxB;IACD;;IACD,MAAM/nC,GAAG,GAAG,KAAKA,GAAjB;IACA,MAAM47B,SAAS,GAAG,KAAKzG,OAAL,CAAayG,SAA/B;IACA,MAAM8O,aAAa,GAAG,KAAKvV,OAAL,CAAa8N,WAAnC;;IACA,KAAK,MAAMn+B,KAAX,IAAoBwuC,MAApB,EAA4B;MAC1B,MAAM;QACJp4C,IADI;QAEJpI,KAFI;QAGJC,MAHI;QAIJhT;MAJI,IAKF+kB,KALJ;MAMA,MAAMgmC,UAAU,GAAG,KAAKvV,cAAL,CAAoBC,SAApB,CAA8B,YAA9B,EAA4C1iC,KAA5C,EAAmDC,MAAnD,CAAnB;MACA,MAAMi6C,OAAO,GAAGlC,UAAU,CAAC53C,OAA3B;MACA85C,OAAO,CAACntD,IAAR;MACA,MAAMsqD,GAAG,GAAG,KAAK5B,SAAL,CAAertC,IAAf,EAAqB4J,KAArB,CAAZ;MACAugC,kBAAkB,CAAC2H,OAAD,EAAU7C,GAAV,CAAlB;MACA6C,OAAO,CAAC7G,wBAAR,GAAmC,WAAnC;MACA6G,OAAO,CAACnX,SAAR,GAAoB6U,aAAa,GAAG9O,SAAS,CAAC9H,UAAV,CAAqBkZ,OAArB,EAA8B,IAA9B,EAAoC7sC,0BAA0B,CAACH,GAAD,CAA9D,EAAqEuzB,QAAQ,CAACt6C,IAA9E,CAAH,GAAyF2iD,SAA1H;MACAoR,OAAO,CAACpE,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuB91C,KAAvB,EAA8BC,MAA9B;MACAi6C,OAAO,CAACltD,OAAR;MACAkgB,GAAG,CAACngB,IAAJ;MACAmgB,GAAG,CAACjgB,SAAJ,CAAc,GAAGA,SAAjB;MACAigB,GAAG,CAACxE,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd;MACAskC,wBAAwB,CAAC9/B,GAAD,EAAM8qC,UAAU,CAAC93C,MAAjB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+BF,KAA/B,EAAsCC,MAAtC,EAA8C,CAA9C,EAAiD,CAAC,CAAlD,EAAqD,CAArD,EAAwD,CAAxD,CAAxB;MACAiN,GAAG,CAAClgB,OAAJ;IACD;;IACD,KAAKosD,OAAL;EACD;;EACD7nD,iBAAiB,CAAC4tD,KAAD,EAAQ;IACvB,IAAI,CAAC,KAAKlK,cAAV,EAA0B;MACxB;IACD;;IACD,MAAM7G,OAAO,GAAG,KAAKqH,SAAL,CAAe0J,KAAf,CAAhB;;IACA,IAAI,CAAC/Q,OAAL,EAAc;MACZx7C,IAAI,CAAC,iCAAD,CAAJ;MACA;IACD;;IACD,KAAKpB,uBAAL,CAA6B48C,OAA7B;EACD;;EACD18C,uBAAuB,CAACytD,KAAD,EAAQxb,MAAR,EAAgBC,MAAhB,EAAwB0c,SAAxB,EAAmC;IACxD,IAAI,CAAC,KAAKrL,cAAV,EAA0B;MACxB;IACD;;IACD,MAAM7G,OAAO,GAAG,KAAKqH,SAAL,CAAe0J,KAAf,CAAhB;;IACA,IAAI,CAAC/Q,OAAL,EAAc;MACZx7C,IAAI,CAAC,iCAAD,CAAJ;MACA;IACD;;IACD,MAAMoN,KAAK,GAAGouC,OAAO,CAACpuC,KAAtB;IACA,MAAMC,MAAM,GAAGmuC,OAAO,CAACnuC,MAAvB;IACA,MAAM3J,GAAG,GAAG,EAAZ;;IACA,KAAK,IAAIhB,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGgkD,SAAS,CAAC5sD,MAA/B,EAAuC4B,CAAC,GAAGgH,EAA3C,EAA+ChH,CAAC,IAAI,CAApD,EAAuD;MACrDgB,GAAG,CAACV,IAAJ,CAAS;QACP3I,SAAS,EAAE,CAAC02C,MAAD,EAAS,CAAT,EAAY,CAAZ,EAAeC,MAAf,EAAuB0c,SAAS,CAAChrD,CAAD,CAAhC,EAAqCgrD,SAAS,CAAChrD,CAAC,GAAG,CAAL,CAA9C,CADJ;QAEP8F,CAAC,EAAE,CAFI;QAGPC,CAAC,EAAE,CAHI;QAIPsS,CAAC,EAAE3N,KAJI;QAKP4N,CAAC,EAAE3N;MALI,CAAT;IAOD;;IACD,KAAKxO,4BAAL,CAAkC28C,OAAlC,EAA2C93C,GAA3C;EACD;;EACDmqD,yBAAyB,CAACvzC,GAAD,EAAM;IAC7B,IAAI,KAAKm1B,OAAL,CAAamO,YAAb,KAA8B,MAAlC,EAA0C;MACxCtjC,GAAG,CAAClJ,MAAJ,GAAa,KAAKq+B,OAAL,CAAamO,YAA1B;MACAtjC,GAAG,CAACkF,SAAJ,CAAclF,GAAG,CAAChN,MAAlB,EAA0B,CAA1B,EAA6B,CAA7B;MACAgN,GAAG,CAAClJ,MAAJ,GAAa,MAAb;IACD;;IACD,OAAOkJ,GAAG,CAAChN,MAAX;EACD;;EACDwgD,yBAAyB,CAACtS,OAAD,EAAU;IACjC,IAAI,KAAK/L,OAAL,CAAamO,YAAb,KAA8B,MAAlC,EAA0C;MACxC,OAAOpC,OAAO,CAAC77B,MAAf;IACD;;IACD,MAAM;MACJA,MADI;MAEJvS,KAFI;MAGJC;IAHI,IAIFmuC,OAJJ;IAKA,MAAM5L,SAAS,GAAG,KAAKC,cAAL,CAAoBC,SAApB,CAA8B,aAA9B,EAA6C1iC,KAA7C,EAAoDC,MAApD,CAAlB;IACA,MAAM0iC,MAAM,GAAGH,SAAS,CAACpiC,OAAzB;IACAuiC,MAAM,CAAC3+B,MAAP,GAAgB,KAAKq+B,OAAL,CAAamO,YAA7B;IACA7N,MAAM,CAACvwB,SAAP,CAAiBG,MAAjB,EAAyB,CAAzB,EAA4B,CAA5B;IACAowB,MAAM,CAAC3+B,MAAP,GAAgB,MAAhB;IACA,OAAOw+B,SAAS,CAACtiC,MAAjB;EACD;;EACD1O,uBAAuB,CAAC48C,OAAD,EAAU;IAC/B,IAAI,CAAC,KAAK6G,cAAV,EAA0B;MACxB;IACD;;IACD,MAAMj1C,KAAK,GAAGouC,OAAO,CAACpuC,KAAtB;IACA,MAAMC,MAAM,GAAGmuC,OAAO,CAACnuC,MAAvB;IACA,MAAMiN,GAAG,GAAG,KAAKA,GAAjB;IACA,KAAKngB,IAAL;;IACA,IAAI,CAACjK,QAAL,EAAe;MACb,MAAM;QACJkhB;MADI,IAEFkJ,GAFJ;;MAGA,IAAIlJ,MAAM,KAAK,MAAX,IAAqBA,MAAM,KAAK,EAApC,EAAwC;QACtCkJ,GAAG,CAAClJ,MAAJ,GAAa,MAAb;MACD;IACF;;IACDkJ,GAAG,CAACxE,KAAJ,CAAU,IAAI1I,KAAd,EAAqB,CAAC,CAAD,GAAKC,MAA1B;IACA,IAAI0gD,UAAJ;;IACA,IAAIvS,OAAO,CAAC77B,MAAZ,EAAoB;MAClBouC,UAAU,GAAG,KAAKD,yBAAL,CAA+BtS,OAA/B,CAAb;IACD,CAFD,MAEO,IAAI,OAAOwS,WAAP,KAAuB,UAAvB,IAAqCxS,OAAO,YAAYwS,WAAxD,IAAuE,CAACxS,OAAO,CAAChmC,IAApF,EAA0F;MAC/Fu4C,UAAU,GAAGvS,OAAb;IACD,CAFM,MAEA;MACL,MAAM5L,SAAS,GAAG,KAAKC,cAAL,CAAoBC,SAApB,CAA8B,aAA9B,EAA6C1iC,KAA7C,EAAoDC,MAApD,CAAlB;MACA,MAAM0iC,MAAM,GAAGH,SAAS,CAACpiC,OAAzB;MACAmxC,kBAAkB,CAAC5O,MAAD,EAASyL,OAAT,CAAlB;MACAuS,UAAU,GAAG,KAAKF,yBAAL,CAA+B9d,MAA/B,CAAb;IACD;;IACD,MAAMoV,MAAM,GAAG,KAAKX,WAAL,CAAiBuJ,UAAjB,EAA6BtzC,0BAA0B,CAACH,GAAD,CAAvD,CAAf;;IACAA,GAAG,CAACsrC,qBAAJ,GAA4BlF,wBAAwB,CAACrmC,mBAAmB,CAACC,GAAD,CAApB,EAA2BkhC,OAAO,CAACmF,WAAnC,CAApD;IACAvG,wBAAwB,CAAC9/B,GAAD,EAAM6qC,MAAM,CAACV,GAAb,EAAkB,CAAlB,EAAqB,CAArB,EAAwBU,MAAM,CAACP,UAA/B,EAA2CO,MAAM,CAACN,WAAlD,EAA+D,CAA/D,EAAkE,CAACx3C,MAAnE,EAA2ED,KAA3E,EAAkFC,MAAlF,CAAxB;IACA,KAAKm5C,OAAL;IACA,KAAKpsD,OAAL;EACD;;EACDyE,4BAA4B,CAAC28C,OAAD,EAAU93C,GAAV,EAAe;IACzC,IAAI,CAAC,KAAK2+C,cAAV,EAA0B;MACxB;IACD;;IACD,MAAM/nC,GAAG,GAAG,KAAKA,GAAjB;IACA,IAAIyzC,UAAJ;;IACA,IAAIvS,OAAO,CAAC77B,MAAZ,EAAoB;MAClBouC,UAAU,GAAGvS,OAAO,CAAC77B,MAArB;IACD,CAFD,MAEO;MACL,MAAM5E,CAAC,GAAGygC,OAAO,CAACpuC,KAAlB;MACA,MAAM4N,CAAC,GAAGwgC,OAAO,CAACnuC,MAAlB;MACA,MAAMuiC,SAAS,GAAG,KAAKC,cAAL,CAAoBC,SAApB,CAA8B,aAA9B,EAA6C/0B,CAA7C,EAAgDC,CAAhD,CAAlB;MACA,MAAM+0B,MAAM,GAAGH,SAAS,CAACpiC,OAAzB;MACAmxC,kBAAkB,CAAC5O,MAAD,EAASyL,OAAT,CAAlB;MACAuS,UAAU,GAAG,KAAKF,yBAAL,CAA+B9d,MAA/B,CAAb;IACD;;IACD,KAAK,MAAMtJ,KAAX,IAAoB/iC,GAApB,EAAyB;MACvB4W,GAAG,CAACngB,IAAJ;MACAmgB,GAAG,CAACjgB,SAAJ,CAAc,GAAGosC,KAAK,CAACpsC,SAAvB;MACAigB,GAAG,CAACxE,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd;MACAskC,wBAAwB,CAAC9/B,GAAD,EAAMyzC,UAAN,EAAkBtnB,KAAK,CAACj+B,CAAxB,EAA2Bi+B,KAAK,CAACh+B,CAAjC,EAAoCg+B,KAAK,CAAC1rB,CAA1C,EAA6C0rB,KAAK,CAACzrB,CAAnD,EAAsD,CAAtD,EAAyD,CAAC,CAA1D,EAA6D,CAA7D,EAAgE,CAAhE,CAAxB;MACAV,GAAG,CAAClgB,OAAJ;IACD;;IACD,KAAKosD,OAAL;EACD;;EACDxnD,wBAAwB,GAAG;IACzB,IAAI,CAAC,KAAKqjD,cAAV,EAA0B;MACxB;IACD;;IACD,KAAK/nC,GAAL,CAAS4oC,QAAT,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B;IACA,KAAKsD,OAAL;EACD;;EACD5oD,SAAS,CAACqwD,GAAD,EAAM,CAAE;;EACjBpwD,cAAc,CAACowD,GAAD,EAAMnO,UAAN,EAAkB,CAAE;;EAClChiD,kBAAkB,CAACmwD,GAAD,EAAM;IACtB,KAAK1M,kBAAL,CAAwBv+C,IAAxB,CAA6B;MAC3B4uB,OAAO,EAAE;IADkB,CAA7B;EAGD;;EACD7zB,uBAAuB,CAACkwD,GAAD,EAAMnO,UAAN,EAAkB;IACvC,IAAImO,GAAG,KAAK,IAAZ,EAAkB;MAChB,KAAK1M,kBAAL,CAAwBv+C,IAAxB,CAA6B;QAC3B4uB,OAAO,EAAE,KAAK0vB,qBAAL,CAA2B4M,SAA3B,CAAqCpO,UAArC;MADkB,CAA7B;IAGD,CAJD,MAIO;MACL,KAAKyB,kBAAL,CAAwBv+C,IAAxB,CAA6B;QAC3B4uB,OAAO,EAAE;MADkB,CAA7B;IAGD;;IACD,KAAKywB,cAAL,GAAsB,KAAK8L,gBAAL,EAAtB;EACD;;EACDnwD,gBAAgB,GAAG;IACjB,KAAKujD,kBAAL,CAAwBqG,GAAxB;IACA,KAAKvF,cAAL,GAAsB,KAAK8L,gBAAL,EAAtB;EACD;;EACDlwD,WAAW,GAAG,CAAE;;EAChBC,SAAS,GAAG,CAAE;;EACdkqD,WAAW,CAACtK,OAAD,EAAU;IACnB,MAAM33B,OAAO,GAAG,KAAKspB,OAAL,CAAagP,WAAb,EAAhB;;IACA,IAAI,KAAKiD,WAAT,EAAsB;MACpB,KAAKjS,OAAL,CAAa+O,kBAAb;IACD;;IACD,IAAI,CAAC,KAAKkD,WAAV,EAAuB;MACrB,KAAK8E,OAAL,CAAa1I,OAAb;IACD;;IACD,MAAMxjC,GAAG,GAAG,KAAKA,GAAjB;;IACA,IAAI,KAAKonC,WAAT,EAAsB;MACpB,IAAI,CAACv7B,OAAL,EAAc;QACZ,IAAI,KAAKu7B,WAAL,KAAqBR,OAAzB,EAAkC;UAChC5mC,GAAG,CAAChf,IAAJ,CAAS,SAAT;QACD,CAFD,MAEO;UACLgf,GAAG,CAAChf,IAAJ;QACD;MACF;;MACD,KAAKomD,WAAL,GAAmB,IAAnB;IACD;;IACD,KAAKjS,OAAL,CAAaoO,sBAAb,CAAoC,KAAKpO,OAAL,CAAaqO,OAAjD;IACAxjC,GAAG,CAAC21B,SAAJ;EACD;;EACDka,mBAAmB,GAAG;IACpB,IAAI,CAAC,KAAKxH,0BAAV,EAAsC;MACpC,MAAM98C,CAAC,GAAGwU,mBAAmB,CAAC,KAAKC,GAAN,CAA7B;;MACA,IAAIzU,CAAC,CAAC,CAAD,CAAD,KAAS,CAAT,IAAcA,CAAC,CAAC,CAAD,CAAD,KAAS,CAA3B,EAA8B;QAC5B,KAAK88C,0BAAL,GAAkC,IAAI//C,IAAI,CAACC,GAAL,CAASD,IAAI,CAAC+F,GAAL,CAAS9C,CAAC,CAAC,CAAD,CAAV,CAAT,EAAyBjD,IAAI,CAAC+F,GAAL,CAAS9C,CAAC,CAAC,CAAD,CAAV,CAAzB,CAAtC;MACD,CAFD,MAEO;QACL,MAAMuoD,MAAM,GAAGxrD,IAAI,CAAC+F,GAAL,CAAS9C,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAA/B,CAAf;QACA,MAAMwoD,KAAK,GAAGzrD,IAAI,CAACi+B,KAAL,CAAWh7B,CAAC,CAAC,CAAD,CAAZ,EAAiBA,CAAC,CAAC,CAAD,CAAlB,CAAd;QACA,MAAMyoD,KAAK,GAAG1rD,IAAI,CAACi+B,KAAL,CAAWh7B,CAAC,CAAC,CAAD,CAAZ,EAAiBA,CAAC,CAAC,CAAD,CAAlB,CAAd;QACA,KAAK88C,0BAAL,GAAkC//C,IAAI,CAAC2D,GAAL,CAAS8nD,KAAT,EAAgBC,KAAhB,IAAyBF,MAA3D;MACD;IACF;;IACD,OAAO,KAAKzL,0BAAZ;EACD;;EACD4L,mBAAmB,GAAG;IACpB,IAAI,KAAK7L,uBAAL,CAA6B,CAA7B,MAAoC,CAAC,CAAzC,EAA4C;MAC1C,MAAM;QACJhF;MADI,IAEF,KAAKjO,OAFT;MAGA,MAAM;QACJ9oC,CADI;QAEJtB,CAFI;QAGJuB,CAHI;QAIJxa;MAJI,IAKF,KAAKkuB,GAAL,CAASE,YAAT,EALJ;MAMA,IAAIu2B,MAAJ,EAAYC,MAAZ;;MACA,IAAI3rC,CAAC,KAAK,CAAN,IAAWuB,CAAC,KAAK,CAArB,EAAwB;QACtB,MAAMynD,KAAK,GAAGzrD,IAAI,CAAC+F,GAAL,CAAShC,CAAT,CAAd;QACA,MAAM2nD,KAAK,GAAG1rD,IAAI,CAAC+F,GAAL,CAASvc,CAAT,CAAd;;QACA,IAAIiiE,KAAK,KAAKC,KAAd,EAAqB;UACnB,IAAI5Q,SAAS,KAAK,CAAlB,EAAqB;YACnB3M,MAAM,GAAGC,MAAM,GAAG,IAAIqd,KAAtB;UACD,CAFD,MAEO;YACL,MAAMG,eAAe,GAAGH,KAAK,GAAG3Q,SAAhC;YACA3M,MAAM,GAAGC,MAAM,GAAGwd,eAAe,GAAG,CAAlB,GAAsB,IAAIA,eAA1B,GAA4C,CAA9D;UACD;QACF,CAPD,MAOO,IAAI9Q,SAAS,KAAK,CAAlB,EAAqB;UAC1B3M,MAAM,GAAG,IAAIsd,KAAb;UACArd,MAAM,GAAG,IAAIsd,KAAb;QACD,CAHM,MAGA;UACL,MAAMG,gBAAgB,GAAGJ,KAAK,GAAG3Q,SAAjC;UACA,MAAMgR,gBAAgB,GAAGJ,KAAK,GAAG5Q,SAAjC;UACA3M,MAAM,GAAG0d,gBAAgB,GAAG,CAAnB,GAAuB,IAAIA,gBAA3B,GAA8C,CAAvD;UACAzd,MAAM,GAAG0d,gBAAgB,GAAG,CAAnB,GAAuB,IAAIA,gBAA3B,GAA8C,CAAvD;QACD;MACF,CAnBD,MAmBO;QACL,MAAMN,MAAM,GAAGxrD,IAAI,CAAC+F,GAAL,CAAShC,CAAC,GAAGva,CAAJ,GAAQiZ,CAAC,GAAGuB,CAArB,CAAf;QACA,MAAMynD,KAAK,GAAGzrD,IAAI,CAACi+B,KAAL,CAAWl6B,CAAX,EAActB,CAAd,CAAd;QACA,MAAMipD,KAAK,GAAG1rD,IAAI,CAACi+B,KAAL,CAAWj6B,CAAX,EAAcxa,CAAd,CAAd;;QACA,IAAIsxD,SAAS,KAAK,CAAlB,EAAqB;UACnB3M,MAAM,GAAGud,KAAK,GAAGF,MAAjB;UACApd,MAAM,GAAGqd,KAAK,GAAGD,MAAjB;QACD,CAHD,MAGO;UACL,MAAMO,QAAQ,GAAGjR,SAAS,GAAG0Q,MAA7B;UACArd,MAAM,GAAGud,KAAK,GAAGK,QAAR,GAAmBL,KAAK,GAAGK,QAA3B,GAAsC,CAA/C;UACA3d,MAAM,GAAGqd,KAAK,GAAGM,QAAR,GAAmBN,KAAK,GAAGM,QAA3B,GAAsC,CAA/C;QACD;MACF;;MACD,KAAKjM,uBAAL,CAA6B,CAA7B,IAAkC3R,MAAlC;MACA,KAAK2R,uBAAL,CAA6B,CAA7B,IAAkC1R,MAAlC;IACD;;IACD,OAAO,KAAK0R,uBAAZ;EACD;;EACD2F,gBAAgB,CAACuG,WAAD,EAAc;IAC5B,MAAM;MACJt0C;IADI,IAEF,IAFJ;IAGA,MAAM;MACJojC;IADI,IAEF,KAAKjO,OAFT;IAGA,MAAM,CAACsB,MAAD,EAASC,MAAT,IAAmB,KAAKud,mBAAL,EAAzB;IACAj0C,GAAG,CAACojC,SAAJ,GAAgBA,SAAS,IAAI,CAA7B;;IACA,IAAI3M,MAAM,KAAK,CAAX,IAAgBC,MAAM,KAAK,CAA/B,EAAkC;MAChC12B,GAAG,CAACzf,MAAJ;MACA;IACD;;IACD,MAAMg0D,MAAM,GAAGv0C,GAAG,CAAC2lC,WAAJ,EAAf;;IACA,IAAI2O,WAAJ,EAAiB;MACft0C,GAAG,CAACngB,IAAJ;IACD;;IACDmgB,GAAG,CAACxE,KAAJ,CAAUi7B,MAAV,EAAkBC,MAAlB;;IACA,IAAI6d,MAAM,CAAC/tD,MAAP,GAAgB,CAApB,EAAuB;MACrB,MAAMgV,KAAK,GAAGlT,IAAI,CAAC2D,GAAL,CAASwqC,MAAT,EAAiBC,MAAjB,CAAd;MACA12B,GAAG,CAAC0lC,WAAJ,CAAgB6O,MAAM,CAACnrD,GAAP,CAAW8E,CAAC,IAAIA,CAAC,GAAGsN,KAApB,CAAhB;MACAwE,GAAG,CAAC4lC,cAAJ,IAAsBpqC,KAAtB;IACD;;IACDwE,GAAG,CAACzf,MAAJ;;IACA,IAAI+zD,WAAJ,EAAiB;MACft0C,GAAG,CAAClgB,OAAJ;IACD;EACF;;EACD+zD,gBAAgB,GAAG;IACjB,KAAK,IAAIzrD,CAAC,GAAG,KAAK6+C,kBAAL,CAAwBzgD,MAAxB,GAAiC,CAA9C,EAAiD4B,CAAC,IAAI,CAAtD,EAAyDA,CAAC,EAA1D,EAA8D;MAC5D,IAAI,CAAC,KAAK6+C,kBAAL,CAAwB7+C,CAAxB,EAA2BkvB,OAAhC,EAAyC;QACvC,OAAO,KAAP;MACD;IACF;;IACD,OAAO,IAAP;EACD;;AA7jDkB;;AA+jDrB,KAAK,MAAMk9B,EAAX,IAAiBvgE,GAAjB,EAAsB;EACpB,IAAI4yD,cAAc,CAACp0D,SAAf,CAAyB+hE,EAAzB,MAAiC1sD,SAArC,EAAgD;IAC9C++C,cAAc,CAACp0D,SAAf,CAAyBwB,GAAG,CAACugE,EAAD,CAA5B,IAAoC3N,cAAc,CAACp0D,SAAf,CAAyB+hE,EAAzB,CAApC;EACD;AACF;;AAED,C,CAAC;;AACD,MAAM5gE,mBAAN,CAA0B;EACxB,OAAO,CAAC6gE,IAAR,GAAe,IAAf;EACA,OAAO,CAACzvC,GAAR,GAAc,EAAd;;EACqB,WAAV0vC,UAAU,GAAG;IACtB,OAAO,KAAK,CAACD,IAAb;EACD;;EACoB,WAAVC,UAAU,CAACtoB,GAAD,EAAM;IACzB,IAAI,EAAE,OAAOuoB,MAAP,KAAkB,WAAlB,IAAiCvoB,GAAG,YAAYuoB,MAAlD,KAA6DvoB,GAAG,KAAK,IAAzE,EAA+E;MAC7E,MAAM,IAAIxmC,KAAJ,CAAU,4BAAV,CAAN;IACD;;IACD,KAAK,CAAC6uD,IAAN,GAAaroB,GAAb;EACD;;EACmB,WAATwoB,SAAS,GAAG;IACrB,OAAO,KAAK,CAAC5vC,GAAb;EACD;;EACmB,WAAT4vC,SAAS,CAACxoB,GAAD,EAAM;IACxB,IAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;MAC3B,MAAM,IAAIxmC,KAAJ,CAAU,2BAAV,CAAN;IACD;;IACD,KAAK,CAACof,GAAN,GAAYonB,GAAZ;EACD;;AApBuB;;AAuB1B,C,CAAC;;AAED,MAAMyoB,YAAY,GAAG;EACnBC,OAAO,EAAE,CADU;EAEnBC,IAAI,EAAE,CAFa;EAGnBC,KAAK,EAAE;AAHY,CAArB;AAKA,MAAMC,UAAU,GAAG;EACjBH,OAAO,EAAE,CADQ;EAEjBI,MAAM,EAAE,CAFS;EAGjBC,eAAe,EAAE,CAHA;EAIjBC,KAAK,EAAE,CAJU;EAKjBC,OAAO,EAAE,CALQ;EAMjBL,KAAK,EAAE,CANU;EAOjBM,IAAI,EAAE,CAPW;EAQjBC,aAAa,EAAE,CARE;EASjBC,cAAc,EAAE;AATC,CAAnB;;AAWA,SAASC,UAAT,CAAoB5hD,MAApB,EAA4B;EAC1B,IAAI,EAAEA,MAAM,YAAYjO,KAAlB,IAA2B,OAAOiO,MAAP,KAAkB,QAAlB,IAA8BA,MAAM,KAAK,IAAtE,CAAJ,EAAiF;IAC/ElO,WAAW,CAAC,gEAAD,CAAX;EACD;;EACD,QAAQkO,MAAM,CAACzM,IAAf;IACE,KAAK,gBAAL;MACE,OAAO,IAAIrU,cAAJ,CAAmB8gB,MAAM,CAAC1M,OAA1B,CAAP;;IACF,KAAK,qBAAL;MACE,OAAO,IAAInT,mBAAJ,CAAwB6f,MAAM,CAAC1M,OAA/B,CAAP;;IACF,KAAK,mBAAL;MACE,OAAO,IAAIG,iBAAJ,CAAsBuM,MAAM,CAAC1M,OAA7B,EAAsC0M,MAAM,CAACtM,IAA7C,CAAP;;IACF,KAAK,6BAAL;MACE,OAAO,IAAI7S,2BAAJ,CAAgCmf,MAAM,CAAC1M,OAAvC,EAAgD0M,MAAM,CAACnM,MAAvD,CAAP;;IACF,KAAK,uBAAL;MACE,OAAO,IAAIF,qBAAJ,CAA0BqM,MAAM,CAAC1M,OAAjC,EAA0C0M,MAAM,CAACpM,OAAjD,CAAP;;IACF;MACE,OAAO,IAAID,qBAAJ,CAA0BqM,MAAM,CAAC1M,OAAjC,EAA0C0M,MAAM,CAACnJ,QAAP,EAA1C,CAAP;EAZJ;AAcD;;AACD,MAAMgrD,cAAN,CAAqB;EACnBruD,WAAW,CAACsuD,UAAD,EAAaC,UAAb,EAAyBC,MAAzB,EAAiC;IAC1C,KAAKF,UAAL,GAAkBA,UAAlB;IACA,KAAKC,UAAL,GAAkBA,UAAlB;IACA,KAAKC,MAAL,GAAcA,MAAd;IACA,KAAKC,UAAL,GAAkB,CAAlB;IACA,KAAKC,QAAL,GAAgB,CAAhB;IACA,KAAKC,WAAL,GAAmB7jE,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAnB;IACA,KAAK4sD,iBAAL,GAAyB9jE,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAzB;IACA,KAAK6sD,oBAAL,GAA4B/jE,MAAM,CAACkX,MAAP,CAAc,IAAd,CAA5B;IACA,KAAK8sD,aAAL,GAAqBhkE,MAAM,CAACkX,MAAP,CAAc,IAAd,CAArB;;IACA,KAAK+sD,kBAAL,GAA0BhuC,KAAK,IAAI;MACjC,MAAMlN,IAAI,GAAGkN,KAAK,CAAClN,IAAnB;;MACA,IAAIA,IAAI,CAAC06C,UAAL,KAAoB,KAAKD,UAA7B,EAAyC;QACvC;MACD;;MACD,IAAIz6C,IAAI,CAACm7C,MAAT,EAAiB;QACf,KAAK,CAACC,oBAAN,CAA2Bp7C,IAA3B;QACA;MACD;;MACD,IAAIA,IAAI,CAAC8M,QAAT,EAAmB;QACjB,MAAM8tC,UAAU,GAAG56C,IAAI,CAAC46C,UAAxB;QACA,MAAMS,UAAU,GAAG,KAAKL,oBAAL,CAA0BJ,UAA1B,CAAnB;;QACA,IAAI,CAACS,UAAL,EAAiB;UACf,MAAM,IAAI3wD,KAAJ,CAAW,2BAA0BkwD,UAAW,EAAhD,CAAN;QACD;;QACD,OAAO,KAAKI,oBAAL,CAA0BJ,UAA1B,CAAP;;QACA,IAAI56C,IAAI,CAAC8M,QAAL,KAAkB6sC,YAAY,CAACE,IAAnC,EAAyC;UACvCwB,UAAU,CAACl8C,OAAX,CAAmBa,IAAI,CAACA,IAAxB;QACD,CAFD,MAEO,IAAIA,IAAI,CAAC8M,QAAL,KAAkB6sC,YAAY,CAACG,KAAnC,EAA0C;UAC/CuB,UAAU,CAACj8C,MAAX,CAAkBm7C,UAAU,CAACv6C,IAAI,CAACrH,MAAN,CAA5B;QACD,CAFM,MAEA;UACL,MAAM,IAAIjO,KAAJ,CAAU,0BAAV,CAAN;QACD;;QACD;MACD;;MACD,MAAMwxB,MAAM,GAAG,KAAK++B,aAAL,CAAmBj7C,IAAI,CAACkc,MAAxB,CAAf;;MACA,IAAI,CAACA,MAAL,EAAa;QACX,MAAM,IAAIxxB,KAAJ,CAAW,+BAA8BsV,IAAI,CAACkc,MAAO,EAArD,CAAN;MACD;;MACD,IAAIlc,IAAI,CAAC46C,UAAT,EAAqB;QACnB,MAAMU,YAAY,GAAG,KAAKb,UAA1B;QACA,MAAMc,YAAY,GAAGv7C,IAAI,CAACy6C,UAA1B;QACA,IAAIv7C,OAAJ,CAAY,UAAUC,OAAV,EAAmB;UAC7BA,OAAO,CAAC+c,MAAM,CAAClc,IAAI,CAACA,IAAN,CAAP,CAAP;QACD,CAFD,EAEGD,IAFH,CAEQ,UAAU+K,MAAV,EAAkB;UACxB6vC,MAAM,CAACa,WAAP,CAAmB;YACjBf,UAAU,EAAEa,YADK;YAEjBZ,UAAU,EAAEa,YAFK;YAGjBzuC,QAAQ,EAAE6sC,YAAY,CAACE,IAHN;YAIjBe,UAAU,EAAE56C,IAAI,CAAC46C,UAJA;YAKjB56C,IAAI,EAAE8K;UALW,CAAnB;QAOD,CAVD,EAUG,UAAUnS,MAAV,EAAkB;UACnBgiD,MAAM,CAACa,WAAP,CAAmB;YACjBf,UAAU,EAAEa,YADK;YAEjBZ,UAAU,EAAEa,YAFK;YAGjBzuC,QAAQ,EAAE6sC,YAAY,CAACG,KAHN;YAIjBc,UAAU,EAAE56C,IAAI,CAAC46C,UAJA;YAKjBjiD,MAAM,EAAE4hD,UAAU,CAAC5hD,MAAD;UALD,CAAnB;QAOD,CAlBD;QAmBA;MACD;;MACD,IAAIqH,IAAI,CAAC66C,QAAT,EAAmB;QACjB,KAAK,CAACY,gBAAN,CAAuBz7C,IAAvB;QACA;MACD;;MACDkc,MAAM,CAAClc,IAAI,CAACA,IAAN,CAAN;IACD,CA1DD;;IA2DA26C,MAAM,CAAC9zC,gBAAP,CAAwB,SAAxB,EAAmC,KAAKq0C,kBAAxC;EACD;;EACDrmC,EAAE,CAAC6mC,UAAD,EAAaC,OAAb,EAAsB;IACtB,MAAMC,EAAE,GAAG,KAAKX,aAAhB;;IACA,IAAIW,EAAE,CAACF,UAAD,CAAN,EAAoB;MAClB,MAAM,IAAIhxD,KAAJ,CAAW,0CAAyCgxD,UAAW,GAA/D,CAAN;IACD;;IACDE,EAAE,CAACF,UAAD,CAAF,GAAiBC,OAAjB;EACD;;EACD97C,IAAI,CAAC67C,UAAD,EAAa17C,IAAb,EAAmB67C,SAAnB,EAA8B;IAChC,KAAKlB,MAAL,CAAYa,WAAZ,CAAwB;MACtBf,UAAU,EAAE,KAAKA,UADK;MAEtBC,UAAU,EAAE,KAAKA,UAFK;MAGtBx+B,MAAM,EAAEw/B,UAHc;MAItB17C;IAJsB,CAAxB,EAKG67C,SALH;EAMD;;EACDC,eAAe,CAACJ,UAAD,EAAa17C,IAAb,EAAmB67C,SAAnB,EAA8B;IAC3C,MAAMjB,UAAU,GAAG,KAAKA,UAAL,EAAnB;IACA,MAAMS,UAAU,GAAGn8C,OAAO,CAACm4B,aAAR,EAAnB;IACA,KAAK2jB,oBAAL,CAA0BJ,UAA1B,IAAwCS,UAAxC;;IACA,IAAI;MACF,KAAKV,MAAL,CAAYa,WAAZ,CAAwB;QACtBf,UAAU,EAAE,KAAKA,UADK;QAEtBC,UAAU,EAAE,KAAKA,UAFK;QAGtBx+B,MAAM,EAAEw/B,UAHc;QAItBd,UAJsB;QAKtB56C;MALsB,CAAxB,EAMG67C,SANH;IAOD,CARD,CAQE,OAAO5nD,EAAP,EAAW;MACXonD,UAAU,CAACj8C,MAAX,CAAkBnL,EAAlB;IACD;;IACD,OAAOonD,UAAU,CAACtxC,OAAlB;EACD;;EACDgyC,cAAc,CAACL,UAAD,EAAa17C,IAAb,EAAmBg8C,gBAAnB,EAAqCH,SAArC,EAAgD;IAC5D,MAAMhB,QAAQ,GAAG,KAAKA,QAAL,EAAjB;IAAA,MACEJ,UAAU,GAAG,KAAKA,UADpB;IAAA,MAEEC,UAAU,GAAG,KAAKA,UAFpB;IAAA,MAGEC,MAAM,GAAG,KAAKA,MAHhB;IAIA,OAAO,IAAIsB,cAAJ,CAAmB;MACxB3/C,KAAK,EAAE4/C,UAAU,IAAI;QACnB,MAAMC,eAAe,GAAGj9C,OAAO,CAACm4B,aAAR,EAAxB;QACA,KAAK0jB,iBAAL,CAAuBF,QAAvB,IAAmC;UACjCqB,UADiC;UAEjCE,SAAS,EAAED,eAFsB;UAGjCE,QAAQ,EAAE,IAHuB;UAIjCC,UAAU,EAAE,IAJqB;UAKjCC,QAAQ,EAAE;QALuB,CAAnC;QAOA5B,MAAM,CAACa,WAAP,CAAmB;UACjBf,UADiB;UAEjBC,UAFiB;UAGjBx+B,MAAM,EAAEw/B,UAHS;UAIjBb,QAJiB;UAKjB76C,IALiB;UAMjBw8C,WAAW,EAAEN,UAAU,CAACM;QANP,CAAnB,EAOGX,SAPH;QAQA,OAAOM,eAAe,CAACpyC,OAAvB;MACD,CAnBuB;MAoBxB0yC,IAAI,EAAEP,UAAU,IAAI;QAClB,MAAMQ,cAAc,GAAGx9C,OAAO,CAACm4B,aAAR,EAAvB;QACA,KAAK0jB,iBAAL,CAAuBF,QAAvB,EAAiCwB,QAAjC,GAA4CK,cAA5C;QACA/B,MAAM,CAACa,WAAP,CAAmB;UACjBf,UADiB;UAEjBC,UAFiB;UAGjBS,MAAM,EAAEpB,UAAU,CAACK,IAHF;UAIjBS,QAJiB;UAKjB2B,WAAW,EAAEN,UAAU,CAACM;QALP,CAAnB;QAOA,OAAOE,cAAc,CAAC3yC,OAAtB;MACD,CA/BuB;MAgCxBuY,MAAM,EAAE3pB,MAAM,IAAI;QAChBhO,MAAM,CAACgO,MAAM,YAAYjO,KAAnB,EAA0B,iCAA1B,CAAN;QACA,MAAMiyD,gBAAgB,GAAGz9C,OAAO,CAACm4B,aAAR,EAAzB;QACA,KAAK0jB,iBAAL,CAAuBF,QAAvB,EAAiCyB,UAAjC,GAA8CK,gBAA9C;QACA,KAAK5B,iBAAL,CAAuBF,QAAvB,EAAiC0B,QAAjC,GAA4C,IAA5C;QACA5B,MAAM,CAACa,WAAP,CAAmB;UACjBf,UADiB;UAEjBC,UAFiB;UAGjBS,MAAM,EAAEpB,UAAU,CAACC,MAHF;UAIjBa,QAJiB;UAKjBliD,MAAM,EAAE4hD,UAAU,CAAC5hD,MAAD;QALD,CAAnB;QAOA,OAAOgkD,gBAAgB,CAAC5yC,OAAxB;MACD;IA7CuB,CAAnB,EA8CJiyC,gBA9CI,CAAP;EA+CD;;EACD,CAACP,gBAAgB,CAACz7C,IAAD,EAAO;IACtB,MAAM66C,QAAQ,GAAG76C,IAAI,CAAC66C,QAAtB;IAAA,MACEJ,UAAU,GAAG,KAAKA,UADpB;IAAA,MAEEC,UAAU,GAAG16C,IAAI,CAACy6C,UAFpB;IAAA,MAGEE,MAAM,GAAG,KAAKA,MAHhB;IAIA,MAAMptC,IAAI,GAAG,IAAb;IAAA,MACE2O,MAAM,GAAG,KAAK++B,aAAL,CAAmBj7C,IAAI,CAACkc,MAAxB,CADX;IAEA,MAAM0gC,UAAU,GAAG;MACjBC,OAAO,CAACvvD,KAAD,EAAQoQ,IAAI,GAAG,CAAf,EAAkBm+C,SAAlB,EAA6B;QAClC,IAAI,KAAKiB,WAAT,EAAsB;UACpB;QACD;;QACD,MAAMC,eAAe,GAAG,KAAKP,WAA7B;QACA,KAAKA,WAAL,IAAoB9+C,IAApB;;QACA,IAAIq/C,eAAe,GAAG,CAAlB,IAAuB,KAAKP,WAAL,IAAoB,CAA/C,EAAkD;UAChD,KAAKQ,cAAL,GAAsB99C,OAAO,CAACm4B,aAAR,EAAtB;UACA,KAAK4lB,KAAL,GAAa,KAAKD,cAAL,CAAoBjzC,OAAjC;QACD;;QACD4wC,MAAM,CAACa,WAAP,CAAmB;UACjBf,UADiB;UAEjBC,UAFiB;UAGjBS,MAAM,EAAEpB,UAAU,CAACI,OAHF;UAIjBU,QAJiB;UAKjBvtD;QALiB,CAAnB,EAMGuuD,SANH;MAOD,CAlBgB;;MAmBjBqB,KAAK,GAAG;QACN,IAAI,KAAKJ,WAAT,EAAsB;UACpB;QACD;;QACD,KAAKA,WAAL,GAAmB,IAAnB;QACAnC,MAAM,CAACa,WAAP,CAAmB;UACjBf,UADiB;UAEjBC,UAFiB;UAGjBS,MAAM,EAAEpB,UAAU,CAACG,KAHF;UAIjBW;QAJiB,CAAnB;QAMA,OAAOttC,IAAI,CAACutC,WAAL,CAAiBD,QAAjB,CAAP;MACD,CA/BgB;;MAgCjB3vC,KAAK,CAACvS,MAAD,EAAS;QACZhO,MAAM,CAACgO,MAAM,YAAYjO,KAAnB,EAA0B,gCAA1B,CAAN;;QACA,IAAI,KAAKoyD,WAAT,EAAsB;UACpB;QACD;;QACD,KAAKA,WAAL,GAAmB,IAAnB;QACAnC,MAAM,CAACa,WAAP,CAAmB;UACjBf,UADiB;UAEjBC,UAFiB;UAGjBS,MAAM,EAAEpB,UAAU,CAACD,KAHF;UAIjBe,QAJiB;UAKjBliD,MAAM,EAAE4hD,UAAU,CAAC5hD,MAAD;QALD,CAAnB;MAOD,CA7CgB;;MA8CjBqkD,cAAc,EAAE99C,OAAO,CAACm4B,aAAR,EA9CC;MA+CjB8lB,MAAM,EAAE,IA/CS;MAgDjBC,QAAQ,EAAE,IAhDO;MAiDjBN,WAAW,EAAE,KAjDI;MAkDjBN,WAAW,EAAEx8C,IAAI,CAACw8C,WAlDD;MAmDjBS,KAAK,EAAE;IAnDU,CAAnB;IAqDAL,UAAU,CAACI,cAAX,CAA0B79C,OAA1B;IACAy9C,UAAU,CAACK,KAAX,GAAmBL,UAAU,CAACI,cAAX,CAA0BjzC,OAA7C;IACA,KAAK+wC,WAAL,CAAiBD,QAAjB,IAA6B+B,UAA7B;IACA,IAAI19C,OAAJ,CAAY,UAAUC,OAAV,EAAmB;MAC7BA,OAAO,CAAC+c,MAAM,CAAClc,IAAI,CAACA,IAAN,EAAY48C,UAAZ,CAAP,CAAP;IACD,CAFD,EAEG78C,IAFH,CAEQ,YAAY;MAClB46C,MAAM,CAACa,WAAP,CAAmB;QACjBf,UADiB;QAEjBC,UAFiB;QAGjBS,MAAM,EAAEpB,UAAU,CAACO,cAHF;QAIjBO,QAJiB;QAKjBwC,OAAO,EAAE;MALQ,CAAnB;IAOD,CAVD,EAUG,UAAU1kD,MAAV,EAAkB;MACnBgiD,MAAM,CAACa,WAAP,CAAmB;QACjBf,UADiB;QAEjBC,UAFiB;QAGjBS,MAAM,EAAEpB,UAAU,CAACO,cAHF;QAIjBO,QAJiB;QAKjBliD,MAAM,EAAE4hD,UAAU,CAAC5hD,MAAD;MALD,CAAnB;IAOD,CAlBD;EAmBD;;EACD,CAACyiD,oBAAoB,CAACp7C,IAAD,EAAO;IAC1B,MAAM66C,QAAQ,GAAG76C,IAAI,CAAC66C,QAAtB;IAAA,MACEJ,UAAU,GAAG,KAAKA,UADpB;IAAA,MAEEC,UAAU,GAAG16C,IAAI,CAACy6C,UAFpB;IAAA,MAGEE,MAAM,GAAG,KAAKA,MAHhB;IAIA,MAAM2C,gBAAgB,GAAG,KAAKvC,iBAAL,CAAuBF,QAAvB,CAAzB;IAAA,MACE+B,UAAU,GAAG,KAAK9B,WAAL,CAAiBD,QAAjB,CADf;;IAEA,QAAQ76C,IAAI,CAACm7C,MAAb;MACE,KAAKpB,UAAU,CAACO,cAAhB;QACE,IAAIt6C,IAAI,CAACq9C,OAAT,EAAkB;UAChBC,gBAAgB,CAAClB,SAAjB,CAA2Bj9C,OAA3B;QACD,CAFD,MAEO;UACLm+C,gBAAgB,CAAClB,SAAjB,CAA2Bh9C,MAA3B,CAAkCm7C,UAAU,CAACv6C,IAAI,CAACrH,MAAN,CAA5C;QACD;;QACD;;MACF,KAAKohD,UAAU,CAACM,aAAhB;QACE,IAAIr6C,IAAI,CAACq9C,OAAT,EAAkB;UAChBC,gBAAgB,CAACjB,QAAjB,CAA0Bl9C,OAA1B;QACD,CAFD,MAEO;UACLm+C,gBAAgB,CAACjB,QAAjB,CAA0Bj9C,MAA1B,CAAiCm7C,UAAU,CAACv6C,IAAI,CAACrH,MAAN,CAA3C;QACD;;QACD;;MACF,KAAKohD,UAAU,CAACK,IAAhB;QACE,IAAI,CAACwC,UAAL,EAAiB;UACfjC,MAAM,CAACa,WAAP,CAAmB;YACjBf,UADiB;YAEjBC,UAFiB;YAGjBS,MAAM,EAAEpB,UAAU,CAACM,aAHF;YAIjBQ,QAJiB;YAKjBwC,OAAO,EAAE;UALQ,CAAnB;UAOA;QACD;;QACD,IAAIT,UAAU,CAACJ,WAAX,IAA0B,CAA1B,IAA+Bx8C,IAAI,CAACw8C,WAAL,GAAmB,CAAtD,EAAyD;UACvDI,UAAU,CAACI,cAAX,CAA0B79C,OAA1B;QACD;;QACDy9C,UAAU,CAACJ,WAAX,GAAyBx8C,IAAI,CAACw8C,WAA9B;QACA,IAAIt9C,OAAJ,CAAY,UAAUC,OAAV,EAAmB;UAC7BA,OAAO,CAACy9C,UAAU,CAACO,MAAX,IAAD,CAAP;QACD,CAFD,EAEGp9C,IAFH,CAEQ,YAAY;UAClB46C,MAAM,CAACa,WAAP,CAAmB;YACjBf,UADiB;YAEjBC,UAFiB;YAGjBS,MAAM,EAAEpB,UAAU,CAACM,aAHF;YAIjBQ,QAJiB;YAKjBwC,OAAO,EAAE;UALQ,CAAnB;QAOD,CAVD,EAUG,UAAU1kD,MAAV,EAAkB;UACnBgiD,MAAM,CAACa,WAAP,CAAmB;YACjBf,UADiB;YAEjBC,UAFiB;YAGjBS,MAAM,EAAEpB,UAAU,CAACM,aAHF;YAIjBQ,QAJiB;YAKjBliD,MAAM,EAAE4hD,UAAU,CAAC5hD,MAAD;UALD,CAAnB;QAOD,CAlBD;QAmBA;;MACF,KAAKohD,UAAU,CAACI,OAAhB;QACExvD,MAAM,CAAC2yD,gBAAD,EAAmB,uCAAnB,CAAN;;QACA,IAAIA,gBAAgB,CAACf,QAArB,EAA+B;UAC7B;QACD;;QACDe,gBAAgB,CAACpB,UAAjB,CAA4BW,OAA5B,CAAoC78C,IAAI,CAAC1S,KAAzC;QACA;;MACF,KAAKysD,UAAU,CAACG,KAAhB;QACEvvD,MAAM,CAAC2yD,gBAAD,EAAmB,qCAAnB,CAAN;;QACA,IAAIA,gBAAgB,CAACf,QAArB,EAA+B;UAC7B;QACD;;QACDe,gBAAgB,CAACf,QAAjB,GAA4B,IAA5B;QACAe,gBAAgB,CAACpB,UAAjB,CAA4BgB,KAA5B;QACA,KAAK,CAACK,sBAAN,CAA6BD,gBAA7B,EAA+CzC,QAA/C;QACA;;MACF,KAAKd,UAAU,CAACD,KAAhB;QACEnvD,MAAM,CAAC2yD,gBAAD,EAAmB,qCAAnB,CAAN;QACAA,gBAAgB,CAACpB,UAAjB,CAA4BhxC,KAA5B,CAAkCqvC,UAAU,CAACv6C,IAAI,CAACrH,MAAN,CAA5C;QACA,KAAK,CAAC4kD,sBAAN,CAA6BD,gBAA7B,EAA+CzC,QAA/C;QACA;;MACF,KAAKd,UAAU,CAACE,eAAhB;QACE,IAAIj6C,IAAI,CAACq9C,OAAT,EAAkB;UAChBC,gBAAgB,CAAChB,UAAjB,CAA4Bn9C,OAA5B;QACD,CAFD,MAEO;UACLm+C,gBAAgB,CAAChB,UAAjB,CAA4Bl9C,MAA5B,CAAmCm7C,UAAU,CAACv6C,IAAI,CAACrH,MAAN,CAA7C;QACD;;QACD,KAAK,CAAC4kD,sBAAN,CAA6BD,gBAA7B,EAA+CzC,QAA/C;QACA;;MACF,KAAKd,UAAU,CAACC,MAAhB;QACE,IAAI,CAAC4C,UAAL,EAAiB;UACf;QACD;;QACD,IAAI19C,OAAJ,CAAY,UAAUC,OAAV,EAAmB;UAC7BA,OAAO,CAACy9C,UAAU,CAACQ,QAAX,GAAsB7C,UAAU,CAACv6C,IAAI,CAACrH,MAAN,CAAhC,CAAD,CAAP;QACD,CAFD,EAEGoH,IAFH,CAEQ,YAAY;UAClB46C,MAAM,CAACa,WAAP,CAAmB;YACjBf,UADiB;YAEjBC,UAFiB;YAGjBS,MAAM,EAAEpB,UAAU,CAACE,eAHF;YAIjBY,QAJiB;YAKjBwC,OAAO,EAAE;UALQ,CAAnB;QAOD,CAVD,EAUG,UAAU1kD,MAAV,EAAkB;UACnBgiD,MAAM,CAACa,WAAP,CAAmB;YACjBf,UADiB;YAEjBC,UAFiB;YAGjBS,MAAM,EAAEpB,UAAU,CAACE,eAHF;YAIjBY,QAJiB;YAKjBliD,MAAM,EAAE4hD,UAAU,CAAC5hD,MAAD;UALD,CAAnB;QAOD,CAlBD;QAmBAikD,UAAU,CAACI,cAAX,CAA0B59C,MAA1B,CAAiCm7C,UAAU,CAACv6C,IAAI,CAACrH,MAAN,CAA3C;QACAikD,UAAU,CAACE,WAAX,GAAyB,IAAzB;QACA,OAAO,KAAKhC,WAAL,CAAiBD,QAAjB,CAAP;QACA;;MACF;QACE,MAAM,IAAInwD,KAAJ,CAAU,wBAAV,CAAN;IA3GJ;EA6GD;;EACK,CAAC6yD,sBAAsB,CAACD,gBAAD,EAAmBzC,QAAnB,EAA6B;IAAA;;IAAA;MACxD,MAAM37C,OAAO,CAACs+C,UAAR,CAAmB,CAACF,gBAAgB,CAAClB,SAAjB,EAA4BryC,OAA7B,EAAsCuzC,gBAAgB,CAACjB,QAAjB,EAA2BtyC,OAAjE,EAA0EuzC,gBAAgB,CAAChB,UAAjB,EAA6BvyC,OAAvG,CAAnB,CAAN;MACA,OAAO,OAAI,CAACgxC,iBAAL,CAAuBF,QAAvB,CAAP;IAFwD;EAGzD;;EACDrjD,OAAO,GAAG;IACR,KAAKmjD,MAAL,CAAY8C,mBAAZ,CAAgC,SAAhC,EAA2C,KAAKvC,kBAAhD;EACD;;AA3WkB;;AA8WrB,C,CAAC;;AAED,MAAMwC,QAAN,CAAe;EACb,CAACC,WAAD;EACA,CAAC39C,IAAD;;EACA7T,WAAW,CAAC;IACVyxD,UADU;IAEV1zC;EAFU,CAAD,EAGR;IACD,KAAK,CAACyzC,WAAN,GAAoBC,UAApB;IACA,KAAK,CAAC59C,IAAN,GAAakK,OAAb;EACD;;EACD2zC,MAAM,GAAG;IACP,OAAO,KAAK,CAAC79C,IAAb;EACD;;EACD5oB,GAAG,CAAC8U,IAAD,EAAO;IACR,OAAO,KAAK,CAACyxD,WAAN,CAAkBvmE,GAAlB,CAAsB8U,IAAtB,KAA+B,IAAtC;EACD;;EACDklC,MAAM,GAAG;IACP,OAAOnjC,aAAa,CAAC,KAAK,CAAC0vD,WAAP,CAApB;EACD;;EACDnwC,GAAG,CAACthB,IAAD,EAAO;IACR,OAAO,KAAK,CAACyxD,WAAN,CAAkBnwC,GAAlB,CAAsBthB,IAAtB,CAAP;EACD;;AArBY;;AAwBf,C,CAAC;;AAGD,MAAM4xD,QAAQ,GAAGC,MAAM,CAAC,UAAD,CAAvB;;AACA,MAAMC,oBAAN,CAA2B;EACzB,CAACC,SAAD,GAAa,KAAb;EACA,CAACC,OAAD,GAAW,KAAX;EACA,CAACC,OAAD,GAAW,KAAX;EACA,CAAC/hC,OAAD,GAAW,IAAX;;EACAjwB,WAAW,CAACiyD,eAAD,EAAkB;IAC3BlyD,IAD2B;IAE3BskD,MAF2B;IAG3B6N;EAH2B,CAAlB,EAIR;IACD,KAAK,CAACJ,SAAN,GAAkB,CAAC,EAAEG,eAAe,GAAG9iE,mBAAmB,CAACE,OAAxC,CAAnB;IACA,KAAK,CAAC0iE,OAAN,GAAgB,CAAC,EAAEE,eAAe,GAAG9iE,mBAAmB,CAACG,KAAxC,CAAjB;IACA,KAAKyQ,IAAL,GAAYA,IAAZ;IACA,KAAKskD,MAAL,GAAcA,MAAd;IACA,KAAK6N,KAAL,GAAaA,KAAb;EACD;;EACU,IAAPjiC,OAAO,GAAG;IACZ,IAAI,KAAK,CAAC+hC,OAAV,EAAmB;MACjB,OAAO,KAAK,CAAC/hC,OAAb;IACD;;IACD,IAAI,CAAC,KAAK,CAACA,OAAX,EAAoB;MAClB,OAAO,KAAP;IACD;;IACD,MAAM;MACJkV,KADI;MAEJgtB;IAFI,IAGF,KAAKD,KAHT;;IAIA,IAAI,KAAK,CAACJ,SAAV,EAAqB;MACnB,OAAOK,IAAI,EAAEC,SAAN,KAAoB,KAA3B;IACD,CAFD,MAEO,IAAI,KAAK,CAACL,OAAV,EAAmB;MACxB,OAAO5sB,KAAK,EAAEktB,UAAP,KAAsB,KAA7B;IACD;;IACD,OAAO,IAAP;EACD;;EACDC,WAAW,CAACC,QAAD,EAAWtiC,OAAX,EAAoB+hC,OAAO,GAAG,KAA9B,EAAqC;IAC9C,IAAIO,QAAQ,KAAKZ,QAAjB,EAA2B;MACzBrzD,WAAW,CAAC,uCAAD,CAAX;IACD;;IACD,KAAK,CAAC0zD,OAAN,GAAgBA,OAAhB;IACA,KAAK,CAAC/hC,OAAN,GAAgBA,OAAhB;EACD;;AAxCwB;;AA0C3B,MAAMuiC,qBAAN,CAA4B;EAC1B,CAACC,aAAD,GAAiB,IAAjB;EACA,CAACC,MAAD,GAAU,IAAIrpD,GAAJ,EAAV;EACA,CAACspD,WAAD,GAAe,IAAf;EACA,CAACC,KAAD,GAAS,IAAT;;EACA5yD,WAAW,CAAC6T,IAAD,EAAOo+C,eAAe,GAAG9iE,mBAAmB,CAACE,OAA7C,EAAsD;IAC/D,KAAK4iE,eAAL,GAAuBA,eAAvB;IACA,KAAKlyD,IAAL,GAAY,IAAZ;IACA,KAAK8yD,OAAL,GAAe,IAAf;;IACA,IAAIh/C,IAAI,KAAK,IAAb,EAAmB;MACjB;IACD;;IACD,KAAK9T,IAAL,GAAY8T,IAAI,CAAC9T,IAAjB;IACA,KAAK8yD,OAAL,GAAeh/C,IAAI,CAACg/C,OAApB;IACA,KAAK,CAACD,KAAN,GAAc/+C,IAAI,CAAC++C,KAAnB;;IACA,KAAK,MAAM9H,KAAX,IAAoBj3C,IAAI,CAAC6+C,MAAzB,EAAiC;MAC/B,KAAK,CAACA,MAAN,CAAaljD,GAAb,CAAiBs7C,KAAK,CAACp9C,EAAvB,EAA2B,IAAImkD,oBAAJ,CAAyBI,eAAzB,EAA0CnH,KAA1C,CAA3B;IACD;;IACD,IAAIj3C,IAAI,CAACi/C,SAAL,KAAmB,KAAvB,EAA8B;MAC5B,KAAK,MAAMhI,KAAX,IAAoB,KAAK,CAAC4H,MAAN,CAAalrC,MAAb,EAApB,EAA2C;QACzCsjC,KAAK,CAACwH,WAAN,CAAkBX,QAAlB,EAA4B,KAA5B;MACD;IACF;;IACD,KAAK,MAAMjpC,EAAX,IAAiB7U,IAAI,CAAC6U,EAAtB,EAA0B;MACxB,KAAK,CAACgqC,MAAN,CAAaznE,GAAb,CAAiBy9B,EAAjB,EAAqB4pC,WAArB,CAAiCX,QAAjC,EAA2C,IAA3C;IACD;;IACD,KAAK,MAAMoB,GAAX,IAAkBl/C,IAAI,CAACk/C,GAAvB,EAA4B;MAC1B,KAAK,CAACL,MAAN,CAAaznE,GAAb,CAAiB8nE,GAAjB,EAAsBT,WAAtB,CAAkCX,QAAlC,EAA4C,KAA5C;IACD;;IACD,KAAK,CAACgB,WAAN,GAAoB,KAAKK,OAAL,EAApB;EACD;;EACD,CAACC,4BAA4B,CAACC,KAAD,EAAQ;IACnC,MAAM/zD,MAAM,GAAG+zD,KAAK,CAAC/zD,MAArB;;IACA,IAAIA,MAAM,GAAG,CAAb,EAAgB;MACd,OAAO,IAAP;IACD;;IACD,MAAMg0D,QAAQ,GAAGD,KAAK,CAAC,CAAD,CAAtB;;IACA,KAAK,IAAInyD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5B,MAApB,EAA4B4B,CAAC,EAA7B,EAAiC;MAC/B,MAAMsa,OAAO,GAAG63C,KAAK,CAACnyD,CAAD,CAArB;MACA,IAAIovB,KAAJ;;MACA,IAAIjtB,KAAK,CAACyqB,OAAN,CAActS,OAAd,CAAJ,EAA4B;QAC1B8U,KAAK,GAAG,KAAK,CAAC8iC,4BAAN,CAAmC53C,OAAnC,CAAR;MACD,CAFD,MAEO,IAAI,KAAK,CAACq3C,MAAN,CAAarxC,GAAb,CAAiBhG,OAAjB,CAAJ,EAA+B;QACpC8U,KAAK,GAAG,KAAK,CAACuiC,MAAN,CAAaznE,GAAb,CAAiBowB,OAAjB,EAA0B4U,OAAlC;MACD,CAFM,MAEA;QACL5xB,IAAI,CAAE,qCAAoCgd,OAAQ,EAA9C,CAAJ;QACA,OAAO,IAAP;MACD;;MACD,QAAQ83C,QAAR;QACE,KAAK,KAAL;UACE,IAAI,CAAChjC,KAAL,EAAY;YACV,OAAO,KAAP;UACD;;UACD;;QACF,KAAK,IAAL;UACE,IAAIA,KAAJ,EAAW;YACT,OAAO,IAAP;UACD;;UACD;;QACF,KAAK,KAAL;UACE,OAAO,CAACA,KAAR;;QACF;UACE,OAAO,IAAP;MAdJ;IAgBD;;IACD,OAAOgjC,QAAQ,KAAK,KAApB;EACD;;EACD5G,SAAS,CAACzB,KAAD,EAAQ;IACf,IAAI,KAAK,CAAC4H,MAAN,CAAanhD,IAAb,KAAsB,CAA1B,EAA6B;MAC3B,OAAO,IAAP;IACD;;IACD,IAAI,CAACu5C,KAAL,EAAY;MACV7sD,IAAI,CAAC,qCAAD,CAAJ;MACA,OAAO,IAAP;IACD;;IACD,IAAI6sD,KAAK,CAACl8D,IAAN,KAAe,KAAnB,EAA0B;MACxB,IAAI,CAAC,KAAK,CAAC8jE,MAAN,CAAarxC,GAAb,CAAiBypC,KAAK,CAACp9C,EAAvB,CAAL,EAAiC;QAC/BrP,IAAI,CAAE,qCAAoCysD,KAAK,CAACp9C,EAAG,EAA/C,CAAJ;QACA,OAAO,IAAP;MACD;;MACD,OAAO,KAAK,CAACglD,MAAN,CAAaznE,GAAb,CAAiB6/D,KAAK,CAACp9C,EAAvB,EAA2BuiB,OAAlC;IACD,CAND,MAMO,IAAI66B,KAAK,CAACl8D,IAAN,KAAe,MAAnB,EAA2B;MAChC,IAAIk8D,KAAK,CAACsI,UAAV,EAAsB;QACpB,OAAO,KAAK,CAACH,4BAAN,CAAmCnI,KAAK,CAACsI,UAAzC,CAAP;MACD;;MACD,IAAI,CAACtI,KAAK,CAACuI,MAAP,IAAiBvI,KAAK,CAACuI,MAAN,KAAiB,OAAtC,EAA+C;QAC7C,KAAK,MAAM3lD,EAAX,IAAiBo9C,KAAK,CAAChlB,GAAvB,EAA4B;UAC1B,IAAI,CAAC,KAAK,CAAC4sB,MAAN,CAAarxC,GAAb,CAAiB3T,EAAjB,CAAL,EAA2B;YACzBrP,IAAI,CAAE,qCAAoCqP,EAAG,EAAzC,CAAJ;YACA,OAAO,IAAP;UACD;;UACD,IAAI,KAAK,CAACglD,MAAN,CAAaznE,GAAb,CAAiByiB,EAAjB,EAAqBuiB,OAAzB,EAAkC;YAChC,OAAO,IAAP;UACD;QACF;;QACD,OAAO,KAAP;MACD,CAXD,MAWO,IAAI66B,KAAK,CAACuI,MAAN,KAAiB,OAArB,EAA8B;QACnC,KAAK,MAAM3lD,EAAX,IAAiBo9C,KAAK,CAAChlB,GAAvB,EAA4B;UAC1B,IAAI,CAAC,KAAK,CAAC4sB,MAAN,CAAarxC,GAAb,CAAiB3T,EAAjB,CAAL,EAA2B;YACzBrP,IAAI,CAAE,qCAAoCqP,EAAG,EAAzC,CAAJ;YACA,OAAO,IAAP;UACD;;UACD,IAAI,CAAC,KAAK,CAACglD,MAAN,CAAaznE,GAAb,CAAiByiB,EAAjB,EAAqBuiB,OAA1B,EAAmC;YACjC,OAAO,KAAP;UACD;QACF;;QACD,OAAO,IAAP;MACD,CAXM,MAWA,IAAI66B,KAAK,CAACuI,MAAN,KAAiB,QAArB,EAA+B;QACpC,KAAK,MAAM3lD,EAAX,IAAiBo9C,KAAK,CAAChlB,GAAvB,EAA4B;UAC1B,IAAI,CAAC,KAAK,CAAC4sB,MAAN,CAAarxC,GAAb,CAAiB3T,EAAjB,CAAL,EAA2B;YACzBrP,IAAI,CAAE,qCAAoCqP,EAAG,EAAzC,CAAJ;YACA,OAAO,IAAP;UACD;;UACD,IAAI,CAAC,KAAK,CAACglD,MAAN,CAAaznE,GAAb,CAAiByiB,EAAjB,EAAqBuiB,OAA1B,EAAmC;YACjC,OAAO,IAAP;UACD;QACF;;QACD,OAAO,KAAP;MACD,CAXM,MAWA,IAAI66B,KAAK,CAACuI,MAAN,KAAiB,QAArB,EAA+B;QACpC,KAAK,MAAM3lD,EAAX,IAAiBo9C,KAAK,CAAChlB,GAAvB,EAA4B;UAC1B,IAAI,CAAC,KAAK,CAAC4sB,MAAN,CAAarxC,GAAb,CAAiB3T,EAAjB,CAAL,EAA2B;YACzBrP,IAAI,CAAE,qCAAoCqP,EAAG,EAAzC,CAAJ;YACA,OAAO,IAAP;UACD;;UACD,IAAI,KAAK,CAACglD,MAAN,CAAaznE,GAAb,CAAiByiB,EAAjB,EAAqBuiB,OAAzB,EAAkC;YAChC,OAAO,KAAP;UACD;QACF;;QACD,OAAO,IAAP;MACD;;MACD5xB,IAAI,CAAE,mCAAkCysD,KAAK,CAACuI,MAAO,GAAjD,CAAJ;MACA,OAAO,IAAP;IACD;;IACDh1D,IAAI,CAAE,sBAAqBysD,KAAK,CAACl8D,IAAK,GAAlC,CAAJ;IACA,OAAO,IAAP;EACD;;EACD0kE,aAAa,CAAC5lD,EAAD,EAAKuiB,OAAO,GAAG,IAAf,EAAqB;IAChC,MAAM66B,KAAK,GAAG,KAAK,CAAC4H,MAAN,CAAaznE,GAAb,CAAiByiB,EAAjB,CAAd;;IACA,IAAI,CAACo9C,KAAL,EAAY;MACVzsD,IAAI,CAAE,qCAAoCqP,EAAG,EAAzC,CAAJ;MACA;IACD;;IACDo9C,KAAK,CAACwH,WAAN,CAAkBX,QAAlB,EAA4B,CAAC,CAAC1hC,OAA9B,EAAuC,IAAvC;;IACA,KAAK,CAACwiC,aAAN,GAAsB,IAAtB;EACD;;EACDc,WAAW,CAAC;IACVpjC,KADU;IAEVqjC;EAFU,CAAD,EAGR;IACD,IAAIL,QAAJ;;IACA,KAAK,MAAM1d,IAAX,IAAmBtlB,KAAnB,EAA0B;MACxB,QAAQslB,IAAR;QACE,KAAK,IAAL;QACA,KAAK,KAAL;QACA,KAAK,QAAL;UACE0d,QAAQ,GAAG1d,IAAX;UACA;MALJ;;MAOA,MAAMqV,KAAK,GAAG,KAAK,CAAC4H,MAAN,CAAaznE,GAAb,CAAiBwqD,IAAjB,CAAd;;MACA,IAAI,CAACqV,KAAL,EAAY;QACV;MACD;;MACD,QAAQqI,QAAR;QACE,KAAK,IAAL;UACErI,KAAK,CAACwH,WAAN,CAAkBX,QAAlB,EAA4B,IAA5B;;UACA;;QACF,KAAK,KAAL;UACE7G,KAAK,CAACwH,WAAN,CAAkBX,QAAlB,EAA4B,KAA5B;;UACA;;QACF,KAAK,QAAL;UACE7G,KAAK,CAACwH,WAAN,CAAkBX,QAAlB,EAA4B,CAAC7G,KAAK,CAAC76B,OAAnC;;UACA;MATJ;IAWD;;IACD,KAAK,CAACwiC,aAAN,GAAsB,IAAtB;EACD;;EACuB,IAApBgB,oBAAoB,GAAG;IACzB,OAAO,KAAK,CAACd,WAAN,KAAsB,IAAtB,IAA8B,KAAKK,OAAL,OAAmB,KAAK,CAACL,WAA9D;EACD;;EACDe,QAAQ,GAAG;IACT,IAAI,CAAC,KAAK,CAAChB,MAAN,CAAanhD,IAAlB,EAAwB;MACtB,OAAO,IAAP;IACD;;IACD,IAAI,KAAK,CAACqhD,KAAV,EAAiB;MACf,OAAO,KAAK,CAACA,KAAN,CAAYnuD,KAAZ,EAAP;IACD;;IACD,OAAO,CAAC,GAAG,KAAK,CAACiuD,MAAN,CAAa7wD,IAAb,EAAJ,CAAP;EACD;;EACD8xD,SAAS,GAAG;IACV,OAAO,KAAK,CAACjB,MAAN,CAAanhD,IAAb,GAAoB,CAApB,GAAwBzP,aAAa,CAAC,KAAK,CAAC4wD,MAAP,CAArC,GAAsD,IAA7D;EACD;;EACDkB,QAAQ,CAAClmD,EAAD,EAAK;IACX,OAAO,KAAK,CAACglD,MAAN,CAAaznE,GAAb,CAAiByiB,EAAjB,KAAwB,IAA/B;EACD;;EACDslD,OAAO,GAAG;IACR,IAAI,KAAK,CAACP,aAAN,KAAwB,IAA5B,EAAkC;MAChC,OAAO,KAAK,CAACA,aAAb;IACD;;IACD,MAAMvuB,IAAI,GAAG,IAAIlB,cAAJ,EAAb;;IACA,KAAK,MAAM,CAACt1B,EAAD,EAAKo9C,KAAL,CAAX,IAA0B,KAAK,CAAC4H,MAAhC,EAAwC;MACtCxuB,IAAI,CAACd,MAAL,CAAa,GAAE11B,EAAG,IAAGo9C,KAAK,CAAC76B,OAAQ,EAAnC;IACD;;IACD,OAAO,KAAK,CAACwiC,aAAN,GAAsBvuB,IAAI,CAACF,SAAL,EAA7B;EACD;;AA3MyB;;AA8M5B,C,CAAC;;AAGD,MAAM6vB,sBAAN,CAA6B;EAC3B7zD,WAAW,CAAC8zD,qBAAD,EAAwB;IACjCC,YAAY,GAAG,KADkB;IAEjCC,aAAa,GAAG;EAFiB,CAAxB,EAGR;IACDx1D,MAAM,CAACs1D,qBAAD,EAAwB,6EAAxB,CAAN;IACA,MAAM;MACJ30D,MADI;MAEJ80D,WAFI;MAGJC,eAHI;MAIJC;IAJI,IAKFL,qBALJ;IAMA,KAAKM,aAAL,GAAqB,EAArB;IACA,KAAKC,gBAAL,GAAwBH,eAAxB;IACA,KAAKI,2BAAL,GAAmCH,0BAAnC;;IACA,IAAIF,WAAW,EAAE90D,MAAb,GAAsB,CAA1B,EAA6B;MAC3B,MAAMkD,MAAM,GAAG4xD,WAAW,YAAYxyD,UAAvB,IAAqCwyD,WAAW,CAAC3wB,UAAZ,KAA2B2wB,WAAW,CAAC5xD,MAAZ,CAAmBihC,UAAnF,GAAgG2wB,WAAW,CAAC5xD,MAA5G,GAAqH,IAAIZ,UAAJ,CAAewyD,WAAf,EAA4B5xD,MAAhK;;MACA,KAAK+xD,aAAL,CAAmB/yD,IAAnB,CAAwBgB,MAAxB;IACD;;IACD,KAAKkyD,sBAAL,GAA8BT,qBAA9B;IACA,KAAKU,qBAAL,GAA6B,CAACR,aAA9B;IACA,KAAKS,iBAAL,GAAyB,CAACV,YAA1B;IACA,KAAKW,cAAL,GAAsBv1D,MAAtB;IACA,KAAKw1D,kBAAL,GAA0B,IAA1B;IACA,KAAKC,aAAL,GAAqB,EAArB;IACAd,qBAAqB,CAACe,gBAAtB,CAAuC,CAACC,KAAD,EAAQ3zD,KAAR,KAAkB;MACvD,KAAK4zD,cAAL,CAAoB;QAClBD,KADkB;QAElB3zD;MAFkB,CAApB;IAID,CALD;IAMA2yD,qBAAqB,CAACkB,mBAAtB,CAA0C,CAACltB,MAAD,EAASmtB,KAAT,KAAmB;MAC3D,KAAKC,WAAL,CAAiB;QACfptB,MADe;QAEfmtB;MAFe,CAAjB;IAID,CALD;IAMAnB,qBAAqB,CAACqB,0BAAtB,CAAiDh0D,KAAK,IAAI;MACxD,KAAK4zD,cAAL,CAAoB;QAClB5zD;MADkB,CAApB;IAGD,CAJD;IAKA2yD,qBAAqB,CAACsB,0BAAtB,CAAiD,MAAM;MACrD,KAAKC,kBAAL;IACD,CAFD;IAGAvB,qBAAqB,CAACwB,cAAtB;EACD;;EACDP,cAAc,CAAC;IACbD,KADa;IAEb3zD;EAFa,CAAD,EAGX;IACD,MAAMkB,MAAM,GAAGlB,KAAK,YAAYM,UAAjB,IAA+BN,KAAK,CAACmiC,UAAN,KAAqBniC,KAAK,CAACkB,MAAN,CAAaihC,UAAjE,GAA8EniC,KAAK,CAACkB,MAApF,GAA6F,IAAIZ,UAAJ,CAAeN,KAAf,EAAsBkB,MAAlI;;IACA,IAAIyyD,KAAK,KAAKr0D,SAAd,EAAyB;MACvB,IAAI,KAAKk0D,kBAAT,EAA6B;QAC3B,KAAKA,kBAAL,CAAwBY,QAAxB,CAAiClzD,MAAjC;MACD,CAFD,MAEO;QACL,KAAK+xD,aAAL,CAAmB/yD,IAAnB,CAAwBgB,MAAxB;MACD;IACF,CAND,MAMO;MACL,MAAMmzD,KAAK,GAAG,KAAKZ,aAAL,CAAmBvmC,IAAnB,CAAwB,UAAUonC,WAAV,EAAuB;QAC3D,IAAIA,WAAW,CAACC,MAAZ,KAAuBZ,KAA3B,EAAkC;UAChC,OAAO,KAAP;QACD;;QACDW,WAAW,CAACF,QAAZ,CAAqBlzD,MAArB;;QACA,OAAO,IAAP;MACD,CANa,CAAd;;MAOA7D,MAAM,CAACg3D,KAAD,EAAQ,yEAAR,CAAN;IACD;EACF;;EACyB,IAAtBG,sBAAsB,GAAG;IAC3B,OAAO,KAAKhB,kBAAL,EAAyBiB,OAAzB,IAAoC,CAA3C;EACD;;EACDV,WAAW,CAACpuC,GAAD,EAAM;IACf,IAAIA,GAAG,CAACmuC,KAAJ,KAAcx0D,SAAlB,EAA6B;MAC3B,KAAKm0D,aAAL,CAAmB,CAAnB,GAAuBiB,UAAvB,GAAoC;QAClC/tB,MAAM,EAAEhhB,GAAG,CAACghB;MADsB,CAApC;IAGD,CAJD,MAIO;MACL,KAAK6sB,kBAAL,EAAyBkB,UAAzB,GAAsC;QACpC/tB,MAAM,EAAEhhB,GAAG,CAACghB,MADwB;QAEpCmtB,KAAK,EAAEnuC,GAAG,CAACmuC;MAFyB,CAAtC;IAID;EACF;;EACDI,kBAAkB,GAAG;IACnB,KAAKV,kBAAL,EAAyBT,eAAzB;IACA,KAAKG,gBAAL,GAAwB,IAAxB;EACD;;EACDyB,kBAAkB,CAACC,MAAD,EAAS;IACzB,MAAMh1D,CAAC,GAAG,KAAK6zD,aAAL,CAAmBoB,OAAnB,CAA2BD,MAA3B,CAAV;;IACA,IAAIh1D,CAAC,IAAI,CAAT,EAAY;MACV,KAAK6zD,aAAL,CAAmBz0C,MAAnB,CAA0Bpf,CAA1B,EAA6B,CAA7B;IACD;EACF;;EACDk1D,aAAa,GAAG;IACdz3D,MAAM,CAAC,CAAC,KAAKm2D,kBAAP,EAA2B,+DAA3B,CAAN;IACA,MAAMuB,YAAY,GAAG,KAAK9B,aAA1B;IACA,KAAKA,aAAL,GAAqB,IAArB;IACA,OAAO,IAAI+B,4BAAJ,CAAiC,IAAjC,EAAuCD,YAAvC,EAAqD,KAAK7B,gBAA1D,EAA4E,KAAKC,2BAAjF,CAAP;EACD;;EACD8B,cAAc,CAACtB,KAAD,EAAQ1kD,GAAR,EAAa;IACzB,IAAIA,GAAG,IAAI,KAAKulD,sBAAhB,EAAwC;MACtC,OAAO,IAAP;IACD;;IACD,MAAMI,MAAM,GAAG,IAAIM,iCAAJ,CAAsC,IAAtC,EAA4CvB,KAA5C,EAAmD1kD,GAAnD,CAAf;;IACA,KAAKmkD,sBAAL,CAA4B+B,gBAA5B,CAA6CxB,KAA7C,EAAoD1kD,GAApD;;IACA,KAAKwkD,aAAL,CAAmBvzD,IAAnB,CAAwB00D,MAAxB;;IACA,OAAOA,MAAP;EACD;;EACDQ,iBAAiB,CAAC/pD,MAAD,EAAS;IACxB,KAAKmoD,kBAAL,EAAyBx+B,MAAzB,CAAgC3pB,MAAhC;;IACA,KAAK,MAAMupD,MAAX,IAAqB,KAAKnB,aAAL,CAAmBnwD,KAAnB,CAAyB,CAAzB,CAArB,EAAkD;MAChDsxD,MAAM,CAAC5/B,MAAP,CAAc3pB,MAAd;IACD;;IACD,KAAK+nD,sBAAL,CAA4BjtC,KAA5B;EACD;;AAnH0B;;AAqH7B,MAAM6uC,4BAAN,CAAmC;EACjCn2D,WAAW,CAACgvD,MAAD,EAASkH,YAAT,EAAuBhC,eAAe,GAAG,KAAzC,EAAgDC,0BAA0B,GAAG,IAA7E,EAAmF;IAC5F,KAAKqC,OAAL,GAAexH,MAAf;IACA,KAAKyH,KAAL,GAAavC,eAAe,IAAI,KAAhC;IACA,KAAKwC,SAAL,GAAiBzoE,SAAS,CAACkmE,0BAAD,CAAT,GAAwCA,0BAAxC,GAAqE,IAAtF;IACA,KAAKC,aAAL,GAAqB8B,YAAY,IAAI,EAArC;IACA,KAAKN,OAAL,GAAe,CAAf;;IACA,KAAK,MAAMz0D,KAAX,IAAoB,KAAKizD,aAAzB,EAAwC;MACtC,KAAKwB,OAAL,IAAgBz0D,KAAK,CAACmiC,UAAtB;IACD;;IACD,KAAKqzB,SAAL,GAAiB,EAAjB;IACA,KAAKC,aAAL,GAAqB7jD,OAAO,CAACC,OAAR,EAArB;IACAg8C,MAAM,CAAC2F,kBAAP,GAA4B,IAA5B;IACA,KAAKkB,UAAL,GAAkB,IAAlB;EACD;;EACDN,QAAQ,CAACp0D,KAAD,EAAQ;IACd,IAAI,KAAKs1D,KAAT,EAAgB;MACd;IACD;;IACD,IAAI,KAAKE,SAAL,CAAex3D,MAAf,GAAwB,CAA5B,EAA+B;MAC7B,MAAM03D,iBAAiB,GAAG,KAAKF,SAAL,CAAejuB,KAAf,EAA1B;;MACAmuB,iBAAiB,CAAC7jD,OAAlB,CAA0B;QACxBxT,KAAK,EAAE2B,KADiB;QAExBqnC,IAAI,EAAE;MAFkB,CAA1B;IAID,CAND,MAMO;MACL,KAAK4rB,aAAL,CAAmB/yD,IAAnB,CAAwBF,KAAxB;IACD;;IACD,KAAKy0D,OAAL,IAAgBz0D,KAAK,CAACmiC,UAAtB;EACD;;EACe,IAAZwzB,YAAY,GAAG;IACjB,OAAO,KAAKF,aAAZ;EACD;;EACW,IAARlqD,QAAQ,GAAG;IACb,OAAO,KAAKgqD,SAAZ;EACD;;EACmB,IAAhBK,gBAAgB,GAAG;IACrB,OAAO,KAAKP,OAAL,CAAa/B,iBAApB;EACD;;EACuB,IAApBuC,oBAAoB,GAAG;IACzB,OAAO,KAAKR,OAAL,CAAahC,qBAApB;EACD;;EACgB,IAAbyC,aAAa,GAAG;IAClB,OAAO,KAAKT,OAAL,CAAa9B,cAApB;EACD;;EACKwC,IAAI,GAAG;IAAA;;IAAA;MACX,IAAI,OAAI,CAAC9C,aAAL,CAAmBj1D,MAAnB,GAA4B,CAAhC,EAAmC;QACjC,MAAMgC,KAAK,GAAG,OAAI,CAACizD,aAAL,CAAmB1rB,KAAnB,EAAd;;QACA,OAAO;UACLlpC,KAAK,EAAE2B,KADF;UAELqnC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,IAAI,OAAI,CAACiuB,KAAT,EAAgB;QACd,OAAO;UACLj3D,KAAK,EAAEiB,SADF;UAEL+nC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,MAAMquB,iBAAiB,GAAG9jD,OAAO,CAACm4B,aAAR,EAA1B;;MACA,OAAI,CAACyrB,SAAL,CAAet1D,IAAf,CAAoBw1D,iBAApB;;MACA,OAAOA,iBAAiB,CAACj5C,OAAzB;IAhBW;EAiBZ;;EACDuY,MAAM,CAAC3pB,MAAD,EAAS;IACb,KAAKiqD,KAAL,GAAa,IAAb;;IACA,KAAK,MAAMI,iBAAX,IAAgC,KAAKF,SAArC,EAAgD;MAC9CE,iBAAiB,CAAC7jD,OAAlB,CAA0B;QACxBxT,KAAK,EAAEiB,SADiB;QAExB+nC,IAAI,EAAE;MAFkB,CAA1B;IAID;;IACD,KAAKmuB,SAAL,CAAex3D,MAAf,GAAwB,CAAxB;EACD;;EACD+0D,eAAe,GAAG;IAChB,IAAI,KAAKuC,KAAT,EAAgB;MACd;IACD;;IACD,KAAKA,KAAL,GAAa,IAAb;EACD;;AA9EgC;;AAgFnC,MAAMJ,iCAAN,CAAwC;EACtCr2D,WAAW,CAACgvD,MAAD,EAAS8F,KAAT,EAAgB1kD,GAAhB,EAAqB;IAC9B,KAAKomD,OAAL,GAAexH,MAAf;IACA,KAAK0G,MAAL,GAAcZ,KAAd;IACA,KAAKqC,IAAL,GAAY/mD,GAAZ;IACA,KAAKgnD,YAAL,GAAoB,IAApB;IACA,KAAKT,SAAL,GAAiB,EAAjB;IACA,KAAKF,KAAL,GAAa,KAAb;IACA,KAAKZ,UAAL,GAAkB,IAAlB;EACD;;EACDN,QAAQ,CAACp0D,KAAD,EAAQ;IACd,IAAI,KAAKs1D,KAAT,EAAgB;MACd;IACD;;IACD,IAAI,KAAKE,SAAL,CAAex3D,MAAf,KAA0B,CAA9B,EAAiC;MAC/B,KAAKi4D,YAAL,GAAoBj2D,KAApB;IACD,CAFD,MAEO;MACL,MAAMk2D,kBAAkB,GAAG,KAAKV,SAAL,CAAejuB,KAAf,EAA3B;;MACA2uB,kBAAkB,CAACrkD,OAAnB,CAA2B;QACzBxT,KAAK,EAAE2B,KADkB;QAEzBqnC,IAAI,EAAE;MAFmB,CAA3B;;MAIA,KAAK,MAAMquB,iBAAX,IAAgC,KAAKF,SAArC,EAAgD;QAC9CE,iBAAiB,CAAC7jD,OAAlB,CAA0B;UACxBxT,KAAK,EAAEiB,SADiB;UAExB+nC,IAAI,EAAE;QAFkB,CAA1B;MAID;;MACD,KAAKmuB,SAAL,CAAex3D,MAAf,GAAwB,CAAxB;IACD;;IACD,KAAKs3D,KAAL,GAAa,IAAb;;IACA,KAAKD,OAAL,CAAaV,kBAAb,CAAgC,IAAhC;EACD;;EACuB,IAApBkB,oBAAoB,GAAG;IACzB,OAAO,KAAP;EACD;;EACKE,IAAI,GAAG;IAAA;;IAAA;MACX,IAAI,OAAI,CAACE,YAAT,EAAuB;QACrB,MAAMj2D,KAAK,GAAG,OAAI,CAACi2D,YAAnB;QACA,OAAI,CAACA,YAAL,GAAoB,IAApB;QACA,OAAO;UACL53D,KAAK,EAAE2B,KADF;UAELqnC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,IAAI,OAAI,CAACiuB,KAAT,EAAgB;QACd,OAAO;UACLj3D,KAAK,EAAEiB,SADF;UAEL+nC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,MAAMquB,iBAAiB,GAAG9jD,OAAO,CAACm4B,aAAR,EAA1B;;MACA,OAAI,CAACyrB,SAAL,CAAet1D,IAAf,CAAoBw1D,iBAApB;;MACA,OAAOA,iBAAiB,CAACj5C,OAAzB;IAjBW;EAkBZ;;EACDuY,MAAM,CAAC3pB,MAAD,EAAS;IACb,KAAKiqD,KAAL,GAAa,IAAb;;IACA,KAAK,MAAMI,iBAAX,IAAgC,KAAKF,SAArC,EAAgD;MAC9CE,iBAAiB,CAAC7jD,OAAlB,CAA0B;QACxBxT,KAAK,EAAEiB,SADiB;QAExB+nC,IAAI,EAAE;MAFkB,CAA1B;IAID;;IACD,KAAKmuB,SAAL,CAAex3D,MAAf,GAAwB,CAAxB;;IACA,KAAKq3D,OAAL,CAAaV,kBAAb,CAAgC,IAAhC;EACD;;AAjEqC;;AAoExC,C,CAAC;;AAED,SAASwB,uCAAT,CAAiDC,kBAAjD,EAAqE;EACnE,IAAIC,kBAAkB,GAAG,IAAzB;EACA,IAAIroB,GAAG,GAAGsoB,aAAa,CAAC,aAAD,EAAgB,GAAhB,CAAb,CAAkCphD,IAAlC,CAAuCkhD,kBAAvC,CAAV;;EACA,IAAIpoB,GAAJ,EAAS;IACPA,GAAG,GAAGA,GAAG,CAAC,CAAD,CAAT;IACA,IAAIziC,QAAQ,GAAGgrD,cAAc,CAACvoB,GAAD,CAA7B;IACAziC,QAAQ,GAAGrE,QAAQ,CAACqE,QAAD,CAAnB;IACAA,QAAQ,GAAGirD,aAAa,CAACjrD,QAAD,CAAxB;IACAA,QAAQ,GAAGkrD,aAAa,CAAClrD,QAAD,CAAxB;IACA,OAAOmrD,aAAa,CAACnrD,QAAD,CAApB;EACD;;EACDyiC,GAAG,GAAG2oB,eAAe,CAACP,kBAAD,CAArB;;EACA,IAAIpoB,GAAJ,EAAS;IACP,MAAMziC,QAAQ,GAAGkrD,aAAa,CAACzoB,GAAD,CAA9B;IACA,OAAO0oB,aAAa,CAACnrD,QAAD,CAApB;EACD;;EACDyiC,GAAG,GAAGsoB,aAAa,CAAC,UAAD,EAAa,GAAb,CAAb,CAA+BphD,IAA/B,CAAoCkhD,kBAApC,CAAN;;EACA,IAAIpoB,GAAJ,EAAS;IACPA,GAAG,GAAGA,GAAG,CAAC,CAAD,CAAT;IACA,IAAIziC,QAAQ,GAAGgrD,cAAc,CAACvoB,GAAD,CAA7B;IACAziC,QAAQ,GAAGkrD,aAAa,CAAClrD,QAAD,CAAxB;IACA,OAAOmrD,aAAa,CAACnrD,QAAD,CAApB;EACD;;EACD,SAAS+qD,aAAT,CAAuBM,gBAAvB,EAAyCC,KAAzC,EAAgD;IAC9C,OAAO,IAAI1gD,MAAJ,CAAW,gBAAgBygD,gBAAhB,GAAmC,WAAnC,GAAiD,GAAjD,GAAuD,kBAAvD,GAA4E,GAA5E,GAAkF,yBAAlF,GAA8G,GAAzH,EAA8HC,KAA9H,CAAP;EACD;;EACD,SAASC,UAAT,CAAoB1wD,QAApB,EAA8B/H,KAA9B,EAAqC;IACnC,IAAI+H,QAAJ,EAAc;MACZ,IAAI,CAAC,iBAAiBwO,IAAjB,CAAsBvW,KAAtB,CAAL,EAAmC;QACjC,OAAOA,KAAP;MACD;;MACD,IAAI;QACF,MAAMgI,OAAO,GAAG,IAAIC,WAAJ,CAAgBF,QAAhB,EAA0B;UACxCG,KAAK,EAAE;QADiC,CAA1B,CAAhB;QAGA,MAAMrF,MAAM,GAAGd,aAAa,CAAC/B,KAAD,CAA5B;QACAA,KAAK,GAAGgI,OAAO,CAACI,MAAR,CAAevF,MAAf,CAAR;QACAm1D,kBAAkB,GAAG,KAArB;MACD,CAPD,CAOE,MAAM,CAAE;IACX;;IACD,OAAOh4D,KAAP;EACD;;EACD,SAASq4D,aAAT,CAAuBr4D,KAAvB,EAA8B;IAC5B,IAAIg4D,kBAAkB,IAAI,cAAczhD,IAAd,CAAmBvW,KAAnB,CAA1B,EAAqD;MACnDA,KAAK,GAAGy4D,UAAU,CAAC,OAAD,EAAUz4D,KAAV,CAAlB;;MACA,IAAIg4D,kBAAJ,EAAwB;QACtBh4D,KAAK,GAAGy4D,UAAU,CAAC,YAAD,EAAez4D,KAAf,CAAlB;MACD;IACF;;IACD,OAAOA,KAAP;EACD;;EACD,SAASs4D,eAAT,CAAyBI,qBAAzB,EAAgD;IAC9C,MAAM3gD,OAAO,GAAG,EAAhB;IACA,IAAIrY,KAAJ;IACA,MAAMi5D,IAAI,GAAGV,aAAa,CAAC,iCAAD,EAAoC,IAApC,CAA1B;;IACA,OAAO,CAACv4D,KAAK,GAAGi5D,IAAI,CAAC9hD,IAAL,CAAU6hD,qBAAV,CAAT,MAA+C,IAAtD,EAA4D;MAC1D,IAAI,GAAG90D,CAAH,EAAMg1D,IAAN,EAAYC,IAAZ,IAAoBn5D,KAAxB;MACAkE,CAAC,GAAGqU,QAAQ,CAACrU,CAAD,EAAI,EAAJ,CAAZ;;MACA,IAAIA,CAAC,IAAImU,OAAT,EAAkB;QAChB,IAAInU,CAAC,KAAK,CAAV,EAAa;UACX;QACD;;QACD;MACD;;MACDmU,OAAO,CAACnU,CAAD,CAAP,GAAa,CAACg1D,IAAD,EAAOC,IAAP,CAAb;IACD;;IACD,MAAMC,KAAK,GAAG,EAAd;;IACA,KAAK,IAAIl1D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmU,OAAO,CAACpY,MAA5B,EAAoC,EAAEiE,CAAtC,EAAyC;MACvC,IAAI,EAAEA,CAAC,IAAImU,OAAP,CAAJ,EAAqB;QACnB;MACD;;MACD,IAAI,CAAC6gD,IAAD,EAAOC,IAAP,IAAe9gD,OAAO,CAACnU,CAAD,CAA1B;MACAi1D,IAAI,GAAGX,cAAc,CAACW,IAAD,CAArB;;MACA,IAAID,IAAJ,EAAU;QACRC,IAAI,GAAGhwD,QAAQ,CAACgwD,IAAD,CAAf;;QACA,IAAIj1D,CAAC,KAAK,CAAV,EAAa;UACXi1D,IAAI,GAAGV,aAAa,CAACU,IAAD,CAApB;QACD;MACF;;MACDC,KAAK,CAACj3D,IAAN,CAAWg3D,IAAX;IACD;;IACD,OAAOC,KAAK,CAACh3D,IAAN,CAAW,EAAX,CAAP;EACD;;EACD,SAASo2D,cAAT,CAAwBl4D,KAAxB,EAA+B;IAC7B,IAAIA,KAAK,CAACR,UAAN,CAAiB,GAAjB,CAAJ,EAA2B;MACzB,MAAMs5D,KAAK,GAAG94D,KAAK,CAACiF,KAAN,CAAY,CAAZ,EAAe2K,KAAf,CAAqB,KAArB,CAAd;;MACA,KAAK,IAAIrO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGu3D,KAAK,CAACn5D,MAA1B,EAAkC,EAAE4B,CAApC,EAAuC;QACrC,MAAMw3D,SAAS,GAAGD,KAAK,CAACv3D,CAAD,CAAL,CAASi1D,OAAT,CAAiB,GAAjB,CAAlB;;QACA,IAAIuC,SAAS,KAAK,CAAC,CAAnB,EAAsB;UACpBD,KAAK,CAACv3D,CAAD,CAAL,GAAWu3D,KAAK,CAACv3D,CAAD,CAAL,CAAS0D,KAAT,CAAe,CAAf,EAAkB8zD,SAAlB,CAAX;UACAD,KAAK,CAACn5D,MAAN,GAAe4B,CAAC,GAAG,CAAnB;QACD;;QACDu3D,KAAK,CAACv3D,CAAD,CAAL,GAAWu3D,KAAK,CAACv3D,CAAD,CAAL,CAAS8G,UAAT,CAAoB,QAApB,EAA8B,IAA9B,CAAX;MACD;;MACDrI,KAAK,GAAG84D,KAAK,CAACh3D,IAAN,CAAW,GAAX,CAAR;IACD;;IACD,OAAO9B,KAAP;EACD;;EACD,SAASm4D,aAAT,CAAuBa,QAAvB,EAAiC;IAC/B,MAAMC,WAAW,GAAGD,QAAQ,CAACxC,OAAT,CAAiB,GAAjB,CAApB;;IACA,IAAIyC,WAAW,KAAK,CAAC,CAArB,EAAwB;MACtB,OAAOD,QAAP;IACD;;IACD,MAAMjxD,QAAQ,GAAGixD,QAAQ,CAAC/zD,KAAT,CAAe,CAAf,EAAkBg0D,WAAlB,CAAjB;IACA,MAAMC,SAAS,GAAGF,QAAQ,CAAC/zD,KAAT,CAAeg0D,WAAW,GAAG,CAA7B,CAAlB;IACA,MAAMj5D,KAAK,GAAGk5D,SAAS,CAACC,OAAV,CAAkB,SAAlB,EAA6B,EAA7B,CAAd;IACA,OAAOV,UAAU,CAAC1wD,QAAD,EAAW/H,KAAX,CAAjB;EACD;;EACD,SAASo4D,aAAT,CAAuBp4D,KAAvB,EAA8B;IAC5B,IAAI,CAACA,KAAK,CAACR,UAAN,CAAiB,IAAjB,CAAD,IAA2B,uBAAuB+W,IAAvB,CAA4BvW,KAA5B,CAA/B,EAAmE;MACjE,OAAOA,KAAP;IACD;;IACD,OAAOA,KAAK,CAACqI,UAAN,CAAiB,gDAAjB,EAAmE,UAAU0P,OAAV,EAAmBqhD,OAAnB,EAA4BrxD,QAA5B,EAAsCuL,IAAtC,EAA4C;MACpH,IAAIvL,QAAQ,KAAK,GAAb,IAAoBA,QAAQ,KAAK,GAArC,EAA0C;QACxCuL,IAAI,GAAGA,IAAI,CAACjL,UAAL,CAAgB,GAAhB,EAAqB,GAArB,CAAP;QACAiL,IAAI,GAAGA,IAAI,CAACjL,UAAL,CAAgB,oBAAhB,EAAsC,UAAU3I,KAAV,EAAiB25D,GAAjB,EAAsB;UACjE,OAAOl4D,MAAM,CAACC,YAAP,CAAoB6W,QAAQ,CAACohD,GAAD,EAAM,EAAN,CAA5B,CAAP;QACD,CAFM,CAAP;QAGA,OAAOZ,UAAU,CAACW,OAAD,EAAU9lD,IAAV,CAAjB;MACD;;MACD,IAAI;QACFA,IAAI,GAAGg2B,IAAI,CAACh2B,IAAD,CAAX;MACD,CAFD,CAEE,MAAM,CAAE;;MACV,OAAOmlD,UAAU,CAACW,OAAD,EAAU9lD,IAAV,CAAjB;IACD,CAZM,CAAP;EAaD;;EACD,OAAO,EAAP;AACD;;AAED,C,CAAC;;AAID,SAASgmD,gCAAT,CAA0C;EACxCC,iBADwC;EAExCC,MAFwC;EAGxCC,cAHwC;EAIxClF;AAJwC,CAA1C,EAKG;EACD,MAAMmF,YAAY,GAAG;IACnBC,kBAAkB,EAAE,KADD;IAEnBC,eAAe,EAAE34D;EAFE,CAArB;EAIA,MAAMtB,MAAM,GAAGsY,QAAQ,CAACshD,iBAAiB,CAAC,gBAAD,CAAlB,EAAsC,EAAtC,CAAvB;;EACA,IAAI,CAACj7D,MAAM,CAACC,SAAP,CAAiBoB,MAAjB,CAAL,EAA+B;IAC7B,OAAO+5D,YAAP;EACD;;EACDA,YAAY,CAACE,eAAb,GAA+Bj6D,MAA/B;;EACA,IAAIA,MAAM,IAAI,IAAI85D,cAAlB,EAAkC;IAChC,OAAOC,YAAP;EACD;;EACD,IAAInF,YAAY,IAAI,CAACiF,MAArB,EAA6B;IAC3B,OAAOE,YAAP;EACD;;EACD,IAAIH,iBAAiB,CAAC,eAAD,CAAjB,KAAuC,OAA3C,EAAoD;IAClD,OAAOG,YAAP;EACD;;EACD,MAAMG,eAAe,GAAGN,iBAAiB,CAAC,kBAAD,CAAjB,IAAyC,UAAjE;;EACA,IAAIM,eAAe,KAAK,UAAxB,EAAoC;IAClC,OAAOH,YAAP;EACD;;EACDA,YAAY,CAACC,kBAAb,GAAkC,IAAlC;EACA,OAAOD,YAAP;AACD;;AACD,SAASI,yBAAT,CAAmCP,iBAAnC,EAAsD;EACpD,MAAMxB,kBAAkB,GAAGwB,iBAAiB,CAAC,qBAAD,CAA5C;;EACA,IAAIxB,kBAAJ,EAAwB;IACtB,IAAI7qD,QAAQ,GAAG4qD,uCAAuC,CAACC,kBAAD,CAAtD;;IACA,IAAI7qD,QAAQ,CAAC7J,QAAT,CAAkB,GAAlB,CAAJ,EAA4B;MAC1B,IAAI;QACF6J,QAAQ,GAAGxE,kBAAkB,CAACwE,QAAD,CAA7B;MACD,CAFD,CAEE,MAAM,CAAE;IACX;;IACD,IAAIze,SAAS,CAACye,QAAD,CAAb,EAAyB;MACvB,OAAOA,QAAP;IACD;EACF;;EACD,OAAO,IAAP;AACD;;AACD,SAAS6sD,yBAAT,CAAmCl5D,MAAnC,EAA2C1B,GAA3C,EAAgD;EAC9C,IAAI0B,MAAM,KAAK,GAAX,IAAkBA,MAAM,KAAK,CAAX,IAAgB1B,GAAG,CAACK,UAAJ,CAAe,OAAf,CAAtC,EAA+D;IAC7D,OAAO,IAAIrS,mBAAJ,CAAwB,kBAAkBgS,GAAlB,GAAwB,IAAhD,CAAP;EACD;;EACD,OAAO,IAAItR,2BAAJ,CAAiC,+BAA8BgT,MAAO,2BAA0B1B,GAAI,IAApG,EAAyG0B,MAAzG,CAAP;AACD;;AACD,SAASm5D,sBAAT,CAAgCn5D,MAAhC,EAAwC;EACtC,OAAOA,MAAM,KAAK,GAAX,IAAkBA,MAAM,KAAK,GAApC;AACD;;AAED,C,CAAC;;AAGD,SAASo5D,kBAAT,CAA4BC,OAA5B,EAAqCC,eAArC,EAAsDz3C,eAAtD,EAAuE;EACrE,OAAO;IACL03C,MAAM,EAAE,KADH;IAELF,OAFK;IAGLn/C,MAAM,EAAE2H,eAAe,CAAC3H,MAHnB;IAIL0J,IAAI,EAAE,MAJD;IAKL41C,WAAW,EAAEF,eAAe,GAAG,SAAH,GAAe,aALtC;IAMLG,QAAQ,EAAE;EANL,CAAP;AAQD;;AACD,SAASC,aAAT,CAAuBC,WAAvB,EAAoC;EAClC,MAAMN,OAAO,GAAG,IAAIO,OAAJ,EAAhB;;EACA,KAAK,MAAM7b,QAAX,IAAuB4b,WAAvB,EAAoC;IAClC,MAAMx6D,KAAK,GAAGw6D,WAAW,CAAC5b,QAAD,CAAzB;;IACA,IAAI5+C,KAAK,KAAKiB,SAAd,EAAyB;MACvB;IACD;;IACDi5D,OAAO,CAAClrD,MAAR,CAAe4vC,QAAf,EAAyB5+C,KAAzB;EACD;;EACD,OAAOk6D,OAAP;AACD;;AACD,SAASQ,cAAT,CAAwBn1B,GAAxB,EAA6B;EAC3B,IAAIA,GAAG,YAAYtjC,UAAnB,EAA+B;IAC7B,OAAOsjC,GAAG,CAAC1iC,MAAX;EACD;;EACD,IAAI0iC,GAAG,YAAYhxB,WAAnB,EAAgC;IAC9B,OAAOgxB,GAAP;EACD;;EACD1mC,IAAI,CAAE,4CAA2C0mC,GAAI,EAAjD,CAAJ;EACA,OAAO,IAAItjC,UAAJ,CAAesjC,GAAf,EAAoB1iC,MAA3B;AACD;;AACD,MAAM83D,cAAN,CAAqB;EACnBn6D,WAAW,CAAC6oB,MAAD,EAAS;IAClB,KAAKA,MAAL,GAAcA,MAAd;IACA,KAAKmwC,MAAL,GAAc,YAAYjjD,IAAZ,CAAiB8S,MAAM,CAAClqB,GAAxB,CAAd;IACA,KAAKq7D,WAAL,GAAmB,KAAKhB,MAAL,IAAenwC,MAAM,CAACmxC,WAAtB,IAAqC,EAAxD;IACA,KAAKrF,kBAAL,GAA0B,IAA1B;IACA,KAAKyF,oBAAL,GAA4B,EAA5B;EACD;;EACyB,IAAtBzE,sBAAsB,GAAG;IAC3B,OAAO,KAAKhB,kBAAL,EAAyBiB,OAAzB,IAAoC,CAA3C;EACD;;EACDK,aAAa,GAAG;IACdz3D,MAAM,CAAC,CAAC,KAAKm2D,kBAAP,EAA2B,uDAA3B,CAAN;IACA,KAAKA,kBAAL,GAA0B,IAAI0F,oBAAJ,CAAyB,IAAzB,CAA1B;IACA,OAAO,KAAK1F,kBAAZ;EACD;;EACDyB,cAAc,CAACtB,KAAD,EAAQ1kD,GAAR,EAAa;IACzB,IAAIA,GAAG,IAAI,KAAKulD,sBAAhB,EAAwC;MACtC,OAAO,IAAP;IACD;;IACD,MAAMI,MAAM,GAAG,IAAIuE,yBAAJ,CAA8B,IAA9B,EAAoCxF,KAApC,EAA2C1kD,GAA3C,CAAf;;IACA,KAAKgqD,oBAAL,CAA0B/4D,IAA1B,CAA+B00D,MAA/B;;IACA,OAAOA,MAAP;EACD;;EACDQ,iBAAiB,CAAC/pD,MAAD,EAAS;IACxB,KAAKmoD,kBAAL,EAAyBx+B,MAAzB,CAAgC3pB,MAAhC;;IACA,KAAK,MAAMupD,MAAX,IAAqB,KAAKqE,oBAAL,CAA0B31D,KAA1B,CAAgC,CAAhC,CAArB,EAAyD;MACvDsxD,MAAM,CAAC5/B,MAAP,CAAc3pB,MAAd;IACD;EACF;;AA7BkB;;AA+BrB,MAAM6tD,oBAAN,CAA2B;EACzBr6D,WAAW,CAACgvD,MAAD,EAAS;IAClB,KAAKwH,OAAL,GAAexH,MAAf;IACA,KAAKuL,OAAL,GAAe,IAAf;IACA,KAAK3E,OAAL,GAAe,CAAf;IACA,KAAKc,SAAL,GAAiB,IAAjB;IACA,MAAM7tC,MAAM,GAAGmmC,MAAM,CAACnmC,MAAtB;IACA,KAAK2xC,gBAAL,GAAwB3xC,MAAM,CAAC8wC,eAAP,IAA0B,KAAlD;IACA,KAAKjF,cAAL,GAAsB7rC,MAAM,CAAC1pB,MAA7B;IACA,KAAKs7D,kBAAL,GAA0B1nD,OAAO,CAACm4B,aAAR,EAA1B;IACA,KAAKwvB,aAAL,GAAqB7xC,MAAM,CAACkrC,YAAP,IAAuB,KAA5C;IACA,KAAK4G,eAAL,GAAuB9xC,MAAM,CAACowC,cAA9B;;IACA,IAAI,CAAC,KAAK0B,eAAN,IAAyB,CAAC,KAAKD,aAAnC,EAAkD;MAChD,KAAKA,aAAL,GAAqB,IAArB;IACD;;IACD,KAAKE,gBAAL,GAAwB,IAAIz4C,eAAJ,EAAxB;IACA,KAAKqyC,qBAAL,GAA6B,CAAC3rC,MAAM,CAACmrC,aAArC;IACA,KAAKS,iBAAL,GAAyB,CAAC5rC,MAAM,CAACkrC,YAAjC;IACA,KAAK8G,QAAL,GAAgBd,aAAa,CAAC,KAAKvD,OAAL,CAAawD,WAAd,CAA7B;IACA,MAAMr7D,GAAG,GAAGkqB,MAAM,CAAClqB,GAAnB;IACAyN,KAAK,CAACzN,GAAD,EAAM86D,kBAAkB,CAAC,KAAKoB,QAAN,EAAgB,KAAKL,gBAArB,EAAuC,KAAKI,gBAA5C,CAAxB,CAAL,CAA4FhnD,IAA5F,CAAiGpB,QAAQ,IAAI;MAC3G,IAAI,CAACgnD,sBAAsB,CAAChnD,QAAQ,CAACnS,MAAV,CAA3B,EAA8C;QAC5C,MAAMk5D,yBAAyB,CAAC/mD,QAAQ,CAACnS,MAAV,EAAkB1B,GAAlB,CAA/B;MACD;;MACD,KAAK47D,OAAL,GAAe/nD,QAAQ,CAAC/D,IAAT,CAAcqsD,SAAd,EAAf;;MACA,KAAKL,kBAAL,CAAwBznD,OAAxB;;MACA,MAAM+lD,iBAAiB,GAAGh5D,IAAI,IAAIyS,QAAQ,CAACknD,OAAT,CAAiBzuE,GAAjB,CAAqB8U,IAArB,CAAlC;;MACA,MAAM;QACJo5D,kBADI;QAEJC;MAFI,IAGFN,gCAAgC,CAAC;QACnCC,iBADmC;QAEnCC,MAAM,EAAE,KAAKxC,OAAL,CAAawC,MAFc;QAGnCC,cAAc,EAAE,KAAK0B,eAHc;QAInC5G,YAAY,EAAE,KAAK2G;MAJgB,CAAD,CAHpC;MASA,KAAKjG,iBAAL,GAAyB0E,kBAAzB;MACA,KAAKzE,cAAL,GAAsB0E,eAAe,IAAI,KAAK1E,cAA9C;MACA,KAAKgC,SAAL,GAAiB4C,yBAAyB,CAACP,iBAAD,CAA1C;;MACA,IAAI,CAAC,KAAKvE,qBAAN,IAA+B,KAAKC,iBAAxC,EAA2D;QACzD,KAAKt+B,MAAL,CAAY,IAAIzqC,cAAJ,CAAmB,wBAAnB,CAAZ;MACD;IACF,CAtBD,EAsBG6gB,KAtBH,CAsBS,KAAKkuD,kBAAL,CAAwBxnD,MAtBjC;IAuBA,KAAK4iD,UAAL,GAAkB,IAAlB;EACD;;EACe,IAAZiB,YAAY,GAAG;IACjB,OAAO,KAAK2D,kBAAL,CAAwB78C,OAA/B;EACD;;EACW,IAARlR,QAAQ,GAAG;IACb,OAAO,KAAKgqD,SAAZ;EACD;;EACgB,IAAbO,aAAa,GAAG;IAClB,OAAO,KAAKvC,cAAZ;EACD;;EACmB,IAAhBqC,gBAAgB,GAAG;IACrB,OAAO,KAAKtC,iBAAZ;EACD;;EACuB,IAApBuC,oBAAoB,GAAG;IACzB,OAAO,KAAKxC,qBAAZ;EACD;;EACK0C,IAAI,GAAG;IAAA;;IAAA;MACX,MAAM,OAAI,CAACuD,kBAAL,CAAwB78C,OAA9B;MACA,MAAM;QACJpe,KADI;QAEJgpC;MAFI,UAGI,OAAI,CAAC+xB,OAAL,CAAarD,IAAb,EAHV;;MAIA,IAAI1uB,IAAJ,EAAU;QACR,OAAO;UACLhpC,KADK;UAELgpC;QAFK,CAAP;MAID;;MACD,OAAI,CAACotB,OAAL,IAAgBp2D,KAAK,CAAC8jC,UAAtB;MACA,OAAI,CAACuyB,UAAL,GAAkB;QAChB/tB,MAAM,EAAE,OAAI,CAAC8tB,OADG;QAEhBX,KAAK,EAAE,OAAI,CAACP;MAFI,CAAlB;MAIA,OAAO;QACLl1D,KAAK,EAAE06D,cAAc,CAAC16D,KAAD,CADhB;QAELgpC,IAAI,EAAE;MAFD,CAAP;IAjBW;EAqBZ;;EACDrS,MAAM,CAAC3pB,MAAD,EAAS;IACb,KAAK+tD,OAAL,EAAcpkC,MAAd,CAAqB3pB,MAArB;;IACA,KAAKouD,gBAAL,CAAsBtzC,KAAtB;EACD;;AArFwB;;AAuF3B,MAAMgzC,yBAAN,CAAgC;EAC9Bt6D,WAAW,CAACgvD,MAAD,EAAS8F,KAAT,EAAgB1kD,GAAhB,EAAqB;IAC9B,KAAKomD,OAAL,GAAexH,MAAf;IACA,KAAKuL,OAAL,GAAe,IAAf;IACA,KAAK3E,OAAL,GAAe,CAAf;IACA,MAAM/sC,MAAM,GAAGmmC,MAAM,CAACnmC,MAAtB;IACA,KAAK2xC,gBAAL,GAAwB3xC,MAAM,CAAC8wC,eAAP,IAA0B,KAAlD;IACA,KAAKoB,eAAL,GAAuBhoD,OAAO,CAACm4B,aAAR,EAAvB;IACA,KAAKspB,qBAAL,GAA6B,CAAC3rC,MAAM,CAACmrC,aAArC;IACA,KAAK4G,gBAAL,GAAwB,IAAIz4C,eAAJ,EAAxB;IACA,KAAK04C,QAAL,GAAgBd,aAAa,CAAC,KAAKvD,OAAL,CAAawD,WAAd,CAA7B;;IACA,KAAKa,QAAL,CAAcrsD,MAAd,CAAqB,OAArB,EAA+B,SAAQsmD,KAAM,IAAG1kD,GAAG,GAAG,CAAE,EAAxD;;IACA,MAAMzR,GAAG,GAAGkqB,MAAM,CAAClqB,GAAnB;IACAyN,KAAK,CAACzN,GAAD,EAAM86D,kBAAkB,CAAC,KAAKoB,QAAN,EAAgB,KAAKL,gBAArB,EAAuC,KAAKI,gBAA5C,CAAxB,CAAL,CAA4FhnD,IAA5F,CAAiGpB,QAAQ,IAAI;MAC3G,IAAI,CAACgnD,sBAAsB,CAAChnD,QAAQ,CAACnS,MAAV,CAA3B,EAA8C;QAC5C,MAAMk5D,yBAAyB,CAAC/mD,QAAQ,CAACnS,MAAV,EAAkB1B,GAAlB,CAA/B;MACD;;MACD,KAAKo8D,eAAL,CAAqB/nD,OAArB;;MACA,KAAKunD,OAAL,GAAe/nD,QAAQ,CAAC/D,IAAT,CAAcqsD,SAAd,EAAf;IACD,CAND,EAMGvuD,KANH,CAMS,KAAKwuD,eAAL,CAAqB9nD,MAN9B;IAOA,KAAK4iD,UAAL,GAAkB,IAAlB;EACD;;EACuB,IAApBmB,oBAAoB,GAAG;IACzB,OAAO,KAAKxC,qBAAZ;EACD;;EACK0C,IAAI,GAAG;IAAA;;IAAA;MACX,MAAM,OAAI,CAAC6D,eAAL,CAAqBn9C,OAA3B;MACA,MAAM;QACJpe,KADI;QAEJgpC;MAFI,UAGI,OAAI,CAAC+xB,OAAL,CAAarD,IAAb,EAHV;;MAIA,IAAI1uB,IAAJ,EAAU;QACR,OAAO;UACLhpC,KADK;UAELgpC;QAFK,CAAP;MAID;;MACD,OAAI,CAACotB,OAAL,IAAgBp2D,KAAK,CAAC8jC,UAAtB;MACA,OAAI,CAACuyB,UAAL,GAAkB;QAChB/tB,MAAM,EAAE,OAAI,CAAC8tB;MADG,CAAlB;MAGA,OAAO;QACLp2D,KAAK,EAAE06D,cAAc,CAAC16D,KAAD,CADhB;QAELgpC,IAAI,EAAE;MAFD,CAAP;IAhBW;EAoBZ;;EACDrS,MAAM,CAAC3pB,MAAD,EAAS;IACb,KAAK+tD,OAAL,EAAcpkC,MAAd,CAAqB3pB,MAArB;;IACA,KAAKouD,gBAAL,CAAsBtzC,KAAtB;EACD;;AAjD6B;;AAoDhC,C,CAAC;;AAGD,MAAM0zC,WAAW,GAAG,GAApB;AACA,MAAMC,wBAAwB,GAAG,GAAjC;;AACA,SAASC,sBAAT,CAAgCC,GAAhC,EAAqC;EACnC,MAAMtnD,IAAI,GAAGsnD,GAAG,CAAC3oD,QAAjB;;EACA,IAAI,OAAOqB,IAAP,KAAgB,QAApB,EAA8B;IAC5B,OAAOA,IAAP;EACD;;EACD,OAAOtS,aAAa,CAACsS,IAAD,CAAb,CAAoBxR,MAA3B;AACD;;AACD,MAAM+4D,cAAN,CAAqB;EACnBp7D,WAAW,CAACrB,GAAD,EAAM4iB,IAAI,GAAG,EAAb,EAAiB;IAC1B,KAAK5iB,GAAL,GAAWA,GAAX;IACA,KAAKq6D,MAAL,GAAc,YAAYjjD,IAAZ,CAAiBpX,GAAjB,CAAd;IACA,KAAKq7D,WAAL,GAAmB,KAAKhB,MAAL,IAAez3C,IAAI,CAACy4C,WAApB,IAAmClvE,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAtD;IACA,KAAK23D,eAAL,GAAuBp4C,IAAI,CAACo4C,eAAL,IAAwB,KAA/C;IACA,KAAK0B,SAAL,GAAiB,CAAjB;IACA,KAAKC,eAAL,GAAuBxwE,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAvB;EACD;;EACDu5D,YAAY,CAACzG,KAAD,EAAQ1kD,GAAR,EAAaorD,SAAb,EAAwB;IAClC,MAAMj6C,IAAI,GAAG;MACXuzC,KADW;MAEX1kD;IAFW,CAAb;;IAIA,KAAK,MAAMjlB,IAAX,IAAmBqwE,SAAnB,EAA8B;MAC5Bj6C,IAAI,CAACp2B,IAAD,CAAJ,GAAaqwE,SAAS,CAACrwE,IAAD,CAAtB;IACD;;IACD,OAAO,KAAK+nB,OAAL,CAAaqO,IAAb,CAAP;EACD;;EACDk6C,WAAW,CAACD,SAAD,EAAY;IACrB,OAAO,KAAKtoD,OAAL,CAAasoD,SAAb,CAAP;EACD;;EACDtoD,OAAO,CAACqO,IAAD,EAAO;IACZ,MAAM45C,GAAG,GAAG,IAAIhoD,cAAJ,EAAZ;IACA,MAAMuoD,KAAK,GAAG,KAAKL,SAAL,EAAd;IACA,MAAMM,cAAc,GAAG,KAAKL,eAAL,CAAqBI,KAArB,IAA8B;MACnDP;IADmD,CAArD;IAGAA,GAAG,CAAC/nD,IAAJ,CAAS,KAAT,EAAgB,KAAKzU,GAArB;IACAw8D,GAAG,CAACxB,eAAJ,GAAsB,KAAKA,eAA3B;;IACA,KAAK,MAAMvb,QAAX,IAAuB,KAAK4b,WAA5B,EAAyC;MACvC,MAAMx6D,KAAK,GAAG,KAAKw6D,WAAL,CAAiB5b,QAAjB,CAAd;;MACA,IAAI5+C,KAAK,KAAKiB,SAAd,EAAyB;QACvB;MACD;;MACD06D,GAAG,CAACS,gBAAJ,CAAqBxd,QAArB,EAA+B5+C,KAA/B;IACD;;IACD,IAAI,KAAKw5D,MAAL,IAAe,WAAWz3C,IAA1B,IAAkC,SAASA,IAA/C,EAAqD;MACnD45C,GAAG,CAACS,gBAAJ,CAAqB,OAArB,EAA+B,SAAQr6C,IAAI,CAACuzC,KAAM,IAAGvzC,IAAI,CAACnR,GAAL,GAAW,CAAE,EAAlE;MACAurD,cAAc,CAACE,cAAf,GAAgCZ,wBAAhC;IACD,CAHD,MAGO;MACLU,cAAc,CAACE,cAAf,GAAgCb,WAAhC;IACD;;IACDG,GAAG,CAAC9nD,YAAJ,GAAmB,aAAnB;;IACA,IAAIkO,IAAI,CAACu6C,OAAT,EAAkB;MAChBX,GAAG,CAACv8C,OAAJ,GAAc,UAAUkI,GAAV,EAAe;QAC3BvF,IAAI,CAACu6C,OAAL,CAAaX,GAAG,CAAC96D,MAAjB;MACD,CAFD;IAGD;;IACD86D,GAAG,CAAC7nD,kBAAJ,GAAyB,KAAKyoD,aAAL,CAAmBtrD,IAAnB,CAAwB,IAAxB,EAA8BirD,KAA9B,CAAzB;IACAP,GAAG,CAACa,UAAJ,GAAiB,KAAKnG,UAAL,CAAgBplD,IAAhB,CAAqB,IAArB,EAA2BirD,KAA3B,CAAjB;IACAC,cAAc,CAACM,iBAAf,GAAmC16C,IAAI,CAAC06C,iBAAxC;IACAN,cAAc,CAACO,MAAf,GAAwB36C,IAAI,CAAC26C,MAA7B;IACAP,cAAc,CAACG,OAAf,GAAyBv6C,IAAI,CAACu6C,OAA9B;IACAH,cAAc,CAAC9F,UAAf,GAA4Bt0C,IAAI,CAACs0C,UAAjC;IACAsF,GAAG,CAACznD,IAAJ,CAAS,IAAT;IACA,OAAOgoD,KAAP;EACD;;EACD7F,UAAU,CAAC6F,KAAD,EAAQ50C,GAAR,EAAa;IACrB,MAAM60C,cAAc,GAAG,KAAKL,eAAL,CAAqBI,KAArB,CAAvB;;IACA,IAAI,CAACC,cAAL,EAAqB;MACnB;IACD;;IACDA,cAAc,CAAC9F,UAAf,GAA4B/uC,GAA5B;EACD;;EACDi1C,aAAa,CAACL,KAAD,EAAQ50C,GAAR,EAAa;IACxB,MAAM60C,cAAc,GAAG,KAAKL,eAAL,CAAqBI,KAArB,CAAvB;;IACA,IAAI,CAACC,cAAL,EAAqB;MACnB;IACD;;IACD,MAAMR,GAAG,GAAGQ,cAAc,CAACR,GAA3B;;IACA,IAAIA,GAAG,CAAC5nD,UAAJ,IAAkB,CAAlB,IAAuBooD,cAAc,CAACM,iBAA1C,EAA6D;MAC3DN,cAAc,CAACM,iBAAf;MACA,OAAON,cAAc,CAACM,iBAAtB;IACD;;IACD,IAAId,GAAG,CAAC5nD,UAAJ,KAAmB,CAAvB,EAA0B;MACxB;IACD;;IACD,IAAI,EAAEmoD,KAAK,IAAI,KAAKJ,eAAhB,CAAJ,EAAsC;MACpC;IACD;;IACD,OAAO,KAAKA,eAAL,CAAqBI,KAArB,CAAP;;IACA,IAAIP,GAAG,CAAC96D,MAAJ,KAAe,CAAf,IAAoB,KAAK24D,MAA7B,EAAqC;MACnC2C,cAAc,CAACG,OAAf,GAAyBX,GAAG,CAAC96D,MAA7B;MACA;IACD;;IACD,MAAM87D,SAAS,GAAGhB,GAAG,CAAC96D,MAAJ,IAAc26D,WAAhC;IACA,MAAMoB,4BAA4B,GAAGD,SAAS,KAAKnB,WAAd,IAA6BW,cAAc,CAACE,cAAf,KAAkCZ,wBAApG;;IACA,IAAI,CAACmB,4BAAD,IAAiCD,SAAS,KAAKR,cAAc,CAACE,cAAlE,EAAkF;MAChFF,cAAc,CAACG,OAAf,GAAyBX,GAAG,CAAC96D,MAA7B;MACA;IACD;;IACD,MAAMc,KAAK,GAAG+5D,sBAAsB,CAACC,GAAD,CAApC;;IACA,IAAIgB,SAAS,KAAKlB,wBAAlB,EAA4C;MAC1C,MAAMoB,WAAW,GAAGlB,GAAG,CAACpC,iBAAJ,CAAsB,eAAtB,CAApB;MACA,MAAMxhD,OAAO,GAAG,2BAA2BlB,IAA3B,CAAgCgmD,WAAhC,CAAhB;MACAV,cAAc,CAACO,MAAf,CAAsB;QACpBpH,KAAK,EAAEr9C,QAAQ,CAACF,OAAO,CAAC,CAAD,CAAR,EAAa,EAAb,CADK;QAEpBpW;MAFoB,CAAtB;IAID,CAPD,MAOO,IAAIA,KAAJ,EAAW;MAChBw6D,cAAc,CAACO,MAAf,CAAsB;QACpBpH,KAAK,EAAE,CADa;QAEpB3zD;MAFoB,CAAtB;IAID,CALM,MAKA;MACLw6D,cAAc,CAACG,OAAf,GAAyBX,GAAG,CAAC96D,MAA7B;IACD;EACF;;EACDi8D,aAAa,CAACZ,KAAD,EAAQ;IACnB,OAAO,KAAKJ,eAAL,CAAqBI,KAArB,EAA4BP,GAAnC;EACD;;EACDoB,gBAAgB,CAACb,KAAD,EAAQ;IACtB,OAAOA,KAAK,IAAI,KAAKJ,eAArB;EACD;;EACDkB,YAAY,CAACd,KAAD,EAAQ;IAClB,MAAMP,GAAG,GAAG,KAAKG,eAAL,CAAqBI,KAArB,EAA4BP,GAAxC;IACA,OAAO,KAAKG,eAAL,CAAqBI,KAArB,CAAP;IACAP,GAAG,CAAC7zC,KAAJ;EACD;;AAvHkB;;AAyHrB,MAAMm1C,gBAAN,CAAuB;EACrBz8D,WAAW,CAAC6oB,MAAD,EAAS;IAClB,KAAK6zC,OAAL,GAAe7zC,MAAf;IACA,KAAK8zC,QAAL,GAAgB,IAAIvB,cAAJ,CAAmBvyC,MAAM,CAAClqB,GAA1B,EAA+B;MAC7Cq7D,WAAW,EAAEnxC,MAAM,CAACmxC,WADyB;MAE7CL,eAAe,EAAE9wC,MAAM,CAAC8wC;IAFqB,CAA/B,CAAhB;IAIA,KAAKgB,eAAL,GAAuB9xC,MAAM,CAACowC,cAA9B;IACA,KAAKtE,kBAAL,GAA0B,IAA1B;IACA,KAAKyF,oBAAL,GAA4B,EAA5B;EACD;;EACDwC,2BAA2B,CAAC7G,MAAD,EAAS;IAClC,MAAMh1D,CAAC,GAAG,KAAKq5D,oBAAL,CAA0BpE,OAA1B,CAAkCD,MAAlC,CAAV;;IACA,IAAIh1D,CAAC,IAAI,CAAT,EAAY;MACV,KAAKq5D,oBAAL,CAA0Bj6C,MAA1B,CAAiCpf,CAAjC,EAAoC,CAApC;IACD;EACF;;EACDk1D,aAAa,GAAG;IACdz3D,MAAM,CAAC,CAAC,KAAKm2D,kBAAP,EAA2B,yDAA3B,CAAN;IACA,KAAKA,kBAAL,GAA0B,IAAIkI,iCAAJ,CAAsC,KAAKF,QAA3C,EAAqD,KAAKD,OAA1D,CAA1B;IACA,OAAO,KAAK/H,kBAAZ;EACD;;EACDyB,cAAc,CAACtB,KAAD,EAAQ1kD,GAAR,EAAa;IACzB,MAAM2lD,MAAM,GAAG,IAAI+G,kCAAJ,CAAuC,KAAKH,QAA5C,EAAsD7H,KAAtD,EAA6D1kD,GAA7D,CAAf;IACA2lD,MAAM,CAACgH,QAAP,GAAkB,KAAKH,2BAAL,CAAiCnsD,IAAjC,CAAsC,IAAtC,CAAlB;;IACA,KAAK2pD,oBAAL,CAA0B/4D,IAA1B,CAA+B00D,MAA/B;;IACA,OAAOA,MAAP;EACD;;EACDQ,iBAAiB,CAAC/pD,MAAD,EAAS;IACxB,KAAKmoD,kBAAL,EAAyBx+B,MAAzB,CAAgC3pB,MAAhC;;IACA,KAAK,MAAMupD,MAAX,IAAqB,KAAKqE,oBAAL,CAA0B31D,KAA1B,CAAgC,CAAhC,CAArB,EAAyD;MACvDsxD,MAAM,CAAC5/B,MAAP,CAAc3pB,MAAd;IACD;EACF;;AAjCoB;;AAmCvB,MAAMqwD,iCAAN,CAAwC;EACtC78D,WAAW,CAACg9D,OAAD,EAAUn0C,MAAV,EAAkB;IAC3B,KAAK8zC,QAAL,GAAgBK,OAAhB;IACA,MAAMz7C,IAAI,GAAG;MACX06C,iBAAiB,EAAE,KAAKgB,kBAAL,CAAwBxsD,IAAxB,CAA6B,IAA7B,CADR;MAEXyrD,MAAM,EAAE,KAAKgB,OAAL,CAAazsD,IAAb,CAAkB,IAAlB,CAFG;MAGXqrD,OAAO,EAAE,KAAKqB,QAAL,CAAc1sD,IAAd,CAAmB,IAAnB,CAHE;MAIXolD,UAAU,EAAE,KAAKX,WAAL,CAAiBzkD,IAAjB,CAAsB,IAAtB;IAJD,CAAb;IAMA,KAAK2sD,IAAL,GAAYv0C,MAAM,CAAClqB,GAAnB;IACA,KAAK0+D,cAAL,GAAsBL,OAAO,CAACvB,WAAR,CAAoBl6C,IAApB,CAAtB;IACA,KAAK+7C,0BAAL,GAAkCvqD,OAAO,CAACm4B,aAAR,EAAlC;IACA,KAAKwvB,aAAL,GAAqB7xC,MAAM,CAACkrC,YAAP,IAAuB,KAA5C;IACA,KAAKW,cAAL,GAAsB7rC,MAAM,CAAC1pB,MAA7B;IACA,KAAKw7D,eAAL,GAAuB9xC,MAAM,CAACowC,cAA9B;;IACA,IAAI,CAAC,KAAK0B,eAAN,IAAyB,CAAC,KAAKD,aAAnC,EAAkD;MAChD,KAAKA,aAAL,GAAqB,IAArB;IACD;;IACD,KAAKlG,qBAAL,GAA6B,KAA7B;IACA,KAAKC,iBAAL,GAAyB,KAAzB;IACA,KAAK8I,aAAL,GAAqB,EAArB;IACA,KAAK5G,SAAL,GAAiB,EAAjB;IACA,KAAKF,KAAL,GAAa,KAAb;IACA,KAAK+G,YAAL,GAAoB/8D,SAApB;IACA,KAAKi2D,SAAL,GAAiB,IAAjB;IACA,KAAKb,UAAL,GAAkB,IAAlB;EACD;;EACDoH,kBAAkB,GAAG;IACnB,MAAMQ,gBAAgB,GAAG,KAAKJ,cAA9B;;IACA,MAAMK,cAAc,GAAG,KAAKf,QAAL,CAAcL,aAAd,CAA4BmB,gBAA5B,CAAvB;;IACA,MAAM1E,iBAAiB,GAAGh5D,IAAI,IAAI29D,cAAc,CAAC3E,iBAAf,CAAiCh5D,IAAjC,CAAlC;;IACA,MAAM;MACJo5D,kBADI;MAEJC;IAFI,IAGFN,gCAAgC,CAAC;MACnCC,iBADmC;MAEnCC,MAAM,EAAE,KAAK2D,QAAL,CAAc3D,MAFa;MAGnCC,cAAc,EAAE,KAAK0B,eAHc;MAInC5G,YAAY,EAAE,KAAK2G;IAJgB,CAAD,CAHpC;;IASA,IAAIvB,kBAAJ,EAAwB;MACtB,KAAK1E,iBAAL,GAAyB,IAAzB;IACD;;IACD,KAAKC,cAAL,GAAsB0E,eAAe,IAAI,KAAK1E,cAA9C;IACA,KAAKgC,SAAL,GAAiB4C,yBAAyB,CAACP,iBAAD,CAA1C;;IACA,IAAI,KAAKtE,iBAAT,EAA4B;MAC1B,KAAKkI,QAAL,CAAcH,YAAd,CAA2BiB,gBAA3B;IACD;;IACD,KAAKH,0BAAL,CAAgCtqD,OAAhC;EACD;;EACDkqD,OAAO,CAACrpD,IAAD,EAAO;IACZ,IAAIA,IAAJ,EAAU;MACR,IAAI,KAAK8iD,SAAL,CAAex3D,MAAf,GAAwB,CAA5B,EAA+B;QAC7B,MAAM03D,iBAAiB,GAAG,KAAKF,SAAL,CAAejuB,KAAf,EAA1B;;QACAmuB,iBAAiB,CAAC7jD,OAAlB,CAA0B;UACxBxT,KAAK,EAAEqU,IAAI,CAAC1S,KADY;UAExBqnC,IAAI,EAAE;QAFkB,CAA1B;MAID,CAND,MAMO;QACL,KAAK+0B,aAAL,CAAmBl8D,IAAnB,CAAwBwS,IAAI,CAAC1S,KAA7B;MACD;IACF;;IACD,KAAKs1D,KAAL,GAAa,IAAb;;IACA,IAAI,KAAK8G,aAAL,CAAmBp+D,MAAnB,GAA4B,CAAhC,EAAmC;MACjC;IACD;;IACD,KAAK,MAAM03D,iBAAX,IAAgC,KAAKF,SAArC,EAAgD;MAC9CE,iBAAiB,CAAC7jD,OAAlB,CAA0B;QACxBxT,KAAK,EAAEiB,SADiB;QAExB+nC,IAAI,EAAE;MAFkB,CAA1B;IAID;;IACD,KAAKmuB,SAAL,CAAex3D,MAAf,GAAwB,CAAxB;EACD;;EACDg+D,QAAQ,CAAC98D,MAAD,EAAS;IACf,KAAKm9D,YAAL,GAAoBjE,yBAAyB,CAACl5D,MAAD,EAAS,KAAK+8D,IAAd,CAA7C;;IACA,KAAKE,0BAAL,CAAgCrqD,MAAhC,CAAuC,KAAKuqD,YAA5C;;IACA,KAAK,MAAM3G,iBAAX,IAAgC,KAAKF,SAArC,EAAgD;MAC9CE,iBAAiB,CAAC5jD,MAAlB,CAAyB,KAAKuqD,YAA9B;IACD;;IACD,KAAK7G,SAAL,CAAex3D,MAAf,GAAwB,CAAxB;IACA,KAAKo+D,aAAL,CAAmBp+D,MAAnB,GAA4B,CAA5B;EACD;;EACD+1D,WAAW,CAACpuC,GAAD,EAAM;IACf,KAAK+uC,UAAL,GAAkB;MAChB/tB,MAAM,EAAEhhB,GAAG,CAACghB,MADI;MAEhBmtB,KAAK,EAAEnuC,GAAG,CAAC62C,gBAAJ,GAAuB72C,GAAG,CAACmuC,KAA3B,GAAmC,KAAKP;IAF/B,CAAlB;EAID;;EACW,IAARhoD,QAAQ,GAAG;IACb,OAAO,KAAKgqD,SAAZ;EACD;;EACmB,IAAhBK,gBAAgB,GAAG;IACrB,OAAO,KAAKtC,iBAAZ;EACD;;EACuB,IAApBuC,oBAAoB,GAAG;IACzB,OAAO,KAAKxC,qBAAZ;EACD;;EACgB,IAAbyC,aAAa,GAAG;IAClB,OAAO,KAAKvC,cAAZ;EACD;;EACe,IAAZoC,YAAY,GAAG;IACjB,OAAO,KAAKwG,0BAAL,CAAgC1/C,OAAvC;EACD;;EACKs5C,IAAI,GAAG;IAAA;;IAAA;MACX,IAAI,OAAI,CAACsG,YAAT,EAAuB;QACrB,MAAM,OAAI,CAACA,YAAX;MACD;;MACD,IAAI,OAAI,CAACD,aAAL,CAAmBp+D,MAAnB,GAA4B,CAAhC,EAAmC;QACjC,MAAMgC,KAAK,GAAG,OAAI,CAACo8D,aAAL,CAAmB70B,KAAnB,EAAd;;QACA,OAAO;UACLlpC,KAAK,EAAE2B,KADF;UAELqnC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,IAAI,OAAI,CAACiuB,KAAT,EAAgB;QACd,OAAO;UACLj3D,KAAK,EAAEiB,SADF;UAEL+nC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,MAAMquB,iBAAiB,GAAG9jD,OAAO,CAACm4B,aAAR,EAA1B;;MACA,OAAI,CAACyrB,SAAL,CAAet1D,IAAf,CAAoBw1D,iBAApB;;MACA,OAAOA,iBAAiB,CAACj5C,OAAzB;IAnBW;EAoBZ;;EACDuY,MAAM,CAAC3pB,MAAD,EAAS;IACb,KAAKiqD,KAAL,GAAa,IAAb;;IACA,KAAK6G,0BAAL,CAAgCrqD,MAAhC,CAAuCzG,MAAvC;;IACA,KAAK,MAAMqqD,iBAAX,IAAgC,KAAKF,SAArC,EAAgD;MAC9CE,iBAAiB,CAAC7jD,OAAlB,CAA0B;QACxBxT,KAAK,EAAEiB,SADiB;QAExB+nC,IAAI,EAAE;MAFkB,CAA1B;IAID;;IACD,KAAKmuB,SAAL,CAAex3D,MAAf,GAAwB,CAAxB;;IACA,IAAI,KAAKw9D,QAAL,CAAcJ,gBAAd,CAA+B,KAAKc,cAApC,CAAJ,EAAyD;MACvD,KAAKV,QAAL,CAAcH,YAAd,CAA2B,KAAKa,cAAhC;IACD;;IACD,KAAK1I,kBAAL,GAA0B,IAA1B;EACD;;AA3IqC;;AA6IxC,MAAMmI,kCAAN,CAAyC;EACvC98D,WAAW,CAACg9D,OAAD,EAAUlI,KAAV,EAAiB1kD,GAAjB,EAAsB;IAC/B,KAAKusD,QAAL,GAAgBK,OAAhB;IACA,MAAMz7C,IAAI,GAAG;MACX26C,MAAM,EAAE,KAAKgB,OAAL,CAAazsD,IAAb,CAAkB,IAAlB,CADG;MAEXqrD,OAAO,EAAE,KAAKqB,QAAL,CAAc1sD,IAAd,CAAmB,IAAnB,CAFE;MAGXolD,UAAU,EAAE,KAAKX,WAAL,CAAiBzkD,IAAjB,CAAsB,IAAtB;IAHD,CAAb;IAKA,KAAK2sD,IAAL,GAAYJ,OAAO,CAACr+D,GAApB;IACA,KAAKi/D,UAAL,GAAkBZ,OAAO,CAACzB,YAAR,CAAqBzG,KAArB,EAA4B1kD,GAA5B,EAAiCmR,IAAjC,CAAlB;IACA,KAAKo1C,SAAL,GAAiB,EAAjB;IACA,KAAKS,YAAL,GAAoB,IAApB;IACA,KAAKX,KAAL,GAAa,KAAb;IACA,KAAK+G,YAAL,GAAoB/8D,SAApB;IACA,KAAKo1D,UAAL,GAAkB,IAAlB;IACA,KAAKkH,QAAL,GAAgB,IAAhB;EACD;;EACDc,MAAM,GAAG;IACP,KAAKd,QAAL,GAAgB,IAAhB;EACD;;EACDG,OAAO,CAACrpD,IAAD,EAAO;IACZ,MAAM1S,KAAK,GAAG0S,IAAI,CAAC1S,KAAnB;;IACA,IAAI,KAAKw1D,SAAL,CAAex3D,MAAf,GAAwB,CAA5B,EAA+B;MAC7B,MAAM03D,iBAAiB,GAAG,KAAKF,SAAL,CAAejuB,KAAf,EAA1B;;MACAmuB,iBAAiB,CAAC7jD,OAAlB,CAA0B;QACxBxT,KAAK,EAAE2B,KADiB;QAExBqnC,IAAI,EAAE;MAFkB,CAA1B;IAID,CAND,MAMO;MACL,KAAK4uB,YAAL,GAAoBj2D,KAApB;IACD;;IACD,KAAKs1D,KAAL,GAAa,IAAb;;IACA,KAAK,MAAMI,iBAAX,IAAgC,KAAKF,SAArC,EAAgD;MAC9CE,iBAAiB,CAAC7jD,OAAlB,CAA0B;QACxBxT,KAAK,EAAEiB,SADiB;QAExB+nC,IAAI,EAAE;MAFkB,CAA1B;IAID;;IACD,KAAKmuB,SAAL,CAAex3D,MAAf,GAAwB,CAAxB;;IACA,KAAK0+D,MAAL;EACD;;EACDV,QAAQ,CAAC98D,MAAD,EAAS;IACf,KAAKm9D,YAAL,GAAoBjE,yBAAyB,CAACl5D,MAAD,EAAS,KAAK+8D,IAAd,CAA7C;;IACA,KAAK,MAAMvG,iBAAX,IAAgC,KAAKF,SAArC,EAAgD;MAC9CE,iBAAiB,CAAC5jD,MAAlB,CAAyB,KAAKuqD,YAA9B;IACD;;IACD,KAAK7G,SAAL,CAAex3D,MAAf,GAAwB,CAAxB;IACA,KAAKi4D,YAAL,GAAoB,IAApB;EACD;;EACDlC,WAAW,CAACpuC,GAAD,EAAM;IACf,IAAI,CAAC,KAAKkwC,oBAAV,EAAgC;MAC9B,KAAKnB,UAAL,GAAkB;QAChB/tB,MAAM,EAAEhhB,GAAG,CAACghB;MADI,CAAlB;IAGD;EACF;;EACuB,IAApBkvB,oBAAoB,GAAG;IACzB,OAAO,KAAP;EACD;;EACKE,IAAI,GAAG;IAAA;;IAAA;MACX,IAAI,OAAI,CAACsG,YAAT,EAAuB;QACrB,MAAM,OAAI,CAACA,YAAX;MACD;;MACD,IAAI,OAAI,CAACpG,YAAL,KAAsB,IAA1B,EAAgC;QAC9B,MAAMj2D,KAAK,GAAG,OAAI,CAACi2D,YAAnB;QACA,OAAI,CAACA,YAAL,GAAoB,IAApB;QACA,OAAO;UACL53D,KAAK,EAAE2B,KADF;UAELqnC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,IAAI,OAAI,CAACiuB,KAAT,EAAgB;QACd,OAAO;UACLj3D,KAAK,EAAEiB,SADF;UAEL+nC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,MAAMquB,iBAAiB,GAAG9jD,OAAO,CAACm4B,aAAR,EAA1B;;MACA,OAAI,CAACyrB,SAAL,CAAet1D,IAAf,CAAoBw1D,iBAApB;;MACA,OAAOA,iBAAiB,CAACj5C,OAAzB;IApBW;EAqBZ;;EACDuY,MAAM,CAAC3pB,MAAD,EAAS;IACb,KAAKiqD,KAAL,GAAa,IAAb;;IACA,KAAK,MAAMI,iBAAX,IAAgC,KAAKF,SAArC,EAAgD;MAC9CE,iBAAiB,CAAC7jD,OAAlB,CAA0B;QACxBxT,KAAK,EAAEiB,SADiB;QAExB+nC,IAAI,EAAE;MAFkB,CAA1B;IAID;;IACD,KAAKmuB,SAAL,CAAex3D,MAAf,GAAwB,CAAxB;;IACA,IAAI,KAAKw9D,QAAL,CAAcJ,gBAAd,CAA+B,KAAKqB,UAApC,CAAJ,EAAqD;MACnD,KAAKjB,QAAL,CAAcH,YAAd,CAA2B,KAAKoB,UAAhC;IACD;;IACD,KAAKC,MAAL;EACD;;AA9FsC;;AAiGzC,C,CAAC;;AAID,MAAMC,QAAQ,GAAG,uBAAjB;;AACA,SAASC,cAAT,CAAwBC,SAAxB,EAAmC;EACjC,IAAIF,QAAQ,CAAC/nD,IAAT,CAAcioD,SAAd,CAAJ,EAA8B;IAC5B,OAAO,IAAIz+D,GAAJ,CAAQy+D,SAAR,CAAP;EACD;;EACD,MAAMr/D,GAAG,GAAG8sC,YAAY,CAACxgD,GAAb,CAAiB,KAAjB,CAAZ;EACA,OAAO,IAAIsU,GAAJ,CAAQZ,GAAG,CAACs/D,aAAJ,CAAkBD,SAAlB,CAAR,CAAP;AACD;;AACD,SAASE,aAAT,CAAuBv/D,GAAvB,EAA4B+6D,OAA5B,EAAqC/4C,QAArC,EAA+C;EAC7C,IAAIhiB,GAAG,CAACC,QAAJ,KAAiB,OAArB,EAA8B;IAC5B,MAAM0sC,IAAI,GAAGG,YAAY,CAACxgD,GAAb,CAAiB,MAAjB,CAAb;IACA,OAAOqgD,IAAI,CAACp4B,OAAL,CAAavU,GAAb,EAAkB;MACvB+6D;IADuB,CAAlB,EAEJ/4C,QAFI,CAAP;EAGD;;EACD,MAAM4qB,KAAK,GAAGE,YAAY,CAACxgD,GAAb,CAAiB,OAAjB,CAAd;EACA,OAAOsgD,KAAK,CAACr4B,OAAN,CAAcvU,GAAd,EAAmB;IACxB+6D;EADwB,CAAnB,EAEJ/4C,QAFI,CAAP;AAGD;;AACD,MAAMw9C,aAAN,CAAoB;EAClBn+D,WAAW,CAAC6oB,MAAD,EAAS;IAClB,KAAKA,MAAL,GAAcA,MAAd;IACA,KAAKlqB,GAAL,GAAWo/D,cAAc,CAACl1C,MAAM,CAAClqB,GAAR,CAAzB;IACA,KAAKq6D,MAAL,GAAc,KAAKr6D,GAAL,CAASC,QAAT,KAAsB,OAAtB,IAAiC,KAAKD,GAAL,CAASC,QAAT,KAAsB,QAArE;IACA,KAAKw/D,OAAL,GAAe,KAAKz/D,GAAL,CAASC,QAAT,KAAsB,OAArC;IACA,KAAKo7D,WAAL,GAAmB,KAAKhB,MAAL,IAAenwC,MAAM,CAACmxC,WAAtB,IAAqC,EAAxD;IACA,KAAKrF,kBAAL,GAA0B,IAA1B;IACA,KAAKyF,oBAAL,GAA4B,EAA5B;EACD;;EACyB,IAAtBzE,sBAAsB,GAAG;IAC3B,OAAO,KAAKhB,kBAAL,EAAyBiB,OAAzB,IAAoC,CAA3C;EACD;;EACDK,aAAa,GAAG;IACdz3D,MAAM,CAAC,CAAC,KAAKm2D,kBAAP,EAA2B,sDAA3B,CAAN;IACA,KAAKA,kBAAL,GAA0B,KAAKyJ,OAAL,GAAe,IAAIC,yBAAJ,CAA8B,IAA9B,CAAf,GAAqD,IAAIC,uBAAJ,CAA4B,IAA5B,CAA/E;IACA,OAAO,KAAK3J,kBAAZ;EACD;;EACDyB,cAAc,CAACjmD,KAAD,EAAQC,GAAR,EAAa;IACzB,IAAIA,GAAG,IAAI,KAAKulD,sBAAhB,EAAwC;MACtC,OAAO,IAAP;IACD;;IACD,MAAMF,WAAW,GAAG,KAAK2I,OAAL,GAAe,IAAIG,0BAAJ,CAA+B,IAA/B,EAAqCpuD,KAArC,EAA4CC,GAA5C,CAAf,GAAkE,IAAIouD,wBAAJ,CAA6B,IAA7B,EAAmCruD,KAAnC,EAA0CC,GAA1C,CAAtF;;IACA,KAAKgqD,oBAAL,CAA0B/4D,IAA1B,CAA+Bo0D,WAA/B;;IACA,OAAOA,WAAP;EACD;;EACDc,iBAAiB,CAAC/pD,MAAD,EAAS;IACxB,KAAKmoD,kBAAL,EAAyBx+B,MAAzB,CAAgC3pB,MAAhC;;IACA,KAAK,MAAMupD,MAAX,IAAqB,KAAKqE,oBAAL,CAA0B31D,KAA1B,CAAgC,CAAhC,CAArB,EAAyD;MACvDsxD,MAAM,CAAC5/B,MAAP,CAAc3pB,MAAd;IACD;EACF;;AA/BiB;;AAiCpB,MAAMiyD,cAAN,CAAqB;EACnBz+D,WAAW,CAACgvD,MAAD,EAAS;IAClB,KAAKoO,IAAL,GAAYpO,MAAM,CAACrwD,GAAnB;IACA,KAAK83D,KAAL,GAAa,KAAb;IACA,KAAK+G,YAAL,GAAoB,IAApB;IACA,KAAK3H,UAAL,GAAkB,IAAlB;IACA,MAAMhtC,MAAM,GAAGmmC,MAAM,CAACnmC,MAAtB;IACA,KAAK6rC,cAAL,GAAsB7rC,MAAM,CAAC1pB,MAA7B;IACA,KAAKy2D,OAAL,GAAe,CAAf;IACA,KAAKc,SAAL,GAAiB,IAAjB;IACA,KAAKgE,aAAL,GAAqB7xC,MAAM,CAACkrC,YAAP,IAAuB,KAA5C;IACA,KAAK4G,eAAL,GAAuB9xC,MAAM,CAACowC,cAA9B;;IACA,IAAI,CAAC,KAAK0B,eAAN,IAAyB,CAAC,KAAKD,aAAnC,EAAkD;MAChD,KAAKA,aAAL,GAAqB,IAArB;IACD;;IACD,KAAKlG,qBAAL,GAA6B,CAAC3rC,MAAM,CAACmrC,aAArC;IACA,KAAKS,iBAAL,GAAyB,CAAC5rC,MAAM,CAACkrC,YAAjC;IACA,KAAK2K,eAAL,GAAuB,IAAvB;IACA,KAAK3D,eAAL,GAAuBhoD,OAAO,CAACm4B,aAAR,EAAvB;IACA,KAAKuvB,kBAAL,GAA0B1nD,OAAO,CAACm4B,aAAR,EAA1B;EACD;;EACe,IAAZ4rB,YAAY,GAAG;IACjB,OAAO,KAAK2D,kBAAL,CAAwB78C,OAA/B;EACD;;EACW,IAARlR,QAAQ,GAAG;IACb,OAAO,KAAKgqD,SAAZ;EACD;;EACgB,IAAbO,aAAa,GAAG;IAClB,OAAO,KAAKvC,cAAZ;EACD;;EACmB,IAAhBqC,gBAAgB,GAAG;IACrB,OAAO,KAAKtC,iBAAZ;EACD;;EACuB,IAApBuC,oBAAoB,GAAG;IACzB,OAAO,KAAKxC,qBAAZ;EACD;;EACK0C,IAAI,GAAG;IAAA;;IAAA;MACX,MAAM,OAAI,CAAC6D,eAAL,CAAqBn9C,OAA3B;;MACA,IAAI,OAAI,CAAC64C,KAAT,EAAgB;QACd,OAAO;UACLj3D,KAAK,EAAEiB,SADF;UAEL+nC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,IAAI,OAAI,CAACg1B,YAAT,EAAuB;QACrB,MAAM,OAAI,CAACA,YAAX;MACD;;MACD,MAAMr8D,KAAK,GAAG,OAAI,CAACu9D,eAAL,CAAqBxH,IAArB,EAAd;;MACA,IAAI/1D,KAAK,KAAK,IAAd,EAAoB;QAClB,OAAI,CAAC45D,eAAL,GAAuBhoD,OAAO,CAACm4B,aAAR,EAAvB;QACA,OAAO,OAAI,CAACgsB,IAAL,EAAP;MACD;;MACD,OAAI,CAACtB,OAAL,IAAgBz0D,KAAK,CAAChC,MAAtB;MACA,OAAI,CAAC02D,UAAL,GAAkB;QAChB/tB,MAAM,EAAE,OAAI,CAAC8tB,OADG;QAEhBX,KAAK,EAAE,OAAI,CAACP;MAFI,CAAlB;MAIA,MAAMryD,MAAM,GAAG,IAAIZ,UAAJ,CAAeN,KAAf,EAAsBkB,MAArC;MACA,OAAO;QACL7C,KAAK,EAAE6C,MADF;QAELmmC,IAAI,EAAE;MAFD,CAAP;IAtBW;EA0BZ;;EACDrS,MAAM,CAAC3pB,MAAD,EAAS;IACb,IAAI,CAAC,KAAKkyD,eAAV,EAA2B;MACzB,KAAKC,MAAL,CAAYnyD,MAAZ;;MACA;IACD;;IACD,KAAKkyD,eAAL,CAAqBrzD,OAArB,CAA6BmB,MAA7B;EACD;;EACDmyD,MAAM,CAACnyD,MAAD,EAAS;IACb,KAAKgxD,YAAL,GAAoBhxD,MAApB;;IACA,KAAKuuD,eAAL,CAAqB/nD,OAArB;EACD;;EACD4rD,kBAAkB,CAACC,cAAD,EAAiB;IACjC,KAAKH,eAAL,GAAuBG,cAAvB;IACAA,cAAc,CAACn2C,EAAf,CAAkB,UAAlB,EAA8B,MAAM;MAClC,KAAKqyC,eAAL,CAAqB/nD,OAArB;IACD,CAFD;IAGA6rD,cAAc,CAACn2C,EAAf,CAAkB,KAAlB,EAAyB,MAAM;MAC7Bm2C,cAAc,CAACxzD,OAAf;MACA,KAAKorD,KAAL,GAAa,IAAb;;MACA,KAAKsE,eAAL,CAAqB/nD,OAArB;IACD,CAJD;IAKA6rD,cAAc,CAACn2C,EAAf,CAAkB,OAAlB,EAA2Blc,MAAM,IAAI;MACnC,KAAKmyD,MAAL,CAAYnyD,MAAZ;IACD,CAFD;;IAGA,IAAI,CAAC,KAAKgoD,qBAAN,IAA+B,KAAKC,iBAAxC,EAA2D;MACzD,KAAKkK,MAAL,CAAY,IAAIjzE,cAAJ,CAAmB,uBAAnB,CAAZ;IACD;;IACD,IAAI,KAAK8xE,YAAT,EAAuB;MACrB,KAAKkB,eAAL,CAAqBrzD,OAArB,CAA6B,KAAKmyD,YAAlC;IACD;EACF;;AA7FkB;;AA+FrB,MAAMsB,eAAN,CAAsB;EACpB9+D,WAAW,CAACgvD,MAAD,EAAS;IAClB,KAAKoO,IAAL,GAAYpO,MAAM,CAACrwD,GAAnB;IACA,KAAK83D,KAAL,GAAa,KAAb;IACA,KAAK+G,YAAL,GAAoB,IAApB;IACA,KAAK3H,UAAL,GAAkB,IAAlB;IACA,KAAKD,OAAL,GAAe,CAAf;IACA,KAAK8I,eAAL,GAAuB,IAAvB;IACA,KAAK3D,eAAL,GAAuBhoD,OAAO,CAACm4B,aAAR,EAAvB;IACA,MAAMriB,MAAM,GAAGmmC,MAAM,CAACnmC,MAAtB;IACA,KAAK2rC,qBAAL,GAA6B,CAAC3rC,MAAM,CAACmrC,aAArC;EACD;;EACuB,IAApBgD,oBAAoB,GAAG;IACzB,OAAO,KAAKxC,qBAAZ;EACD;;EACK0C,IAAI,GAAG;IAAA;;IAAA;MACX,MAAM,OAAI,CAAC6D,eAAL,CAAqBn9C,OAA3B;;MACA,IAAI,OAAI,CAAC64C,KAAT,EAAgB;QACd,OAAO;UACLj3D,KAAK,EAAEiB,SADF;UAEL+nC,IAAI,EAAE;QAFD,CAAP;MAID;;MACD,IAAI,OAAI,CAACg1B,YAAT,EAAuB;QACrB,MAAM,OAAI,CAACA,YAAX;MACD;;MACD,MAAMr8D,KAAK,GAAG,OAAI,CAACu9D,eAAL,CAAqBxH,IAArB,EAAd;;MACA,IAAI/1D,KAAK,KAAK,IAAd,EAAoB;QAClB,OAAI,CAAC45D,eAAL,GAAuBhoD,OAAO,CAACm4B,aAAR,EAAvB;QACA,OAAO,OAAI,CAACgsB,IAAL,EAAP;MACD;;MACD,OAAI,CAACtB,OAAL,IAAgBz0D,KAAK,CAAChC,MAAtB;MACA,OAAI,CAAC02D,UAAL,GAAkB;QAChB/tB,MAAM,EAAE,OAAI,CAAC8tB;MADG,CAAlB;MAGA,MAAMvzD,MAAM,GAAG,IAAIZ,UAAJ,CAAeN,KAAf,EAAsBkB,MAArC;MACA,OAAO;QACL7C,KAAK,EAAE6C,MADF;QAELmmC,IAAI,EAAE;MAFD,CAAP;IArBW;EAyBZ;;EACDrS,MAAM,CAAC3pB,MAAD,EAAS;IACb,IAAI,CAAC,KAAKkyD,eAAV,EAA2B;MACzB,KAAKC,MAAL,CAAYnyD,MAAZ;;MACA;IACD;;IACD,KAAKkyD,eAAL,CAAqBrzD,OAArB,CAA6BmB,MAA7B;EACD;;EACDmyD,MAAM,CAACnyD,MAAD,EAAS;IACb,KAAKgxD,YAAL,GAAoBhxD,MAApB;;IACA,KAAKuuD,eAAL,CAAqB/nD,OAArB;EACD;;EACD4rD,kBAAkB,CAACC,cAAD,EAAiB;IACjC,KAAKH,eAAL,GAAuBG,cAAvB;IACAA,cAAc,CAACn2C,EAAf,CAAkB,UAAlB,EAA8B,MAAM;MAClC,KAAKqyC,eAAL,CAAqB/nD,OAArB;IACD,CAFD;IAGA6rD,cAAc,CAACn2C,EAAf,CAAkB,KAAlB,EAAyB,MAAM;MAC7Bm2C,cAAc,CAACxzD,OAAf;MACA,KAAKorD,KAAL,GAAa,IAAb;;MACA,KAAKsE,eAAL,CAAqB/nD,OAArB;IACD,CAJD;IAKA6rD,cAAc,CAACn2C,EAAf,CAAkB,OAAlB,EAA2Blc,MAAM,IAAI;MACnC,KAAKmyD,MAAL,CAAYnyD,MAAZ;IACD,CAFD;;IAGA,IAAI,KAAKgxD,YAAT,EAAuB;MACrB,KAAKkB,eAAL,CAAqBrzD,OAArB,CAA6B,KAAKmyD,YAAlC;IACD;EACF;;AApEmB;;AAsEtB,MAAMc,uBAAN,SAAsCG,cAAtC,CAAqD;EACnDz+D,WAAW,CAACgvD,MAAD,EAAS;IAClB,MAAMA,MAAN;;IACA,MAAM+P,cAAc,GAAGvsD,QAAQ,IAAI;MACjC,IAAIA,QAAQ,CAACwsD,UAAT,KAAwB,GAA5B,EAAiC;QAC/B,MAAMjgD,KAAK,GAAG,IAAIpyB,mBAAJ,CAAyB,gBAAe,KAAKywE,IAAK,IAAlD,CAAd;QACA,KAAKI,YAAL,GAAoBz+C,KAApB;;QACA,KAAK07C,kBAAL,CAAwBxnD,MAAxB,CAA+B8L,KAA/B;;QACA;MACD;;MACD,KAAK07C,kBAAL,CAAwBznD,OAAxB;;MACA,KAAK4rD,kBAAL,CAAwBpsD,QAAxB;;MACA,MAAMumD,iBAAiB,GAAGh5D,IAAI,IAAI,KAAK2+D,eAAL,CAAqBhF,OAArB,CAA6B35D,IAAI,CAAC+V,WAAL,EAA7B,CAAlC;;MACA,MAAM;QACJqjD,kBADI;QAEJC;MAFI,IAGFN,gCAAgC,CAAC;QACnCC,iBADmC;QAEnCC,MAAM,EAAEhK,MAAM,CAACgK,MAFoB;QAGnCC,cAAc,EAAE,KAAK0B,eAHc;QAInC5G,YAAY,EAAE,KAAK2G;MAJgB,CAAD,CAHpC;MASA,KAAKjG,iBAAL,GAAyB0E,kBAAzB;MACA,KAAKzE,cAAL,GAAsB0E,eAAe,IAAI,KAAK1E,cAA9C;MACA,KAAKgC,SAAL,GAAiB4C,yBAAyB,CAACP,iBAAD,CAA1C;IACD,CAtBD;;IAuBA,KAAKkG,QAAL,GAAgBf,aAAa,CAAC,KAAKd,IAAN,EAAYpO,MAAM,CAACgL,WAAnB,EAAgC+E,cAAhC,CAA7B;;IACA,KAAKE,QAAL,CAAcv2C,EAAd,CAAiB,OAAjB,EAA0Blc,MAAM,IAAI;MAClC,KAAKgxD,YAAL,GAAoBhxD,MAApB;;MACA,KAAKiuD,kBAAL,CAAwBxnD,MAAxB,CAA+BzG,MAA/B;IACD,CAHD;;IAIA,KAAKyyD,QAAL,CAAc7uD,GAAd;EACD;;AAhCkD;;AAkCrD,MAAMouD,wBAAN,SAAuCM,eAAvC,CAAuD;EACrD9+D,WAAW,CAACgvD,MAAD,EAAS7+C,KAAT,EAAgBC,GAAhB,EAAqB;IAC9B,MAAM4+C,MAAN;IACA,KAAKkQ,YAAL,GAAoB,EAApB;;IACA,KAAK,MAAM9gB,QAAX,IAAuB4Q,MAAM,CAACgL,WAA9B,EAA2C;MACzC,MAAMx6D,KAAK,GAAGwvD,MAAM,CAACgL,WAAP,CAAmB5b,QAAnB,CAAd;;MACA,IAAI5+C,KAAK,KAAKiB,SAAd,EAAyB;QACvB;MACD;;MACD,KAAKy+D,YAAL,CAAkB9gB,QAAlB,IAA8B5+C,KAA9B;IACD;;IACD,KAAK0/D,YAAL,CAAkBC,KAAlB,GAA2B,SAAQhvD,KAAM,IAAGC,GAAG,GAAG,CAAE,EAApD;;IACA,MAAM2uD,cAAc,GAAGvsD,QAAQ,IAAI;MACjC,IAAIA,QAAQ,CAACwsD,UAAT,KAAwB,GAA5B,EAAiC;QAC/B,MAAMjgD,KAAK,GAAG,IAAIpyB,mBAAJ,CAAyB,gBAAe,KAAKywE,IAAK,IAAlD,CAAd;QACA,KAAKI,YAAL,GAAoBz+C,KAApB;QACA;MACD;;MACD,KAAK6/C,kBAAL,CAAwBpsD,QAAxB;IACD,CAPD;;IAQA,KAAKysD,QAAL,GAAgBf,aAAa,CAAC,KAAKd,IAAN,EAAY,KAAK8B,YAAjB,EAA+BH,cAA/B,CAA7B;;IACA,KAAKE,QAAL,CAAcv2C,EAAd,CAAiB,OAAjB,EAA0Blc,MAAM,IAAI;MAClC,KAAKgxD,YAAL,GAAoBhxD,MAApB;IACD,CAFD;;IAGA,KAAKyyD,QAAL,CAAc7uD,GAAd;EACD;;AAzBoD;;AA2BvD,MAAMiuD,yBAAN,SAAwCI,cAAxC,CAAuD;EACrDz+D,WAAW,CAACgvD,MAAD,EAAS;IAClB,MAAMA,MAAN;IACA,MAAM3jB,EAAE,GAAGI,YAAY,CAACxgD,GAAb,CAAiB,IAAjB,CAAX;IACAogD,EAAE,CAACM,QAAH,CAAYyzB,KAAZ,CAAkB,KAAKhC,IAAvB,EAA6BxpD,IAA7B,CAAkCyrD,IAAI,IAAI;MACxC,KAAK3K,cAAL,GAAsB2K,IAAI,CAAC9tD,IAA3B;;MACA,KAAKqtD,kBAAL,CAAwBvzB,EAAE,CAACi0B,gBAAH,CAAoB,KAAKlC,IAAzB,CAAxB;;MACA,KAAK3C,kBAAL,CAAwBznD,OAAxB;IACD,CAJD,EAIG+L,KAAK,IAAI;MACV,IAAIA,KAAK,CAAC7e,IAAN,KAAe,QAAnB,EAA6B;QAC3B6e,KAAK,GAAG,IAAIpyB,mBAAJ,CAAyB,gBAAe,KAAKywE,IAAK,IAAlD,CAAR;MACD;;MACD,KAAKI,YAAL,GAAoBz+C,KAApB;;MACA,KAAK07C,kBAAL,CAAwBxnD,MAAxB,CAA+B8L,KAA/B;IACD,CAVD;EAWD;;AAfoD;;AAiBvD,MAAMw/C,0BAAN,SAAyCO,eAAzC,CAAyD;EACvD9+D,WAAW,CAACgvD,MAAD,EAAS7+C,KAAT,EAAgBC,GAAhB,EAAqB;IAC9B,MAAM4+C,MAAN;IACA,MAAM3jB,EAAE,GAAGI,YAAY,CAACxgD,GAAb,CAAiB,IAAjB,CAAX;;IACA,KAAK2zE,kBAAL,CAAwBvzB,EAAE,CAACi0B,gBAAH,CAAoB,KAAKlC,IAAzB,EAA+B;MACrDjtD,KADqD;MAErDC,GAAG,EAAEA,GAAG,GAAG;IAF0C,CAA/B,CAAxB;EAID;;AARsD;;AAWzD,C,CAAC;;AAGD,MAAMmvD,uBAAuB,GAAG,MAAhC;AACA,MAAMC,iBAAiB,GAAG,EAA1B;AACA,MAAMC,mBAAmB,GAAG,GAA5B;;AACA,MAAMryE,SAAN,CAAgB;EACd,CAAC8hE,UAAD,GAAcn8C,OAAO,CAACm4B,aAAR,EAAd;EACA,CAACrmB,SAAD,GAAa,IAAb;EACA,CAAC66C,mBAAD,GAAuB,KAAvB;EACA,CAACC,oBAAD,GAAwB,CAAC,CAACn0E,UAAU,CAACo0E,aAAX,EAA0BxpC,OAApD;EACA,CAACypC,IAAD,GAAQ,IAAR;EACA,CAACC,gBAAD,GAAoB,IAApB;EACA,CAAC5qD,UAAD,GAAc,CAAd;EACA,CAACD,SAAD,GAAa,CAAb;EACA,CAAC8gD,MAAD,GAAU,IAAV;EACA,CAACgK,aAAD,GAAiB,IAAjB;EACA,CAAC3rD,QAAD,GAAY,CAAZ;EACA,CAACD,KAAD,GAAS,CAAT;EACA,CAAC6rD,UAAD,GAAcl1E,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAd;EACA,CAACi+D,mBAAD,GAAuB,EAAvB;EACA,CAACC,iBAAD,GAAqB,IAArB;EACA,CAACC,QAAD,GAAY,EAAZ;EACA,CAACC,iBAAD,GAAqB,IAAIC,OAAJ,EAArB;EACA,CAAC3nE,SAAD,GAAa,IAAb;EACA,OAAO,CAAC4nE,WAAR,GAAsB,IAAIj3D,GAAJ,EAAtB;EACA,OAAO,CAACk3D,cAAR,GAAyB,IAAIl3D,GAAJ,EAAzB;EACA,OAAO,CAACm3D,WAAR,GAAsB,IAAtB;EACA,OAAO,CAACC,iBAAR,GAA4B,IAAI//C,GAAJ,EAA5B;;EACA1gB,WAAW,CAAC;IACVkgE,iBADU;IAEVr7C,SAFU;IAGV7L;EAHU,CAAD,EAIR;IACD,IAAIknD,iBAAiB,YAAYpQ,cAAjC,EAAiD;MAC/C,KAAK,CAACoQ,iBAAN,GAA0BA,iBAA1B;IACD,CAFD,MAEO,IAAI,OAAOA,iBAAP,KAA6B,QAAjC,EAA2C;MAChD,KAAK,CAACA,iBAAN,GAA0B,IAAIpQ,cAAJ,CAAmB;QAC3C3/C,KAAK,CAAC4/C,UAAD,EAAa;UAChBA,UAAU,CAACW,OAAX,CAAmBwP,iBAAnB;UACAnQ,UAAU,CAACgB,KAAX;QACD;;MAJ0C,CAAnB,CAA1B;IAMD,CAPM,MAOA;MACL,MAAM,IAAIxyD,KAAJ,CAAU,6CAAV,CAAN;IACD;;IACD,KAAK,CAACsmB,SAAN,GAAkB,KAAK,CAACk7C,aAAN,GAAsBl7C,SAAxC;IACA,KAAK,CAAC1Q,KAAN,GAAc6E,QAAQ,CAAC7E,KAAT,IAAkB3oB,UAAU,CAAC2zD,gBAAX,IAA+B,CAAjD,CAAd;IACA,KAAK,CAAC/qC,QAAN,GAAiB4E,QAAQ,CAAC5E,QAA1B;IACA,KAAK,CAAC0rD,gBAAN,GAAyB;MACvBY,YAAY,EAAE,IADS;MAEvBC,cAAc,EAAE,IAFO;MAGvB5yD,GAAG,EAAE,IAHkB;MAIvBowC,UAAU,EAAE,IAJW;MAKvBxlC,GAAG,EAAE;IALkB,CAAzB;IAOA,MAAM;MACJ1D,SADI;MAEJC,UAFI;MAGJC,KAHI;MAIJC;IAJI,IAKF4D,QAAQ,CAAChE,OALb;IAMA,KAAK,CAACtc,SAAN,GAAkB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAC,CAAX,EAAc,CAACyc,KAAf,EAAsBC,KAAK,GAAGF,UAA9B,CAAlB;IACA,KAAK,CAACD,SAAN,GAAkBA,SAAlB;IACA,KAAK,CAACC,UAAN,GAAmBA,UAAnB;IACA9nB,SAAS,CAAC,CAACwzE,yBAAX;IACAxyE,kBAAkB,CAACy2B,SAAD,EAAY7L,QAAZ,CAAlB;IACA,KAAK,CAACk2C,UAAN,CAAiBtxC,OAAjB,CAAyBrR,KAAzB,CAA+B,MAAM,CAAE,CAAvC,EAAyCqH,IAAzC,CAA8C,MAAM;MAClDxmB,SAAS,CAAC,CAACqzE,iBAAX,CAA6BzkD,MAA7B,CAAoC,IAApC;MACA,KAAK,CAAC8jD,gBAAN,GAAyB,IAAzB;MACA,KAAK,CAACE,UAAN,GAAmB,IAAnB;IACD,CAJD;EAKD;;EACD5lD,MAAM,GAAG;IACP,MAAMymD,IAAI,GAAG,MAAM;MACjB,KAAK,CAAC9K,MAAN,CAAamB,IAAb,GAAoBtjD,IAApB,CAAyB,CAAC;QACxBpU,KADwB;QAExBgpC;MAFwB,CAAD,KAGnB;QACJ,IAAIA,IAAJ,EAAU;UACR,KAAK,CAAC0mB,UAAN,CAAiBl8C,OAAjB;UACA;QACD;;QACD,KAAK,CAAC6sD,IAAN,KAAergE,KAAK,CAACqgE,IAArB;QACA/0E,MAAM,CAACwjC,MAAP,CAAc,KAAK,CAAC0xC,UAApB,EAAgCxgE,KAAK,CAACshE,MAAtC;QACA,KAAK,CAACC,YAAN,CAAmBvhE,KAAK,CAACutB,KAAzB;QACA8zC,IAAI;MACL,CAZD,EAYG,KAAK,CAAC3R,UAAN,CAAiBj8C,MAZpB;IAaD,CAdD;;IAeA,KAAK,CAAC8iD,MAAN,GAAe,KAAK,CAACmK,iBAAN,CAAwBpF,SAAxB,EAAf;IACA1tE,SAAS,CAAC,CAACqzE,iBAAX,CAA6BhlD,GAA7B,CAAiC,IAAjC;IACAolD,IAAI;IACJ,OAAO,KAAK,CAAC3R,UAAN,CAAiBtxC,OAAxB;EACD;;EACDwlB,MAAM,CAAC;IACLpqB,QADK;IAELgoD,QAAQ,GAAG;EAFN,CAAD,EAGH;IACD,MAAM7sD,KAAK,GAAG6E,QAAQ,CAAC7E,KAAT,IAAkB3oB,UAAU,CAAC2zD,gBAAX,IAA+B,CAAjD,CAAd;IACA,MAAM/qC,QAAQ,GAAG4E,QAAQ,CAAC5E,QAA1B;;IACA,IAAIA,QAAQ,KAAK,KAAK,CAACA,QAAvB,EAAiC;MAC/B4sD,QAAQ;MACR,KAAK,CAAC5sD,QAAN,GAAiBA,QAAjB;MACAhmB,kBAAkB,CAAC,KAAK,CAAC2xE,aAAP,EAAsB;QACtC3rD;MADsC,CAAtB,CAAlB;IAGD;;IACD,IAAID,KAAK,KAAK,KAAK,CAACA,KAApB,EAA2B;MACzB6sD,QAAQ;MACR,KAAK,CAAC7sD,KAAN,GAAcA,KAAd;MACA,MAAM2d,MAAM,GAAG;QACb4uC,YAAY,EAAE,IADD;QAEbC,cAAc,EAAE,IAFH;QAGb5yD,GAAG,EAAE,IAHQ;QAIbowC,UAAU,EAAE,IAJC;QAKbxlC,GAAG,EAAEvrB,SAAS,CAAC,CAAC6zE,MAAX,CAAkB,KAAK,CAACpB,IAAxB;MALQ,CAAf;;MAOA,KAAK,MAAM9xD,GAAX,IAAkB,KAAK,CAACoyD,QAAxB,EAAkC;QAChCruC,MAAM,CAACqsB,UAAP,GAAoB,KAAK,CAACiiB,iBAAN,CAAwBn1E,GAAxB,CAA4B8iB,GAA5B,CAApB;QACA+jB,MAAM,CAAC/jB,GAAP,GAAaA,GAAb;QACA,KAAK,CAACmzD,MAAN,CAAapvC,MAAb;MACD;IACF;EACF;;EACDqE,MAAM,GAAG;IACP,MAAMgrC,OAAO,GAAG,IAAIz1E,cAAJ,CAAmB,2BAAnB,CAAhB;IACA,KAAK,CAACqqE,MAAN,EAAc5/B,MAAd,CAAqBgrC,OAArB,EAA8B50D,KAA9B,CAAoC,MAAM,CAAE,CAA5C;IACA,KAAK,CAACwpD,MAAN,GAAe,IAAf;IACA,KAAK,CAAC7G,UAAN,CAAiBj8C,MAAjB,CAAwBkuD,OAAxB;EACD;;EACW,IAARhB,QAAQ,GAAG;IACb,OAAO,KAAK,CAACA,QAAb;EACD;;EACsB,IAAnBF,mBAAmB,GAAG;IACxB,OAAO,KAAK,CAACA,mBAAb;EACD;;EACD,CAACc,YAAY,CAACh0C,KAAD,EAAQ;IACnB,IAAI,KAAK,CAAC2yC,mBAAV,EAA+B;MAC7B;IACD;;IACD,KAAK,CAACI,gBAAN,CAAuBnnD,GAAvB,KAA+BvrB,SAAS,CAAC,CAAC6zE,MAAX,CAAkB,KAAK,CAACpB,IAAxB,CAA/B;IACA,MAAMM,QAAQ,GAAG,KAAK,CAACA,QAAvB;IAAA,MACEF,mBAAmB,GAAG,KAAK,CAACA,mBAD9B;;IAEA,KAAK,MAAM/yC,IAAX,IAAmBH,KAAnB,EAA0B;MACxB,IAAIozC,QAAQ,CAAChhE,MAAT,GAAkBogE,uBAAtB,EAA+C;QAC7ClhE,IAAI,CAAC,uDAAD,CAAJ;QACA,KAAK,CAACqhE,mBAAN,GAA4B,IAA5B;QACA;MACD;;MACD,IAAIxyC,IAAI,CAAC1rB,GAAL,KAAaf,SAAjB,EAA4B;QAC1B,IAAIysB,IAAI,CAACt+B,IAAL,KAAc,yBAAd,IAA2Cs+B,IAAI,CAACt+B,IAAL,KAAc,oBAA7D,EAAmF;UACjF,MAAMmuB,MAAM,GAAG,KAAK,CAAC8H,SAArB;UACA,KAAK,CAACA,SAAN,GAAkBrX,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAAlB;UACA,KAAK,CAAC6X,SAAN,CAAgBrJ,SAAhB,CAA0BC,GAA1B,CAA8B,eAA9B;;UACA,IAAIyR,IAAI,CAACxf,EAAL,KAAY,IAAhB,EAAsB;YACpB,KAAK,CAACmX,SAAN,CAAgB9X,YAAhB,CAA6B,IAA7B,EAAoC,GAAEmgB,IAAI,CAACxf,EAAG,EAA9C;UACD;;UACDqP,MAAM,CAACvO,MAAP,CAAc,KAAK,CAACqW,SAApB;QACD,CARD,MAQO,IAAIqI,IAAI,CAACt+B,IAAL,KAAc,kBAAlB,EAAsC;UAC3C,KAAK,CAACi2B,SAAN,GAAkB,KAAK,CAACA,SAAN,CAAgBrT,UAAlC;QACD;;QACD;MACD;;MACDyuD,mBAAmB,CAAC5+D,IAApB,CAAyB6rB,IAAI,CAAC1rB,GAA9B;MACA,KAAK,CAAC4/D,UAAN,CAAiBl0C,IAAjB;IACD;EACF;;EACD,CAACk0C,UAAU,CAACC,IAAD,EAAO;IAChB,MAAMC,OAAO,GAAG9zD,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAAhB;IACA,MAAMozD,iBAAiB,GAAG;MACxBrkC,KAAK,EAAE,CADiB;MAExByvB,WAAW,EAAE,CAFW;MAGxB+V,OAAO,EAAEF,IAAI,CAAC7/D,GAAL,KAAa,EAHE;MAIxBggE,MAAM,EAAEH,IAAI,CAACG,MAJW;MAKxBzmB,QAAQ,EAAE;IALc,CAA1B;IAOA,KAAK,CAAColB,QAAN,CAAe9+D,IAAf,CAAoBigE,OAApB;IACA,MAAMruC,EAAE,GAAG3lC,IAAI,CAACoL,SAAL,CAAe,KAAK,CAACA,SAArB,EAAgC2oE,IAAI,CAAC3oE,SAArC,CAAX;IACA,IAAIqjC,KAAK,GAAG96B,IAAI,CAACwgE,KAAL,CAAWxuC,EAAE,CAAC,CAAD,CAAb,EAAkBA,EAAE,CAAC,CAAD,CAApB,CAAZ;IACA,MAAMjlB,KAAK,GAAG,KAAK,CAACgyD,UAAN,CAAiBqB,IAAI,CAACK,QAAtB,CAAd;;IACA,IAAI1zD,KAAK,CAACm6C,QAAV,EAAoB;MAClBpsB,KAAK,IAAI96B,IAAI,CAACnK,EAAL,GAAU,CAAnB;IACD;;IACD,MAAMizC,UAAU,GAAG,KAAK,CAAC41B,oBAAN,IAA8B3xD,KAAK,CAAC2zD,gBAApC,IAAwD3zD,KAAK,CAAC+7B,UAAjF;IACA,MAAM63B,UAAU,GAAG3gE,IAAI,CAACi+B,KAAL,CAAWjM,EAAE,CAAC,CAAD,CAAb,EAAkBA,EAAE,CAAC,CAAD,CAApB,CAAnB;IACA,MAAM4uC,UAAU,GAAGD,UAAU,GAAGx0E,SAAS,CAAC,CAAC00E,SAAX,CAAqB/3B,UAArB,EAAiC,KAAK,CAAC81B,IAAvC,CAAhC;IACA,IAAIxxD,IAAJ,EAAUD,GAAV;;IACA,IAAI2tB,KAAK,KAAK,CAAd,EAAiB;MACf1tB,IAAI,GAAG4kB,EAAE,CAAC,CAAD,CAAT;MACA7kB,GAAG,GAAG6kB,EAAE,CAAC,CAAD,CAAF,GAAQ4uC,UAAd;IACD,CAHD,MAGO;MACLxzD,IAAI,GAAG4kB,EAAE,CAAC,CAAD,CAAF,GAAQ4uC,UAAU,GAAG5gE,IAAI,CAAC8gE,GAAL,CAAShmC,KAAT,CAA5B;MACA3tB,GAAG,GAAG6kB,EAAE,CAAC,CAAD,CAAF,GAAQ4uC,UAAU,GAAG5gE,IAAI,CAAC+gE,GAAL,CAASjmC,KAAT,CAA3B;IACD;;IACD,MAAMkmC,cAAc,GAAG,2BAAvB;IACA,MAAMC,QAAQ,GAAGZ,OAAO,CAACtzD,KAAzB;;IACA,IAAI,KAAK,CAAC6W,SAAN,KAAoB,KAAK,CAACk7C,aAA9B,EAA6C;MAC3CmC,QAAQ,CAAC7zD,IAAT,GAAiB,GAAE,CAAC,MAAMA,IAAN,GAAa,KAAK,CAAC4G,SAApB,EAA+BymB,OAA/B,CAAuC,CAAvC,CAA0C,GAA7D;MACAwmC,QAAQ,CAAC9zD,GAAT,GAAgB,GAAE,CAAC,MAAMA,GAAN,GAAY,KAAK,CAAC8G,UAAnB,EAA+BwmB,OAA/B,CAAuC,CAAvC,CAA0C,GAA5D;IACD,CAHD,MAGO;MACLwmC,QAAQ,CAAC7zD,IAAT,GAAiB,GAAE4zD,cAAe,GAAE5zD,IAAI,CAACqtB,OAAL,CAAa,CAAb,CAAgB,KAApD;MACAwmC,QAAQ,CAAC9zD,GAAT,GAAgB,GAAE6zD,cAAe,GAAE7zD,GAAG,CAACstB,OAAJ,CAAY,CAAZ,CAAe,KAAlD;IACD;;IACDwmC,QAAQ,CAACnnB,QAAT,GAAqB,GAAEknB,cAAe,GAAE,CAAC70E,SAAS,CAAC,CAACozE,WAAX,GAAyBoB,UAA1B,EAAsClmC,OAAtC,CAA8C,CAA9C,CAAiD,KAAzF;IACAwmC,QAAQ,CAACn4B,UAAT,GAAsBA,UAAtB;IACAq2B,iBAAiB,CAACrlB,QAAlB,GAA6B6mB,UAA7B;IACAN,OAAO,CAACv0D,YAAR,CAAqB,MAArB,EAA6B,cAA7B;IACAu0D,OAAO,CAAChsC,WAAR,GAAsB+rC,IAAI,CAAC7/D,GAA3B;IACA8/D,OAAO,CAACa,GAAR,GAAcd,IAAI,CAACc,GAAnB;;IACA,IAAI,KAAK,CAACxC,oBAAV,EAAgC;MAC9B2B,OAAO,CAACc,OAAR,CAAgBV,QAAhB,GAA2B1zD,KAAK,CAACq0D,0BAAN,IAAoChB,IAAI,CAACK,QAApE;IACD;;IACD,IAAI3lC,KAAK,KAAK,CAAd,EAAiB;MACfqkC,iBAAiB,CAACrkC,KAAlB,GAA0BA,KAAK,IAAI,MAAM96B,IAAI,CAACnK,EAAf,CAA/B;IACD;;IACD,IAAIwrE,eAAe,GAAG,KAAtB;;IACA,IAAIjB,IAAI,CAAC7/D,GAAL,CAASrC,MAAT,GAAkB,CAAtB,EAAyB;MACvBmjE,eAAe,GAAG,IAAlB;IACD,CAFD,MAEO,IAAIjB,IAAI,CAAC7/D,GAAL,KAAa,GAAb,IAAoB6/D,IAAI,CAAC3oE,SAAL,CAAe,CAAf,MAAsB2oE,IAAI,CAAC3oE,SAAL,CAAe,CAAf,CAA9C,EAAiE;MACtE,MAAM6pE,SAAS,GAAGthE,IAAI,CAAC+F,GAAL,CAASq6D,IAAI,CAAC3oE,SAAL,CAAe,CAAf,CAAT,CAAlB;MAAA,MACE8pE,SAAS,GAAGvhE,IAAI,CAAC+F,GAAL,CAASq6D,IAAI,CAAC3oE,SAAL,CAAe,CAAf,CAAT,CADd;;MAEA,IAAI6pE,SAAS,KAAKC,SAAd,IAA2BvhE,IAAI,CAAC2D,GAAL,CAAS29D,SAAT,EAAoBC,SAApB,IAAiCvhE,IAAI,CAACC,GAAL,CAASqhE,SAAT,EAAoBC,SAApB,CAAjC,GAAkE,GAAjG,EAAsG;QACpGF,eAAe,GAAG,IAAlB;MACD;IACF;;IACD,IAAIA,eAAJ,EAAqB;MACnBlC,iBAAiB,CAAC5U,WAAlB,GAAgCx9C,KAAK,CAACm6C,QAAN,GAAiBkZ,IAAI,CAAC31D,MAAtB,GAA+B21D,IAAI,CAAC51D,KAApE;IACD;;IACD,KAAK,CAAC20D,iBAAN,CAAwB5wD,GAAxB,CAA4B8xD,OAA5B,EAAqClB,iBAArC;IACA,KAAK,CAACN,gBAAN,CAAuB/xD,GAAvB,GAA6BuzD,OAA7B;IACA,KAAK,CAACxB,gBAAN,CAAuB3hB,UAAvB,GAAoCiiB,iBAApC;IACA,KAAK,CAACc,MAAN,CAAa,KAAK,CAACpB,gBAAnB;;IACA,IAAIM,iBAAiB,CAACmB,OAAtB,EAA+B;MAC7B,KAAK,CAAC18C,SAAN,CAAgBrW,MAAhB,CAAuB8yD,OAAvB;IACD;;IACD,IAAIlB,iBAAiB,CAACoB,MAAtB,EAA8B;MAC5B,MAAMiB,EAAE,GAAGj1D,QAAQ,CAACR,aAAT,CAAuB,IAAvB,CAAX;MACAy1D,EAAE,CAAC11D,YAAH,CAAgB,MAAhB,EAAwB,cAAxB;MACA,KAAK,CAAC8X,SAAN,CAAgBrW,MAAhB,CAAuBi0D,EAAvB;IACD;EACF;;EACD,CAACvB,MAAM,CAACpvC,MAAD,EAAS;IACd,MAAM;MACJ/jB,GADI;MAEJowC,UAFI;MAGJxlC,GAHI;MAIJ+nD,YAJI;MAKJC;IALI,IAMF7uC,MANJ;IAOA,MAAM;MACJ9jB;IADI,IAEFD,GAFJ;IAGA,IAAIrV,SAAS,GAAG,EAAhB;;IACA,IAAItL,SAAS,CAAC,CAACozE,WAAX,GAAyB,CAA7B,EAAgC;MAC9B9nE,SAAS,GAAI,SAAQ,IAAItL,SAAS,CAAC,CAACozE,WAAY,GAAhD;IACD;;IACD,IAAIriB,UAAU,CAACqN,WAAX,KAA2B,CAA3B,IAAgCrN,UAAU,CAACojB,OAA/C,EAAwD;MACtD,MAAM;QACJx3B;MADI,IAEF/7B,KAFJ;MAGA,MAAM;QACJw9C,WADI;QAEJzQ;MAFI,IAGFoD,UAHJ;;MAIA,IAAIuiB,YAAY,KAAK3lB,QAAjB,IAA6B4lB,cAAc,KAAK52B,UAApD,EAAgE;QAC9DpxB,GAAG,CAAC+uB,IAAJ,GAAY,GAAEqT,QAAQ,GAAG,KAAK,CAAC5mC,KAAM,MAAK41B,UAAW,EAArD;QACAjY,MAAM,CAAC4uC,YAAP,GAAsB3lB,QAAtB;QACAjpB,MAAM,CAAC6uC,cAAP,GAAwB52B,UAAxB;MACD;;MACD,MAAM;QACJt+B;MADI,IAEFkN,GAAG,CAAC6wC,WAAJ,CAAgBz7C,GAAG,CAACunB,WAApB,CAFJ;;MAGA,IAAI7pB,KAAK,GAAG,CAAZ,EAAe;QACb/S,SAAS,GAAI,UAAS8yD,WAAW,GAAG,KAAK,CAACr3C,KAApB,GAA4B1I,KAAM,KAAI/S,SAAU,EAAtE;MACD;IACF;;IACD,IAAIylD,UAAU,CAACpiB,KAAX,KAAqB,CAAzB,EAA4B;MAC1BrjC,SAAS,GAAI,UAASylD,UAAU,CAACpiB,KAAM,QAAOrjC,SAAU,EAAxD;IACD;;IACD,IAAIA,SAAS,CAACyG,MAAV,GAAmB,CAAvB,EAA0B;MACxB6O,KAAK,CAACtV,SAAN,GAAkBA,SAAlB;IACD;EACF;;EACa,OAAPgqE,OAAO,GAAG;IACf,IAAI,KAAK,CAACjC,iBAAN,CAAwBlvD,IAAxB,GAA+B,CAAnC,EAAsC;MACpC;IACD;;IACD,KAAK,CAAC+uD,WAAN,CAAkB7uD,KAAlB;;IACA,KAAK,MAAM;MACT9F;IADS,CAAX,IAEK,KAAK,CAAC40D,cAAN,CAAqB/4C,MAArB,EAFL,EAEoC;MAClC7b,MAAM,CAACiE,MAAP;IACD;;IACD,KAAK,CAAC2wD,cAAN,CAAqB9uD,KAArB;EACD;;EACa,OAAP,CAACwvD,MAAM,CAACpB,IAAI,GAAG,IAAR,EAAc;IAC1B,IAAI8C,aAAa,GAAG,KAAK,CAACpC,cAAN,CAAqBt1E,GAArB,CAAyB40E,IAAI,KAAK,EAAlC,CAApB;;IACA,IAAI,CAAC8C,aAAL,EAAoB;MAClB,MAAMh3D,MAAM,GAAG6B,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAf;MACArB,MAAM,CAAC2O,SAAP,GAAmB,qBAAnB;MACA3O,MAAM,CAACk0D,IAAP,GAAcA,IAAd;MACAryD,QAAQ,CAACiB,IAAT,CAAcD,MAAd,CAAqB7C,MAArB;MACAg3D,aAAa,GAAGh3D,MAAM,CAACG,UAAP,CAAkB,IAAlB,EAAwB;QACtC82D,KAAK,EAAE,KAD+B;QAEtC72D,kBAAkB,EAAE;MAFkB,CAAxB,CAAhB;MAIA,KAAK,CAACw0D,cAAN,CAAqB/wD,GAArB,CAAyBqwD,IAAzB,EAA+B8C,aAA/B;IACD;;IACD,OAAOA,aAAP;EACD;;EACgC,OAA1B,CAAC/B,yBAAyB,GAAG;IAClC,IAAI,KAAK,CAACJ,WAAN,KAAsB,IAA1B,EAAgC;MAC9B;IACD;;IACD,MAAMzyD,GAAG,GAAGP,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAZ;IACAe,GAAG,CAACC,KAAJ,CAAUoP,OAAV,GAAoB,CAApB;IACArP,GAAG,CAACC,KAAJ,CAAU60D,UAAV,GAAuB,CAAvB;IACA90D,GAAG,CAACC,KAAJ,CAAU+sC,QAAV,GAAqB,KAArB;IACAhtC,GAAG,CAACC,KAAJ,CAAUG,QAAV,GAAqB,UAArB;IACAJ,GAAG,CAACunB,WAAJ,GAAkB,GAAlB;IACA9nB,QAAQ,CAACiB,IAAT,CAAcD,MAAd,CAAqBT,GAArB;IACA,KAAK,CAACyyD,WAAN,GAAoBzyD,GAAG,CAACsb,qBAAJ,GAA4B3d,MAAhD;IACAqC,GAAG,CAAC6B,MAAJ;EACD;;EACgB,OAAV,CAACkyD,SAAS,CAAC/3B,UAAD,EAAa81B,IAAb,EAAmB;IAClC,MAAMiD,YAAY,GAAG,KAAK,CAACxC,WAAN,CAAkBr1E,GAAlB,CAAsB8+C,UAAtB,CAArB;;IACA,IAAI+4B,YAAJ,EAAkB;MAChB,OAAOA,YAAP;IACD;;IACD,MAAMnqD,GAAG,GAAG,KAAK,CAACsoD,MAAN,CAAapB,IAAb,CAAZ;IACA,MAAMkD,SAAS,GAAGpqD,GAAG,CAAC+uB,IAAtB;IACA/uB,GAAG,CAAChN,MAAJ,CAAWF,KAAX,GAAmBkN,GAAG,CAAChN,MAAJ,CAAWD,MAAX,GAAoB8zD,iBAAvC;IACA7mD,GAAG,CAAC+uB,IAAJ,GAAY,GAAE83B,iBAAkB,MAAKz1B,UAAW,EAAhD;IACA,MAAMi5B,OAAO,GAAGrqD,GAAG,CAAC6wC,WAAJ,CAAgB,EAAhB,CAAhB;IACA,IAAIyZ,MAAM,GAAGD,OAAO,CAACE,qBAArB;IACA,IAAIC,OAAO,GAAGliE,IAAI,CAAC+F,GAAL,CAASg8D,OAAO,CAACI,sBAAjB,CAAd;;IACA,IAAIH,MAAJ,EAAY;MACV,MAAMI,KAAK,GAAGJ,MAAM,IAAIA,MAAM,GAAGE,OAAb,CAApB;MACA,KAAK,CAAC7C,WAAN,CAAkB9wD,GAAlB,CAAsBu6B,UAAtB,EAAkCs5B,KAAlC;MACA1qD,GAAG,CAAChN,MAAJ,CAAWF,KAAX,GAAmBkN,GAAG,CAAChN,MAAJ,CAAWD,MAAX,GAAoB,CAAvC;MACAiN,GAAG,CAAC+uB,IAAJ,GAAWq7B,SAAX;MACA,OAAOM,KAAP;IACD;;IACD1qD,GAAG,CAAC27B,WAAJ,GAAkB,KAAlB;IACA37B,GAAG,CAAC01B,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoBmxB,iBAApB,EAAuCA,iBAAvC;IACA7mD,GAAG,CAACmvC,UAAJ,CAAe,GAAf,EAAoB,CAApB,EAAuB,CAAvB;IACA,IAAIwb,MAAM,GAAG3qD,GAAG,CAACmF,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB0hD,iBAAvB,EAA0CA,iBAA1C,EAA6D3rD,IAA1E;IACAsvD,OAAO,GAAG,CAAV;;IACA,KAAK,IAAIpiE,CAAC,GAAGuiE,MAAM,CAACnkE,MAAP,GAAgB,CAAhB,GAAoB,CAAjC,EAAoC4B,CAAC,IAAI,CAAzC,EAA4CA,CAAC,IAAI,CAAjD,EAAoD;MAClD,IAAIuiE,MAAM,CAACviE,CAAD,CAAN,GAAY,CAAhB,EAAmB;QACjBoiE,OAAO,GAAGliE,IAAI,CAAC+sC,IAAL,CAAUjtC,CAAC,GAAG,CAAJ,GAAQy+D,iBAAlB,CAAV;QACA;MACD;IACF;;IACD7mD,GAAG,CAAC01B,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoBmxB,iBAApB,EAAuCA,iBAAvC;IACA7mD,GAAG,CAACmvC,UAAJ,CAAe,GAAf,EAAoB,CAApB,EAAuB0X,iBAAvB;IACA8D,MAAM,GAAG3qD,GAAG,CAACmF,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB0hD,iBAAvB,EAA0CA,iBAA1C,EAA6D3rD,IAAtE;IACAovD,MAAM,GAAG,CAAT;;IACA,KAAK,IAAIliE,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGu7D,MAAM,CAACnkE,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;MAClD,IAAIuiE,MAAM,CAACviE,CAAD,CAAN,GAAY,CAAhB,EAAmB;QACjBkiE,MAAM,GAAGzD,iBAAiB,GAAGv+D,IAAI,CAAC4I,KAAL,CAAW9I,CAAC,GAAG,CAAJ,GAAQy+D,iBAAnB,CAA7B;QACA;MACD;IACF;;IACD7mD,GAAG,CAAChN,MAAJ,CAAWF,KAAX,GAAmBkN,GAAG,CAAChN,MAAJ,CAAWD,MAAX,GAAoB,CAAvC;IACAiN,GAAG,CAAC+uB,IAAJ,GAAWq7B,SAAX;IACA,MAAMM,KAAK,GAAGJ,MAAM,GAAGA,MAAM,IAAIA,MAAM,GAAGE,OAAb,CAAT,GAAiC1D,mBAArD;IACA,KAAK,CAACa,WAAN,CAAkB9wD,GAAlB,CAAsBu6B,UAAtB,EAAkCs5B,KAAlC;IACA,OAAOA,KAAP;EACD;;AA3Wa;;AA8WhB,C,CAAC;;AACD,MAAME,OAAN,CAAc;EACM,OAAXjuC,WAAW,CAACkuC,GAAD,EAAM;IACtB,MAAMz2C,KAAK,GAAG,EAAd;IACA,MAAM02C,MAAM,GAAG;MACb12C,KADa;MAEb+zC,MAAM,EAAEh2E,MAAM,CAACkX,MAAP,CAAc,IAAd;IAFK,CAAf;;IAIA,SAAS0hE,IAAT,CAAcC,IAAd,EAAoB;MAClB,IAAI,CAACA,IAAL,EAAW;QACT;MACD;;MACD,IAAIniE,GAAG,GAAG,IAAV;MACA,MAAMzB,IAAI,GAAG4jE,IAAI,CAAC5jE,IAAlB;;MACA,IAAIA,IAAI,KAAK,OAAb,EAAsB;QACpByB,GAAG,GAAGmiE,IAAI,CAACnkE,KAAX;MACD,CAFD,MAEO,IAAI,CAAC+jE,OAAO,CAACK,eAAR,CAAwB7jE,IAAxB,CAAL,EAAoC;QACzC;MACD,CAFM,MAEA,IAAI4jE,IAAI,EAAExrD,UAAN,EAAkBmd,WAAtB,EAAmC;QACxC9zB,GAAG,GAAGmiE,IAAI,CAACxrD,UAAL,CAAgBmd,WAAtB;MACD,CAFM,MAEA,IAAIquC,IAAI,CAACnkE,KAAT,EAAgB;QACrBgC,GAAG,GAAGmiE,IAAI,CAACnkE,KAAX;MACD;;MACD,IAAIgC,GAAG,KAAK,IAAZ,EAAkB;QAChBurB,KAAK,CAAC1rB,IAAN,CAAW;UACTG;QADS,CAAX;MAGD;;MACD,IAAI,CAACmiE,IAAI,CAACviC,QAAV,EAAoB;QAClB;MACD;;MACD,KAAK,MAAM9K,KAAX,IAAoBqtC,IAAI,CAACviC,QAAzB,EAAmC;QACjCsiC,IAAI,CAACptC,KAAD,CAAJ;MACD;IACF;;IACDotC,IAAI,CAACF,GAAD,CAAJ;IACA,OAAOC,MAAP;EACD;;EACqB,OAAfG,eAAe,CAAC7jE,IAAD,EAAO;IAC3B,OAAO,EAAEA,IAAI,KAAK,UAAT,IAAuBA,IAAI,KAAK,OAAhC,IAA2CA,IAAI,KAAK,QAApD,IAAgEA,IAAI,KAAK,QAA3E,CAAP;EACD;;AAvCW;;AA0Cd,C,CAAC;;AAiBD,MAAM8jE,wBAAwB,GAAG,KAAjC;AACA,MAAMC,2BAA2B,GAAG,GAApC;AACA,MAAMC,uBAAuB,GAAG,IAAhC;AACA,MAAMC,oBAAoB,GAAGz1E,QAAQ,GAAGu9C,iBAAH,GAAuBz5B,gBAA5D;AACA,MAAM4xD,wBAAwB,GAAG11E,QAAQ,GAAGy9C,qBAAH,GAA2Br4B,oBAApE;AACA,MAAMuwD,oBAAoB,GAAG31E,QAAQ,GAAGs9C,iBAAH,GAAuBz+B,gBAA5D;AACA,MAAM+2D,8BAA8B,GAAG51E,QAAQ,GAAG09C,2BAAH,GAAiCj4B,0BAAhF;;AACA,SAASpmB,WAAT,CAAqB+vB,GAAG,GAAG,EAA3B,EAA+B;EAC7B,IAAI,OAAOA,GAAP,KAAe,QAAf,IAA2BA,GAAG,YAAYpe,GAA9C,EAAmD;IACjDoe,GAAG,GAAG;MACJhf,GAAG,EAAEgf;IADD,CAAN;EAGD,CAJD,MAIO,IAAIA,GAAG,YAAY5J,WAAf,IAA8BA,WAAW,CAACsvB,MAAZ,CAAmB1lB,GAAnB,CAAlC,EAA2D;IAChEA,GAAG,GAAG;MACJ9J,IAAI,EAAE8J;IADF,CAAN;EAGD;;EACD,MAAMymD,IAAI,GAAG,IAAIC,sBAAJ,EAAb;EACA,MAAM;IACJ92D;EADI,IAEF62D,IAFJ;EAGA,MAAMzlE,GAAG,GAAGgf,GAAG,CAAChf,GAAJ,GAAU2lE,UAAU,CAAC3mD,GAAG,CAAChf,GAAL,CAApB,GAAgC,IAA5C;EACA,MAAMkV,IAAI,GAAG8J,GAAG,CAAC9J,IAAJ,GAAW0wD,WAAW,CAAC5mD,GAAG,CAAC9J,IAAL,CAAtB,GAAmC,IAAhD;EACA,MAAMmmD,WAAW,GAAGr8C,GAAG,CAACq8C,WAAJ,IAAmB,IAAvC;EACA,MAAML,eAAe,GAAGh8C,GAAG,CAACg8C,eAAJ,KAAwB,IAAhD;EACA,MAAM6K,QAAQ,GAAG7mD,GAAG,CAAC6mD,QAAJ,IAAgB,IAAjC;EACA,MAAMC,cAAc,GAAG9mD,GAAG,CAACuW,KAAJ,YAAqBrnC,qBAArB,GAA6C8wB,GAAG,CAACuW,KAAjD,GAAyD,IAAhF;EACA,MAAM+kC,cAAc,GAAGn7D,MAAM,CAACC,SAAP,CAAiB4f,GAAG,CAACs7C,cAArB,KAAwCt7C,GAAG,CAACs7C,cAAJ,GAAqB,CAA7D,GAAiEt7C,GAAG,CAACs7C,cAArE,GAAsF4K,wBAA7G;EACA,IAAIa,MAAM,GAAG/mD,GAAG,CAAC+mD,MAAJ,YAAsB33E,SAAtB,GAAkC4wB,GAAG,CAAC+mD,MAAtC,GAA+C,IAA5D;EACA,MAAM/mE,SAAS,GAAGggB,GAAG,CAAChgB,SAAtB;EACA,MAAMgnE,UAAU,GAAG,OAAOhnD,GAAG,CAACgnD,UAAX,KAA0B,QAA1B,IAAsC,CAAC32E,YAAY,CAAC2vB,GAAG,CAACgnD,UAAL,CAAnD,GAAsEhnD,GAAG,CAACgnD,UAA1E,GAAuF,IAA1G;EACA,MAAMC,OAAO,GAAG,OAAOjnD,GAAG,CAACinD,OAAX,KAAuB,QAAvB,GAAkCjnD,GAAG,CAACinD,OAAtC,GAAgD,IAAhE;EACA,MAAMC,UAAU,GAAGlnD,GAAG,CAACknD,UAAJ,KAAmB,KAAtC;EACA,MAAMC,iBAAiB,GAAGnnD,GAAG,CAACmnD,iBAAJ,IAAyBb,wBAAnD;EACA,MAAMc,mBAAmB,GAAG,OAAOpnD,GAAG,CAAConD,mBAAX,KAAmC,QAAnC,GAA8CpnD,GAAG,CAAConD,mBAAlD,GAAwE,IAApG;EACA,MAAMC,uBAAuB,GAAGrnD,GAAG,CAACqnD,uBAAJ,IAA+Bb,8BAA/D;EACA,MAAMc,YAAY,GAAGtnD,GAAG,CAACunD,YAAJ,KAAqB,IAA1C;EACA,MAAMC,YAAY,GAAGrnE,MAAM,CAACC,SAAP,CAAiB4f,GAAG,CAACwnD,YAArB,KAAsCxnD,GAAG,CAACwnD,YAAJ,GAAmB,CAAC,CAA1D,GAA8DxnD,GAAG,CAACwnD,YAAlE,GAAiF,CAAC,CAAvG;EACA,MAAM7iE,eAAe,GAAGqb,GAAG,CAACrb,eAAJ,KAAwB,KAAhD;EACA,MAAME,0BAA0B,GAAG,OAAOmb,GAAG,CAACnb,0BAAX,KAA0C,SAA1C,GAAsDmb,GAAG,CAACnb,0BAA1D,GAAuF,CAACjU,QAA3H;EACA,MAAM62E,oBAAoB,GAAGtnE,MAAM,CAACC,SAAP,CAAiB4f,GAAG,CAACynD,oBAArB,IAA6CznD,GAAG,CAACynD,oBAAjD,GAAwE,CAAC,CAAtG;EACA,MAAMh+B,eAAe,GAAG,OAAOzpB,GAAG,CAACypB,eAAX,KAA+B,SAA/B,GAA2CzpB,GAAG,CAACypB,eAA/C,GAAiE74C,QAAzF;EACA,MAAM82E,mBAAmB,GAAG1nD,GAAG,CAAC0nD,mBAAJ,KAA4B,IAAxD;EACA,MAAMC,SAAS,GAAG3nD,GAAG,CAAC2nD,SAAJ,KAAkB,IAApC;EACA,MAAM33D,aAAa,GAAGgQ,GAAG,CAAChQ,aAAJ,IAAqBniB,UAAU,CAACgiB,QAAtD;EACA,MAAMumD,YAAY,GAAGp2C,GAAG,CAACo2C,YAAJ,KAAqB,IAA1C;EACA,MAAMC,aAAa,GAAGr2C,GAAG,CAACq2C,aAAJ,KAAsB,IAA5C;EACA,MAAMuR,gBAAgB,GAAG5nD,GAAG,CAAC4nD,gBAAJ,KAAyB,IAAlD;EACA,MAAMC,MAAM,GAAG7nD,GAAG,CAAC6nD,MAAJ,KAAe,IAA9B;EACA,MAAMh6D,SAAS,GAAGmS,GAAG,CAACnS,SAAJ,KAAkB,IAApC;EACA,MAAMrM,MAAM,GAAGslE,cAAc,GAAGA,cAAc,CAACtlE,MAAlB,GAA2Bwe,GAAG,CAACxe,MAAJ,IAAc4gB,GAAtE;EACA,MAAM0lD,cAAc,GAAG,OAAO9nD,GAAG,CAAC8nD,cAAX,KAA8B,SAA9B,GAA0C9nD,GAAG,CAAC8nD,cAA9C,GAA+D,CAACl3E,QAAD,IAAa,CAAC64C,eAApG;EACA,MAAMs+B,cAAc,GAAG,OAAO/nD,GAAG,CAAC+nD,cAAX,KAA8B,SAA9B,GAA0C/nD,GAAG,CAAC+nD,cAA9C,GAA+DZ,iBAAiB,KAAKnxD,oBAAtB,IAA8CqxD,uBAAuB,KAAKhxD,0BAA1E,IAAwG4wD,OAAxG,IAAmHG,mBAAnH,IAA0IxyD,eAAe,CAACqyD,OAAD,EAAUp3D,QAAQ,CAAC2B,OAAnB,CAAzJ,IAAwLoD,eAAe,CAACwyD,mBAAD,EAAsBv3D,QAAQ,CAAC2B,OAA/B,CAA7R;EACA,MAAMopC,aAAa,GAAG56B,GAAG,CAAC46B,aAAJ,IAAqB,IAAIyrB,oBAAJ,CAAyB;IAClEr2D,aADkE;IAElEnC;EAFkE,CAAzB,CAA3C;EAIA,MAAM4X,aAAa,GAAGzF,GAAG,CAACyF,aAAJ,IAAqB,IAAI8gD,oBAAJ,CAAyB;IAClE32D,KADkE;IAElEI;EAFkE,CAAzB,CAA3C;EAIA,MAAMu4B,YAAY,GAAG,IAArB;EACAtoC,iBAAiB,CAACD,SAAD,CAAjB;EACA,MAAMgoE,gBAAgB,GAAG;IACvBptB,aADuB;IAEvBn1B;EAFuB,CAAzB;;EAIA,IAAI,CAACsiD,cAAL,EAAqB;IACnBC,gBAAgB,CAACC,iBAAjB,GAAqC,IAAId,iBAAJ,CAAsB;MACzDjmE,OAAO,EAAE+lE,OADgD;MAEzDz4D,YAAY,EAAE04D;IAF2C,CAAtB,CAArC;IAIAc,gBAAgB,CAACE,uBAAjB,GAA2C,IAAIb,uBAAJ,CAA4B;MACrEnmE,OAAO,EAAEkmE;IAD4D,CAA5B,CAA3C;EAGD;;EACD,IAAI,CAACL,MAAL,EAAa;IACX,MAAMoB,YAAY,GAAG;MACnBnoE,SADmB;MAEnByvD,IAAI,EAAE7gE,mBAAmB,CAAC8gE;IAFP,CAArB;IAIAqX,MAAM,GAAGoB,YAAY,CAAC1Y,IAAb,GAAoBrgE,SAAS,CAACg5E,QAAV,CAAmBD,YAAnB,CAApB,GAAuD,IAAI/4E,SAAJ,CAAc+4E,YAAd,CAAhE;IACA1B,IAAI,CAAC4B,OAAL,GAAetB,MAAf;EACD;;EACD,MAAMuB,SAAS,GAAG;IAChB14D,KADgB;IAEhB24D,UAAU,EAAE,QAFI;IAGhBryD,IAHgB;IAIhB2wD,QAJgB;IAKhBe,gBALgB;IAMhBtM,cANgB;IAOhB95D,MAPgB;IAQhBwlE,UARgB;IAShBW,SATgB;IAUhBa,gBAAgB,EAAE;MAChBhB,YADgB;MAEhB/9B,eAFgB;MAGhB69B,YAHgB;MAIhB3iE,eAJgB;MAKhBE,0BALgB;MAMhB4iE,oBANgB;MAOhBC,mBAPgB;MAQhBI,cARgB;MAShBb,OAAO,EAAEc,cAAc,GAAGd,OAAH,GAAa,IATpB;MAUhBG,mBAAmB,EAAEW,cAAc,GAAGX,mBAAH,GAAyB;IAV5C;EAVF,CAAlB;EAuBA,MAAMqB,eAAe,GAAG;IACtBh/B,eADsB;IAEtBi+B,mBAFsB;IAGtB13D,aAHsB;IAItB63D,MAJsB;IAKtBt/B,YALsB;IAMtBmgC,aAAa,EAAE;MACbd,gBADa;MAEbD;IAFa;EANO,CAAxB;EAWAZ,MAAM,CAAC9mD,OAAP,CAAehK,IAAf,CAAoB,YAAY;IAC9B,IAAIwwD,IAAI,CAACkC,SAAT,EAAoB;MAClB,MAAM,IAAI/nE,KAAJ,CAAU,iBAAV,CAAN;IACD;;IACD,IAAImmE,MAAM,CAAC4B,SAAX,EAAsB;MACpB,MAAM,IAAI/nE,KAAJ,CAAU,sBAAV,CAAN;IACD;;IACD,MAAMgoE,eAAe,GAAG7B,MAAM,CAAC8B,cAAP,CAAsB7W,eAAtB,CAAsC,eAAtC,EAAuDsW,SAAvD,EAAkEpyD,IAAI,GAAG,CAACA,IAAI,CAACxR,MAAN,CAAH,GAAmB,IAAzF,CAAxB;IACA,IAAIokE,aAAJ;;IACA,IAAIhC,cAAJ,EAAoB;MAClBgC,aAAa,GAAG,IAAI5S,sBAAJ,CAA2B4Q,cAA3B,EAA2C;QACzD1Q,YADyD;QAEzDC;MAFyD,CAA3C,CAAhB;IAID,CALD,MAKO,IAAI,CAACngD,IAAL,EAAW;MAChB,IAAI,CAAClV,GAAL,EAAU;QACR,MAAM,IAAIJ,KAAJ,CAAU,4CAAV,CAAN;MACD;;MACD,MAAMmoE,sBAAsB,GAAG50C,MAAM,IAAI;QACvC,IAAIvjC,QAAJ,EAAc;UACZ,MAAMo4E,gBAAgB,GAAG,YAAY;YACnC,OAAO,OAAOv6D,KAAP,KAAiB,WAAjB,IAAgC,OAAOw6D,QAAP,KAAoB,WAApD,IAAmE,UAAUA,QAAQ,CAACx7E,SAA7F;UACD,CAFD;;UAGA,OAAOu7E,gBAAgB,MAAMp0D,eAAe,CAACuf,MAAM,CAACnzB,GAAR,CAArC,GAAoD,IAAIw7D,cAAJ,CAAmBroC,MAAnB,CAApD,GAAiF,IAAIqsC,aAAJ,CAAkBrsC,MAAlB,CAAxF;QACD;;QACD,OAAOvf,eAAe,CAACuf,MAAM,CAACnzB,GAAR,CAAf,GAA8B,IAAIw7D,cAAJ,CAAmBroC,MAAnB,CAA9B,GAA2D,IAAI2qC,gBAAJ,CAAqB3qC,MAArB,CAAlE;MACD,CARD;;MASA20C,aAAa,GAAGC,sBAAsB,CAAC;QACrC/nE,GADqC;QAErCQ,MAFqC;QAGrC66D,WAHqC;QAIrCL,eAJqC;QAKrCV,cALqC;QAMrClF,YANqC;QAOrCC;MAPqC,CAAD,CAAtC;IASD;;IACD,OAAOuS,eAAe,CAAC3yD,IAAhB,CAAqBizD,QAAQ,IAAI;MACtC,IAAIzC,IAAI,CAACkC,SAAT,EAAoB;QAClB,MAAM,IAAI/nE,KAAJ,CAAU,iBAAV,CAAN;MACD;;MACD,IAAImmE,MAAM,CAAC4B,SAAX,EAAsB;QACpB,MAAM,IAAI/nE,KAAJ,CAAU,sBAAV,CAAN;MACD;;MACD,MAAMioE,cAAc,GAAG,IAAInY,cAAJ,CAAmB9gD,KAAnB,EAA0Bs5D,QAA1B,EAAoCnC,MAAM,CAACtX,IAA3C,CAAvB;MACA,MAAM0Z,SAAS,GAAG,IAAIC,eAAJ,CAAoBP,cAApB,EAAoCpC,IAApC,EAA0CqC,aAA1C,EAAyDL,eAAzD,EAA0ET,gBAA1E,CAAlB;MACAvB,IAAI,CAAC4C,UAAL,GAAkBF,SAAlB;MACAN,cAAc,CAAC9yD,IAAf,CAAoB,OAApB,EAA6B,IAA7B;IACD,CAXM,CAAP;EAYD,CAjDD,EAiDGnH,KAjDH,CAiDS63D,IAAI,CAAC6C,WAAL,CAAiBh0D,MAjD1B;EAkDA,OAAOmxD,IAAP;AACD;;AACD,SAASE,UAAT,CAAoBv/B,GAApB,EAAyB;EACvB,IAAIA,GAAG,YAAYxlC,GAAnB,EAAwB;IACtB,OAAOwlC,GAAG,CAACmiC,IAAX;EACD;;EACD,IAAI;IACF,OAAO,IAAI3nE,GAAJ,CAAQwlC,GAAR,EAAatsB,MAAM,CAAC0uD,QAApB,EAA8BD,IAArC;EACD,CAFD,CAEE,MAAM;IACN,IAAI34E,QAAQ,IAAI,OAAOw2C,GAAP,KAAe,QAA/B,EAAyC;MACvC,OAAOA,GAAP;IACD;EACF;;EACD,MAAM,IAAIxmC,KAAJ,CAAU,2BAA2B,8DAArC,CAAN;AACD;;AACD,SAASgmE,WAAT,CAAqBx/B,GAArB,EAA0B;EACxB,IAAIx2C,QAAQ,IAAI,OAAO64E,MAAP,KAAkB,WAA9B,IAA6CriC,GAAG,YAAYqiC,MAAhE,EAAwE;IACtE,MAAM,IAAI7oE,KAAJ,CAAU,mEAAV,CAAN;EACD;;EACD,IAAIwmC,GAAG,YAAYtjC,UAAf,IAA6BsjC,GAAG,CAACzB,UAAJ,KAAmByB,GAAG,CAAC1iC,MAAJ,CAAWihC,UAA/D,EAA2E;IACzE,OAAOyB,GAAP;EACD;;EACD,IAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;IAC3B,OAAOxjC,aAAa,CAACwjC,GAAD,CAApB;EACD;;EACD,IAAIA,GAAG,YAAYhxB,WAAf,IAA8BA,WAAW,CAACsvB,MAAZ,CAAmB0B,GAAnB,CAA9B,IAAyD,OAAOA,GAAP,KAAe,QAAf,IAA2B,CAACsiC,KAAK,CAACtiC,GAAG,EAAE5lC,MAAN,CAA9F,EAA6G;IAC3G,OAAO,IAAIsC,UAAJ,CAAesjC,GAAf,CAAP;EACD;;EACD,MAAM,IAAIxmC,KAAJ,CAAU,iDAAiD,gEAA3D,CAAN;AACD;;AACD,SAAS+oE,UAAT,CAAoBC,GAApB,EAAyB;EACvB,OAAO,OAAOA,GAAP,KAAe,QAAf,IAA2BzpE,MAAM,CAACC,SAAP,CAAiBwpE,GAAG,EAAEC,GAAtB,CAA3B,IAAyDD,GAAG,CAACC,GAAJ,IAAW,CAApE,IAAyE1pE,MAAM,CAACC,SAAP,CAAiBwpE,GAAG,EAAEE,GAAtB,CAAzE,IAAuGF,GAAG,CAACE,GAAJ,IAAW,CAAzH;AACD;;AACD,MAAMpD,sBAAN,CAA6B;EAC3B,OAAO,CAAC92D,KAAR,GAAgB,CAAhB;;EACAvN,WAAW,GAAG;IACZ,KAAKinE,WAAL,GAAmBl0D,OAAO,CAACm4B,aAAR,EAAnB;IACA,KAAK87B,UAAL,GAAkB,IAAlB;IACA,KAAKhB,OAAL,GAAe,IAAf;IACA,KAAKz4D,KAAL,GAAc,IAAG82D,sBAAsB,CAAC,CAAC92D,KAAxB,EAAgC,EAAjD;IACA,KAAK+4D,SAAL,GAAiB,KAAjB;IACA,KAAKoB,UAAL,GAAkB,IAAlB;IACA,KAAK7R,UAAL,GAAkB,IAAlB;EACD;;EACU,IAAPj4C,OAAO,GAAG;IACZ,OAAO,KAAKqpD,WAAL,CAAiBrpD,OAAxB;EACD;;EACKvS,OAAO,GAAG;IAAA;;IAAA;MACd,OAAI,CAACi7D,SAAL,GAAiB,IAAjB;;MACA,IAAI;QACF,IAAI,OAAI,CAACN,OAAL,EAAc5Y,IAAlB,EAAwB;UACtB,OAAI,CAAC4Y,OAAL,CAAa2B,eAAb,GAA+B,IAA/B;QACD;;QACD,MAAM,OAAI,CAACX,UAAL,EAAiB37D,OAAjB,EAAN;MACD,CALD,CAKE,OAAOvD,EAAP,EAAW;QACX,IAAI,OAAI,CAACk+D,OAAL,EAAc5Y,IAAlB,EAAwB;UACtB,OAAO,OAAI,CAAC4Y,OAAL,CAAa2B,eAApB;QACD;;QACD,MAAM7/D,EAAN;MACD;;MACD,OAAI,CAACk/D,UAAL,GAAkB,IAAlB;;MACA,IAAI,OAAI,CAAChB,OAAT,EAAkB;QAChB,OAAI,CAACA,OAAL,CAAa36D,OAAb;;QACA,OAAI,CAAC26D,OAAL,GAAe,IAAf;MACD;IAjBa;EAkBf;;AAhC0B;;AAkC7B,MAAMn5E,qBAAN,CAA4B;EAC1BmT,WAAW,CAACb,MAAD,EAAS80D,WAAT,EAAsBC,eAAe,GAAG,KAAxC,EAA+CC,0BAA0B,GAAG,IAA5E,EAAkF;IAC3F,KAAKh1D,MAAL,GAAcA,MAAd;IACA,KAAK80D,WAAL,GAAmBA,WAAnB;IACA,KAAKC,eAAL,GAAuBA,eAAvB;IACA,KAAKC,0BAAL,GAAkCA,0BAAlC;IACA,KAAKyT,eAAL,GAAuB,EAAvB;IACA,KAAKC,kBAAL,GAA0B,EAA1B;IACA,KAAKC,yBAAL,GAAiC,EAAjC;IACA,KAAKC,yBAAL,GAAiC,EAAjC;IACA,KAAKC,gBAAL,GAAwBj1D,OAAO,CAACm4B,aAAR,EAAxB;EACD;;EACD2pB,gBAAgB,CAACoT,QAAD,EAAW;IACzB,KAAKL,eAAL,CAAqBvmE,IAArB,CAA0B4mE,QAA1B;EACD;;EACDjT,mBAAmB,CAACiT,QAAD,EAAW;IAC5B,KAAKJ,kBAAL,CAAwBxmE,IAAxB,CAA6B4mE,QAA7B;EACD;;EACD9S,0BAA0B,CAAC8S,QAAD,EAAW;IACnC,KAAKH,yBAAL,CAA+BzmE,IAA/B,CAAoC4mE,QAApC;EACD;;EACD7S,0BAA0B,CAAC6S,QAAD,EAAW;IACnC,KAAKF,yBAAL,CAA+B1mE,IAA/B,CAAoC4mE,QAApC;EACD;;EACDC,WAAW,CAACpT,KAAD,EAAQ3zD,KAAR,EAAe;IACxB,KAAK,MAAM8mE,QAAX,IAAuB,KAAKL,eAA5B,EAA6C;MAC3CK,QAAQ,CAACnT,KAAD,EAAQ3zD,KAAR,CAAR;IACD;EACF;;EACDgnE,cAAc,CAACrgC,MAAD,EAASmtB,KAAT,EAAgB;IAC5B,KAAK+S,gBAAL,CAAsBpqD,OAAtB,CAA8BhK,IAA9B,CAAmC,MAAM;MACvC,KAAK,MAAMq0D,QAAX,IAAuB,KAAKJ,kBAA5B,EAAgD;QAC9CI,QAAQ,CAACngC,MAAD,EAASmtB,KAAT,CAAR;MACD;IACF,CAJD;EAKD;;EACDmT,qBAAqB,CAACjnE,KAAD,EAAQ;IAC3B,KAAK6mE,gBAAL,CAAsBpqD,OAAtB,CAA8BhK,IAA9B,CAAmC,MAAM;MACvC,KAAK,MAAMq0D,QAAX,IAAuB,KAAKH,yBAA5B,EAAuD;QACrDG,QAAQ,CAAC9mE,KAAD,CAAR;MACD;IACF,CAJD;EAKD;;EACDknE,qBAAqB,GAAG;IACtB,KAAKL,gBAAL,CAAsBpqD,OAAtB,CAA8BhK,IAA9B,CAAmC,MAAM;MACvC,KAAK,MAAMq0D,QAAX,IAAuB,KAAKF,yBAA5B,EAAuD;QACrDE,QAAQ;MACT;IACF,CAJD;EAKD;;EACD3S,cAAc,GAAG;IACf,KAAK0S,gBAAL,CAAsBh1D,OAAtB;EACD;;EACDsjD,gBAAgB,CAACxB,KAAD,EAAQ1kD,GAAR,EAAa;IAC3B9R,WAAW,CAAC,wDAAD,CAAX;EACD;;EACDgpB,KAAK,GAAG,CAAE;;AAxDgB;;AA0D5B,MAAMghD,gBAAN,CAAuB;EACrBtoE,WAAW,CAACuoE,OAAD,EAAUzB,SAAV,EAAqB;IAC9B,KAAK0B,QAAL,GAAgBD,OAAhB;IACA,KAAKvB,UAAL,GAAkBF,SAAlB;EACD;;EACoB,IAAjBtkD,iBAAiB,GAAG;IACtB,OAAO,KAAKwkD,UAAL,CAAgBxkD,iBAAvB;EACD;;EACgB,IAAbY,aAAa,GAAG;IAClB,OAAO,KAAK4jD,UAAL,CAAgB5jD,aAAvB;EACD;;EACW,IAARqlD,QAAQ,GAAG;IACb,OAAO,KAAKD,QAAL,CAAcC,QAArB;EACD;;EACe,IAAZC,YAAY,GAAG;IACjB,OAAO,KAAKF,QAAL,CAAcE,YAArB;EACD;;EACY,IAATC,SAAS,GAAG;IACd,OAAOt6E,MAAM,CAAC,IAAD,EAAO,WAAP,EAAoB,CAAC,CAAC,KAAK24E,UAAL,CAAgB4B,WAAtC,CAAb;EACD;;EACa,IAAVC,UAAU,GAAG;IACf,OAAO,KAAK7B,UAAL,CAAgB4B,WAAvB;EACD;;EACDE,OAAO,CAAC//C,UAAD,EAAa;IAClB,OAAO,KAAKi+C,UAAL,CAAgB8B,OAAhB,CAAwB//C,UAAxB,CAAP;EACD;;EACDggD,YAAY,CAACxB,GAAD,EAAM;IAChB,OAAO,KAAKP,UAAL,CAAgB+B,YAAhB,CAA6BxB,GAA7B,CAAP;EACD;;EACDyB,eAAe,GAAG;IAChB,OAAO,KAAKhC,UAAL,CAAgBgC,eAAhB,EAAP;EACD;;EACDC,cAAc,CAACv7D,EAAD,EAAK;IACjB,OAAO,KAAKs5D,UAAL,CAAgBiC,cAAhB,CAA+Bv7D,EAA/B,CAAP;EACD;;EACDw7D,aAAa,GAAG;IACd,OAAO,KAAKlC,UAAL,CAAgBkC,aAAhB,EAAP;EACD;;EACDC,aAAa,GAAG;IACd,OAAO,KAAKnC,UAAL,CAAgBmC,aAAhB,EAAP;EACD;;EACDC,WAAW,GAAG;IACZ,OAAO,KAAKpC,UAAL,CAAgBoC,WAAhB,EAAP;EACD;;EACDC,oBAAoB,GAAG;IACrB,OAAO,KAAKrC,UAAL,CAAgBqC,oBAAhB,EAAP;EACD;;EACDC,aAAa,GAAG;IACd,OAAO,KAAKtC,UAAL,CAAgBsC,aAAhB,EAAP;EACD;;EACDC,cAAc,GAAG;IACf,OAAO,KAAKvC,UAAL,CAAgBuC,cAAhB,EAAP;EACD;;EACDC,YAAY,GAAG;IACb,OAAO,KAAKxC,UAAL,CAAgByC,eAAhB,EAAP;EACD;;EACDC,UAAU,GAAG;IACX,OAAO,KAAK1C,UAAL,CAAgB0C,UAAhB,EAAP;EACD;;EACDC,wBAAwB,CAAC;IACvBtlB,MAAM,GAAG;EADc,IAErB,EAFoB,EAEhB;IACN,MAAM;MACJ4N;IADI,IAEF,KAAK+U,UAAL,CAAgB4C,kBAAhB,CAAmCvlB,MAAnC,CAFJ;;IAGA,OAAO,KAAK2iB,UAAL,CAAgB2C,wBAAhB,CAAyC1X,eAAzC,CAAP;EACD;;EACD4X,cAAc,GAAG;IACf,OAAO,KAAK7C,UAAL,CAAgB6C,cAAhB,EAAP;EACD;;EACDC,WAAW,GAAG;IACZ,OAAO,KAAK9C,UAAL,CAAgB8C,WAAhB,EAAP;EACD;;EACDC,WAAW,GAAG;IACZ,OAAO,KAAK/C,UAAL,CAAgB+C,WAAhB,EAAP;EACD;;EACDt8C,OAAO,GAAG;IACR,OAAO,KAAKu5C,UAAL,CAAgBv5C,OAAhB,EAAP;EACD;;EACDu8C,YAAY,GAAG;IACb,OAAO,KAAKhD,UAAL,CAAgBgD,YAAhB,EAAP;EACD;;EACDC,eAAe,GAAG;IAChB,OAAO,KAAKjD,UAAL,CAAgBkD,sBAAhB,CAAuCtsD,OAA9C;EACD;;EACD8kD,OAAO,CAACyH,eAAe,GAAG,KAAnB,EAA0B;IAC/B,OAAO,KAAKnD,UAAL,CAAgBoD,YAAhB,CAA6BD,eAAe,IAAI,KAAKxB,SAArD,CAAP;EACD;;EACDt9D,OAAO,GAAG;IACR,OAAO,KAAKg/D,WAAL,CAAiBh/D,OAAjB,EAAP;EACD;;EACDi/D,gBAAgB,CAAC/C,GAAD,EAAM;IACpB,OAAO,KAAKP,UAAL,CAAgBsD,gBAAhB,CAAiC/C,GAAjC,CAAP;EACD;;EACgB,IAAblB,aAAa,GAAG;IAClB,OAAO,KAAKW,UAAL,CAAgBX,aAAvB;EACD;;EACc,IAAXgE,WAAW,GAAG;IAChB,OAAO,KAAKrD,UAAL,CAAgBqD,WAAvB;EACD;;EACDE,eAAe,GAAG;IAChB,OAAO,KAAKvD,UAAL,CAAgBuD,eAAhB,EAAP;EACD;;EACDC,YAAY,GAAG;IACb,OAAO,KAAKxD,UAAL,CAAgBwD,YAAhB,EAAP;EACD;;EACDC,sBAAsB,GAAG;IACvB,OAAO,KAAKzD,UAAL,CAAgByD,sBAAhB,EAAP;EACD;;AA5GoB;;AA8GvB,MAAMC,YAAN,CAAmB;EACjB,CAACC,qBAAD,GAAyB,IAAzB;EACA,CAACC,cAAD,GAAkB,KAAlB;;EACA5qE,WAAW,CAAC8uB,SAAD,EAAY+7C,QAAZ,EAAsB/D,SAAtB,EAAiCtB,MAAM,GAAG,KAA1C,EAAiD;IAC1D,KAAKsF,UAAL,GAAkBh8C,SAAlB;IACA,KAAKi8C,SAAL,GAAiBF,QAAjB;IACA,KAAK7D,UAAL,GAAkBF,SAAlB;IACA,KAAKkE,MAAL,GAAcxF,MAAM,GAAG,IAAIjvD,SAAJ,EAAH,GAAqB,IAAzC;IACA,KAAK00D,OAAL,GAAezF,MAAf;IACA,KAAK9lB,UAAL,GAAkBonB,SAAS,CAACpnB,UAA5B;IACA,KAAK/U,IAAL,GAAY,IAAIugC,UAAJ,EAAZ;IACA,KAAKC,wBAAL,GAAgC,KAAhC;IACA,KAAKC,aAAL,GAAqB,IAAI/hE,GAAJ,EAArB;IACA,KAAKi9D,SAAL,GAAiB,KAAjB;EACD;;EACa,IAAVv9C,UAAU,GAAG;IACf,OAAO,KAAK+hD,UAAL,GAAkB,CAAzB;EACD;;EACS,IAAN/pC,MAAM,GAAG;IACX,OAAO,KAAKgqC,SAAL,CAAehqC,MAAtB;EACD;;EACM,IAAHwmC,GAAG,GAAG;IACR,OAAO,KAAKwD,SAAL,CAAexD,GAAtB;EACD;;EACW,IAAR8D,QAAQ,GAAG;IACb,OAAO,KAAKN,SAAL,CAAeM,QAAtB;EACD;;EACO,IAAJlZ,IAAI,GAAG;IACT,OAAO,KAAK4Y,SAAL,CAAe5Y,IAAtB;EACD;;EACDmZ,WAAW,CAAC;IACVn3D,KADU;IAEVC,QAAQ,GAAG,KAAK2sB,MAFN;IAGV1sB,OAAO,GAAG,CAHA;IAIVC,OAAO,GAAG,CAJA;IAKVC,QAAQ,GAAG;EALD,IAMR,EANO,EAMH;IACN,OAAO,IAAIN,YAAJ,CAAiB;MACtBC,OAAO,EAAE,KAAKi+C,IADQ;MAEtBh+C,KAFsB;MAGtBC,QAHsB;MAItBC,OAJsB;MAKtBC,OALsB;MAMtBC;IANsB,CAAjB,CAAP;EAQD;;EACDg3D,cAAc,CAAC;IACblnB,MAAM,GAAG;EADI,IAEX,EAFU,EAEN;IACN,MAAM;MACJ4N;IADI,IAEF,KAAK+U,UAAL,CAAgB4C,kBAAhB,CAAmCvlB,MAAnC,CAFJ;;IAGA,OAAO,KAAK2iB,UAAL,CAAgBuE,cAAhB,CAA+B,KAAKT,UAApC,EAAgD7Y,eAAhD,CAAP;EACD;;EACDuX,YAAY,GAAG;IACb,OAAO,KAAKxC,UAAL,CAAgBwE,gBAAhB,CAAiC,KAAKV,UAAtC,CAAP;EACD;;EACgB,IAAb1nD,aAAa,GAAG;IAClB,OAAO,KAAK4jD,UAAL,CAAgB5jD,aAAvB;EACD;;EACY,IAATulD,SAAS,GAAG;IACd,OAAOt6E,MAAM,CAAC,IAAD,EAAO,WAAP,EAAoB,CAAC,CAAC,KAAK24E,UAAL,CAAgB4B,WAAtC,CAAb;EACD;;EACK6C,MAAM,GAAG;IAAA;;IAAA;MACb,OAAO,OAAI,CAACzE,UAAL,CAAgB4B,WAAhB,EAA6BxnC,QAA7B,CAAsC,OAAI,CAAC0pC,UAA3C,KAA0D,IAAjE;IADa;EAEd;;EACD1wD,MAAM,CAAC;IACLuoD,aADK;IAEL3pD,QAFK;IAGLqrC,MAAM,GAAG,SAHJ;IAILqnB,cAAc,GAAG1/E,cAAc,CAAC8D,MAJ3B;IAKL4I,SAAS,GAAG,IALP;IAMLwvB,UAAU,GAAG,IANR;IAOLyjD,4BAA4B,GAAG,IAP1B;IAQL9rB,mBAAmB,GAAG,IARjB;IASLz7B,UAAU,GAAG,IATR;IAULwnD,sBAAsB,GAAG,IAVpB;IAWLrnD,SAAS,GAAG;EAXP,CAAD,EAYH;IACD,KAAKymD,MAAL,EAAat0D,IAAb,CAAkB,SAAlB;;IACA,MAAMm1D,UAAU,GAAG,KAAK7E,UAAL,CAAgB4C,kBAAhB,CAAmCvlB,MAAnC,EAA2CqnB,cAA3C,EAA2DE,sBAA3D,EAAmFrnD,SAAnF,CAAnB;;IACA,MAAM;MACJ0tC,eADI;MAEJ1O;IAFI,IAGFsoB,UAHJ;IAIA,KAAK,CAACjB,cAAN,GAAuB,KAAvB;IACA,KAAK,CAACkB,mBAAN;IACAH,4BAA4B,KAAK,KAAK3E,UAAL,CAAgB2C,wBAAhB,CAAyC1X,eAAzC,CAAjC;;IACA,IAAI8Z,WAAW,GAAG,KAAKX,aAAL,CAAmBngF,GAAnB,CAAuBs4D,QAAvB,CAAlB;;IACA,IAAI,CAACwoB,WAAL,EAAkB;MAChBA,WAAW,GAAGjhF,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAd;;MACA,KAAKopE,aAAL,CAAmB57D,GAAnB,CAAuB+zC,QAAvB,EAAiCwoB,WAAjC;IACD;;IACD,IAAIA,WAAW,CAACC,yBAAhB,EAA2C;MACzCvkD,YAAY,CAACskD,WAAW,CAACC,yBAAb,CAAZ;MACAD,WAAW,CAACC,yBAAZ,GAAwC,IAAxC;IACD;;IACD,MAAMC,WAAW,GAAG,CAAC,EAAEha,eAAe,GAAG9iE,mBAAmB,CAACG,KAAxC,CAArB;;IACA,IAAI,CAACy8E,WAAW,CAACG,sBAAjB,EAAyC;MACvCH,WAAW,CAACG,sBAAZ,GAAqCn5D,OAAO,CAACm4B,aAAR,EAArC;MACA6gC,WAAW,CAACl5B,YAAZ,GAA2B;QACzBiP,OAAO,EAAE,EADgB;QAEzBD,SAAS,EAAE,EAFc;QAGzBsqB,SAAS,EAAE,KAHc;QAIzBC,cAAc,EAAE;MAJS,CAA3B;MAMA,KAAKpB,MAAL,EAAat0D,IAAb,CAAkB,cAAlB;;MACA,KAAK21D,iBAAL,CAAuBR,UAAvB;IACD;;IACD,MAAMljC,QAAQ,GAAG5pB,KAAK,IAAI;MACxBgtD,WAAW,CAACO,WAAZ,CAAwBtwD,MAAxB,CAA+BuwD,kBAA/B;;MACA,IAAI,KAAKpB,wBAAL,IAAiCc,WAArC,EAAkD;QAChD,KAAK,CAACrB,cAAN,GAAuB,IAAvB;MACD;;MACD,KAAK,CAAC4B,UAAN,CAAiB,CAACP,WAAlB;;MACA,IAAIltD,KAAJ,EAAW;QACTwtD,kBAAkB,CAACrd,UAAnB,CAA8Bj8C,MAA9B,CAAqC8L,KAArC;;QACA,KAAK0tD,kBAAL,CAAwB;UACtBV,WADsB;UAEtBv/D,MAAM,EAAEuS,KAAK,YAAYxgB,KAAjB,GAAyBwgB,KAAzB,GAAiC,IAAIxgB,KAAJ,CAAUwgB,KAAV;QAFnB,CAAxB;MAID,CAND,MAMO;QACLwtD,kBAAkB,CAACrd,UAAnB,CAA8Bl8C,OAA9B;MACD;;MACD,IAAI,KAAKg4D,MAAT,EAAiB;QACf,KAAKA,MAAL,CAAYp0D,OAAZ,CAAoB,WAApB;;QACA,KAAKo0D,MAAL,CAAYp0D,OAAZ,CAAoB,SAApB;;QACA,IAAIprB,UAAU,CAACkhF,KAAX,EAAkBt2C,OAAtB,EAA+B;UAC7B5qC,UAAU,CAACkhF,KAAX,CAAiBjxD,GAAjB,CAAqB,KAAKsN,UAA1B,EAAsC,KAAKiiD,MAA3C;QACD;MACF;IACF,CAtBD;;IAuBA,MAAMuB,kBAAkB,GAAG,IAAII,kBAAJ,CAAuB;MAChDhsD,QAAQ,EAAEgoB,QADsC;MAEhD7W,MAAM,EAAE;QACN6wC,aADM;QAEN3pD,QAFM;QAGNtgB,SAHM;QAINwvB;MAJM,CAFwC;MAQhDyiB,IAAI,EAAE,KAAKA,IARqC;MAShD+U,UAAU,EAAE,KAAKA,UAT+B;MAUhDG,mBAVgD;MAWhDhN,YAAY,EAAEk5B,WAAW,CAACl5B,YAXsB;MAYhD/jB,SAAS,EAAE,KAAKg8C,UAZgC;MAahDvyB,aAAa,EAAE,KAAKyuB,UAAL,CAAgBzuB,aAbiB;MAchDn1B,aAAa,EAAE,KAAK4jD,UAAL,CAAgB5jD,aAdiB;MAehDwpD,wBAAwB,EAAE,CAACX,WAfqB;MAgBhDzG,MAAM,EAAE,KAAKyF,OAhBmC;MAiBhD7mD;IAjBgD,CAAvB,CAA3B;IAmBA,CAAC2nD,WAAW,CAACO,WAAZ,KAA4B,IAAI5rD,GAAJ,EAA7B,EAAwCjF,GAAxC,CAA4C8wD,kBAA5C;IACA,MAAMM,UAAU,GAAGN,kBAAkB,CAACnI,IAAtC;IACArxD,OAAO,CAAC+5D,GAAR,CAAY,CAACf,WAAW,CAACG,sBAAZ,CAAmCtuD,OAApC,EAA6C+tD,4BAA7C,CAAZ,EAAwF/3D,IAAxF,CAA6F,CAAC,CAACytC,YAAD,EAAe1B,qBAAf,CAAD,KAA2C;MACtI,IAAI,KAAK2mB,SAAT,EAAoB;QAClB39B,QAAQ;QACR;MACD;;MACD,KAAKqiC,MAAL,EAAat0D,IAAb,CAAkB,WAAlB;;MACA,IAAI,EAAEipC,qBAAqB,CAACsS,eAAtB,GAAwCA,eAA1C,CAAJ,EAAgE;QAC9D,MAAM,IAAI1zD,KAAJ,CAAU,gFAAgF,0DAA1F,CAAN;MACD;;MACDguE,kBAAkB,CAACQ,kBAAnB,CAAsC;QACpC1rB,YADoC;QAEpC1B;MAFoC,CAAtC;MAIA4sB,kBAAkB,CAACS,mBAAnB;IACD,CAdD,EAcGzgE,KAdH,CAcSo8B,QAdT;IAeA,OAAOkkC,UAAP;EACD;;EACDI,eAAe,CAAC;IACd5oB,MAAM,GAAG,SADK;IAEdqnB,cAAc,GAAG1/E,cAAc,CAAC8D,MAFlB;IAGd87E,sBAAsB,GAAG,IAHX;IAIdrnD,SAAS,GAAG;EAJE,IAKZ,EALW,EAKP;IACN,SAASyoD,mBAAT,GAA+B;MAC7B,IAAIjB,WAAW,CAACl5B,YAAZ,CAAyBs5B,SAA7B,EAAwC;QACtCJ,WAAW,CAACmB,oBAAZ,CAAiCl6D,OAAjC,CAAyC+4D,WAAW,CAACl5B,YAArD;QACAk5B,WAAW,CAACO,WAAZ,CAAwBtwD,MAAxB,CAA+BmxD,UAA/B;MACD;IACF;;IACD,MAAMtB,UAAU,GAAG,KAAK7E,UAAL,CAAgB4C,kBAAhB,CAAmCvlB,MAAnC,EAA2CqnB,cAA3C,EAA2DE,sBAA3D,EAAmFrnD,SAAnF,EAA8F,IAA9F,CAAnB;;IACA,IAAIwnD,WAAW,GAAG,KAAKX,aAAL,CAAmBngF,GAAnB,CAAuB4gF,UAAU,CAACtoB,QAAlC,CAAlB;;IACA,IAAI,CAACwoB,WAAL,EAAkB;MAChBA,WAAW,GAAGjhF,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAd;;MACA,KAAKopE,aAAL,CAAmB57D,GAAnB,CAAuBq8D,UAAU,CAACtoB,QAAlC,EAA4CwoB,WAA5C;IACD;;IACD,IAAIoB,UAAJ;;IACA,IAAI,CAACpB,WAAW,CAACmB,oBAAjB,EAAuC;MACrCC,UAAU,GAAGriF,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAb;MACAmrE,UAAU,CAACH,mBAAX,GAAiCA,mBAAjC;MACAjB,WAAW,CAACmB,oBAAZ,GAAmCn6D,OAAO,CAACm4B,aAAR,EAAnC;MACA,CAAC6gC,WAAW,CAACO,WAAZ,KAA4B,IAAI5rD,GAAJ,EAA7B,EAAwCjF,GAAxC,CAA4C0xD,UAA5C;MACApB,WAAW,CAACl5B,YAAZ,GAA2B;QACzBiP,OAAO,EAAE,EADgB;QAEzBD,SAAS,EAAE,EAFc;QAGzBsqB,SAAS,EAAE,KAHc;QAIzBC,cAAc,EAAE;MAJS,CAA3B;MAMA,KAAKpB,MAAL,EAAat0D,IAAb,CAAkB,cAAlB;;MACA,KAAK21D,iBAAL,CAAuBR,UAAvB;IACD;;IACD,OAAOE,WAAW,CAACmB,oBAAZ,CAAiCtvD,OAAxC;EACD;;EACDwvD,iBAAiB,CAAC;IAChBC,oBAAoB,GAAG,KADP;IAEhBC,oBAAoB,GAAG;EAFP,IAGd,EAHa,EAGT;IACN,MAAMC,uBAAuB,GAAG,GAAhC;IACA,OAAO,KAAKvG,UAAL,CAAgBR,cAAhB,CAA+B5W,cAA/B,CAA8C,gBAA9C,EAAgE;MACrE9gC,SAAS,EAAE,KAAKg8C,UADqD;MAErEuC,oBAAoB,EAAEA,oBAAoB,KAAK,IAFsB;MAGrEC,oBAAoB,EAAEA,oBAAoB,KAAK;IAHsB,CAAhE,EAIJ;MACDE,aAAa,EAAED,uBADd;;MAEDh8D,IAAI,CAAC+jB,WAAD,EAAc;QAChB,OAAOA,WAAW,CAACvI,KAAZ,CAAkB5tB,MAAzB;MACD;;IAJA,CAJI,CAAP;EAUD;;EACDsuE,cAAc,CAAC37C,MAAM,GAAG,EAAV,EAAc;IAC1B,IAAI,KAAKk1C,UAAL,CAAgB4B,WAApB,EAAiC;MAC/B,OAAO,KAAK6C,MAAL,GAAc73D,IAAd,CAAmB4vD,GAAG,IAAID,OAAO,CAACjuC,WAAR,CAAoBkuC,GAApB,CAA1B,CAAP;IACD;;IACD,MAAM3E,cAAc,GAAG,KAAKuO,iBAAL,CAAuBt7C,MAAvB,CAAvB;IACA,OAAO,IAAI/e,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;MAC5C,SAAS4tD,IAAT,GAAgB;QACd9K,MAAM,CAACmB,IAAP,GAActjD,IAAd,CAAmB,UAAU;UAC3BpU,KAD2B;UAE3BgpC;QAF2B,CAAV,EAGhB;UACD,IAAIA,IAAJ,EAAU;YACRx1B,OAAO,CAACsiB,WAAD,CAAP;YACA;UACD;;UACDA,WAAW,CAACuqC,IAAZ,KAAqBrgE,KAAK,CAACqgE,IAA3B;UACA/0E,MAAM,CAACwjC,MAAP,CAAcgH,WAAW,CAACwrC,MAA1B,EAAkCthE,KAAK,CAACshE,MAAxC;UACAxrC,WAAW,CAACvI,KAAZ,CAAkB1rB,IAAlB,CAAuB,GAAG7B,KAAK,CAACutB,KAAhC;UACA8zC,IAAI;QACL,CAZD,EAYG5tD,MAZH;MAaD;;MACD,MAAM8iD,MAAM,GAAG8I,cAAc,CAAC/D,SAAf,EAAf;MACA,MAAMxlC,WAAW,GAAG;QAClBvI,KAAK,EAAE,EADW;QAElB+zC,MAAM,EAAEh2E,MAAM,CAACkX,MAAP,CAAc,IAAd,CAFU;QAGlB69D,IAAI,EAAE;MAHY,CAApB;MAKAgB,IAAI;IACL,CAvBM,CAAP;EAwBD;;EACD6M,aAAa,GAAG;IACd,OAAO,KAAK1G,UAAL,CAAgB0G,aAAhB,CAA8B,KAAK5C,UAAnC,CAAP;EACD;;EACD6C,QAAQ,GAAG;IACT,KAAKrH,SAAL,GAAiB,IAAjB;IACA,MAAMsH,MAAM,GAAG,EAAf;;IACA,KAAK,MAAM7B,WAAX,IAA0B,KAAKX,aAAL,CAAmB5jD,MAAnB,EAA1B,EAAuD;MACrD,KAAKilD,kBAAL,CAAwB;QACtBV,WADsB;QAEtBv/D,MAAM,EAAE,IAAIjO,KAAJ,CAAU,qBAAV,CAFc;QAGtBsvE,KAAK,EAAE;MAHe,CAAxB;;MAKA,IAAI9B,WAAW,CAACmB,oBAAhB,EAAsC;QACpC;MACD;;MACD,KAAK,MAAMX,kBAAX,IAAiCR,WAAW,CAACO,WAA7C,EAA0D;QACxDsB,MAAM,CAACvsE,IAAP,CAAYkrE,kBAAkB,CAACuB,SAA/B;QACAvB,kBAAkB,CAACp2C,MAAnB;MACD;IACF;;IACD,KAAKwU,IAAL,CAAUl5B,KAAV;IACA,KAAK,CAACm5D,cAAN,GAAuB,KAAvB;IACA,KAAK,CAACkB,mBAAN;IACA,OAAO/4D,OAAO,CAAC+5D,GAAR,CAAYc,MAAZ,CAAP;EACD;;EACDlL,OAAO,CAACqL,UAAU,GAAG,KAAd,EAAqB;IAC1B,KAAK,CAACnD,cAAN,GAAuB,IAAvB;IACA,MAAM1Z,OAAO,GAAG,KAAK,CAACsb,UAAN,CAAiB,KAAjB,CAAhB;;IACA,IAAIuB,UAAU,IAAI7c,OAAlB,EAA2B;MACzB,KAAK8Z,MAAL,KAAgB,IAAIz0D,SAAJ,EAAhB;IACD;;IACD,OAAO26C,OAAP;EACD;;EACD,CAACsb,UAAU,CAACwB,OAAO,GAAG,KAAX,EAAkB;IAC3B,KAAK,CAAClC,mBAAN;;IACA,IAAI,CAAC,KAAK,CAAClB,cAAP,IAAyB,KAAKtE,SAAlC,EAA6C;MAC3C,OAAO,KAAP;IACD;;IACD,IAAI0H,OAAJ,EAAa;MACX,KAAK,CAACrD,qBAAN,GAA8B/5C,UAAU,CAAC,MAAM;QAC7C,KAAK,CAAC+5C,qBAAN,GAA8B,IAA9B;QACA,KAAK,CAAC6B,UAAN,CAAiB,KAAjB;MACD,CAHuC,EAGrCzI,uBAHqC,CAAxC;MAIA,OAAO,KAAP;IACD;;IACD,KAAK,MAAM;MACTuI,WADS;MAETz5B;IAFS,CAAX,IAGK,KAAKu4B,aAAL,CAAmB5jD,MAAnB,EAHL,EAGkC;MAChC,IAAI8kD,WAAW,CAAC/6D,IAAZ,GAAmB,CAAnB,IAAwB,CAACshC,YAAY,CAACs5B,SAA1C,EAAqD;QACnD,OAAO,KAAP;MACD;IACF;;IACD,KAAKf,aAAL,CAAmB35D,KAAnB;;IACA,KAAKk5B,IAAL,CAAUl5B,KAAV;IACA,KAAK,CAACm5D,cAAN,GAAuB,KAAvB;IACA,OAAO,IAAP;EACD;;EACD,CAACkB,mBAAmB,GAAG;IACrB,IAAI,KAAK,CAACnB,qBAAV,EAAiC;MAC/BljD,YAAY,CAAC,KAAK,CAACkjD,qBAAP,CAAZ;MACA,KAAK,CAACA,qBAAN,GAA8B,IAA9B;IACD;EACF;;EACDsD,gBAAgB,CAAC5sB,YAAD,EAAekC,QAAf,EAAyB;IACvC,MAAMwoB,WAAW,GAAG,KAAKX,aAAL,CAAmBngF,GAAnB,CAAuBs4D,QAAvB,CAApB;;IACA,IAAI,CAACwoB,WAAL,EAAkB;MAChB;IACD;;IACD,KAAKf,MAAL,EAAap0D,OAAb,CAAqB,cAArB;IACAm1D,WAAW,CAACG,sBAAZ,EAAoCl5D,OAApC,CAA4CquC,YAA5C;EACD;;EACD6sB,gBAAgB,CAACC,iBAAD,EAAoBpC,WAApB,EAAiC;IAC/C,KAAK,IAAIhrE,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGomE,iBAAiB,CAAChvE,MAAvC,EAA+C4B,CAAC,GAAGgH,EAAnD,EAAuDhH,CAAC,EAAxD,EAA4D;MAC1DgrE,WAAW,CAACl5B,YAAZ,CAAyBiP,OAAzB,CAAiCzgD,IAAjC,CAAsC8sE,iBAAiB,CAACrsB,OAAlB,CAA0B/gD,CAA1B,CAAtC;MACAgrE,WAAW,CAACl5B,YAAZ,CAAyBgP,SAAzB,CAAmCxgD,IAAnC,CAAwC8sE,iBAAiB,CAACtsB,SAAlB,CAA4B9gD,CAA5B,CAAxC;IACD;;IACDgrE,WAAW,CAACl5B,YAAZ,CAAyBs5B,SAAzB,GAAqCgC,iBAAiB,CAAChC,SAAvD;IACAJ,WAAW,CAACl5B,YAAZ,CAAyBu5B,cAAzB,GAA0C+B,iBAAiB,CAAC/B,cAA5D;;IACA,KAAK,MAAMG,kBAAX,IAAiCR,WAAW,CAACO,WAA7C,EAA0D;MACxDC,kBAAkB,CAACS,mBAAnB;IACD;;IACD,IAAImB,iBAAiB,CAAChC,SAAtB,EAAiC;MAC/B,KAAK,CAACK,UAAN,CAAiB,IAAjB;IACD;EACF;;EACDH,iBAAiB,CAAC;IAChBpa,eADgB;IAEhB1O,QAFgB;IAGhB6qB,6BAHgB;IAIhB9pC;EAJgB,CAAD,EAKd;IACD,MAAM;MACJviC,GADI;MAEJoiC;IAFI,IAGFiqC,6BAHJ;;IAIA,MAAMvP,cAAc,GAAG,KAAKmI,UAAL,CAAgBR,cAAhB,CAA+B5W,cAA/B,CAA8C,iBAA9C,EAAiE;MACtF9gC,SAAS,EAAE,KAAKg8C,UADsE;MAEtFzmB,MAAM,EAAE4N,eAF8E;MAGtF1O,QAHsF;MAItF/gC,iBAAiB,EAAEzgB,GAJmE;MAKtFuiC;IALsF,CAAjE,EAMpBH,QANoB,CAAvB;;IAOA,MAAM4xB,MAAM,GAAG8I,cAAc,CAAC/D,SAAf,EAAf;;IACA,MAAMiR,WAAW,GAAG,KAAKX,aAAL,CAAmBngF,GAAnB,CAAuBs4D,QAAvB,CAApB;;IACAwoB,WAAW,CAACsC,YAAZ,GAA2BtY,MAA3B;;IACA,MAAM8K,IAAI,GAAG,MAAM;MACjB9K,MAAM,CAACmB,IAAP,GAActjD,IAAd,CAAmB,CAAC;QAClBpU,KADkB;QAElBgpC;MAFkB,CAAD,KAGb;QACJ,IAAIA,IAAJ,EAAU;UACRujC,WAAW,CAACsC,YAAZ,GAA2B,IAA3B;UACA;QACD;;QACD,IAAI,KAAKrH,UAAL,CAAgBV,SAApB,EAA+B;UAC7B;QACD;;QACD,KAAK4H,gBAAL,CAAsB1uE,KAAtB,EAA6BusE,WAA7B;;QACAlL,IAAI;MACL,CAbD,EAaGr0D,MAAM,IAAI;QACXu/D,WAAW,CAACsC,YAAZ,GAA2B,IAA3B;;QACA,IAAI,KAAKrH,UAAL,CAAgBV,SAApB,EAA+B;UAC7B;QACD;;QACD,IAAIyF,WAAW,CAACl5B,YAAhB,EAA8B;UAC5Bk5B,WAAW,CAACl5B,YAAZ,CAAyBs5B,SAAzB,GAAqC,IAArC;;UACA,KAAK,MAAMI,kBAAX,IAAiCR,WAAW,CAACO,WAA7C,EAA0D;YACxDC,kBAAkB,CAACS,mBAAnB;UACD;;UACD,KAAK,CAACR,UAAN,CAAiB,IAAjB;QACD;;QACD,IAAIT,WAAW,CAACG,sBAAhB,EAAwC;UACtCH,WAAW,CAACG,sBAAZ,CAAmCj5D,MAAnC,CAA0CzG,MAA1C;QACD,CAFD,MAEO,IAAIu/D,WAAW,CAACmB,oBAAhB,EAAsC;UAC3CnB,WAAW,CAACmB,oBAAZ,CAAiCj6D,MAAjC,CAAwCzG,MAAxC;QACD,CAFM,MAEA;UACL,MAAMA,MAAN;QACD;MACF,CAhCD;IAiCD,CAlCD;;IAmCAq0D,IAAI;EACL;;EACD4L,kBAAkB,CAAC;IACjBV,WADiB;IAEjBv/D,MAFiB;IAGjBqhE,KAAK,GAAG;EAHS,CAAD,EAIf;IACD,IAAI,CAAC9B,WAAW,CAACsC,YAAjB,EAA+B;MAC7B;IACD;;IACD,IAAItC,WAAW,CAACC,yBAAhB,EAA2C;MACzCvkD,YAAY,CAACskD,WAAW,CAACC,yBAAb,CAAZ;MACAD,WAAW,CAACC,yBAAZ,GAAwC,IAAxC;IACD;;IACD,IAAI,CAAC6B,KAAL,EAAY;MACV,IAAI9B,WAAW,CAACO,WAAZ,CAAwB/6D,IAAxB,GAA+B,CAAnC,EAAsC;QACpC;MACD;;MACD,IAAI/E,MAAM,YAAYrf,2BAAtB,EAAmD;QACjD,IAAImhF,KAAK,GAAGxK,2BAAZ;;QACA,IAAIt3D,MAAM,CAACmJ,UAAP,GAAoB,CAApB,IAAyBnJ,MAAM,CAACmJ,UAAP,GAAoB,IAAjD,EAAuD;UACrD24D,KAAK,IAAI9hE,MAAM,CAACmJ,UAAhB;QACD;;QACDo2D,WAAW,CAACC,yBAAZ,GAAwCp7C,UAAU,CAAC,MAAM;UACvDm7C,WAAW,CAACC,yBAAZ,GAAwC,IAAxC;;UACA,KAAKS,kBAAL,CAAwB;YACtBV,WADsB;YAEtBv/D,MAFsB;YAGtBqhE,KAAK,EAAE;UAHe,CAAxB;QAKD,CAPiD,EAO/CS,KAP+C,CAAlD;QAQA;MACD;IACF;;IACDvC,WAAW,CAACsC,YAAZ,CAAyBl4C,MAAzB,CAAgC,IAAIzqC,cAAJ,CAAmB8gB,MAAM,CAAC1M,OAA1B,CAAhC,EAAoEyM,KAApE,CAA0E,MAAM,CAAE,CAAlF;IACAw/D,WAAW,CAACsC,YAAZ,GAA2B,IAA3B;;IACA,IAAI,KAAKrH,UAAL,CAAgBV,SAApB,EAA+B;MAC7B;IACD;;IACD,KAAK,MAAM,CAACiI,WAAD,EAAcC,cAAd,CAAX,IAA4C,KAAKpD,aAAjD,EAAgE;MAC9D,IAAIoD,cAAc,KAAKzC,WAAvB,EAAoC;QAClC,KAAKX,aAAL,CAAmBpvD,MAAnB,CAA0BuyD,WAA1B;;QACA;MACD;IACF;;IACD,KAAK7L,OAAL;EACD;;EACQ,IAALl9B,KAAK,GAAG;IACV,OAAO,KAAKwlC,MAAZ;EACD;;AAzbgB;;AA2bnB,MAAMyD,YAAN,CAAmB;EACjB,CAACjT,SAAD,GAAa,IAAI96C,GAAJ,EAAb;EACA,CAACguD,QAAD,GAAY37D,OAAO,CAACC,OAAR,EAAZ;;EACAq8C,WAAW,CAACnkE,GAAD,EAAMi5C,QAAN,EAAgB;IACzB,MAAMpjB,KAAK,GAAG;MACZlN,IAAI,EAAEkyB,eAAe,CAAC76C,GAAD,EAAMi5C,QAAQ,GAAG;QACpCA;MADoC,CAAH,GAE/B,IAFiB;IADT,CAAd;IAKA,KAAK,CAACuqC,QAAN,CAAe96D,IAAf,CAAoB,MAAM;MACxB,KAAK,MAAMq0D,QAAX,IAAuB,KAAK,CAACzM,SAA7B,EAAwC;QACtCyM,QAAQ,CAAC38E,IAAT,CAAc,IAAd,EAAoBy1B,KAApB;MACD;IACF,CAJD;EAKD;;EACDrG,gBAAgB,CAAC3a,IAAD,EAAOkoE,QAAP,EAAiB;IAC/B,KAAK,CAACzM,SAAN,CAAgB//C,GAAhB,CAAoBwsD,QAApB;EACD;;EACD3W,mBAAmB,CAACvxD,IAAD,EAAOkoE,QAAP,EAAiB;IAClC,KAAK,CAACzM,SAAN,CAAgBx/C,MAAhB,CAAuBisD,QAAvB;EACD;;EACD0G,SAAS,GAAG;IACV,KAAK,CAACnT,SAAN,CAAgB/pD,KAAhB;EACD;;AAvBgB;;AAyBnB,MAAM1kB,SAAN,CAAgB;EACd,OAAO,CAAC6hF,YAAR,GAAuB,CAAvB;EACA,OAAO,CAACC,gBAAR,GAA2B,KAA3B;EACA,OAAO,CAACC,WAAR;EACA;IACE,IAAIvgF,QAAJ,EAAc;MACZ,KAAK,CAACsgF,gBAAN,GAAyB,IAAzB;MACAtiF,mBAAmB,CAACghE,SAApB,KAAkC,kBAAlC;IACD;;IACD,KAAKwhB,aAAL,GAAqB,CAAClwE,OAAD,EAAUmwE,QAAV,KAAuB;MAC1C,IAAIC,IAAJ;;MACA,IAAI;QACFA,IAAI,GAAG,IAAI1vE,GAAJ,CAAQV,OAAR,CAAP;;QACA,IAAI,CAACowE,IAAI,CAACC,MAAN,IAAgBD,IAAI,CAACC,MAAL,KAAgB,MAApC,EAA4C;UAC1C,OAAO,KAAP;QACD;MACF,CALD,CAKE,MAAM;QACN,OAAO,KAAP;MACD;;MACD,MAAMC,KAAK,GAAG,IAAI5vE,GAAJ,CAAQyvE,QAAR,EAAkBC,IAAlB,CAAd;MACA,OAAOA,IAAI,CAACC,MAAL,KAAgBC,KAAK,CAACD,MAA7B;IACD,CAZD;;IAaA,KAAKE,iBAAL,GAAyBzwE,GAAG,IAAI;MAC9B,MAAM0wE,OAAO,GAAI,iBAAgB1wE,GAAI,KAArC;MACA,OAAOY,GAAG,CAAC+vE,eAAJ,CAAoB,IAAIC,IAAJ,CAAS,CAACF,OAAD,CAAT,EAAoB;QAC7CzgF,IAAI,EAAE;MADuC,CAApB,CAApB,CAAP;IAGD,CALD;;EAlBF;;EAyBAoR,WAAW,CAAC;IACVD,IAAI,GAAG,IADG;IAEVqtD,IAAI,GAAG,IAFG;IAGVzvD,SAAS,GAAGK,iBAAiB;EAHnB,IAIR,EAJO,EAIH;IACN,KAAK+B,IAAL,GAAYA,IAAZ;IACA,KAAKumE,SAAL,GAAiB,KAAjB;IACA,KAAK3oE,SAAL,GAAiBA,SAAjB;IACA,KAAKqqE,gBAAL,GAAwBj1D,OAAO,CAACm4B,aAAR,EAAxB;IACA,KAAKskC,KAAL,GAAa,IAAb;IACA,KAAKC,UAAL,GAAkB,IAAlB;IACA,KAAKC,eAAL,GAAuB,IAAvB;;IACA,IAAItiB,IAAJ,EAAU;MACR,IAAIrgE,SAAS,CAAC,CAAC+hF,WAAX,EAAwBztD,GAAxB,CAA4B+rC,IAA5B,CAAJ,EAAuC;QACrC,MAAM,IAAI7uD,KAAJ,CAAU,8CAAV,CAAN;MACD;;MACD,CAACxR,SAAS,CAAC,CAAC+hF,WAAX,KAA2B,IAAIzO,OAAJ,EAA5B,EAA2C7wD,GAA3C,CAA+C49C,IAA/C,EAAqD,IAArD;;MACA,KAAKuiB,mBAAL,CAAyBviB,IAAzB;;MACA;IACD;;IACD,KAAKwiB,WAAL;EACD;;EACU,IAAPhyD,OAAO,GAAG;IACZ,IAAIrvB,QAAJ,EAAc;MACZ,OAAOwkB,OAAO,CAAC+5D,GAAR,CAAY,CAACrhC,YAAY,CAAC7tB,OAAd,EAAuB,KAAKoqD,gBAAL,CAAsBpqD,OAA7C,CAAZ,CAAP;IACD;;IACD,OAAO,KAAKoqD,gBAAL,CAAsBpqD,OAA7B;EACD;;EACD,CAAC5K,OAAO,GAAG;IACT,KAAKg1D,gBAAL,CAAsBh1D,OAAtB;;IACA,KAAK08D,eAAL,CAAqBh8D,IAArB,CAA0B,WAA1B,EAAuC;MACrC/V,SAAS,EAAE,KAAKA;IADqB,CAAvC;EAGD;;EACO,IAAJyvD,IAAI,GAAG;IACT,OAAO,KAAKoiB,KAAZ;EACD;;EACiB,IAAdhJ,cAAc,GAAG;IACnB,OAAO,KAAKkJ,eAAZ;EACD;;EACDC,mBAAmB,CAACviB,IAAD,EAAO;IACxB,KAAKoiB,KAAL,GAAapiB,IAAb;IACA,KAAKsiB,eAAL,GAAuB,IAAIrhB,cAAJ,CAAmB,MAAnB,EAA2B,QAA3B,EAAqCjB,IAArC,CAAvB;;IACA,KAAKsiB,eAAL,CAAqBhnD,EAArB,CAAwB,OAAxB,EAAiC,YAAY,CAAE,CAA/C;;IACA,KAAK,CAAC1V,OAAN;EACD;;EACD48D,WAAW,GAAG;IACZ,IAAI7iF,SAAS,CAAC,CAAC8hF,gBAAX,IAA+B9hF,SAAS,CAAC,CAAC8iF,8BAA9C,EAA8E;MAC5E,KAAKC,gBAAL;;MACA;IACD;;IACD,IAAI;MACFviB;IADE,IAEAxgE,SAFJ;;IAGA,IAAI;MACF,IAAI,CAACA,SAAS,CAACgiF,aAAV,CAAwBt2D,MAAM,CAAC0uD,QAAP,CAAgBD,IAAxC,EAA8C3Z,SAA9C,CAAL,EAA+D;QAC7DA,SAAS,GAAGxgE,SAAS,CAACqiF,iBAAV,CAA4B,IAAI7vE,GAAJ,CAAQguD,SAAR,EAAmB90C,MAAM,CAAC0uD,QAA1B,EAAoCD,IAAhE,CAAZ;MACD;;MACD,MAAMxC,MAAM,GAAG,IAAIpX,MAAJ,CAAWC,SAAX,EAAsB;QACnC3+D,IAAI,EAAE;MAD6B,CAAtB,CAAf;MAGA,MAAM43E,cAAc,GAAG,IAAInY,cAAJ,CAAmB,MAAnB,EAA2B,QAA3B,EAAqCqW,MAArC,CAAvB;;MACA,MAAMqL,cAAc,GAAG,MAAM;QAC3BpoD,EAAE,CAACL,KAAH;QACAk/C,cAAc,CAACn7D,OAAf;QACAq5D,MAAM,CAACiK,SAAP;;QACA,IAAI,KAAKrI,SAAT,EAAoB;UAClB,KAAK0B,gBAAL,CAAsB/0D,MAAtB,CAA6B,IAAI1U,KAAJ,CAAU,sBAAV,CAA7B;QACD,CAFD,MAEO;UACL,KAAKuxE,gBAAL;QACD;MACF,CATD;;MAUA,MAAMnoD,EAAE,GAAG,IAAIxF,eAAJ,EAAX;MACAuiD,MAAM,CAAChqD,gBAAP,CAAwB,OAAxB,EAAiC,MAAM;QACrC,IAAI,CAAC,KAAK+0D,UAAV,EAAsB;UACpBM,cAAc;QACf;MACF,CAJD,EAIG;QACDx1D,MAAM,EAAEoN,EAAE,CAACpN;MADV,CAJH;MAOAisD,cAAc,CAAC99C,EAAf,CAAkB,MAAlB,EAA0B7U,IAAI,IAAI;QAChC8T,EAAE,CAACL,KAAH;;QACA,IAAI,KAAKg/C,SAAL,IAAkB,CAACzyD,IAAvB,EAA6B;UAC3Bk8D,cAAc;UACd;QACD;;QACD,KAAKL,eAAL,GAAuBlJ,cAAvB;QACA,KAAKgJ,KAAL,GAAa9K,MAAb;QACA,KAAK+K,UAAL,GAAkB/K,MAAlB;QACA,KAAK,CAAC1xD,OAAN;MACD,CAVD;MAWAwzD,cAAc,CAAC99C,EAAf,CAAkB,OAAlB,EAA2B7U,IAAI,IAAI;QACjC8T,EAAE,CAACL,KAAH;;QACA,IAAI,KAAKg/C,SAAT,EAAoB;UAClByJ,cAAc;UACd;QACD;;QACD,IAAI;UACFC,QAAQ;QACT,CAFD,CAEE,MAAM;UACN,KAAKF,gBAAL;QACD;MACF,CAXD;;MAYA,MAAME,QAAQ,GAAG,MAAM;QACrB,MAAMC,OAAO,GAAG,IAAIxuE,UAAJ,EAAhB;QACA+kE,cAAc,CAAC9yD,IAAf,CAAoB,MAApB,EAA4Bu8D,OAA5B,EAAqC,CAACA,OAAO,CAAC5tE,MAAT,CAArC;MACD,CAHD;;MAIA2tE,QAAQ;MACR;IACD,CAvDD,CAuDE,MAAM;MACN/xE,IAAI,CAAC,+BAAD,CAAJ;IACD;;IACD,KAAK6xE,gBAAL;EACD;;EACDA,gBAAgB,GAAG;IACjB,IAAI,CAAC/iF,SAAS,CAAC,CAAC8hF,gBAAhB,EAAkC;MAChCxwE,IAAI,CAAC,yBAAD,CAAJ;MACAtR,SAAS,CAAC,CAAC8hF,gBAAX,GAA8B,IAA9B;IACD;;IACD9hF,SAAS,CAACmjF,sBAAV,CAAiCt8D,IAAjC,CAAsCu8D,oBAAoB,IAAI;MAC5D,IAAI,KAAK7J,SAAT,EAAoB;QAClB,KAAK0B,gBAAL,CAAsB/0D,MAAtB,CAA6B,IAAI1U,KAAJ,CAAU,sBAAV,CAA7B;;QACA;MACD;;MACD,MAAM6uD,IAAI,GAAG,IAAIqhB,YAAJ,EAAb;MACA,KAAKe,KAAL,GAAapiB,IAAb;MACA,MAAM1/C,EAAE,GAAI,OAAM3gB,SAAS,CAAC,CAAC6hF,YAAX,EAA0B,EAA5C;MACA,MAAMwB,aAAa,GAAG,IAAI/hB,cAAJ,CAAmB3gD,EAAE,GAAG,SAAxB,EAAmCA,EAAnC,EAAuC0/C,IAAvC,CAAtB;MACA+iB,oBAAoB,CAACE,KAArB,CAA2BD,aAA3B,EAA0ChjB,IAA1C;MACA,KAAKsiB,eAAL,GAAuB,IAAIrhB,cAAJ,CAAmB3gD,EAAnB,EAAuBA,EAAE,GAAG,SAA5B,EAAuC0/C,IAAvC,CAAvB;MACA,KAAK,CAACp6C,OAAN;IACD,CAZD,EAYGzG,KAZH,CAYSC,MAAM,IAAI;MACjB,KAAKw7D,gBAAL,CAAsB/0D,MAAtB,CAA6B,IAAI1U,KAAJ,CAAW,mCAAkCiO,MAAM,CAAC1M,OAAQ,IAA5D,CAA7B;IACD,CAdD;EAeD;;EACDuL,OAAO,GAAG;IACR,KAAKi7D,SAAL,GAAiB,IAAjB;;IACA,IAAI,KAAKmJ,UAAT,EAAqB;MACnB,KAAKA,UAAL,CAAgBd,SAAhB;;MACA,KAAKc,UAAL,GAAkB,IAAlB;IACD;;IACD1iF,SAAS,CAAC,CAAC+hF,WAAX,EAAwB9yD,MAAxB,CAA+B,KAAKwzD,KAApC;IACA,KAAKA,KAAL,GAAa,IAAb;;IACA,IAAI,KAAKE,eAAT,EAA0B;MACxB,KAAKA,eAAL,CAAqBrkE,OAArB;;MACA,KAAKqkE,eAAL,GAAuB,IAAvB;IACD;EACF;;EACc,OAAR3J,QAAQ,CAACj0C,MAAD,EAAS;IACtB,IAAI,CAACA,MAAM,EAAEs7B,IAAb,EAAmB;MACjB,MAAM,IAAI7uD,KAAJ,CAAU,gDAAV,CAAN;IACD;;IACD,MAAM+xE,UAAU,GAAG,KAAK,CAACxB,WAAN,EAAmB7jF,GAAnB,CAAuB6mC,MAAM,CAACs7B,IAA9B,CAAnB;;IACA,IAAIkjB,UAAJ,EAAgB;MACd,IAAIA,UAAU,CAAC3I,eAAf,EAAgC;QAC9B,MAAM,IAAIppE,KAAJ,CAAU,0DAA0D,oEAApE,CAAN;MACD;;MACD,OAAO+xE,UAAP;IACD;;IACD,OAAO,IAAIvjF,SAAJ,CAAc+kC,MAAd,CAAP;EACD;;EACmB,WAATy7B,SAAS,GAAG;IACrB,IAAIhhE,mBAAmB,CAACghE,SAAxB,EAAmC;MACjC,OAAOhhE,mBAAmB,CAACghE,SAA3B;IACD;;IACD,MAAM,IAAIhvD,KAAJ,CAAU,+CAAV,CAAN;EACD;;EACyC,WAA/B,CAACsxE,8BAA8B,GAAG;IAC3C,IAAI;MACF,OAAOrkF,UAAU,CAAC+kF,WAAX,EAAwBJ,oBAAxB,IAAgD,IAAvD;IACD,CAFD,CAEE,MAAM;MACN,OAAO,IAAP;IACD;EACF;;EACgC,WAAtBD,sBAAsB,GAAG;IAAA;;IAClC,MAAMM,MAAM;MAAA,8BAAG,aAAY;QACzB,IAAI,OAAI,CAAC,CAACX,8BAAV,EAA0C;UACxC,OAAO,OAAI,CAAC,CAACA,8BAAb;QACD;;QACD,MAAMnL,MAAM,SAAS;QAAQ;QAAuB,OAAI,CAACnX,SAApC,CAArB;QACA,OAAOmX,MAAM,CAACyL,oBAAd;MACD,CANW;;MAAA,gBAANK,MAAM;QAAA;MAAA;IAAA,GAAZ;;IAOA,OAAOniF,MAAM,CAAC,IAAD,EAAO,wBAAP,EAAiCmiF,MAAM,EAAvC,CAAb;EACD;;AApNa;;AAsNhB,MAAMzJ,eAAN,CAAsB;EACpB,CAAC0J,cAAD,GAAkB,IAAIpnE,GAAJ,EAAlB;EACA,CAACqnE,SAAD,GAAa,IAAIrnE,GAAJ,EAAb;EACA,CAACsnE,YAAD,GAAgB,IAAItnE,GAAJ,EAAhB;EACA,CAACunE,YAAD,GAAgB,IAAIvnE,GAAJ,EAAhB;EACA,CAACwnE,kBAAD,GAAsB,IAAtB;;EACA7wE,WAAW,CAACwmE,cAAD,EAAiB6D,WAAjB,EAA8B5D,aAA9B,EAA6C30C,MAA7C,EAAqDg/C,OAArD,EAA8D;IACvE,KAAKtK,cAAL,GAAsBA,cAAtB;IACA,KAAK6D,WAAL,GAAmBA,WAAnB;IACA,KAAK3qB,UAAL,GAAkB,IAAIwrB,UAAJ,EAAlB;IACA,KAAK6F,UAAL,GAAkB,IAAI/qC,UAAJ,CAAe;MAC/Br4B,aAAa,EAAEmkB,MAAM,CAACnkB,aADS;MAE/Bu4B,YAAY,EAAEpU,MAAM,CAACoU;IAFU,CAAf,CAAlB;IAIA,KAAKmgC,aAAL,GAAqBv0C,MAAM,CAACu0C,aAA5B;IACA,KAAK2K,OAAL,GAAel/C,MAAf;IACA,KAAKymB,aAAL,GAAqBu4B,OAAO,CAACv4B,aAA7B;IACA,KAAKn1B,aAAL,GAAqB0tD,OAAO,CAAC1tD,aAA7B;IACA,KAAKwiD,iBAAL,GAAyBkL,OAAO,CAAClL,iBAAjC;IACA,KAAKC,uBAAL,GAA+BiL,OAAO,CAACjL,uBAAvC;IACA,KAAKS,SAAL,GAAiB,KAAjB;IACA,KAAK2K,iBAAL,GAAyB,IAAzB;IACA,KAAKC,cAAL,GAAsBzK,aAAtB;IACA,KAAK0K,WAAL,GAAmB,IAAnB;IACA,KAAKC,aAAL,GAAqB,IAArB;IACA,KAAKlH,sBAAL,GAA8Bn3D,OAAO,CAACm4B,aAAR,EAA9B;IACA,KAAKmmC,mBAAL;EACD;;EACD,CAACC,iBAAiB,CAACvxE,IAAD,EAAO8T,IAAI,GAAG,IAAd,EAAoB;IACpC,MAAM09D,aAAa,GAAG,KAAK,CAACd,cAAN,CAAqBxlF,GAArB,CAAyB8U,IAAzB,CAAtB;;IACA,IAAIwxE,aAAJ,EAAmB;MACjB,OAAOA,aAAP;IACD;;IACD,MAAM3zD,OAAO,GAAG,KAAK4oD,cAAL,CAAoB7W,eAApB,CAAoC5vD,IAApC,EAA0C8T,IAA1C,CAAhB;IACA,KAAK,CAAC48D,cAAN,CAAqBjhE,GAArB,CAAyBzP,IAAzB,EAA+B6d,OAA/B;IACA,OAAOA,OAAP;EACD;;EACoB,IAAjB4E,iBAAiB,GAAG;IACtB,OAAOn0B,MAAM,CAAC,IAAD,EAAO,mBAAP,EAA4B,IAAI+1C,iBAAJ,EAA5B,CAAb;EACD;;EACDwlC,kBAAkB,CAACvlB,MAAD,EAASqnB,cAAc,GAAG1/E,cAAc,CAAC8D,MAAzC,EAAiD87E,sBAAsB,GAAG,IAA1E,EAAgFrnD,SAAS,GAAG,KAA5F,EAAmGitD,QAAQ,GAAG,KAA9G,EAAqH;IACrI,IAAIvf,eAAe,GAAG9iE,mBAAmB,CAACE,OAA1C;IACA,IAAI++E,6BAA6B,GAAGnqC,iBAApC;;IACA,QAAQogB,MAAR;MACE,KAAK,KAAL;QACE4N,eAAe,GAAG9iE,mBAAmB,CAACC,GAAtC;QACA;;MACF,KAAK,SAAL;QACE;;MACF,KAAK,OAAL;QACE6iE,eAAe,GAAG9iE,mBAAmB,CAACG,KAAtC;QACA;;MACF;QACE+O,IAAI,CAAE,wCAAuCgmD,MAAO,EAAhD,CAAJ;IAVJ;;IAYA,MAAM7hC,iBAAiB,GAAGyvC,eAAe,GAAG9iE,mBAAmB,CAACG,KAAtC,IAA+Cs8E,sBAAsB,YAAYxmC,sBAAjF,GAA0GwmC,sBAA1G,GAAmI,KAAKppD,iBAAlK;;IACA,QAAQkpD,cAAR;MACE,KAAK1/E,cAAc,CAAC6D,OAApB;QACEoiE,eAAe,IAAI9iE,mBAAmB,CAACO,mBAAvC;QACA;;MACF,KAAK1D,cAAc,CAAC8D,MAApB;QACE;;MACF,KAAK9D,cAAc,CAAC+D,YAApB;QACEkiE,eAAe,IAAI9iE,mBAAmB,CAACK,iBAAvC;QACA;;MACF,KAAKxD,cAAc,CAACgE,cAApB;QACEiiE,eAAe,IAAI9iE,mBAAmB,CAACM,mBAAvC;QACA2+E,6BAA6B,GAAG5rD,iBAAiB,CAAC6iB,YAAlD;QACA;;MACF;QACEhnC,IAAI,CAAE,gDAA+CqtE,cAAe,EAAhE,CAAJ;IAdJ;;IAgBA,IAAInnD,SAAJ,EAAe;MACb0tC,eAAe,IAAI9iE,mBAAmB,CAACQ,UAAvC;IACD;;IACD,IAAI6hF,QAAJ,EAAc;MACZvf,eAAe,IAAI9iE,mBAAmB,CAACS,MAAvC;IACD;;IACD,MAAM;MACJk2C,GAAG,EAAExB,WADD;MAEJJ,IAAI,EAAEutC;IAFF,IAGFjvD,iBAAiB,CAAC8hB,WAHtB;IAIA,MAAMotC,WAAW,GAAG,CAACzf,eAAD,EAAkBmc,6BAA6B,CAAClqC,IAAhD,EAAsDutC,eAAtD,CAApB;IACA,OAAO;MACLxf,eADK;MAEL1O,QAAQ,EAAEmuB,WAAW,CAACpwE,IAAZ,CAAiB,GAAjB,CAFL;MAGL8sE,6BAHK;MAIL9pC;IAJK,CAAP;EAMD;;EACDj5B,OAAO,GAAG;IACR,IAAI,KAAK4lE,iBAAT,EAA4B;MAC1B,OAAO,KAAKA,iBAAL,CAAuBrzD,OAA9B;IACD;;IACD,KAAK0oD,SAAL,GAAiB,IAAjB;IACA,KAAK2K,iBAAL,GAAyBl+D,OAAO,CAACm4B,aAAR,EAAzB;IACA,KAAK,CAAC2lC,kBAAN,EAA0B59D,MAA1B,CAAiC,IAAI1U,KAAJ,CAAU,iDAAV,CAAjC;IACA,MAAMqvE,MAAM,GAAG,EAAf;;IACA,KAAK,MAAM+D,IAAX,IAAmB,KAAK,CAACjB,SAAN,CAAgBlpD,MAAhB,EAAnB,EAA6C;MAC3ComD,MAAM,CAACvsE,IAAP,CAAYswE,IAAI,CAAChE,QAAL,EAAZ;IACD;;IACD,KAAK,CAAC+C,SAAN,CAAgBj/D,KAAhB;IACA,KAAK,CAACk/D,YAAN,CAAmBl/D,KAAnB;IACA,KAAK,CAACm/D,YAAN,CAAmBn/D,KAAnB;;IACA,IAAI,KAAKpmB,cAAL,CAAoB,mBAApB,CAAJ,EAA8C;MAC5C,KAAKm3B,iBAAL,CAAuBqiB,aAAvB;IACD;;IACD,MAAM+sC,UAAU,GAAG,KAAKpL,cAAL,CAAoB7W,eAApB,CAAoC,WAApC,EAAiD,IAAjD,CAAnB;IACAie,MAAM,CAACvsE,IAAP,CAAYuwE,UAAZ;IACA7+D,OAAO,CAAC+5D,GAAR,CAAYc,MAAZ,EAAoBh6D,IAApB,CAAyB,MAAM;MAC7B,KAAK8rC,UAAL,CAAgBjuC,KAAhB;MACA,KAAKs/D,UAAL,CAAgBt/D,KAAhB;MACA,KAAK,CAACg/D,cAAN,CAAqBh/D,KAArB;MACA,KAAK2R,aAAL,CAAmB/X,OAAnB;MACAje,SAAS,CAACs1E,OAAV;MACA,KAAKwO,cAAL,EAAqB3a,iBAArB,CAAuC,IAAI7qE,cAAJ,CAAmB,wBAAnB,CAAvC;;MACA,IAAI,KAAK86E,cAAT,EAAyB;QACvB,KAAKA,cAAL,CAAoBn7D,OAApB;QACA,KAAKm7D,cAAL,GAAsB,IAAtB;MACD;;MACD,KAAKyK,iBAAL,CAAuBj+D,OAAvB;IACD,CAZD,EAYG,KAAKi+D,iBAAL,CAAuBh+D,MAZ1B;IAaA,OAAO,KAAKg+D,iBAAL,CAAuBrzD,OAA9B;EACD;;EACDyzD,mBAAmB,GAAG;IACpB,MAAM;MACJ7K,cADI;MAEJ6D;IAFI,IAGF,IAHJ;IAIA7D,cAAc,CAAC99C,EAAf,CAAkB,WAAlB,EAA+B,CAAC7U,IAAD,EAAOg+D,IAAP,KAAgB;MAC7CrzE,MAAM,CAAC,KAAK0yE,cAAN,EAAsB,iDAAtB,CAAN;MACA,KAAKC,WAAL,GAAmB,KAAKD,cAAL,CAAoBjb,aAApB,EAAnB;;MACA,KAAKkb,WAAL,CAAiBtb,UAAjB,GAA8B/uC,GAAG,IAAI;QACnC,KAAKsqD,aAAL,GAAqB;UACnBtpC,MAAM,EAAEhhB,GAAG,CAACghB,MADO;UAEnBmtB,KAAK,EAAEnuC,GAAG,CAACmuC;QAFQ,CAArB;MAID,CALD;;MAMA4c,IAAI,CAAC7gB,MAAL,GAAc,MAAM;QAClB,KAAKmgB,WAAL,CAAiBja,IAAjB,GAAwBtjD,IAAxB,CAA6B,UAAU;UACrCpU,KADqC;UAErCgpC;QAFqC,CAAV,EAG1B;UACD,IAAIA,IAAJ,EAAU;YACRqpC,IAAI,CAAC9gB,KAAL;YACA;UACD;;UACDvyD,MAAM,CAACgB,KAAK,YAAYuU,WAAlB,EAA+B,sCAA/B,CAAN;UACA89D,IAAI,CAACnhB,OAAL,CAAa,IAAIjvD,UAAJ,CAAejC,KAAf,CAAb,EAAoC,CAApC,EAAuC,CAACA,KAAD,CAAvC;QACD,CAVD,EAUG+M,KAVH,CAUSC,MAAM,IAAI;UACjBqlE,IAAI,CAAC9yD,KAAL,CAAWvS,MAAX;QACD,CAZD;MAaD,CAdD;;MAeAqlE,IAAI,CAAC5gB,QAAL,GAAgBzkD,MAAM,IAAI;QACxB,KAAK2kE,WAAL,CAAiBh7C,MAAjB,CAAwB3pB,MAAxB;;QACAqlE,IAAI,CAAC/gB,KAAL,CAAWvkD,KAAX,CAAiBulE,WAAW,IAAI;UAC9B,IAAI,KAAKxL,SAAT,EAAoB;YAClB;UACD;;UACD,MAAMwL,WAAN;QACD,CALD;MAMD,CARD;IASD,CAjCD;IAkCAtL,cAAc,CAAC99C,EAAf,CAAkB,oBAAlB,EAAwC7U,IAAI,IAAI;MAC9C,MAAMk+D,iBAAiB,GAAGh/D,OAAO,CAACm4B,aAAR,EAA1B;MACA,MAAM8mC,UAAU,GAAG,KAAKb,WAAxB;MACAa,UAAU,CAAClb,YAAX,CAAwBljD,IAAxB,CAA6B,MAAM;QACjC,IAAI,CAACo+D,UAAU,CAAChb,oBAAZ,IAAoC,CAACgb,UAAU,CAACjb,gBAApD,EAAsE;UACpE,IAAI,KAAKqa,aAAT,EAAwB;YACtB/G,WAAW,CAACxU,UAAZ,GAAyB,KAAKub,aAA9B;UACD;;UACDY,UAAU,CAACnc,UAAX,GAAwB/uC,GAAG,IAAI;YAC7BujD,WAAW,CAACxU,UAAZ,GAAyB;cACvB/tB,MAAM,EAAEhhB,GAAG,CAACghB,MADW;cAEvBmtB,KAAK,EAAEnuC,GAAG,CAACmuC;YAFY,CAAzB;UAID,CALD;QAMD;;QACD8c,iBAAiB,CAAC/+D,OAAlB,CAA0B;UACxBgkD,oBAAoB,EAAEgb,UAAU,CAAChb,oBADT;UAExBD,gBAAgB,EAAEib,UAAU,CAACjb,gBAFL;UAGxBE,aAAa,EAAE+a,UAAU,CAAC/a;QAHF,CAA1B;MAKD,CAjBD,EAiBG8a,iBAAiB,CAAC9+D,MAjBrB;MAkBA,OAAO8+D,iBAAiB,CAACn0D,OAAzB;IACD,CAtBD;IAuBA4oD,cAAc,CAAC99C,EAAf,CAAkB,gBAAlB,EAAoC,CAAC7U,IAAD,EAAOg+D,IAAP,KAAgB;MAClDrzE,MAAM,CAAC,KAAK0yE,cAAN,EAAsB,sDAAtB,CAAN;;MACA,MAAMzb,WAAW,GAAG,KAAKyb,cAAL,CAAoB9a,cAApB,CAAmCviD,IAAI,CAACihD,KAAxC,EAA+CjhD,IAAI,CAACzD,GAApD,CAApB;;MACA,IAAI,CAACqlD,WAAL,EAAkB;QAChBoc,IAAI,CAAC9gB,KAAL;QACA;MACD;;MACD8gB,IAAI,CAAC7gB,MAAL,GAAc,MAAM;QAClByE,WAAW,CAACyB,IAAZ,GAAmBtjD,IAAnB,CAAwB,UAAU;UAChCpU,KADgC;UAEhCgpC;QAFgC,CAAV,EAGrB;UACD,IAAIA,IAAJ,EAAU;YACRqpC,IAAI,CAAC9gB,KAAL;YACA;UACD;;UACDvyD,MAAM,CAACgB,KAAK,YAAYuU,WAAlB,EAA+B,2CAA/B,CAAN;UACA89D,IAAI,CAACnhB,OAAL,CAAa,IAAIjvD,UAAJ,CAAejC,KAAf,CAAb,EAAoC,CAApC,EAAuC,CAACA,KAAD,CAAvC;QACD,CAVD,EAUG+M,KAVH,CAUSC,MAAM,IAAI;UACjBqlE,IAAI,CAAC9yD,KAAL,CAAWvS,MAAX;QACD,CAZD;MAaD,CAdD;;MAeAqlE,IAAI,CAAC5gB,QAAL,GAAgBzkD,MAAM,IAAI;QACxBipD,WAAW,CAACt/B,MAAZ,CAAmB3pB,MAAnB;QACAqlE,IAAI,CAAC/gB,KAAL,CAAWvkD,KAAX,CAAiBulE,WAAW,IAAI;UAC9B,IAAI,KAAKxL,SAAT,EAAoB;YAClB;UACD;;UACD,MAAMwL,WAAN;QACD,CALD;MAMD,CARD;IASD,CA/BD;IAgCAtL,cAAc,CAAC99C,EAAf,CAAkB,QAAlB,EAA4B,CAAC;MAC3B6/C;IAD2B,CAAD,KAEtB;MACJ,KAAK0J,SAAL,GAAiB1J,OAAO,CAACE,QAAzB;MACA,KAAKG,WAAL,GAAmBL,OAAO,CAAC2J,UAA3B;MACA,OAAO3J,OAAO,CAAC2J,UAAf;;MACA7H,WAAW,CAACpD,WAAZ,CAAwBj0D,OAAxB,CAAgC,IAAIs1D,gBAAJ,CAAqBC,OAArB,EAA8B,IAA9B,CAAhC;IACD,CAPD;IAQA/B,cAAc,CAAC99C,EAAf,CAAkB,cAAlB,EAAkC,UAAU5gB,EAAV,EAAc;MAC9C,IAAI0E,MAAJ;;MACA,QAAQ1E,EAAE,CAAC/H,IAAX;QACE,KAAK,mBAAL;UACEyM,MAAM,GAAG,IAAIvM,iBAAJ,CAAsB6H,EAAE,CAAChI,OAAzB,EAAkCgI,EAAE,CAAC5H,IAArC,CAAT;UACA;;QACF,KAAK,qBAAL;UACEsM,MAAM,GAAG,IAAI9f,mBAAJ,CAAwBob,EAAE,CAAChI,OAA3B,CAAT;UACA;;QACF,KAAK,qBAAL;UACE0M,MAAM,GAAG,IAAI7f,mBAAJ,CAAwBmb,EAAE,CAAChI,OAA3B,CAAT;UACA;;QACF,KAAK,6BAAL;UACE0M,MAAM,GAAG,IAAInf,2BAAJ,CAAgCya,EAAE,CAAChI,OAAnC,EAA4CgI,EAAE,CAACzH,MAA/C,CAAT;UACA;;QACF,KAAK,uBAAL;UACEmM,MAAM,GAAG,IAAIrM,qBAAJ,CAA0B2H,EAAE,CAAChI,OAA7B,EAAsCgI,EAAE,CAAC1H,OAAzC,CAAT;UACA;;QACF;UACE9B,WAAW,CAAC,wCAAD,CAAX;MAjBJ;;MAmBA+rE,WAAW,CAACpD,WAAZ,CAAwBh0D,MAAxB,CAA+BzG,MAA/B;IACD,CAtBD;IAuBAg6D,cAAc,CAAC99C,EAAf,CAAkB,iBAAlB,EAAqCypD,SAAS,IAAI;MAChD,KAAK,CAACtB,kBAAN,GAA2B99D,OAAO,CAACm4B,aAAR,EAA3B;;MACA,IAAIm/B,WAAW,CAAC3C,UAAhB,EAA4B;QAC1B,MAAM0K,cAAc,GAAG5N,QAAQ,IAAI;UACjC,IAAIA,QAAQ,YAAYjmE,KAAxB,EAA+B;YAC7B,KAAK,CAACsyE,kBAAN,CAAyB59D,MAAzB,CAAgCuxD,QAAhC;UACD,CAFD,MAEO;YACL,KAAK,CAACqM,kBAAN,CAAyB79D,OAAzB,CAAiC;cAC/BwxD;YAD+B,CAAjC;UAGD;QACF,CARD;;QASA,IAAI;UACF6F,WAAW,CAAC3C,UAAZ,CAAuB0K,cAAvB,EAAuCD,SAAS,CAACjyE,IAAjD;QACD,CAFD,CAEE,OAAO4H,EAAP,EAAW;UACX,KAAK,CAAC+oE,kBAAN,CAAyB59D,MAAzB,CAAgCnL,EAAhC;QACD;MACF,CAfD,MAeO;QACL,KAAK,CAAC+oE,kBAAN,CAAyB59D,MAAzB,CAAgC,IAAIhT,iBAAJ,CAAsBkyE,SAAS,CAACryE,OAAhC,EAAyCqyE,SAAS,CAACjyE,IAAnD,CAAhC;MACD;;MACD,OAAO,KAAK,CAAC2wE,kBAAN,CAAyBjzD,OAAhC;IACD,CArBD;IAsBA4oD,cAAc,CAAC99C,EAAf,CAAkB,YAAlB,EAAgC7U,IAAI,IAAI;MACtCw2D,WAAW,CAACxU,UAAZ,GAAyB;QACvB/tB,MAAM,EAAEj0B,IAAI,CAAC1U,MADU;QAEvB81D,KAAK,EAAEphD,IAAI,CAAC1U;MAFW,CAAzB;MAIA,KAAK+qE,sBAAL,CAA4Bl3D,OAA5B,CAAoCa,IAApC;IACD,CAND;IAOA2yD,cAAc,CAAC99C,EAAf,CAAkB,iBAAlB,EAAqC7U,IAAI,IAAI;MAC3C,IAAI,KAAKyyD,SAAT,EAAoB;QAClB;MACD;;MACD,MAAMqL,IAAI,GAAG,KAAK,CAACjB,SAAN,CAAgBzlF,GAAhB,CAAoB4oB,IAAI,CAACib,SAAzB,CAAb;;MACA6iD,IAAI,CAAC1D,gBAAL,CAAsBp6D,IAAI,CAACwtC,YAA3B,EAAyCxtC,IAAI,CAAC0vC,QAA9C;IACD,CAND;IAOAijB,cAAc,CAAC99C,EAAf,CAAkB,WAAlB,EAA+B,CAAC,CAAChb,EAAD,EAAK9e,IAAL,EAAWyjF,YAAX,CAAD,KAA8B;MAC3D,IAAI,KAAK/L,SAAT,EAAoB;QAClB,OAAO,IAAP;MACD;;MACD,IAAI,KAAK5mB,UAAL,CAAgBr+B,GAAhB,CAAoB3T,EAApB,CAAJ,EAA6B;QAC3B,OAAO,IAAP;MACD;;MACD,QAAQ9e,IAAR;QACE,KAAK,MAAL;UACE,MAAM;YACJw4C,eADI;YAEJi+B,mBAFI;YAGJG;UAHI,IAIF,KAAKwL,OAJT;;UAKA,IAAI,WAAWqB,YAAf,EAA6B;YAC3B,MAAMC,aAAa,GAAGD,YAAY,CAACtzD,KAAnC;YACA1gB,IAAI,CAAE,8BAA6Bi0E,aAAc,EAA7C,CAAJ;YACA,KAAK5yB,UAAL,CAAgB1sC,OAAhB,CAAwBtF,EAAxB,EAA4B4kE,aAA5B;YACA;UACD;;UACD,MAAMpoC,WAAW,GAAGs7B,MAAM,IAAIh6E,UAAU,CAACo0E,aAAX,EAA0BxpC,OAApC,GAA8C,CAACsR,IAAD,EAAO/oC,GAAP,KAAenT,UAAU,CAACo0E,aAAX,CAAyB2S,SAAzB,CAAmC7qC,IAAnC,EAAyC/oC,GAAzC,CAA7D,GAA6G,IAAjI;UACA,MAAM+oC,IAAI,GAAG,IAAIsC,cAAJ,CAAmBqoC,YAAnB,EAAiC;YAC5CjrC,eAD4C;YAE5C8C;UAF4C,CAAjC,CAAb;UAIA,KAAK6mC,UAAL,CAAgBtgE,IAAhB,CAAqBi3B,IAArB,EAA2Bn7B,KAA3B,CAAiC,MAAMi6D,cAAc,CAAC7W,eAAf,CAA+B,cAA/B,EAA+C;YACpFjiD;UADoF,CAA/C,CAAvC,EAEI8kE,OAFJ,CAEY,MAAM;YAChB,IAAI,CAACnN,mBAAD,IAAwB39B,IAAI,CAAC7zB,IAAjC,EAAuC;cACrC6zB,IAAI,CAAC7zB,IAAL,GAAY,IAAZ;YACD;;YACD,KAAK6rC,UAAL,CAAgB1sC,OAAhB,CAAwBtF,EAAxB,EAA4Bg6B,IAA5B;UACD,CAPD;UAQA;;QACF,KAAK,gBAAL;UACE,MAAM;YACJ+qC;UADI,IAEFJ,YAFJ;UAGA7zE,MAAM,CAACi0E,QAAD,EAAW,+BAAX,CAAN;;UACA,KAAK,MAAMC,SAAX,IAAwB,KAAK,CAAChC,SAAN,CAAgBlpD,MAAhB,EAAxB,EAAkD;YAChD,KAAK,MAAM,GAAG3T,IAAH,CAAX,IAAuB6+D,SAAS,CAAC/nC,IAAjC,EAAuC;cACrC,IAAI92B,IAAI,EAAE0zD,GAAN,KAAckL,QAAlB,EAA4B;gBAC1B;cACD;;cACD,IAAI,CAAC5+D,IAAI,CAAC8+D,OAAV,EAAmB;gBACjB,OAAO,IAAP;cACD;;cACD,KAAKjzB,UAAL,CAAgB1sC,OAAhB,CAAwBtF,EAAxB,EAA4Bq4B,eAAe,CAAClyB,IAAD,CAA3C;cACA,OAAOA,IAAI,CAAC8+D,OAAZ;YACD;UACF;;UACD;;QACF,KAAK,UAAL;QACA,KAAK,OAAL;QACA,KAAK,SAAL;UACE,KAAKjzB,UAAL,CAAgB1sC,OAAhB,CAAwBtF,EAAxB,EAA4B2kE,YAA5B;UACA;;QACF;UACE,MAAM,IAAI9zE,KAAJ,CAAW,kCAAiC3P,IAAK,EAAjD,CAAN;MAnDJ;;MAqDA,OAAO,IAAP;IACD,CA7DD;IA8DA43E,cAAc,CAAC99C,EAAf,CAAkB,KAAlB,EAAyB,CAAC,CAAChb,EAAD,EAAKohB,SAAL,EAAgBlgC,IAAhB,EAAsB66C,SAAtB,CAAD,KAAsC;MAC7D,IAAI,KAAK68B,SAAT,EAAoB;QAClB;MACD;;MACD,MAAMoM,SAAS,GAAG,KAAK,CAAChC,SAAN,CAAgBzlF,GAAhB,CAAoB6jC,SAApB,CAAlB;;MACA,IAAI4jD,SAAS,CAAC/nC,IAAV,CAAetpB,GAAf,CAAmB3T,EAAnB,CAAJ,EAA4B;QAC1B;MACD;;MACD,IAAIglE,SAAS,CAACtH,aAAV,CAAwB75D,IAAxB,KAAiC,CAArC,EAAwC;QACtCk4B,SAAS,EAAEzrB,MAAX,EAAmB+yC,KAAnB;QACA;MACD;;MACD,QAAQniE,IAAR;QACE,KAAK,OAAL;UACE8jF,SAAS,CAAC/nC,IAAV,CAAe33B,OAAf,CAAuBtF,EAAvB,EAA2B+7B,SAA3B;;UACA,IAAIA,SAAS,EAAEkpC,OAAX,GAAqB5jF,uBAAzB,EAAkD;YAChD2jF,SAAS,CAACvH,wBAAV,GAAqC,IAArC;UACD;;UACD;;QACF,KAAK,SAAL;UACEuH,SAAS,CAAC/nC,IAAV,CAAe33B,OAAf,CAAuBtF,EAAvB,EAA2B+7B,SAA3B;UACA;;QACF;UACE,MAAM,IAAIlrC,KAAJ,CAAW,2BAA0B3P,IAAK,EAA1C,CAAN;MAXJ;IAaD,CAzBD;IA0BA43E,cAAc,CAAC99C,EAAf,CAAkB,aAAlB,EAAiC7U,IAAI,IAAI;MACvC,IAAI,KAAKyyD,SAAT,EAAoB;QAClB;MACD;;MACD+D,WAAW,CAACxU,UAAZ,GAAyB;QACvB/tB,MAAM,EAAEj0B,IAAI,CAACi0B,MADU;QAEvBmtB,KAAK,EAAEphD,IAAI,CAACohD;MAFW,CAAzB;IAID,CARD;IASAuR,cAAc,CAAC99C,EAAf,CAAkB,kBAAlB,EAAsC7U,IAAI,IAAI;MAC5C,IAAI,KAAKyyD,SAAT,EAAoB;QAClB,OAAOvzD,OAAO,CAACE,MAAR,CAAe,IAAI1U,KAAJ,CAAU,uBAAV,CAAf,CAAP;MACD;;MACD,IAAI,CAAC,KAAKqnE,iBAAV,EAA6B;QAC3B,OAAO7yD,OAAO,CAACE,MAAR,CAAe,IAAI1U,KAAJ,CAAU,wEAAV,CAAf,CAAP;MACD;;MACD,OAAO,KAAKqnE,iBAAL,CAAuBx5D,KAAvB,CAA6ByH,IAA7B,CAAP;IACD,CARD;IASA2yD,cAAc,CAAC99C,EAAf,CAAkB,uBAAlB,EAA2C7U,IAAI,IAAI;MACjD,IAAI,KAAKyyD,SAAT,EAAoB;QAClB,OAAOvzD,OAAO,CAACE,MAAR,CAAe,IAAI1U,KAAJ,CAAU,uBAAV,CAAf,CAAP;MACD;;MACD,IAAI,CAAC,KAAKsnE,uBAAV,EAAmC;QACjC,OAAO9yD,OAAO,CAACE,MAAR,CAAe,IAAI1U,KAAJ,CAAU,8EAAV,CAAf,CAAP;MACD;;MACD,OAAO,KAAKsnE,uBAAL,CAA6Bz5D,KAA7B,CAAmCyH,IAAnC,CAAP;IACD,CARD;EASD;;EACD4Z,OAAO,GAAG;IACR,OAAO,KAAK+4C,cAAL,CAAoB7W,eAApB,CAAoC,SAApC,EAA+C,IAA/C,CAAP;EACD;;EACDqa,YAAY,GAAG;IACb,IAAI,KAAKxnD,iBAAL,CAAuBjR,IAAvB,IAA+B,CAAnC,EAAsC;MACpClT,IAAI,CAAC,6DAA6D,wCAA9D,CAAJ;IACD;;IACD,MAAM;MACJ0D,GADI;MAEJoiC;IAFI,IAGF,KAAK3hB,iBAAL,CAAuB6iB,YAH3B;IAIA,OAAO,KAAKmhC,cAAL,CAAoB7W,eAApB,CAAoC,cAApC,EAAoD;MACzDgZ,SAAS,EAAE,CAAC,CAAC,KAAKC,WADuC;MAEzDH,QAAQ,EAAE,KAAKwJ,SAF0C;MAGzDzvD,iBAAiB,EAAEzgB,GAHsC;MAIzD2K,QAAQ,EAAE,KAAKykE,WAAL,EAAkBzkE,QAAlB,IAA8B;IAJiB,CAApD,EAKJy3B,QALI,EAKMquC,OALN,CAKc,MAAM;MACzB,KAAKhwD,iBAAL,CAAuBqiB,aAAvB;IACD,CAPM,CAAP;EAQD;;EACDikC,OAAO,CAAC//C,UAAD,EAAa;IAClB,IAAI,CAACjrB,MAAM,CAACC,SAAP,CAAiBgrB,UAAjB,CAAD,IAAiCA,UAAU,IAAI,CAA/C,IAAoDA,UAAU,GAAG,KAAKkpD,SAA1E,EAAqF;MACnF,OAAOl/D,OAAO,CAACE,MAAR,CAAe,IAAI1U,KAAJ,CAAU,uBAAV,CAAf,CAAP;IACD;;IACD,MAAMuwB,SAAS,GAAG/F,UAAU,GAAG,CAA/B;IAAA,MACEwoD,aAAa,GAAG,KAAK,CAACZ,YAAN,CAAmB1lF,GAAnB,CAAuB6jC,SAAvB,CADlB;;IAEA,IAAIyiD,aAAJ,EAAmB;MACjB,OAAOA,aAAP;IACD;;IACD,MAAM3zD,OAAO,GAAG,KAAK4oD,cAAL,CAAoB7W,eAApB,CAAoC,SAApC,EAA+C;MAC7D7gC;IAD6D,CAA/C,EAEblb,IAFa,CAERi3D,QAAQ,IAAI;MAClB,IAAI,KAAKvE,SAAT,EAAoB;QAClB,MAAM,IAAI/nE,KAAJ,CAAU,qBAAV,CAAN;MACD;;MACD,IAAIssE,QAAQ,CAAC+H,MAAb,EAAqB;QACnB,KAAK,CAAChC,YAAN,CAAmBphE,GAAnB,CAAuBq7D,QAAQ,CAAC+H,MAAhC,EAAwC7pD,UAAxC;MACD;;MACD,MAAM4oD,IAAI,GAAG,IAAIjH,YAAJ,CAAiB57C,SAAjB,EAA4B+7C,QAA5B,EAAsC,IAAtC,EAA4C,KAAKmG,OAAL,CAAaxL,MAAzD,CAAb;MACA,KAAK,CAACkL,SAAN,CAAgBlhE,GAAhB,CAAoBsf,SAApB,EAA+B6iD,IAA/B;MACA,OAAOA,IAAP;IACD,CAZe,CAAhB;IAaA,KAAK,CAAChB,YAAN,CAAmBnhE,GAAnB,CAAuBsf,SAAvB,EAAkClR,OAAlC;IACA,OAAOA,OAAP;EACD;;EACDmrD,YAAY,CAACxB,GAAD,EAAM;IAChB,IAAI,CAACD,UAAU,CAACC,GAAD,CAAf,EAAsB;MACpB,OAAOx0D,OAAO,CAACE,MAAR,CAAe,IAAI1U,KAAJ,CAAU,4BAAV,CAAf,CAAP;IACD;;IACD,OAAO,KAAKioE,cAAL,CAAoB7W,eAApB,CAAoC,cAApC,EAAoD;MACzD6X,GAAG,EAAED,GAAG,CAACC,GADgD;MAEzDC,GAAG,EAAEF,GAAG,CAACE;IAFgD,CAApD,CAAP;EAID;;EACD8D,cAAc,CAACz8C,SAAD,EAAYu1B,MAAZ,EAAoB;IAChC,OAAO,KAAKmiB,cAAL,CAAoB7W,eAApB,CAAoC,gBAApC,EAAsD;MAC3D7gC,SAD2D;MAE3Du1B;IAF2D,CAAtD,CAAP;EAID;;EACDkmB,eAAe,GAAG;IAChB,OAAO,KAAK,CAAC+G,iBAAN,CAAwB,iBAAxB,CAAP;EACD;;EACD9G,YAAY,GAAG;IACb,OAAO,KAAK,CAAC8G,iBAAN,CAAwB,cAAxB,CAAP;EACD;;EACD7G,sBAAsB,GAAG;IACvB,OAAO,KAAKjE,cAAL,CAAoB7W,eAApB,CAAoC,wBAApC,EAA8D,IAA9D,CAAP;EACD;;EACDqZ,eAAe,GAAG;IAChB,OAAO,KAAKxC,cAAL,CAAoB7W,eAApB,CAAoC,iBAApC,EAAuD,IAAvD,CAAP;EACD;;EACDsZ,cAAc,CAACv7D,EAAD,EAAK;IACjB,IAAI,OAAOA,EAAP,KAAc,QAAlB,EAA4B;MAC1B,OAAOqF,OAAO,CAACE,MAAR,CAAe,IAAI1U,KAAJ,CAAU,8BAAV,CAAf,CAAP;IACD;;IACD,OAAO,KAAKioE,cAAL,CAAoB7W,eAApB,CAAoC,gBAApC,EAAsD;MAC3DjiD;IAD2D,CAAtD,CAAP;EAGD;;EACDw7D,aAAa,GAAG;IACd,OAAO,KAAK1C,cAAL,CAAoB7W,eAApB,CAAoC,eAApC,EAAqD,IAArD,CAAP;EACD;;EACDwZ,aAAa,GAAG;IACd,OAAO,KAAK3C,cAAL,CAAoB7W,eAApB,CAAoC,eAApC,EAAqD,IAArD,CAAP;EACD;;EACDyZ,WAAW,GAAG;IACZ,OAAO,KAAK5C,cAAL,CAAoB7W,eAApB,CAAoC,aAApC,EAAmD,IAAnD,CAAP;EACD;;EACD0Z,oBAAoB,GAAG;IACrB,OAAO,KAAK7C,cAAL,CAAoB7W,eAApB,CAAoC,sBAApC,EAA4D,IAA5D,CAAP;EACD;;EACD2Z,aAAa,GAAG;IACd,OAAO,KAAK9C,cAAL,CAAoB7W,eAApB,CAAoC,eAApC,EAAqD,IAArD,CAAP;EACD;;EACD4Z,cAAc,GAAG;IACf,OAAO,KAAK/C,cAAL,CAAoB7W,eAApB,CAAoC,gBAApC,EAAsD,IAAtD,CAAP;EACD;;EACD8Z,eAAe,GAAG;IAChB,OAAO,KAAK,CAAC6H,iBAAN,CAAwB,iBAAxB,CAAP;EACD;;EACD9F,gBAAgB,CAAC18C,SAAD,EAAY;IAC1B,OAAO,KAAK03C,cAAL,CAAoB7W,eAApB,CAAoC,kBAApC,EAAwD;MAC7D7gC;IAD6D,CAAxD,CAAP;EAGD;;EACD4+C,aAAa,CAAC5+C,SAAD,EAAY;IACvB,OAAO,KAAK03C,cAAL,CAAoB7W,eAApB,CAAoC,eAApC,EAAqD;MAC1D7gC;IAD0D,CAArD,CAAP;EAGD;;EACD46C,UAAU,GAAG;IACX,OAAO,KAAKlD,cAAL,CAAoB7W,eAApB,CAAoC,YAApC,EAAkD,IAAlD,CAAP;EACD;;EACDga,wBAAwB,CAAC1X,eAAD,EAAkB;IACxC,OAAO,KAAK,CAACqf,iBAAN,CAAwB,0BAAxB,EAAoD19D,IAApD,CAAyDC,IAAI,IAAI,IAAI2+C,qBAAJ,CAA0B3+C,IAA1B,EAAgCo+C,eAAhC,CAAjE,CAAP;EACD;;EACD4X,cAAc,GAAG;IACf,OAAO,KAAKrD,cAAL,CAAoB7W,eAApB,CAAoC,gBAApC,EAAsD,IAAtD,CAAP;EACD;;EACDma,WAAW,GAAG;IACZ,MAAM/pE,IAAI,GAAG,aAAb;IAAA,MACEwxE,aAAa,GAAG,KAAK,CAACd,cAAN,CAAqBxlF,GAArB,CAAyB8U,IAAzB,CADlB;;IAEA,IAAIwxE,aAAJ,EAAmB;MACjB,OAAOA,aAAP;IACD;;IACD,MAAM3zD,OAAO,GAAG,KAAK4oD,cAAL,CAAoB7W,eAApB,CAAoC5vD,IAApC,EAA0C,IAA1C,EAAgD6T,IAAhD,CAAqDi/D,OAAO,KAAK;MAC/E50E,IAAI,EAAE40E,OAAO,CAAC,CAAD,CADkE;MAE/EC,QAAQ,EAAED,OAAO,CAAC,CAAD,CAAP,GAAa,IAAIthB,QAAJ,CAAashB,OAAO,CAAC,CAAD,CAApB,CAAb,GAAwC,IAF6B;MAG/E1e,0BAA0B,EAAE,KAAKgd,WAAL,EAAkBzkE,QAAlB,IAA8B,IAHqB;MAI/EuqD,aAAa,EAAE,KAAKka,WAAL,EAAkBla,aAAlB,IAAmC;IAJ6B,CAAL,CAA5D,CAAhB;IAMA,KAAK,CAACwZ,cAAN,CAAqBjhE,GAArB,CAAyBzP,IAAzB,EAA+B6d,OAA/B;IACA,OAAOA,OAAP;EACD;;EACDmsD,WAAW,GAAG;IACZ,OAAO,KAAKvD,cAAL,CAAoB7W,eAApB,CAAoC,aAApC,EAAmD,IAAnD,CAAP;EACD;;EACKya,YAAY,CAACD,eAAe,GAAG,KAAnB,EAA0B;IAAA;;IAAA;MAC1C,IAAI,OAAI,CAAC7D,SAAT,EAAoB;QAClB;MACD;;MACD,MAAM,OAAI,CAACE,cAAL,CAAoB7W,eAApB,CAAoC,SAApC,EAA+C,IAA/C,CAAN;;MACA,KAAK,MAAMgiB,IAAX,IAAmB,OAAI,CAAC,CAACjB,SAAN,CAAgBlpD,MAAhB,EAAnB,EAA6C;QAC3C,MAAMurD,iBAAiB,GAAGpB,IAAI,CAACjP,OAAL,EAA1B;;QACA,IAAI,CAACqQ,iBAAL,EAAwB;UACtB,MAAM,IAAIx0E,KAAJ,CAAW,sBAAqBozE,IAAI,CAAC5oD,UAAW,0BAAhD,CAAN;QACD;MACF;;MACD,OAAI,CAAC22B,UAAL,CAAgBjuC,KAAhB;;MACA,IAAI,CAAC04D,eAAL,EAAsB;QACpB,OAAI,CAAC4G,UAAL,CAAgBt/D,KAAhB;MACD;;MACD,OAAI,CAAC,CAACg/D,cAAN,CAAqBh/D,KAArB;;MACA,OAAI,CAAC2R,aAAL,CAAmB/X,OAAnB,CAA2B,IAA3B;;MACAje,SAAS,CAACs1E,OAAV;IAjB0C;EAkB3C;;EACD4H,gBAAgB,CAAC/C,GAAD,EAAM;IACpB,IAAI,CAACD,UAAU,CAACC,GAAD,CAAf,EAAsB;MACpB,OAAO,IAAP;IACD;;IACD,MAAMqL,MAAM,GAAGrL,GAAG,CAACE,GAAJ,KAAY,CAAZ,GAAiB,GAAEF,GAAG,CAACC,GAAI,GAA3B,GAAiC,GAAED,GAAG,CAACC,GAAI,IAAGD,GAAG,CAACE,GAAI,EAArE;IACA,OAAO,KAAK,CAACmJ,YAAN,CAAmB3lF,GAAnB,CAAuB2nF,MAAvB,KAAkC,IAAzC;EACD;;AApjBmB;;AAsjBtB,MAAMI,YAAY,GAAGphB,MAAM,CAAC,cAAD,CAA3B;;AACA,MAAMsZ,UAAN,CAAiB;EACf,CAACvgC,IAAD,GAAQ7/C,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAR;;EACA,CAACixE,SAAS,CAACroB,KAAD,EAAQ;IAChB,OAAO,KAAK,CAACjgB,IAAN,CAAWigB,KAAX,MAAsB,EAC3B,GAAG73C,OAAO,CAACm4B,aAAR,EADwB;MAE3Br3B,IAAI,EAAEm/D;IAFqB,CAA7B;EAID;;EACD/nF,GAAG,CAAC2/D,KAAD,EAAQjqC,QAAQ,GAAG,IAAnB,EAAyB;IAC1B,IAAIA,QAAJ,EAAc;MACZ,MAAMz1B,GAAG,GAAG,KAAK,CAAC+nF,SAAN,CAAgBroB,KAAhB,CAAZ;MACA1/D,GAAG,CAAC0yB,OAAJ,CAAYhK,IAAZ,CAAiB,MAAM+M,QAAQ,CAACz1B,GAAG,CAAC2oB,IAAL,CAA/B;MACA,OAAO,IAAP;IACD;;IACD,MAAM3oB,GAAG,GAAG,KAAK,CAACy/C,IAAN,CAAWigB,KAAX,CAAZ;;IACA,IAAI,CAAC1/D,GAAD,IAAQA,GAAG,CAAC2oB,IAAJ,KAAam/D,YAAzB,EAAuC;MACrC,MAAM,IAAIz0E,KAAJ,CAAW,6CAA4CqsD,KAAM,GAA7D,CAAN;IACD;;IACD,OAAO1/D,GAAG,CAAC2oB,IAAX;EACD;;EACDwN,GAAG,CAACupC,KAAD,EAAQ;IACT,MAAM1/D,GAAG,GAAG,KAAK,CAACy/C,IAAN,CAAWigB,KAAX,CAAZ;IACA,OAAO,CAAC,CAAC1/D,GAAF,IAASA,GAAG,CAAC2oB,IAAJ,KAAam/D,YAA7B;EACD;;EACDhgE,OAAO,CAAC43C,KAAD,EAAQ/2C,IAAI,GAAG,IAAf,EAAqB;IAC1B,MAAM3oB,GAAG,GAAG,KAAK,CAAC+nF,SAAN,CAAgBroB,KAAhB,CAAZ;IACA1/D,GAAG,CAAC2oB,IAAJ,GAAWA,IAAX;IACA3oB,GAAG,CAAC8nB,OAAJ;EACD;;EACDvB,KAAK,GAAG;IACN,KAAK,MAAMm5C,KAAX,IAAoB,KAAK,CAACjgB,IAA1B,EAAgC;MAC9B,MAAM;QACJ92B;MADI,IAEF,KAAK,CAAC82B,IAAN,CAAWigB,KAAX,CAFJ;MAGA/2C,IAAI,EAAEmK,MAAN,EAAc+yC,KAAd;IACD;;IACD,KAAK,CAACpmB,IAAN,GAAa7/C,MAAM,CAACkX,MAAP,CAAc,IAAd,CAAb;EACD;;EACgB,EAAf4vD,MAAM,CAACshB,QAAQ,IAAI;IACnB,KAAK,MAAMtoB,KAAX,IAAoB,KAAK,CAACjgB,IAA1B,EAAgC;MAC9B,MAAM;QACJ92B;MADI,IAEF,KAAK,CAAC82B,IAAN,CAAWigB,KAAX,CAFJ;;MAGA,IAAI/2C,IAAI,KAAKm/D,YAAb,EAA2B;QACzB;MACD;;MACD,MAAM,CAACpoB,KAAD,EAAQ/2C,IAAR,CAAN;IACD;EACF;;AAhDc;;AAkDjB,MAAMs/D,UAAN,CAAiB;EACf,CAAC5G,kBAAD,GAAsB,IAAtB;;EACAvsE,WAAW,CAACusE,kBAAD,EAAqB;IAC9B,KAAK,CAACA,kBAAN,GAA2BA,kBAA3B;IACA,KAAK6G,UAAL,GAAkB,IAAlB;EACD;;EACU,IAAPx1D,OAAO,GAAG;IACZ,OAAO,KAAK,CAAC2uD,kBAAN,CAAyBrd,UAAzB,CAAoCtxC,OAA3C;EACD;;EACDuY,MAAM,CAACxgB,UAAU,GAAG,CAAd,EAAiB;IACrB,KAAK,CAAC42D,kBAAN,CAAyBp2C,MAAzB,CAAgC,IAAhC,EAAsCxgB,UAAtC;EACD;;EACiB,IAAdy2D,cAAc,GAAG;IACnB,MAAM;MACJA;IADI,IAEF,KAAK,CAACG,kBAAN,CAAyB15B,YAF7B;;IAGA,IAAI,CAACu5B,cAAL,EAAqB;MACnB,OAAO,KAAP;IACD;;IACD,MAAM;MACJvsB;IADI,IAEF,KAAK,CAAC0sB,kBAFV;IAGA,OAAOH,cAAc,CAACiH,IAAf,IAAuBjH,cAAc,CAACzgE,MAAf,IAAyBk0C,mBAAmB,EAAEtuC,IAArB,GAA4B,CAAnF;EACD;;AAvBc;;AAyBjB,MAAMo7D,kBAAN,CAAyB;EACvB,CAAC2G,GAAD,GAAO,IAAP;EACA,OAAO,CAACC,WAAR,GAAsB,IAAIC,OAAJ,EAAtB;;EACAxzE,WAAW,CAAC;IACV2gB,QADU;IAEVmR,MAFU;IAGV6Y,IAHU;IAIV+U,UAJU;IAKVG,mBALU;IAMVhN,YANU;IAOV/jB,SAPU;IAQVypB,aARU;IASVn1B,aATU;IAUVwpD,wBAAwB,GAAG,KAVjB;IAWVpH,MAAM,GAAG,KAXC;IAYVphD,UAAU,GAAG;EAZH,CAAD,EAaR;IACD,KAAKzD,QAAL,GAAgBA,QAAhB;IACA,KAAKmR,MAAL,GAAcA,MAAd;IACA,KAAK6Y,IAAL,GAAYA,IAAZ;IACA,KAAK+U,UAAL,GAAkBA,UAAlB;IACA,KAAKG,mBAAL,GAA2BA,mBAA3B;IACA,KAAK4zB,eAAL,GAAuB,IAAvB;IACA,KAAK5gC,YAAL,GAAoBA,YAApB;IACA,KAAKi4B,UAAL,GAAkBh8C,SAAlB;IACA,KAAKypB,aAAL,GAAqBA,aAArB;IACA,KAAKn1B,aAAL,GAAqBA,aAArB;IACA,KAAK6nD,OAAL,GAAezF,MAAf;IACA,KAAKphD,UAAL,GAAkBA,UAAlB;IACA,KAAKsvD,OAAL,GAAe,KAAf;IACA,KAAKC,qBAAL,GAA6B,IAA7B;IACA,KAAKC,aAAL,GAAqB,KAArB;IACA,KAAKC,yBAAL,GAAiCjH,wBAAwB,KAAK,IAA7B,IAAqC,OAAOn0D,MAAP,KAAkB,WAAxF;IACA,KAAKq7D,SAAL,GAAiB,KAAjB;IACA,KAAK5kB,UAAL,GAAkBn8C,OAAO,CAACm4B,aAAR,EAAlB;IACA,KAAKk5B,IAAL,GAAY,IAAI+O,UAAJ,CAAe,IAAf,CAAZ;IACA,KAAKY,YAAL,GAAoB,KAAK59C,MAAL,CAAY1lB,IAAZ,CAAiB,IAAjB,CAApB;IACA,KAAKujE,cAAL,GAAsB,KAAKC,SAAL,CAAexjE,IAAf,CAAoB,IAApB,CAAtB;IACA,KAAKyjE,kBAAL,GAA0B,KAAKC,aAAL,CAAmB1jE,IAAnB,CAAwB,IAAxB,CAA1B;IACA,KAAK2jE,UAAL,GAAkB,KAAKC,KAAL,CAAW5jE,IAAX,CAAgB,IAAhB,CAAlB;IACA,KAAK6jE,OAAL,GAAexiD,MAAM,CAAC6wC,aAAP,CAAqBh3D,MAApC;EACD;;EACY,IAATmiE,SAAS,GAAG;IACd,OAAO,KAAK5e,UAAL,CAAgBtxC,OAAhB,CAAwBrR,KAAxB,CAA8B,YAAY,CAAE,CAA5C,CAAP;EACD;;EACDwgE,kBAAkB,CAAC;IACjB1rB,YAAY,GAAG,KADE;IAEjB1B;EAFiB,CAAD,EAGf;IACD,IAAI,KAAKm0B,SAAT,EAAoB;MAClB;IACD;;IACD,IAAI,KAAKQ,OAAT,EAAkB;MAChB,IAAI3H,kBAAkB,CAAC,CAAC4G,WAApB,CAAgClyD,GAAhC,CAAoC,KAAKizD,OAAzC,CAAJ,EAAuD;QACrD,MAAM,IAAI/1E,KAAJ,CAAU,qEAAqE,0DAArE,GAAkI,yBAA5I,CAAN;MACD;;MACDouE,kBAAkB,CAAC,CAAC4G,WAApB,CAAgC93D,GAAhC,CAAoC,KAAK64D,OAAzC;IACD;;IACD,IAAI,KAAKrJ,OAAL,IAAgBz/E,UAAU,CAAC+oF,cAAX,EAA2Bn+C,OAA/C,EAAwD;MACtD,KAAKwrB,OAAL,GAAep2D,UAAU,CAAC+oF,cAAX,CAA0BvyE,MAA1B,CAAiC,KAAK8oE,UAAtC,CAAf;MACA,KAAKlpB,OAAL,CAAa4yB,IAAb,CAAkB,KAAK3hC,YAAvB;MACA,KAAK+O,OAAL,CAAaO,cAAb,GAA8B,KAAKP,OAAL,CAAa6yB,iBAAb,EAA9B;IACD;;IACD,MAAM;MACJ9R,aADI;MAEJ3pD,QAFI;MAGJtgB,SAHI;MAIJwvB;IAJI,IAKF,KAAK4J,MALT;IAMA,KAAK4iD,GAAL,GAAW,IAAIl1B,cAAJ,CAAmBmjB,aAAnB,EAAkC,KAAKjjB,UAAvC,EAAmD,KAAK/U,IAAxD,EAA8D,KAAK4N,aAAnE,EAAkF,KAAKn1B,aAAvF,EAAsG;MAC/Gu8B;IAD+G,CAAtG,EAER,KAAKE,mBAFG,EAEkB,KAAKz7B,UAFvB,CAAX;IAGA,KAAKswD,GAAL,CAAStzB,YAAT,CAAsB;MACpB1oD,SADoB;MAEpBsgB,QAFoB;MAGpBqoC,YAHoB;MAIpBn5B;IAJoB,CAAtB;IAMA,KAAKurD,eAAL,GAAuB,CAAvB;IACA,KAAKG,aAAL,GAAqB,IAArB;IACA,KAAKD,qBAAL;EACD;;EACDx9C,MAAM,CAACpX,KAAK,GAAG,IAAT,EAAepJ,UAAU,GAAG,CAA5B,EAA+B;IACnC,KAAK+9D,OAAL,GAAe,KAAf;IACA,KAAKI,SAAL,GAAiB,IAAjB;IACA,KAAKY,GAAL,EAAUzgC,UAAV;;IACA,IAAI,KAAK,CAACq/B,GAAV,EAAe;MACb76D,MAAM,CAACk8D,oBAAP,CAA4B,KAAK,CAACrB,GAAlC;MACA,KAAK,CAACA,GAAN,GAAY,IAAZ;IACD;;IACD3G,kBAAkB,CAAC,CAAC4G,WAApB,CAAgCv3D,MAAhC,CAAuC,KAAKs4D,OAA5C;IACA,KAAK3zD,QAAL,CAAc5B,KAAK,IAAI,IAAI5xB,2BAAJ,CAAiC,6BAA4B,KAAK29E,UAAL,GAAkB,CAAE,EAAjF,EAAoFn1D,UAApF,CAAvB;EACD;;EACDq3D,mBAAmB,GAAG;IACpB,IAAI,CAAC,KAAK4G,aAAV,EAAyB;MACvB,KAAKD,qBAAL,KAA+B,KAAKK,cAApC;MACA;IACD;;IACD,KAAKpyB,OAAL,EAAcgzB,kBAAd,CAAiC,KAAK/hC,YAAtC;;IACA,IAAI,KAAK6gC,OAAT,EAAkB;MAChB;IACD;;IACD,KAAKO,SAAL;EACD;;EACDA,SAAS,GAAG;IACV,KAAKP,OAAL,GAAe,IAAf;;IACA,IAAI,KAAKI,SAAT,EAAoB;MAClB;IACD;;IACD,IAAI,KAAK1P,IAAL,CAAUgP,UAAd,EAA0B;MACxB,KAAKhP,IAAL,CAAUgP,UAAV,CAAqB,KAAKc,kBAA1B;IACD,CAFD,MAEO;MACL,KAAKC,aAAL;IACD;EACF;;EACDA,aAAa,GAAG;IACd,IAAI,KAAKN,yBAAT,EAAoC;MAClC,KAAK,CAACP,GAAN,GAAY76D,MAAM,CAACo8D,qBAAP,CAA6B,MAAM;QAC7C,KAAK,CAACvB,GAAN,GAAY,IAAZ;;QACA,KAAKc,UAAL,GAAkB7nE,KAAlB,CAAwB,KAAKwnE,YAA7B;MACD,CAHW,CAAZ;IAID,CALD,MAKO;MACLhhE,OAAO,CAACC,OAAR,GAAkBY,IAAlB,CAAuB,KAAKwgE,UAA5B,EAAwC7nE,KAAxC,CAA8C,KAAKwnE,YAAnD;IACD;EACF;;EACKM,KAAK,GAAG;IAAA;;IAAA;MACZ,IAAI,OAAI,CAACP,SAAT,EAAoB;QAClB;MACD;;MACD,OAAI,CAACL,eAAL,GAAuB,OAAI,CAACiB,GAAL,CAAS1gC,mBAAT,CAA6B,OAAI,CAACnB,YAAlC,EAAgD,OAAI,CAAC4gC,eAArD,EAAsE,OAAI,CAACO,cAA3E,EAA2F,OAAI,CAACpyB,OAAhG,CAAvB;;MACA,IAAI,OAAI,CAAC6xB,eAAL,KAAyB,OAAI,CAAC5gC,YAAL,CAAkBgP,SAAlB,CAA4B1iD,MAAzD,EAAiE;QAC/D,OAAI,CAACu0E,OAAL,GAAe,KAAf;;QACA,IAAI,OAAI,CAAC7gC,YAAL,CAAkBs5B,SAAtB,EAAiC;UAC/B,OAAI,CAACuI,GAAL,CAASzgC,UAAT;;UACA04B,kBAAkB,CAAC,CAAC4G,WAApB,CAAgCv3D,MAAhC,CAAuC,OAAI,CAACs4D,OAA5C;;UACA,OAAI,CAAC3zD,QAAL;QACD;MACF;IAZW;EAab;;AA1IsB;;AA4IzB,MAAMryB,OAAO,GAAG,QAAhB;AACA,MAAMb,KAAK,GAAG,WAAd;AAEA,C,CAAC;;AACD,SAASqnF,aAAT,CAAuB1xE,CAAvB,EAA0B;EACxB,OAAOnC,IAAI,CAAC4I,KAAL,CAAW5I,IAAI,CAAC2D,GAAL,CAAS,CAAT,EAAY3D,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYkC,CAAZ,CAAZ,IAA8B,GAAzC,EAA8CC,QAA9C,CAAuD,EAAvD,EAA2DC,QAA3D,CAAoE,CAApE,EAAuE,GAAvE,CAAP;AACD;;AACD,SAASyxE,aAAT,CAAuBluE,CAAvB,EAA0B;EACxB,OAAO5F,IAAI,CAAC2D,GAAL,CAAS,CAAT,EAAY3D,IAAI,CAACC,GAAL,CAAS,GAAT,EAAc,MAAM2F,CAApB,CAAZ,CAAP;AACD;;AACD,MAAMmuE,eAAN,CAAsB;EACP,OAANC,MAAM,CAAC,CAAChwE,CAAD,EAAI6B,CAAJ,EAAO5C,CAAP,EAAUmN,CAAV,CAAD,EAAe;IAC1B,OAAO,CAAC,GAAD,EAAM,IAAIpQ,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY,MAAM+D,CAAN,GAAU,OAAOf,CAAjB,GAAqB,OAAO4C,CAA5B,GAAgCuK,CAA5C,CAAV,CAAP;EACD;;EACY,OAAN6jE,MAAM,CAAC,CAACzxE,CAAD,CAAD,EAAM;IACjB,OAAO,CAAC,MAAD,EAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,EAAkB,IAAIA,CAAtB,CAAP;EACD;;EACW,OAAL0xE,KAAK,CAAC,CAAC1xE,CAAD,CAAD,EAAM;IAChB,OAAO,CAAC,KAAD,EAAQA,CAAR,EAAWA,CAAX,EAAcA,CAAd,CAAP;EACD;;EACW,OAAL2xE,KAAK,CAAC,CAAC3xE,CAAD,CAAD,EAAM;IAChBA,CAAC,GAAGsxE,aAAa,CAACtxE,CAAD,CAAjB;IACA,OAAO,CAACA,CAAD,EAAIA,CAAJ,EAAOA,CAAP,CAAP;EACD;;EACY,OAAN4xE,MAAM,CAAC,CAAC5xE,CAAD,CAAD,EAAM;IACjB,MAAM6xE,CAAC,GAAGR,aAAa,CAACrxE,CAAD,CAAvB;IACA,OAAQ,IAAG6xE,CAAE,GAAEA,CAAE,GAAEA,CAAE,EAArB;EACD;;EACW,OAALC,KAAK,CAAC,CAAC/xE,CAAD,EAAIC,CAAJ,EAAOC,CAAP,CAAD,EAAY;IACtB,OAAO,CAAC,GAAD,EAAM,MAAMF,CAAN,GAAU,OAAOC,CAAjB,GAAqB,OAAOC,CAAlC,CAAP;EACD;;EACa,OAAP8xE,OAAO,CAACxlE,KAAD,EAAQ;IACpB,OAAOA,KAAK,CAACjO,GAAN,CAAUgzE,aAAV,CAAP;EACD;;EACc,OAARU,QAAQ,CAACzlE,KAAD,EAAQ;IACrB,OAAQ,IAAGA,KAAK,CAACjO,GAAN,CAAU+yE,aAAV,EAAyBxzE,IAAzB,CAA8B,EAA9B,CAAkC,EAA7C;EACD;;EACY,OAANo0E,MAAM,GAAG;IACd,OAAO,WAAP;EACD;;EACW,OAALC,KAAK,GAAG;IACb,OAAO,CAAC,IAAD,CAAP;EACD;;EACc,OAARC,QAAQ,CAAC,CAAC3wE,CAAD,EAAI6B,CAAJ,EAAO5C,CAAP,EAAUmN,CAAV,CAAD,EAAe;IAC5B,OAAO,CAAC,KAAD,EAAQ,IAAIpQ,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY+D,CAAC,GAAGoM,CAAhB,CAAZ,EAAgC,IAAIpQ,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYgD,CAAC,GAAGmN,CAAhB,CAApC,EAAwD,IAAIpQ,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY4F,CAAC,GAAGuK,CAAhB,CAA5D,CAAP;EACD;;EACc,OAARwkE,QAAQ,CAAC,CAAC5wE,CAAD,EAAI6B,CAAJ,EAAO5C,CAAP,EAAUmN,CAAV,CAAD,EAAe;IAC5B,OAAO,CAAC0jE,aAAa,CAAC,IAAI9zE,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY+D,CAAC,GAAGoM,CAAhB,CAAL,CAAd,EAAwC0jE,aAAa,CAAC,IAAI9zE,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYgD,CAAC,GAAGmN,CAAhB,CAAL,CAArD,EAA+E0jE,aAAa,CAAC,IAAI9zE,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY4F,CAAC,GAAGuK,CAAhB,CAAL,CAA5F,CAAP;EACD;;EACe,OAATykE,SAAS,CAACC,UAAD,EAAa;IAC3B,MAAMl0D,GAAG,GAAG,KAAK+zD,QAAL,CAAcG,UAAd,EAA0BtxE,KAA1B,CAAgC,CAAhC,CAAZ;IACA,OAAO,KAAKgxE,QAAL,CAAc5zD,GAAd,CAAP;EACD;;EACc,OAARm0D,QAAQ,CAAC,CAACxyE,CAAD,EAAIC,CAAJ,EAAOC,CAAP,CAAD,EAAY;IACzB,MAAMuB,CAAC,GAAG,IAAIzB,CAAd;IACA,MAAMU,CAAC,GAAG,IAAIT,CAAd;IACA,MAAMqD,CAAC,GAAG,IAAIpD,CAAd;IACA,MAAM2N,CAAC,GAAGpQ,IAAI,CAACC,GAAL,CAAS+D,CAAT,EAAYf,CAAZ,EAAe4C,CAAf,CAAV;IACA,OAAO,CAAC,MAAD,EAAS7B,CAAT,EAAYf,CAAZ,EAAe4C,CAAf,EAAkBuK,CAAlB,CAAP;EACD;;AAjDmB;;AAoDtB,C,CAAC;;AAED,MAAM7jB,QAAN,CAAe;EACM,OAAZyoF,YAAY,CAACC,IAAD,EAAOxoE,EAAP,EAAW2N,OAAX,EAAoBkpB,OAApB,EAA6B8f,MAA7B,EAAqC;IACtD,MAAM8xB,UAAU,GAAG5xC,OAAO,CAACI,QAAR,CAAiBj3B,EAAjB,EAAqB;MACtClO,KAAK,EAAE;IAD+B,CAArB,CAAnB;;IAGA,QAAQ6b,OAAO,CAACtb,IAAhB;MACE,KAAK,UAAL;QACE,IAAIo2E,UAAU,CAAC32E,KAAX,KAAqB,IAAzB,EAA+B;UAC7B02E,IAAI,CAAC5gD,WAAL,GAAmB6gD,UAAU,CAAC32E,KAA9B;QACD;;QACD,IAAI6kD,MAAM,KAAK,OAAf,EAAwB;UACtB;QACD;;QACD6xB,IAAI,CAACx7D,gBAAL,CAAsB,OAAtB,EAA+BqG,KAAK,IAAI;UACtCwjB,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;YACnBlO,KAAK,EAAEuhB,KAAK,CAAC2E,MAAN,CAAalmB;UADD,CAArB;QAGD,CAJD;QAKA;;MACF,KAAK,OAAL;QACE,IAAI6b,OAAO,CAAClD,UAAR,CAAmBvpB,IAAnB,KAA4B,OAA5B,IAAuCysB,OAAO,CAAClD,UAAR,CAAmBvpB,IAAnB,KAA4B,UAAvE,EAAmF;UACjF,IAAIunF,UAAU,CAAC32E,KAAX,KAAqB6b,OAAO,CAAClD,UAAR,CAAmBi+D,KAA5C,EAAmD;YACjDF,IAAI,CAACnpE,YAAL,CAAkB,SAAlB,EAA6B,IAA7B;UACD,CAFD,MAEO,IAAIopE,UAAU,CAAC32E,KAAX,KAAqB6b,OAAO,CAAClD,UAAR,CAAmBk+D,MAA5C,EAAoD;YACzDH,IAAI,CAACI,eAAL,CAAqB,SAArB;UACD;;UACD,IAAIjyB,MAAM,KAAK,OAAf,EAAwB;YACtB;UACD;;UACD6xB,IAAI,CAACx7D,gBAAL,CAAsB,QAAtB,EAAgCqG,KAAK,IAAI;YACvCwjB,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;cACnBlO,KAAK,EAAEuhB,KAAK,CAAC2E,MAAN,CAAa6wD,OAAb,GAAuBx1D,KAAK,CAAC2E,MAAN,CAAauO,YAAb,CAA0B,OAA1B,CAAvB,GAA4DlT,KAAK,CAAC2E,MAAN,CAAauO,YAAb,CAA0B,QAA1B;YADhD,CAArB;UAGD,CAJD;QAKD,CAdD,MAcO;UACL,IAAIkiD,UAAU,CAAC32E,KAAX,KAAqB,IAAzB,EAA+B;YAC7B02E,IAAI,CAACnpE,YAAL,CAAkB,OAAlB,EAA2BopE,UAAU,CAAC32E,KAAtC;UACD;;UACD,IAAI6kD,MAAM,KAAK,OAAf,EAAwB;YACtB;UACD;;UACD6xB,IAAI,CAACx7D,gBAAL,CAAsB,OAAtB,EAA+BqG,KAAK,IAAI;YACtCwjB,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;cACnBlO,KAAK,EAAEuhB,KAAK,CAAC2E,MAAN,CAAalmB;YADD,CAArB;UAGD,CAJD;QAKD;;QACD;;MACF,KAAK,QAAL;QACE,IAAI22E,UAAU,CAAC32E,KAAX,KAAqB,IAAzB,EAA+B;UAC7B02E,IAAI,CAACnpE,YAAL,CAAkB,OAAlB,EAA2BopE,UAAU,CAAC32E,KAAtC;;UACA,KAAK,MAAMg3E,MAAX,IAAqBn7D,OAAO,CAAC+lB,QAA7B,EAAuC;YACrC,IAAIo1C,MAAM,CAACr+D,UAAP,CAAkB3Y,KAAlB,KAA4B22E,UAAU,CAAC32E,KAA3C,EAAkD;cAChDg3E,MAAM,CAACr+D,UAAP,CAAkBs+D,QAAlB,GAA6B,IAA7B;YACD,CAFD,MAEO,IAAID,MAAM,CAACr+D,UAAP,CAAkB9sB,cAAlB,CAAiC,UAAjC,CAAJ,EAAkD;cACvD,OAAOmrF,MAAM,CAACr+D,UAAP,CAAkBs+D,QAAzB;YACD;UACF;QACF;;QACDP,IAAI,CAACx7D,gBAAL,CAAsB,OAAtB,EAA+BqG,KAAK,IAAI;UACtC,MAAMjiB,OAAO,GAAGiiB,KAAK,CAAC2E,MAAN,CAAa5mB,OAA7B;UACA,MAAMU,KAAK,GAAGV,OAAO,CAAC43E,aAAR,KAA0B,CAAC,CAA3B,GAA+B,EAA/B,GAAoC53E,OAAO,CAACA,OAAO,CAAC43E,aAAT,CAAP,CAA+Bl3E,KAAjF;UACA+kC,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;YACnBlO;UADmB,CAArB;QAGD,CAND;QAOA;IA7DJ;EA+DD;;EACmB,OAAbm3E,aAAa,CAAC;IACnBT,IADmB;IAEnB76D,OAFmB;IAGnBkpB,OAAO,GAAG,IAHS;IAInB8f,MAJmB;IAKnBuyB;EALmB,CAAD,EAMjB;IACD,MAAM;MACJz+D;IADI,IAEFkD,OAFJ;IAGA,MAAMw7D,mBAAmB,GAAGX,IAAI,YAAYY,iBAA5C;;IACA,IAAI3+D,UAAU,CAACvpB,IAAX,KAAoB,OAAxB,EAAiC;MAC/BupB,UAAU,CAACpY,IAAX,GAAmB,GAAEoY,UAAU,CAACpY,IAAK,IAAGskD,MAAO,EAA/C;IACD;;IACD,KAAK,MAAM,CAACz5D,GAAD,EAAM4U,KAAN,CAAX,IAA2B1U,MAAM,CAACsjC,OAAP,CAAejW,UAAf,CAA3B,EAAuD;MACrD,IAAI3Y,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKiB,SAAhC,EAA2C;QACzC;MACD;;MACD,QAAQ7V,GAAR;QACE,KAAK,OAAL;UACE,IAAI4U,KAAK,CAACL,MAAV,EAAkB;YAChB+2E,IAAI,CAACnpE,YAAL,CAAkBniB,GAAlB,EAAuB4U,KAAK,CAAC8B,IAAN,CAAW,GAAX,CAAvB;UACD;;UACD;;QACF,KAAK,QAAL;UACE;;QACF,KAAK,IAAL;UACE40E,IAAI,CAACnpE,YAAL,CAAkB,iBAAlB,EAAqCvN,KAArC;UACA;;QACF,KAAK,OAAL;UACE1U,MAAM,CAACwjC,MAAP,CAAc4nD,IAAI,CAACloE,KAAnB,EAA0BxO,KAA1B;UACA;;QACF,KAAK,aAAL;UACE02E,IAAI,CAAC5gD,WAAL,GAAmB91B,KAAnB;UACA;;QACF;UACE,IAAI,CAACq3E,mBAAD,IAAwBjsF,GAAG,KAAK,MAAR,IAAkBA,GAAG,KAAK,WAAtD,EAAmE;YACjEsrF,IAAI,CAACnpE,YAAL,CAAkBniB,GAAlB,EAAuB4U,KAAvB;UACD;;MApBL;IAsBD;;IACD,IAAIq3E,mBAAJ,EAAyB;MACvBD,WAAW,CAACG,iBAAZ,CAA8Bb,IAA9B,EAAoC/9D,UAAU,CAAC+uD,IAA/C,EAAqD/uD,UAAU,CAAC6+D,SAAhE;IACD;;IACD,IAAIzyC,OAAO,IAAIpsB,UAAU,CAAC8+D,MAA1B,EAAkC;MAChC,KAAKhB,YAAL,CAAkBC,IAAlB,EAAwB/9D,UAAU,CAAC8+D,MAAnC,EAA2C57D,OAA3C,EAAoDkpB,OAApD;IACD;EACF;;EACY,OAANnqB,MAAM,CAACqe,UAAD,EAAa;IACxB,MAAM8L,OAAO,GAAG9L,UAAU,CAACjW,iBAA3B;IACA,MAAMo0D,WAAW,GAAGn+C,UAAU,CAACm+C,WAA/B;IACA,MAAMM,IAAI,GAAGz+C,UAAU,CAAC0+C,OAAxB;IACA,MAAM9yB,MAAM,GAAG5rB,UAAU,CAAC4rB,MAAX,IAAqB,SAApC;IACA,MAAM+yB,QAAQ,GAAG5pE,QAAQ,CAACR,aAAT,CAAuBkqE,IAAI,CAACn3E,IAA5B,CAAjB;;IACA,IAAIm3E,IAAI,CAAC/+D,UAAT,EAAqB;MACnB,KAAKw+D,aAAL,CAAmB;QACjBT,IAAI,EAAEkB,QADW;QAEjB/7D,OAAO,EAAE67D,IAFQ;QAGjB7yB,MAHiB;QAIjBuyB;MAJiB,CAAnB;IAMD;;IACD,MAAMS,gBAAgB,GAAGhzB,MAAM,KAAK,UAApC;IACA,MAAMizB,OAAO,GAAG7+C,UAAU,CAAC1qB,GAA3B;IACAupE,OAAO,CAAC9oE,MAAR,CAAe4oE,QAAf;;IACA,IAAI3+C,UAAU,CAACzf,QAAf,EAAyB;MACvB,MAAMtgB,SAAS,GAAI,UAAS+/B,UAAU,CAACzf,QAAX,CAAoBtgB,SAApB,CAA8B4I,IAA9B,CAAmC,GAAnC,CAAwC,GAApE;MACAg2E,OAAO,CAACtpE,KAAR,CAActV,SAAd,GAA0BA,SAA1B;IACD;;IACD,IAAI2+E,gBAAJ,EAAsB;MACpBC,OAAO,CAACvqE,YAAR,CAAqB,OAArB,EAA8B,kBAA9B;IACD;;IACD,MAAMozD,QAAQ,GAAG,EAAjB;;IACA,IAAI+W,IAAI,CAAC91C,QAAL,CAAcjiC,MAAd,KAAyB,CAA7B,EAAgC;MAC9B,IAAI+3E,IAAI,CAAC13E,KAAT,EAAgB;QACd,MAAMmkE,IAAI,GAAGn2D,QAAQ,CAAC+pE,cAAT,CAAwBL,IAAI,CAAC13E,KAA7B,CAAb;QACA43E,QAAQ,CAAC5oE,MAAT,CAAgBm1D,IAAhB;;QACA,IAAI0T,gBAAgB,IAAI9T,OAAO,CAACK,eAAR,CAAwBsT,IAAI,CAACn3E,IAA7B,CAAxB,EAA4D;UAC1DogE,QAAQ,CAAC9+D,IAAT,CAAcsiE,IAAd;QACD;MACF;;MACD,OAAO;QACLxD;MADK,CAAP;IAGD;;IACD,MAAMqX,KAAK,GAAG,CAAC,CAACN,IAAD,EAAO,CAAC,CAAR,EAAWE,QAAX,CAAD,CAAd;;IACA,OAAOI,KAAK,CAACr4E,MAAN,GAAe,CAAtB,EAAyB;MACvB,MAAM,CAAC4d,MAAD,EAAShc,CAAT,EAAYm1E,IAAZ,IAAoBsB,KAAK,CAAC32D,EAAN,CAAS,CAAC,CAAV,CAA1B;;MACA,IAAI9f,CAAC,GAAG,CAAJ,KAAUgc,MAAM,CAACqkB,QAAP,CAAgBjiC,MAA9B,EAAsC;QACpCq4E,KAAK,CAACvxB,GAAN;QACA;MACD;;MACD,MAAM3vB,KAAK,GAAGvZ,MAAM,CAACqkB,QAAP,CAAgB,EAAEo2C,KAAK,CAAC32D,EAAN,CAAS,CAAC,CAAV,EAAa,CAAb,CAAlB,CAAd;;MACA,IAAIyV,KAAK,KAAK,IAAd,EAAoB;QAClB;MACD;;MACD,MAAM;QACJv2B;MADI,IAEFu2B,KAFJ;;MAGA,IAAIv2B,IAAI,KAAK,OAAb,EAAsB;QACpB,MAAM4jE,IAAI,GAAGn2D,QAAQ,CAAC+pE,cAAT,CAAwBjhD,KAAK,CAAC92B,KAA9B,CAAb;QACA2gE,QAAQ,CAAC9+D,IAAT,CAAcsiE,IAAd;QACAuS,IAAI,CAAC1nE,MAAL,CAAYm1D,IAAZ;QACA;MACD;;MACD,MAAM8T,SAAS,GAAGnhD,KAAK,EAAEne,UAAP,EAAmBu/D,KAAnB,GAA2BlqE,QAAQ,CAACe,eAAT,CAAyB+nB,KAAK,CAACne,UAAN,CAAiBu/D,KAA1C,EAAiD33E,IAAjD,CAA3B,GAAoFyN,QAAQ,CAACR,aAAT,CAAuBjN,IAAvB,CAAtG;MACAm2E,IAAI,CAAC1nE,MAAL,CAAYipE,SAAZ;;MACA,IAAInhD,KAAK,CAACne,UAAV,EAAsB;QACpB,KAAKw+D,aAAL,CAAmB;UACjBT,IAAI,EAAEuB,SADW;UAEjBp8D,OAAO,EAAEib,KAFQ;UAGjBiO,OAHiB;UAIjB8f,MAJiB;UAKjBuyB;QALiB,CAAnB;MAOD;;MACD,IAAItgD,KAAK,CAAC8K,QAAN,EAAgBjiC,MAAhB,GAAyB,CAA7B,EAAgC;QAC9Bq4E,KAAK,CAACn2E,IAAN,CAAW,CAACi1B,KAAD,EAAQ,CAAC,CAAT,EAAYmhD,SAAZ,CAAX;MACD,CAFD,MAEO,IAAInhD,KAAK,CAAC92B,KAAV,EAAiB;QACtB,MAAMmkE,IAAI,GAAGn2D,QAAQ,CAAC+pE,cAAT,CAAwBjhD,KAAK,CAAC92B,KAA9B,CAAb;;QACA,IAAI63E,gBAAgB,IAAI9T,OAAO,CAACK,eAAR,CAAwB7jE,IAAxB,CAAxB,EAAuD;UACrDogE,QAAQ,CAAC9+D,IAAT,CAAcsiE,IAAd;QACD;;QACD8T,SAAS,CAACjpE,MAAV,CAAiBm1D,IAAjB;MACD;IACF;;IACD,KAAK,MAAMh+C,EAAX,IAAiB2xD,OAAO,CAACK,gBAAR,CAAyB,uDAAzB,CAAjB,EAAoG;MAClGhyD,EAAE,CAAC5Y,YAAH,CAAgB,UAAhB,EAA4B,IAA5B;IACD;;IACD,OAAO;MACLozD;IADK,CAAP;EAGD;;EACY,OAAN/8B,MAAM,CAAC3K,UAAD,EAAa;IACxB,MAAM//B,SAAS,GAAI,UAAS+/B,UAAU,CAACzf,QAAX,CAAoBtgB,SAApB,CAA8B4I,IAA9B,CAAmC,GAAnC,CAAwC,GAApE;IACAm3B,UAAU,CAAC1qB,GAAX,CAAeC,KAAf,CAAqBtV,SAArB,GAAiCA,SAAjC;IACA+/B,UAAU,CAAC1qB,GAAX,CAAe6pE,MAAf,GAAwB,KAAxB;EACD;;AA9MY;;AAiNf,C,CAAC;;AAMD,MAAMC,iBAAiB,GAAG,IAA1B;AACA,MAAMC,kCAAkC,GAAG,CAA3C;AACA,MAAMC,oBAAoB,GAAG,IAAIvE,OAAJ,EAA7B;;AACA,SAASwE,WAAT,CAAqBxyE,IAArB,EAA2B;EACzB,OAAO;IACLiG,KAAK,EAAEjG,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CADhB;IAELkG,MAAM,EAAElG,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD;EAFjB,CAAP;AAID;;AACD,MAAMyyE,wBAAN,CAA+B;EAChB,OAANj2E,MAAM,CAACy2B,UAAD,EAAa;IACxB,MAAM+sB,OAAO,GAAG/sB,UAAU,CAAC5kB,IAAX,CAAgBqkE,cAAhC;;IACA,QAAQ1yB,OAAR;MACE,KAAK/yD,cAAc,CAACE,IAApB;QACE,OAAO,IAAIwlF,qBAAJ,CAA0B1/C,UAA1B,CAAP;;MACF,KAAKhmC,cAAc,CAACC,IAApB;QACE,OAAO,IAAI0lF,qBAAJ,CAA0B3/C,UAA1B,CAAP;;MACF,KAAKhmC,cAAc,CAACgB,MAApB;QACE,MAAM4kF,SAAS,GAAG5/C,UAAU,CAAC5kB,IAAX,CAAgBwkE,SAAlC;;QACA,QAAQA,SAAR;UACE,KAAK,IAAL;YACE,OAAO,IAAIC,2BAAJ,CAAgC7/C,UAAhC,CAAP;;UACF,KAAK,KAAL;YACE,IAAIA,UAAU,CAAC5kB,IAAX,CAAgB0kE,WAApB,EAAiC;cAC/B,OAAO,IAAIC,kCAAJ,CAAuC//C,UAAvC,CAAP;YACD,CAFD,MAEO,IAAIA,UAAU,CAAC5kB,IAAX,CAAgB4kE,QAApB,EAA8B;cACnC,OAAO,IAAIC,+BAAJ,CAAoCjgD,UAApC,CAAP;YACD;;YACD,OAAO,IAAIkgD,iCAAJ,CAAsClgD,UAAtC,CAAP;;UACF,KAAK,IAAL;YACE,OAAO,IAAImgD,6BAAJ,CAAkCngD,UAAlC,CAAP;;UACF,KAAK,KAAL;YACE,OAAO,IAAIogD,gCAAJ,CAAqCpgD,UAArC,CAAP;QAbJ;;QAeA,OAAO,IAAIqgD,uBAAJ,CAA4BrgD,UAA5B,CAAP;;MACF,KAAKhmC,cAAc,CAACY,KAApB;QACE,OAAO,IAAI0lF,sBAAJ,CAA2BtgD,UAA3B,CAAP;;MACF,KAAKhmC,cAAc,CAACtC,QAApB;QACE,OAAO,IAAI6oF,yBAAJ,CAA8BvgD,UAA9B,CAAP;;MACF,KAAKhmC,cAAc,CAACG,IAApB;QACE,OAAO,IAAIqmF,qBAAJ,CAA0BxgD,UAA1B,CAAP;;MACF,KAAKhmC,cAAc,CAACI,MAApB;QACE,OAAO,IAAIqmF,uBAAJ,CAA4BzgD,UAA5B,CAAP;;MACF,KAAKhmC,cAAc,CAACK,MAApB;QACE,OAAO,IAAIqmF,uBAAJ,CAA4B1gD,UAA5B,CAAP;;MACF,KAAKhmC,cAAc,CAACO,QAApB;QACE,OAAO,IAAIomF,yBAAJ,CAA8B3gD,UAA9B,CAAP;;MACF,KAAKhmC,cAAc,CAACW,KAApB;QACE,OAAO,IAAIimF,sBAAJ,CAA2B5gD,UAA3B,CAAP;;MACF,KAAKhmC,cAAc,CAACnC,GAApB;QACE,OAAO,IAAIgpF,oBAAJ,CAAyB7gD,UAAzB,CAAP;;MACF,KAAKhmC,cAAc,CAACM,OAApB;QACE,OAAO,IAAIwmF,wBAAJ,CAA6B9gD,UAA7B,CAAP;;MACF,KAAKhmC,cAAc,CAACrC,SAApB;QACE,OAAO,IAAIopF,0BAAJ,CAA+B/gD,UAA/B,CAAP;;MACF,KAAKhmC,cAAc,CAACQ,SAApB;QACE,OAAO,IAAIwmF,0BAAJ,CAA+BhhD,UAA/B,CAAP;;MACF,KAAKhmC,cAAc,CAACS,QAApB;QACE,OAAO,IAAIwmF,yBAAJ,CAA8BjhD,UAA9B,CAAP;;MACF,KAAKhmC,cAAc,CAACU,SAApB;QACE,OAAO,IAAIwmF,0BAAJ,CAA+BlhD,UAA/B,CAAP;;MACF,KAAKhmC,cAAc,CAACpC,KAApB;QACE,OAAO,IAAIupF,sBAAJ,CAA2BnhD,UAA3B,CAAP;;MACF,KAAKhmC,cAAc,CAACa,cAApB;QACE,OAAO,IAAIumF,+BAAJ,CAAoCphD,UAApC,CAAP;;MACF;QACE,OAAO,IAAIqhD,iBAAJ,CAAsBrhD,UAAtB,CAAP;IAtDJ;EAwDD;;AA3D4B;;AA6D/B,MAAMqhD,iBAAN,CAAwB;EACtB,CAACC,OAAD,GAAW,IAAX;EACA,CAACC,SAAD,GAAa,KAAb;EACA,CAACC,YAAD,GAAgB,IAAhB;;EACAj6E,WAAW,CAACy4B,UAAD,EAAa;IACtByhD,YAAY,GAAG,KADO;IAEtBC,YAAY,GAAG,KAFO;IAGtBC,oBAAoB,GAAG;EAHD,IAIpB,EAJO,EAIH;IACN,KAAKF,YAAL,GAAoBA,YAApB;IACA,KAAKrmE,IAAL,GAAY4kB,UAAU,CAAC5kB,IAAvB;IACA,KAAK0T,KAAL,GAAakR,UAAU,CAAClR,KAAxB;IACA,KAAKqvD,WAAL,GAAmBn+C,UAAU,CAACm+C,WAA9B;IACA,KAAKyD,eAAL,GAAuB5hD,UAAU,CAAC4hD,eAAlC;IACA,KAAKC,kBAAL,GAA0B7hD,UAAU,CAAC6hD,kBAArC;IACA,KAAKC,WAAL,GAAmB9hD,UAAU,CAAC8hD,WAA9B;IACA,KAAKC,UAAL,GAAkB/hD,UAAU,CAAC+hD,UAA7B;IACA,KAAKh4D,iBAAL,GAAyBiW,UAAU,CAACjW,iBAApC;IACA,KAAKi4D,eAAL,GAAuBhiD,UAAU,CAACgiD,eAAlC;IACA,KAAKjQ,YAAL,GAAoB/xC,UAAU,CAAC+xC,YAA/B;IACA,KAAKkQ,aAAL,GAAqBjiD,UAAU,CAACkiD,YAAhC;IACA,KAAK59D,MAAL,GAAc0b,UAAU,CAAC1b,MAAzB;;IACA,IAAIm9D,YAAJ,EAAkB;MAChB,KAAKr1D,SAAL,GAAiB,KAAK+1D,gBAAL,CAAsBT,YAAtB,CAAjB;IACD;;IACD,IAAIC,oBAAJ,EAA0B;MACxB,KAAKS,qBAAL;IACD;EACF;;EACmB,OAAbC,aAAa,CAAC;IACnBC,QADmB;IAEnBC,WAFmB;IAGnBC;EAHmB,CAAD,EAIjB;IACD,OAAO,CAAC,EAAEF,QAAQ,EAAEv5E,GAAV,IAAiBw5E,WAAW,EAAEx5E,GAA9B,IAAqCy5E,QAAQ,EAAEz5E,GAAjD,CAAR;EACD;;EACc,IAAX05E,WAAW,GAAG;IAChB,OAAO,KAAKrnE,IAAL,CAAUsnE,UAAjB;EACD;;EACe,IAAZC,YAAY,GAAG;IACjB,OAAOtB,iBAAiB,CAACgB,aAAlB,CAAgC,KAAKjnE,IAArC,CAAP;EACD;;EACDwnE,YAAY,CAACvpD,MAAD,EAAS;IACnB,IAAI,CAAC,KAAKjN,SAAV,EAAqB;MACnB;IACD;;IACD,KAAK,CAACk1D,OAAN,KAAkB;MAChBv0E,IAAI,EAAE,KAAKqO,IAAL,CAAUrO,IAAV,CAAef,KAAf,CAAqB,CAArB;IADU,CAAlB;IAGA,MAAM;MACJe;IADI,IAEFssB,MAFJ;;IAGA,IAAItsB,IAAJ,EAAU;MACR,KAAK,CAAC81E,aAAN,CAAoB91E,IAApB;IACD;;IACD,KAAK,CAACy0E,YAAN,EAAoBsB,KAApB,CAA0BF,YAA1B,CAAuCvpD,MAAvC;EACD;;EACD0pD,WAAW,GAAG;IACZ,IAAI,CAAC,KAAK,CAACzB,OAAX,EAAoB;MAClB;IACD;;IACD,KAAK,CAACuB,aAAN,CAAoB,KAAK,CAACvB,OAAN,CAAcv0E,IAAlC;IACA,KAAK,CAACy0E,YAAN,EAAoBsB,KAApB,CAA0BC,WAA1B;IACA,KAAK,CAACzB,OAAN,GAAgB,IAAhB;EACD;;EACD,CAACuB,aAAa,CAAC91E,IAAD,EAAO;IACnB,MAAM;MACJqf,SAAS,EAAE;QACT7W;MADS,CADP;MAIJ6F,IAAI,EAAE;QACJrO,IAAI,EAAEi2E,WADF;QAEJrnE;MAFI,CAJF;MAQJ2I,MAAM,EAAE;QACN/D,QAAQ,EAAE;UACRhE,OAAO,EAAE;YACPC,SADO;YAEPC,UAFO;YAGPC,KAHO;YAIPC;UAJO;QADD;MADJ;IARJ,IAkBF,IAlBJ;IAmBAqmE,WAAW,EAAEt7D,MAAb,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,GAAG3a,IAA7B;IACA,MAAM;MACJiG,KADI;MAEJC;IAFI,IAGFssE,WAAW,CAACxyE,IAAD,CAHf;IAIAwI,KAAK,CAACK,IAAN,GAAc,GAAE,OAAO7I,IAAI,CAAC,CAAD,CAAJ,GAAU2P,KAAjB,IAA0BF,SAAU,GAApD;IACAjH,KAAK,CAACI,GAAN,GAAa,GAAE,OAAO8G,UAAU,GAAG1P,IAAI,CAAC,CAAD,CAAjB,GAAuB4P,KAA9B,IAAuCF,UAAW,GAAjE;;IACA,IAAId,QAAQ,KAAK,CAAjB,EAAoB;MAClBpG,KAAK,CAACvC,KAAN,GAAe,GAAE,MAAMA,KAAN,GAAcwJ,SAAU,GAAzC;MACAjH,KAAK,CAACtC,MAAN,GAAgB,GAAE,MAAMA,MAAN,GAAewJ,UAAW,GAA5C;IACD,CAHD,MAGO;MACL,KAAKwmE,WAAL,CAAiBtnE,QAAjB;IACD;EACF;;EACDwmE,gBAAgB,CAACT,YAAD,EAAe;IAC7B,MAAM;MACJtmE,IADI;MAEJkJ,MAAM,EAAE;QACN40D,IADM;QAEN34D;MAFM;IAFJ,IAMF,IANJ;IAOA,MAAM6L,SAAS,GAAGrX,QAAQ,CAACR,aAAT,CAAuB,SAAvB,CAAlB;IACA6X,SAAS,CAAC9X,YAAV,CAAuB,oBAAvB,EAA6C8G,IAAI,CAACnG,EAAlD;;IACA,IAAI,EAAE,gBAAgBorE,uBAAlB,CAAJ,EAAgD;MAC9Cj0D,SAAS,CAAC9I,QAAV,GAAqB87D,iBAArB;IACD;;IACD,MAAM;MACJ7pE;IADI,IAEF6W,SAFJ;IAGA7W,KAAK,CAACM,MAAN,GAAe,KAAKyO,MAAL,CAAYzO,MAAZ,EAAf;;IACA,IAAIuF,IAAI,CAAC8nE,QAAT,EAAmB;MACjB92D,SAAS,CAAC9X,YAAV,CAAuB,eAAvB,EAAwC,QAAxC;IACD;;IACD,IAAI8G,IAAI,CAAC+nE,eAAT,EAA0B;MACxB/2D,SAAS,CAACg3D,KAAV,GAAkBhoE,IAAI,CAAC+nE,eAAvB;IACD;;IACD,IAAI/nE,IAAI,CAACioE,QAAT,EAAmB;MACjBj3D,SAAS,CAACrJ,SAAV,CAAoBC,GAApB,CAAwB,UAAxB;IACD;;IACD,IAAI,CAAC5H,IAAI,CAACrO,IAAN,IAAc,gBAAgBuzE,sBAAlC,EAA0D;MACxD,MAAM;QACJ3kE;MADI,IAEFP,IAFJ;;MAGA,IAAI,CAACA,IAAI,CAAC03C,YAAN,IAAsBn3C,QAAQ,KAAK,CAAvC,EAA0C;QACxC,KAAKsnE,WAAL,CAAiBtnE,QAAjB,EAA2ByQ,SAA3B;MACD;;MACD,OAAOA,SAAP;IACD;;IACD,MAAM;MACJpZ,KADI;MAEJC;IAFI,IAGFssE,WAAW,CAACnkE,IAAI,CAACrO,IAAN,CAHf;;IAIA,IAAI,CAAC20E,YAAD,IAAiBtmE,IAAI,CAACkoE,WAAL,CAAiBtwE,KAAjB,GAAyB,CAA9C,EAAiD;MAC/CuC,KAAK,CAACguE,WAAN,GAAqB,GAAEnoE,IAAI,CAACkoE,WAAL,CAAiBtwE,KAAM,IAA9C;MACA,MAAMwwE,gBAAgB,GAAGpoE,IAAI,CAACkoE,WAAL,CAAiBG,sBAA1C;MACA,MAAMC,cAAc,GAAGtoE,IAAI,CAACkoE,WAAL,CAAiBK,oBAAxC;;MACA,IAAIH,gBAAgB,GAAG,CAAnB,IAAwBE,cAAc,GAAG,CAA7C,EAAgD;QAC9C,MAAME,MAAM,GAAI,QAAOJ,gBAAiB,oCAAmCE,cAAe,2BAA1F;QACAnuE,KAAK,CAACsuE,YAAN,GAAqBD,MAArB;MACD,CAHD,MAGO,IAAI,gBAAgB7D,kCAApB,EAAwD;QAC7D,MAAM6D,MAAM,GAAI,QAAO5wE,KAAM,oCAAmCC,MAAO,2BAAvE;QACAsC,KAAK,CAACsuE,YAAN,GAAqBD,MAArB;MACD;;MACD,QAAQxoE,IAAI,CAACkoE,WAAL,CAAiB/tE,KAAzB;QACE,KAAKjY,yBAAyB,CAACC,KAA/B;UACEgY,KAAK,CAAC+tE,WAAN,GAAoB,OAApB;UACA;;QACF,KAAKhmF,yBAAyB,CAACE,MAA/B;UACE+X,KAAK,CAAC+tE,WAAN,GAAoB,QAApB;UACA;;QACF,KAAKhmF,yBAAyB,CAACG,OAA/B;UACEmI,IAAI,CAAC,qCAAD,CAAJ;UACA;;QACF,KAAKtI,yBAAyB,CAACI,KAA/B;UACEkI,IAAI,CAAC,mCAAD,CAAJ;UACA;;QACF,KAAKtI,yBAAyB,CAAC9C,SAA/B;UACE+a,KAAK,CAACuuE,iBAAN,GAA0B,OAA1B;UACA;;QACF;UACE;MAjBJ;;MAmBA,MAAMC,WAAW,GAAG3oE,IAAI,CAAC2oE,WAAL,IAAoB,IAAxC;;MACA,IAAIA,WAAJ,EAAiB;QACf,KAAK,CAACxC,SAAN,GAAkB,IAAlB;QACAhsE,KAAK,CAACwuE,WAAN,GAAoBlvF,IAAI,CAACiW,YAAL,CAAkBi5E,WAAW,CAAC,CAAD,CAAX,GAAiB,CAAnC,EAAsCA,WAAW,CAAC,CAAD,CAAX,GAAiB,CAAvD,EAA0DA,WAAW,CAAC,CAAD,CAAX,GAAiB,CAA3E,CAApB;MACD,CAHD,MAGO;QACLxuE,KAAK,CAACguE,WAAN,GAAoB,CAApB;MACD;IACF;;IACD,MAAMx2E,IAAI,GAAGlY,IAAI,CAACiY,aAAL,CAAmB,CAACsO,IAAI,CAACrO,IAAL,CAAU,CAAV,CAAD,EAAemsE,IAAI,CAACxf,IAAL,CAAU,CAAV,IAAet+C,IAAI,CAACrO,IAAL,CAAU,CAAV,CAAf,GAA8BmsE,IAAI,CAACxf,IAAL,CAAU,CAAV,CAA7C,EAA2Dt+C,IAAI,CAACrO,IAAL,CAAU,CAAV,CAA3D,EAAyEmsE,IAAI,CAACxf,IAAL,CAAU,CAAV,IAAet+C,IAAI,CAACrO,IAAL,CAAU,CAAV,CAAf,GAA8BmsE,IAAI,CAACxf,IAAL,CAAU,CAAV,CAAvG,CAAnB,CAAb;IACA,MAAM;MACJl9C,SADI;MAEJC,UAFI;MAGJC,KAHI;MAIJC;IAJI,IAKF4D,QAAQ,CAAChE,OALb;IAMAhH,KAAK,CAACK,IAAN,GAAc,GAAE,OAAO7I,IAAI,CAAC,CAAD,CAAJ,GAAU2P,KAAjB,IAA0BF,SAAU,GAApD;IACAjH,KAAK,CAACI,GAAN,GAAa,GAAE,OAAO5I,IAAI,CAAC,CAAD,CAAJ,GAAU4P,KAAjB,IAA0BF,UAAW,GAApD;IACA,MAAM;MACJd;IADI,IAEFP,IAFJ;;IAGA,IAAIA,IAAI,CAAC03C,YAAL,IAAqBn3C,QAAQ,KAAK,CAAtC,EAAyC;MACvCpG,KAAK,CAACvC,KAAN,GAAe,GAAE,MAAMA,KAAN,GAAcwJ,SAAU,GAAzC;MACAjH,KAAK,CAACtC,MAAN,GAAgB,GAAE,MAAMA,MAAN,GAAewJ,UAAW,GAA5C;IACD,CAHD,MAGO;MACL,KAAKwmE,WAAL,CAAiBtnE,QAAjB,EAA2ByQ,SAA3B;IACD;;IACD,OAAOA,SAAP;EACD;;EACD62D,WAAW,CAAC3/C,KAAD,EAAQlX,SAAS,GAAG,KAAKA,SAAzB,EAAoC;IAC7C,IAAI,CAAC,KAAKhR,IAAL,CAAUrO,IAAf,EAAqB;MACnB;IACD;;IACD,MAAM;MACJyP,SADI;MAEJC;IAFI,IAGF,KAAK6H,MAAL,CAAY/D,QAAZ,CAAqBhE,OAHzB;IAIA,MAAM;MACJvJ,KADI;MAEJC;IAFI,IAGFssE,WAAW,CAAC,KAAKnkE,IAAL,CAAUrO,IAAX,CAHf;IAIA,IAAIi3E,YAAJ,EAAkBC,aAAlB;;IACA,IAAI3gD,KAAK,GAAG,GAAR,KAAgB,CAApB,EAAuB;MACrB0gD,YAAY,GAAG,MAAMhxE,KAAN,GAAcwJ,SAA7B;MACAynE,aAAa,GAAG,MAAMhxE,MAAN,GAAewJ,UAA/B;IACD,CAHD,MAGO;MACLunE,YAAY,GAAG,MAAM/wE,MAAN,GAAeuJ,SAA9B;MACAynE,aAAa,GAAG,MAAMjxE,KAAN,GAAcyJ,UAA9B;IACD;;IACD2P,SAAS,CAAC7W,KAAV,CAAgBvC,KAAhB,GAAyB,GAAEgxE,YAAa,GAAxC;IACA53D,SAAS,CAAC7W,KAAV,CAAgBtC,MAAhB,GAA0B,GAAEgxE,aAAc,GAA1C;IACA73D,SAAS,CAAC9X,YAAV,CAAuB,oBAAvB,EAA6C,CAAC,MAAMgvB,KAAP,IAAgB,GAA7D;EACD;;EACiB,IAAd4gD,cAAc,GAAG;IACnB,MAAMC,QAAQ,GAAG,CAACC,MAAD,EAASC,SAAT,EAAoB/7D,KAApB,KAA8B;MAC7C,MAAM/Q,KAAK,GAAG+Q,KAAK,CAACg8D,MAAN,CAAaF,MAAb,CAAd;MACA,MAAMG,SAAS,GAAGhtE,KAAK,CAAC,CAAD,CAAvB;MACA,MAAMitE,UAAU,GAAGjtE,KAAK,CAACvL,KAAN,CAAY,CAAZ,CAAnB;MACAsc,KAAK,CAAC2E,MAAN,CAAa1X,KAAb,CAAmB8uE,SAAnB,IAAgC9H,eAAe,CAAE,GAAEgI,SAAU,OAAd,CAAf,CAAqCC,UAArC,CAAhC;MACA,KAAKz6D,iBAAL,CAAuB8I,QAAvB,CAAgC,KAAKzX,IAAL,CAAUnG,EAA1C,EAA8C;QAC5C,CAACovE,SAAD,GAAa9H,eAAe,CAAE,GAAEgI,SAAU,MAAd,CAAf,CAAoCC,UAApC;MAD+B,CAA9C;IAGD,CARD;;IASA,OAAO5uF,MAAM,CAAC,IAAD,EAAO,gBAAP,EAAyB;MACpC6uF,OAAO,EAAEn8D,KAAK,IAAI;QAChB,MAAM;UACJm8D;QADI,IAEFn8D,KAAK,CAACg8D,MAFV;QAGA,MAAMnF,MAAM,GAAGsF,OAAO,GAAG,CAAV,KAAgB,CAA/B;QACA,KAAKr4D,SAAL,CAAe7W,KAAf,CAAqBC,UAArB,GAAkC2pE,MAAM,GAAG,QAAH,GAAc,SAAtD;QACA,KAAKp1D,iBAAL,CAAuB8I,QAAvB,CAAgC,KAAKzX,IAAL,CAAUnG,EAA1C,EAA8C;UAC5CyvE,MAAM,EAAEvF,MADoC;UAE5CwF,OAAO,EAAEF,OAAO,KAAK,CAAZ,IAAiBA,OAAO,KAAK;QAFM,CAA9C;MAID,CAXmC;MAYpC/3C,KAAK,EAAEpkB,KAAK,IAAI;QACd,KAAKyB,iBAAL,CAAuB8I,QAAvB,CAAgC,KAAKzX,IAAL,CAAUnG,EAA1C,EAA8C;UAC5C0vE,OAAO,EAAE,CAACr8D,KAAK,CAACg8D,MAAN,CAAa53C;QADqB,CAA9C;MAGD,CAhBmC;MAiBpCyyC,MAAM,EAAE72D,KAAK,IAAI;QACf,MAAM;UACJ62D;QADI,IAEF72D,KAAK,CAACg8D,MAFV;QAGA,KAAKl4D,SAAL,CAAe7W,KAAf,CAAqBC,UAArB,GAAkC2pE,MAAM,GAAG,QAAH,GAAc,SAAtD;QACA,KAAKp1D,iBAAL,CAAuB8I,QAAvB,CAAgC,KAAKzX,IAAL,CAAUnG,EAA1C,EAA8C;UAC5C0vE,OAAO,EAAExF,MADmC;UAE5CuF,MAAM,EAAEvF;QAFoC,CAA9C;MAID,CA1BmC;MA2BpC3uD,KAAK,EAAElI,KAAK,IAAI;QACd6P,UAAU,CAAC,MAAM7P,KAAK,CAAC2E,MAAN,CAAauD,KAAb,CAAmB;UAClCgZ,aAAa,EAAE;QADmB,CAAnB,CAAP,EAEN,CAFM,CAAV;MAGD,CA/BmC;MAgCpCo7C,QAAQ,EAAEt8D,KAAK,IAAI;QACjBA,KAAK,CAAC2E,MAAN,CAAam2D,KAAb,GAAqB96D,KAAK,CAACg8D,MAAN,CAAaM,QAAlC;MACD,CAlCmC;MAmCpCC,QAAQ,EAAEv8D,KAAK,IAAI;QACjBA,KAAK,CAAC2E,MAAN,CAAa2Q,QAAb,GAAwBtV,KAAK,CAACg8D,MAAN,CAAaO,QAArC;MACD,CArCmC;MAsCpCC,QAAQ,EAAEx8D,KAAK,IAAI;QACjB,KAAKy8D,YAAL,CAAkBz8D,KAAK,CAAC2E,MAAxB,EAAgC3E,KAAK,CAACg8D,MAAN,CAAaQ,QAA7C;MACD,CAxCmC;MAyCpCzyE,OAAO,EAAEiW,KAAK,IAAI;QAChB67D,QAAQ,CAAC,SAAD,EAAY,iBAAZ,EAA+B77D,KAA/B,CAAR;MACD,CA3CmC;MA4CpCwzB,SAAS,EAAExzB,KAAK,IAAI;QAClB67D,QAAQ,CAAC,WAAD,EAAc,iBAAd,EAAiC77D,KAAjC,CAAR;MACD,CA9CmC;MA+CpClW,OAAO,EAAEkW,KAAK,IAAI;QAChB67D,QAAQ,CAAC,SAAD,EAAY,OAAZ,EAAqB77D,KAArB,CAAR;MACD,CAjDmC;MAkDpC08D,SAAS,EAAE18D,KAAK,IAAI;QAClB67D,QAAQ,CAAC,WAAD,EAAc,OAAd,EAAuB77D,KAAvB,CAAR;MACD,CApDmC;MAqDpCy7D,WAAW,EAAEz7D,KAAK,IAAI;QACpB67D,QAAQ,CAAC,aAAD,EAAgB,aAAhB,EAA+B77D,KAA/B,CAAR;MACD,CAvDmC;MAwDpCyzB,WAAW,EAAEzzB,KAAK,IAAI;QACpB67D,QAAQ,CAAC,aAAD,EAAgB,aAAhB,EAA+B77D,KAA/B,CAAR;MACD,CA1DmC;MA2DpC3M,QAAQ,EAAE2M,KAAK,IAAI;QACjB,MAAMgb,KAAK,GAAGhb,KAAK,CAACg8D,MAAN,CAAa3oE,QAA3B;QACA,KAAKsnE,WAAL,CAAiB3/C,KAAjB;QACA,KAAKvZ,iBAAL,CAAuB8I,QAAvB,CAAgC,KAAKzX,IAAL,CAAUnG,EAA1C,EAA8C;UAC5C0G,QAAQ,EAAE2nB;QADkC,CAA9C;MAGD;IAjEmC,CAAzB,CAAb;EAmED;;EACD2hD,yBAAyB,CAACC,OAAD,EAAUC,OAAV,EAAmB;IAC1C,MAAMC,aAAa,GAAG,KAAKlB,cAA3B;;IACA,KAAK,MAAM58E,IAAX,IAAmBjV,MAAM,CAAC+W,IAAP,CAAY+7E,OAAO,CAACb,MAApB,CAAnB,EAAgD;MAC9C,MAAMhtD,MAAM,GAAG4tD,OAAO,CAAC59E,IAAD,CAAP,IAAiB89E,aAAa,CAAC99E,IAAD,CAA7C;MACAgwB,MAAM,GAAG6tD,OAAH,CAAN;IACD;EACF;;EACDE,2BAA2B,CAACziE,OAAD,EAAU;IACnC,IAAI,CAAC,KAAKo/D,eAAV,EAA2B;MACzB;IACD;;IACD,MAAMtE,UAAU,GAAG,KAAK3zD,iBAAL,CAAuBgS,WAAvB,CAAmC,KAAK3gB,IAAL,CAAUnG,EAA7C,CAAnB;;IACA,IAAI,CAACyoE,UAAL,EAAiB;MACf;IACD;;IACD,MAAM0H,aAAa,GAAG,KAAKlB,cAA3B;;IACA,KAAK,MAAM,CAACptB,UAAD,EAAawtB,MAAb,CAAX,IAAmCjyF,MAAM,CAACsjC,OAAP,CAAe+nD,UAAf,CAAnC,EAA+D;MAC7D,MAAMpmD,MAAM,GAAG8tD,aAAa,CAACtuB,UAAD,CAA5B;;MACA,IAAIx/B,MAAJ,EAAY;QACV,MAAMguD,UAAU,GAAG;UACjBhB,MAAM,EAAE;YACN,CAACxtB,UAAD,GAAcwtB;UADR,CADS;UAIjBr3D,MAAM,EAAErK;QAJS,CAAnB;QAMA0U,MAAM,CAACguD,UAAD,CAAN;QACA,OAAO5H,UAAU,CAAC5mB,UAAD,CAAjB;MACD;IACF;EACF;;EACDsrB,qBAAqB,GAAG;IACtB,IAAI,CAAC,KAAKh2D,SAAV,EAAqB;MACnB;IACD;;IACD,MAAM;MACJm5D;IADI,IAEF,KAAKnqE,IAFT;;IAGA,IAAI,CAACmqE,UAAL,EAAiB;MACf;IACD;;IACD,MAAM,CAACC,OAAD,EAAUC,OAAV,EAAmBC,OAAnB,EAA4BC,OAA5B,IAAuC,KAAKvqE,IAAL,CAAUrO,IAAV,CAAezD,GAAf,CAAmB8E,CAAC,IAAI5F,IAAI,CAACg+C,MAAL,CAAYp4C,CAAZ,CAAxB,CAA7C;;IACA,IAAIm3E,UAAU,CAAC7+E,MAAX,KAAsB,CAA1B,EAA6B;MAC3B,MAAM,CAACk/E,GAAD,EAAMC,GAAN,EAAWC,GAAX,EAAgBC,GAAhB,IAAuBR,UAAU,CAAC58E,QAAX,CAAoB,CAApB,EAAuB,CAAvB,CAA7B;;MACA,IAAI+8E,OAAO,KAAKE,GAAZ,IAAmBD,OAAO,KAAKE,GAA/B,IAAsCL,OAAO,KAAKM,GAAlD,IAAyDL,OAAO,KAAKM,GAAzE,EAA8E;QAC5E;MACD;IACF;;IACD,MAAM;MACJxwE;IADI,IAEF,KAAK6W,SAFT;IAGA,IAAI45D,SAAJ;;IACA,IAAI,KAAK,CAACzE,SAAV,EAAqB;MACnB,MAAM;QACJwC,WADI;QAEJR;MAFI,IAGFhuE,KAHJ;MAIAA,KAAK,CAACguE,WAAN,GAAoB,CAApB;MACAyC,SAAS,GAAG,CAAC,+BAAD,EAAmC,yCAAnC,EAA8E,gDAA9E,EAAgI,iCAAgCjC,WAAY,mBAAkBR,WAAY,IAA1M,CAAZ;MACA,KAAKn3D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,WAA7B;IACD;;IACD,MAAMhQ,KAAK,GAAG0yE,OAAO,GAAGF,OAAxB;IACA,MAAMvyE,MAAM,GAAG0yE,OAAO,GAAGF,OAAzB;IACA,MAAM;MACJ1D;IADI,IAEF,IAFJ;IAGA,MAAM3tE,GAAG,GAAG2tE,UAAU,CAACxtE,aAAX,CAAyB,KAAzB,CAAZ;IACAH,GAAG,CAAC2O,SAAJ,CAAcC,GAAd,CAAkB,yBAAlB;IACA5O,GAAG,CAACE,YAAJ,CAAiB,OAAjB,EAA0B,CAA1B;IACAF,GAAG,CAACE,YAAJ,CAAiB,QAAjB,EAA2B,CAA3B;IACA,MAAMe,IAAI,GAAG0sE,UAAU,CAACxtE,aAAX,CAAyB,MAAzB,CAAb;IACAH,GAAG,CAAC2B,MAAJ,CAAWV,IAAX;IACA,MAAM4wE,QAAQ,GAAGlE,UAAU,CAACxtE,aAAX,CAAyB,UAAzB,CAAjB;IACA,MAAMU,EAAE,GAAI,YAAW,KAAKmG,IAAL,CAAUnG,EAAG,EAApC;IACAgxE,QAAQ,CAAC3xE,YAAT,CAAsB,IAAtB,EAA4BW,EAA5B;IACAgxE,QAAQ,CAAC3xE,YAAT,CAAsB,eAAtB,EAAuC,mBAAvC;IACAe,IAAI,CAACU,MAAL,CAAYkwE,QAAZ;;IACA,KAAK,IAAI39E,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGi2E,UAAU,CAAC7+E,MAAhC,EAAwC4B,CAAC,GAAGgH,EAA5C,EAAgDhH,CAAC,IAAI,CAArD,EAAwD;MACtD,MAAMs9E,GAAG,GAAGL,UAAU,CAACj9E,CAAD,CAAtB;MACA,MAAMu9E,GAAG,GAAGN,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAtB;MACA,MAAMw9E,GAAG,GAAGP,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAtB;MACA,MAAMy9E,GAAG,GAAGR,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAtB;MACA,MAAMyE,IAAI,GAAGg1E,UAAU,CAACxtE,aAAX,CAAyB,MAAzB,CAAb;MACA,MAAMnG,CAAC,GAAG,CAAC03E,GAAG,GAAGN,OAAP,IAAkBxyE,KAA5B;MACA,MAAM3E,CAAC,GAAG,CAACs3E,OAAO,GAAGE,GAAX,IAAkB5yE,MAA5B;MACA,MAAMizE,SAAS,GAAG,CAACN,GAAG,GAAGE,GAAP,IAAc9yE,KAAhC;MACA,MAAMmzE,UAAU,GAAG,CAACN,GAAG,GAAGE,GAAP,IAAc9yE,MAAjC;MACAlG,IAAI,CAACuH,YAAL,CAAkB,GAAlB,EAAuBlG,CAAvB;MACArB,IAAI,CAACuH,YAAL,CAAkB,GAAlB,EAAuBjG,CAAvB;MACAtB,IAAI,CAACuH,YAAL,CAAkB,OAAlB,EAA2B4xE,SAA3B;MACAn5E,IAAI,CAACuH,YAAL,CAAkB,QAAlB,EAA4B6xE,UAA5B;MACAF,QAAQ,CAAClwE,MAAT,CAAgBhJ,IAAhB;MACAi5E,SAAS,EAAEp9E,IAAX,CAAiB,+CAA8CwF,CAAE,QAAOC,CAAE,YAAW63E,SAAU,aAAYC,UAAW,KAAtH;IACD;;IACD,IAAI,KAAK,CAAC5E,SAAV,EAAqB;MACnByE,SAAS,CAACp9E,IAAV,CAAgB,cAAhB;MACA2M,KAAK,CAAC6wE,eAAN,GAAwBJ,SAAS,CAACn9E,IAAV,CAAe,EAAf,CAAxB;IACD;;IACD,KAAKujB,SAAL,CAAerW,MAAf,CAAsB3B,GAAtB;IACA,KAAKgY,SAAL,CAAe7W,KAAf,CAAqB0wE,QAArB,GAAiC,QAAOhxE,EAAG,GAA3C;EACD;;EACDoxE,YAAY,GAAG;IACb,MAAM;MACJj6D,SADI;MAEJhR;IAFI,IAGF,IAHJ;IAIAgR,SAAS,CAAC9X,YAAV,CAAuB,eAAvB,EAAwC,QAAxC;IACA,MAAMwuE,KAAK,GAAG,KAAK,CAACtB,YAAN,GAAqB,IAAIlB,sBAAJ,CAA2B;MAC5DllE,IAAI,EAAE;QACJ7D,KAAK,EAAE6D,IAAI,CAAC7D,KADR;QAEJ+qE,QAAQ,EAAElnE,IAAI,CAACknE,QAFX;QAGJgE,gBAAgB,EAAElrE,IAAI,CAACkrE,gBAHnB;QAIJ/D,WAAW,EAAEnnE,IAAI,CAACmnE,WAJd;QAKJC,QAAQ,EAAEpnE,IAAI,CAAConE,QALX;QAMJ+D,UAAU,EAAEnrE,IAAI,CAACrO,IANb;QAOJu2E,WAAW,EAAE,CAPT;QAQJruE,EAAE,EAAG,SAAQmG,IAAI,CAACnG,EAAG,EARjB;QASJ0G,QAAQ,EAAEP,IAAI,CAACO;MATX,CADsD;MAY5D2I,MAAM,EAAE,KAAKA,MAZ+C;MAa5DkiE,QAAQ,EAAE,CAAC,IAAD;IAbkD,CAA3B,CAAnC;IAeA,KAAKliE,MAAL,CAAYhP,GAAZ,CAAgBS,MAAhB,CAAuB+sE,KAAK,CAACnhE,MAAN,EAAvB;EACD;;EACDA,MAAM,GAAG;IACP9b,WAAW,CAAC,mDAAD,CAAX;EACD;;EACD4gF,kBAAkB,CAACn/E,IAAD,EAAOo/E,MAAM,GAAG,IAAhB,EAAsB;IACtC,MAAMC,MAAM,GAAG,EAAf;;IACA,IAAI,KAAK1E,aAAT,EAAwB;MACtB,MAAM2E,QAAQ,GAAG,KAAK3E,aAAL,CAAmB36E,IAAnB,CAAjB;;MACA,IAAIs/E,QAAJ,EAAc;QACZ,KAAK,MAAM;UACT1N,IADS;UAETjkE,EAFS;UAGT4xE;QAHS,CAAX,IAIKD,QAJL,EAIe;UACb,IAAI1N,IAAI,KAAK,CAAC,CAAd,EAAiB;YACf;UACD;;UACD,IAAIjkE,EAAE,KAAKyxE,MAAX,EAAmB;YACjB;UACD;;UACD,MAAMI,WAAW,GAAG,OAAOD,YAAP,KAAwB,QAAxB,GAAmCA,YAAnC,GAAkD,IAAtE;UACA,MAAME,UAAU,GAAGhyE,QAAQ,CAACk1B,aAAT,CAAwB,qBAAoBh1B,EAAG,IAA/C,CAAnB;;UACA,IAAI8xE,UAAU,IAAI,CAACzH,oBAAoB,CAAC12D,GAArB,CAAyBm+D,UAAzB,CAAnB,EAAyD;YACvDnhF,IAAI,CAAE,6CAA4CqP,EAAG,EAAjD,CAAJ;YACA;UACD;;UACD0xE,MAAM,CAAC/9E,IAAP,CAAY;YACVqM,EADU;YAEV6xE,WAFU;YAGVC;UAHU,CAAZ;QAKD;MACF;;MACD,OAAOJ,MAAP;IACD;;IACD,KAAK,MAAMI,UAAX,IAAyBhyE,QAAQ,CAACiyE,iBAAT,CAA2B1/E,IAA3B,CAAzB,EAA2D;MACzD,MAAM;QACJw/E;MADI,IAEFC,UAFJ;MAGA,MAAM9xE,EAAE,GAAG8xE,UAAU,CAACvrD,YAAX,CAAwB,iBAAxB,CAAX;;MACA,IAAIvmB,EAAE,KAAKyxE,MAAX,EAAmB;QACjB;MACD;;MACD,IAAI,CAACpH,oBAAoB,CAAC12D,GAArB,CAAyBm+D,UAAzB,CAAL,EAA2C;QACzC;MACD;;MACDJ,MAAM,CAAC/9E,IAAP,CAAY;QACVqM,EADU;QAEV6xE,WAFU;QAGVC;MAHU,CAAZ;IAKD;;IACD,OAAOJ,MAAP;EACD;;EACDzjE,IAAI,GAAG;IACL,IAAI,KAAKkJ,SAAT,EAAoB;MAClB,KAAKA,SAAL,CAAe+yD,MAAf,GAAwB,KAAxB;IACD;;IACD,KAAK2D,KAAL,EAAYmE,SAAZ;EACD;;EACDnkE,IAAI,GAAG;IACL,IAAI,KAAKsJ,SAAT,EAAoB;MAClB,KAAKA,SAAL,CAAe+yD,MAAf,GAAwB,IAAxB;IACD;;IACD,KAAK2D,KAAL,EAAYoE,SAAZ;EACD;;EACDC,yBAAyB,GAAG;IAC1B,OAAO,KAAK/6D,SAAZ;EACD;;EACDg7D,gBAAgB,GAAG;IACjB,MAAMC,QAAQ,GAAG,KAAKF,yBAAL,EAAjB;;IACA,IAAI18E,KAAK,CAACyqB,OAAN,CAAcmyD,QAAd,CAAJ,EAA6B;MAC3B,KAAK,MAAMzkE,OAAX,IAAsBykE,QAAtB,EAAgC;QAC9BzkE,OAAO,CAACG,SAAR,CAAkBC,GAAlB,CAAsB,eAAtB;MACD;IACF,CAJD,MAIO;MACLqkE,QAAQ,CAACtkE,SAAT,CAAmBC,GAAnB,CAAuB,eAAvB;IACD;EACF;;EACDskE,kBAAkB,GAAG;IACnB,IAAI,CAAC,KAAK7E,WAAV,EAAuB;MACrB;IACD;;IACD,MAAM;MACJ8E,oBAAoB,EAAE/7D,IADlB;MAEJpQ,IAAI,EAAE;QACJnG,EAAE,EAAE0hB;MADA;IAFF,IAKF,IALJ;IAMA,KAAKvK,SAAL,CAAenK,gBAAf,CAAgC,UAAhC,EAA4C,MAAM;MAChD,KAAKk8D,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,4BAApC,EAAkE;QAChEC,MAAM,EAAE,IADwD;QAEhE5E,IAFgE;QAGhEmL;MAHgE,CAAlE;IAKD,CAND;EAOD;;AApgBqB;;AAsgBxB,MAAM+oD,qBAAN,SAAoC2B,iBAApC,CAAsD;EACpD95E,WAAW,CAACy4B,UAAD,EAAa35B,OAAO,GAAG,IAAvB,EAA6B;IACtC,MAAM25B,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE,CAAC,CAACr7E,OAAO,EAAEq7E,YAFT;MAGhBC,oBAAoB,EAAE;IAHN,CAAlB;IAKA,KAAK6F,aAAL,GAAqBxnD,UAAU,CAAC5kB,IAAX,CAAgBosE,aAArC;EACD;;EACD7lE,MAAM,GAAG;IACP,MAAM;MACJvG,IADI;MAEJ+iE;IAFI,IAGF,IAHJ;IAIA,MAAMsJ,IAAI,GAAG1yE,QAAQ,CAACR,aAAT,CAAuB,GAAvB,CAAb;IACAkzE,IAAI,CAACnzE,YAAL,CAAkB,iBAAlB,EAAqC8G,IAAI,CAACnG,EAA1C;IACA,IAAIyyE,OAAO,GAAG,KAAd;;IACA,IAAItsE,IAAI,CAAClV,GAAT,EAAc;MACZi4E,WAAW,CAACG,iBAAZ,CAA8BmJ,IAA9B,EAAoCrsE,IAAI,CAAClV,GAAzC,EAA8CkV,IAAI,CAACmjE,SAAnD;MACAmJ,OAAO,GAAG,IAAV;IACD,CAHD,MAGO,IAAItsE,IAAI,CAACkc,MAAT,EAAiB;MACtB,KAAKqwD,gBAAL,CAAsBF,IAAtB,EAA4BrsE,IAAI,CAACkc,MAAjC;;MACAowD,OAAO,GAAG,IAAV;IACD,CAHM,MAGA,IAAItsE,IAAI,CAACwsE,UAAT,EAAqB;MAC1B,KAAK,CAACC,cAAN,CAAqBJ,IAArB,EAA2BrsE,IAAI,CAACwsE,UAAhC,EAA4CxsE,IAAI,CAAC0sE,cAAjD;MACAJ,OAAO,GAAG,IAAV;IACD,CAHM,MAGA,IAAItsE,IAAI,CAAC0/C,WAAT,EAAsB;MAC3B,KAAK,CAACitB,eAAN,CAAsBN,IAAtB,EAA4BrsE,IAAI,CAAC0/C,WAAjC;MACA4sB,OAAO,GAAG,IAAV;IACD,CAHM,MAGA,IAAItsE,IAAI,CAACkhC,IAAT,EAAe;MACpB,KAAK0rC,SAAL,CAAeP,IAAf,EAAqBrsE,IAAI,CAACkhC,IAA1B;;MACAorC,OAAO,GAAG,IAAV;IACD,CAHM,MAGA;MACL,IAAItsE,IAAI,CAAC8pE,OAAL,KAAiB9pE,IAAI,CAAC8pE,OAAL,CAAa+C,MAAb,IAAuB7sE,IAAI,CAAC8pE,OAAL,CAAa,UAAb,CAAvB,IAAmD9pE,IAAI,CAAC8pE,OAAL,CAAa,YAAb,CAApE,KAAmG,KAAKlD,eAAxG,IAA2H,KAAKjQ,YAApI,EAAkJ;QAChJ,KAAKmW,aAAL,CAAmBT,IAAnB,EAAyBrsE,IAAzB;;QACAssE,OAAO,GAAG,IAAV;MACD;;MACD,IAAItsE,IAAI,CAAC+sE,SAAT,EAAoB;QAClB,KAAKC,oBAAL,CAA0BX,IAA1B,EAAgCrsE,IAAI,CAAC+sE,SAArC;;QACAT,OAAO,GAAG,IAAV;MACD,CAHD,MAGO,IAAI,KAAKF,aAAL,IAAsB,CAACE,OAA3B,EAAoC;QACzC,KAAKM,SAAL,CAAeP,IAAf,EAAqB,EAArB;;QACAC,OAAO,GAAG,IAAV;MACD;IACF;;IACD,KAAKt7D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,gBAA7B;;IACA,IAAI0kE,OAAJ,EAAa;MACX,KAAKt7D,SAAL,CAAerW,MAAf,CAAsB0xE,IAAtB;IACD;;IACD,OAAO,KAAKr7D,SAAZ;EACD;;EACD,CAACi8D,eAAe,GAAG;IACjB,KAAKj8D,SAAL,CAAe9X,YAAf,CAA4B,oBAA5B,EAAkD,EAAlD;EACD;;EACD0zE,SAAS,CAACP,IAAD,EAAOa,WAAP,EAAoB;IAC3Bb,IAAI,CAAChZ,IAAL,GAAY,KAAK0P,WAAL,CAAiBoK,kBAAjB,CAAoCD,WAApC,CAAZ;;IACAb,IAAI,CAACe,OAAL,GAAe,MAAM;MACnB,IAAIF,WAAJ,EAAiB;QACf,KAAKnK,WAAL,CAAiBsK,eAAjB,CAAiCH,WAAjC;MACD;;MACD,OAAO,KAAP;IACD,CALD;;IAMA,IAAIA,WAAW,IAAIA,WAAW,KAAK,EAAnC,EAAuC;MACrC,KAAK,CAACD,eAAN;IACD;EACF;;EACDV,gBAAgB,CAACF,IAAD,EAAOnwD,MAAP,EAAe;IAC7BmwD,IAAI,CAAChZ,IAAL,GAAY,KAAK0P,WAAL,CAAiBuK,YAAjB,CAA8B,EAA9B,CAAZ;;IACAjB,IAAI,CAACe,OAAL,GAAe,MAAM;MACnB,KAAKrK,WAAL,CAAiBwK,kBAAjB,CAAoCrxD,MAApC;MACA,OAAO,KAAP;IACD,CAHD;;IAIA,KAAK,CAAC+wD,eAAN;EACD;;EACD,CAACR,cAAc,CAACJ,IAAD,EAAOG,UAAP,EAAmBtrC,IAAI,GAAG,IAA1B,EAAgC;IAC7CmrC,IAAI,CAAChZ,IAAL,GAAY,KAAK0P,WAAL,CAAiBuK,YAAjB,CAA8B,EAA9B,CAAZ;;IACA,IAAId,UAAU,CAACgB,WAAf,EAA4B;MAC1BnB,IAAI,CAACrE,KAAL,GAAawE,UAAU,CAACgB,WAAxB;IACD;;IACDnB,IAAI,CAACe,OAAL,GAAe,MAAM;MACnB,KAAK5G,eAAL,EAAsBiH,kBAAtB,CAAyCjB,UAAU,CAAC59C,OAApD,EAA6D49C,UAAU,CAAC3zE,QAAxE,EAAkFqoC,IAAlF;MACA,OAAO,KAAP;IACD,CAHD;;IAIA,KAAK,CAAC+rC,eAAN;EACD;;EACD,CAACN,eAAe,CAACN,IAAD,EAAOnwD,MAAP,EAAe;IAC7BmwD,IAAI,CAAChZ,IAAL,GAAY,KAAK0P,WAAL,CAAiBuK,YAAjB,CAA8B,EAA9B,CAAZ;;IACAjB,IAAI,CAACe,OAAL,GAAe,MAAM;MACnB,KAAKrK,WAAL,CAAiB2K,kBAAjB,CAAoCxxD,MAApC;MACA,OAAO,KAAP;IACD,CAHD;;IAIA,KAAK,CAAC+wD,eAAN;EACD;;EACDH,aAAa,CAACT,IAAD,EAAOrsE,IAAP,EAAa;IACxBqsE,IAAI,CAAChZ,IAAL,GAAY,KAAK0P,WAAL,CAAiBuK,YAAjB,CAA8B,EAA9B,CAAZ;IACA,MAAMp/E,GAAG,GAAG,IAAIsH,GAAJ,CAAQ,CAAC,CAAC,QAAD,EAAW,SAAX,CAAD,EAAwB,CAAC,UAAD,EAAa,WAAb,CAAxB,EAAmD,CAAC,YAAD,EAAe,aAAf,CAAnD,CAAR,CAAZ;;IACA,KAAK,MAAMtJ,IAAX,IAAmBjV,MAAM,CAAC+W,IAAP,CAAYgS,IAAI,CAAC8pE,OAAjB,CAAnB,EAA8C;MAC5C,MAAMd,MAAM,GAAG96E,GAAG,CAAC9W,GAAJ,CAAQ8U,IAAR,CAAf;;MACA,IAAI,CAAC88E,MAAL,EAAa;QACX;MACD;;MACDqD,IAAI,CAACrD,MAAD,CAAJ,GAAe,MAAM;QACnB,KAAKjG,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,wBAApC,EAA8D;UAC5DC,MAAM,EAAE,IADoD;UAE5Dk0D,MAAM,EAAE;YACNrvE,EAAE,EAAEmG,IAAI,CAACnG,EADH;YAEN3N;UAFM;QAFoD,CAA9D;QAOA,OAAO,KAAP;MACD,CATD;IAUD;;IACD,IAAI,CAACmgF,IAAI,CAACe,OAAV,EAAmB;MACjBf,IAAI,CAACe,OAAL,GAAe,MAAM,KAArB;IACD;;IACD,KAAK,CAACH,eAAN;EACD;;EACDD,oBAAoB,CAACX,IAAD,EAAOU,SAAP,EAAkB;IACpC,MAAMY,gBAAgB,GAAGtB,IAAI,CAACe,OAA9B;;IACA,IAAI,CAACO,gBAAL,EAAuB;MACrBtB,IAAI,CAAChZ,IAAL,GAAY,KAAK0P,WAAL,CAAiBuK,YAAjB,CAA8B,EAA9B,CAAZ;IACD;;IACD,KAAK,CAACL,eAAN;;IACA,IAAI,CAAC,KAAKpG,aAAV,EAAyB;MACvBr8E,IAAI,CAAE,2DAAD,GAA8D,uDAA/D,CAAJ;;MACA,IAAI,CAACmjF,gBAAL,EAAuB;QACrBtB,IAAI,CAACe,OAAL,GAAe,MAAM,KAArB;MACD;;MACD;IACD;;IACDf,IAAI,CAACe,OAAL,GAAe,MAAM;MACnBO,gBAAgB;MAChB,MAAM;QACJpC,MAAM,EAAEqC,eADJ;QAEJC,IAAI,EAAEC,aAFF;QAGJC;MAHI,IAIFhB,SAJJ;MAKA,MAAMiB,SAAS,GAAG,EAAlB;;MACA,IAAIJ,eAAe,CAACtiF,MAAhB,KAA2B,CAA3B,IAAgCwiF,aAAa,CAACxiF,MAAd,KAAyB,CAA7D,EAAgE;QAC9D,MAAM2iF,QAAQ,GAAG,IAAIphE,GAAJ,CAAQihE,aAAR,CAAjB;;QACA,KAAK,MAAMI,SAAX,IAAwBN,eAAxB,EAAyC;UACvC,MAAMrC,MAAM,GAAG,KAAK1E,aAAL,CAAmBqH,SAAnB,KAAiC,EAAhD;;UACA,KAAK,MAAM;YACTr0E;UADS,CAAX,IAEK0xE,MAFL,EAEa;YACX0C,QAAQ,CAACrmE,GAAT,CAAa/N,EAAb;UACD;QACF;;QACD,KAAK,MAAM0xE,MAAX,IAAqBt0F,MAAM,CAAC08B,MAAP,CAAc,KAAKkzD,aAAnB,CAArB,EAAwD;UACtD,KAAK,MAAMsH,KAAX,IAAoB5C,MAApB,EAA4B;YAC1B,IAAI0C,QAAQ,CAACzgE,GAAT,CAAa2gE,KAAK,CAACt0E,EAAnB,MAA2Bk0E,OAA/B,EAAwC;cACtCC,SAAS,CAACxgF,IAAV,CAAe2gF,KAAf;YACD;UACF;QACF;MACF,CAjBD,MAiBO;QACL,KAAK,MAAM5C,MAAX,IAAqBt0F,MAAM,CAAC08B,MAAP,CAAc,KAAKkzD,aAAnB,CAArB,EAAwD;UACtDmH,SAAS,CAACxgF,IAAV,CAAe,GAAG+9E,MAAlB;QACD;MACF;;MACD,MAAM76C,OAAO,GAAG,KAAK/hB,iBAArB;MACA,MAAMy/D,MAAM,GAAG,EAAf;;MACA,KAAK,MAAMD,KAAX,IAAoBH,SAApB,EAA+B;QAC7B,MAAM;UACJn0E;QADI,IAEFs0E,KAFJ;QAGAC,MAAM,CAAC5gF,IAAP,CAAYqM,EAAZ;;QACA,QAAQs0E,KAAK,CAACpzF,IAAd;UACE,KAAK,MAAL;YACE;cACE,MAAM4Q,KAAK,GAAGwiF,KAAK,CAACp9C,YAAN,IAAsB,EAApC;cACAL,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;gBACnBlO;cADmB,CAArB;cAGA;YACD;;UACH,KAAK,UAAL;UACA,KAAK,aAAL;YACE;cACE,MAAMA,KAAK,GAAGwiF,KAAK,CAACp9C,YAAN,KAAuBo9C,KAAK,CAAC1C,YAA3C;cACA/6C,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;gBACnBlO;cADmB,CAArB;cAGA;YACD;;UACH,KAAK,UAAL;UACA,KAAK,SAAL;YACE;cACE,MAAMA,KAAK,GAAGwiF,KAAK,CAACp9C,YAAN,IAAsB,EAApC;cACAL,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;gBACnBlO;cADmB,CAArB;cAGA;YACD;;UACH;YACE;QA5BJ;;QA8BA,MAAMggF,UAAU,GAAGhyE,QAAQ,CAACk1B,aAAT,CAAwB,qBAAoBh1B,EAAG,IAA/C,CAAnB;;QACA,IAAI,CAAC8xE,UAAL,EAAiB;UACf;QACD,CAFD,MAEO,IAAI,CAACzH,oBAAoB,CAAC12D,GAArB,CAAyBm+D,UAAzB,CAAL,EAA2C;UAChDnhF,IAAI,CAAE,+CAA8CqP,EAAG,EAAnD,CAAJ;UACA;QACD;;QACD8xE,UAAU,CAAC0C,aAAX,CAAyB,IAAIC,KAAJ,CAAU,WAAV,CAAzB;MACD;;MACD,IAAI,KAAK1H,eAAT,EAA0B;QACxB,KAAK7D,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,wBAApC,EAA8D;UAC5DC,MAAM,EAAE,IADoD;UAE5Dk0D,MAAM,EAAE;YACNrvE,EAAE,EAAE,KADE;YAENo4B,GAAG,EAAEm8C,MAFC;YAGNliF,IAAI,EAAE;UAHA;QAFoD,CAA9D;MAQD;;MACD,OAAO,KAAP;IACD,CAvFD;EAwFD;;AA1NmD;;AA4NtD,MAAMq4E,qBAAN,SAAoC0B,iBAApC,CAAsD;EACpD95E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE;IADE,CAAlB;EAGD;;EACD9/D,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,gBAA7B;IACA,MAAMgC,KAAK,GAAGjQ,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAd;IACAyQ,KAAK,CAACE,GAAN,GAAY,KAAK28D,kBAAL,GAA0B,aAA1B,GAA0C,KAAKzmE,IAAL,CAAU9T,IAAV,CAAe+V,WAAf,EAA1C,GAAyE,MAArF;IACA2H,KAAK,CAAC1Q,YAAN,CAAmB,cAAnB,EAAmC,4BAAnC;IACA0Q,KAAK,CAAC1Q,YAAN,CAAmB,gBAAnB,EAAqCwgB,IAAI,CAACC,SAAL,CAAe;MAClD5+B,IAAI,EAAE,KAAKilB,IAAL,CAAU9T;IADkC,CAAf,CAArC;;IAGA,IAAI,CAAC,KAAK8T,IAAL,CAAU8nE,QAAX,IAAuB,KAAKP,YAAhC,EAA8C;MAC5C,KAAK0D,YAAL;IACD;;IACD,KAAKj6D,SAAL,CAAerW,MAAf,CAAsBiP,KAAtB;IACA,OAAO,KAAKoH,SAAZ;EACD;;AAnBmD;;AAqBtD,MAAMi0D,uBAAN,SAAsCgB,iBAAtC,CAAwD;EACtD1/D,MAAM,GAAG;IACP,OAAO,KAAKyK,SAAZ;EACD;;EACDu9D,wBAAwB,CAAC/mE,OAAD,EAAU;IAChC,IAAI,KAAKxH,IAAL,CAAU03C,YAAd,EAA4B;MAC1B,IAAIlwC,OAAO,CAACgnE,eAAR,EAAyB1/C,QAAzB,KAAsC,QAA1C,EAAoD;QAClDtnB,OAAO,CAACgnE,eAAR,CAAwBzK,MAAxB,GAAiC,IAAjC;MACD;;MACDv8D,OAAO,CAACu8D,MAAR,GAAiB,KAAjB;IACD;EACF;;EACD0K,eAAe,CAACvhE,KAAD,EAAQ;IACrB,OAAOz0B,gBAAgB,CAACoW,QAAjB,CAA0BE,KAA1B,GAAkCme,KAAK,CAACG,OAAxC,GAAkDH,KAAK,CAACE,OAA/D;EACD;;EACDshE,iBAAiB,CAAClnE,OAAD,EAAUmnE,WAAV,EAAuBC,QAAvB,EAAiCC,SAAjC,EAA4CC,WAA5C,EAAyD;IACxE,IAAIF,QAAQ,CAAC5/E,QAAT,CAAkB,OAAlB,CAAJ,EAAgC;MAC9BwY,OAAO,CAACX,gBAAR,CAAyB+nE,QAAzB,EAAmC1hE,KAAK,IAAI;QAC1C,KAAK61D,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,wBAApC,EAA8D;UAC5DC,MAAM,EAAE,IADoD;UAE5Dk0D,MAAM,EAAE;YACNrvE,EAAE,EAAE,KAAKmG,IAAL,CAAUnG,EADR;YAEN3N,IAAI,EAAE2iF,SAFA;YAGNljF,KAAK,EAAEmjF,WAAW,CAAC5hE,KAAD,CAHZ;YAIN2nB,KAAK,EAAE3nB,KAAK,CAACI,QAJP;YAKNyhE,QAAQ,EAAE,KAAKN,eAAL,CAAqBvhE,KAArB;UALJ;QAFoD,CAA9D;MAUD,CAXD;IAYD,CAbD,MAaO;MACL1F,OAAO,CAACX,gBAAR,CAAyB+nE,QAAzB,EAAmC1hE,KAAK,IAAI;QAC1C,IAAI0hE,QAAQ,KAAK,MAAjB,EAAyB;UACvB,IAAI,CAACD,WAAW,CAACK,OAAb,IAAwB,CAAC9hE,KAAK,CAACga,aAAnC,EAAkD;YAChD;UACD;;UACDynD,WAAW,CAACK,OAAZ,GAAsB,KAAtB;QACD,CALD,MAKO,IAAIJ,QAAQ,KAAK,OAAjB,EAA0B;UAC/B,IAAID,WAAW,CAACK,OAAhB,EAAyB;YACvB;UACD;;UACDL,WAAW,CAACK,OAAZ,GAAsB,IAAtB;QACD;;QACD,IAAI,CAACF,WAAL,EAAkB;UAChB;QACD;;QACD,KAAK/L,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,wBAApC,EAA8D;UAC5DC,MAAM,EAAE,IADoD;UAE5Dk0D,MAAM,EAAE;YACNrvE,EAAE,EAAE,KAAKmG,IAAL,CAAUnG,EADR;YAEN3N,IAAI,EAAE2iF,SAFA;YAGNljF,KAAK,EAAEmjF,WAAW,CAAC5hE,KAAD;UAHZ;QAFoD,CAA9D;MAQD,CAvBD;IAwBD;EACF;;EACD+hE,kBAAkB,CAACznE,OAAD,EAAUmnE,WAAV,EAAuBtlE,KAAvB,EAA8B6lE,MAA9B,EAAsC;IACtD,KAAK,MAAM,CAACN,QAAD,EAAWC,SAAX,CAAX,IAAoCxlE,KAApC,EAA2C;MACzC,IAAIwlE,SAAS,KAAK,QAAd,IAA0B,KAAK7uE,IAAL,CAAU8pE,OAAV,GAAoB+E,SAApB,CAA9B,EAA8D;QAC5D,IAAIA,SAAS,KAAK,OAAd,IAAyBA,SAAS,KAAK,MAA3C,EAAmD;UACjDF,WAAW,KAAK;YACdK,OAAO,EAAE;UADK,CAAhB;QAGD;;QACD,KAAKN,iBAAL,CAAuBlnE,OAAvB,EAAgCmnE,WAAhC,EAA6CC,QAA7C,EAAuDC,SAAvD,EAAkEK,MAAlE;;QACA,IAAIL,SAAS,KAAK,OAAd,IAAyB,CAAC,KAAK7uE,IAAL,CAAU8pE,OAAV,EAAmBqF,IAAjD,EAAuD;UACrD,KAAKT,iBAAL,CAAuBlnE,OAAvB,EAAgCmnE,WAAhC,EAA6C,MAA7C,EAAqD,MAArD,EAA6D,IAA7D;QACD,CAFD,MAEO,IAAIE,SAAS,KAAK,MAAd,IAAwB,CAAC,KAAK7uE,IAAL,CAAU8pE,OAAV,EAAmBsF,KAAhD,EAAuD;UAC5D,KAAKV,iBAAL,CAAuBlnE,OAAvB,EAAgCmnE,WAAhC,EAA6C,OAA7C,EAAsD,OAAtD,EAA+D,IAA/D;QACD;MACF;IACF;EACF;;EACDU,mBAAmB,CAAC7nE,OAAD,EAAU;IAC3B,MAAMrL,KAAK,GAAG,KAAK6D,IAAL,CAAU69B,eAAV,IAA6B,IAA3C;IACAr2B,OAAO,CAACrN,KAAR,CAAc0jC,eAAd,GAAgC1hC,KAAK,KAAK,IAAV,GAAiB,aAAjB,GAAiC1iB,IAAI,CAACiW,YAAL,CAAkByM,KAAK,CAAC,CAAD,CAAvB,EAA4BA,KAAK,CAAC,CAAD,CAAjC,EAAsCA,KAAK,CAAC,CAAD,CAA3C,CAAjE;EACD;;EACDmzE,aAAa,CAAC9nE,OAAD,EAAU;IACrB,MAAM+nE,cAAc,GAAG,CAAC,MAAD,EAAS,QAAT,EAAmB,OAAnB,CAAvB;IACA,MAAM;MACJC;IADI,IAEF,KAAKxvE,IAAL,CAAUyvE,qBAFd;IAGA,MAAMvoC,QAAQ,GAAG,KAAKlnC,IAAL,CAAUyvE,qBAAV,CAAgCvoC,QAAhC,IAA4C+8B,kCAA7D;IACA,MAAM9pE,KAAK,GAAGqN,OAAO,CAACrN,KAAtB;IACA,IAAIu1E,gBAAJ;IACA,MAAM1xC,WAAW,GAAG,CAApB;;IACA,MAAM2xC,iBAAiB,GAAG38E,CAAC,IAAI5F,IAAI,CAAC0P,KAAL,CAAW,KAAK9J,CAAhB,IAAqB,EAApD;;IACA,IAAI,KAAKgN,IAAL,CAAU4vE,SAAd,EAAyB;MACvB,MAAM/3E,MAAM,GAAGzK,IAAI,CAAC+F,GAAL,CAAS,KAAK6M,IAAL,CAAUrO,IAAV,CAAe,CAAf,IAAoB,KAAKqO,IAAL,CAAUrO,IAAV,CAAe,CAAf,CAApB,GAAwCqsC,WAAjD,CAAf;MACA,MAAM6xC,aAAa,GAAGziF,IAAI,CAAC0P,KAAL,CAAWjF,MAAM,IAAI1c,WAAW,GAAG+rD,QAAlB,CAAjB,KAAiD,CAAvE;MACA,MAAM8nB,UAAU,GAAGn3D,MAAM,GAAGg4E,aAA5B;MACAH,gBAAgB,GAAGtiF,IAAI,CAACC,GAAL,CAAS65C,QAAT,EAAmByoC,iBAAiB,CAAC3gB,UAAU,GAAG7zE,WAAd,CAApC,CAAnB;IACD,CALD,MAKO;MACL,MAAM0c,MAAM,GAAGzK,IAAI,CAAC+F,GAAL,CAAS,KAAK6M,IAAL,CAAUrO,IAAV,CAAe,CAAf,IAAoB,KAAKqO,IAAL,CAAUrO,IAAV,CAAe,CAAf,CAApB,GAAwCqsC,WAAjD,CAAf;MACA0xC,gBAAgB,GAAGtiF,IAAI,CAACC,GAAL,CAAS65C,QAAT,EAAmByoC,iBAAiB,CAAC93E,MAAM,GAAG1c,WAAV,CAApC,CAAnB;IACD;;IACDgf,KAAK,CAAC+sC,QAAN,GAAkB,QAAOwoC,gBAAiB,2BAA1C;IACAv1E,KAAK,CAACgC,KAAN,GAAc1iB,IAAI,CAACiW,YAAL,CAAkB8/E,SAAS,CAAC,CAAD,CAA3B,EAAgCA,SAAS,CAAC,CAAD,CAAzC,EAA8CA,SAAS,CAAC,CAAD,CAAvD,CAAd;;IACA,IAAI,KAAKxvE,IAAL,CAAU8vE,aAAV,KAA4B,IAAhC,EAAsC;MACpC31E,KAAK,CAAC41E,SAAN,GAAkBR,cAAc,CAAC,KAAKvvE,IAAL,CAAU8vE,aAAX,CAAhC;IACD;EACF;;EACDnG,YAAY,CAACniE,OAAD,EAAUwoE,UAAV,EAAsB;IAChC,IAAIA,UAAJ,EAAgB;MACdxoE,OAAO,CAACtO,YAAR,CAAqB,UAArB,EAAiC,IAAjC;IACD,CAFD,MAEO;MACLsO,OAAO,CAACi7D,eAAR,CAAwB,UAAxB;IACD;;IACDj7D,OAAO,CAACtO,YAAR,CAAqB,eAArB,EAAsC82E,UAAtC;EACD;;AA7GqD;;AA+GxD,MAAMvL,2BAAN,SAA0CQ,uBAA1C,CAAkE;EAChE94E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMyhD,YAAY,GAAGzhD,UAAU,CAAC8hD,WAAX,IAA0B9hD,UAAU,CAAC5kB,IAAX,CAAgB03C,YAA1C,IAA0D,CAAC9yB,UAAU,CAAC5kB,IAAX,CAAgBiwE,aAAjB,IAAkC,CAAC,CAACrrD,UAAU,CAAC5kB,IAAX,CAAgBkwE,UAAnI;IACA,MAAMtrD,UAAN,EAAkB;MAChByhD;IADgB,CAAlB;EAGD;;EACD8J,qBAAqB,CAAC/U,IAAD,EAAOrkF,GAAP,EAAY4U,KAAZ,EAAmBykF,YAAnB,EAAiC;IACpD,MAAM1/C,OAAO,GAAG,KAAK/hB,iBAArB;;IACA,KAAK,MAAMnH,OAAX,IAAsB,KAAK6jE,kBAAL,CAAwBjQ,IAAI,CAAClvE,IAA7B,EAAmCkvE,IAAI,CAACvhE,EAAxC,CAAtB,EAAmE;MACjE,IAAI2N,OAAO,CAACmkE,UAAZ,EAAwB;QACtBnkE,OAAO,CAACmkE,UAAR,CAAmB50F,GAAnB,IAA0B4U,KAA1B;MACD;;MACD+kC,OAAO,CAACjZ,QAAR,CAAiBjQ,OAAO,CAAC3N,EAAzB,EAA6B;QAC3B,CAACu2E,YAAD,GAAgBzkF;MADW,CAA7B;IAGD;EACF;;EACD4a,MAAM,GAAG;IACP,MAAMmqB,OAAO,GAAG,KAAK/hB,iBAArB;IACA,MAAM9U,EAAE,GAAG,KAAKmG,IAAL,CAAUnG,EAArB;IACA,KAAKmX,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,sBAA7B;IACA,IAAIJ,OAAO,GAAG,IAAd;;IACA,IAAI,KAAKk/D,WAAT,EAAsB;MACpB,MAAMpE,UAAU,GAAG5xC,OAAO,CAACI,QAAR,CAAiBj3B,EAAjB,EAAqB;QACtClO,KAAK,EAAE,KAAKqU,IAAL,CAAUkwE;MADqB,CAArB,CAAnB;MAGA,IAAIzuD,WAAW,GAAG6gD,UAAU,CAAC32E,KAAX,IAAoB,EAAtC;MACA,MAAM0kF,MAAM,GAAG3/C,OAAO,CAACI,QAAR,CAAiBj3B,EAAjB,EAAqB;QAClCy2E,SAAS,EAAE,KAAKtwE,IAAL,CAAUqwE;MADa,CAArB,EAEZC,SAFH;;MAGA,IAAID,MAAM,IAAI5uD,WAAW,CAACn2B,MAAZ,GAAqB+kF,MAAnC,EAA2C;QACzC5uD,WAAW,GAAGA,WAAW,CAAC7wB,KAAZ,CAAkB,CAAlB,EAAqBy/E,MAArB,CAAd;MACD;;MACD,IAAIE,oBAAoB,GAAGjO,UAAU,CAACkO,cAAX,IAA6B,KAAKxwE,IAAL,CAAUyhB,WAAV,EAAuBh0B,IAAvB,CAA4B,IAA5B,CAA7B,IAAkE,IAA7F;;MACA,IAAI8iF,oBAAoB,IAAI,KAAKvwE,IAAL,CAAUywE,IAAtC,EAA4C;QAC1CF,oBAAoB,GAAGA,oBAAoB,CAACv8E,UAArB,CAAgC,MAAhC,EAAwC,EAAxC,CAAvB;MACD;;MACD,MAAM26E,WAAW,GAAG;QAClB+B,SAAS,EAAEjvD,WADO;QAElB+uD,cAAc,EAAED,oBAFE;QAGlBI,kBAAkB,EAAE,IAHF;QAIlBC,SAAS,EAAE,CAJO;QAKlB5B,OAAO,EAAE;MALS,CAApB;;MAOA,IAAI,KAAKhvE,IAAL,CAAU4vE,SAAd,EAAyB;QACvBpoE,OAAO,GAAG7N,QAAQ,CAACR,aAAT,CAAuB,UAAvB,CAAV;QACAqO,OAAO,CAACia,WAAR,GAAsB8uD,oBAAoB,IAAI9uD,WAA9C;;QACA,IAAI,KAAKzhB,IAAL,CAAU6wE,WAAd,EAA2B;UACzBrpE,OAAO,CAACrN,KAAR,CAAc22E,SAAd,GAA0B,QAA1B;QACD;MACF,CAND,MAMO;QACLtpE,OAAO,GAAG7N,QAAQ,CAACR,aAAT,CAAuB,OAAvB,CAAV;QACAqO,OAAO,CAACzsB,IAAR,GAAe,MAAf;QACAysB,OAAO,CAACtO,YAAR,CAAqB,OAArB,EAA8Bq3E,oBAAoB,IAAI9uD,WAAtD;;QACA,IAAI,KAAKzhB,IAAL,CAAU6wE,WAAd,EAA2B;UACzBrpE,OAAO,CAACrN,KAAR,CAAc42E,SAAd,GAA0B,QAA1B;QACD;MACF;;MACD,IAAI,KAAK/wE,IAAL,CAAU03C,YAAd,EAA4B;QAC1BlwC,OAAO,CAACu8D,MAAR,GAAiB,IAAjB;MACD;;MACDG,oBAAoB,CAACt8D,GAArB,CAAyBJ,OAAzB;MACAA,OAAO,CAACtO,YAAR,CAAqB,iBAArB,EAAwCW,EAAxC;MACA2N,OAAO,CAACgb,QAAR,GAAmB,KAAKxiB,IAAL,CAAUgxE,QAA7B;MACAxpE,OAAO,CAACtb,IAAR,GAAe,KAAK8T,IAAL,CAAUkuE,SAAzB;MACA1mE,OAAO,CAACU,QAAR,GAAmB87D,iBAAnB;;MACA,KAAK2F,YAAL,CAAkBniE,OAAlB,EAA2B,KAAKxH,IAAL,CAAU0pE,QAArC;;MACA,IAAI2G,MAAJ,EAAY;QACV7oE,OAAO,CAACypE,SAAR,GAAoBZ,MAApB;MACD;;MACD7oE,OAAO,CAACX,gBAAR,CAAyB,OAAzB,EAAkCqG,KAAK,IAAI;QACzCwjB,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;UACnBlO,KAAK,EAAEuhB,KAAK,CAAC2E,MAAN,CAAalmB;QADD,CAArB;QAGA,KAAKwkF,qBAAL,CAA2B3oE,OAA3B,EAAoC,OAApC,EAA6C0F,KAAK,CAAC2E,MAAN,CAAalmB,KAA1D,EAAiE,OAAjE;QACAgjF,WAAW,CAAC6B,cAAZ,GAA6B,IAA7B;MACD,CAND;MAOAhpE,OAAO,CAACX,gBAAR,CAAyB,WAAzB,EAAsCqG,KAAK,IAAI;QAC7C,MAAM6jB,YAAY,GAAG,KAAK/wB,IAAL,CAAUkxE,iBAAV,IAA+B,EAApD;QACA1pE,OAAO,CAAC7b,KAAR,GAAgBgjF,WAAW,CAAC+B,SAAZ,GAAwB3/C,YAAxC;QACA49C,WAAW,CAAC6B,cAAZ,GAA6B,IAA7B;MACD,CAJD;;MAKA,IAAIW,YAAY,GAAGjkE,KAAK,IAAI;QAC1B,MAAM;UACJsjE;QADI,IAEF7B,WAFJ;;QAGA,IAAI6B,cAAc,KAAK,IAAnB,IAA2BA,cAAc,KAAK5jF,SAAlD,EAA6D;UAC3DsgB,KAAK,CAAC2E,MAAN,CAAalmB,KAAb,GAAqB6kF,cAArB;QACD;;QACDtjE,KAAK,CAAC2E,MAAN,CAAau/D,UAAb,GAA0B,CAA1B;MACD,CARD;;MASA,IAAI,KAAKxK,eAAL,IAAwB,KAAKjQ,YAAjC,EAA+C;QAC7CnvD,OAAO,CAACX,gBAAR,CAAyB,OAAzB,EAAkCqG,KAAK,IAAI;UACzC,IAAIyhE,WAAW,CAACK,OAAhB,EAAyB;YACvB;UACD;;UACD,MAAM;YACJn9D;UADI,IAEF3E,KAFJ;;UAGA,IAAIyhE,WAAW,CAAC+B,SAAhB,EAA2B;YACzB7+D,MAAM,CAAClmB,KAAP,GAAegjF,WAAW,CAAC+B,SAA3B;UACD;;UACD/B,WAAW,CAACgC,kBAAZ,GAAiC9+D,MAAM,CAAClmB,KAAxC;UACAgjF,WAAW,CAACiC,SAAZ,GAAwB,CAAxB;;UACA,IAAI,CAAC,KAAK5wE,IAAL,CAAU8pE,OAAV,EAAmBsF,KAAxB,EAA+B;YAC7BT,WAAW,CAACK,OAAZ,GAAsB,IAAtB;UACD;QACF,CAfD;QAgBAxnE,OAAO,CAACX,gBAAR,CAAyB,mBAAzB,EAA8CkjE,OAAO,IAAI;UACvD,KAAKwE,wBAAL,CAA8BxE,OAAO,CAACl4D,MAAtC;UACA,MAAMi4D,OAAO,GAAG;YACdn+E,KAAK,CAACuhB,KAAD,EAAQ;cACXyhE,WAAW,CAAC+B,SAAZ,GAAwBxjE,KAAK,CAACg8D,MAAN,CAAav9E,KAAb,IAAsB,EAA9C;cACA+kC,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;gBACnBlO,KAAK,EAAEgjF,WAAW,CAAC+B,SAAZ,CAAsBlhF,QAAtB;cADY,CAArB;cAGA0d,KAAK,CAAC2E,MAAN,CAAalmB,KAAb,GAAqBgjF,WAAW,CAAC+B,SAAjC;YACD,CAPa;;YAQdF,cAAc,CAACtjE,KAAD,EAAQ;cACpB,MAAM;gBACJsjE;cADI,IAEFtjE,KAAK,CAACg8D,MAFV;cAGAyF,WAAW,CAAC6B,cAAZ,GAA6BA,cAA7B;;cACA,IAAIA,cAAc,KAAK,IAAnB,IAA2BA,cAAc,KAAK5jF,SAA9C,IAA2DsgB,KAAK,CAAC2E,MAAN,KAAiBlY,QAAQ,CAAC6X,aAAzF,EAAwG;gBACtGtE,KAAK,CAAC2E,MAAN,CAAalmB,KAAb,GAAqB6kF,cAArB;cACD;;cACD9/C,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;gBACnB22E;cADmB,CAArB;YAGD,CAnBa;;YAoBda,QAAQ,CAACnkE,KAAD,EAAQ;cACdA,KAAK,CAAC2E,MAAN,CAAay/D,iBAAb,CAA+B,GAAGpkE,KAAK,CAACg8D,MAAN,CAAamI,QAA/C;YACD,CAtBa;;YAuBdf,SAAS,EAAEpjE,KAAK,IAAI;cAClB,MAAM;gBACJojE;cADI,IAEFpjE,KAAK,CAACg8D,MAFV;cAGA,MAAM;gBACJr3D;cADI,IAEF3E,KAFJ;;cAGA,IAAIojE,SAAS,KAAK,CAAlB,EAAqB;gBACnBz+D,MAAM,CAAC4wD,eAAP,CAAuB,WAAvB;gBACA;cACD;;cACD5wD,MAAM,CAAC3Y,YAAP,CAAoB,WAApB,EAAiCo3E,SAAjC;cACA,IAAI3kF,KAAK,GAAGgjF,WAAW,CAAC+B,SAAxB;;cACA,IAAI,CAAC/kF,KAAD,IAAUA,KAAK,CAACL,MAAN,IAAgBglF,SAA9B,EAAyC;gBACvC;cACD;;cACD3kF,KAAK,GAAGA,KAAK,CAACiF,KAAN,CAAY,CAAZ,EAAe0/E,SAAf,CAAR;cACAz+D,MAAM,CAAClmB,KAAP,GAAegjF,WAAW,CAAC+B,SAAZ,GAAwB/kF,KAAvC;cACA+kC,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;gBACnBlO;cADmB,CAArB;cAGA,KAAKo3E,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,wBAApC,EAA8D;gBAC5DC,MAAM,EAAE,IADoD;gBAE5Dk0D,MAAM,EAAE;kBACNrvE,EADM;kBAEN3N,IAAI,EAAE,WAFA;kBAGNP,KAHM;kBAIN4lF,UAAU,EAAE,IAJN;kBAKNX,SAAS,EAAE,CALL;kBAMNY,QAAQ,EAAE3/D,MAAM,CAAC4/D,cANX;kBAONC,MAAM,EAAE7/D,MAAM,CAAC8/D;gBAPT;cAFoD,CAA9D;YAYD;UAxDa,CAAhB;;UA0DA,KAAK9H,yBAAL,CAA+BC,OAA/B,EAAwCC,OAAxC;QACD,CA7DD;QA8DAviE,OAAO,CAACX,gBAAR,CAAyB,SAAzB,EAAoCqG,KAAK,IAAI;UAC3CyhE,WAAW,CAACiC,SAAZ,GAAwB,CAAxB;UACA,IAAIA,SAAS,GAAG,CAAC,CAAjB;;UACA,IAAI1jE,KAAK,CAACn2B,GAAN,KAAc,QAAlB,EAA4B;YAC1B65F,SAAS,GAAG,CAAZ;UACD,CAFD,MAEO,IAAI1jE,KAAK,CAACn2B,GAAN,KAAc,OAAd,IAAyB,CAAC,KAAKipB,IAAL,CAAU4vE,SAAxC,EAAmD;YACxDgB,SAAS,GAAG,CAAZ;UACD,CAFM,MAEA,IAAI1jE,KAAK,CAACn2B,GAAN,KAAc,KAAlB,EAAyB;YAC9B43F,WAAW,CAACiC,SAAZ,GAAwB,CAAxB;UACD;;UACD,IAAIA,SAAS,KAAK,CAAC,CAAnB,EAAsB;YACpB;UACD;;UACD,MAAM;YACJjlF;UADI,IAEFuhB,KAAK,CAAC2E,MAFV;;UAGA,IAAI88D,WAAW,CAACgC,kBAAZ,KAAmChlF,KAAvC,EAA8C;YAC5C;UACD;;UACDgjF,WAAW,CAACgC,kBAAZ,GAAiChlF,KAAjC;UACAgjF,WAAW,CAAC+B,SAAZ,GAAwB/kF,KAAxB;UACA,KAAKo3E,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,wBAApC,EAA8D;YAC5DC,MAAM,EAAE,IADoD;YAE5Dk0D,MAAM,EAAE;cACNrvE,EADM;cAEN3N,IAAI,EAAE,WAFA;cAGNP,KAHM;cAIN4lF,UAAU,EAAE,IAJN;cAKNX,SALM;cAMNY,QAAQ,EAAEtkE,KAAK,CAAC2E,MAAN,CAAa4/D,cANjB;cAONC,MAAM,EAAExkE,KAAK,CAAC2E,MAAN,CAAa8/D;YAPf;UAFoD,CAA9D;QAYD,CAjCD;QAkCA,MAAMC,aAAa,GAAGT,YAAtB;QACAA,YAAY,GAAG,IAAf;QACA3pE,OAAO,CAACX,gBAAR,CAAyB,MAAzB,EAAiCqG,KAAK,IAAI;UACxC,IAAI,CAACyhE,WAAW,CAACK,OAAb,IAAwB,CAAC9hE,KAAK,CAACga,aAAnC,EAAkD;YAChD;UACD;;UACD,IAAI,CAAC,KAAKlnB,IAAL,CAAU8pE,OAAV,EAAmBqF,IAAxB,EAA8B;YAC5BR,WAAW,CAACK,OAAZ,GAAsB,KAAtB;UACD;;UACD,MAAM;YACJrjF;UADI,IAEFuhB,KAAK,CAAC2E,MAFV;UAGA88D,WAAW,CAAC+B,SAAZ,GAAwB/kF,KAAxB;;UACA,IAAIgjF,WAAW,CAACgC,kBAAZ,KAAmChlF,KAAvC,EAA8C;YAC5C,KAAKo3E,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,wBAApC,EAA8D;cAC5DC,MAAM,EAAE,IADoD;cAE5Dk0D,MAAM,EAAE;gBACNrvE,EADM;gBAEN3N,IAAI,EAAE,WAFA;gBAGNP,KAHM;gBAIN4lF,UAAU,EAAE,IAJN;gBAKNX,SAAS,EAAEjC,WAAW,CAACiC,SALjB;gBAMNY,QAAQ,EAAEtkE,KAAK,CAAC2E,MAAN,CAAa4/D,cANjB;gBAONC,MAAM,EAAExkE,KAAK,CAAC2E,MAAN,CAAa8/D;cAPf;YAFoD,CAA9D;UAYD;;UACDC,aAAa,CAAC1kE,KAAD,CAAb;QACD,CA1BD;;QA2BA,IAAI,KAAKlN,IAAL,CAAU8pE,OAAV,EAAmB+H,SAAvB,EAAkC;UAChCrqE,OAAO,CAACX,gBAAR,CAAyB,aAAzB,EAAwCqG,KAAK,IAAI;YAC/CyhE,WAAW,CAACgC,kBAAZ,GAAiC,IAAjC;YACA,MAAM;cACJ3wE,IADI;cAEJ6R;YAFI,IAGF3E,KAHJ;YAIA,MAAM;cACJvhB,KADI;cAEJ8lF,cAFI;cAGJE;YAHI,IAIF9/D,MAJJ;YAKA,IAAI2/D,QAAQ,GAAGC,cAAf;YAAA,IACEC,MAAM,GAAGC,YADX;;YAEA,QAAQzkE,KAAK,CAAC4kE,SAAd;cACE,KAAK,oBAAL;gBACE;kBACE,MAAMzmF,KAAK,GAAGM,KAAK,CAACqW,SAAN,CAAgB,CAAhB,EAAmByvE,cAAnB,EAAmCpmF,KAAnC,CAAyC,YAAzC,CAAd;;kBACA,IAAIA,KAAJ,EAAW;oBACTmmF,QAAQ,IAAInmF,KAAK,CAAC,CAAD,CAAL,CAASC,MAArB;kBACD;;kBACD;gBACD;;cACH,KAAK,mBAAL;gBACE;kBACE,MAAMD,KAAK,GAAGM,KAAK,CAACqW,SAAN,CAAgByvE,cAAhB,EAAgCpmF,KAAhC,CAAsC,YAAtC,CAAd;;kBACA,IAAIA,KAAJ,EAAW;oBACTqmF,MAAM,IAAIrmF,KAAK,CAAC,CAAD,CAAL,CAASC,MAAnB;kBACD;;kBACD;gBACD;;cACH,KAAK,uBAAL;gBACE,IAAImmF,cAAc,KAAKE,YAAvB,EAAqC;kBACnCH,QAAQ,IAAI,CAAZ;gBACD;;gBACD;;cACF,KAAK,sBAAL;gBACE,IAAIC,cAAc,KAAKE,YAAvB,EAAqC;kBACnCD,MAAM,IAAI,CAAV;gBACD;;gBACD;YA1BJ;;YA4BAxkE,KAAK,CAAC9J,cAAN;YACA,KAAK2/D,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,wBAApC,EAA8D;cAC5DC,MAAM,EAAE,IADoD;cAE5Dk0D,MAAM,EAAE;gBACNrvE,EADM;gBAEN3N,IAAI,EAAE,WAFA;gBAGNP,KAHM;gBAINomF,MAAM,EAAE/xE,IAAI,IAAI,EAJV;gBAKNuxE,UAAU,EAAE,KALN;gBAMNC,QANM;gBAONE;cAPM;YAFoD,CAA9D;UAYD,CAtDD;QAuDD;;QACD,KAAKzC,kBAAL,CAAwBznE,OAAxB,EAAiCmnE,WAAjC,EAA8C,CAAC,CAAC,OAAD,EAAU,OAAV,CAAD,EAAqB,CAAC,MAAD,EAAS,MAAT,CAArB,EAAuC,CAAC,WAAD,EAAc,YAAd,CAAvC,EAAoE,CAAC,YAAD,EAAe,aAAf,CAApE,EAAmG,CAAC,YAAD,EAAe,YAAf,CAAnG,EAAiI,CAAC,SAAD,EAAY,UAAZ,CAAjI,CAA9C,EAAyMzhE,KAAK,IAAIA,KAAK,CAAC2E,MAAN,CAAalmB,KAA/N;MACD;;MACD,IAAIwlF,YAAJ,EAAkB;QAChB3pE,OAAO,CAACX,gBAAR,CAAyB,MAAzB,EAAiCsqE,YAAjC;MACD;;MACD,IAAI,KAAKnxE,IAAL,CAAUywE,IAAd,EAAoB;QAClB,MAAMuB,UAAU,GAAG,KAAKhyE,IAAL,CAAUrO,IAAV,CAAe,CAAf,IAAoB,KAAKqO,IAAL,CAAUrO,IAAV,CAAe,CAAf,CAAvC;QACA,MAAMsgF,SAAS,GAAGD,UAAU,GAAG3B,MAA/B;QACA7oE,OAAO,CAACG,SAAR,CAAkBC,GAAlB,CAAsB,MAAtB;QACAJ,OAAO,CAACrN,KAAR,CAAc+3E,aAAd,GAA+B,QAAOD,SAAU,iCAAhD;MACD;IACF,CAvRD,MAuRO;MACLzqE,OAAO,GAAG7N,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAV;MACAqO,OAAO,CAACia,WAAR,GAAsB,KAAKzhB,IAAL,CAAUkwE,UAAhC;MACA1oE,OAAO,CAACrN,KAAR,CAAcg4E,aAAd,GAA8B,QAA9B;MACA3qE,OAAO,CAACrN,KAAR,CAAckvE,OAAd,GAAwB,YAAxB;;MACA,IAAI,KAAKrpE,IAAL,CAAU03C,YAAd,EAA4B;QAC1BlwC,OAAO,CAACu8D,MAAR,GAAiB,IAAjB;MACD;IACF;;IACD,KAAKuL,aAAL,CAAmB9nE,OAAnB;;IACA,KAAK6nE,mBAAL,CAAyB7nE,OAAzB;;IACA,KAAKyiE,2BAAL,CAAiCziE,OAAjC;;IACA,KAAKwJ,SAAL,CAAerW,MAAf,CAAsB6M,OAAtB;IACA,OAAO,KAAKwJ,SAAZ;EACD;;AA5T+D;;AA8TlE,MAAMg0D,gCAAN,SAA+CC,uBAA/C,CAAuE;EACrE94E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,CAAC,CAACzhD,UAAU,CAAC5kB,IAAX,CAAgB03C;IADhB,CAAlB;EAGD;;AALoE;;AAOvE,MAAMmtB,+BAAN,SAA8CI,uBAA9C,CAAsE;EACpE94E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAEzhD,UAAU,CAAC8hD;IADT,CAAlB;EAGD;;EACDngE,MAAM,GAAG;IACP,MAAMmqB,OAAO,GAAG,KAAK/hB,iBAArB;IACA,MAAM3O,IAAI,GAAG,KAAKA,IAAlB;IACA,MAAMnG,EAAE,GAAGmG,IAAI,CAACnG,EAAhB;IACA,IAAIlO,KAAK,GAAG+kC,OAAO,CAACI,QAAR,CAAiBj3B,EAAjB,EAAqB;MAC/BlO,KAAK,EAAEqU,IAAI,CAAC0rE,WAAL,KAAqB1rE,IAAI,CAACkwE;IADF,CAArB,EAETvkF,KAFH;;IAGA,IAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;MAC7BA,KAAK,GAAGA,KAAK,KAAK,KAAlB;MACA+kC,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;QACnBlO;MADmB,CAArB;IAGD;;IACD,KAAKqlB,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,wBAA7B,EAAuD,UAAvD;IACA,MAAMJ,OAAO,GAAG7N,QAAQ,CAACR,aAAT,CAAuB,OAAvB,CAAhB;IACA+qE,oBAAoB,CAACt8D,GAArB,CAAyBJ,OAAzB;IACAA,OAAO,CAACtO,YAAR,CAAqB,iBAArB,EAAwCW,EAAxC;IACA2N,OAAO,CAACgb,QAAR,GAAmBxiB,IAAI,CAACgxE,QAAxB;;IACA,KAAKrH,YAAL,CAAkBniE,OAAlB,EAA2B,KAAKxH,IAAL,CAAU0pE,QAArC;;IACAliE,OAAO,CAACzsB,IAAR,GAAe,UAAf;IACAysB,OAAO,CAACtb,IAAR,GAAe8T,IAAI,CAACkuE,SAApB;;IACA,IAAIviF,KAAJ,EAAW;MACT6b,OAAO,CAACtO,YAAR,CAAqB,SAArB,EAAgC,IAAhC;IACD;;IACDsO,OAAO,CAACtO,YAAR,CAAqB,aAArB,EAAoC8G,IAAI,CAAC0rE,WAAzC;IACAlkE,OAAO,CAACU,QAAR,GAAmB87D,iBAAnB;IACAx8D,OAAO,CAACX,gBAAR,CAAyB,QAAzB,EAAmCqG,KAAK,IAAI;MAC1C,MAAM;QACJhhB,IADI;QAEJw2E;MAFI,IAGFx1D,KAAK,CAAC2E,MAHV;;MAIA,KAAK,MAAMugE,QAAX,IAAuB,KAAK/G,kBAAL,CAAwBn/E,IAAxB,EAA8B2N,EAA9B,CAAvB,EAA0D;QACxD,MAAMw4E,UAAU,GAAG3P,OAAO,IAAI0P,QAAQ,CAAC1G,WAAT,KAAyB1rE,IAAI,CAAC0rE,WAA5D;;QACA,IAAI0G,QAAQ,CAACzG,UAAb,EAAyB;UACvByG,QAAQ,CAACzG,UAAT,CAAoBjJ,OAApB,GAA8B2P,UAA9B;QACD;;QACD3hD,OAAO,CAACjZ,QAAR,CAAiB26D,QAAQ,CAACv4E,EAA1B,EAA8B;UAC5BlO,KAAK,EAAE0mF;QADqB,CAA9B;MAGD;;MACD3hD,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;QACnBlO,KAAK,EAAE+2E;MADY,CAArB;IAGD,CAjBD;IAkBAl7D,OAAO,CAACX,gBAAR,CAAyB,WAAzB,EAAsCqG,KAAK,IAAI;MAC7C,MAAM6jB,YAAY,GAAG/wB,IAAI,CAACkxE,iBAAL,IAA0B,KAA/C;MACAhkE,KAAK,CAAC2E,MAAN,CAAa6wD,OAAb,GAAuB3xC,YAAY,KAAK/wB,IAAI,CAAC0rE,WAA7C;IACD,CAHD;;IAIA,IAAI,KAAK9E,eAAL,IAAwB,KAAKjQ,YAAjC,EAA+C;MAC7CnvD,OAAO,CAACX,gBAAR,CAAyB,mBAAzB,EAA8CkjE,OAAO,IAAI;QACvD,MAAMD,OAAO,GAAG;UACdn+E,KAAK,CAACuhB,KAAD,EAAQ;YACXA,KAAK,CAAC2E,MAAN,CAAa6wD,OAAb,GAAuBx1D,KAAK,CAACg8D,MAAN,CAAav9E,KAAb,KAAuB,KAA9C;YACA+kC,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;cACnBlO,KAAK,EAAEuhB,KAAK,CAAC2E,MAAN,CAAa6wD;YADD,CAArB;UAGD;;QANa,CAAhB;;QAQA,KAAKmH,yBAAL,CAA+BC,OAA/B,EAAwCC,OAAxC;MACD,CAVD;;MAWA,KAAKkF,kBAAL,CAAwBznE,OAAxB,EAAiC,IAAjC,EAAuC,CAAC,CAAC,QAAD,EAAW,UAAX,CAAD,EAAyB,CAAC,QAAD,EAAW,QAAX,CAAzB,EAA+C,CAAC,OAAD,EAAU,OAAV,CAA/C,EAAmE,CAAC,MAAD,EAAS,MAAT,CAAnE,EAAqF,CAAC,WAAD,EAAc,YAAd,CAArF,EAAkH,CAAC,YAAD,EAAe,aAAf,CAAlH,EAAiJ,CAAC,YAAD,EAAe,YAAf,CAAjJ,EAA+K,CAAC,SAAD,EAAY,UAAZ,CAA/K,CAAvC,EAAgP0F,KAAK,IAAIA,KAAK,CAAC2E,MAAN,CAAa6wD,OAAtQ;IACD;;IACD,KAAK2M,mBAAL,CAAyB7nE,OAAzB;;IACA,KAAKyiE,2BAAL,CAAiCziE,OAAjC;;IACA,KAAKwJ,SAAL,CAAerW,MAAf,CAAsB6M,OAAtB;IACA,OAAO,KAAKwJ,SAAZ;EACD;;AAxEmE;;AA0EtE,MAAM2zD,kCAAN,SAAiDM,uBAAjD,CAAyE;EACvE94E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAEzhD,UAAU,CAAC8hD;IADT,CAAlB;EAGD;;EACDngE,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,wBAA7B,EAAuD,aAAvD;IACA,MAAM8oB,OAAO,GAAG,KAAK/hB,iBAArB;IACA,MAAM3O,IAAI,GAAG,KAAKA,IAAlB;IACA,MAAMnG,EAAE,GAAGmG,IAAI,CAACnG,EAAhB;IACA,IAAIlO,KAAK,GAAG+kC,OAAO,CAACI,QAAR,CAAiBj3B,EAAjB,EAAqB;MAC/BlO,KAAK,EAAEqU,IAAI,CAACkwE,UAAL,KAAoBlwE,IAAI,CAACsyE;IADD,CAArB,EAET3mF,KAFH;;IAGA,IAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;MAC7BA,KAAK,GAAGA,KAAK,KAAKqU,IAAI,CAACsyE,WAAvB;MACA5hD,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;QACnBlO;MADmB,CAArB;IAGD;;IACD,IAAIA,KAAJ,EAAW;MACT,KAAK,MAAM4mF,KAAX,IAAoB,KAAKlH,kBAAL,CAAwBrrE,IAAI,CAACkuE,SAA7B,EAAwCr0E,EAAxC,CAApB,EAAiE;QAC/D62B,OAAO,CAACjZ,QAAR,CAAiB86D,KAAK,CAAC14E,EAAvB,EAA2B;UACzBlO,KAAK,EAAE;QADkB,CAA3B;MAGD;IACF;;IACD,MAAM6b,OAAO,GAAG7N,QAAQ,CAACR,aAAT,CAAuB,OAAvB,CAAhB;IACA+qE,oBAAoB,CAACt8D,GAArB,CAAyBJ,OAAzB;IACAA,OAAO,CAACtO,YAAR,CAAqB,iBAArB,EAAwCW,EAAxC;IACA2N,OAAO,CAACgb,QAAR,GAAmBxiB,IAAI,CAACgxE,QAAxB;;IACA,KAAKrH,YAAL,CAAkBniE,OAAlB,EAA2B,KAAKxH,IAAL,CAAU0pE,QAArC;;IACAliE,OAAO,CAACzsB,IAAR,GAAe,OAAf;IACAysB,OAAO,CAACtb,IAAR,GAAe8T,IAAI,CAACkuE,SAApB;;IACA,IAAIviF,KAAJ,EAAW;MACT6b,OAAO,CAACtO,YAAR,CAAqB,SAArB,EAAgC,IAAhC;IACD;;IACDsO,OAAO,CAACU,QAAR,GAAmB87D,iBAAnB;IACAx8D,OAAO,CAACX,gBAAR,CAAyB,QAAzB,EAAmCqG,KAAK,IAAI;MAC1C,MAAM;QACJhhB,IADI;QAEJw2E;MAFI,IAGFx1D,KAAK,CAAC2E,MAHV;;MAIA,KAAK,MAAM0gE,KAAX,IAAoB,KAAKlH,kBAAL,CAAwBn/E,IAAxB,EAA8B2N,EAA9B,CAApB,EAAuD;QACrD62B,OAAO,CAACjZ,QAAR,CAAiB86D,KAAK,CAAC14E,EAAvB,EAA2B;UACzBlO,KAAK,EAAE;QADkB,CAA3B;MAGD;;MACD+kC,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;QACnBlO,KAAK,EAAE+2E;MADY,CAArB;IAGD,CAbD;IAcAl7D,OAAO,CAACX,gBAAR,CAAyB,WAAzB,EAAsCqG,KAAK,IAAI;MAC7C,MAAM6jB,YAAY,GAAG/wB,IAAI,CAACkxE,iBAA1B;MACAhkE,KAAK,CAAC2E,MAAN,CAAa6wD,OAAb,GAAuB3xC,YAAY,KAAK,IAAjB,IAAyBA,YAAY,KAAKnkC,SAA1C,IAAuDmkC,YAAY,KAAK/wB,IAAI,CAACsyE,WAApG;IACD,CAHD;;IAIA,IAAI,KAAK1L,eAAL,IAAwB,KAAKjQ,YAAjC,EAA+C;MAC7C,MAAM6b,cAAc,GAAGxyE,IAAI,CAACsyE,WAA5B;MACA9qE,OAAO,CAACX,gBAAR,CAAyB,mBAAzB,EAA8CkjE,OAAO,IAAI;QACvD,MAAMD,OAAO,GAAG;UACdn+E,KAAK,EAAEuhB,KAAK,IAAI;YACd,MAAMw1D,OAAO,GAAG8P,cAAc,KAAKtlE,KAAK,CAACg8D,MAAN,CAAav9E,KAAhD;;YACA,KAAK,MAAM4mF,KAAX,IAAoB,KAAKlH,kBAAL,CAAwBn+D,KAAK,CAAC2E,MAAN,CAAa3lB,IAArC,CAApB,EAAgE;cAC9D,MAAMmmF,UAAU,GAAG3P,OAAO,IAAI6P,KAAK,CAAC14E,EAAN,KAAaA,EAA3C;;cACA,IAAI04E,KAAK,CAAC5G,UAAV,EAAsB;gBACpB4G,KAAK,CAAC5G,UAAN,CAAiBjJ,OAAjB,GAA2B2P,UAA3B;cACD;;cACD3hD,OAAO,CAACjZ,QAAR,CAAiB86D,KAAK,CAAC14E,EAAvB,EAA2B;gBACzBlO,KAAK,EAAE0mF;cADkB,CAA3B;YAGD;UACF;QAZa,CAAhB;;QAcA,KAAKxI,yBAAL,CAA+BC,OAA/B,EAAwCC,OAAxC;MACD,CAhBD;;MAiBA,KAAKkF,kBAAL,CAAwBznE,OAAxB,EAAiC,IAAjC,EAAuC,CAAC,CAAC,QAAD,EAAW,UAAX,CAAD,EAAyB,CAAC,QAAD,EAAW,QAAX,CAAzB,EAA+C,CAAC,OAAD,EAAU,OAAV,CAA/C,EAAmE,CAAC,MAAD,EAAS,MAAT,CAAnE,EAAqF,CAAC,WAAD,EAAc,YAAd,CAArF,EAAkH,CAAC,YAAD,EAAe,aAAf,CAAlH,EAAiJ,CAAC,YAAD,EAAe,YAAf,CAAjJ,EAA+K,CAAC,SAAD,EAAY,UAAZ,CAA/K,CAAvC,EAAgP0F,KAAK,IAAIA,KAAK,CAAC2E,MAAN,CAAa6wD,OAAtQ;IACD;;IACD,KAAK2M,mBAAL,CAAyB7nE,OAAzB;;IACA,KAAKyiE,2BAAL,CAAiCziE,OAAjC;;IACA,KAAKwJ,SAAL,CAAerW,MAAf,CAAsB6M,OAAtB;IACA,OAAO,KAAKwJ,SAAZ;EACD;;AAjFsE;;AAmFzE,MAAM8zD,iCAAN,SAAgDR,qBAAhD,CAAsE;EACpEn4E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChB0hD,YAAY,EAAE1hD,UAAU,CAAC5kB,IAAX,CAAgBiwE;IADd,CAAlB;EAGD;;EACD1pE,MAAM,GAAG;IACP,MAAMyK,SAAS,GAAG,MAAMzK,MAAN,EAAlB;IACAyK,SAAS,CAACrJ,SAAV,CAAoBC,GAApB,CAAwB,wBAAxB,EAAkD,YAAlD;IACA,MAAM6qE,WAAW,GAAGzhE,SAAS,CAACid,SAA9B;;IACA,IAAI,KAAK24C,eAAL,IAAwB,KAAKjQ,YAA7B,IAA6C8b,WAAjD,EAA8D;MAC5D,KAAKxI,2BAAL,CAAiCwI,WAAjC;;MACAA,WAAW,CAAC5rE,gBAAZ,CAA6B,mBAA7B,EAAkDkjE,OAAO,IAAI;QAC3D,KAAKF,yBAAL,CAA+B,EAA/B,EAAmCE,OAAnC;MACD,CAFD;IAGD;;IACD,OAAO/4D,SAAP;EACD;;AAjBmE;;AAmBtE,MAAM+zD,6BAAN,SAA4CE,uBAA5C,CAAoE;EAClE94E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAEzhD,UAAU,CAAC8hD;IADT,CAAlB;EAGD;;EACDngE,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,wBAA7B;IACA,MAAM8oB,OAAO,GAAG,KAAK/hB,iBAArB;IACA,MAAM9U,EAAE,GAAG,KAAKmG,IAAL,CAAUnG,EAArB;IACA,MAAMyoE,UAAU,GAAG5xC,OAAO,CAACI,QAAR,CAAiBj3B,EAAjB,EAAqB;MACtClO,KAAK,EAAE,KAAKqU,IAAL,CAAUkwE;IADqB,CAArB,CAAnB;IAGA,MAAMwC,aAAa,GAAG/4E,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAtB;IACA+qE,oBAAoB,CAACt8D,GAArB,CAAyB8qE,aAAzB;IACAA,aAAa,CAACx5E,YAAd,CAA2B,iBAA3B,EAA8CW,EAA9C;IACA64E,aAAa,CAAClwD,QAAd,GAAyB,KAAKxiB,IAAL,CAAUgxE,QAAnC;;IACA,KAAKrH,YAAL,CAAkB+I,aAAlB,EAAiC,KAAK1yE,IAAL,CAAU0pE,QAA3C;;IACAgJ,aAAa,CAACxmF,IAAd,GAAqB,KAAK8T,IAAL,CAAUkuE,SAA/B;IACAwE,aAAa,CAACxqE,QAAd,GAAyB87D,iBAAzB;IACA,IAAI2O,eAAe,GAAG,KAAK3yE,IAAL,CAAU4yE,KAAV,IAAmB,KAAK5yE,IAAL,CAAU/U,OAAV,CAAkBK,MAAlB,GAA2B,CAApE;;IACA,IAAI,CAAC,KAAK0U,IAAL,CAAU4yE,KAAf,EAAsB;MACpBF,aAAa,CAACh1E,IAAd,GAAqB,KAAKsC,IAAL,CAAU/U,OAAV,CAAkBK,MAAvC;;MACA,IAAI,KAAK0U,IAAL,CAAU6yE,WAAd,EAA2B;QACzBH,aAAa,CAACI,QAAd,GAAyB,IAAzB;MACD;IACF;;IACDJ,aAAa,CAAC7rE,gBAAd,CAA+B,WAA/B,EAA4CqG,KAAK,IAAI;MACnD,MAAM6jB,YAAY,GAAG,KAAK/wB,IAAL,CAAUkxE,iBAA/B;;MACA,KAAK,MAAMvO,MAAX,IAAqB+P,aAAa,CAACznF,OAAnC,EAA4C;QAC1C03E,MAAM,CAACC,QAAP,GAAkBD,MAAM,CAACh3E,KAAP,KAAiBolC,YAAnC;MACD;IACF,CALD;;IAMA,KAAK,MAAM4xC,MAAX,IAAqB,KAAK3iE,IAAL,CAAU/U,OAA/B,EAAwC;MACtC,MAAM8nF,aAAa,GAAGp5E,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAtB;MACA45E,aAAa,CAACtxD,WAAd,GAA4BkhD,MAAM,CAACqQ,YAAnC;MACAD,aAAa,CAACpnF,KAAd,GAAsBg3E,MAAM,CAAC+I,WAA7B;;MACA,IAAIpJ,UAAU,CAAC32E,KAAX,CAAiBqD,QAAjB,CAA0B2zE,MAAM,CAAC+I,WAAjC,CAAJ,EAAmD;QACjDqH,aAAa,CAAC75E,YAAd,CAA2B,UAA3B,EAAuC,IAAvC;QACAy5E,eAAe,GAAG,KAAlB;MACD;;MACDD,aAAa,CAAC/3E,MAAd,CAAqBo4E,aAArB;IACD;;IACD,IAAIE,gBAAgB,GAAG,IAAvB;;IACA,IAAIN,eAAJ,EAAqB;MACnB,MAAMO,iBAAiB,GAAGv5E,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAA1B;MACA+5E,iBAAiB,CAACvnF,KAAlB,GAA0B,GAA1B;MACAunF,iBAAiB,CAACh6E,YAAlB,CAA+B,QAA/B,EAAyC,IAAzC;MACAg6E,iBAAiB,CAACh6E,YAAlB,CAA+B,UAA/B,EAA2C,IAA3C;MACAw5E,aAAa,CAACpqE,OAAd,CAAsB4qE,iBAAtB;;MACAD,gBAAgB,GAAG,MAAM;QACvBC,iBAAiB,CAACn3E,MAAlB;QACA22E,aAAa,CAACj1B,mBAAd,CAAkC,OAAlC,EAA2Cw1B,gBAA3C;QACAA,gBAAgB,GAAG,IAAnB;MACD,CAJD;;MAKAP,aAAa,CAAC7rE,gBAAd,CAA+B,OAA/B,EAAwCosE,gBAAxC;IACD;;IACD,MAAMniD,QAAQ,GAAGqiD,QAAQ,IAAI;MAC3B,MAAMjnF,IAAI,GAAGinF,QAAQ,GAAG,OAAH,GAAa,aAAlC;MACA,MAAM;QACJloF,OADI;QAEJ6nF;MAFI,IAGFJ,aAHJ;;MAIA,IAAI,CAACI,QAAL,EAAe;QACb,OAAO7nF,OAAO,CAAC43E,aAAR,KAA0B,CAAC,CAA3B,GAA+B,IAA/B,GAAsC53E,OAAO,CAACA,OAAO,CAAC43E,aAAT,CAAP,CAA+B32E,IAA/B,CAA7C;MACD;;MACD,OAAOmD,KAAK,CAAC9X,SAAN,CAAgBqkB,MAAhB,CAAuBnkB,IAAvB,CAA4BwT,OAA5B,EAAqC03E,MAAM,IAAIA,MAAM,CAACC,QAAtD,EAAgE10E,GAAhE,CAAoEy0E,MAAM,IAAIA,MAAM,CAACz2E,IAAD,CAApF,CAAP;IACD,CAVD;;IAWA,IAAIknF,cAAc,GAAGtiD,QAAQ,CAAC,KAAD,CAA7B;;IACA,MAAMuiD,QAAQ,GAAGnmE,KAAK,IAAI;MACxB,MAAMjiB,OAAO,GAAGiiB,KAAK,CAAC2E,MAAN,CAAa5mB,OAA7B;MACA,OAAOoE,KAAK,CAAC9X,SAAN,CAAgB2W,GAAhB,CAAoBzW,IAApB,CAAyBwT,OAAzB,EAAkC03E,MAAM,KAAK;QAClDqQ,YAAY,EAAErQ,MAAM,CAAClhD,WAD6B;QAElDiqD,WAAW,EAAE/I,MAAM,CAACh3E;MAF8B,CAAL,CAAxC,CAAP;IAID,CAND;;IAOA,IAAI,KAAKi7E,eAAL,IAAwB,KAAKjQ,YAAjC,EAA+C;MAC7C+b,aAAa,CAAC7rE,gBAAd,CAA+B,mBAA/B,EAAoDkjE,OAAO,IAAI;QAC7D,MAAMD,OAAO,GAAG;UACdn+E,KAAK,CAACuhB,KAAD,EAAQ;YACX+lE,gBAAgB;YAChB,MAAMtnF,KAAK,GAAGuhB,KAAK,CAACg8D,MAAN,CAAav9E,KAA3B;YACA,MAAMgoB,MAAM,GAAG,IAAI9G,GAAJ,CAAQxd,KAAK,CAACyqB,OAAN,CAAcnuB,KAAd,IAAuBA,KAAvB,GAA+B,CAACA,KAAD,CAAvC,CAAf;;YACA,KAAK,MAAMg3E,MAAX,IAAqB+P,aAAa,CAACznF,OAAnC,EAA4C;cAC1C03E,MAAM,CAACC,QAAP,GAAkBjvD,MAAM,CAACnG,GAAP,CAAWm1D,MAAM,CAACh3E,KAAlB,CAAlB;YACD;;YACD+kC,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;cACnBlO,KAAK,EAAEmlC,QAAQ,CAAC,IAAD;YADI,CAArB;YAGAsiD,cAAc,GAAGtiD,QAAQ,CAAC,KAAD,CAAzB;UACD,CAZa;;UAadwiD,iBAAiB,CAACpmE,KAAD,EAAQ;YACvBwlE,aAAa,CAACI,QAAd,GAAyB,IAAzB;UACD,CAfa;;UAgBd/2E,MAAM,CAACmR,KAAD,EAAQ;YACZ,MAAMjiB,OAAO,GAAGynF,aAAa,CAACznF,OAA9B;YACA,MAAMsoF,KAAK,GAAGrmE,KAAK,CAACg8D,MAAN,CAAantE,MAA3B;YACA9Q,OAAO,CAACsoF,KAAD,CAAP,CAAe3Q,QAAf,GAA0B,KAA1B;YACA8P,aAAa,CAAC32E,MAAd,CAAqBw3E,KAArB;;YACA,IAAItoF,OAAO,CAACK,MAAR,GAAiB,CAArB,EAAwB;cACtB,MAAM4B,CAAC,GAAGmC,KAAK,CAAC9X,SAAN,CAAgBi8F,SAAhB,CAA0B/7F,IAA1B,CAA+BwT,OAA/B,EAAwC03E,MAAM,IAAIA,MAAM,CAACC,QAAzD,CAAV;;cACA,IAAI11E,CAAC,KAAK,CAAC,CAAX,EAAc;gBACZjC,OAAO,CAAC,CAAD,CAAP,CAAW23E,QAAX,GAAsB,IAAtB;cACD;YACF;;YACDlyC,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;cACnBlO,KAAK,EAAEmlC,QAAQ,CAAC,IAAD,CADI;cAEnB5X,KAAK,EAAEm6D,QAAQ,CAACnmE,KAAD;YAFI,CAArB;YAIAkmE,cAAc,GAAGtiD,QAAQ,CAAC,KAAD,CAAzB;UACD,CAhCa;;UAiCdlzB,KAAK,CAACsP,KAAD,EAAQ;YACX,OAAOwlE,aAAa,CAACpnF,MAAd,KAAyB,CAAhC,EAAmC;cACjConF,aAAa,CAAC32E,MAAd,CAAqB,CAArB;YACD;;YACD20B,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;cACnBlO,KAAK,EAAE,IADY;cAEnButB,KAAK,EAAE;YAFY,CAArB;YAIAk6D,cAAc,GAAGtiD,QAAQ,CAAC,KAAD,CAAzB;UACD,CA1Ca;;UA2CdwE,MAAM,CAACpoB,KAAD,EAAQ;YACZ,MAAM;cACJqmE,KADI;cAEJP,YAFI;cAGJtH;YAHI,IAIFx+D,KAAK,CAACg8D,MAAN,CAAa5zC,MAJjB;YAKA,MAAMm+C,WAAW,GAAGf,aAAa,CAACnlD,QAAd,CAAuBgmD,KAAvB,CAApB;YACA,MAAMR,aAAa,GAAGp5E,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAtB;YACA45E,aAAa,CAACtxD,WAAd,GAA4BuxD,YAA5B;YACAD,aAAa,CAACpnF,KAAd,GAAsB+/E,WAAtB;;YACA,IAAI+H,WAAJ,EAAiB;cACfA,WAAW,CAACzlD,MAAZ,CAAmB+kD,aAAnB;YACD,CAFD,MAEO;cACLL,aAAa,CAAC/3E,MAAd,CAAqBo4E,aAArB;YACD;;YACDriD,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;cACnBlO,KAAK,EAAEmlC,QAAQ,CAAC,IAAD,CADI;cAEnB5X,KAAK,EAAEm6D,QAAQ,CAACnmE,KAAD;YAFI,CAArB;YAIAkmE,cAAc,GAAGtiD,QAAQ,CAAC,KAAD,CAAzB;UACD,CA/Da;;UAgEd5X,KAAK,CAAChM,KAAD,EAAQ;YACX,MAAM;cACJgM;YADI,IAEFhM,KAAK,CAACg8D,MAFV;;YAGA,OAAOwJ,aAAa,CAACpnF,MAAd,KAAyB,CAAhC,EAAmC;cACjConF,aAAa,CAAC32E,MAAd,CAAqB,CAArB;YACD;;YACD,KAAK,MAAMsd,IAAX,IAAmBH,KAAnB,EAA0B;cACxB,MAAM;gBACJ85D,YADI;gBAEJtH;cAFI,IAGFryD,IAHJ;cAIA,MAAM05D,aAAa,GAAGp5E,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAtB;cACA45E,aAAa,CAACtxD,WAAd,GAA4BuxD,YAA5B;cACAD,aAAa,CAACpnF,KAAd,GAAsB+/E,WAAtB;cACAgH,aAAa,CAAC/3E,MAAd,CAAqBo4E,aAArB;YACD;;YACD,IAAIL,aAAa,CAACznF,OAAd,CAAsBK,MAAtB,GAA+B,CAAnC,EAAsC;cACpConF,aAAa,CAACznF,OAAd,CAAsB,CAAtB,EAAyB23E,QAAzB,GAAoC,IAApC;YACD;;YACDlyC,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;cACnBlO,KAAK,EAAEmlC,QAAQ,CAAC,IAAD,CADI;cAEnB5X,KAAK,EAAEm6D,QAAQ,CAACnmE,KAAD;YAFI,CAArB;YAIAkmE,cAAc,GAAGtiD,QAAQ,CAAC,KAAD,CAAzB;UACD,CAzFa;;UA0Fd4iD,OAAO,CAACxmE,KAAD,EAAQ;YACb,MAAMwmE,OAAO,GAAG,IAAI7mE,GAAJ,CAAQK,KAAK,CAACg8D,MAAN,CAAawK,OAArB,CAAhB;;YACA,KAAK,MAAM/Q,MAAX,IAAqBz1D,KAAK,CAAC2E,MAAN,CAAa5mB,OAAlC,EAA2C;cACzC03E,MAAM,CAACC,QAAP,GAAkB8Q,OAAO,CAAClmE,GAAR,CAAYm1D,MAAM,CAAC4Q,KAAnB,CAAlB;YACD;;YACD7iD,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;cACnBlO,KAAK,EAAEmlC,QAAQ,CAAC,IAAD;YADI,CAArB;YAGAsiD,cAAc,GAAGtiD,QAAQ,CAAC,KAAD,CAAzB;UACD,CAnGa;;UAoGd6iD,QAAQ,CAACzmE,KAAD,EAAQ;YACdA,KAAK,CAAC2E,MAAN,CAAa2Q,QAAb,GAAwB,CAACtV,KAAK,CAACg8D,MAAN,CAAayK,QAAtC;UACD;;QAtGa,CAAhB;;QAwGA,KAAK9J,yBAAL,CAA+BC,OAA/B,EAAwCC,OAAxC;MACD,CA1GD;MA2GA2I,aAAa,CAAC7rE,gBAAd,CAA+B,OAA/B,EAAwCqG,KAAK,IAAI;QAC/C,MAAMw+D,WAAW,GAAG56C,QAAQ,CAAC,IAAD,CAA5B;QACA,MAAMihD,MAAM,GAAGjhD,QAAQ,CAAC,KAAD,CAAvB;QACAJ,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;UACnBlO,KAAK,EAAE+/E;QADY,CAArB;QAGAx+D,KAAK,CAAC9J,cAAN;QACA,KAAK2/D,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,wBAApC,EAA8D;UAC5DC,MAAM,EAAE,IADoD;UAE5Dk0D,MAAM,EAAE;YACNrvE,EADM;YAEN3N,IAAI,EAAE,WAFA;YAGNP,KAAK,EAAEynF,cAHD;YAINrB,MAJM;YAKN6B,QAAQ,EAAElI,WALJ;YAMN6F,UAAU,EAAE,KANN;YAONX,SAAS,EAAE,CAPL;YAQNiD,OAAO,EAAE;UARH;QAFoD,CAA9D;MAaD,CApBD;;MAqBA,KAAK5E,kBAAL,CAAwByD,aAAxB,EAAuC,IAAvC,EAA6C,CAAC,CAAC,OAAD,EAAU,OAAV,CAAD,EAAqB,CAAC,MAAD,EAAS,MAAT,CAArB,EAAuC,CAAC,WAAD,EAAc,YAAd,CAAvC,EAAoE,CAAC,YAAD,EAAe,aAAf,CAApE,EAAmG,CAAC,YAAD,EAAe,YAAf,CAAnG,EAAiI,CAAC,SAAD,EAAY,UAAZ,CAAjI,EAA0J,CAAC,OAAD,EAAU,QAAV,CAA1J,EAA+K,CAAC,OAAD,EAAU,UAAV,CAA/K,CAA7C,EAAoPxlE,KAAK,IAAIA,KAAK,CAAC2E,MAAN,CAAalmB,KAA1Q;IACD,CAlID,MAkIO;MACL+mF,aAAa,CAAC7rE,gBAAd,CAA+B,OAA/B,EAAwC,UAAUqG,KAAV,EAAiB;QACvDwjB,OAAO,CAACjZ,QAAR,CAAiB5d,EAAjB,EAAqB;UACnBlO,KAAK,EAAEmlC,QAAQ,CAAC,IAAD;QADI,CAArB;MAGD,CAJD;IAKD;;IACD,IAAI,KAAK9wB,IAAL,CAAU4yE,KAAd,EAAqB;MACnB,KAAKtD,aAAL,CAAmBoD,aAAnB;IACD,CAFD,MAEO,CAAE;;IACT,KAAKrD,mBAAL,CAAyBqD,aAAzB;;IACA,KAAKzI,2BAAL,CAAiCyI,aAAjC;;IACA,KAAK1hE,SAAL,CAAerW,MAAf,CAAsB+3E,aAAtB;IACA,OAAO,KAAK1hE,SAAZ;EACD;;AA5NiE;;AA8NpE,MAAMk0D,sBAAN,SAAqCe,iBAArC,CAAuD;EACrD95E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAM;MACJ5kB,IADI;MAEJorE;IAFI,IAGFxmD,UAHJ;IAIA,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAEJ,iBAAiB,CAACgB,aAAlB,CAAgCjnE,IAAhC;IADE,CAAlB;IAGA,KAAKorE,QAAL,GAAgBA,QAAhB;IACA,KAAK1D,KAAL,GAAa,IAAb;EACD;;EACDnhE,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,iBAA7B;IACA,MAAM8/D,KAAK,GAAG,KAAKA,KAAL,GAAa,IAAIoM,YAAJ,CAAiB;MAC1C9iE,SAAS,EAAE,KAAKA,SAD0B;MAE1C7U,KAAK,EAAE,KAAK6D,IAAL,CAAU7D,KAFyB;MAG1C+qE,QAAQ,EAAE,KAAKlnE,IAAL,CAAUknE,QAHsB;MAI1CgE,gBAAgB,EAAE,KAAKlrE,IAAL,CAAUkrE,gBAJc;MAK1C/D,WAAW,EAAE,KAAKnnE,IAAL,CAAUmnE,WALmB;MAM1CC,QAAQ,EAAE,KAAKpnE,IAAL,CAAUonE,QANsB;MAO1Cz1E,IAAI,EAAE,KAAKqO,IAAL,CAAUrO,IAP0B;MAQ1Cw5E,UAAU,EAAE,KAAKnrE,IAAL,CAAUmrE,UAAV,IAAwB,IARM;MAS1CjiE,MAAM,EAAE,KAAKA,MAT6B;MAU1CkiE,QAAQ,EAAE,KAAKA,QAV2B;MAW1C7rE,IAAI,EAAE,KAAKS,IAAL,CAAUT;IAX0B,CAAjB,CAA3B;IAaA,MAAMw0E,UAAU,GAAG,EAAnB;;IACA,KAAK,MAAMvsE,OAAX,IAAsB,KAAK4jE,QAA3B,EAAqC;MACnC5jE,OAAO,CAACkgE,KAAR,GAAgBA,KAAhB;MACAqM,UAAU,CAACvmF,IAAX,CAAgBga,OAAO,CAACxH,IAAR,CAAanG,EAA7B;MACA2N,OAAO,CAACwkE,gBAAR;IACD;;IACD,KAAKh7D,SAAL,CAAe9X,YAAf,CAA4B,eAA5B,EAA6C66E,UAAU,CAAC7lF,GAAX,CAAe2L,EAAE,IAAK,GAAE3D,gBAAiB,GAAE2D,EAAG,EAA9C,EAAiDpM,IAAjD,CAAsD,GAAtD,CAA7C;IACA,OAAO,KAAKujB,SAAZ;EACD;;AAnCoD;;AAqCvD,MAAM8iE,YAAN,CAAmB;EACjB,CAACE,YAAD,GAAgB,KAAK,CAACH,OAAN,CAAcj3E,IAAd,CAAmB,IAAnB,CAAhB;EACA,CAACq3E,SAAD,GAAa,KAAK,CAACvsE,IAAN,CAAW9K,IAAX,CAAgB,IAAhB,CAAb;EACA,CAACs3E,SAAD,GAAa,KAAK,CAACpsE,IAAN,CAAWlL,IAAX,CAAgB,IAAhB,CAAb;EACA,CAACu3E,WAAD,GAAe,KAAK,CAACz+D,MAAN,CAAa9Y,IAAb,CAAkB,IAAlB,CAAf;EACA,CAACT,KAAD,GAAS,IAAT;EACA,CAAC6U,SAAD,GAAa,IAAb;EACA,CAACm2D,WAAD,GAAe,IAAf;EACA,CAACiN,OAAD,GAAW,IAAX;EACA,CAAChJ,QAAD,GAAY,IAAZ;EACA,CAACliE,MAAD,GAAU,IAAV;EACA,CAACiiE,UAAD,GAAc,IAAd;EACA,CAACkJ,MAAD,GAAU,KAAV;EACA,CAAC3M,KAAD,GAAS,IAAT;EACA,CAACptE,QAAD,GAAY,IAAZ;EACA,CAAC3I,IAAD,GAAQ,IAAR;EACA,CAACy1E,QAAD,GAAY,IAAZ;EACA,CAACF,QAAD,GAAY,IAAZ;EACA,CAAChB,OAAD,GAAW,IAAX;EACA,CAACoO,UAAD,GAAc,KAAd;;EACAnoF,WAAW,CAAC;IACV6kB,SADU;IAEV7U,KAFU;IAGVivE,QAHU;IAIVlE,QAJU;IAKVgE,gBALU;IAMV/D,WANU;IAOVC,QAPU;IAQVl+D,MARU;IASVvX,IATU;IAUVw5E,UAVU;IAWV5rE;EAXU,CAAD,EAYR;IACD,KAAK,CAACyR,SAAN,GAAkBA,SAAlB;IACA,KAAK,CAACk2D,QAAN,GAAiBA,QAAjB;IACA,KAAK,CAACC,WAAN,GAAoBA,WAApB;IACA,KAAK,CAACC,QAAN,GAAiBA,QAAjB;IACA,KAAK,CAACl+D,MAAN,GAAeA,MAAf;IACA,KAAK,CAAC/M,KAAN,GAAcA,KAAd;IACA,KAAK,CAACxK,IAAN,GAAaA,IAAb;IACA,KAAK,CAACw5E,UAAN,GAAmBA,UAAnB;IACA,KAAK,CAACC,QAAN,GAAiBA,QAAjB;IACA,KAAK,CAACgJ,OAAN,GAAgBn7F,aAAa,CAACsqB,YAAd,CAA2B2nE,gBAA3B,CAAhB;IACA,KAAKqJ,OAAL,GAAenJ,QAAQ,CAACoJ,OAAT,CAAiBrxE,CAAC,IAAIA,CAAC,CAAC4oE,yBAAF,EAAtB,CAAf;;IACA,KAAK,MAAMvkE,OAAX,IAAsB,KAAK+sE,OAA3B,EAAoC;MAClC/sE,OAAO,CAACX,gBAAR,CAAyB,OAAzB,EAAkC,KAAK,CAACstE,WAAxC;MACA3sE,OAAO,CAACX,gBAAR,CAAyB,YAAzB,EAAuC,KAAK,CAACqtE,SAA7C;MACA1sE,OAAO,CAACX,gBAAR,CAAyB,YAAzB,EAAuC,KAAK,CAACotE,SAA7C;MACAzsE,OAAO,CAACG,SAAR,CAAkBC,GAAlB,CAAsB,kBAAtB;IACD;;IACD,KAAK,MAAMJ,OAAX,IAAsB4jE,QAAtB,EAAgC;MAC9B5jE,OAAO,CAACwJ,SAAR,EAAmBnK,gBAAnB,CAAoC,SAApC,EAA+C,KAAK,CAACmtE,YAArD;IACD;;IACD,KAAK,CAAChjE,SAAN,CAAgB+yD,MAAhB,GAAyB,IAAzB;;IACA,IAAIxkE,IAAJ,EAAU;MACR,KAAK,CAACmW,MAAN;IACD;EACF;;EACDnP,MAAM,GAAG;IACP,IAAI,KAAK,CAACmhE,KAAV,EAAiB;MACf;IACD;;IACD,MAAMA,KAAK,GAAG,KAAK,CAACA,KAAN,GAAc/tE,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAA5B;IACAuuE,KAAK,CAACjhE,SAAN,GAAkB,OAAlB;;IACA,IAAI,KAAK,CAACtK,KAAV,EAAiB;MACf,MAAMs4E,SAAS,GAAG/M,KAAK,CAACvtE,KAAN,CAAYu6E,YAAZ,GAA2Bj7F,IAAI,CAACiW,YAAL,CAAkB,GAAG,KAAK,CAACyM,KAA3B,CAA7C;;MACA,IAAIjN,GAAG,CAACC,QAAJ,CAAa,kBAAb,EAAiC,oCAAjC,CAAJ,EAA4E;QAC1Eu4E,KAAK,CAACvtE,KAAN,CAAY0jC,eAAZ,GAA+B,sBAAqB42C,SAAU,cAA9D;MACD,CAFD,MAEO;QACL,MAAME,kBAAkB,GAAG,GAA3B;QACAjN,KAAK,CAACvtE,KAAN,CAAY0jC,eAAZ,GAA8BpkD,IAAI,CAACiW,YAAL,CAAkB,GAAG,KAAK,CAACyM,KAAN,CAAYjO,GAAZ,CAAgBkD,CAAC,IAAIhE,IAAI,CAAC4I,KAAL,CAAW2+E,kBAAkB,IAAI,MAAMvjF,CAAV,CAAlB,GAAiCA,CAA5C,CAArB,CAArB,CAA9B;MACD;IACF;;IACD,MAAMwjF,MAAM,GAAGj7E,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAAf;IACAy7E,MAAM,CAACnuE,SAAP,GAAmB,QAAnB;IACA,MAAMuhE,KAAK,GAAGruE,QAAQ,CAACR,aAAT,CAAuB,IAAvB,CAAd;IACAy7E,MAAM,CAACj6E,MAAP,CAAcqtE,KAAd;IACA,CAAC;MACC1Z,GAAG,EAAE0Z,KAAK,CAAC1Z,GADZ;MAEC3gE,GAAG,EAAEq6E,KAAK,CAACvmD;IAFZ,IAGG,KAAK,CAACylD,QAHV;IAIAQ,KAAK,CAAC/sE,MAAN,CAAai6E,MAAb;;IACA,IAAI,KAAK,CAACR,OAAV,EAAmB;MACjB,MAAMlJ,gBAAgB,GAAGvxE,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAAzB;MACA+xE,gBAAgB,CAACvjE,SAAjB,CAA2BC,GAA3B,CAA+B,WAA/B;MACAsjE,gBAAgB,CAAChyE,YAAjB,CAA8B,cAA9B,EAA8C,mCAA9C;MACAgyE,gBAAgB,CAAChyE,YAAjB,CAA8B,gBAA9B,EAAgDwgB,IAAI,CAACC,SAAL,CAAe;QAC7Dy6D,OAAO,EAAE,KAAK,CAACA,OAAN,CAAcS,OAAd;MADoD,CAAf,CAAhD;MAGAD,MAAM,CAACj6E,MAAP,CAAcuwE,gBAAd;IACD;;IACD,MAAM7I,IAAI,GAAG,KAAK,CAACA,IAAnB;;IACA,IAAIA,IAAJ,EAAU;MACR1oF,QAAQ,CAAC4sB,MAAT,CAAgB;QACd+8D,OAAO,EAAEjB,IADK;QAEd7xB,MAAM,EAAE,UAFM;QAGdt2C,GAAG,EAAEwtE;MAHS,CAAhB;MAKAA,KAAK,CAACz5C,SAAN,CAAgBtmB,SAAhB,CAA0BC,GAA1B,CAA8B,UAA9B,EAA0C,cAA1C;IACD,CAPD,MAOO;MACL,MAAMktE,QAAQ,GAAG,KAAKC,eAAL,CAAqB,KAAK,CAAC5N,WAA3B,CAAjB;;MACAO,KAAK,CAAC/sE,MAAN,CAAam6E,QAAb;IACD;;IACD,KAAK,CAAC9jE,SAAN,CAAgBrW,MAAhB,CAAuB+sE,KAAvB;EACD;;EACQ,IAAL,CAACrF,IAAI,GAAG;IACV,MAAM+E,QAAQ,GAAG,KAAK,CAACA,QAAvB;IACA,MAAMD,WAAW,GAAG,KAAK,CAACA,WAA1B;;IACA,IAAIC,QAAQ,EAAEz5E,GAAV,KAAkB,CAACw5E,WAAW,EAAEx5E,GAAd,IAAqBw5E,WAAW,CAACx5E,GAAZ,KAAoBy5E,QAAQ,CAACz5E,GAApE,CAAJ,EAA8E;MAC5E,OAAO,KAAK,CAACy5E,QAAN,CAAe/E,IAAf,IAAuB,IAA9B;IACD;;IACD,OAAO,IAAP;EACD;;EACY,IAAT,CAACn7B,QAAQ,GAAG;IACd,OAAO,KAAK,CAACm7B,IAAN,EAAY/9D,UAAZ,EAAwBnK,KAAxB,EAA+B+sC,QAA/B,IAA2C,CAAlD;EACD;;EACa,IAAV,CAACsoC,SAAS,GAAG;IACf,OAAO,KAAK,CAACnN,IAAN,EAAY/9D,UAAZ,EAAwBnK,KAAxB,EAA+BgC,KAA/B,IAAwC,IAA/C;EACD;;EACD,CAAC64E,gBAAgB,CAAC/1E,IAAD,EAAO;IACtB,MAAMg2E,UAAU,GAAG,EAAnB;IACA,MAAMC,YAAY,GAAG;MACnBvnF,GAAG,EAAEsR,IADc;MAEnBojE,IAAI,EAAE;QACJn2E,IAAI,EAAE,KADF;QAEJoY,UAAU,EAAE;UACVgqD,GAAG,EAAE;QADK,CAFR;QAKJ/gC,QAAQ,EAAE,CAAC;UACTrhC,IAAI,EAAE,GADG;UAETqhC,QAAQ,EAAE0nD;QAFD,CAAD;MALN;IAFa,CAArB;IAaA,MAAME,cAAc,GAAG;MACrBh7E,KAAK,EAAE;QACLgC,KAAK,EAAE,KAAK,CAACqzE,SADR;QAELtoC,QAAQ,EAAE,KAAK,CAACA,QAAN,GAAkB,QAAO,KAAK,CAACA,QAAS,2BAAxC,GAAqE;MAF1E;IADc,CAAvB;;IAMA,KAAK,MAAMkuC,IAAX,IAAmBn2E,IAAI,CAAC1D,KAAL,CAAW,IAAX,CAAnB,EAAqC;MACnC05E,UAAU,CAACznF,IAAX,CAAgB;QACdtB,IAAI,EAAE,MADQ;QAEdP,KAAK,EAAEypF,IAFO;QAGd9wE,UAAU,EAAE6wE;MAHE,CAAhB;IAKD;;IACD,OAAOD,YAAP;EACD;;EACDH,eAAe,CAAC;IACdpnF,GADc;IAEd2gE;EAFc,CAAD,EAGZ;IACD,MAAMl+D,CAAC,GAAGuJ,QAAQ,CAACR,aAAT,CAAuB,GAAvB,CAAV;IACA/I,CAAC,CAACuX,SAAF,CAAYC,GAAZ,CAAgB,cAAhB;IACAxX,CAAC,CAACk+D,GAAF,GAAQA,GAAR;IACA,MAAM+mB,KAAK,GAAG1nF,GAAG,CAAC4N,KAAJ,CAAU,cAAV,CAAd;;IACA,KAAK,IAAIrO,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGmhF,KAAK,CAAC/pF,MAA3B,EAAmC4B,CAAC,GAAGgH,EAAvC,EAA2C,EAAEhH,CAA7C,EAAgD;MAC9C,MAAMkoF,IAAI,GAAGC,KAAK,CAACnoF,CAAD,CAAlB;MACAkD,CAAC,CAACuK,MAAF,CAAShB,QAAQ,CAAC+pE,cAAT,CAAwB0R,IAAxB,CAAT;;MACA,IAAIloF,CAAC,GAAGgH,EAAE,GAAG,CAAb,EAAgB;QACd9D,CAAC,CAACuK,MAAF,CAAShB,QAAQ,CAACR,aAAT,CAAuB,IAAvB,CAAT;MACD;IACF;;IACD,OAAO/I,CAAP;EACD;;EACD,CAACyjF,OAAO,CAAC3mE,KAAD,EAAQ;IACd,IAAIA,KAAK,CAACC,MAAN,IAAgBD,KAAK,CAACI,QAAtB,IAAkCJ,KAAK,CAACE,OAAxC,IAAmDF,KAAK,CAACG,OAA7D,EAAsE;MACpE;IACD;;IACD,IAAIH,KAAK,CAACn2B,GAAN,KAAc,OAAd,IAAyBm2B,KAAK,CAACn2B,GAAN,KAAc,QAAd,IAA0B,KAAK,CAACs9F,MAA7D,EAAqE;MACnE,KAAK,CAAC3+D,MAAN;IACD;EACF;;EACD8xD,YAAY,CAAC;IACX71E,IADW;IAEXujF;EAFW,CAAD,EAGT;IACD,KAAK,CAAChP,OAAN,KAAkB;MAChBiB,WAAW,EAAE,KAAK,CAACA,WADH;MAEhBC,QAAQ,EAAE,KAAK,CAACA;IAFA,CAAlB;;IAIA,IAAIz1E,IAAJ,EAAU;MACR,KAAK,CAAC2I,QAAN,GAAiB,IAAjB;IACD;;IACD,IAAI46E,YAAJ,EAAkB;MAChB,KAAK,CAAC9N,QAAN,GAAiB,KAAK,CAAC4N,gBAAN,CAAuBE,YAAvB,CAAjB;MACA,KAAK,CAAC/N,WAAN,GAAoB,IAApB;IACD;;IACD,KAAK,CAACO,KAAN,EAAa3rE,MAAb;IACA,KAAK,CAAC2rE,KAAN,GAAc,IAAd;EACD;;EACDC,WAAW,GAAG;IACZ,IAAI,CAAC,KAAK,CAACzB,OAAX,EAAoB;MAClB;IACD;;IACD,CAAC;MACCiB,WAAW,EAAE,KAAK,CAACA,WADpB;MAECC,QAAQ,EAAE,KAAK,CAACA;IAFjB,IAGG,KAAK,CAAClB,OAHV;IAIA,KAAK,CAACA,OAAN,GAAgB,IAAhB;IACA,KAAK,CAACwB,KAAN,EAAa3rE,MAAb;IACA,KAAK,CAAC2rE,KAAN,GAAc,IAAd;IACA,KAAK,CAACptE,QAAN,GAAiB,IAAjB;EACD;;EACD,CAACg7E,WAAW,GAAG;IACb,IAAI,KAAK,CAACh7E,QAAN,KAAmB,IAAvB,EAA6B;MAC3B;IACD;;IACD,MAAM;MACJwjE,IAAI,EAAE;QACJxf;MADI,CADF;MAIJn5C,QAAQ,EAAE;QACRhE,OAAO,EAAE;UACPC,SADO;UAEPC,UAFO;UAGPC,KAHO;UAIPC;QAJO;MADD;IAJN,IAYF,KAAK,CAAC2H,MAZV;IAaA,IAAIqsE,aAAa,GAAG,CAAC,CAAC,KAAK,CAACpK,UAA5B;IACA,IAAIx5E,IAAI,GAAG4jF,aAAa,GAAG,KAAK,CAACpK,UAAT,GAAsB,KAAK,CAACx5E,IAApD;;IACA,KAAK,MAAM6V,OAAX,IAAsB,KAAK,CAAC4jE,QAA5B,EAAsC;MACpC,IAAI,CAACz5E,IAAD,IAASlY,IAAI,CAACmY,SAAL,CAAe4V,OAAO,CAACxH,IAAR,CAAarO,IAA5B,EAAkCA,IAAlC,MAA4C,IAAzD,EAA+D;QAC7DA,IAAI,GAAG6V,OAAO,CAACxH,IAAR,CAAarO,IAApB;QACA4jF,aAAa,GAAG,IAAhB;QACA;MACD;IACF;;IACD,MAAMC,cAAc,GAAG/7F,IAAI,CAACiY,aAAL,CAAmB,CAACC,IAAI,CAAC,CAAD,CAAL,EAAU2sD,IAAI,CAAC,CAAD,CAAJ,GAAU3sD,IAAI,CAAC,CAAD,CAAd,GAAoB2sD,IAAI,CAAC,CAAD,CAAlC,EAAuC3sD,IAAI,CAAC,CAAD,CAA3C,EAAgD2sD,IAAI,CAAC,CAAD,CAAJ,GAAU3sD,IAAI,CAAC,CAAD,CAAd,GAAoB2sD,IAAI,CAAC,CAAD,CAAxE,CAAnB,CAAvB;IACA,MAAMm3B,iCAAiC,GAAG,CAA1C;IACA,MAAMx1D,WAAW,GAAGs1D,aAAa,GAAG5jF,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAd,GAAoB8jF,iCAAvB,GAA2D,CAA5F;IACA,MAAMC,SAAS,GAAGF,cAAc,CAAC,CAAD,CAAd,GAAoBv1D,WAAtC;IACA,MAAM01D,QAAQ,GAAGH,cAAc,CAAC,CAAD,CAA/B;IACA,KAAK,CAACl7E,QAAN,GAAiB,CAAC,OAAOo7E,SAAS,GAAGp0E,KAAnB,IAA4BF,SAA7B,EAAwC,OAAOu0E,QAAQ,GAAGp0E,KAAlB,IAA2BF,UAAnE,CAAjB;IACA,MAAM;MACJlH;IADI,IAEF,KAAK,CAAC6W,SAFV;IAGA7W,KAAK,CAACK,IAAN,GAAc,GAAE,KAAK,CAACF,QAAN,CAAe,CAAf,CAAkB,GAAlC;IACAH,KAAK,CAACI,GAAN,GAAa,GAAE,KAAK,CAACD,QAAN,CAAe,CAAf,CAAkB,GAAjC;EACD;;EACD,CAACob,MAAM,GAAG;IACR,KAAK,CAAC2+D,MAAN,GAAe,CAAC,KAAK,CAACA,MAAtB;;IACA,IAAI,KAAK,CAACA,MAAV,EAAkB;MAChB,KAAK,CAACvsE,IAAN;MACA,KAAK,CAACkJ,SAAN,CAAgBnK,gBAAhB,CAAiC,OAAjC,EAA0C,KAAK,CAACstE,WAAhD;MACA,KAAK,CAACnjE,SAAN,CAAgBnK,gBAAhB,CAAiC,SAAjC,EAA4C,KAAK,CAACmtE,YAAlD;IACD,CAJD,MAIO;MACL,KAAK,CAACtsE,IAAN;MACA,KAAK,CAACsJ,SAAN,CAAgBysC,mBAAhB,CAAoC,OAApC,EAA6C,KAAK,CAAC02B,WAAnD;MACA,KAAK,CAACnjE,SAAN,CAAgBysC,mBAAhB,CAAoC,SAApC,EAA+C,KAAK,CAACu2B,YAArD;IACD;EACF;;EACD,CAAClsE,IAAI,GAAG;IACN,IAAI,CAAC,KAAK,CAAC4/D,KAAX,EAAkB;MAChB,KAAKnhE,MAAL;IACD;;IACD,IAAI,CAAC,KAAKmyC,SAAV,EAAqB;MACnB,KAAK,CAAC48B,WAAN;MACA,KAAK,CAACtkE,SAAN,CAAgB+yD,MAAhB,GAAyB,KAAzB;MACA,KAAK,CAAC/yD,SAAN,CAAgB7W,KAAhB,CAAsBM,MAAtB,GAA+BmJ,QAAQ,CAAC,KAAK,CAACoN,SAAN,CAAgB7W,KAAhB,CAAsBM,MAAvB,CAAR,GAAyC,IAAxE;IACD,CAJD,MAIO,IAAI,KAAK,CAAC45E,MAAV,EAAkB;MACvB,KAAK,CAACrjE,SAAN,CAAgBrJ,SAAhB,CAA0BC,GAA1B,CAA8B,SAA9B;IACD;EACF;;EACD,CAACF,IAAI,GAAG;IACN,KAAK,CAACsJ,SAAN,CAAgBrJ,SAAhB,CAA0B5L,MAA1B,CAAiC,SAAjC;;IACA,IAAI,KAAK,CAACs4E,MAAN,IAAgB,CAAC,KAAK37B,SAA1B,EAAqC;MACnC;IACD;;IACD,KAAK,CAAC1nC,SAAN,CAAgB+yD,MAAhB,GAAyB,IAAzB;IACA,KAAK,CAAC/yD,SAAN,CAAgB7W,KAAhB,CAAsBM,MAAtB,GAA+BmJ,QAAQ,CAAC,KAAK,CAACoN,SAAN,CAAgB7W,KAAhB,CAAsBM,MAAvB,CAAR,GAAyC,IAAxE;EACD;;EACDqxE,SAAS,GAAG;IACV,KAAK,CAACwI,UAAN,GAAmB,KAAK57B,SAAxB;;IACA,IAAI,CAAC,KAAK,CAAC47B,UAAX,EAAuB;MACrB;IACD;;IACD,KAAK,CAACtjE,SAAN,CAAgB+yD,MAAhB,GAAyB,IAAzB;EACD;;EACD8H,SAAS,GAAG;IACV,IAAI,CAAC,KAAK,CAACyI,UAAX,EAAuB;MACrB;IACD;;IACD,IAAI,CAAC,KAAK,CAAC5M,KAAX,EAAkB;MAChB,KAAK,CAAC5/D,IAAN;IACD;;IACD,KAAK,CAACwsE,UAAN,GAAmB,KAAnB;IACA,KAAK,CAACtjE,SAAN,CAAgB+yD,MAAhB,GAAyB,KAAzB;EACD;;EACY,IAATrrB,SAAS,GAAG;IACd,OAAO,KAAK,CAAC1nC,SAAN,CAAgB+yD,MAAhB,KAA2B,KAAlC;EACD;;AAtSgB;;AAwSnB,MAAMoB,yBAAN,SAAwCc,iBAAxC,CAA0D;EACxD95E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE;IAFE,CAAlB;IAIA,KAAK7kD,WAAL,GAAmBmD,UAAU,CAAC5kB,IAAX,CAAgByhB,WAAnC;IACA,KAAKm0D,YAAL,GAAoBhxD,UAAU,CAAC5kB,IAAX,CAAgB41E,YAApC;IACA,KAAKzJ,oBAAL,GAA4Bn0F,oBAAoB,CAACsE,QAAjD;EACD;;EACDiqB,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,oBAA7B;;IACA,IAAI,KAAK6Z,WAAT,EAAsB;MACpB,MAAMmN,OAAO,GAAGj1B,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAhB;MACAy1B,OAAO,CAACjnB,SAAR,CAAkBC,GAAlB,CAAsB,uBAAtB;MACAgnB,OAAO,CAAC11B,YAAR,CAAqB,MAArB,EAA6B,SAA7B;;MACA,KAAK,MAAMk8E,IAAX,IAAmB,KAAK3zD,WAAxB,EAAqC;QACnC,MAAMo0D,QAAQ,GAAGl8E,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAAjB;QACA08E,QAAQ,CAACp0D,WAAT,GAAuB2zD,IAAvB;QACAxmD,OAAO,CAACj0B,MAAR,CAAek7E,QAAf;MACD;;MACD,KAAK7kE,SAAL,CAAerW,MAAf,CAAsBi0B,OAAtB;IACD;;IACD,IAAI,CAAC,KAAK5uB,IAAL,CAAU8nE,QAAX,IAAuB,KAAKP,YAAhC,EAA8C;MAC5C,KAAK0D,YAAL;IACD;;IACD,KAAKiB,kBAAL;;IACA,OAAO,KAAKl7D,SAAZ;EACD;;AA5BuD;;AA8B1D,MAAMo0D,qBAAN,SAAoCa,iBAApC,CAAsD;EACpD,CAACmP,IAAD,GAAQ,IAAR;;EACAjpF,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE;IAFE,CAAlB;EAID;;EACD//D,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,gBAA7B;IACA,MAAM5H,IAAI,GAAG,KAAKA,IAAlB;IACA,MAAM;MACJpI,KADI;MAEJC;IAFI,IAGFssE,WAAW,CAACnkE,IAAI,CAACrO,IAAN,CAHf;IAIA,MAAMqH,GAAG,GAAG,KAAK2tE,UAAL,CAAgBx4E,MAAhB,CAAuByJ,KAAvB,EAA8BC,MAA9B,EAAsC,IAAtC,CAAZ;IACA,MAAMu9E,IAAI,GAAG,KAAK,CAACA,IAAN,GAAa,KAAKzO,UAAL,CAAgBxtE,aAAhB,CAA8B,UAA9B,CAA1B;IACAi8E,IAAI,CAACl8E,YAAL,CAAkB,IAAlB,EAAwB8G,IAAI,CAACrO,IAAL,CAAU,CAAV,IAAeqO,IAAI,CAAC81E,eAAL,CAAqB,CAArB,CAAvC;IACAV,IAAI,CAACl8E,YAAL,CAAkB,IAAlB,EAAwB8G,IAAI,CAACrO,IAAL,CAAU,CAAV,IAAeqO,IAAI,CAAC81E,eAAL,CAAqB,CAArB,CAAvC;IACAV,IAAI,CAACl8E,YAAL,CAAkB,IAAlB,EAAwB8G,IAAI,CAACrO,IAAL,CAAU,CAAV,IAAeqO,IAAI,CAAC81E,eAAL,CAAqB,CAArB,CAAvC;IACAV,IAAI,CAACl8E,YAAL,CAAkB,IAAlB,EAAwB8G,IAAI,CAACrO,IAAL,CAAU,CAAV,IAAeqO,IAAI,CAAC81E,eAAL,CAAqB,CAArB,CAAvC;IACAV,IAAI,CAACl8E,YAAL,CAAkB,cAAlB,EAAkC8G,IAAI,CAACkoE,WAAL,CAAiBtwE,KAAjB,IAA0B,CAA5D;IACAw9E,IAAI,CAACl8E,YAAL,CAAkB,QAAlB,EAA4B,aAA5B;IACAk8E,IAAI,CAACl8E,YAAL,CAAkB,MAAlB,EAA0B,aAA1B;IACAF,GAAG,CAAC2B,MAAJ,CAAWy6E,IAAX;IACA,KAAKpkE,SAAL,CAAerW,MAAf,CAAsB3B,GAAtB;;IACA,IAAI,CAACgH,IAAI,CAAC8nE,QAAN,IAAkB,KAAKP,YAA3B,EAAyC;MACvC,KAAK0D,YAAL;IACD;;IACD,OAAO,KAAKj6D,SAAZ;EACD;;EACD+6D,yBAAyB,GAAG;IAC1B,OAAO,KAAK,CAACqJ,IAAb;EACD;;EACDpJ,gBAAgB,GAAG;IACjB,KAAKh7D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,eAA7B;EACD;;AApCmD;;AAsCtD,MAAMy9D,uBAAN,SAAsCY,iBAAtC,CAAwD;EACtD,CAAC8P,MAAD,GAAU,IAAV;;EACA5pF,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE;IAFE,CAAlB;EAID;;EACD//D,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,kBAA7B;IACA,MAAM5H,IAAI,GAAG,KAAKA,IAAlB;IACA,MAAM;MACJpI,KADI;MAEJC;IAFI,IAGFssE,WAAW,CAACnkE,IAAI,CAACrO,IAAN,CAHf;IAIA,MAAMqH,GAAG,GAAG,KAAK2tE,UAAL,CAAgBx4E,MAAhB,CAAuByJ,KAAvB,EAA8BC,MAA9B,EAAsC,IAAtC,CAAZ;IACA,MAAMswE,WAAW,GAAGnoE,IAAI,CAACkoE,WAAL,CAAiBtwE,KAArC;IACA,MAAMm+E,MAAM,GAAG,KAAK,CAACA,MAAN,GAAe,KAAKpP,UAAL,CAAgBxtE,aAAhB,CAA8B,UAA9B,CAA9B;IACA48E,MAAM,CAAC78E,YAAP,CAAoB,GAApB,EAAyBivE,WAAW,GAAG,CAAvC;IACA4N,MAAM,CAAC78E,YAAP,CAAoB,GAApB,EAAyBivE,WAAW,GAAG,CAAvC;IACA4N,MAAM,CAAC78E,YAAP,CAAoB,OAApB,EAA6BtB,KAAK,GAAGuwE,WAArC;IACA4N,MAAM,CAAC78E,YAAP,CAAoB,QAApB,EAA8BrB,MAAM,GAAGswE,WAAvC;IACA4N,MAAM,CAAC78E,YAAP,CAAoB,cAApB,EAAoCivE,WAAW,IAAI,CAAnD;IACA4N,MAAM,CAAC78E,YAAP,CAAoB,QAApB,EAA8B,aAA9B;IACA68E,MAAM,CAAC78E,YAAP,CAAoB,MAApB,EAA4B,aAA5B;IACAF,GAAG,CAAC2B,MAAJ,CAAWo7E,MAAX;IACA,KAAK/kE,SAAL,CAAerW,MAAf,CAAsB3B,GAAtB;;IACA,IAAI,CAACgH,IAAI,CAAC8nE,QAAN,IAAkB,KAAKP,YAA3B,EAAyC;MACvC,KAAK0D,YAAL;IACD;;IACD,OAAO,KAAKj6D,SAAZ;EACD;;EACD+6D,yBAAyB,GAAG;IAC1B,OAAO,KAAK,CAACgK,MAAb;EACD;;EACD/J,gBAAgB,GAAG;IACjB,KAAKh7D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,eAA7B;EACD;;AArCqD;;AAuCxD,MAAM09D,uBAAN,SAAsCW,iBAAtC,CAAwD;EACtD,CAAC+P,MAAD,GAAU,IAAV;;EACA7pF,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE;IAFE,CAAlB;EAID;;EACD//D,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,kBAA7B;IACA,MAAM5H,IAAI,GAAG,KAAKA,IAAlB;IACA,MAAM;MACJpI,KADI;MAEJC;IAFI,IAGFssE,WAAW,CAACnkE,IAAI,CAACrO,IAAN,CAHf;IAIA,MAAMqH,GAAG,GAAG,KAAK2tE,UAAL,CAAgBx4E,MAAhB,CAAuByJ,KAAvB,EAA8BC,MAA9B,EAAsC,IAAtC,CAAZ;IACA,MAAMswE,WAAW,GAAGnoE,IAAI,CAACkoE,WAAL,CAAiBtwE,KAArC;IACA,MAAMo+E,MAAM,GAAG,KAAK,CAACA,MAAN,GAAe,KAAKrP,UAAL,CAAgBxtE,aAAhB,CAA8B,aAA9B,CAA9B;IACA68E,MAAM,CAAC98E,YAAP,CAAoB,IAApB,EAA0BtB,KAAK,GAAG,CAAlC;IACAo+E,MAAM,CAAC98E,YAAP,CAAoB,IAApB,EAA0BrB,MAAM,GAAG,CAAnC;IACAm+E,MAAM,CAAC98E,YAAP,CAAoB,IAApB,EAA0BtB,KAAK,GAAG,CAAR,GAAYuwE,WAAW,GAAG,CAApD;IACA6N,MAAM,CAAC98E,YAAP,CAAoB,IAApB,EAA0BrB,MAAM,GAAG,CAAT,GAAaswE,WAAW,GAAG,CAArD;IACA6N,MAAM,CAAC98E,YAAP,CAAoB,cAApB,EAAoCivE,WAAW,IAAI,CAAnD;IACA6N,MAAM,CAAC98E,YAAP,CAAoB,QAApB,EAA8B,aAA9B;IACA88E,MAAM,CAAC98E,YAAP,CAAoB,MAApB,EAA4B,aAA5B;IACAF,GAAG,CAAC2B,MAAJ,CAAWq7E,MAAX;IACA,KAAKhlE,SAAL,CAAerW,MAAf,CAAsB3B,GAAtB;;IACA,IAAI,CAACgH,IAAI,CAAC8nE,QAAN,IAAkB,KAAKP,YAA3B,EAAyC;MACvC,KAAK0D,YAAL;IACD;;IACD,OAAO,KAAKj6D,SAAZ;EACD;;EACD+6D,yBAAyB,GAAG;IAC1B,OAAO,KAAK,CAACiK,MAAb;EACD;;EACDhK,gBAAgB,GAAG;IACjB,KAAKh7D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,eAA7B;EACD;;AArCqD;;AAuCxD,MAAM29D,yBAAN,SAAwCU,iBAAxC,CAA0D;EACxD,CAACgQ,QAAD,GAAY,IAAZ;;EACA9pF,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE;IAFE,CAAlB;IAIA,KAAK4P,kBAAL,GAA0B,oBAA1B;IACA,KAAKC,cAAL,GAAsB,cAAtB;EACD;;EACD5vE,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,KAAKsuE,kBAAlC;IACA,MAAM;MACJl2E,IAAI,EAAE;QACJrO,IADI;QAEJykF,QAFI;QAGJlO,WAHI;QAIJJ;MAJI;IADF,IAOF,IAPJ;;IAQA,IAAI,CAACsO,QAAL,EAAe;MACb,OAAO,KAAKplE,SAAZ;IACD;;IACD,MAAM;MACJpZ,KADI;MAEJC;IAFI,IAGFssE,WAAW,CAACxyE,IAAD,CAHf;IAIA,MAAMqH,GAAG,GAAG,KAAK2tE,UAAL,CAAgBx4E,MAAhB,CAAuByJ,KAAvB,EAA8BC,MAA9B,EAAsC,IAAtC,CAAZ;IACA,IAAIuuC,MAAM,GAAG,EAAb;;IACA,KAAK,IAAIl5C,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkiF,QAAQ,CAAC9qF,MAA9B,EAAsC4B,CAAC,GAAGgH,EAA1C,EAA8ChH,CAAC,IAAI,CAAnD,EAAsD;MACpD,MAAM8F,CAAC,GAAGojF,QAAQ,CAAClpF,CAAD,CAAR,GAAcyE,IAAI,CAAC,CAAD,CAA5B;MACA,MAAMsB,CAAC,GAAGtB,IAAI,CAAC,CAAD,CAAJ,GAAUykF,QAAQ,CAAClpF,CAAC,GAAG,CAAL,CAA5B;MACAk5C,MAAM,CAAC54C,IAAP,CAAa,GAAEwF,CAAE,IAAGC,CAAE,EAAtB;IACD;;IACDmzC,MAAM,GAAGA,MAAM,CAAC34C,IAAP,CAAY,GAAZ,CAAT;IACA,MAAMwoF,QAAQ,GAAG,KAAK,CAACA,QAAN,GAAiB,KAAKtP,UAAL,CAAgBxtE,aAAhB,CAA8B,KAAKg9E,cAAnC,CAAlC;IACAF,QAAQ,CAAC/8E,YAAT,CAAsB,QAAtB,EAAgCktC,MAAhC;IACA6vC,QAAQ,CAAC/8E,YAAT,CAAsB,cAAtB,EAAsCgvE,WAAW,CAACtwE,KAAZ,IAAqB,CAA3D;IACAq+E,QAAQ,CAAC/8E,YAAT,CAAsB,QAAtB,EAAgC,aAAhC;IACA+8E,QAAQ,CAAC/8E,YAAT,CAAsB,MAAtB,EAA8B,aAA9B;IACAF,GAAG,CAAC2B,MAAJ,CAAWs7E,QAAX;IACA,KAAKjlE,SAAL,CAAerW,MAAf,CAAsB3B,GAAtB;;IACA,IAAI,CAAC8uE,QAAD,IAAa,KAAKP,YAAtB,EAAoC;MAClC,KAAK0D,YAAL;IACD;;IACD,OAAO,KAAKj6D,SAAZ;EACD;;EACD+6D,yBAAyB,GAAG;IAC1B,OAAO,KAAK,CAACkK,QAAb;EACD;;EACDjK,gBAAgB,GAAG;IACjB,KAAKh7D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,eAA7B;EACD;;AApDuD;;AAsD1D,MAAM89D,wBAAN,SAAuCH,yBAAvC,CAAiE;EAC/Dp5E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN;IACA,KAAKsxD,kBAAL,GAA0B,mBAA1B;IACA,KAAKC,cAAL,GAAsB,aAAtB;EACD;;AAL8D;;AAOjE,MAAM3Q,sBAAN,SAAqCS,iBAArC,CAAuD;EACrD95E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE;IAFE,CAAlB;EAID;;EACD//D,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,iBAA7B;;IACA,IAAI,CAAC,KAAK5H,IAAL,CAAU8nE,QAAX,IAAuB,KAAKP,YAAhC,EAA8C;MAC5C,KAAK0D,YAAL;IACD;;IACD,OAAO,KAAKj6D,SAAZ;EACD;;AAboD;;AAevD,MAAMy0D,oBAAN,SAAmCQ,iBAAnC,CAAqD;EACnD,CAACoQ,SAAD,GAAa,EAAb;;EACAlqF,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE;IAFE,CAAlB;IAIA,KAAK4P,kBAAL,GAA0B,eAA1B;IACA,KAAKC,cAAL,GAAsB,cAAtB;IACA,KAAKhK,oBAAL,GAA4Bn0F,oBAAoB,CAACyE,GAAjD;EACD;;EACD8pB,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,KAAKsuE,kBAAlC;IACA,MAAM;MACJl2E,IAAI,EAAE;QACJrO,IADI;QAEJ2kF,QAFI;QAGJpO,WAHI;QAIJJ;MAJI;IADF,IAOF,IAPJ;IAQA,MAAM;MACJlwE,KADI;MAEJC;IAFI,IAGFssE,WAAW,CAACxyE,IAAD,CAHf;IAIA,MAAMqH,GAAG,GAAG,KAAK2tE,UAAL,CAAgBx4E,MAAhB,CAAuByJ,KAAvB,EAA8BC,MAA9B,EAAsC,IAAtC,CAAZ;;IACA,KAAK,MAAM0+E,OAAX,IAAsBD,QAAtB,EAAgC;MAC9B,IAAIlwC,MAAM,GAAG,EAAb;;MACA,KAAK,IAAIl5C,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGqiF,OAAO,CAACjrF,MAA7B,EAAqC4B,CAAC,GAAGgH,EAAzC,EAA6ChH,CAAC,IAAI,CAAlD,EAAqD;QACnD,MAAM8F,CAAC,GAAGujF,OAAO,CAACrpF,CAAD,CAAP,GAAayE,IAAI,CAAC,CAAD,CAA3B;QACA,MAAMsB,CAAC,GAAGtB,IAAI,CAAC,CAAD,CAAJ,GAAU4kF,OAAO,CAACrpF,CAAC,GAAG,CAAL,CAA3B;QACAk5C,MAAM,CAAC54C,IAAP,CAAa,GAAEwF,CAAE,IAAGC,CAAE,EAAtB;MACD;;MACDmzC,MAAM,GAAGA,MAAM,CAAC34C,IAAP,CAAY,GAAZ,CAAT;MACA,MAAMwoF,QAAQ,GAAG,KAAKtP,UAAL,CAAgBxtE,aAAhB,CAA8B,KAAKg9E,cAAnC,CAAjB;MACA,KAAK,CAACE,SAAN,CAAgB7oF,IAAhB,CAAqByoF,QAArB;MACAA,QAAQ,CAAC/8E,YAAT,CAAsB,QAAtB,EAAgCktC,MAAhC;MACA6vC,QAAQ,CAAC/8E,YAAT,CAAsB,cAAtB,EAAsCgvE,WAAW,CAACtwE,KAAZ,IAAqB,CAA3D;MACAq+E,QAAQ,CAAC/8E,YAAT,CAAsB,QAAtB,EAAgC,aAAhC;MACA+8E,QAAQ,CAAC/8E,YAAT,CAAsB,MAAtB,EAA8B,aAA9B;;MACA,IAAI,CAAC4uE,QAAD,IAAa,KAAKP,YAAtB,EAAoC;QAClC,KAAK0D,YAAL;MACD;;MACDjyE,GAAG,CAAC2B,MAAJ,CAAWs7E,QAAX;IACD;;IACD,KAAKjlE,SAAL,CAAerW,MAAf,CAAsB3B,GAAtB;IACA,OAAO,KAAKgY,SAAZ;EACD;;EACD+6D,yBAAyB,GAAG;IAC1B,OAAO,KAAK,CAACsK,SAAb;EACD;;EACDrK,gBAAgB,GAAG;IACjB,KAAKh7D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,eAA7B;EACD;;AArDkD;;AAuDrD,MAAM+9D,0BAAN,SAAyCM,iBAAzC,CAA2D;EACzD95E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE,IAFE;MAGhBC,oBAAoB,EAAE;IAHN,CAAlB;EAKD;;EACDhgE,MAAM,GAAG;IACP,IAAI,CAAC,KAAKvG,IAAL,CAAU8nE,QAAX,IAAuB,KAAKP,YAAhC,EAA8C;MAC5C,KAAK0D,YAAL;IACD;;IACD,KAAKj6D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,qBAA7B;IACA,OAAO,KAAKoJ,SAAZ;EACD;;AAdwD;;AAgB3D,MAAM40D,0BAAN,SAAyCK,iBAAzC,CAA2D;EACzD95E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE,IAFE;MAGhBC,oBAAoB,EAAE;IAHN,CAAlB;EAKD;;EACDhgE,MAAM,GAAG;IACP,IAAI,CAAC,KAAKvG,IAAL,CAAU8nE,QAAX,IAAuB,KAAKP,YAAhC,EAA8C;MAC5C,KAAK0D,YAAL;IACD;;IACD,KAAKj6D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,qBAA7B;IACA,OAAO,KAAKoJ,SAAZ;EACD;;AAdwD;;AAgB3D,MAAM60D,yBAAN,SAAwCI,iBAAxC,CAA0D;EACxD95E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE,IAFE;MAGhBC,oBAAoB,EAAE;IAHN,CAAlB;EAKD;;EACDhgE,MAAM,GAAG;IACP,IAAI,CAAC,KAAKvG,IAAL,CAAU8nE,QAAX,IAAuB,KAAKP,YAAhC,EAA8C;MAC5C,KAAK0D,YAAL;IACD;;IACD,KAAKj6D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,oBAA7B;IACA,OAAO,KAAKoJ,SAAZ;EACD;;AAduD;;AAgB1D,MAAM80D,0BAAN,SAAyCG,iBAAzC,CAA2D;EACzD95E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE,IAFE;MAGhBC,oBAAoB,EAAE;IAHN,CAAlB;EAKD;;EACDhgE,MAAM,GAAG;IACP,IAAI,CAAC,KAAKvG,IAAL,CAAU8nE,QAAX,IAAuB,KAAKP,YAAhC,EAA8C;MAC5C,KAAK0D,YAAL;IACD;;IACD,KAAKj6D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,qBAA7B;IACA,OAAO,KAAKoJ,SAAZ;EACD;;AAdwD;;AAgB3D,MAAM+0D,sBAAN,SAAqCE,iBAArC,CAAuD;EACrD95E,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE,IADE;MAEhBC,YAAY,EAAE;IAFE,CAAlB;EAID;;EACD//D,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,iBAA7B;;IACA,IAAI,CAAC,KAAK5H,IAAL,CAAU8nE,QAAX,IAAuB,KAAKP,YAAhC,EAA8C;MAC5C,KAAK0D,YAAL;IACD;;IACD,OAAO,KAAKj6D,SAAZ;EACD;;AAboD;;AAevD,MAAMg1D,+BAAN,SAA8CC,iBAA9C,CAAgE;EAC9D,CAACsO,OAAD,GAAW,IAAX;;EACApoF,WAAW,CAACy4B,UAAD,EAAa;IACtB,MAAMA,UAAN,EAAkB;MAChByhD,YAAY,EAAE;IADE,CAAlB;IAGA,MAAM;MACJ/7D;IADI,IAEF,KAAKtK,IAFT;IAGA,KAAKnH,QAAL,GAAgByR,IAAI,CAACzR,QAArB;IACA,KAAK+1B,OAAL,GAAetkB,IAAI,CAACskB,OAApB;IACA,KAAKm0C,WAAL,CAAiBvwD,QAAjB,EAA2BuC,QAA3B,CAAoC,0BAApC,EAAgE;MAC9DC,MAAM,EAAE,IADsD;MAE9D,GAAG1K;IAF2D,CAAhE;EAID;;EACD/D,MAAM,GAAG;IACP,KAAKyK,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,0BAA7B;IACA,MAAM;MACJoJ,SADI;MAEJhR;IAFI,IAGF,IAHJ;IAIA,IAAIu0E,OAAJ;;IACA,IAAIv0E,IAAI,CAACiwE,aAAL,IAAsBjwE,IAAI,CAACgoC,SAAL,KAAmB,CAA7C,EAAgD;MAC9CusC,OAAO,GAAG56E,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAV;IACD,CAFD,MAEO;MACLo7E,OAAO,GAAG56E,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAV;MACAo7E,OAAO,CAACzqE,GAAR,GAAe,GAAE,KAAK28D,kBAAmB,cAAa,aAAavkE,IAAb,CAAkBlC,IAAI,CAAC9T,IAAvB,IAA+B,WAA/B,GAA6C,SAAU,MAA7G;;MACA,IAAI8T,IAAI,CAACgoC,SAAL,IAAkBhoC,IAAI,CAACgoC,SAAL,GAAiB,CAAvC,EAA0C;QACxCusC,OAAO,CAACp6E,KAAR,GAAiB,mBAAkB/M,IAAI,CAAC0P,KAAL,CAAWkD,IAAI,CAACgoC,SAAL,GAAiB,GAA5B,CAAiC,KAApE;MACD;IACF;;IACDusC,OAAO,CAAC1tE,gBAAR,CAAyB,UAAzB,EAAqC,KAAK,CAAC2vE,QAAN,CAAe55E,IAAf,CAAoB,IAApB,CAArC;IACA,KAAK,CAAC23E,OAAN,GAAgBA,OAAhB;IACA,MAAM;MACJxlF;IADI,IAEFtW,gBAAgB,CAACoW,QAFrB;IAGAmiB,SAAS,CAACnK,gBAAV,CAA2B,SAA3B,EAAsCoM,GAAG,IAAI;MAC3C,IAAIA,GAAG,CAACl8B,GAAJ,KAAY,OAAZ,KAAwBgY,KAAK,GAAGkkB,GAAG,CAAC5F,OAAP,GAAiB4F,GAAG,CAAC7F,OAAlD,CAAJ,EAAgE;QAC9D,KAAK,CAACopE,QAAN;MACD;IACF,CAJD;;IAKA,IAAI,CAACx2E,IAAI,CAAC8nE,QAAN,IAAkB,KAAKP,YAA3B,EAAyC;MACvC,KAAK0D,YAAL;IACD,CAFD,MAEO;MACLsJ,OAAO,CAAC5sE,SAAR,CAAkBC,GAAlB,CAAsB,kBAAtB;IACD;;IACDoJ,SAAS,CAACrW,MAAV,CAAiB45E,OAAjB;IACA,OAAOvjE,SAAP;EACD;;EACD+6D,yBAAyB,GAAG;IAC1B,OAAO,KAAK,CAACwI,OAAb;EACD;;EACDvI,gBAAgB,GAAG;IACjB,KAAKh7D,SAAL,CAAerJ,SAAf,CAAyBC,GAAzB,CAA6B,eAA7B;EACD;;EACD,CAAC4uE,QAAQ,GAAG;IACV,KAAKhQ,eAAL,EAAsBiH,kBAAtB,CAAyC,KAAK7+C,OAA9C,EAAuD,KAAK/1B,QAA5D;EACD;;AA1D6D;;AA4DhE,MAAM3gB,eAAN,CAAsB;EACpB,CAACu+F,oBAAD,GAAwB,IAAxB;EACA,CAACzqC,mBAAD,GAAuB,IAAvB;EACA,CAAC0qC,mBAAD,GAAuB,IAAIlhF,GAAJ,EAAvB;;EACArJ,WAAW,CAAC;IACV+N,GADU;IAEVu8E,oBAFU;IAGVzqC,mBAHU;IAIV2qC,yBAJU;IAKV7Y,IALU;IAMV34D;EANU,CAAD,EAOR;IACD,KAAKjL,GAAL,GAAWA,GAAX;IACA,KAAK,CAACu8E,oBAAN,GAA6BA,oBAA7B;IACA,KAAK,CAACzqC,mBAAN,GAA4BA,mBAA5B;IACA,KAAK8xB,IAAL,GAAYA,IAAZ;IACA,KAAK34D,QAAL,GAAgBA,QAAhB;IACA,KAAK1K,MAAL,GAAc,CAAd;IACA,KAAKm8E,0BAAL,GAAkCD,yBAAlC;EACD;;EACDE,sBAAsB,GAAG;IACvB,OAAO,KAAK,CAACH,mBAAN,CAA0Bh5E,IAA1B,GAAiC,CAAxC;EACD;;EACD,CAACo5E,aAAa,CAACtvE,OAAD,EAAU3N,EAAV,EAAc;IAC1B,MAAMk9E,cAAc,GAAGvvE,OAAO,CAACumB,UAAR,IAAsBvmB,OAA7C;IACAuvE,cAAc,CAACl9E,EAAf,GAAqB,GAAE3D,gBAAiB,GAAE2D,EAAG,EAA7C;IACA,KAAKK,GAAL,CAASS,MAAT,CAAgB6M,OAAhB;IACA,KAAK,CAACivE,oBAAN,EAA4BO,gBAA5B,CAA6C,KAAK98E,GAAlD,EAAuDsN,OAAvD,EAAgEuvE,cAAhE,EAAgF,KAAhF;EACD;;EACKxwE,MAAM,CAAC0X,MAAD,EAAS;IAAA;;IAAA;MACnB,MAAM;QACJg5D;MADI,IAEFh5D,MAFJ;MAGA,MAAMvK,KAAK,GAAG,OAAI,CAACxZ,GAAnB;MACA3f,kBAAkB,CAACm5B,KAAD,EAAQ,OAAI,CAACvO,QAAb,CAAlB;MACA,MAAM+xE,eAAe,GAAG,IAAI1hF,GAAJ,EAAxB;MACA,MAAM2hF,aAAa,GAAG;QACpBn3E,IAAI,EAAE,IADc;QAEpB0T,KAFoB;QAGpBqvD,WAAW,EAAE9kD,MAAM,CAAC8kD,WAHA;QAIpByD,eAAe,EAAEvoD,MAAM,CAACuoD,eAJJ;QAKpBC,kBAAkB,EAAExoD,MAAM,CAACwoD,kBAAP,IAA6B,EAL7B;QAMpBC,WAAW,EAAEzoD,MAAM,CAACyoD,WAAP,KAAuB,KANhB;QAOpBC,UAAU,EAAE,IAAIruF,aAAJ,EAPQ;QAQpBq2B,iBAAiB,EAAEsP,MAAM,CAACtP,iBAAP,IAA4B,IAAI4hB,iBAAJ,EAR3B;QASpBq2C,eAAe,EAAE3oD,MAAM,CAAC2oD,eAAP,KAA2B,IATxB;QAUpBjQ,YAAY,EAAE14C,MAAM,CAAC04C,YAVD;QAWpBmQ,YAAY,EAAE7oD,MAAM,CAAC6oD,YAXD;QAYpB59D,MAAM,EAAE,OAZY;QAapBkiE,QAAQ,EAAE;MAbU,CAAtB;;MAeA,KAAK,MAAMprE,IAAX,IAAmBi3E,WAAnB,EAAgC;QAC9B,IAAIj3E,IAAI,CAACo3E,MAAT,EAAiB;UACf;QACD;;QACD,MAAMC,iBAAiB,GAAGr3E,IAAI,CAACqkE,cAAL,KAAwBzlF,cAAc,CAACY,KAAjE;;QACA,IAAI,CAAC63F,iBAAL,EAAwB;UACtB,MAAM;YACJz/E,KADI;YAEJC;UAFI,IAGFssE,WAAW,CAACnkE,IAAI,CAACrO,IAAN,CAHf;;UAIA,IAAIiG,KAAK,IAAI,CAAT,IAAcC,MAAM,IAAI,CAA5B,EAA+B;YAC7B;UACD;QACF,CARD,MAQO;UACL,MAAMuzE,QAAQ,GAAG8L,eAAe,CAAC9/F,GAAhB,CAAoB4oB,IAAI,CAACnG,EAAzB,CAAjB;;UACA,IAAI,CAACuxE,QAAL,EAAe;YACb;UACD;;UACD+L,aAAa,CAAC/L,QAAd,GAAyBA,QAAzB;QACD;;QACD+L,aAAa,CAACn3E,IAAd,GAAqBA,IAArB;QACA,MAAMwH,OAAO,GAAG48D,wBAAwB,CAACj2E,MAAzB,CAAgCgpF,aAAhC,CAAhB;;QACA,IAAI,CAAC3vE,OAAO,CAAC6+D,YAAb,EAA2B;UACzB;QACD;;QACD,IAAI,CAACgR,iBAAD,IAAsBr3E,IAAI,CAAC8nE,QAA/B,EAAyC;UACvC,MAAMsD,QAAQ,GAAG8L,eAAe,CAAC9/F,GAAhB,CAAoB4oB,IAAI,CAAC8nE,QAAzB,CAAjB;;UACA,IAAI,CAACsD,QAAL,EAAe;YACb8L,eAAe,CAACv7E,GAAhB,CAAoBqE,IAAI,CAAC8nE,QAAzB,EAAmC,CAACtgE,OAAD,CAAnC;UACD,CAFD,MAEO;YACL4jE,QAAQ,CAAC59E,IAAT,CAAcga,OAAd;UACD;QACF;;QACD,MAAM8vE,QAAQ,GAAG9vE,OAAO,CAACjB,MAAR,EAAjB;;QACA,IAAIvG,IAAI,CAAC+jE,MAAT,EAAiB;UACfuT,QAAQ,CAACn9E,KAAT,CAAeC,UAAf,GAA4B,QAA5B;QACD;;QACD,OAAI,CAAC,CAAC08E,aAAN,CAAoBQ,QAApB,EAA8Bt3E,IAAI,CAACnG,EAAnC;;QACA,IAAI2N,OAAO,CAAC6/D,WAAZ,EAAyB;UACvB,OAAI,CAAC,CAACqP,mBAAN,CAA0B/6E,GAA1B,CAA8B6L,OAAO,CAACxH,IAAR,CAAanG,EAA3C,EAA+C2N,OAA/C;;UACA,OAAI,CAACovE,0BAAL,EAAiCp2D,uBAAjC,CAAyDhZ,OAAzD;QACD;MACF;;MACD,OAAI,CAAC,CAAC+vE,sBAAN;IAjEmB;EAkEpB;;EACDhoD,MAAM,CAAC;IACLpqB;EADK,CAAD,EAEH;IACD,MAAMuO,KAAK,GAAG,KAAKxZ,GAAnB;IACA,KAAKiL,QAAL,GAAgBA,QAAhB;IACA5qB,kBAAkB,CAACm5B,KAAD,EAAQ;MACxBnT,QAAQ,EAAE4E,QAAQ,CAAC5E;IADK,CAAR,CAAlB;IAGA,KAAK,CAACg3E,sBAAN;IACA7jE,KAAK,CAACqwD,MAAN,GAAe,KAAf;EACD;;EACD,CAACwT,sBAAsB,GAAG;IACxB,IAAI,CAAC,KAAK,CAACvrC,mBAAX,EAAgC;MAC9B;IACD;;IACD,MAAMt4B,KAAK,GAAG,KAAKxZ,GAAnB;;IACA,KAAK,MAAM,CAACL,EAAD,EAAK/B,MAAL,CAAX,IAA2B,KAAK,CAACk0C,mBAAjC,EAAsD;MACpD,MAAMxkC,OAAO,GAAGkM,KAAK,CAACmb,aAAN,CAAqB,wBAAuBh1B,EAAG,IAA/C,CAAhB;;MACA,IAAI,CAAC2N,OAAL,EAAc;QACZ;MACD;;MACD1P,MAAM,CAAC2O,SAAP,GAAmB,mBAAnB;MACA,MAAM;QACJsnB;MADI,IAEFvmB,OAFJ;;MAGA,IAAI,CAACumB,UAAL,EAAiB;QACfvmB,OAAO,CAAC7M,MAAR,CAAe7C,MAAf;MACD,CAFD,MAEO,IAAIi2B,UAAU,CAACe,QAAX,KAAwB,QAA5B,EAAsC;QAC3Cf,UAAU,CAACypD,WAAX,CAAuB1/E,MAAvB;MACD,CAFM,MAEA,IAAI,CAACi2B,UAAU,CAACpmB,SAAX,CAAqB4J,QAArB,CAA8B,mBAA9B,CAAL,EAAyD;QAC9Dwc,UAAU,CAACC,MAAX,CAAkBl2B,MAAlB;MACD,CAFM,MAEA;QACLi2B,UAAU,CAAC0pD,KAAX,CAAiB3/E,MAAjB;MACD;IACF;;IACD,KAAK,CAACk0C,mBAAN,CAA0BpuC,KAA1B;EACD;;EACD85E,sBAAsB,GAAG;IACvB,OAAOroF,KAAK,CAACC,IAAN,CAAW,KAAK,CAAConF,mBAAN,CAA0B/iE,MAA1B,EAAX,CAAP;EACD;;EACDgkE,qBAAqB,CAAC99E,EAAD,EAAK;IACxB,OAAO,KAAK,CAAC68E,mBAAN,CAA0Bt/F,GAA1B,CAA8ByiB,EAA9B,CAAP;EACD;;AA1ImB;;AA6ItB,C,CAAC;;AAKD,MAAM+9E,WAAW,GAAG,WAApB;;AACA,MAAMC,cAAN,SAA6B90D,gBAA7B,CAA8C;EAC5C,CAAC5mB,KAAD;EACA,CAACyyB,OAAD,GAAW,EAAX;EACA,CAACkpD,WAAD,GAAgB,GAAE,KAAKj+E,EAAG,SAA1B;EACA,CAACk+E,UAAD,GAAc,IAAd;EACA,CAAC7wC,QAAD;EACA,CAACkZ,WAAD,GAAe,IAAf;EAC8B,OAAvB43B,uBAAuB,GAAG,EAAH;EACP,OAAhBC,gBAAgB,GAAG,CAAH;EACH,OAAbC,aAAa,GAAG,IAAH;EACG,OAAhBC,gBAAgB,GAAG,EAAH;;EACI,WAAhB/mE,gBAAgB,GAAG;IAC5B,MAAMC,KAAK,GAAGwmE,cAAc,CAACtgG,SAA7B;;IACA,MAAM+5B,YAAY,GAAG/D,IAAI,IAAIA,IAAI,CAACoD,OAAL,EAA7B;;IACA,MAAMqB,KAAK,GAAG/5B,yBAAyB,CAACi5B,eAAxC;IACA,MAAMe,GAAG,GAAGh6B,yBAAyB,CAACk5B,aAAtC;IACA,OAAO32B,MAAM,CAAC,IAAD,EAAO,kBAAP,EAA2B,IAAIkyB,eAAJ,CAAoB,CAAC,CAAC,CAAC,QAAD,EAAW,YAAX,EAAyB,QAAzB,EAAmC,YAAnC,CAAD,EAAmD2E,KAAK,CAACwE,cAAzD,EAAyE;MACpIpI,OAAO,EAAE;IAD2H,CAAzE,CAAD,EAExD,CAAC,CAAC,YAAD,EAAe,gBAAf,EAAiC,QAAjC,EAA2C,YAA3C,CAAD,EAA2D4D,KAAK,CAACwE,cAAjE,CAFwD,EAE0B,CAAC,CAAC,WAAD,EAAc,eAAd,CAAD,EAAiCxE,KAAK,CAAC+mE,eAAvC,EAAwD;MAC5I1qE,IAAI,EAAE,CAAC,CAACsE,KAAF,EAAS,CAAT,CADsI;MAE5IrE,OAAO,EAAE2D;IAFmI,CAAxD,CAF1B,EAKxD,CAAC,CAAC,gBAAD,EAAmB,qBAAnB,CAAD,EAA4CD,KAAK,CAAC+mE,eAAlD,EAAmE;MACrE1qE,IAAI,EAAE,CAAC,CAACuE,GAAF,EAAO,CAAP,CAD+D;MAErEtE,OAAO,EAAE2D;IAF4D,CAAnE,CALwD,EAQxD,CAAC,CAAC,YAAD,EAAe,gBAAf,CAAD,EAAmCD,KAAK,CAAC+mE,eAAzC,EAA0D;MAC5D1qE,IAAI,EAAE,CAACsE,KAAD,EAAQ,CAAR,CADsD;MAE5DrE,OAAO,EAAE2D;IAFmD,CAA1D,CARwD,EAWxD,CAAC,CAAC,iBAAD,EAAoB,sBAApB,CAAD,EAA8CD,KAAK,CAAC+mE,eAApD,EAAqE;MACvE1qE,IAAI,EAAE,CAACuE,GAAD,EAAM,CAAN,CADiE;MAEvEtE,OAAO,EAAE2D;IAF8D,CAArE,CAXwD,EAcxD,CAAC,CAAC,SAAD,EAAY,aAAZ,CAAD,EAA6BD,KAAK,CAAC+mE,eAAnC,EAAoD;MACtD1qE,IAAI,EAAE,CAAC,CAAD,EAAI,CAACsE,KAAL,CADgD;MAEtDrE,OAAO,EAAE2D;IAF6C,CAApD,CAdwD,EAiBxD,CAAC,CAAC,cAAD,EAAiB,mBAAjB,CAAD,EAAwCD,KAAK,CAAC+mE,eAA9C,EAA+D;MACjE1qE,IAAI,EAAE,CAAC,CAAD,EAAI,CAACuE,GAAL,CAD2D;MAEjEtE,OAAO,EAAE2D;IAFwD,CAA/D,CAjBwD,EAoBxD,CAAC,CAAC,WAAD,EAAc,eAAd,CAAD,EAAiCD,KAAK,CAAC+mE,eAAvC,EAAwD;MAC1D1qE,IAAI,EAAE,CAAC,CAAD,EAAIsE,KAAJ,CADoD;MAE1DrE,OAAO,EAAE2D;IAFiD,CAAxD,CApBwD,EAuBxD,CAAC,CAAC,gBAAD,EAAmB,qBAAnB,CAAD,EAA4CD,KAAK,CAAC+mE,eAAlD,EAAmE;MACrE1qE,IAAI,EAAE,CAAC,CAAD,EAAIuE,GAAJ,CAD+D;MAErEtE,OAAO,EAAE2D;IAF4D,CAAnE,CAvBwD,CAApB,CAA3B,CAAb;EA2BD;;EACW,OAALgU,KAAK,GAAG,UAAH;EACM,OAAX+yD,WAAW,GAAGrgG,oBAAoB,CAACsE,QAAxB;;EAClB6P,WAAW,CAAC8xB,MAAD,EAAS;IAClB,MAAM,EACJ,GAAGA,MADC;MAEJ/xB,IAAI,EAAE;IAFF,CAAN;IAIA,KAAK,CAACiQ,KAAN,GAAc8hB,MAAM,CAAC9hB,KAAP,IAAgB07E,cAAc,CAACK,aAA/B,IAAgDn1D,gBAAgB,CAACwC,iBAA/E;IACA,KAAK,CAAC2hB,QAAN,GAAiBjpB,MAAM,CAACipB,QAAP,IAAmB2wC,cAAc,CAACM,gBAAnD;EACD;;EACgB,OAAV52D,UAAU,CAACqE,IAAD,EAAOld,SAAP,EAAkB;IACjCqa,gBAAgB,CAACxB,UAAjB,CAA4BqE,IAA5B,EAAkCld,SAAlC,EAA6C;MAC3Cyd,OAAO,EAAE,CAAC,iCAAD;IADkC,CAA7C;IAGA,MAAMhsB,KAAK,GAAGmE,gBAAgB,CAAC3E,QAAQ,CAACysB,eAAV,CAA9B;IACA,KAAK6xD,gBAAL,GAAwB5xD,UAAU,CAAClsB,KAAK,CAACoE,gBAAN,CAAuB,oBAAvB,CAAD,CAAlC;EACD;;EACyB,OAAnB4d,mBAAmB,CAACphC,IAAD,EAAO4Q,KAAP,EAAc;IACtC,QAAQ5Q,IAAR;MACE,KAAKhD,0BAA0B,CAAC6E,aAAhC;QACEi7F,cAAc,CAACM,gBAAf,GAAkCxsF,KAAlC;QACA;;MACF,KAAK5T,0BAA0B,CAAC8E,cAAhC;QACEg7F,cAAc,CAACK,aAAf,GAA+BvsF,KAA/B;QACA;IANJ;EAQD;;EACDunB,YAAY,CAACn4B,IAAD,EAAO4Q,KAAP,EAAc;IACxB,QAAQ5Q,IAAR;MACE,KAAKhD,0BAA0B,CAAC6E,aAAhC;QACE,KAAK,CAAC07F,cAAN,CAAqB3sF,KAArB;QACA;;MACF,KAAK5T,0BAA0B,CAAC8E,cAAhC;QACE,KAAK,CAACo/B,WAAN,CAAkBtwB,KAAlB;QACA;IANJ;EAQD;;EACmC,WAAzBmvB,yBAAyB,GAAG;IACrC,OAAO,CAAC,CAAC/iC,0BAA0B,CAAC6E,aAA5B,EAA2Ci7F,cAAc,CAACM,gBAA1D,CAAD,EAA8E,CAACpgG,0BAA0B,CAAC8E,cAA5B,EAA4Cg7F,cAAc,CAACK,aAAf,IAAgCn1D,gBAAgB,CAACwC,iBAA7F,CAA9E,CAAP;EACD;;EACqB,IAAlB9H,kBAAkB,GAAG;IACvB,OAAO,CAAC,CAAC1lC,0BAA0B,CAAC6E,aAA5B,EAA2C,KAAK,CAACsqD,QAAjD,CAAD,EAA6D,CAACnvD,0BAA0B,CAAC8E,cAA5B,EAA4C,KAAK,CAACsf,KAAlD,CAA7D,CAAP;EACD;;EACD,CAACm8E,cAAc,CAACpxC,QAAD,EAAW;IACxB,MAAMqxC,WAAW,GAAG76E,IAAI,IAAI;MAC1B,KAAK86E,SAAL,CAAer+E,KAAf,CAAqB+sC,QAArB,GAAiC,QAAOxpC,IAAK,2BAA7C;MACA,KAAK4pB,SAAL,CAAe,CAAf,EAAkB,EAAE5pB,IAAI,GAAG,KAAK,CAACwpC,QAAf,IAA2B,KAAK7e,WAAlD;MACA,KAAK,CAAC6e,QAAN,GAAiBxpC,IAAjB;MACA,KAAK,CAAC+6E,mBAAN;IACD,CALD;;IAMA,MAAMC,aAAa,GAAG,KAAK,CAACxxC,QAA5B;IACA,KAAK9sB,WAAL,CAAiB;MACftO,GAAG,EAAEysE,WAAW,CAAC37E,IAAZ,CAAiB,IAAjB,EAAuBsqC,QAAvB,CADU;MAEfn7B,IAAI,EAAEwsE,WAAW,CAAC37E,IAAZ,CAAiB,IAAjB,EAAuB87E,aAAvB,CAFS;MAGf1sE,IAAI,EAAE,KAAKrF,UAAL,CAAgBiX,QAAhB,CAAyBhhB,IAAzB,CAA8B,KAAK+J,UAAnC,EAA+C,IAA/C,CAHS;MAIfsF,QAAQ,EAAE,IAJK;MAKflxB,IAAI,EAAEhD,0BAA0B,CAAC6E,aALlB;MAMfuvB,mBAAmB,EAAE,IANN;MAOfC,QAAQ,EAAE;IAPK,CAAjB;EASD;;EACD,CAAC6P,WAAW,CAAC9f,KAAD,EAAQ;IAClB,MAAM4sE,QAAQ,GAAG4P,GAAG,IAAI;MACtB,KAAK,CAACx8E,KAAN,GAAc,KAAKq8E,SAAL,CAAer+E,KAAf,CAAqBgC,KAArB,GAA6Bw8E,GAA3C;IACD,CAFD;;IAGA,MAAMC,UAAU,GAAG,KAAK,CAACz8E,KAAzB;IACA,KAAKie,WAAL,CAAiB;MACftO,GAAG,EAAEi9D,QAAQ,CAACnsE,IAAT,CAAc,IAAd,EAAoBT,KAApB,CADU;MAEf4P,IAAI,EAAEg9D,QAAQ,CAACnsE,IAAT,CAAc,IAAd,EAAoBg8E,UAApB,CAFS;MAGf5sE,IAAI,EAAE,KAAKrF,UAAL,CAAgBiX,QAAhB,CAAyBhhB,IAAzB,CAA8B,KAAK+J,UAAnC,EAA+C,IAA/C,CAHS;MAIfsF,QAAQ,EAAE,IAJK;MAKflxB,IAAI,EAAEhD,0BAA0B,CAAC8E,cALlB;MAMfsvB,mBAAmB,EAAE,IANN;MAOfC,QAAQ,EAAE;IAPK,CAAjB;EASD;;EACDgsE,eAAe,CAACplF,CAAD,EAAIC,CAAJ,EAAO;IACpB,KAAK0T,UAAL,CAAgB4L,wBAAhB,CAAyCvf,CAAzC,EAA4CC,CAA5C,EAA+C,IAA/C;EACD;;EACD41B,qBAAqB,GAAG;IACtB,MAAMvoB,KAAK,GAAG,KAAK+nB,WAAnB;IACA,OAAO,CAAC,CAACwvD,cAAc,CAACI,gBAAhB,GAAmC33E,KAApC,EAA2C,EAAEu3E,cAAc,CAACI,gBAAf,GAAkC,KAAK,CAAC/wC,QAA1C,IAAsD5mC,KAAjG,CAAP;EACD;;EACDif,OAAO,GAAG;IACR,IAAI,CAAC,KAAKrW,MAAV,EAAkB;MAChB;IACD;;IACD,MAAMqW,OAAN;;IACA,IAAI,KAAKrlB,GAAL,KAAa,IAAjB,EAAuB;MACrB;IACD;;IACD,IAAI,CAAC,KAAKkrB,eAAV,EAA2B;MACzB,KAAKlc,MAAL,CAAYtB,GAAZ,CAAgB,IAAhB;IACD;EACF;;EACDmlB,cAAc,GAAG;IACf,IAAI,KAAKtJ,YAAL,EAAJ,EAAyB;MACvB;IACD;;IACD,KAAKva,MAAL,CAAYyR,eAAZ,CAA4B,KAA5B;IACA,KAAKzR,MAAL,CAAY8S,aAAZ,CAA0BhkC,oBAAoB,CAACsE,QAA/C;IACA,MAAMywC,cAAN;IACA,KAAK8rD,UAAL,CAAgBlxE,SAAhB,CAA0B5L,MAA1B,CAAiC,SAAjC;IACA,KAAKy8E,SAAL,CAAeM,eAAf,GAAiC,IAAjC;IACA,KAAKtyD,YAAL,GAAoB,KAApB;IACA,KAAKtsB,GAAL,CAASuoE,eAAT,CAAyB,uBAAzB;IACA,KAAK,CAACsV,UAAN,GAAmB,IAAIzpE,eAAJ,EAAnB;;IACA,MAAM5H,MAAM,GAAG,KAAKC,UAAL,CAAgBkN,cAAhB,CAA+B,KAAK,CAACkkE,UAArC,CAAf;;IACA,KAAKS,SAAL,CAAe3xE,gBAAf,CAAgC,SAAhC,EAA2C,KAAKkyE,gBAAL,CAAsBn8E,IAAtB,CAA2B,IAA3B,CAA3C,EAA6E;MAC3E8J;IAD2E,CAA7E;IAGA,KAAK8xE,SAAL,CAAe3xE,gBAAf,CAAgC,OAAhC,EAAyC,KAAKmyE,cAAL,CAAoBp8E,IAApB,CAAyB,IAAzB,CAAzC,EAAyE;MACvE8J;IADuE,CAAzE;IAGA,KAAK8xE,SAAL,CAAe3xE,gBAAf,CAAgC,MAAhC,EAAwC,KAAKoyE,aAAL,CAAmBr8E,IAAnB,CAAwB,IAAxB,CAAxC,EAAuE;MACrE8J;IADqE,CAAvE;IAGA,KAAK8xE,SAAL,CAAe3xE,gBAAf,CAAgC,OAAhC,EAAyC,KAAKqyE,cAAL,CAAoBt8E,IAApB,CAAyB,IAAzB,CAAzC,EAAyE;MACvE8J;IADuE,CAAzE;IAGA,KAAK8xE,SAAL,CAAe3xE,gBAAf,CAAgC,OAAhC,EAAyC,KAAKsyE,cAAL,CAAoBv8E,IAApB,CAAyB,IAAzB,CAAzC,EAAyE;MACvE8J;IADuE,CAAzE;EAGD;;EACDsmB,eAAe,GAAG;IAChB,IAAI,CAAC,KAAKvJ,YAAL,EAAL,EAA0B;MACxB;IACD;;IACD,KAAKva,MAAL,CAAYyR,eAAZ,CAA4B,IAA5B;IACA,MAAMqS,eAAN;IACA,KAAK6rD,UAAL,CAAgBlxE,SAAhB,CAA0BC,GAA1B,CAA8B,SAA9B;IACA,KAAK4wE,SAAL,CAAeM,eAAf,GAAiC,KAAjC;IACA,KAAK5+E,GAAL,CAAShB,YAAT,CAAsB,uBAAtB,EAA+C,KAAK,CAAC4+E,WAArD;IACA,KAAKtxD,YAAL,GAAoB,IAApB;IACA,KAAK,CAACuxD,UAAN,EAAkBtkE,KAAlB;IACA,KAAK,CAACskE,UAAN,GAAmB,IAAnB;IACA,KAAK79E,GAAL,CAASkb,KAAT,CAAe;MACbgZ,aAAa,EAAE;IADF,CAAf;IAGA,KAAK1d,SAAL,GAAiB,KAAjB;IACA,KAAKxH,MAAL,CAAYhP,GAAZ,CAAgByN,SAAhB,CAA0BC,GAA1B,CAA8B,iBAA9B;EACD;;EACDof,OAAO,CAAC9Z,KAAD,EAAQ;IACb,IAAI,CAAC,KAAK7F,mBAAV,EAA+B;MAC7B;IACD;;IACD,MAAM2f,OAAN,CAAc9Z,KAAd;;IACA,IAAIA,KAAK,CAAC2E,MAAN,KAAiB,KAAK2mE,SAA1B,EAAqC;MACnC,KAAKA,SAAL,CAAepjE,KAAf;IACD;EACF;;EACD0X,SAAS,GAAG;IACV,IAAI,KAAKl1B,KAAT,EAAgB;MACd;IACD;;IACD,KAAKm1B,cAAL;IACA,KAAKyrD,SAAL,CAAepjE,KAAf;;IACA,IAAI,KAAK4O,eAAL,EAAsBc,UAA1B,EAAsC;MACpC,KAAK2B,MAAL;IACD;;IACD,KAAKzC,eAAL,GAAuB,IAAvB;EACD;;EACDrT,OAAO,GAAG;IACR,OAAO,CAAC,KAAK6nE,SAAN,IAAmB,KAAKA,SAAL,CAAe31D,SAAf,CAAyB9gB,IAAzB,OAAoC,EAA9D;EACD;;EACDhG,MAAM,GAAG;IACP,KAAK2U,SAAL,GAAiB,KAAjB;;IACA,IAAI,KAAKxH,MAAT,EAAiB;MACf,KAAKA,MAAL,CAAYyR,eAAZ,CAA4B,IAA5B;MACA,KAAKzR,MAAL,CAAYhP,GAAZ,CAAgByN,SAAhB,CAA0BC,GAA1B,CAA8B,iBAA9B;IACD;;IACD,MAAM7L,MAAN;EACD;;EACD,CAACq9E,WAAW,GAAG;IACb,MAAM5qF,MAAM,GAAG,EAAf;IACA,KAAKgqF,SAAL,CAAe9iF,SAAf;;IACA,KAAK,MAAM+sB,KAAX,IAAoB,KAAK+1D,SAAL,CAAe91D,UAAnC,EAA+C;MAC7Cl0B,MAAM,CAAChB,IAAP,CAAYqqF,cAAc,CAAC,CAACwB,cAAhB,CAA+B52D,KAA/B,CAAZ;IACD;;IACD,OAAOj0B,MAAM,CAACf,IAAP,CAAY,IAAZ,CAAP;EACD;;EACD,CAACgrF,mBAAmB,GAAG;IACrB,MAAM,CAACx4D,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,IAAIxzB,IAAJ;;IACA,IAAI,KAAKyzB,eAAT,EAA0B;MACxBzzB,IAAI,GAAG,KAAKuI,GAAL,CAASsb,qBAAT,EAAP;IACD,CAFD,MAEO;MACL,MAAM;QACJe,YADI;QAEJrc;MAFI,IAGF,IAHJ;MAIA,MAAMo/E,YAAY,GAAGp/E,GAAG,CAACC,KAAJ,CAAUkvE,OAA/B;MACA,MAAMkQ,eAAe,GAAGr/E,GAAG,CAACyN,SAAJ,CAAc4J,QAAd,CAAuB,QAAvB,CAAxB;MACArX,GAAG,CAACyN,SAAJ,CAAc5L,MAAd,CAAqB,QAArB;MACA7B,GAAG,CAACC,KAAJ,CAAUkvE,OAAV,GAAoB,QAApB;MACA9yD,YAAY,CAACrc,GAAb,CAAiBS,MAAjB,CAAwB,KAAKT,GAA7B;MACAvI,IAAI,GAAGuI,GAAG,CAACsb,qBAAJ,EAAP;MACAtb,GAAG,CAAC6B,MAAJ;MACA7B,GAAG,CAACC,KAAJ,CAAUkvE,OAAV,GAAoBiQ,YAApB;MACAp/E,GAAG,CAACyN,SAAJ,CAAc+N,MAAd,CAAqB,QAArB,EAA+B6jE,eAA/B;IACD;;IACD,IAAI,KAAKh5E,QAAL,GAAgB,GAAhB,KAAwB,KAAKmmB,cAAL,GAAsB,GAAlD,EAAuD;MACrD,KAAK9uB,KAAL,GAAajG,IAAI,CAACiG,KAAL,GAAaqoB,WAA1B;MACA,KAAKpoB,MAAL,GAAclG,IAAI,CAACkG,MAAL,GAAcqoB,YAA5B;IACD,CAHD,MAGO;MACL,KAAKtoB,KAAL,GAAajG,IAAI,CAACkG,MAAL,GAAcooB,WAA3B;MACA,KAAKpoB,MAAL,GAAclG,IAAI,CAACiG,KAAL,GAAasoB,YAA3B;IACD;;IACD,KAAKyG,iBAAL;EACD;;EACDzI,MAAM,GAAG;IACP,IAAI,CAAC,KAAKuF,YAAL,EAAL,EAA0B;MACxB;IACD;;IACD,MAAMvF,MAAN;IACA,KAAK8O,eAAL;IACA,MAAMwsD,SAAS,GAAG,KAAK,CAAC5qD,OAAxB;IACA,MAAM6qD,OAAO,GAAG,KAAK,CAAC7qD,OAAN,GAAgB,KAAK,CAACwqD,WAAN,GAAoBM,OAApB,EAAhC;;IACA,IAAIF,SAAS,KAAKC,OAAlB,EAA2B;MACzB;IACD;;IACD,MAAME,OAAO,GAAG16E,IAAI,IAAI;MACtB,KAAK,CAAC2vB,OAAN,GAAgB3vB,IAAhB;;MACA,IAAI,CAACA,IAAL,EAAW;QACT,KAAKlD,MAAL;QACA;MACD;;MACD,KAAK,CAAC69E,UAAN;;MACA,KAAKjzE,UAAL,CAAgB4Y,OAAhB,CAAwB,IAAxB;;MACA,KAAK,CAACk5D,mBAAN;IACD,CATD;;IAUA,KAAKr+D,WAAL,CAAiB;MACftO,GAAG,EAAE,MAAM;QACT6tE,OAAO,CAACF,OAAD,CAAP;MACD,CAHc;MAIf1tE,IAAI,EAAE,MAAM;QACV4tE,OAAO,CAACH,SAAD,CAAP;MACD,CANc;MAOfvtE,QAAQ,EAAE;IAPK,CAAjB;IASA,KAAK,CAACwsE,mBAAN;EACD;;EACD/4D,uBAAuB,GAAG;IACxB,OAAO,KAAK+D,YAAL,EAAP;EACD;;EACD5H,eAAe,GAAG;IAChB,KAAKkR,cAAL;IACA,KAAKyrD,SAAL,CAAepjE,KAAf;EACD;;EACDykE,QAAQ,CAAC3sE,KAAD,EAAQ;IACd,KAAK2O,eAAL;EACD;;EACDxD,OAAO,CAACnL,KAAD,EAAQ;IACb,IAAIA,KAAK,CAAC2E,MAAN,KAAiB,KAAK3X,GAAtB,IAA6BgT,KAAK,CAACn2B,GAAN,KAAc,OAA/C,EAAwD;MACtD,KAAK8kC,eAAL;MACA3O,KAAK,CAAC9J,cAAN;IACD;EACF;;EACD21E,gBAAgB,CAAC7rE,KAAD,EAAQ;IACtB2qE,cAAc,CAACzmE,gBAAf,CAAgC5O,IAAhC,CAAqC,IAArC,EAA2C0K,KAA3C;EACD;;EACD8rE,cAAc,CAAC9rE,KAAD,EAAQ;IACpB,KAAKwD,SAAL,GAAiB,IAAjB;EACD;;EACDuoE,aAAa,CAAC/rE,KAAD,EAAQ;IACnB,KAAKwD,SAAL,GAAiB,KAAjB;EACD;;EACDwoE,cAAc,CAAChsE,KAAD,EAAQ;IACpB,KAAKhE,MAAL,CAAYhP,GAAZ,CAAgByN,SAAhB,CAA0B+N,MAA1B,CAAiC,iBAAjC,EAAoD,KAAK/E,OAAL,EAApD;EACD;;EACD0d,cAAc,GAAG;IACf,KAAKmqD,SAAL,CAAet/E,YAAf,CAA4B,MAA5B,EAAoC,SAApC;IACA,KAAKs/E,SAAL,CAAe/V,eAAf,CAA+B,gBAA/B;EACD;;EACDn0C,aAAa,GAAG;IACd,KAAKkqD,SAAL,CAAet/E,YAAf,CAA4B,MAA5B,EAAoC,SAApC;IACA,KAAKs/E,SAAL,CAAet/E,YAAf,CAA4B,gBAA5B,EAA8C,IAA9C;EACD;;EACDqN,MAAM,GAAG;IACP,IAAI,KAAKrM,GAAT,EAAc;MACZ,OAAO,KAAKA,GAAZ;IACD;;IACD,IAAI4/E,KAAJ,EAAWC,KAAX;;IACA,IAAI,KAAKniF,KAAT,EAAgB;MACdkiF,KAAK,GAAG,KAAK9mF,CAAb;MACA+mF,KAAK,GAAG,KAAK9mF,CAAb;IACD;;IACD,MAAMsT,MAAN;IACA,KAAKiyE,SAAL,GAAiB7+E,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAjB;IACA,KAAKq/E,SAAL,CAAe/xE,SAAf,GAA2B,UAA3B;IACA,KAAK+xE,SAAL,CAAet/E,YAAf,CAA4B,IAA5B,EAAkC,KAAK,CAAC4+E,WAAxC;IACA,KAAKU,SAAL,CAAet/E,YAAf,CAA4B,cAA5B,EAA4C,iBAA5C;IACA,KAAKo1B,aAAL;;IACAvL,gBAAgB,CAACzB,YAAjB,CAA8BlqC,GAA9B,CAAkC,iCAAlC,EAAqE2oB,IAArE,CAA0E1V,GAAG,IAAI,KAAKmuF,SAAL,EAAgBt/E,YAAhB,CAA6B,iBAA7B,EAAgD7O,GAAhD,CAAjF;;IACA,KAAKmuF,SAAL,CAAeM,eAAf,GAAiC,IAAjC;IACA,MAAM;MACJ3+E;IADI,IAEF,KAAKq+E,SAFT;IAGAr+E,KAAK,CAAC+sC,QAAN,GAAkB,QAAO,KAAK,CAACA,QAAS,2BAAxC;IACA/sC,KAAK,CAACgC,KAAN,GAAc,KAAK,CAACA,KAApB;IACA,KAAKjC,GAAL,CAASS,MAAT,CAAgB,KAAK69E,SAArB;IACA,KAAKK,UAAL,GAAkBl/E,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAlB;IACA,KAAK0/E,UAAL,CAAgBlxE,SAAhB,CAA0BC,GAA1B,CAA8B,SAA9B,EAAyC,SAAzC;IACA,KAAK1N,GAAL,CAASS,MAAT,CAAgB,KAAKk+E,UAArB;IACAzvE,UAAU,CAAC,IAAD,EAAO,KAAKlP,GAAZ,EAAiB,CAAC,UAAD,EAAa,SAAb,CAAjB,CAAV;;IACA,IAAI,KAAKtC,KAAT,EAAgB;MACd,MAAM,CAACqoB,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;;MACA,IAAI,KAAKxJ,mBAAT,EAA8B;QAC5B,MAAM;UACJrhB;QADI,IAEF,KAAK,CAAC8lD,WAFV;QAGA,IAAI,CAAChhC,EAAD,EAAKC,EAAL,IAAW,KAAKwJ,qBAAL,EAAf;QACA,CAACzJ,EAAD,EAAKC,EAAL,IAAW,KAAK8I,uBAAL,CAA6B/I,EAA7B,EAAiCC,EAAjC,CAAX;QACA,MAAM,CAACje,SAAD,EAAYC,UAAZ,IAA0B,KAAK4jB,cAArC;QACA,MAAM,CAAC3jB,KAAD,EAAQC,KAAR,IAAiB,KAAK2jB,eAA5B;QACA,IAAI80D,IAAJ,EAAUC,IAAV;;QACA,QAAQ,KAAK15E,QAAb;UACE,KAAK,CAAL;YACEy5E,IAAI,GAAGF,KAAK,GAAG,CAACx/E,QAAQ,CAAC,CAAD,CAAR,GAAcgH,KAAf,IAAwBF,SAAvC;YACA64E,IAAI,GAAGF,KAAK,GAAG,KAAKliF,MAAb,GAAsB,CAACyC,QAAQ,CAAC,CAAD,CAAR,GAAciH,KAAf,IAAwBF,UAArD;YACA;;UACF,KAAK,EAAL;YACE24E,IAAI,GAAGF,KAAK,GAAG,CAACx/E,QAAQ,CAAC,CAAD,CAAR,GAAcgH,KAAf,IAAwBF,SAAvC;YACA64E,IAAI,GAAGF,KAAK,GAAG,CAACz/E,QAAQ,CAAC,CAAD,CAAR,GAAciH,KAAf,IAAwBF,UAAvC;YACA,CAAC+d,EAAD,EAAKC,EAAL,IAAW,CAACA,EAAD,EAAK,CAACD,EAAN,CAAX;YACA;;UACF,KAAK,GAAL;YACE46D,IAAI,GAAGF,KAAK,GAAG,KAAKliF,KAAb,GAAqB,CAAC0C,QAAQ,CAAC,CAAD,CAAR,GAAcgH,KAAf,IAAwBF,SAApD;YACA64E,IAAI,GAAGF,KAAK,GAAG,CAACz/E,QAAQ,CAAC,CAAD,CAAR,GAAciH,KAAf,IAAwBF,UAAvC;YACA,CAAC+d,EAAD,EAAKC,EAAL,IAAW,CAAC,CAACD,EAAF,EAAM,CAACC,EAAP,CAAX;YACA;;UACF,KAAK,GAAL;YACE26D,IAAI,GAAGF,KAAK,GAAG,CAACx/E,QAAQ,CAAC,CAAD,CAAR,GAAcgH,KAAd,GAAsB,KAAKzJ,MAAL,GAAcwJ,UAArC,IAAmDD,SAAlE;YACA64E,IAAI,GAAGF,KAAK,GAAG,CAACz/E,QAAQ,CAAC,CAAD,CAAR,GAAciH,KAAd,GAAsB,KAAK3J,KAAL,GAAawJ,SAApC,IAAiDC,UAAhE;YACA,CAAC+d,EAAD,EAAKC,EAAL,IAAW,CAAC,CAACA,EAAF,EAAMD,EAAN,CAAX;YACA;QAnBJ;;QAqBA,KAAKgI,KAAL,CAAW4yD,IAAI,GAAG/5D,WAAlB,EAA+Bg6D,IAAI,GAAG/5D,YAAtC,EAAoDd,EAApD,EAAwDC,EAAxD;MACD,CA/BD,MA+BO;QACL,KAAK+H,KAAL,CAAW0yD,KAAK,GAAG75D,WAAnB,EAAgC85D,KAAK,GAAG75D,YAAxC,EAAsD,KAAKtoB,KAAL,GAAaqoB,WAAnE,EAAgF,KAAKpoB,MAAL,GAAcqoB,YAA9F;MACD;;MACD,KAAK,CAAC05D,UAAN;MACA,KAAKpzD,YAAL,GAAoB,IAApB;MACA,KAAKgyD,SAAL,CAAeM,eAAf,GAAiC,KAAjC;IACD,CAvCD,MAuCO;MACL,KAAKtyD,YAAL,GAAoB,KAApB;MACA,KAAKgyD,SAAL,CAAeM,eAAf,GAAiC,IAAjC;IACD;;IACD,OAAO,KAAK5+E,GAAZ;EACD;;EACqB,OAAf,CAACm/E,cAAc,CAACvpB,IAAD,EAAO;IAC3B,OAAO,CAACA,IAAI,CAAC75C,QAAL,KAAkBC,IAAI,CAACC,SAAvB,GAAmC25C,IAAI,CAACoqB,SAAxC,GAAoDpqB,IAAI,CAACjtC,SAA1D,EAAqE7uB,UAArE,CAAgF4jF,WAAhF,EAA6F,EAA7F,CAAP;EACD;;EACDuB,cAAc,CAACjsE,KAAD,EAAQ;IACpB,MAAMsM,aAAa,GAAGtM,KAAK,CAACsM,aAAN,IAAuB5U,MAAM,CAAC4U,aAApD;IACA,MAAM;MACJqB;IADI,IAEFrB,aAFJ;;IAGA,IAAIqB,KAAK,CAACvvB,MAAN,KAAiB,CAAjB,IAAsBuvB,KAAK,CAAC,CAAD,CAAL,KAAa,YAAvC,EAAqD;MACnD;IACD;;IACD3N,KAAK,CAAC9J,cAAN;IACA,MAAMuV,KAAK,GAAGk/D,cAAc,CAAC,CAACsC,kBAAhB,CAAmC3gE,aAAa,CAACI,OAAd,CAAsB,MAAtB,KAAiC,EAApE,EAAwE5lB,UAAxE,CAAmF4jF,WAAnF,EAAgG,IAAhG,CAAd;;IACA,IAAI,CAACj/D,KAAL,EAAY;MACV;IACD;;IACD,MAAMjC,SAAS,GAAG9R,MAAM,CAAC+R,YAAP,EAAlB;;IACA,IAAI,CAACD,SAAS,CAACoJ,UAAf,EAA2B;MACzB;IACD;;IACD,KAAK04D,SAAL,CAAe9iF,SAAf;IACAghB,SAAS,CAAC0jE,kBAAV;IACA,MAAM/5D,KAAK,GAAG3J,SAAS,CAACqJ,UAAV,CAAqB,CAArB,CAAd;;IACA,IAAI,CAACpH,KAAK,CAAC3pB,QAAN,CAAe,IAAf,CAAL,EAA2B;MACzBqxB,KAAK,CAACg6D,UAAN,CAAiB1gF,QAAQ,CAAC+pE,cAAT,CAAwB/qD,KAAxB,CAAjB;MACA,KAAK6/D,SAAL,CAAe9iF,SAAf;MACAghB,SAAS,CAAC4jE,eAAV;MACA;IACD;;IACD,MAAM;MACJC,cADI;MAEJC;IAFI,IAGFn6D,KAHJ;IAIA,MAAMo6D,YAAY,GAAG,EAArB;IACA,MAAMC,WAAW,GAAG,EAApB;;IACA,IAAIH,cAAc,CAACtkE,QAAf,KAA4BC,IAAI,CAACC,SAArC,EAAgD;MAC9C,MAAMjN,MAAM,GAAGqxE,cAAc,CAACnkE,aAA9B;MACAskE,WAAW,CAACltF,IAAZ,CAAiB+sF,cAAc,CAACL,SAAf,CAAyBtpF,KAAzB,CAA+B4pF,WAA/B,EAA4CxmF,UAA5C,CAAuD4jF,WAAvD,EAAoE,EAApE,CAAjB;;MACA,IAAI1uE,MAAM,KAAK,KAAKsvE,SAApB,EAA+B;QAC7B,IAAIhqF,MAAM,GAAGisF,YAAb;;QACA,KAAK,MAAMh4D,KAAX,IAAoB,KAAK+1D,SAAL,CAAe91D,UAAnC,EAA+C;UAC7C,IAAID,KAAK,KAAKvZ,MAAd,EAAsB;YACpB1a,MAAM,GAAGksF,WAAT;YACA;UACD;;UACDlsF,MAAM,CAAChB,IAAP,CAAYqqF,cAAc,CAAC,CAACwB,cAAhB,CAA+B52D,KAA/B,CAAZ;QACD;MACF;;MACDg4D,YAAY,CAACjtF,IAAb,CAAkB+sF,cAAc,CAACL,SAAf,CAAyBtpF,KAAzB,CAA+B,CAA/B,EAAkC4pF,WAAlC,EAA+CxmF,UAA/C,CAA0D4jF,WAA1D,EAAuE,EAAvE,CAAlB;IACD,CAdD,MAcO,IAAI2C,cAAc,KAAK,KAAK/B,SAA5B,EAAuC;MAC5C,IAAIhqF,MAAM,GAAGisF,YAAb;MACA,IAAIvtF,CAAC,GAAG,CAAR;;MACA,KAAK,MAAMu1B,KAAX,IAAoB,KAAK+1D,SAAL,CAAe91D,UAAnC,EAA+C;QAC7C,IAAIx1B,CAAC,OAAOstF,WAAZ,EAAyB;UACvBhsF,MAAM,GAAGksF,WAAT;QACD;;QACDlsF,MAAM,CAAChB,IAAP,CAAYqqF,cAAc,CAAC,CAACwB,cAAhB,CAA+B52D,KAA/B,CAAZ;MACD;IACF;;IACD,KAAK,CAACmM,OAAN,GAAiB,GAAE6rD,YAAY,CAAChtF,IAAb,CAAkB,IAAlB,CAAwB,GAAEkrB,KAAM,GAAE+hE,WAAW,CAACjtF,IAAZ,CAAiB,IAAjB,CAAuB,EAA5E;IACA,KAAK,CAACmsF,UAAN;IACA,MAAMe,QAAQ,GAAG,IAAIrvB,KAAJ,EAAjB;IACA,IAAIsvB,YAAY,GAAGH,YAAY,CAACI,MAAb,CAAoB,CAACC,GAAD,EAAM1F,IAAN,KAAe0F,GAAG,GAAG1F,IAAI,CAAC9pF,MAA9C,EAAsD,CAAtD,CAAnB;;IACA,KAAK,MAAM;MACTyiC;IADS,CAAX,IAEK,KAAKyqD,SAAL,CAAe91D,UAFpB,EAEgC;MAC9B,IAAIqL,UAAU,CAAC9X,QAAX,KAAwBC,IAAI,CAACC,SAAjC,EAA4C;QAC1C,MAAM7qB,MAAM,GAAGyiC,UAAU,CAACmsD,SAAX,CAAqB5uF,MAApC;;QACA,IAAIsvF,YAAY,IAAItvF,MAApB,EAA4B;UAC1BqvF,QAAQ,CAACI,QAAT,CAAkBhtD,UAAlB,EAA8B6sD,YAA9B;UACAD,QAAQ,CAACK,MAAT,CAAgBjtD,UAAhB,EAA4B6sD,YAA5B;UACA;QACD;;QACDA,YAAY,IAAItvF,MAAhB;MACD;IACF;;IACDorB,SAAS,CAACukE,eAAV;IACAvkE,SAAS,CAACwkE,QAAV,CAAmBP,QAAnB;EACD;;EACD,CAACf,UAAU,GAAG;IACZ,KAAKpB,SAAL,CAAe2C,eAAf;;IACA,IAAI,CAAC,KAAK,CAACvsD,OAAX,EAAoB;MAClB;IACD;;IACD,KAAK,MAAMwmD,IAAX,IAAmB,KAAK,CAACxmD,OAAN,CAAcrzB,KAAd,CAAoB,IAApB,CAAnB,EAA8C;MAC5C,MAAMrB,GAAG,GAAGP,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAZ;MACAe,GAAG,CAACS,MAAJ,CAAWy6E,IAAI,GAAGz7E,QAAQ,CAAC+pE,cAAT,CAAwB0R,IAAxB,CAAH,GAAmCz7E,QAAQ,CAACR,aAAT,CAAuB,IAAvB,CAAlD;MACA,KAAKq/E,SAAL,CAAe79E,MAAf,CAAsBT,GAAtB;IACD;EACF;;EACD,CAACkhF,gBAAgB,GAAG;IAClB,OAAO,KAAK,CAACxsD,OAAN,CAAc56B,UAAd,CAAyB,MAAzB,EAAiC,GAAjC,CAAP;EACD;;EACyB,OAAnB,CAACmmF,kBAAkB,CAACvrD,OAAD,EAAU;IAClC,OAAOA,OAAO,CAAC56B,UAAR,CAAmB,GAAnB,EAAwB,MAAxB,CAAP;EACD;;EACa,IAAVu6B,UAAU,GAAG;IACf,OAAO,KAAKiqD,SAAZ;EACD;;EACiB,OAAXv+D,WAAW,CAACja,IAAD,EAAOkJ,MAAP,EAAeR,SAAf,EAA0B;IAC1C,IAAI03C,WAAW,GAAG,IAAlB;;IACA,IAAIpgD,IAAI,YAAYmlE,yBAApB,EAA+C;MAC7C,MAAM;QACJnlE,IAAI,EAAE;UACJyvE,qBAAqB,EAAE;YACrBvoC,QADqB;YAErBsoC;UAFqB,CADnB;UAKJ79E,IALI;UAMJ4O,QANI;UAOJ1G;QAPI,CADF;QAUJ4nB,WAVI;QAWJm0D,YAXI;QAYJ1sE,MAAM,EAAE;UACN40D,IAAI,EAAE;YACJ5oD;UADI;QADA;MAZJ,IAiBFlV,IAjBJ;;MAkBA,IAAI,CAACyhB,WAAD,IAAgBA,WAAW,CAACn2B,MAAZ,KAAuB,CAA3C,EAA8C;QAC5C,OAAO,IAAP;MACD;;MACD80D,WAAW,GAAGpgD,IAAI,GAAG;QACnBqkE,cAAc,EAAErsF,oBAAoB,CAACsE,QADlB;QAEnB6f,KAAK,EAAE9M,KAAK,CAACC,IAAN,CAAWkgF,SAAX,CAFY;QAGnBtoC,QAHmB;QAInBv7C,KAAK,EAAE81B,WAAW,CAACh0B,IAAZ,CAAiB,IAAjB,CAJY;QAKnB6M,QAAQ,EAAEs7E,YALS;QAMnB36D,SAAS,EAAE/F,UAAU,GAAG,CANL;QAOnBvjB,IAAI,EAAEA,IAAI,CAACf,KAAL,CAAW,CAAX,CAPa;QAQnB2P,QARmB;QASnB1G,EATmB;QAUnBsjB,OAAO,EAAE;MAVU,CAArB;IAYD;;IACD,MAAMrX,MAAM,GAAG,MAAMmU,WAAN,CAAkBja,IAAlB,EAAwBkJ,MAAxB,EAAgCR,SAAhC,CAAf;IACA5C,MAAM,CAAC,CAACohC,QAAR,GAAmBlnC,IAAI,CAACknC,QAAxB;IACAphC,MAAM,CAAC,CAAC3J,KAAR,GAAgB1iB,IAAI,CAACiW,YAAL,CAAkB,GAAGsQ,IAAI,CAAC7D,KAA1B,CAAhB;IACA2J,MAAM,CAAC,CAAC8oB,OAAR,GAAkBipD,cAAc,CAAC,CAACsC,kBAAhB,CAAmCn6E,IAAI,CAACrU,KAAxC,CAAlB;IACAma,MAAM,CAAC6V,mBAAP,GAA6B3b,IAAI,CAACnG,EAAL,IAAW,IAAxC;IACAiM,MAAM,CAAC,CAACs6C,WAAR,GAAsBA,WAAtB;IACA,OAAOt6C,MAAP;EACD;;EACDmH,SAAS,CAACmV,YAAY,GAAG,KAAhB,EAAuB;IAC9B,IAAI,KAAKzR,OAAL,EAAJ,EAAoB;MAClB,OAAO,IAAP;IACD;;IACD,IAAI,KAAKwM,OAAT,EAAkB;MAChB,OAAO;QACLlC,SAAS,EAAE,KAAKA,SADX;QAELphB,EAAE,EAAE,KAAK8hB,mBAFJ;QAGLwB,OAAO,EAAE;MAHJ,CAAP;IAKD;;IACD,MAAMk+D,OAAO,GAAGxD,cAAc,CAACI,gBAAf,GAAkC,KAAK5vD,WAAvD;IACA,MAAM12B,IAAI,GAAG,KAAK+6B,OAAL,CAAa2uD,OAAb,EAAsBA,OAAtB,CAAb;;IACA,MAAMl/E,KAAK,GAAG4mB,gBAAgB,CAACuB,aAAjB,CAA+BvW,OAA/B,CAAuC,KAAKqX,eAAL,GAAuB9mB,gBAAgB,CAAC,KAAKk6E,SAAN,CAAhB,CAAiCr8E,KAAxD,GAAgE,KAAK,CAACA,KAA7G,CAAd;;IACA,MAAMod,UAAU,GAAG;MACjB8qD,cAAc,EAAErsF,oBAAoB,CAACsE,QADpB;MAEjB6f,KAFiB;MAGjB+qC,QAAQ,EAAE,KAAK,CAACA,QAHC;MAIjBv7C,KAAK,EAAE,KAAK,CAACyvF,gBAAN,EAJU;MAKjBngE,SAAS,EAAE,KAAKA,SALC;MAMjBtpB,IANiB;MAOjB4O,QAAQ,EAAE,KAAKA,QAPE;MAQjB+6E,kBAAkB,EAAE,KAAKv2D;IARR,CAAnB;;IAUA,IAAI3C,YAAJ,EAAkB;MAChB,OAAO7I,UAAP;IACD;;IACD,IAAI,KAAKoC,mBAAL,IAA4B,CAAC,KAAK,CAAC4/D,iBAAN,CAAwBhiE,UAAxB,CAAjC,EAAsE;MACpE,OAAO,IAAP;IACD;;IACDA,UAAU,CAAC1f,EAAX,GAAgB,KAAK8hB,mBAArB;IACA,OAAOpC,UAAP;EACD;;EACD,CAACgiE,iBAAiB,CAAChiE,UAAD,EAAa;IAC7B,MAAM;MACJ5tB,KADI;MAEJu7C,QAFI;MAGJ/qC,KAHI;MAIJ8e;IAJI,IAKF,KAAK,CAACmlC,WALV;IAMA,OAAO,KAAKt4B,aAAL,IAAsBvO,UAAU,CAAC5tB,KAAX,KAAqBA,KAA3C,IAAoD4tB,UAAU,CAAC2tB,QAAX,KAAwBA,QAA5E,IAAwF3tB,UAAU,CAACpd,KAAX,CAAiBqe,IAAjB,CAAsB,CAACppB,CAAD,EAAIlE,CAAJ,KAAUkE,CAAC,KAAK+K,KAAK,CAACjP,CAAD,CAA3C,CAAxF,IAA2IqsB,UAAU,CAAC0B,SAAX,KAAyBA,SAA3K;EACD;;EACDuF,uBAAuB,CAACC,UAAD,EAAa;IAClC,MAAMmO,OAAO,GAAG,MAAMpO,uBAAN,CAA8BC,UAA9B,CAAhB;;IACA,IAAI,KAAKtD,OAAT,EAAkB;MAChB,OAAOyR,OAAP;IACD;;IACD,MAAM;MACJz0B;IADI,IAEFy0B,OAFJ;IAGAz0B,KAAK,CAAC+sC,QAAN,GAAkB,QAAO,KAAK,CAACA,QAAS,2BAAxC;IACA/sC,KAAK,CAACgC,KAAN,GAAc,KAAK,CAACA,KAApB;IACAyyB,OAAO,CAACusD,eAAR;;IACA,KAAK,MAAM/F,IAAX,IAAmB,KAAK,CAACxmD,OAAN,CAAcrzB,KAAd,CAAoB,IAApB,CAAnB,EAA8C;MAC5C,MAAMrB,GAAG,GAAGP,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAZ;MACAe,GAAG,CAACS,MAAJ,CAAWy6E,IAAI,GAAGz7E,QAAQ,CAAC+pE,cAAT,CAAwB0R,IAAxB,CAAH,GAAmCz7E,QAAQ,CAACR,aAAT,CAAuB,IAAvB,CAAlD;MACAy1B,OAAO,CAACj0B,MAAR,CAAeT,GAAf;IACD;;IACD,MAAMmhF,OAAO,GAAGxD,cAAc,CAACI,gBAAf,GAAkC,KAAK5vD,WAAvD;IACA5H,UAAU,CAAC+mD,YAAX,CAAwB;MACtB71E,IAAI,EAAE,KAAK+6B,OAAL,CAAa2uD,OAAb,EAAsBA,OAAtB,CADgB;MAEtBnG,YAAY,EAAE,KAAK,CAACtmD;IAFE,CAAxB;IAIA,OAAOA,OAAP;EACD;;EACDG,sBAAsB,CAACtO,UAAD,EAAa;IACjC,MAAMsO,sBAAN,CAA6BtO,UAA7B;IACAA,UAAU,CAACknD,WAAX;EACD;;AA9lB2C;;AAimB9C,C,CAAC;;AAED,MAAM6T,QAAN,CAAe;EACb,CAACvyE,GAAD;EACA,CAACwyE,aAAD,GAAiB,EAAjB;EACA,CAACC,SAAD,GAAa,EAAb;;EACAvvF,WAAW,CAAC0c,KAAD,EAAQs/D,WAAW,GAAG,CAAtB,EAAyBwT,WAAW,GAAG,CAAvC,EAA0C7yE,KAAK,GAAG,IAAlD,EAAwD;IACjE,IAAI2/B,IAAI,GAAGS,QAAX;IACA,IAAIR,IAAI,GAAG,CAACQ,QAAZ;IACA,IAAIhN,IAAI,GAAGgN,QAAX;IACA,IAAI/M,IAAI,GAAG,CAAC+M,QAAZ;IACA,MAAM0yC,gBAAgB,GAAG,CAAzB;IACA,MAAMC,OAAO,GAAG,MAAM,CAACD,gBAAvB;;IACA,KAAK,MAAM;MACT5oF,CADS;MAETC,CAFS;MAGT2E,KAHS;MAITC;IAJS,CAAX,IAKKgR,KALL,EAKY;MACV,MAAMxW,EAAE,GAAGjF,IAAI,CAAC4I,KAAL,CAAW,CAAChD,CAAC,GAAGm1E,WAAL,IAAoB0T,OAA/B,IAA0CA,OAArD;MACA,MAAMvpF,EAAE,GAAGlF,IAAI,CAAC+sC,IAAL,CAAU,CAACnnC,CAAC,GAAG4E,KAAJ,GAAYuwE,WAAb,IAA4B0T,OAAtC,IAAiDA,OAA5D;MACA,MAAMppF,EAAE,GAAGrF,IAAI,CAAC4I,KAAL,CAAW,CAAC/C,CAAC,GAAGk1E,WAAL,IAAoB0T,OAA/B,IAA0CA,OAArD;MACA,MAAMnpF,EAAE,GAAGtF,IAAI,CAAC+sC,IAAL,CAAU,CAAClnC,CAAC,GAAG4E,MAAJ,GAAaswE,WAAd,IAA6B0T,OAAvC,IAAkDA,OAA7D;MACA,MAAMrhF,IAAI,GAAG,CAACnI,EAAD,EAAKI,EAAL,EAASC,EAAT,EAAa,IAAb,CAAb;MACA,MAAMopF,KAAK,GAAG,CAACxpF,EAAD,EAAKG,EAAL,EAASC,EAAT,EAAa,KAAb,CAAd;MACA,KAAK,CAAC+oF,aAAN,CAAoBjuF,IAApB,CAAyBgN,IAAzB,EAA+BshF,KAA/B;MACArzC,IAAI,GAAGr7C,IAAI,CAACC,GAAL,CAASo7C,IAAT,EAAep2C,EAAf,CAAP;MACAq2C,IAAI,GAAGt7C,IAAI,CAAC2D,GAAL,CAAS23C,IAAT,EAAep2C,EAAf,CAAP;MACA4pC,IAAI,GAAG9uC,IAAI,CAACC,GAAL,CAAS6uC,IAAT,EAAezpC,EAAf,CAAP;MACA0pC,IAAI,GAAG/uC,IAAI,CAAC2D,GAAL,CAASorC,IAAT,EAAezpC,EAAf,CAAP;IACD;;IACD,MAAM4tC,SAAS,GAAGoI,IAAI,GAAGD,IAAP,GAAc,IAAIkzC,WAApC;IACA,MAAMp7C,UAAU,GAAGpE,IAAI,GAAGD,IAAP,GAAc,IAAIy/C,WAArC;IACA,MAAMI,WAAW,GAAGtzC,IAAI,GAAGkzC,WAA3B;IACA,MAAMK,WAAW,GAAG9/C,IAAI,GAAGy/C,WAA3B;IACA,MAAMM,QAAQ,GAAG,KAAK,CAACR,aAAN,CAAoBzuE,EAApB,CAAuBlE,KAAK,GAAG,CAAC,CAAJ,GAAQ,CAAC,CAArC,CAAjB;IACA,MAAMozE,SAAS,GAAG,CAACD,QAAQ,CAAC,CAAD,CAAT,EAAcA,QAAQ,CAAC,CAAD,CAAtB,CAAlB;;IACA,KAAK,MAAME,IAAX,IAAmB,KAAK,CAACV,aAAzB,EAAwC;MACtC,MAAM,CAACzoF,CAAD,EAAIP,EAAJ,EAAQC,EAAR,IAAcypF,IAApB;MACAA,IAAI,CAAC,CAAD,CAAJ,GAAU,CAACnpF,CAAC,GAAG+oF,WAAL,IAAoBz7C,SAA9B;MACA67C,IAAI,CAAC,CAAD,CAAJ,GAAU,CAAC1pF,EAAE,GAAGupF,WAAN,IAAqBz7C,UAA/B;MACA47C,IAAI,CAAC,CAAD,CAAJ,GAAU,CAACzpF,EAAE,GAAGspF,WAAN,IAAqBz7C,UAA/B;IACD;;IACD,KAAK,CAACt3B,GAAN,GAAY;MACVjW,CAAC,EAAE+oF,WADO;MAEV9oF,CAAC,EAAE+oF,WAFO;MAGVpkF,KAAK,EAAE0oC,SAHG;MAIVzoC,MAAM,EAAE0oC,UAJE;MAKV27C;IALU,CAAZ;EAOD;;EACDE,WAAW,GAAG;IACZ,KAAK,CAACX,aAAN,CAAoBY,IAApB,CAAyB,CAAClrF,CAAD,EAAItB,CAAJ,KAAUsB,CAAC,CAAC,CAAD,CAAD,GAAOtB,CAAC,CAAC,CAAD,CAAR,IAAesB,CAAC,CAAC,CAAD,CAAD,GAAOtB,CAAC,CAAC,CAAD,CAAvB,IAA8BsB,CAAC,CAAC,CAAD,CAAD,GAAOtB,CAAC,CAAC,CAAD,CAAzE;IACA,MAAMysF,oBAAoB,GAAG,EAA7B;;IACA,KAAK,MAAMH,IAAX,IAAmB,KAAK,CAACV,aAAzB,EAAwC;MACtC,IAAIU,IAAI,CAAC,CAAD,CAAR,EAAa;QACXG,oBAAoB,CAAC9uF,IAArB,CAA0B,GAAG,KAAK,CAAC+uF,SAAN,CAAgBJ,IAAhB,CAA7B;QACA,KAAK,CAAC7mD,MAAN,CAAa6mD,IAAb;MACD,CAHD,MAGO;QACL,KAAK,CAACpgF,MAAN,CAAaogF,IAAb;QACAG,oBAAoB,CAAC9uF,IAArB,CAA0B,GAAG,KAAK,CAAC+uF,SAAN,CAAgBJ,IAAhB,CAA7B;MACD;IACF;;IACD,OAAO,KAAK,CAACC,WAAN,CAAkBE,oBAAlB,CAAP;EACD;;EACD,CAACF,WAAW,CAACE,oBAAD,EAAuB;IACjC,MAAME,KAAK,GAAG,EAAd;IACA,MAAMC,QAAQ,GAAG,IAAI5vE,GAAJ,EAAjB;;IACA,KAAK,MAAMsvE,IAAX,IAAmBG,oBAAnB,EAAyC;MACvC,MAAM,CAACtpF,CAAD,EAAIP,EAAJ,EAAQC,EAAR,IAAcypF,IAApB;MACAK,KAAK,CAAChvF,IAAN,CAAW,CAACwF,CAAD,EAAIP,EAAJ,EAAQ0pF,IAAR,CAAX,EAA0B,CAACnpF,CAAD,EAAIN,EAAJ,EAAQypF,IAAR,CAA1B;IACD;;IACDK,KAAK,CAACH,IAAN,CAAW,CAAClrF,CAAD,EAAItB,CAAJ,KAAUsB,CAAC,CAAC,CAAD,CAAD,GAAOtB,CAAC,CAAC,CAAD,CAAR,IAAesB,CAAC,CAAC,CAAD,CAAD,GAAOtB,CAAC,CAAC,CAAD,CAA5C;;IACA,KAAK,IAAI3C,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGsoF,KAAK,CAAClxF,MAA3B,EAAmC4B,CAAC,GAAGgH,EAAvC,EAA2ChH,CAAC,IAAI,CAAhD,EAAmD;MACjD,MAAMwvF,KAAK,GAAGF,KAAK,CAACtvF,CAAD,CAAL,CAAS,CAAT,CAAd;MACA,MAAMyvF,KAAK,GAAGH,KAAK,CAACtvF,CAAC,GAAG,CAAL,CAAL,CAAa,CAAb,CAAd;MACAwvF,KAAK,CAAClvF,IAAN,CAAWmvF,KAAX;MACAA,KAAK,CAACnvF,IAAN,CAAWkvF,KAAX;MACAD,QAAQ,CAAC70E,GAAT,CAAa80E,KAAb;MACAD,QAAQ,CAAC70E,GAAT,CAAa+0E,KAAb;IACD;;IACD,MAAMC,QAAQ,GAAG,EAAjB;IACA,IAAIC,OAAJ;;IACA,OAAOJ,QAAQ,CAAC/+E,IAAT,GAAgB,CAAvB,EAA0B;MACxB,MAAMy+E,IAAI,GAAGM,QAAQ,CAAC9oE,MAAT,GAAkBtH,IAAlB,GAAyB1gB,KAAtC;MACA,IAAI,CAACqH,CAAD,EAAIP,EAAJ,EAAQC,EAAR,EAAYgqF,KAAZ,EAAmBC,KAAnB,IAA4BR,IAAhC;MACAM,QAAQ,CAACt0E,MAAT,CAAgBg0E,IAAhB;MACA,IAAIW,UAAU,GAAG9pF,CAAjB;MACA,IAAI+pF,UAAU,GAAGtqF,EAAjB;MACAoqF,OAAO,GAAG,CAAC7pF,CAAD,EAAIN,EAAJ,CAAV;MACAkqF,QAAQ,CAACpvF,IAAT,CAAcqvF,OAAd;;MACA,OAAO,IAAP,EAAa;QACX,IAAI15E,CAAJ;;QACA,IAAIs5E,QAAQ,CAACjvE,GAAT,CAAakvE,KAAb,CAAJ,EAAyB;UACvBv5E,CAAC,GAAGu5E,KAAJ;QACD,CAFD,MAEO,IAAID,QAAQ,CAACjvE,GAAT,CAAamvE,KAAb,CAAJ,EAAyB;UAC9Bx5E,CAAC,GAAGw5E,KAAJ;QACD,CAFM,MAEA;UACL;QACD;;QACDF,QAAQ,CAACt0E,MAAT,CAAgBhF,CAAhB;QACA,CAACnQ,CAAD,EAAIP,EAAJ,EAAQC,EAAR,EAAYgqF,KAAZ,EAAmBC,KAAnB,IAA4Bx5E,CAA5B;;QACA,IAAI25E,UAAU,KAAK9pF,CAAnB,EAAsB;UACpB6pF,OAAO,CAACrvF,IAAR,CAAasvF,UAAb,EAAyBC,UAAzB,EAAqC/pF,CAArC,EAAwC+pF,UAAU,KAAKtqF,EAAf,GAAoBA,EAApB,GAAyBC,EAAjE;UACAoqF,UAAU,GAAG9pF,CAAb;QACD;;QACD+pF,UAAU,GAAGA,UAAU,KAAKtqF,EAAf,GAAoBC,EAApB,GAAyBD,EAAtC;MACD;;MACDoqF,OAAO,CAACrvF,IAAR,CAAasvF,UAAb,EAAyBC,UAAzB;IACD;;IACD,OAAO,IAAIC,gBAAJ,CAAqBJ,QAArB,EAA+B,KAAK,CAAC3zE,GAArC,CAAP;EACD;;EACD,CAACg0E,YAAY,CAAChqF,CAAD,EAAI;IACf,MAAMosD,KAAK,GAAG,KAAK,CAACq8B,SAApB;IACA,IAAIp/E,KAAK,GAAG,CAAZ;IACA,IAAIC,GAAG,GAAG8iD,KAAK,CAAC/zD,MAAN,GAAe,CAAzB;;IACA,OAAOgR,KAAK,IAAIC,GAAhB,EAAqB;MACnB,MAAM2gF,MAAM,GAAG5gF,KAAK,GAAGC,GAAR,IAAe,CAA9B;MACA,MAAM9J,EAAE,GAAG4sD,KAAK,CAAC69B,MAAD,CAAL,CAAc,CAAd,CAAX;;MACA,IAAIzqF,EAAE,KAAKQ,CAAX,EAAc;QACZ,OAAOiqF,MAAP;MACD;;MACD,IAAIzqF,EAAE,GAAGQ,CAAT,EAAY;QACVqJ,KAAK,GAAG4gF,MAAM,GAAG,CAAjB;MACD,CAFD,MAEO;QACL3gF,GAAG,GAAG2gF,MAAM,GAAG,CAAf;MACD;IACF;;IACD,OAAO3gF,GAAG,GAAG,CAAb;EACD;;EACD,CAAC+4B,MAAM,CAAC,GAAG7iC,EAAH,EAAOC,EAAP,CAAD,EAAa;IAClB,MAAM6gF,KAAK,GAAG,KAAK,CAAC0J,YAAN,CAAmBxqF,EAAnB,CAAd;IACA,KAAK,CAACipF,SAAN,CAAgBpvE,MAAhB,CAAuBinE,KAAvB,EAA8B,CAA9B,EAAiC,CAAC9gF,EAAD,EAAKC,EAAL,CAAjC;EACD;;EACD,CAACqJ,MAAM,CAAC,GAAGtJ,EAAH,EAAOC,EAAP,CAAD,EAAa;IAClB,MAAM6gF,KAAK,GAAG,KAAK,CAAC0J,YAAN,CAAmBxqF,EAAnB,CAAd;;IACA,KAAK,IAAIvF,CAAC,GAAGqmF,KAAb,EAAoBrmF,CAAC,GAAG,KAAK,CAACwuF,SAAN,CAAgBpwF,MAAxC,EAAgD4B,CAAC,EAAjD,EAAqD;MACnD,MAAM,CAACoP,KAAD,EAAQC,GAAR,IAAe,KAAK,CAACm/E,SAAN,CAAgBxuF,CAAhB,CAArB;;MACA,IAAIoP,KAAK,KAAK7J,EAAd,EAAkB;QAChB;MACD;;MACD,IAAI6J,KAAK,KAAK7J,EAAV,IAAgB8J,GAAG,KAAK7J,EAA5B,EAAgC;QAC9B,KAAK,CAACgpF,SAAN,CAAgBpvE,MAAhB,CAAuBpf,CAAvB,EAA0B,CAA1B;QACA;MACD;IACF;;IACD,KAAK,IAAIA,CAAC,GAAGqmF,KAAK,GAAG,CAArB,EAAwBrmF,CAAC,IAAI,CAA7B,EAAgCA,CAAC,EAAjC,EAAqC;MACnC,MAAM,CAACoP,KAAD,EAAQC,GAAR,IAAe,KAAK,CAACm/E,SAAN,CAAgBxuF,CAAhB,CAArB;;MACA,IAAIoP,KAAK,KAAK7J,EAAd,EAAkB;QAChB;MACD;;MACD,IAAI6J,KAAK,KAAK7J,EAAV,IAAgB8J,GAAG,KAAK7J,EAA5B,EAAgC;QAC9B,KAAK,CAACgpF,SAAN,CAAgBpvE,MAAhB,CAAuBpf,CAAvB,EAA0B,CAA1B;QACA;MACD;IACF;EACF;;EACD,CAACqvF,SAAS,CAACJ,IAAD,EAAO;IACf,MAAM,CAACnpF,CAAD,EAAIP,EAAJ,EAAQC,EAAR,IAAcypF,IAApB;IACA,MAAMnd,OAAO,GAAG,CAAC,CAAChsE,CAAD,EAAIP,EAAJ,EAAQC,EAAR,CAAD,CAAhB;IACA,MAAM6gF,KAAK,GAAG,KAAK,CAAC0J,YAAN,CAAmBvqF,EAAnB,CAAd;;IACA,KAAK,IAAIxF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqmF,KAApB,EAA2BrmF,CAAC,EAA5B,EAAgC;MAC9B,MAAM,CAACoP,KAAD,EAAQC,GAAR,IAAe,KAAK,CAACm/E,SAAN,CAAgBxuF,CAAhB,CAArB;;MACA,KAAK,IAAIuQ,CAAC,GAAG,CAAR,EAAWykC,EAAE,GAAG88B,OAAO,CAAC1zE,MAA7B,EAAqCmS,CAAC,GAAGykC,EAAzC,EAA6CzkC,CAAC,EAA9C,EAAkD;QAChD,MAAM,GAAG9K,EAAH,EAAOwqF,EAAP,IAAane,OAAO,CAACvhE,CAAD,CAA1B;;QACA,IAAIlB,GAAG,IAAI5J,EAAP,IAAawqF,EAAE,IAAI7gF,KAAvB,EAA8B;UAC5B;QACD;;QACD,IAAI3J,EAAE,IAAI2J,KAAV,EAAiB;UACf,IAAI6gF,EAAE,GAAG5gF,GAAT,EAAc;YACZyiE,OAAO,CAACvhE,CAAD,CAAP,CAAW,CAAX,IAAgBlB,GAAhB;UACD,CAFD,MAEO;YACL,IAAI2lC,EAAE,KAAK,CAAX,EAAc;cACZ,OAAO,EAAP;YACD;;YACD88B,OAAO,CAAC1yD,MAAR,CAAe7O,CAAf,EAAkB,CAAlB;YACAA,CAAC;YACDykC,EAAE;UACH;;UACD;QACD;;QACD88B,OAAO,CAACvhE,CAAD,CAAP,CAAW,CAAX,IAAgBnB,KAAhB;;QACA,IAAI6gF,EAAE,GAAG5gF,GAAT,EAAc;UACZyiE,OAAO,CAACxxE,IAAR,CAAa,CAACwF,CAAD,EAAIuJ,GAAJ,EAAS4gF,EAAT,CAAb;QACD;MACF;IACF;;IACD,OAAOne,OAAP;EACD;;AA1LY;;AA4Lf,MAAMoe,OAAN,CAAc;EACZC,SAAS,GAAG;IACV,MAAM,IAAI3yF,KAAJ,CAAU,kDAAV,CAAN;EACD;;EACM,IAAHue,GAAG,GAAG;IACR,MAAM,IAAIve,KAAJ,CAAU,4CAAV,CAAN;EACD;;EACDuiB,SAAS,CAAC8rB,KAAD,EAAQukD,SAAR,EAAmB;IAC1B,MAAM,IAAI5yF,KAAJ,CAAU,kDAAV,CAAN;EACD;;EACO,IAAJ6yF,IAAI,GAAG;IACT,OAAO,gBAAgBC,oBAAvB;EACD;;AAZW;;AAcd,MAAMR,gBAAN,SAA+BI,OAA/B,CAAuC;EACrC,CAACn0E,GAAD;EACA,CAAC2zE,QAAD;;EACAzwF,WAAW,CAACywF,QAAD,EAAW3zE,GAAX,EAAgB;IACzB;IACA,KAAK,CAAC2zE,QAAN,GAAiBA,QAAjB;IACA,KAAK,CAAC3zE,GAAN,GAAYA,GAAZ;EACD;;EACDo0E,SAAS,GAAG;IACV,MAAM7uF,MAAM,GAAG,EAAf;;IACA,KAAK,MAAMivF,OAAX,IAAsB,KAAK,CAACb,QAA5B,EAAsC;MACpC,IAAI,CAACc,KAAD,EAAQC,KAAR,IAAiBF,OAArB;MACAjvF,MAAM,CAAChB,IAAP,CAAa,IAAGkwF,KAAM,IAAGC,KAAM,EAA/B;;MACA,KAAK,IAAIzwF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuwF,OAAO,CAACnyF,MAA5B,EAAoC4B,CAAC,IAAI,CAAzC,EAA4C;QAC1C,MAAM8F,CAAC,GAAGyqF,OAAO,CAACvwF,CAAD,CAAjB;QACA,MAAM+F,CAAC,GAAGwqF,OAAO,CAACvwF,CAAC,GAAG,CAAL,CAAjB;;QACA,IAAI8F,CAAC,KAAK0qF,KAAV,EAAiB;UACflvF,MAAM,CAAChB,IAAP,CAAa,IAAGyF,CAAE,EAAlB;UACA0qF,KAAK,GAAG1qF,CAAR;QACD,CAHD,MAGO,IAAIA,CAAC,KAAK0qF,KAAV,EAAiB;UACtBnvF,MAAM,CAAChB,IAAP,CAAa,IAAGwF,CAAE,EAAlB;UACA0qF,KAAK,GAAG1qF,CAAR;QACD;MACF;;MACDxE,MAAM,CAAChB,IAAP,CAAY,GAAZ;IACD;;IACD,OAAOgB,MAAM,CAACf,IAAP,CAAY,GAAZ,CAAP;EACD;;EACDwf,SAAS,CAAC,CAACy9D,GAAD,EAAMC,GAAN,EAAWH,GAAX,EAAgBC,GAAhB,CAAD,EAAuB6S,SAAvB,EAAkC;IACzC,MAAMV,QAAQ,GAAG,EAAjB;IACA,MAAMhlF,KAAK,GAAG4yE,GAAG,GAAGE,GAApB;IACA,MAAM7yE,MAAM,GAAG4yE,GAAG,GAAGE,GAArB;;IACA,KAAK,MAAMkS,OAAX,IAAsB,KAAK,CAACD,QAA5B,EAAsC;MACpC,MAAMx2C,MAAM,GAAG,IAAI/2C,KAAJ,CAAUwtF,OAAO,CAACvxF,MAAlB,CAAf;;MACA,KAAK,IAAI4B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2vF,OAAO,CAACvxF,MAA5B,EAAoC4B,CAAC,IAAI,CAAzC,EAA4C;QAC1Ck5C,MAAM,CAACl5C,CAAD,CAAN,GAAYw9E,GAAG,GAAGmS,OAAO,CAAC3vF,CAAD,CAAP,GAAa0K,KAA/B;QACAwuC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgBu9E,GAAG,GAAGoS,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAP,GAAiB2K,MAAvC;MACD;;MACD+kF,QAAQ,CAACpvF,IAAT,CAAc44C,MAAd;IACD;;IACD,OAAOw2C,QAAP;EACD;;EACM,IAAH3zE,GAAG,GAAG;IACR,OAAO,KAAK,CAACA,GAAb;EACD;;AA5CoC;;AA8CvC,MAAM20E,YAAN,CAAmB;EACjB,CAAC30E,GAAD;EACA,CAAC40E,MAAD,GAAU,EAAV;EACA,CAAClC,WAAD;EACA,CAAC7yE,KAAD;EACA,CAACvO,GAAD,GAAO,EAAP;EACA,CAACujF,IAAD,GAAQ,IAAIC,YAAJ,CAAiB,EAAjB,CAAR;EACA,CAAC/0E,KAAD;EACA,CAACD,KAAD;EACA,CAAC1b,GAAD;EACA,CAAC2wF,QAAD;EACA,CAACC,WAAD;EACA,CAACC,SAAD;EACA,CAAC93C,MAAD,GAAU,EAAV;EACA,OAAO,CAAC+3C,QAAR,GAAmB,CAAnB;EACA,OAAO,CAACC,QAAR,GAAmB,CAAnB;EACA,OAAO,CAACC,GAAR,GAAcT,YAAY,CAAC,CAACO,QAAd,GAAyBP,YAAY,CAAC,CAACQ,QAArD;;EACAjyF,WAAW,CAAC;IACV6G,CADU;IAEVC;EAFU,CAAD,EAGRgW,GAHQ,EAGHg1E,WAHG,EAGUC,SAHV,EAGqBp1E,KAHrB,EAG4B6yE,WAAW,GAAG,CAH1C,EAG6C;IACtD,KAAK,CAAC1yE,GAAN,GAAYA,GAAZ;IACA,KAAK,CAACi1E,SAAN,GAAkBA,SAAS,GAAGD,WAA9B;IACA,KAAK,CAACn1E,KAAN,GAAcA,KAAd;IACA,KAAK,CAACg1E,IAAN,CAAWniF,GAAX,CAAe,CAACuQ,GAAD,EAAMA,GAAN,EAAWA,GAAX,EAAgBA,GAAhB,EAAqBlZ,CAArB,EAAwBC,CAAxB,CAAf,EAA2C,CAA3C;IACA,KAAK,CAAC0oF,WAAN,GAAoBA,WAApB;IACA,KAAK,CAACqC,QAAN,GAAiBJ,YAAY,CAAC,CAACO,QAAd,GAAyBF,WAA1C;IACA,KAAK,CAAC5wF,GAAN,GAAYuwF,YAAY,CAAC,CAACS,GAAd,GAAoBJ,WAAhC;IACA,KAAK,CAACA,WAAN,GAAoBA,WAApB;IACA,KAAK,CAAC73C,MAAN,CAAa54C,IAAb,CAAkBwF,CAAlB,EAAqBC,CAArB;EACD;;EACO,IAAJsqF,IAAI,GAAG;IACT,OAAO,IAAP;EACD;;EACD5sE,OAAO,GAAG;IACR,OAAO6iD,KAAK,CAAC,KAAK,CAACsqB,IAAN,CAAW,CAAX,CAAD,CAAZ;EACD;;EACD,CAACQ,aAAa,GAAG;IACf,MAAMC,OAAO,GAAG,KAAK,CAACT,IAAN,CAAWvwF,QAAX,CAAoB,CAApB,EAAuB,CAAvB,CAAhB;IACA,MAAMixF,UAAU,GAAG,KAAK,CAACV,IAAN,CAAWvwF,QAAX,CAAoB,EAApB,EAAwB,EAAxB,CAAnB;IACA,MAAM,CAACyF,CAAD,EAAIC,CAAJ,EAAO2E,KAAP,EAAcC,MAAd,IAAwB,KAAK,CAACoR,GAApC;IACA,OAAO,CAAC,CAAC,KAAK,CAACD,KAAN,GAAc,CAACu1E,OAAO,CAAC,CAAD,CAAP,GAAaC,UAAU,CAAC,CAAD,CAAxB,IAA+B,CAA7C,GAAiDxrF,CAAlD,IAAuD4E,KAAxD,EAA+D,CAAC,KAAK,CAACmR,KAAN,GAAc,CAACw1E,OAAO,CAAC,CAAD,CAAP,GAAaC,UAAU,CAAC,CAAD,CAAxB,IAA+B,CAA7C,GAAiDvrF,CAAlD,IAAuD4E,MAAtH,EAA8H,CAAC,KAAK,CAACmR,KAAN,GAAc,CAACw1E,UAAU,CAAC,CAAD,CAAV,GAAgBD,OAAO,CAAC,CAAD,CAAxB,IAA+B,CAA7C,GAAiDvrF,CAAlD,IAAuD4E,KAArL,EAA4L,CAAC,KAAK,CAACmR,KAAN,GAAc,CAACy1E,UAAU,CAAC,CAAD,CAAV,GAAgBD,OAAO,CAAC,CAAD,CAAxB,IAA+B,CAA7C,GAAiDtrF,CAAlD,IAAuD4E,MAAnP,CAAP;EACD;;EACD+P,GAAG,CAAC;IACF5U,CADE;IAEFC;EAFE,CAAD,EAGA;IACD,KAAK,CAAC+V,KAAN,GAAchW,CAAd;IACA,KAAK,CAAC+V,KAAN,GAAc9V,CAAd;IACA,MAAM,CAACqiB,MAAD,EAASC,MAAT,EAAiBi8B,UAAjB,EAA6BC,WAA7B,IAA4C,KAAK,CAACxoC,GAAxD;IACA,IAAI,CAAC5W,EAAD,EAAKI,EAAL,EAASH,EAAT,EAAaI,EAAb,IAAmB,KAAK,CAACorF,IAAN,CAAWvwF,QAAX,CAAoB,CAApB,EAAuB,EAAvB,CAAvB;IACA,MAAMkxF,KAAK,GAAGzrF,CAAC,GAAGV,EAAlB;IACA,MAAMosF,KAAK,GAAGzrF,CAAC,GAAGP,EAAlB;IACA,MAAM9b,CAAC,GAAGwW,IAAI,CAACi+B,KAAL,CAAWozD,KAAX,EAAkBC,KAAlB,CAAV;;IACA,IAAI9nG,CAAC,GAAG,KAAK,CAACyW,GAAd,EAAmB;MACjB,OAAO,KAAP;IACD;;IACD,MAAMsxF,KAAK,GAAG/nG,CAAC,GAAG,KAAK,CAAConG,QAAxB;IACA,MAAM96F,CAAC,GAAGy7F,KAAK,GAAG/nG,CAAlB;IACA,MAAM+1C,MAAM,GAAGzpC,CAAC,GAAGu7F,KAAnB;IACA,MAAM7xD,MAAM,GAAG1pC,CAAC,GAAGw7F,KAAnB;IACA,IAAItsF,EAAE,GAAGC,EAAT;IACA,IAAIG,EAAE,GAAGC,EAAT;IACAJ,EAAE,GAAGC,EAAL;IACAG,EAAE,GAAGC,EAAL;IACAJ,EAAE,IAAIq6B,MAAN;IACAj6B,EAAE,IAAIk6B,MAAN;IACA,KAAK,CAACwZ,MAAN,EAAc54C,IAAd,CAAmBwF,CAAnB,EAAsBC,CAAtB;IACA,MAAM2rF,EAAE,GAAG,CAAChyD,MAAD,GAAU+xD,KAArB;IACA,MAAME,EAAE,GAAGlyD,MAAM,GAAGgyD,KAApB;IACA,MAAMG,GAAG,GAAGF,EAAE,GAAG,KAAK,CAACV,SAAvB;IACA,MAAMa,GAAG,GAAGF,EAAE,GAAG,KAAK,CAACX,SAAvB;IACA,KAAK,CAACJ,IAAN,CAAWniF,GAAX,CAAe,KAAK,CAACmiF,IAAN,CAAWvwF,QAAX,CAAoB,CAApB,EAAuB,CAAvB,CAAf,EAA0C,CAA1C;IACA,KAAK,CAACuwF,IAAN,CAAWniF,GAAX,CAAe,CAACrJ,EAAE,GAAGwsF,GAAN,EAAWpsF,EAAE,GAAGqsF,GAAhB,CAAf,EAAqC,CAArC;IACA,KAAK,CAACjB,IAAN,CAAWniF,GAAX,CAAe,KAAK,CAACmiF,IAAN,CAAWvwF,QAAX,CAAoB,EAApB,EAAwB,EAAxB,CAAf,EAA4C,EAA5C;IACA,KAAK,CAACuwF,IAAN,CAAWniF,GAAX,CAAe,CAACrJ,EAAE,GAAGwsF,GAAN,EAAWpsF,EAAE,GAAGqsF,GAAhB,CAAf,EAAqC,EAArC;;IACA,IAAIvrB,KAAK,CAAC,KAAK,CAACsqB,IAAN,CAAW,CAAX,CAAD,CAAT,EAA0B;MACxB,IAAI,KAAK,CAACvjF,GAAN,CAAUjP,MAAV,KAAqB,CAAzB,EAA4B;QAC1B,KAAK,CAACwyF,IAAN,CAAWniF,GAAX,CAAe,CAACtJ,EAAE,GAAGysF,GAAN,EAAWrsF,EAAE,GAAGssF,GAAhB,CAAf,EAAqC,CAArC;QACA,KAAK,CAACxkF,GAAN,CAAU/M,IAAV,CAAe0e,GAAf,EAAoBA,GAApB,EAAyBA,GAAzB,EAA8BA,GAA9B,EAAmC,CAAC7Z,EAAE,GAAGysF,GAAL,GAAWxpE,MAAZ,IAAsBk8B,UAAzD,EAAqE,CAAC/+C,EAAE,GAAGssF,GAAL,GAAWxpE,MAAZ,IAAsBk8B,WAA3F;QACA,KAAK,CAACqsC,IAAN,CAAWniF,GAAX,CAAe,CAACtJ,EAAE,GAAGysF,GAAN,EAAWrsF,EAAE,GAAGssF,GAAhB,CAAf,EAAqC,EAArC;QACA,KAAK,CAAClB,MAAN,CAAarwF,IAAb,CAAkB0e,GAAlB,EAAuBA,GAAvB,EAA4BA,GAA5B,EAAiCA,GAAjC,EAAsC,CAAC7Z,EAAE,GAAGysF,GAAL,GAAWxpE,MAAZ,IAAsBk8B,UAA5D,EAAwE,CAAC/+C,EAAE,GAAGssF,GAAL,GAAWxpE,MAAZ,IAAsBk8B,WAA9F;MACD;;MACD,KAAK,CAACqsC,IAAN,CAAWniF,GAAX,CAAe,CAACvJ,EAAD,EAAKI,EAAL,EAASH,EAAT,EAAaI,EAAb,EAAiBH,EAAjB,EAAqBI,EAArB,CAAf,EAAyC,CAAzC;MACA,OAAO,CAAC,KAAKie,OAAL,EAAR;IACD;;IACD,KAAK,CAACmtE,IAAN,CAAWniF,GAAX,CAAe,CAACvJ,EAAD,EAAKI,EAAL,EAASH,EAAT,EAAaI,EAAb,EAAiBH,EAAjB,EAAqBI,EAArB,CAAf,EAAyC,CAAzC;IACA,MAAMw1B,KAAK,GAAG96B,IAAI,CAAC+F,GAAL,CAAS/F,IAAI,CAACwgE,KAAL,CAAWp7D,EAAE,GAAGC,EAAhB,EAAoBL,EAAE,GAAGC,EAAzB,IAA+BjF,IAAI,CAACwgE,KAAL,CAAWhhC,MAAX,EAAmBD,MAAnB,CAAxC,CAAd;;IACA,IAAIzE,KAAK,GAAG96B,IAAI,CAACnK,EAAL,GAAU,CAAtB,EAAyB;MACvB,CAACoP,EAAD,EAAKI,EAAL,EAASH,EAAT,EAAaI,EAAb,IAAmB,KAAK,CAACorF,IAAN,CAAWvwF,QAAX,CAAoB,CAApB,EAAuB,CAAvB,CAAnB;MACA,KAAK,CAACgN,GAAN,CAAU/M,IAAV,CAAe0e,GAAf,EAAoBA,GAApB,EAAyBA,GAAzB,EAA8BA,GAA9B,EAAmC,CAAC,CAAC7Z,EAAE,GAAGC,EAAN,IAAY,CAAZ,GAAgBgjB,MAAjB,IAA2Bk8B,UAA9D,EAA0E,CAAC,CAAC/+C,EAAE,GAAGC,EAAN,IAAY,CAAZ,GAAgB6iB,MAAjB,IAA2Bk8B,WAArG;MACA,CAACp/C,EAAD,EAAKI,EAAL,EAASL,EAAT,EAAaI,EAAb,IAAmB,KAAK,CAACsrF,IAAN,CAAWvwF,QAAX,CAAoB,EAApB,EAAwB,EAAxB,CAAnB;MACA,KAAK,CAACswF,MAAN,CAAarwF,IAAb,CAAkB0e,GAAlB,EAAuBA,GAAvB,EAA4BA,GAA5B,EAAiCA,GAAjC,EAAsC,CAAC,CAAC9Z,EAAE,GAAGC,EAAN,IAAY,CAAZ,GAAgBijB,MAAjB,IAA2Bk8B,UAAjE,EAA6E,CAAC,CAACh/C,EAAE,GAAGC,EAAN,IAAY,CAAZ,GAAgB8iB,MAAjB,IAA2Bk8B,WAAxG;MACA,OAAO,IAAP;IACD;;IACD,CAACr/C,EAAD,EAAKI,EAAL,EAASH,EAAT,EAAaI,EAAb,EAAiBH,EAAjB,EAAqBI,EAArB,IAA2B,KAAK,CAACorF,IAAN,CAAWvwF,QAAX,CAAoB,CAApB,EAAuB,CAAvB,CAA3B;IACA,KAAK,CAACgN,GAAN,CAAU/M,IAAV,CAAe,CAAC,CAAC4E,EAAE,GAAG,IAAIC,EAAV,IAAgB,CAAhB,GAAoBijB,MAArB,IAA+Bk8B,UAA9C,EAA0D,CAAC,CAACh/C,EAAE,GAAG,IAAIC,EAAV,IAAgB,CAAhB,GAAoB8iB,MAArB,IAA+Bk8B,WAAzF,EAAsG,CAAC,CAAC,IAAIp/C,EAAJ,GAASC,EAAV,IAAgB,CAAhB,GAAoBgjB,MAArB,IAA+Bk8B,UAArI,EAAiJ,CAAC,CAAC,IAAI/+C,EAAJ,GAASC,EAAV,IAAgB,CAAhB,GAAoB6iB,MAArB,IAA+Bk8B,WAAhL,EAA6L,CAAC,CAACp/C,EAAE,GAAGC,EAAN,IAAY,CAAZ,GAAgBgjB,MAAjB,IAA2Bk8B,UAAxN,EAAoO,CAAC,CAAC/+C,EAAE,GAAGC,EAAN,IAAY,CAAZ,GAAgB6iB,MAAjB,IAA2Bk8B,WAA/P;IACA,CAACn/C,EAAD,EAAKI,EAAL,EAASL,EAAT,EAAaI,EAAb,EAAiBL,EAAjB,EAAqBI,EAArB,IAA2B,KAAK,CAACsrF,IAAN,CAAWvwF,QAAX,CAAoB,EAApB,EAAwB,EAAxB,CAA3B;IACA,KAAK,CAACswF,MAAN,CAAarwF,IAAb,CAAkB,CAAC,CAAC4E,EAAE,GAAG,IAAIC,EAAV,IAAgB,CAAhB,GAAoBijB,MAArB,IAA+Bk8B,UAAjD,EAA6D,CAAC,CAACh/C,EAAE,GAAG,IAAIC,EAAV,IAAgB,CAAhB,GAAoB8iB,MAArB,IAA+Bk8B,WAA5F,EAAyG,CAAC,CAAC,IAAIp/C,EAAJ,GAASC,EAAV,IAAgB,CAAhB,GAAoBgjB,MAArB,IAA+Bk8B,UAAxI,EAAoJ,CAAC,CAAC,IAAI/+C,EAAJ,GAASC,EAAV,IAAgB,CAAhB,GAAoB6iB,MAArB,IAA+Bk8B,WAAnL,EAAgM,CAAC,CAACp/C,EAAE,GAAGC,EAAN,IAAY,CAAZ,GAAgBgjB,MAAjB,IAA2Bk8B,UAA3N,EAAuO,CAAC,CAAC/+C,EAAE,GAAGC,EAAN,IAAY,CAAZ,GAAgB6iB,MAAjB,IAA2Bk8B,WAAlQ;IACA,OAAO,IAAP;EACD;;EACD4rC,SAAS,GAAG;IACV,IAAI,KAAK1sE,OAAL,EAAJ,EAAoB;MAClB,OAAO,EAAP;IACD;;IACD,MAAMpW,GAAG,GAAG,KAAK,CAACA,GAAlB;IACA,MAAMsjF,MAAM,GAAG,KAAK,CAACA,MAArB;IACA,MAAMU,OAAO,GAAG,KAAK,CAACT,IAAN,CAAWvwF,QAAX,CAAoB,CAApB,EAAuB,CAAvB,CAAhB;IACA,MAAMixF,UAAU,GAAG,KAAK,CAACV,IAAN,CAAWvwF,QAAX,CAAoB,EAApB,EAAwB,EAAxB,CAAnB;IACA,MAAM,CAACyF,CAAD,EAAIC,CAAJ,EAAO2E,KAAP,EAAcC,MAAd,IAAwB,KAAK,CAACoR,GAApC;IACA,MAAM,CAAC+1E,QAAD,EAAWC,QAAX,EAAqBC,WAArB,EAAkCC,WAAlC,IAAiD,KAAK,CAACb,aAAN,EAAvD;;IACA,IAAI9qB,KAAK,CAAC,KAAK,CAACsqB,IAAN,CAAW,CAAX,CAAD,CAAL,IAAwB,CAAC,KAAKntE,OAAL,EAA7B,EAA6C;MAC3C,OAAQ,IAAG,CAAC,KAAK,CAACmtE,IAAN,CAAW,CAAX,IAAgB9qF,CAAjB,IAAsB4E,KAAM,IAAG,CAAC,KAAK,CAACkmF,IAAN,CAAW,CAAX,IAAgB7qF,CAAjB,IAAsB4E,MAAO,KAAI,CAAC,KAAK,CAACimF,IAAN,CAAW,CAAX,IAAgB9qF,CAAjB,IAAsB4E,KAAM,IAAG,CAAC,KAAK,CAACkmF,IAAN,CAAW,CAAX,IAAgB7qF,CAAjB,IAAsB4E,MAAO,KAAImnF,QAAS,IAAGC,QAAS,KAAIC,WAAY,IAAGC,WAAY,KAAI,CAAC,KAAK,CAACrB,IAAN,CAAW,EAAX,IAAiB9qF,CAAlB,IAAuB4E,KAAM,IAAG,CAAC,KAAK,CAACkmF,IAAN,CAAW,EAAX,IAAiB7qF,CAAlB,IAAuB4E,MAAO,KAAI,CAAC,KAAK,CAACimF,IAAN,CAAW,EAAX,IAAiB9qF,CAAlB,IAAuB4E,KAAM,IAAG,CAAC,KAAK,CAACkmF,IAAN,CAAW,EAAX,IAAiB7qF,CAAlB,IAAuB4E,MAAO,IAAnU;IACD;;IACD,MAAMrJ,MAAM,GAAG,EAAf;IACAA,MAAM,CAAChB,IAAP,CAAa,IAAG+M,GAAG,CAAC,CAAD,CAAI,IAAGA,GAAG,CAAC,CAAD,CAAI,EAAjC;;IACA,KAAK,IAAIrN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqN,GAAG,CAACjP,MAAxB,EAAgC4B,CAAC,IAAI,CAArC,EAAwC;MACtC,IAAIsmE,KAAK,CAACj5D,GAAG,CAACrN,CAAD,CAAJ,CAAT,EAAmB;QACjBsB,MAAM,CAAChB,IAAP,CAAa,IAAG+M,GAAG,CAACrN,CAAC,GAAG,CAAL,CAAQ,IAAGqN,GAAG,CAACrN,CAAC,GAAG,CAAL,CAAQ,EAAzC;MACD,CAFD,MAEO;QACLsB,MAAM,CAAChB,IAAP,CAAa,IAAG+M,GAAG,CAACrN,CAAD,CAAI,IAAGqN,GAAG,CAACrN,CAAC,GAAG,CAAL,CAAQ,IAAGqN,GAAG,CAACrN,CAAC,GAAG,CAAL,CAAQ,IAAGqN,GAAG,CAACrN,CAAC,GAAG,CAAL,CAAQ,IAAGqN,GAAG,CAACrN,CAAC,GAAG,CAAL,CAAQ,IAAGqN,GAAG,CAACrN,CAAC,GAAG,CAAL,CAAQ,EAA7F;MACD;IACF;;IACDsB,MAAM,CAAChB,IAAP,CAAa,IAAG,CAAC+wF,OAAO,CAAC,CAAD,CAAP,GAAavrF,CAAd,IAAmB4E,KAAM,IAAG,CAAC2mF,OAAO,CAAC,CAAD,CAAP,GAAatrF,CAAd,IAAmB4E,MAAO,KAAImnF,QAAS,IAAGC,QAAS,KAAIC,WAAY,IAAGC,WAAY,KAAI,CAACX,UAAU,CAAC,CAAD,CAAV,GAAgBxrF,CAAjB,IAAsB4E,KAAM,IAAG,CAAC4mF,UAAU,CAAC,CAAD,CAAV,GAAgBvrF,CAAjB,IAAsB4E,MAAO,EAA9L;;IACA,KAAK,IAAI3K,CAAC,GAAG2wF,MAAM,CAACvyF,MAAP,GAAgB,CAA7B,EAAgC4B,CAAC,IAAI,CAArC,EAAwCA,CAAC,IAAI,CAA7C,EAAgD;MAC9C,IAAIsmE,KAAK,CAACqqB,MAAM,CAAC3wF,CAAD,CAAP,CAAT,EAAsB;QACpBsB,MAAM,CAAChB,IAAP,CAAa,IAAGqwF,MAAM,CAAC3wF,CAAC,GAAG,CAAL,CAAQ,IAAG2wF,MAAM,CAAC3wF,CAAC,GAAG,CAAL,CAAQ,EAA/C;MACD,CAFD,MAEO;QACLsB,MAAM,CAAChB,IAAP,CAAa,IAAGqwF,MAAM,CAAC3wF,CAAD,CAAI,IAAG2wF,MAAM,CAAC3wF,CAAC,GAAG,CAAL,CAAQ,IAAG2wF,MAAM,CAAC3wF,CAAC,GAAG,CAAL,CAAQ,IAAG2wF,MAAM,CAAC3wF,CAAC,GAAG,CAAL,CAAQ,IAAG2wF,MAAM,CAAC3wF,CAAC,GAAG,CAAL,CAAQ,IAAG2wF,MAAM,CAAC3wF,CAAC,GAAG,CAAL,CAAQ,EAA/G;MACD;IACF;;IACDsB,MAAM,CAAChB,IAAP,CAAa,IAAGqwF,MAAM,CAAC,CAAD,CAAI,IAAGA,MAAM,CAAC,CAAD,CAAI,IAAvC;IACA,OAAOrvF,MAAM,CAACf,IAAP,CAAY,GAAZ,CAAP;EACD;;EACD2uF,WAAW,GAAG;IACZ,MAAM7hF,GAAG,GAAG,KAAK,CAACA,GAAlB;IACA,MAAMsjF,MAAM,GAAG,KAAK,CAACA,MAArB;IACA,MAAMC,IAAI,GAAG,KAAK,CAACA,IAAnB;IACA,MAAMS,OAAO,GAAGT,IAAI,CAACvwF,QAAL,CAAc,CAAd,EAAiB,CAAjB,CAAhB;IACA,MAAMixF,UAAU,GAAGV,IAAI,CAACvwF,QAAL,CAAc,EAAd,EAAkB,EAAlB,CAAnB;IACA,MAAM,CAAC+nB,MAAD,EAASC,MAAT,EAAiBi8B,UAAjB,EAA6BC,WAA7B,IAA4C,KAAK,CAACxoC,GAAxD;IACA,MAAMm9B,MAAM,GAAG,IAAI23C,YAAJ,CAAiB,CAAC,KAAK,CAAC33C,MAAN,EAAc96C,MAAd,IAAwB,CAAzB,IAA8B,CAA/C,CAAf;;IACA,KAAK,IAAI4B,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAAP,GAAgB,CAArC,EAAwC4B,CAAC,GAAGgH,EAA5C,EAAgDhH,CAAC,IAAI,CAArD,EAAwD;MACtDk5C,MAAM,CAACl5C,CAAD,CAAN,GAAY,CAAC,KAAK,CAACk5C,MAAN,CAAal5C,CAAb,IAAkBooB,MAAnB,IAA6Bk8B,UAAzC;MACApL,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgB,CAAC,KAAK,CAACk5C,MAAN,CAAal5C,CAAC,GAAG,CAAjB,IAAsBqoB,MAAvB,IAAiCk8B,WAAjD;IACD;;IACDrL,MAAM,CAACA,MAAM,CAAC96C,MAAP,GAAgB,CAAjB,CAAN,GAA4B,CAAC,KAAK,CAAC0d,KAAN,GAAcsM,MAAf,IAAyBk8B,UAArD;IACApL,MAAM,CAACA,MAAM,CAAC96C,MAAP,GAAgB,CAAjB,CAAN,GAA4B,CAAC,KAAK,CAACyd,KAAN,GAAcwM,MAAf,IAAyBk8B,WAArD;IACA,MAAM,CAACutC,QAAD,EAAWC,QAAX,EAAqBC,WAArB,EAAkCC,WAAlC,IAAiD,KAAK,CAACb,aAAN,EAAvD;;IACA,IAAI9qB,KAAK,CAACsqB,IAAI,CAAC,CAAD,CAAL,CAAL,IAAkB,CAAC,KAAKntE,OAAL,EAAvB,EAAuC;MACrC,MAAMksE,OAAO,GAAG,IAAIkB,YAAJ,CAAiB,EAAjB,CAAhB;MACAlB,OAAO,CAAClhF,GAAR,CAAY,CAACuQ,GAAD,EAAMA,GAAN,EAAWA,GAAX,EAAgBA,GAAhB,EAAqB,CAAC4xE,IAAI,CAAC,CAAD,CAAJ,GAAUxoE,MAAX,IAAqBk8B,UAA1C,EAAsD,CAACssC,IAAI,CAAC,CAAD,CAAJ,GAAUvoE,MAAX,IAAqBk8B,WAA3E,EAAwFvlC,GAAxF,EAA6FA,GAA7F,EAAkGA,GAAlG,EAAuGA,GAAvG,EAA4G,CAAC4xE,IAAI,CAAC,CAAD,CAAJ,GAAUxoE,MAAX,IAAqBk8B,UAAjI,EAA6I,CAACssC,IAAI,CAAC,CAAD,CAAJ,GAAUvoE,MAAX,IAAqBk8B,WAAlK,EAA+KvlC,GAA/K,EAAoLA,GAApL,EAAyLA,GAAzL,EAA8LA,GAA9L,EAAmM8yE,QAAnM,EAA6MC,QAA7M,EAAuN/yE,GAAvN,EAA4NA,GAA5N,EAAiOA,GAAjO,EAAsOA,GAAtO,EAA2OgzE,WAA3O,EAAwPC,WAAxP,EAAqQjzE,GAArQ,EAA0QA,GAA1Q,EAA+QA,GAA/Q,EAAoRA,GAApR,EAAyR,CAAC4xE,IAAI,CAAC,EAAD,CAAJ,GAAWxoE,MAAZ,IAAsBk8B,UAA/S,EAA2T,CAACssC,IAAI,CAAC,EAAD,CAAJ,GAAWvoE,MAAZ,IAAsBk8B,WAAjV,EAA8VvlC,GAA9V,EAAmWA,GAAnW,EAAwWA,GAAxW,EAA6WA,GAA7W,EAAkX,CAAC4xE,IAAI,CAAC,EAAD,CAAJ,GAAWxoE,MAAZ,IAAsBk8B,UAAxY,EAAoZ,CAACssC,IAAI,CAAC,EAAD,CAAJ,GAAWvoE,MAAZ,IAAsBk8B,WAA1a,CAAZ,EAAoc,CAApc;MACA,OAAO,IAAI+rC,oBAAJ,CAAyBX,OAAzB,EAAkCz2C,MAAlC,EAA0C,KAAK,CAACn9B,GAAhD,EAAqD,KAAK,CAACg1E,WAA3D,EAAwE,KAAK,CAACtC,WAA9E,EAA2F,KAAK,CAAC7yE,KAAjG,CAAP;IACD;;IACD,MAAM+zE,OAAO,GAAG,IAAIkB,YAAJ,CAAiB,KAAK,CAACxjF,GAAN,CAAUjP,MAAV,GAAmB,EAAnB,GAAwB,KAAK,CAACuyF,MAAN,CAAavyF,MAAtD,CAAhB;IACA,IAAI8zF,CAAC,GAAG7kF,GAAG,CAACjP,MAAZ;;IACA,KAAK,IAAI4B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGkyF,CAApB,EAAuBlyF,CAAC,IAAI,CAA5B,EAA+B;MAC7B,IAAIsmE,KAAK,CAACj5D,GAAG,CAACrN,CAAD,CAAJ,CAAT,EAAmB;QACjB2vF,OAAO,CAAC3vF,CAAD,CAAP,GAAa2vF,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAP,GAAiBgf,GAA9B;QACA;MACD;;MACD2wE,OAAO,CAAC3vF,CAAD,CAAP,GAAaqN,GAAG,CAACrN,CAAD,CAAhB;MACA2vF,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAP,GAAiBqN,GAAG,CAACrN,CAAC,GAAG,CAAL,CAApB;IACD;;IACD2vF,OAAO,CAAClhF,GAAR,CAAY,CAACuQ,GAAD,EAAMA,GAAN,EAAWA,GAAX,EAAgBA,GAAhB,EAAqB,CAACqyE,OAAO,CAAC,CAAD,CAAP,GAAajpE,MAAd,IAAwBk8B,UAA7C,EAAyD,CAAC+sC,OAAO,CAAC,CAAD,CAAP,GAAahpE,MAAd,IAAwBk8B,WAAjF,EAA8FvlC,GAA9F,EAAmGA,GAAnG,EAAwGA,GAAxG,EAA6GA,GAA7G,EAAkH8yE,QAAlH,EAA4HC,QAA5H,EAAsI/yE,GAAtI,EAA2IA,GAA3I,EAAgJA,GAAhJ,EAAqJA,GAArJ,EAA0JgzE,WAA1J,EAAuKC,WAAvK,EAAoLjzE,GAApL,EAAyLA,GAAzL,EAA8LA,GAA9L,EAAmMA,GAAnM,EAAwM,CAACsyE,UAAU,CAAC,CAAD,CAAV,GAAgBlpE,MAAjB,IAA2Bk8B,UAAnO,EAA+O,CAACgtC,UAAU,CAAC,CAAD,CAAV,GAAgBjpE,MAAjB,IAA2Bk8B,WAA1Q,CAAZ,EAAoS2tC,CAApS;IACAA,CAAC,IAAI,EAAL;;IACA,KAAK,IAAIlyF,CAAC,GAAG2wF,MAAM,CAACvyF,MAAP,GAAgB,CAA7B,EAAgC4B,CAAC,IAAI,CAArC,EAAwCA,CAAC,IAAI,CAA7C,EAAgD;MAC9C,KAAK,IAAIuQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,IAAI,CAA5B,EAA+B;QAC7B,IAAI+1D,KAAK,CAACqqB,MAAM,CAAC3wF,CAAC,GAAGuQ,CAAL,CAAP,CAAT,EAA0B;UACxBo/E,OAAO,CAACuC,CAAD,CAAP,GAAavC,OAAO,CAACuC,CAAC,GAAG,CAAL,CAAP,GAAiBlzE,GAA9B;UACAkzE,CAAC,IAAI,CAAL;UACA;QACD;;QACDvC,OAAO,CAACuC,CAAD,CAAP,GAAavB,MAAM,CAAC3wF,CAAC,GAAGuQ,CAAL,CAAnB;QACAo/E,OAAO,CAACuC,CAAC,GAAG,CAAL,CAAP,GAAiBvB,MAAM,CAAC3wF,CAAC,GAAGuQ,CAAJ,GAAQ,CAAT,CAAvB;QACA2hF,CAAC,IAAI,CAAL;MACD;IACF;;IACDvC,OAAO,CAAClhF,GAAR,CAAY,CAACuQ,GAAD,EAAMA,GAAN,EAAWA,GAAX,EAAgBA,GAAhB,EAAqB2xE,MAAM,CAAC,CAAD,CAA3B,EAAgCA,MAAM,CAAC,CAAD,CAAtC,CAAZ,EAAwDuB,CAAxD;IACA,OAAO,IAAI5B,oBAAJ,CAAyBX,OAAzB,EAAkCz2C,MAAlC,EAA0C,KAAK,CAACn9B,GAAhD,EAAqD,KAAK,CAACg1E,WAA3D,EAAwE,KAAK,CAACtC,WAA9E,EAA2F,KAAK,CAAC7yE,KAAjG,CAAP;EACD;;AApLgB;;AAsLnB,MAAM00E,oBAAN,SAAmCJ,OAAnC,CAA2C;EACzC,CAACn0E,GAAD;EACA,CAACuvB,IAAD,GAAQ,IAAR;EACA,CAACmjD,WAAD;EACA,CAAC7yE,KAAD;EACA,CAACs9B,MAAD;EACA,CAAC63C,WAAD;EACA,CAACpB,OAAD;;EACA1wF,WAAW,CAAC0wF,OAAD,EAAUz2C,MAAV,EAAkBn9B,GAAlB,EAAuBg1E,WAAvB,EAAoCtC,WAApC,EAAiD7yE,KAAjD,EAAwD;IACjE;IACA,KAAK,CAAC+zE,OAAN,GAAgBA,OAAhB;IACA,KAAK,CAACz2C,MAAN,GAAeA,MAAf;IACA,KAAK,CAACn9B,GAAN,GAAYA,GAAZ;IACA,KAAK,CAACg1E,WAAN,GAAoBA,WAApB;IACA,KAAK,CAACtC,WAAN,GAAoBA,WAApB;IACA,KAAK,CAAC7yE,KAAN,GAAcA,KAAd;IACA,KAAK,CAACu2E,aAAN,CAAoBv2E,KAApB;IACA,MAAM;MACJ9V,CADI;MAEJC,CAFI;MAGJ2E,KAHI;MAIJC;IAJI,IAKF,KAAK,CAAC2gC,IALV;;IAMA,KAAK,IAAItrC,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAG2oF,OAAO,CAACvxF,MAA7B,EAAqC4B,CAAC,GAAGgH,EAAzC,EAA6ChH,CAAC,IAAI,CAAlD,EAAqD;MACnD2vF,OAAO,CAAC3vF,CAAD,CAAP,GAAa,CAAC2vF,OAAO,CAAC3vF,CAAD,CAAP,GAAa8F,CAAd,IAAmB4E,KAAhC;MACAilF,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAP,GAAiB,CAAC2vF,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAP,GAAiB+F,CAAlB,IAAuB4E,MAAxC;IACD;;IACD,KAAK,IAAI3K,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;MAClDk5C,MAAM,CAACl5C,CAAD,CAAN,GAAY,CAACk5C,MAAM,CAACl5C,CAAD,CAAN,GAAY8F,CAAb,IAAkB4E,KAA9B;MACAwuC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgB,CAACk5C,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgB+F,CAAjB,IAAsB4E,MAAtC;IACD;EACF;;EACDwlF,SAAS,GAAG;IACV,MAAM7uF,MAAM,GAAG,CAAE,IAAG,KAAK,CAACquF,OAAN,CAAc,CAAd,CAAiB,IAAG,KAAK,CAACA,OAAN,CAAc,CAAd,CAAiB,EAA1C,CAAf;;IACA,KAAK,IAAI3vF,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAG,KAAK,CAAC2oF,OAAN,CAAcvxF,MAAnC,EAA2C4B,CAAC,GAAGgH,EAA/C,EAAmDhH,CAAC,IAAI,CAAxD,EAA2D;MACzD,IAAIsmE,KAAK,CAAC,KAAK,CAACqpB,OAAN,CAAc3vF,CAAd,CAAD,CAAT,EAA6B;QAC3BsB,MAAM,CAAChB,IAAP,CAAa,IAAG,KAAK,CAACqvF,OAAN,CAAc3vF,CAAC,GAAG,CAAlB,CAAqB,IAAG,KAAK,CAAC2vF,OAAN,CAAc3vF,CAAC,GAAG,CAAlB,CAAqB,EAA7D;QACA;MACD;;MACDsB,MAAM,CAAChB,IAAP,CAAa,IAAG,KAAK,CAACqvF,OAAN,CAAc3vF,CAAd,CAAiB,IAAG,KAAK,CAAC2vF,OAAN,CAAc3vF,CAAC,GAAG,CAAlB,CAAqB,IAAG,KAAK,CAAC2vF,OAAN,CAAc3vF,CAAC,GAAG,CAAlB,CAAqB,IAAG,KAAK,CAAC2vF,OAAN,CAAc3vF,CAAC,GAAG,CAAlB,CAAqB,IAAG,KAAK,CAAC2vF,OAAN,CAAc3vF,CAAC,GAAG,CAAlB,CAAqB,IAAG,KAAK,CAAC2vF,OAAN,CAAc3vF,CAAC,GAAG,CAAlB,CAAqB,EAAzJ;IACD;;IACDsB,MAAM,CAAChB,IAAP,CAAY,GAAZ;IACA,OAAOgB,MAAM,CAACf,IAAP,CAAY,GAAZ,CAAP;EACD;;EACDwf,SAAS,CAAC,CAACy9D,GAAD,EAAMC,GAAN,EAAWH,GAAX,EAAgBC,GAAhB,CAAD,EAAuBlqE,QAAvB,EAAiC;IACxC,MAAM3I,KAAK,GAAG4yE,GAAG,GAAGE,GAApB;IACA,MAAM7yE,MAAM,GAAG4yE,GAAG,GAAGE,GAArB;IACA,IAAIkS,OAAJ;IACA,IAAIz2C,MAAJ;;IACA,QAAQ7lC,QAAR;MACE,KAAK,CAAL;QACEs8E,OAAO,GAAG,KAAK,CAACyC,OAAN,CAAc,KAAK,CAACzC,OAApB,EAA6BnS,GAA7B,EAAkCD,GAAlC,EAAuC7yE,KAAvC,EAA8C,CAACC,MAA/C,CAAV;QACAuuC,MAAM,GAAG,KAAK,CAACk5C,OAAN,CAAc,KAAK,CAACl5C,MAApB,EAA4BskC,GAA5B,EAAiCD,GAAjC,EAAsC7yE,KAAtC,EAA6C,CAACC,MAA9C,CAAT;QACA;;MACF,KAAK,EAAL;QACEglF,OAAO,GAAG,KAAK,CAAC0C,cAAN,CAAqB,KAAK,CAAC1C,OAA3B,EAAoCnS,GAApC,EAAyCC,GAAzC,EAA8C/yE,KAA9C,EAAqDC,MAArD,CAAV;QACAuuC,MAAM,GAAG,KAAK,CAACm5C,cAAN,CAAqB,KAAK,CAACn5C,MAA3B,EAAmCskC,GAAnC,EAAwCC,GAAxC,EAA6C/yE,KAA7C,EAAoDC,MAApD,CAAT;QACA;;MACF,KAAK,GAAL;QACEglF,OAAO,GAAG,KAAK,CAACyC,OAAN,CAAc,KAAK,CAACzC,OAApB,EAA6BrS,GAA7B,EAAkCG,GAAlC,EAAuC,CAAC/yE,KAAxC,EAA+CC,MAA/C,CAAV;QACAuuC,MAAM,GAAG,KAAK,CAACk5C,OAAN,CAAc,KAAK,CAACl5C,MAApB,EAA4BokC,GAA5B,EAAiCG,GAAjC,EAAsC,CAAC/yE,KAAvC,EAA8CC,MAA9C,CAAT;QACA;;MACF,KAAK,GAAL;QACEglF,OAAO,GAAG,KAAK,CAAC0C,cAAN,CAAqB,KAAK,CAAC1C,OAA3B,EAAoCrS,GAApC,EAAyCC,GAAzC,EAA8C,CAAC7yE,KAA/C,EAAsD,CAACC,MAAvD,CAAV;QACAuuC,MAAM,GAAG,KAAK,CAACm5C,cAAN,CAAqB,KAAK,CAACn5C,MAA3B,EAAmCokC,GAAnC,EAAwCC,GAAxC,EAA6C,CAAC7yE,KAA9C,EAAqD,CAACC,MAAtD,CAAT;QACA;IAhBJ;;IAkBA,OAAO;MACLglF,OAAO,EAAExtF,KAAK,CAACC,IAAN,CAAWutF,OAAX,CADJ;MAELz2C,MAAM,EAAE,CAAC/2C,KAAK,CAACC,IAAN,CAAW82C,MAAX,CAAD;IAFH,CAAP;EAID;;EACD,CAACk5C,OAAO,CAACx1E,GAAD,EAAMsV,EAAN,EAAUC,EAAV,EAAc7tB,EAAd,EAAkBC,EAAlB,EAAsB;IAC5B,MAAMyvC,IAAI,GAAG,IAAI68C,YAAJ,CAAiBj0E,GAAG,CAACxe,MAArB,CAAb;;IACA,KAAK,IAAI4B,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAG4V,GAAG,CAACxe,MAAzB,EAAiC4B,CAAC,GAAGgH,EAArC,EAAyChH,CAAC,IAAI,CAA9C,EAAiD;MAC/Cg0C,IAAI,CAACh0C,CAAD,CAAJ,GAAUkyB,EAAE,GAAGtV,GAAG,CAAC5c,CAAD,CAAH,GAASsE,EAAxB;MACA0vC,IAAI,CAACh0C,CAAC,GAAG,CAAL,CAAJ,GAAcmyB,EAAE,GAAGvV,GAAG,CAAC5c,CAAC,GAAG,CAAL,CAAH,GAAauE,EAAhC;IACD;;IACD,OAAOyvC,IAAP;EACD;;EACD,CAACq+C,cAAc,CAACz1E,GAAD,EAAMsV,EAAN,EAAUC,EAAV,EAAc7tB,EAAd,EAAkBC,EAAlB,EAAsB;IACnC,MAAMyvC,IAAI,GAAG,IAAI68C,YAAJ,CAAiBj0E,GAAG,CAACxe,MAArB,CAAb;;IACA,KAAK,IAAI4B,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAG4V,GAAG,CAACxe,MAAzB,EAAiC4B,CAAC,GAAGgH,EAArC,EAAyChH,CAAC,IAAI,CAA9C,EAAiD;MAC/Cg0C,IAAI,CAACh0C,CAAD,CAAJ,GAAUkyB,EAAE,GAAGtV,GAAG,CAAC5c,CAAC,GAAG,CAAL,CAAH,GAAasE,EAA5B;MACA0vC,IAAI,CAACh0C,CAAC,GAAG,CAAL,CAAJ,GAAcmyB,EAAE,GAAGvV,GAAG,CAAC5c,CAAD,CAAH,GAASuE,EAA5B;IACD;;IACD,OAAOyvC,IAAP;EACD;;EACD,CAACm+C,aAAa,CAACv2E,KAAD,EAAQ;IACpB,MAAM+zE,OAAO,GAAG,KAAK,CAACA,OAAtB;IACA,IAAI7zE,KAAK,GAAG6zE,OAAO,CAAC,CAAD,CAAnB;IACA,IAAI9zE,KAAK,GAAG8zE,OAAO,CAAC,CAAD,CAAnB;IACA,IAAIp0C,IAAI,GAAGz/B,KAAX;IACA,IAAIkzB,IAAI,GAAGnzB,KAAX;IACA,IAAI2/B,IAAI,GAAG1/B,KAAX;IACA,IAAImzB,IAAI,GAAGpzB,KAAX;IACA,IAAI+zE,UAAU,GAAG9zE,KAAjB;IACA,IAAI+zE,UAAU,GAAGh0E,KAAjB;IACA,MAAMy2E,WAAW,GAAG12E,KAAK,GAAG1b,IAAI,CAAC2D,GAAR,GAAc3D,IAAI,CAACC,GAA5C;;IACA,KAAK,IAAIH,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAG2oF,OAAO,CAACvxF,MAA7B,EAAqC4B,CAAC,GAAGgH,EAAzC,EAA6ChH,CAAC,IAAI,CAAlD,EAAqD;MACnD,IAAIsmE,KAAK,CAACqpB,OAAO,CAAC3vF,CAAD,CAAR,CAAT,EAAuB;QACrBu7C,IAAI,GAAGr7C,IAAI,CAACC,GAAL,CAASo7C,IAAT,EAAeo0C,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAtB,CAAP;QACAgvC,IAAI,GAAG9uC,IAAI,CAACC,GAAL,CAAS6uC,IAAT,EAAe2gD,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAtB,CAAP;QACAw7C,IAAI,GAAGt7C,IAAI,CAAC2D,GAAL,CAAS23C,IAAT,EAAem0C,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAtB,CAAP;QACAivC,IAAI,GAAG/uC,IAAI,CAAC2D,GAAL,CAASorC,IAAT,EAAe0gD,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAtB,CAAP;;QACA,IAAI6vF,UAAU,GAAGF,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAxB,EAAiC;UAC/B4vF,UAAU,GAAGD,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAApB;UACA6vF,UAAU,GAAGF,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAApB;QACD,CAHD,MAGO,IAAI6vF,UAAU,KAAKF,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAA1B,EAAmC;UACxC4vF,UAAU,GAAG0C,WAAW,CAAC1C,UAAD,EAAaD,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAApB,CAAxB;QACD;MACF,CAXD,MAWO;QACL,MAAMsrC,IAAI,GAAG/+C,IAAI,CAAC8Z,iBAAL,CAAuByV,KAAvB,EAA8BD,KAA9B,EAAqC,GAAG8zE,OAAO,CAACjsF,KAAR,CAAc1D,CAAd,EAAiBA,CAAC,GAAG,CAArB,CAAxC,CAAb;QACAu7C,IAAI,GAAGr7C,IAAI,CAACC,GAAL,CAASo7C,IAAT,EAAejQ,IAAI,CAAC,CAAD,CAAnB,CAAP;QACA0D,IAAI,GAAG9uC,IAAI,CAACC,GAAL,CAAS6uC,IAAT,EAAe1D,IAAI,CAAC,CAAD,CAAnB,CAAP;QACAkQ,IAAI,GAAGt7C,IAAI,CAAC2D,GAAL,CAAS23C,IAAT,EAAelQ,IAAI,CAAC,CAAD,CAAnB,CAAP;QACA2D,IAAI,GAAG/uC,IAAI,CAAC2D,GAAL,CAASorC,IAAT,EAAe3D,IAAI,CAAC,CAAD,CAAnB,CAAP;;QACA,IAAIukD,UAAU,GAAGvkD,IAAI,CAAC,CAAD,CAArB,EAA0B;UACxBskD,UAAU,GAAGtkD,IAAI,CAAC,CAAD,CAAjB;UACAukD,UAAU,GAAGvkD,IAAI,CAAC,CAAD,CAAjB;QACD,CAHD,MAGO,IAAIukD,UAAU,KAAKvkD,IAAI,CAAC,CAAD,CAAvB,EAA4B;UACjCskD,UAAU,GAAG0C,WAAW,CAAC1C,UAAD,EAAatkD,IAAI,CAAC,CAAD,CAAjB,CAAxB;QACD;MACF;;MACDxvB,KAAK,GAAG6zE,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAf;MACA6b,KAAK,GAAG8zE,OAAO,CAAC3vF,CAAC,GAAG,CAAL,CAAf;IACD;;IACD,MAAM8F,CAAC,GAAGy1C,IAAI,GAAG,KAAK,CAACkzC,WAAvB;IAAA,MACE1oF,CAAC,GAAGipC,IAAI,GAAG,KAAK,CAACy/C,WADnB;IAAA,MAEE/jF,KAAK,GAAG8wC,IAAI,GAAGD,IAAP,GAAc,IAAI,KAAK,CAACkzC,WAFlC;IAAA,MAGE9jF,MAAM,GAAGskC,IAAI,GAAGD,IAAP,GAAc,IAAI,KAAK,CAACy/C,WAHnC;IAIA,KAAK,CAACnjD,IAAN,GAAa;MACXxlC,CADW;MAEXC,CAFW;MAGX2E,KAHW;MAIXC,MAJW;MAKXqkF,SAAS,EAAE,CAACY,UAAD,EAAaC,UAAb;IALA,CAAb;EAOD;;EACM,IAAH9zE,GAAG,GAAG;IACR,OAAO,KAAK,CAACuvB,IAAb;EACD;;EACDinD,aAAa,CAACvB,SAAD,EAAYvC,WAAZ,EAAyB;IACpC,MAAM;MACJ3oF,CADI;MAEJC,CAFI;MAGJ2E,KAHI;MAIJC;IAJI,IAKF,KAAK,CAAC2gC,IALV;IAMA,MAAM,CAACljB,MAAD,EAASC,MAAT,EAAiBi8B,UAAjB,EAA6BC,WAA7B,IAA4C,KAAK,CAACxoC,GAAxD;IACA,MAAMzX,EAAE,GAAGoG,KAAK,GAAG45C,UAAnB;IACA,MAAM//C,EAAE,GAAGoG,MAAM,GAAG45C,WAApB;IACA,MAAMryB,EAAE,GAAGpsB,CAAC,GAAGw+C,UAAJ,GAAiBl8B,MAA5B;IACA,MAAM+J,EAAE,GAAGpsB,CAAC,GAAGw+C,WAAJ,GAAkBl8B,MAA7B;IACA,MAAMmqE,QAAQ,GAAG,IAAI9B,YAAJ,CAAiB;MAChC5qF,CAAC,EAAE,KAAK,CAACozC,MAAN,CAAa,CAAb,IAAkB50C,EAAlB,GAAuB4tB,EADM;MAEhCnsB,CAAC,EAAE,KAAK,CAACmzC,MAAN,CAAa,CAAb,IAAkB30C,EAAlB,GAAuB4tB;IAFM,CAAjB,EAGd,KAAK,CAACpW,GAHQ,EAGH,KAAK,CAACg1E,WAHH,EAGgBC,SAHhB,EAG2B,KAAK,CAACp1E,KAHjC,EAGwC6yE,WAAW,IAAI,KAAK,CAACA,WAH7D,CAAjB;;IAIA,KAAK,IAAIzuF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK,CAACk5C,MAAN,CAAa96C,MAAjC,EAAyC4B,CAAC,IAAI,CAA9C,EAAiD;MAC/CwyF,QAAQ,CAAC93E,GAAT,CAAa;QACX5U,CAAC,EAAE,KAAK,CAACozC,MAAN,CAAal5C,CAAb,IAAkBsE,EAAlB,GAAuB4tB,EADf;QAEXnsB,CAAC,EAAE,KAAK,CAACmzC,MAAN,CAAal5C,CAAC,GAAG,CAAjB,IAAsBuE,EAAtB,GAA2B4tB;MAFnB,CAAb;IAID;;IACD,OAAOqgE,QAAQ,CAACtD,WAAT,EAAP;EACD;;AArKwC;;AAwK3C,C,CAAC;;AAID,MAAM/jG,WAAN,CAAkB;EAChB,CAAC27F,YAAD,GAAgB,KAAK,CAACH,OAAN,CAAcj3E,IAAd,CAAmB,IAAnB,CAAhB;EACA,CAAC+iF,gBAAD,GAAoB,KAAK,CAAC74E,WAAN,CAAkBlK,IAAlB,CAAuB,IAAvB,CAApB;EACA,CAACqL,MAAD,GAAU,IAAV;EACA,CAAC23E,YAAD,GAAgB,IAAhB;EACA,CAACC,YAAD;EACA,CAACC,QAAD,GAAY,IAAZ;EACA,CAACC,uBAAD,GAA2B,KAA3B;EACA,CAACC,iBAAD,GAAqB,KAArB;EACA,CAACl6E,MAAD,GAAU,IAAV;EACA,CAAC0M,QAAD;EACA,CAAC9J,SAAD,GAAa,IAAb;EACA,CAAC3tB,IAAD;;EAC2B,WAAhBq2B,gBAAgB,GAAG;IAC5B,OAAO52B,MAAM,CAAC,IAAD,EAAO,kBAAP,EAA2B,IAAIkyB,eAAJ,CAAoB,CAAC,CAAC,CAAC,QAAD,EAAW,YAAX,CAAD,EAA2Br0B,WAAW,CAACd,SAAZ,CAAsB0oG,yBAAjD,CAAD,EAA8E,CAAC,CAAC,GAAD,EAAM,OAAN,CAAD,EAAiB5nG,WAAW,CAACd,SAAZ,CAAsB2oG,wBAAvC,CAA9E,EAAgJ,CAAC,CAAC,WAAD,EAAc,YAAd,EAA4B,eAA5B,EAA6C,gBAA7C,CAAD,EAAiE7nG,WAAW,CAACd,SAAZ,CAAsB4oG,WAAvF,CAAhJ,EAAqP,CAAC,CAAC,SAAD,EAAY,WAAZ,EAAyB,aAAzB,EAAwC,eAAxC,CAAD,EAA2D9nG,WAAW,CAACd,SAAZ,CAAsB6oG,eAAjF,CAArP,EAAwV,CAAC,CAAC,MAAD,EAAS,UAAT,CAAD,EAAuB/nG,WAAW,CAACd,SAAZ,CAAsB8oG,gBAA7C,CAAxV,EAAwZ,CAAC,CAAC,KAAD,EAAQ,SAAR,CAAD,EAAqBhoG,WAAW,CAACd,SAAZ,CAAsB+oG,UAA3C,CAAxZ,CAApB,CAA3B,CAAb;EACD;;EACDn0F,WAAW,CAAC;IACV2Z,MAAM,GAAG,IADC;IAEV4C,SAAS,GAAG;EAFF,CAAD,EAGR;IACD,IAAI5C,MAAJ,EAAY;MACV,KAAK,CAACk6E,iBAAN,GAA0B,KAA1B;MACA,KAAK,CAACjlG,IAAN,GAAahD,0BAA0B,CAACmF,eAAxC;MACA,KAAK,CAAC4oB,MAAN,GAAeA,MAAf;IACD,CAJD,MAIO;MACL,KAAK,CAACk6E,iBAAN,GAA0B,IAA1B;MACA,KAAK,CAACjlG,IAAN,GAAahD,0BAA0B,CAACoF,uBAAxC;IACD;;IACD,KAAK,CAACurB,SAAN,GAAkB5C,MAAM,EAAEa,UAAR,IAAsB+B,SAAxC;IACA,KAAK,CAAC8J,QAAN,GAAiB,KAAK,CAAC9J,SAAN,CAAgBgK,SAAjC;IACA,KAAK,CAACmtE,YAAN,GAAqB/5E,MAAM,EAAE3J,KAAR,IAAiB,KAAK,CAACuM,SAAN,EAAiBgH,eAAjB,CAAiCiE,MAAjC,GAA0CtH,IAA1C,GAAiD1gB,KAAlE,IAA2E,SAAhG;EACD;;EACD6c,YAAY,GAAG;IACb,MAAMP,MAAM,GAAG,KAAK,CAACA,MAAN,GAAetO,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAA9B;IACA8O,MAAM,CAACxB,SAAP,GAAmB,aAAnB;IACAwB,MAAM,CAACC,QAAP,GAAkB,GAAlB;IACAD,MAAM,CAAC/O,YAAP,CAAoB,cAApB,EAAoC,iCAApC;IACA+O,MAAM,CAAC/O,YAAP,CAAoB,eAApB,EAAqC,IAArC;IACA,MAAMwN,MAAM,GAAG,KAAK,CAACgC,SAAN,CAAgB9B,OAA/B;IACAqB,MAAM,CAACpB,gBAAP,CAAwB,OAAxB,EAAiC,KAAK,CAAC05E,YAAN,CAAmB3jF,IAAnB,CAAwB,IAAxB,CAAjC,EAAgE;MAC9D8J;IAD8D,CAAhE;IAGAuB,MAAM,CAACpB,gBAAP,CAAwB,SAAxB,EAAmC,KAAK,CAACmtE,YAAzC,EAAuD;MACrDttE;IADqD,CAAvD;IAGA,MAAM85E,MAAM,GAAG,KAAK,CAACZ,YAAN,GAAqBjmF,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAApC;IACAqnF,MAAM,CAAC/5E,SAAP,GAAmB,QAAnB;IACA+5E,MAAM,CAACtnF,YAAP,CAAoB,aAApB,EAAmC,IAAnC;IACAsnF,MAAM,CAACrmF,KAAP,CAAa0jC,eAAb,GAA+B,KAAK,CAACgiD,YAArC;IACA53E,MAAM,CAACtN,MAAP,CAAc6lF,MAAd;IACA,OAAOv4E,MAAP;EACD;;EACDw4E,kBAAkB,GAAG;IACnB,MAAMX,QAAQ,GAAG,KAAK,CAACA,QAAN,GAAiB,KAAK,CAACY,eAAN,EAAlC;IACAZ,QAAQ,CAAC5mF,YAAT,CAAsB,kBAAtB,EAA0C,YAA1C;IACA4mF,QAAQ,CAAC5mF,YAAT,CAAsB,iBAAtB,EAAyC,2BAAzC;IACA,OAAO4mF,QAAP;EACD;;EACD,CAACY,eAAe,GAAG;IACjB,MAAMxmF,GAAG,GAAGP,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAAZ;IACA,MAAMuN,MAAM,GAAG,KAAK,CAACgC,SAAN,CAAgB9B,OAA/B;IACA1M,GAAG,CAAC2M,gBAAJ,CAAqB,aAArB,EAAoCxsB,aAApC,EAAmD;MACjDqsB;IADiD,CAAnD;IAGAxM,GAAG,CAACuM,SAAJ,GAAgB,UAAhB;IACAvM,GAAG,CAACymF,IAAJ,GAAW,SAAX;IACAzmF,GAAG,CAAChB,YAAJ,CAAiB,sBAAjB,EAAyC,KAAzC;IACAgB,GAAG,CAAChB,YAAJ,CAAiB,kBAAjB,EAAqC,UAArC;IACAgB,GAAG,CAAChB,YAAJ,CAAiB,cAAjB,EAAiC,mCAAjC;;IACA,KAAK,MAAM,CAAChN,IAAD,EAAOiQ,KAAP,CAAX,IAA4B,KAAK,CAACuM,SAAN,CAAgBgH,eAA5C,EAA6D;MAC3D,MAAMzH,MAAM,GAAGtO,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAf;MACA8O,MAAM,CAACC,QAAP,GAAkB,GAAlB;MACAD,MAAM,CAAC04E,IAAP,GAAc,QAAd;MACA14E,MAAM,CAAC/O,YAAP,CAAoB,YAApB,EAAkCiD,KAAlC;MACA8L,MAAM,CAAC+/D,KAAP,GAAe97E,IAAf;MACA+b,MAAM,CAAC/O,YAAP,CAAoB,cAApB,EAAqC,4BAA2BhN,IAAK,EAArE;MACA,MAAMs0F,MAAM,GAAG7mF,QAAQ,CAACR,aAAT,CAAuB,MAAvB,CAAf;MACA8O,MAAM,CAACtN,MAAP,CAAc6lF,MAAd;MACAA,MAAM,CAAC/5E,SAAP,GAAmB,QAAnB;MACA+5E,MAAM,CAACrmF,KAAP,CAAa0jC,eAAb,GAA+B1hC,KAA/B;MACA8L,MAAM,CAAC/O,YAAP,CAAoB,eAApB,EAAqCiD,KAAK,KAAK,KAAK,CAAC0jF,YAArD;MACA53E,MAAM,CAACpB,gBAAP,CAAwB,OAAxB,EAAiC,KAAK,CAAC+5E,WAAN,CAAkBhkF,IAAlB,CAAuB,IAAvB,EAA6BT,KAA7B,CAAjC,EAAsE;QACpEuK;MADoE,CAAtE;MAGAxM,GAAG,CAACS,MAAJ,CAAWsN,MAAX;IACD;;IACD/N,GAAG,CAAC2M,gBAAJ,CAAqB,SAArB,EAAgC,KAAK,CAACmtE,YAAtC,EAAoD;MAClDttE;IADkD,CAApD;IAGA,OAAOxM,GAAP;EACD;;EACD,CAAC0mF,WAAW,CAACzkF,KAAD,EAAQ+Q,KAAR,EAAe;IACzBA,KAAK,CAAC/F,eAAN;IACA,KAAK,CAACqL,QAAN,CAAeuC,QAAf,CAAwB,8BAAxB,EAAwD;MACtDC,MAAM,EAAE,IAD8C;MAEtDj6B,IAAI,EAAE,KAAK,CAACA,IAF0C;MAGtD4Q,KAAK,EAAEwQ;IAH+C,CAAxD;EAKD;;EACD+jF,wBAAwB,CAAChzE,KAAD,EAAQ;IAC9B,IAAIA,KAAK,CAAC2E,MAAN,KAAiB,KAAK,CAAC5J,MAA3B,EAAmC;MACjC,KAAK,CAACs4E,YAAN,CAAmBrzE,KAAnB;MACA;IACD;;IACD,MAAM/Q,KAAK,GAAG+Q,KAAK,CAAC2E,MAAN,CAAauO,YAAb,CAA0B,YAA1B,CAAd;;IACA,IAAI,CAACjkB,KAAL,EAAY;MACV;IACD;;IACD,KAAK,CAACykF,WAAN,CAAkBzkF,KAAlB,EAAyB+Q,KAAzB;EACD;;EACDizE,WAAW,CAACjzE,KAAD,EAAQ;IACjB,IAAI,CAAC,KAAK,CAAC2zE,iBAAX,EAA8B;MAC5B,KAAK,CAACN,YAAN,CAAmBrzE,KAAnB;MACA;IACD;;IACD,IAAIA,KAAK,CAAC2E,MAAN,KAAiB,KAAK,CAAC5J,MAA3B,EAAmC;MACjC,KAAK,CAAC63E,QAAN,CAAe/xD,UAAf,EAA2B3Y,KAA3B;MACA;IACD;;IACDlI,KAAK,CAAC2E,MAAN,CAAaivE,WAAb,EAA0B1rE,KAA1B;EACD;;EACDgrE,eAAe,CAAClzE,KAAD,EAAQ;IACrB,IAAIA,KAAK,CAAC2E,MAAN,KAAiB,KAAK,CAACiuE,QAAN,EAAgB/xD,UAAjC,IAA+C7gB,KAAK,CAAC2E,MAAN,KAAiB,KAAK,CAAC5J,MAA1E,EAAkF;MAChF,IAAI,KAAK,CAAC44E,iBAAV,EAA6B;QAC3B,KAAKZ,yBAAL;MACD;;MACD;IACD;;IACD,IAAI,CAAC,KAAK,CAACY,iBAAX,EAA8B;MAC5B,KAAK,CAACN,YAAN,CAAmBrzE,KAAnB;IACD;;IACDA,KAAK,CAAC2E,MAAN,CAAa28D,eAAb,EAA8Bp5D,KAA9B;EACD;;EACDirE,gBAAgB,CAACnzE,KAAD,EAAQ;IACtB,IAAI,CAAC,KAAK,CAAC2zE,iBAAX,EAA8B;MAC5B,KAAK,CAACN,YAAN,CAAmBrzE,KAAnB;MACA;IACD;;IACD,KAAK,CAAC4yE,QAAN,CAAe/xD,UAAf,EAA2B3Y,KAA3B;EACD;;EACDkrE,UAAU,CAACpzE,KAAD,EAAQ;IAChB,IAAI,CAAC,KAAK,CAAC2zE,iBAAX,EAA8B;MAC5B,KAAK,CAACN,YAAN,CAAmBrzE,KAAnB;MACA;IACD;;IACD,KAAK,CAAC4yE,QAAN,CAAe7xD,SAAf,EAA0B7Y,KAA1B;EACD;;EACD,CAACy+D,OAAO,CAAC3mE,KAAD,EAAQ;IACd70B,WAAW,CAAC+4B,gBAAZ,CAA6B5O,IAA7B,CAAkC,IAAlC,EAAwC0K,KAAxC;EACD;;EACD,CAACqzE,YAAY,CAACrzE,KAAD,EAAQ;IACnB,IAAI,KAAK,CAAC2zE,iBAAV,EAA6B;MAC3B,KAAKh5E,YAAL;MACA;IACD;;IACD,KAAK,CAACk4E,uBAAN,GAAgC7yE,KAAK,CAACg8D,MAAN,KAAiB,CAAjD;IACAtkE,MAAM,CAACiC,gBAAP,CAAwB,aAAxB,EAAuC,KAAK,CAAC84E,gBAA7C,EAA+D;MAC7Dj5E,MAAM,EAAE,KAAK,CAACgC,SAAN,CAAgB9B;IADqC,CAA/D;;IAGA,IAAI,KAAK,CAACk5E,QAAV,EAAoB;MAClB,KAAK,CAACA,QAAN,CAAen4E,SAAf,CAAyB5L,MAAzB,CAAgC,QAAhC;MACA;IACD;;IACD,MAAMsnE,IAAI,GAAG,KAAK,CAACyc,QAAN,GAAiB,KAAK,CAACY,eAAN,EAA9B;IACA,KAAK,CAACz4E,MAAN,CAAatN,MAAb,CAAoB0oE,IAApB;EACD;;EACD,CAACv8D,WAAW,CAACoG,KAAD,EAAQ;IAClB,IAAI,KAAK,CAAC4yE,QAAN,EAAgBvuE,QAAhB,CAAyBrE,KAAK,CAAC2E,MAA/B,CAAJ,EAA4C;MAC1C;IACD;;IACD,KAAKhK,YAAL;EACD;;EACDA,YAAY,GAAG;IACb,KAAK,CAACi4E,QAAN,EAAgBn4E,SAAhB,CAA0BC,GAA1B,CAA8B,QAA9B;IACAhD,MAAM,CAAC64C,mBAAP,CAA2B,aAA3B,EAA0C,KAAK,CAACkiC,gBAAhD;EACD;;EACqB,IAAlB,CAACkB,iBAAiB,GAAG;IACvB,OAAO,KAAK,CAACf,QAAN,IAAkB,CAAC,KAAK,CAACA,QAAN,CAAen4E,SAAf,CAAyB4J,QAAzB,CAAkC,QAAlC,CAA1B;EACD;;EACD0uE,yBAAyB,GAAG;IAC1B,IAAI,KAAK,CAACD,iBAAV,EAA6B;MAC3B;IACD;;IACD,IAAI,CAAC,KAAK,CAACa,iBAAX,EAA8B;MAC5B,KAAK,CAAC/6E,MAAN,EAAckX,QAAd;MACA;IACD;;IACD,KAAKnV,YAAL;IACA,KAAK,CAACI,MAAN,CAAamN,KAAb,CAAmB;MACjBgZ,aAAa,EAAE,IADE;MAEjBrM,YAAY,EAAE,KAAK,CAACg+D;IAFH,CAAnB;EAID;;EACD9jE,WAAW,CAAC9f,KAAD,EAAQ;IACjB,IAAI,KAAK,CAACyjF,YAAV,EAAwB;MACtB,KAAK,CAACA,YAAN,CAAmBzlF,KAAnB,CAAyB0jC,eAAzB,GAA2C1hC,KAA3C;IACD;;IACD,IAAI,CAAC,KAAK,CAAC2jF,QAAX,EAAqB;MACnB;IACD;;IACD,MAAM5yF,CAAC,GAAG,KAAK,CAACwb,SAAN,CAAgBgH,eAAhB,CAAgCiE,MAAhC,EAAV;;IACA,KAAK,MAAM8O,KAAX,IAAoB,KAAK,CAACq9D,QAAN,CAAevyD,QAAnC,EAA6C;MAC3C9K,KAAK,CAACvpB,YAAN,CAAmB,eAAnB,EAAoChM,CAAC,CAACmf,IAAF,GAAS1gB,KAAT,KAAmBwQ,KAAvD;IACD;EACF;;EACD3E,OAAO,GAAG;IACR,KAAK,CAACyQ,MAAN,EAAclM,MAAd;IACA,KAAK,CAACkM,MAAN,GAAe,IAAf;IACA,KAAK,CAAC23E,YAAN,GAAqB,IAArB;IACA,KAAK,CAACE,QAAN,EAAgB/jF,MAAhB;IACA,KAAK,CAAC+jF,QAAN,GAAiB,IAAjB;EACD;;AAnNe;;AAsNlB,C,CAAC;;AAOD,MAAMiB,eAAN,SAA8Bh+D,gBAA9B,CAA+C;EAC7C,CAAC/M,UAAD,GAAc,IAAd;EACA,CAACa,YAAD,GAAgB,CAAhB;EACA,CAAChO,KAAD;EACA,CAACm4E,UAAD,GAAc,IAAd;EACA,CAACn7E,WAAD,GAAe,IAAf;EACA,CAACo7E,aAAD,GAAiB,IAAjB;EACA,CAACnqE,SAAD,GAAa,IAAb;EACA,CAACC,WAAD,GAAe,CAAf;EACA,CAACmqE,YAAD,GAAgB,IAAhB;EACA,CAACC,iBAAD,GAAqB,IAArB;EACA,CAACtnF,EAAD,GAAM,IAAN;EACA,CAACunF,eAAD,GAAmB,KAAnB;EACA,CAAClF,SAAD,GAAa,IAAb;EACA,CAAC3yE,OAAD;EACA,CAAC83E,SAAD,GAAa,IAAb;EACA,CAACpiF,IAAD,GAAQ,EAAR;EACA,CAACi/E,SAAD;EACA,CAACznE,gBAAD,GAAoB,EAApB;EACoB,OAAbyhE,aAAa,GAAG,IAAH;EACE,OAAfoJ,eAAe,GAAG,CAAH;EACE,OAAjBC,iBAAiB,GAAG,EAAH;EACL,OAAZjgE,YAAY;EACP,OAALgE,KAAK,GAAG,WAAH;EACM,OAAX+yD,WAAW,GAAGrgG,oBAAoB,CAACuE,SAAxB;EACK,OAAhBilG,gBAAgB,GAAG,CAAC,CAAJ;EACF,OAAdC,cAAc,GAAG,IAAH;EACM,OAApBC,oBAAoB,GAAG,EAAH;;EACA,WAAhBtwE,gBAAgB,GAAG;IAC5B,MAAMC,KAAK,GAAG0vE,eAAe,CAACxpG,SAA9B;IACA,OAAOiD,MAAM,CAAC,IAAD,EAAO,kBAAP,EAA2B,IAAIkyB,eAAJ,CAAoB,CAAC,CAAC,CAAC,WAAD,EAAc,eAAd,CAAD,EAAiC2E,KAAK,CAACswE,UAAvC,EAAmD;MAC9Gj0E,IAAI,EAAE,CAAC,CAAD;IADwG,CAAnD,CAAD,EAExD,CAAC,CAAC,YAAD,EAAe,gBAAf,CAAD,EAAmC2D,KAAK,CAACswE,UAAzC,EAAqD;MACvDj0E,IAAI,EAAE,CAAC,CAAD;IADiD,CAArD,CAFwD,EAIxD,CAAC,CAAC,SAAD,EAAY,aAAZ,CAAD,EAA6B2D,KAAK,CAACswE,UAAnC,EAA+C;MACjDj0E,IAAI,EAAE,CAAC,CAAD;IAD2C,CAA/C,CAJwD,EAMxD,CAAC,CAAC,WAAD,EAAc,eAAd,CAAD,EAAiC2D,KAAK,CAACswE,UAAvC,EAAmD;MACrDj0E,IAAI,EAAE,CAAC,CAAD;IAD+C,CAAnD,CANwD,CAApB,CAA3B,CAAb;EASD;;EACDvhB,WAAW,CAAC8xB,MAAD,EAAS;IAClB,MAAM,EACJ,GAAGA,MADC;MAEJ/xB,IAAI,EAAE;IAFF,CAAN;IAIA,KAAKiQ,KAAL,GAAa8hB,MAAM,CAAC9hB,KAAP,IAAgB4kF,eAAe,CAAC7I,aAA7C;IACA,KAAK,CAACgG,SAAN,GAAkBjgE,MAAM,CAACigE,SAAP,IAAoB6C,eAAe,CAACQ,iBAAtD;IACA,KAAK,CAACh4E,OAAN,GAAgB0U,MAAM,CAAC1U,OAAP,IAAkBw3E,eAAe,CAACO,eAAlD;IACA,KAAK,CAACz4E,KAAN,GAAcoV,MAAM,CAACpV,KAAP,IAAgB,IAA9B;IACA,KAAK,CAAC4N,gBAAN,GAAyBwH,MAAM,CAACxH,gBAAP,IAA2B,EAApD;IACA,KAAK,CAACxX,IAAN,GAAagf,MAAM,CAAChf,IAAP,IAAe,EAA5B;IACA,KAAKunB,YAAL,GAAoB,KAApB;;IACA,IAAIvI,MAAM,CAAC2jE,WAAP,GAAqB,CAAC,CAA1B,EAA6B;MAC3B,KAAK,CAACR,eAAN,GAAwB,IAAxB;MACA,KAAK,CAACS,kBAAN,CAAyB5jE,MAAzB;MACA,KAAK,CAAC6jE,cAAN;IACD,CAJD,MAIO;MACL,KAAK,CAAC9rE,UAAN,GAAmBiI,MAAM,CAACjI,UAA1B;MACA,KAAK,CAACa,YAAN,GAAqBoH,MAAM,CAACpH,YAA5B;MACA,KAAK,CAACC,SAAN,GAAkBmH,MAAM,CAACnH,SAAzB;MACA,KAAK,CAACC,WAAN,GAAoBkH,MAAM,CAAClH,WAA3B;MACA,KAAK,CAACgrE,cAAN;MACA,KAAK,CAACD,cAAN;MACA,KAAK50D,MAAL,CAAY,KAAK3sB,QAAjB;IACD;EACF;;EACuB,IAApBmuB,oBAAoB,GAAG;IACzB,OAAO;MACLxS,MAAM,EAAE,OADH;MAELnhC,IAAI,EAAE,KAAK,CAACqmG,eAAN,GAAwB,gBAAxB,GAA2C,WAF5C;MAGLjlF,KAAK,EAAE,KAAKwK,UAAL,CAAgB4N,mBAAhB,CAAoCn9B,GAApC,CAAwC,KAAK+kB,KAA7C,CAHF;MAIL+hF,SAAS,EAAE,KAAK,CAACA,SAJZ;MAKLznE,gBAAgB,EAAE,KAAK,CAACA;IALnB,CAAP;EAOD;;EACqB,IAAlBkY,kBAAkB,GAAG;IACvB,OAAO;MACL5zC,IAAI,EAAE,WADD;MAELohB,KAAK,EAAE,KAAKwK,UAAL,CAAgB4N,mBAAhB,CAAoCn9B,GAApC,CAAwC,KAAK+kB,KAA7C;IAFF,CAAP;EAID;;EAC+B,OAAzB41B,yBAAyB,CAAC/xB,IAAD,EAAO;IACrC,OAAO;MACLgiF,cAAc,EAAEhiF,IAAI,CAAC5oB,GAAL,CAAS,OAAT,EAAkBsmB;IAD7B,CAAP;EAGD;;EACD,CAACqkF,cAAc,GAAG;IAChB,MAAMrC,QAAQ,GAAG,IAAIlE,QAAJ,CAAa,KAAK,CAAC3yE,KAAnB,EAA0B,KAA1B,CAAjB;IACA,KAAK,CAACs4E,iBAAN,GAA0BzB,QAAQ,CAACtD,WAAT,EAA1B;IACA,CAAC;MACCppF,CAAC,EAAE,KAAKA,CADT;MAECC,CAAC,EAAE,KAAKA,CAFT;MAGC2E,KAAK,EAAE,KAAKA,KAHb;MAICC,MAAM,EAAE,KAAKA;IAJd,IAKG,KAAK,CAACspF,iBAAN,CAAwBl4E,GAL5B;IAMA,MAAMg5E,kBAAkB,GAAG,IAAIzG,QAAJ,CAAa,KAAK,CAAC3yE,KAAnB,EAA0B,MAA1B,EAAkC,KAAlC,EAAyC,KAAKlC,UAAL,CAAgBK,SAAhB,KAA8B,KAAvE,CAA3B;IACA,KAAK,CAACi6E,aAAN,GAAsBgB,kBAAkB,CAAC7F,WAAnB,EAAtB;IACA,MAAM;MACJF;IADI,IAEF,KAAK,CAAC+E,aAAN,CAAoBh4E,GAFxB;IAGA,KAAK,CAACizE,SAAN,GAAkB,CAAC,CAACA,SAAS,CAAC,CAAD,CAAT,GAAe,KAAKlpF,CAArB,IAA0B,KAAK4E,KAAhC,EAAuC,CAACskF,SAAS,CAAC,CAAD,CAAT,GAAe,KAAKjpF,CAArB,IAA0B,KAAK4E,MAAtE,CAAlB;EACD;;EACD,CAACgqF,kBAAkB,CAAC;IAClBV,iBADkB;IAElBS,WAFkB;IAGlBZ;EAHkB,CAAD,EAIhB;IACD,KAAK,CAACG,iBAAN,GAA0BA,iBAA1B;IACA,MAAMe,cAAc,GAAG,GAAvB;IACA,KAAK,CAACjB,aAAN,GAAsBE,iBAAiB,CAAC1B,aAAlB,CAAgC,KAAK,CAACvB,SAAN,GAAkB,CAAlB,GAAsBgE,cAAtD,EAAsE,MAAtE,CAAtB;;IACA,IAAIN,WAAW,IAAI,CAAnB,EAAsB;MACpB,KAAK,CAAC/nF,EAAN,GAAW+nF,WAAX;MACA,KAAK,CAACZ,UAAN,GAAmBA,UAAnB;MACA,KAAK93E,MAAL,CAAYi5E,SAAZ,CAAsBC,YAAtB,CAAmCR,WAAnC,EAAgDT,iBAAhD;MACA,KAAK,CAACE,SAAN,GAAkB,KAAKn4E,MAAL,CAAYi5E,SAAZ,CAAsBE,gBAAtB,CAAuC,KAAK,CAACpB,aAA7C,CAAlB;IACD,CALD,MAKO,IAAI,KAAK/3E,MAAT,EAAiB;MACtB,MAAMgf,KAAK,GAAG,KAAKhf,MAAL,CAAY/D,QAAZ,CAAqB5E,QAAnC;MACA,KAAK2I,MAAL,CAAYi5E,SAAZ,CAAsBG,UAAtB,CAAiC,KAAK,CAACzoF,EAAvC,EAA2CsnF,iBAA3C;MACA,KAAKj4E,MAAL,CAAYi5E,SAAZ,CAAsBI,SAAtB,CAAgC,KAAK,CAAC1oF,EAAtC,EAA0CknF,eAAe,CAAC,CAACyB,UAAjB,CAA4B,KAAK,CAACrB,iBAAN,CAAwBl4E,GAApD,EAAyD,CAACif,KAAK,GAAG,KAAK3nB,QAAb,GAAwB,GAAzB,IAAgC,GAAzF,CAA1C;MACA,KAAK2I,MAAL,CAAYi5E,SAAZ,CAAsBG,UAAtB,CAAiC,KAAK,CAACjB,SAAvC,EAAkD,KAAK,CAACJ,aAAxD;MACA,KAAK/3E,MAAL,CAAYi5E,SAAZ,CAAsBI,SAAtB,CAAgC,KAAK,CAAClB,SAAtC,EAAiDN,eAAe,CAAC,CAACyB,UAAjB,CAA4B,KAAK,CAACvB,aAAN,CAAoBh4E,GAAhD,EAAqDif,KAArD,CAAjD;IACD;;IACD,MAAM;MACJl1B,CADI;MAEJC,CAFI;MAGJ2E,KAHI;MAIJC;IAJI,IAKFspF,iBAAiB,CAACl4E,GALtB;;IAMA,QAAQ,KAAK1I,QAAb;MACE,KAAK,CAAL;QACE,KAAKvN,CAAL,GAASA,CAAT;QACA,KAAKC,CAAL,GAASA,CAAT;QACA,KAAK2E,KAAL,GAAaA,KAAb;QACA,KAAKC,MAAL,GAAcA,MAAd;QACA;;MACF,KAAK,EAAL;QACE;UACE,MAAM,CAACuJ,SAAD,EAAYC,UAAZ,IAA0B,KAAK8jB,gBAArC;UACA,KAAKnyB,CAAL,GAASC,CAAT;UACA,KAAKA,CAAL,GAAS,IAAID,CAAb;UACA,KAAK4E,KAAL,GAAaA,KAAK,GAAGyJ,UAAR,GAAqBD,SAAlC;UACA,KAAKvJ,MAAL,GAAcA,MAAM,GAAGuJ,SAAT,GAAqBC,UAAnC;UACA;QACD;;MACH,KAAK,GAAL;QACE,KAAKrO,CAAL,GAAS,IAAIA,CAAb;QACA,KAAKC,CAAL,GAAS,IAAIA,CAAb;QACA,KAAK2E,KAAL,GAAaA,KAAb;QACA,KAAKC,MAAL,GAAcA,MAAd;QACA;;MACF,KAAK,GAAL;QACE;UACE,MAAM,CAACuJ,SAAD,EAAYC,UAAZ,IAA0B,KAAK8jB,gBAArC;UACA,KAAKnyB,CAAL,GAAS,IAAIC,CAAb;UACA,KAAKA,CAAL,GAASD,CAAT;UACA,KAAK4E,KAAL,GAAaA,KAAK,GAAGyJ,UAAR,GAAqBD,SAAlC;UACA,KAAKvJ,MAAL,GAAcA,MAAM,GAAGuJ,SAAT,GAAqBC,UAAnC;UACA;QACD;IA9BL;;IAgCA,MAAM;MACJ66E;IADI,IAEF,KAAK,CAAC+E,aAAN,CAAoBh4E,GAFxB;IAGA,KAAK,CAACizE,SAAN,GAAkB,CAAC,CAACA,SAAS,CAAC,CAAD,CAAT,GAAelpF,CAAhB,IAAqB4E,KAAtB,EAA6B,CAACskF,SAAS,CAAC,CAAD,CAAT,GAAejpF,CAAhB,IAAqB4E,MAAlD,CAAlB;EACD;;EACgB,OAAV0pB,UAAU,CAACqE,IAAD,EAAOld,SAAP,EAAkB;IACjCqa,gBAAgB,CAACxB,UAAjB,CAA4BqE,IAA5B,EAAkCld,SAAlC;IACAq4E,eAAe,CAAC7I,aAAhB,KAAkCxvE,SAAS,CAACgH,eAAV,EAA2BiE,MAA3B,GAAoCtH,IAApC,GAA2C1gB,KAA3C,IAAoD,SAAtF;EACD;;EACyB,OAAnBwwB,mBAAmB,CAACphC,IAAD,EAAO4Q,KAAP,EAAc;IACtC,QAAQ5Q,IAAR;MACE,KAAKhD,0BAA0B,CAACoF,uBAAhC;QACE4jG,eAAe,CAAC7I,aAAhB,GAAgCvsF,KAAhC;QACA;;MACF,KAAK5T,0BAA0B,CAACqF,mBAAhC;QACE2jG,eAAe,CAACQ,iBAAhB,GAAoC51F,KAApC;QACA;IANJ;EAQD;;EACD4yB,eAAe,CAACvrB,CAAD,EAAIC,CAAJ,EAAO,CAAE;;EACL,IAAf8T,eAAe,GAAG;IACpB,OAAO,KAAK,CAACm1E,SAAb;EACD;;EACDhpE,YAAY,CAACn4B,IAAD,EAAO4Q,KAAP,EAAc;IACxB,QAAQ5Q,IAAR;MACE,KAAKhD,0BAA0B,CAACmF,eAAhC;QACE,KAAK,CAAC++B,WAAN,CAAkBtwB,KAAlB;QACA;;MACF,KAAK5T,0BAA0B,CAACqF,mBAAhC;QACE,KAAK,CAACqlG,eAAN,CAAsB92F,KAAtB;QACA;IANJ;EAQD;;EACmC,WAAzBmvB,yBAAyB,GAAG;IACrC,OAAO,CAAC,CAAC/iC,0BAA0B,CAACoF,uBAA5B,EAAqD4jG,eAAe,CAAC7I,aAArE,CAAD,EAAsF,CAACngG,0BAA0B,CAACqF,mBAA5B,EAAiD2jG,eAAe,CAACQ,iBAAjE,CAAtF,CAAP;EACD;;EACqB,IAAlB9jE,kBAAkB,GAAG;IACvB,OAAO,CAAC,CAAC1lC,0BAA0B,CAACmF,eAA5B,EAA6C,KAAKif,KAAL,IAAc4kF,eAAe,CAAC7I,aAA3E,CAAD,EAA4F,CAACngG,0BAA0B,CAACqF,mBAA5B,EAAiD,KAAK,CAAC8gG,SAAN,IAAmB6C,eAAe,CAACQ,iBAApF,CAA5F,EAAoM,CAACxpG,0BAA0B,CAACsF,cAA5B,EAA4C,KAAK,CAAC+jG,eAAlD,CAApM,CAAP;EACD;;EACD,CAACnlE,WAAW,CAAC9f,KAAD,EAAQ;IAClB,MAAM4sE,QAAQ,GAAG4P,GAAG,IAAI;MACtB,KAAKx8E,KAAL,GAAaw8E,GAAb;MACA,KAAKzvE,MAAL,EAAai5E,SAAb,CAAuBO,WAAvB,CAAmC,KAAK,CAAC7oF,EAAzC,EAA6C8+E,GAA7C;MACA,KAAK,CAAC9yE,WAAN,EAAmBoW,WAAnB,CAA+B08D,GAA/B;IACD,CAJD;;IAKA,MAAMC,UAAU,GAAG,KAAKz8E,KAAxB;IACA,KAAKie,WAAL,CAAiB;MACftO,GAAG,EAAEi9D,QAAQ,CAACnsE,IAAT,CAAc,IAAd,EAAoBT,KAApB,CADU;MAEf4P,IAAI,EAAEg9D,QAAQ,CAACnsE,IAAT,CAAc,IAAd,EAAoBg8E,UAApB,CAFS;MAGf5sE,IAAI,EAAE,KAAKrF,UAAL,CAAgBiX,QAAhB,CAAyBhhB,IAAzB,CAA8B,KAAK+J,UAAnC,EAA+C,IAA/C,CAHS;MAIfsF,QAAQ,EAAE,IAJK;MAKflxB,IAAI,EAAEhD,0BAA0B,CAACmF,eALlB;MAMfivB,mBAAmB,EAAE,IANN;MAOfC,QAAQ,EAAE;IAPK,CAAjB;;IASA,KAAKuV,gBAAL,CAAsB;MACpBzF,MAAM,EAAE,eADY;MAEpB/f,KAAK,EAAE,KAAKwK,UAAL,CAAgB4N,mBAAhB,CAAoCn9B,GAApC,CAAwC+kB,KAAxC;IAFa,CAAtB,EAGG,IAHH;EAID;;EACD,CAACsmF,eAAe,CAACvE,SAAD,EAAY;IAC1B,MAAMyE,cAAc,GAAG,KAAK,CAACzE,SAA7B;;IACA,MAAM0E,YAAY,GAAGC,EAAE,IAAI;MACzB,KAAK,CAAC3E,SAAN,GAAkB2E,EAAlB;MACA,KAAK,CAACC,eAAN,CAAsBD,EAAtB;IACD,CAHD;;IAIA,KAAKzoE,WAAL,CAAiB;MACftO,GAAG,EAAE82E,YAAY,CAAChmF,IAAb,CAAkB,IAAlB,EAAwBshF,SAAxB,CADU;MAEfnyE,IAAI,EAAE62E,YAAY,CAAChmF,IAAb,CAAkB,IAAlB,EAAwB+lF,cAAxB,CAFS;MAGf32E,IAAI,EAAE,KAAKrF,UAAL,CAAgBiX,QAAhB,CAAyBhhB,IAAzB,CAA8B,KAAK+J,UAAnC,EAA+C,IAA/C,CAHS;MAIfsF,QAAQ,EAAE,IAJK;MAKflxB,IAAI,EAAEhD,0BAA0B,CAACiF,aALlB;MAMfmvB,mBAAmB,EAAE,IANN;MAOfC,QAAQ,EAAE;IAPK,CAAjB;;IASA,KAAKuV,gBAAL,CAAsB;MACpBzF,MAAM,EAAE,mBADY;MAEpBgiE;IAFoB,CAAtB,EAGG,IAHH;EAID;;EACK3yD,cAAc,GAAG;IAAA;IAAA;;IAAA;MACrB,MAAM3lB,OAAO,SAAS,4CAAtB;;MACA,IAAI,CAACA,OAAL,EAAc;QACZ,OAAO,IAAP;MACD;;MACD,IAAI,OAAI,CAACe,UAAL,CAAgB+I,eAApB,EAAqC;QACnC,OAAI,CAAC,CAAC7J,WAAN,GAAoB,IAAIxtB,WAAJ,CAAgB;UAClCytB,MAAM,EAAE;QAD0B,CAAhB,CAApB;QAGAF,OAAO,CAAC2C,cAAR,CAAuB,OAAI,CAAC,CAAC1C,WAA7B;MACD;;MACD,OAAOD,OAAP;IAXqB;EAYtB;;EACDyoB,cAAc,GAAG;IACf,MAAMA,cAAN;IACA,KAAKn0B,GAAL,CAASyN,SAAT,CAAmB+N,MAAnB,CAA0B,UAA1B,EAAsC,IAAtC;EACD;;EACD4Y,aAAa,GAAG;IACd,MAAMA,aAAN;IACA,KAAKp0B,GAAL,CAASyN,SAAT,CAAmB+N,MAAnB,CAA0B,UAA1B,EAAsC,KAAtC;EACD;;EACDiR,iBAAiB,GAAG;IAClB,OAAO,MAAMA,iBAAN,CAAwB,KAAK,CAACo8D,WAAN,EAAxB,CAAP;EACD;;EACDn7D,kBAAkB,GAAG;IACnB,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;EACD;;EACD8E,OAAO,CAACtN,EAAD,EAAKC,EAAL,EAAS;IACd,OAAO,MAAMqN,OAAN,CAActN,EAAd,EAAkBC,EAAlB,EAAsB,KAAK,CAAC0jE,WAAN,EAAtB,CAAP;EACD;;EACDj2D,SAAS,GAAG;IACV,KAAK5jB,MAAL,CAAY85E,iBAAZ,CAA8B,IAA9B;IACA,KAAK9oF,GAAL,CAASkb,KAAT;EACD;;EACDrZ,MAAM,GAAG;IACP,KAAK,CAACknF,cAAN;;IACA,KAAKthE,gBAAL,CAAsB;MACpBzF,MAAM,EAAE;IADY,CAAtB;;IAGA,MAAMngB,MAAN;EACD;;EACDwjB,OAAO,GAAG;IACR,IAAI,CAAC,KAAKrW,MAAV,EAAkB;MAChB;IACD;;IACD,MAAMqW,OAAN;;IACA,IAAI,KAAKrlB,GAAL,KAAa,IAAjB,EAAuB;MACrB;IACD;;IACD,KAAK,CAAC4nF,cAAN;;IACA,IAAI,CAAC,KAAK18D,eAAV,EAA2B;MACzB,KAAKlc,MAAL,CAAYtB,GAAZ,CAAgB,IAAhB;IACD;EACF;;EACDkf,SAAS,CAAC5d,MAAD,EAAS;IAChB,IAAIg6E,cAAc,GAAG,KAArB;;IACA,IAAI,KAAKh6E,MAAL,IAAe,CAACA,MAApB,EAA4B;MAC1B,KAAK,CAAC+5E,cAAN;IACD,CAFD,MAEO,IAAI/5E,MAAJ,EAAY;MACjB,KAAK,CAAC44E,cAAN,CAAqB54E,MAArB;MACAg6E,cAAc,GAAG,CAAC,KAAKh6E,MAAN,IAAgB,KAAKhP,GAAL,EAAUyN,SAAV,CAAoB4J,QAApB,CAA6B,gBAA7B,CAAjC;IACD;;IACD,MAAMuV,SAAN,CAAgB5d,MAAhB;IACA,KAAKpB,IAAL,CAAU,KAAKmc,UAAf;;IACA,IAAIi/D,cAAJ,EAAoB;MAClB,KAAKplE,MAAL;IACD;EACF;;EACD,CAACglE,eAAe,CAAC5E,SAAD,EAAY;IAC1B,IAAI,CAAC,KAAK,CAACkD,eAAX,EAA4B;MAC1B;IACD;;IACD,KAAK,CAACS,kBAAN,CAAyB;MACvBV,iBAAiB,EAAE,KAAK,CAACA,iBAAN,CAAwB1B,aAAxB,CAAsCvB,SAAS,GAAG,CAAlD;IADI,CAAzB;IAGA,KAAKv3D,iBAAL;IACA,MAAM,CAAC1G,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,KAAKqD,OAAL,CAAa,KAAK5wB,KAAL,GAAaqoB,WAA1B,EAAuC,KAAKpoB,MAAL,GAAcqoB,YAArD;EACD;;EACD,CAAC+iE,cAAc,GAAG;IAChB,IAAI,KAAK,CAACppF,EAAN,KAAa,IAAb,IAAqB,CAAC,KAAKqP,MAA/B,EAAuC;MACrC;IACD;;IACD,KAAKA,MAAL,CAAYi5E,SAAZ,CAAsBpmF,MAAtB,CAA6B,KAAK,CAAClC,EAAnC;IACA,KAAK,CAACA,EAAN,GAAW,IAAX;IACA,KAAKqP,MAAL,CAAYi5E,SAAZ,CAAsBpmF,MAAtB,CAA6B,KAAK,CAACslF,SAAnC;IACA,KAAK,CAACA,SAAN,GAAkB,IAAlB;EACD;;EACD,CAACS,cAAc,CAAC54E,MAAM,GAAG,KAAKA,MAAf,EAAuB;IACpC,IAAI,KAAK,CAACrP,EAAN,KAAa,IAAjB,EAAuB;MACrB;IACD;;IACD,CAAC;MACCA,EAAE,EAAE,KAAK,CAACA,EADX;MAECmnF,UAAU,EAAE,KAAK,CAACA;IAFnB,IAGG93E,MAAM,CAACi5E,SAAP,CAAiB/7E,SAAjB,CAA2B,KAAK,CAAC+6E,iBAAjC,EAAoD,KAAKhlF,KAAzD,EAAgE,KAAK,CAACoN,OAAtE,CAHJ;IAIA,KAAK,CAAC83E,SAAN,GAAkBn4E,MAAM,CAACi5E,SAAP,CAAiBE,gBAAjB,CAAkC,KAAK,CAACpB,aAAxC,CAAlB;;IACA,IAAI,KAAK,CAACC,YAAV,EAAwB;MACtB,KAAK,CAACA,YAAN,CAAmB/mF,KAAnB,CAAyB0wE,QAAzB,GAAoC,KAAK,CAACmW,UAA1C;IACD;EACF;;EACiB,OAAX,CAACwB,UAAU,CAAC;IACjBxvF,CADiB;IAEjBC,CAFiB;IAGjB2E,KAHiB;IAIjBC;EAJiB,CAAD,EAKfqwB,KALe,EAKR;IACR,QAAQA,KAAR;MACE,KAAK,EAAL;QACE,OAAO;UACLl1B,CAAC,EAAE,IAAIC,CAAJ,GAAQ4E,MADN;UAEL5E,CAAC,EAAED,CAFE;UAGL4E,KAAK,EAAEC,MAHF;UAILA,MAAM,EAAED;QAJH,CAAP;;MAMF,KAAK,GAAL;QACE,OAAO;UACL5E,CAAC,EAAE,IAAIA,CAAJ,GAAQ4E,KADN;UAEL3E,CAAC,EAAE,IAAIA,CAAJ,GAAQ4E,MAFN;UAGLD,KAHK;UAILC;QAJK,CAAP;;MAMF,KAAK,GAAL;QACE,OAAO;UACL7E,CAAC,EAAEC,CADE;UAELA,CAAC,EAAE,IAAID,CAAJ,GAAQ4E,KAFN;UAGLA,KAAK,EAAEC,MAHF;UAILA,MAAM,EAAED;QAJH,CAAP;IAhBJ;;IAuBA,OAAO;MACL5E,CADK;MAELC,CAFK;MAGL2E,KAHK;MAILC;IAJK,CAAP;EAMD;;EACDq1B,MAAM,CAAChF,KAAD,EAAQ;IACZ,MAAM;MACJi6D;IADI,IAEF,KAAKj5E,MAFT;IAGA,IAAID,GAAJ;;IACA,IAAI,KAAK,CAACm4E,eAAV,EAA2B;MACzBl5D,KAAK,GAAG,CAACA,KAAK,GAAG,KAAK3nB,QAAb,GAAwB,GAAzB,IAAgC,GAAxC;MACA0I,GAAG,GAAG83E,eAAe,CAAC,CAACyB,UAAjB,CAA4B,KAAK,CAACrB,iBAAN,CAAwBl4E,GAApD,EAAyDif,KAAzD,CAAN;IACD,CAHD,MAGO;MACLjf,GAAG,GAAG83E,eAAe,CAAC,CAACyB,UAAjB,CAA4B,IAA5B,EAAkCt6D,KAAlC,CAAN;IACD;;IACDi6D,SAAS,CAACj1D,MAAV,CAAiB,KAAK,CAACrzB,EAAvB,EAA2BquB,KAA3B;IACAi6D,SAAS,CAACj1D,MAAV,CAAiB,KAAK,CAACm0D,SAAvB,EAAkCn5D,KAAlC;IACAi6D,SAAS,CAACI,SAAV,CAAoB,KAAK,CAAC1oF,EAA1B,EAA8BoP,GAA9B;IACAk5E,SAAS,CAACI,SAAV,CAAoB,KAAK,CAAClB,SAA1B,EAAqCN,eAAe,CAAC,CAACyB,UAAjB,CAA4B,KAAK,CAACvB,aAAN,CAAoBh4E,GAAhD,EAAqDif,KAArD,CAArC;EACD;;EACD3hB,MAAM,GAAG;IACP,IAAI,KAAKrM,GAAT,EAAc;MACZ,OAAO,KAAKA,GAAZ;IACD;;IACD,MAAMA,GAAG,GAAG,MAAMqM,MAAN,EAAZ;;IACA,IAAI,KAAK,CAACtH,IAAV,EAAgB;MACd/E,GAAG,CAAChB,YAAJ,CAAiB,YAAjB,EAA+B,KAAK,CAAC+F,IAArC;MACA/E,GAAG,CAAChB,YAAJ,CAAiB,MAAjB,EAAyB,MAAzB;IACD;;IACD,IAAI,KAAK,CAACkoF,eAAV,EAA2B;MACzBlnF,GAAG,CAACyN,SAAJ,CAAcC,GAAd,CAAkB,MAAlB;IACD,CAFD,MAEO;MACL,KAAK1N,GAAL,CAAS2M,gBAAT,CAA0B,SAA1B,EAAqC,KAAK,CAACwR,OAAN,CAAczb,IAAd,CAAmB,IAAnB,CAArC,EAA+D;QAC7D8J,MAAM,EAAE,KAAKC,UAAL,CAAgBC;MADqC,CAA/D;IAGD;;IACD,MAAMs6E,YAAY,GAAG,KAAK,CAACA,YAAN,GAAqBvnF,QAAQ,CAACR,aAAT,CAAuB,KAAvB,CAA1C;IACAe,GAAG,CAACS,MAAJ,CAAWumF,YAAX;IACAA,YAAY,CAAChoF,YAAb,CAA0B,aAA1B,EAAyC,MAAzC;IACAgoF,YAAY,CAACz6E,SAAb,GAAyB,UAAzB;IACAy6E,YAAY,CAAC/mF,KAAb,CAAmB0wE,QAAnB,GAA8B,KAAK,CAACmW,UAApC;IACA,MAAM,CAAC/gE,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,KAAKqD,OAAL,CAAa,KAAK5wB,KAAL,GAAaqoB,WAA1B,EAAuC,KAAKpoB,MAAL,GAAcqoB,YAArD;IACA9W,UAAU,CAAC,IAAD,EAAO,KAAK,CAAC83E,YAAb,EAA2B,CAAC,aAAD,EAAgB,cAAhB,CAA3B,CAAV;IACA,KAAK5yD,aAAL;IACA,OAAOp0B,GAAP;EACD;;EACDipF,WAAW,GAAG;IACZ,KAAKj6E,MAAL,CAAYi5E,SAAZ,CAAsBiB,QAAtB,CAA+B,KAAK,CAAC/B,SAArC,EAAgD,SAAhD;EACD;;EACDgC,YAAY,GAAG;IACb,KAAKn6E,MAAL,CAAYi5E,SAAZ,CAAsBmB,WAAtB,CAAkC,KAAK,CAACjC,SAAxC,EAAmD,SAAnD;EACD;;EACD,CAAChpE,OAAO,CAACnL,KAAD,EAAQ;IACd6zE,eAAe,CAAC3vE,gBAAhB,CAAiC5O,IAAjC,CAAsC,IAAtC,EAA4C0K,KAA5C;EACD;;EACDy0E,UAAU,CAAC36E,SAAD,EAAY;IACpB,KAAKkC,MAAL,CAAY8T,QAAZ,CAAqB,IAArB;;IACA,QAAQhW,SAAR;MACE,KAAK,CAAL;MACA,KAAK,CAAL;QACE,KAAK,CAACu8E,QAAN,CAAe,IAAf;QACA;;MACF,KAAK,CAAL;MACA,KAAK,CAAL;QACE,KAAK,CAACA,QAAN,CAAe,KAAf;QACA;IARJ;EAUD;;EACD,CAACA,QAAQ,CAACjnF,KAAD,EAAQ;IACf,IAAI,CAAC,KAAK,CAAC0Z,UAAX,EAAuB;MACrB;IACD;;IACD,MAAMU,SAAS,GAAG9R,MAAM,CAAC+R,YAAP,EAAlB;;IACA,IAAIra,KAAJ,EAAW;MACToa,SAAS,CAAC4+D,WAAV,CAAsB,KAAK,CAACt/D,UAA5B,EAAwC,KAAK,CAACa,YAA9C;IACD,CAFD,MAEO;MACLH,SAAS,CAAC4+D,WAAV,CAAsB,KAAK,CAACx+D,SAA5B,EAAuC,KAAK,CAACC,WAA7C;IACD;EACF;;EACD+G,MAAM,GAAG;IACP,MAAMA,MAAN;;IACA,IAAI,CAAC,KAAK,CAACujE,SAAX,EAAsB;MACpB;IACD;;IACD,KAAKn4E,MAAL,EAAai5E,SAAb,CAAuBmB,WAAvB,CAAmC,KAAK,CAACjC,SAAzC,EAAoD,SAApD;IACA,KAAKn4E,MAAL,EAAai5E,SAAb,CAAuBiB,QAAvB,CAAgC,KAAK,CAAC/B,SAAtC,EAAiD,UAAjD;EACD;;EACDrkE,QAAQ,GAAG;IACT,MAAMA,QAAN;;IACA,IAAI,CAAC,KAAK,CAACqkE,SAAX,EAAsB;MACpB;IACD;;IACD,KAAKn4E,MAAL,EAAai5E,SAAb,CAAuBmB,WAAvB,CAAmC,KAAK,CAACjC,SAAzC,EAAoD,UAApD;;IACA,IAAI,CAAC,KAAK,CAACD,eAAX,EAA4B;MAC1B,KAAK,CAACmC,QAAN,CAAe,KAAf;IACD;EACF;;EACmB,IAAhBx7D,gBAAgB,GAAG;IACrB,OAAO,CAAC,KAAK,CAACq5D,eAAd;EACD;;EACDt5E,IAAI,CAACsU,OAAO,GAAG,KAAK6H,UAAhB,EAA4B;IAC9B,MAAMnc,IAAN,CAAWsU,OAAX;;IACA,IAAI,KAAKlT,MAAT,EAAiB;MACf,KAAKA,MAAL,CAAYi5E,SAAZ,CAAsBr6E,IAAtB,CAA2B,KAAK,CAACjO,EAAjC,EAAqCuiB,OAArC;MACA,KAAKlT,MAAL,CAAYi5E,SAAZ,CAAsBr6E,IAAtB,CAA2B,KAAK,CAACu5E,SAAjC,EAA4CjlE,OAA5C;IACD;EACF;;EACD,CAAC2mE,WAAW,GAAG;IACb,OAAO,KAAK,CAAC3B,eAAN,GAAwB,KAAK7gF,QAA7B,GAAwC,CAA/C;EACD;;EACD,CAACijF,cAAc,GAAG;IAChB,IAAI,KAAK,CAACpC,eAAV,EAA2B;MACzB,OAAO,IAAP;IACD;;IACD,MAAM,CAAChgF,SAAD,EAAYC,UAAZ,IAA0B,KAAK4jB,cAArC;IACA,MAAM,CAAC3jB,KAAD,EAAQC,KAAR,IAAiB,KAAK2jB,eAA5B;IACA,MAAMrc,KAAK,GAAG,KAAK,CAACA,KAApB;IACA,MAAMshE,UAAU,GAAG,IAAIsZ,YAAJ,CAAiB56E,KAAK,CAACvd,MAAN,GAAe,CAAhC,CAAnB;IACA,IAAI4B,CAAC,GAAG,CAAR;;IACA,KAAK,MAAM;MACT8F,CADS;MAETC,CAFS;MAGT2E,KAHS;MAITC;IAJS,CAAX,IAKKgR,KALL,EAKY;MACV,MAAMrX,EAAE,GAAGwB,CAAC,GAAGoO,SAAJ,GAAgBE,KAA3B;MACA,MAAM7P,EAAE,GAAG,CAAC,IAAIwB,CAAJ,GAAQ4E,MAAT,IAAmBwJ,UAAnB,GAAgCE,KAA3C;MACA4oE,UAAU,CAACj9E,CAAD,CAAV,GAAgBi9E,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAV,GAAoBsE,EAApC;MACA24E,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAV,GAAoBi9E,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAV,GAAoBuE,EAAxC;MACA04E,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAV,GAAoBi9E,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAV,GAAoBsE,EAAE,GAAGoG,KAAK,GAAGwJ,SAArD;MACA+oE,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAV,GAAoBi9E,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAV,GAAoBuE,EAAE,GAAGoG,MAAM,GAAGwJ,UAAtD;MACAnU,CAAC,IAAI,CAAL;IACD;;IACD,OAAOi9E,UAAP;EACD;;EACD,CAACuZ,iBAAiB,CAAC/xF,IAAD,EAAO;IACvB,OAAO,KAAK,CAACwvF,iBAAN,CAAwBl0E,SAAxB,CAAkCtb,IAAlC,EAAwC,KAAK,CAACoxF,WAAN,EAAxC,CAAP;EACD;;EACuB,OAAjBY,iBAAiB,CAACz6E,MAAD,EAASJ,KAAT,EAAgB;IACtC+I,MAAM,EAAEyE,SAD8B;IAEtCtjB,CAFsC;IAGtCC;EAHsC,CAAhB,EAIrB;IACD,MAAM;MACJD,CAAC,EAAEsiB,MADC;MAEJriB,CAAC,EAAEsiB,MAFC;MAGJ3d,KAAK,EAAEqoB,WAHH;MAIJpoB,MAAM,EAAEqoB;IAJJ,IAKF5J,SAAS,CAACd,qBAAV,EALJ;IAMA,MAAM1B,EAAE,GAAG,IAAIxF,eAAJ,EAAX;IACA,MAAM5H,MAAM,GAAGwC,MAAM,CAAC2K,cAAP,CAAsBC,EAAtB,CAAf;;IACA,MAAMhN,WAAW,GAAG3D,CAAC,IAAI;MACvBA,CAAC,CAACC,cAAF;MACAD,CAAC,CAACgE,eAAF;IACD,CAHD;;IAIA,MAAMuiB,iBAAiB,GAAGvmB,CAAC,IAAI;MAC7B2Q,EAAE,CAACL,KAAH;MACA,KAAK,CAACmwE,YAAN,CAAmB16E,MAAnB,EAA2B/F,CAA3B;IACD,CAHD;;IAIAyB,MAAM,CAACiC,gBAAP,CAAwB,MAAxB,EAAgC6iB,iBAAhC,EAAmD;MACjDhjB;IADiD,CAAnD;IAGA9B,MAAM,CAACiC,gBAAP,CAAwB,WAAxB,EAAqC6iB,iBAArC,EAAwD;MACtDhjB;IADsD,CAAxD;IAGA9B,MAAM,CAACiC,gBAAP,CAAwB,aAAxB,EAAuCC,WAAvC,EAAoD;MAClDW,OAAO,EAAE,IADyC;MAElD2hB,OAAO,EAAE,KAFyC;MAGlD1iB;IAHkD,CAApD;IAKA9B,MAAM,CAACiC,gBAAP,CAAwB,aAAxB,EAAuCxsB,aAAvC,EAAsD;MACpDqsB;IADoD,CAAtD;IAGA4P,SAAS,CAACzP,gBAAV,CAA2B,aAA3B,EAA0C,KAAK,CAACg9E,aAAN,CAAoBjnF,IAApB,CAAyB,IAAzB,EAA+BsM,MAA/B,CAA1C,EAAkF;MAChFxC;IADgF,CAAlF;IAGA,KAAK+6E,cAAL,GAAsB,IAAI7D,YAAJ,CAAiB;MACrC5qF,CADqC;MAErCC;IAFqC,CAAjB,EAGnB,CAACqiB,MAAD,EAASC,MAAT,EAAiB0K,WAAjB,EAA8BC,YAA9B,CAHmB,EAG0BhX,MAAM,CAAC5I,KAHjC,EAGwC,KAAKihF,iBAAL,GAAyB,CAHjE,EAGoEz4E,KAHpE,EAG2E,KAH3E,CAAtB;IAIA,CAAC;MACCjP,EAAE,EAAE,KAAK2nF,gBADV;MAECR,UAAU,EAAE,KAAKU;IAFlB,IAGGx4E,MAAM,CAACi5E,SAAP,CAAiB/7E,SAAjB,CAA2B,KAAKq7E,cAAhC,EAAgD,KAAKvJ,aAArD,EAAoE,KAAKoJ,eAAzE,EAA0F,IAA1F,CAHJ;EAID;;EACoB,OAAd,CAACuC,aAAa,CAAC36E,MAAD,EAASgE,KAAT,EAAgB;IACnC,IAAI,KAAKu0E,cAAL,CAAoB75E,GAApB,CAAwBsF,KAAxB,CAAJ,EAAoC;MAClChE,MAAM,CAACi5E,SAAP,CAAiB2B,UAAjB,CAA4B,KAAKtC,gBAAjC,EAAmD,KAAKC,cAAxD;IACD;EACF;;EACmB,OAAb,CAACmC,YAAY,CAAC16E,MAAD,EAASgE,KAAT,EAAgB;IAClC,IAAI,CAAC,KAAKu0E,cAAL,CAAoB9wE,OAApB,EAAL,EAAoC;MAClCzH,MAAM,CAACmO,qBAAP,CAA6BnK,KAA7B,EAAoC,KAApC,EAA2C;QACzC00E,WAAW,EAAE,KAAKJ,gBADuB;QAEzCL,iBAAiB,EAAE,KAAKM,cAAL,CAAoBrF,WAApB,EAFsB;QAGzC4E,UAAU,EAAE,KAAKU,oBAHwB;QAIzCjrE,gBAAgB,EAAE;MAJuB,CAA3C;IAMD,CAPD,MAOO;MACLvN,MAAM,CAACi5E,SAAP,CAAiB4B,mBAAjB,CAAqC,KAAKvC,gBAA1C;IACD;;IACD,KAAKA,gBAAL,GAAwB,CAAC,CAAzB;IACA,KAAKC,cAAL,GAAsB,IAAtB;IACA,KAAKC,oBAAL,GAA4B,EAA5B;EACD;;EACiB,OAAXznE,WAAW,CAACja,IAAD,EAAOkJ,MAAP,EAAeR,SAAf,EAA0B;IAC1C,MAAM5C,MAAM,GAAG,MAAMmU,WAAN,CAAkBja,IAAlB,EAAwBkJ,MAAxB,EAAgCR,SAAhC,CAAf;IACA,MAAM;MACJ/W,IAAI,EAAE,CAAC+4E,GAAD,EAAMC,GAAN,EAAWH,GAAX,EAAgBC,GAAhB,CADF;MAEJtuE,KAFI;MAGJguE;IAHI,IAIFnqE,IAJJ;IAKA8F,MAAM,CAAC3J,KAAP,GAAe1iB,IAAI,CAACiW,YAAL,CAAkB,GAAGyM,KAArB,CAAf;IACA2J,MAAM,CAAC,CAACyD,OAAR,GAAkBvJ,IAAI,CAACuJ,OAAvB;IACA,MAAM,CAACnI,SAAD,EAAYC,UAAZ,IAA0ByE,MAAM,CAACmf,cAAvC;IACAnf,MAAM,CAAClO,KAAP,GAAe,CAAC4yE,GAAG,GAAGE,GAAP,IAActpE,SAA7B;IACA0E,MAAM,CAACjO,MAAP,GAAgB,CAAC4yE,GAAG,GAAGE,GAAP,IAActpE,UAA9B;IACA,MAAMwH,KAAK,GAAG/C,MAAM,CAAC,CAAC+C,KAAR,GAAgB,EAA9B;;IACA,KAAK,IAAI3b,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGi9E,UAAU,CAAC7+E,MAA/B,EAAuC4B,CAAC,IAAI,CAA5C,EAA+C;MAC7C2b,KAAK,CAACrb,IAAN,CAAW;QACTwF,CAAC,EAAE,CAACm3E,UAAU,CAAC,CAAD,CAAV,GAAgBK,GAAjB,IAAwBppE,SADlB;QAETnO,CAAC,EAAE,CAACw3E,GAAG,IAAI,IAAIN,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAlB,CAAJ,IAAkCmU,UAF5B;QAGTzJ,KAAK,EAAE,CAACuyE,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAV,GAAoBi9E,UAAU,CAACj9E,CAAD,CAA/B,IAAsCkU,SAHpC;QAITvJ,MAAM,EAAE,CAACsyE,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAAV,GAAoBi9E,UAAU,CAACj9E,CAAC,GAAG,CAAL,CAA/B,IAA0CmU;MAJzC,CAAX;IAMD;;IACDyE,MAAM,CAAC,CAACi8E,cAAR;IACA,OAAOj8E,MAAP;EACD;;EACDmH,SAAS,CAACmV,YAAY,GAAG,KAAhB,EAAuB;IAC9B,IAAI,KAAKzR,OAAL,MAAkByR,YAAtB,EAAoC;MAClC,OAAO,IAAP;IACD;;IACD,MAAMzwB,IAAI,GAAG,KAAK+6B,OAAL,CAAa,CAAb,EAAgB,CAAhB,CAAb;;IACA,MAAMvwB,KAAK,GAAG4mB,gBAAgB,CAACuB,aAAjB,CAA+BvW,OAA/B,CAAuC,KAAK5R,KAA5C,CAAd;;IACA,OAAO;MACLkoE,cAAc,EAAErsF,oBAAoB,CAACuE,SADhC;MAEL4f,KAFK;MAGLoN,OAAO,EAAE,KAAK,CAACA,OAHV;MAIL20E,SAAS,EAAE,KAAK,CAACA,SAJZ;MAKL/T,UAAU,EAAE,KAAK,CAACqZ,cAAN,EALP;MAML5G,QAAQ,EAAE,KAAK,CAAC8G,iBAAN,CAAwB/xF,IAAxB,CANL;MAOLspB,SAAS,EAAE,KAAKA,SAPX;MAQLtpB,IARK;MASL4O,QAAQ,EAAE,KAAK,CAACwiF,WAAN,EATL;MAULzH,kBAAkB,EAAE,KAAKv2D;IAVpB,CAAP;EAYD;;EAC6B,OAAvBjJ,uBAAuB,GAAG;IAC/B,OAAO,KAAP;EACD;;AAhnB4C;;AAmnB/C,C,CAAC;;AAMD,MAAMkoE,SAAN,SAAwBjhE,gBAAxB,CAAyC;EACvC,CAACkhE,UAAD,GAAc,CAAd;EACA,CAACC,SAAD,GAAa,CAAb;EACA,CAACC,0BAAD,GAA8B,IAA9B;EACA,CAACC,aAAD,GAAiB,IAAI1rD,MAAJ,EAAjB;EACA,CAACrK,cAAD,GAAkB,KAAlB;EACA,CAACg2D,SAAD,GAAa,IAAb;EACA,CAACC,kBAAD,GAAsB,KAAtB;EACA,CAACC,mBAAD,GAAuB,KAAvB;EACA,CAACC,QAAD,GAAY,IAAZ;EACA,CAACC,aAAD,GAAiB,IAAjB;EACA,CAACC,SAAD,GAAa,CAAb;EACA,CAACC,UAAD,GAAc,CAAd;EACA,CAACC,oBAAD,GAAwB,IAAxB;EACoB,OAAb1M,aAAa,GAAG,IAAH;EACE,OAAfoJ,eAAe,GAAG,CAAH;EACE,OAAjBC,iBAAiB,GAAG,CAAH;EACZ,OAALj8D,KAAK,GAAG,KAAH;EACM,OAAX+yD,WAAW,GAAGrgG,oBAAoB,CAACyE,GAAxB;;EAClB0P,WAAW,CAAC8xB,MAAD,EAAS;IAClB,MAAM,EACJ,GAAGA,MADC;MAEJ/xB,IAAI,EAAE;IAFF,CAAN;IAIA,KAAKiQ,KAAL,GAAa8hB,MAAM,CAAC9hB,KAAP,IAAgB,IAA7B;IACA,KAAK+hF,SAAL,GAAiBjgE,MAAM,CAACigE,SAAP,IAAoB,IAArC;IACA,KAAK30E,OAAL,GAAe0U,MAAM,CAAC1U,OAAP,IAAkB,IAAjC;IACA,KAAKwpC,KAAL,GAAa,EAAb;IACA,KAAK8xC,YAAL,GAAoB,EAApB;IACA,KAAKC,WAAL,GAAmB,EAAnB;IACA,KAAKC,WAAL,GAAmB,EAAnB;IACA,KAAK9G,WAAL,GAAmB,CAAnB;IACA,KAAK+G,YAAL,GAAoB,KAAKC,YAAL,GAAoB,CAAxC;IACA,KAAKjyF,CAAL,GAAS,CAAT;IACA,KAAKC,CAAL,GAAS,CAAT;IACA,KAAK4xB,oBAAL,GAA4B,IAA5B;EACD;;EACgB,OAAVtD,UAAU,CAACqE,IAAD,EAAOld,SAAP,EAAkB;IACjCqa,gBAAgB,CAACxB,UAAjB,CAA4BqE,IAA5B,EAAkCld,SAAlC;EACD;;EACyB,OAAnByT,mBAAmB,CAACphC,IAAD,EAAO4Q,KAAP,EAAc;IACtC,QAAQ5Q,IAAR;MACE,KAAKhD,0BAA0B,CAACiF,aAAhC;QACEgnG,SAAS,CAACzC,iBAAV,GAA8B51F,KAA9B;QACA;;MACF,KAAK5T,0BAA0B,CAACgF,SAAhC;QACEinG,SAAS,CAAC9L,aAAV,GAA0BvsF,KAA1B;QACA;;MACF,KAAK5T,0BAA0B,CAACkF,WAAhC;QACE+mG,SAAS,CAAC1C,eAAV,GAA4B31F,KAAK,GAAG,GAApC;QACA;IATJ;EAWD;;EACDunB,YAAY,CAACn4B,IAAD,EAAO4Q,KAAP,EAAc;IACxB,QAAQ5Q,IAAR;MACE,KAAKhD,0BAA0B,CAACiF,aAAhC;QACE,KAAK,CAACylG,eAAN,CAAsB92F,KAAtB;QACA;;MACF,KAAK5T,0BAA0B,CAACgF,SAAhC;QACE,KAAK,CAACk/B,WAAN,CAAkBtwB,KAAlB;QACA;;MACF,KAAK5T,0BAA0B,CAACkF,WAAhC;QACE,KAAK,CAACioG,aAAN,CAAoBv5F,KAApB;QACA;IATJ;EAWD;;EACmC,WAAzBmvB,yBAAyB,GAAG;IACrC,OAAO,CAAC,CAAC/iC,0BAA0B,CAACiF,aAA5B,EAA2CgnG,SAAS,CAACzC,iBAArD,CAAD,EAA0E,CAACxpG,0BAA0B,CAACgF,SAA5B,EAAuCinG,SAAS,CAAC9L,aAAV,IAA2Bn1D,gBAAgB,CAACwC,iBAAnF,CAA1E,EAAiL,CAACxtC,0BAA0B,CAACkF,WAA5B,EAAyCmQ,IAAI,CAAC0P,KAAL,CAAWknF,SAAS,CAAC1C,eAAV,GAA4B,GAAvC,CAAzC,CAAjL,CAAP;EACD;;EACqB,IAAlB7jE,kBAAkB,GAAG;IACvB,OAAO,CAAC,CAAC1lC,0BAA0B,CAACiF,aAA5B,EAA2C,KAAKkhG,SAAL,IAAkB8F,SAAS,CAACzC,iBAAvE,CAAD,EAA4F,CAACxpG,0BAA0B,CAACgF,SAA5B,EAAuC,KAAKof,KAAL,IAAc6nF,SAAS,CAAC9L,aAAxB,IAAyCn1D,gBAAgB,CAACwC,iBAAjG,CAA5F,EAAiN,CAACxtC,0BAA0B,CAACkF,WAA5B,EAAyCmQ,IAAI,CAAC0P,KAAL,CAAW,OAAO,KAAKyM,OAAL,IAAgBy6E,SAAS,CAAC1C,eAAjC,CAAX,CAAzC,CAAjN,CAAP;EACD;;EACD,CAACmB,eAAe,CAACvE,SAAD,EAAY;IAC1B,MAAM0E,YAAY,GAAGC,EAAE,IAAI;MACzB,KAAK3E,SAAL,GAAiB2E,EAAjB;MACA,KAAK,CAACsC,YAAN;IACD,CAHD;;IAIA,MAAMxC,cAAc,GAAG,KAAKzE,SAA5B;IACA,KAAK9jE,WAAL,CAAiB;MACftO,GAAG,EAAE82E,YAAY,CAAChmF,IAAb,CAAkB,IAAlB,EAAwBshF,SAAxB,CADU;MAEfnyE,IAAI,EAAE62E,YAAY,CAAChmF,IAAb,CAAkB,IAAlB,EAAwB+lF,cAAxB,CAFS;MAGf32E,IAAI,EAAE,KAAKrF,UAAL,CAAgBiX,QAAhB,CAAyBhhB,IAAzB,CAA8B,KAAK+J,UAAnC,EAA+C,IAA/C,CAHS;MAIfsF,QAAQ,EAAE,IAJK;MAKflxB,IAAI,EAAEhD,0BAA0B,CAACiF,aALlB;MAMfmvB,mBAAmB,EAAE,IANN;MAOfC,QAAQ,EAAE;IAPK,CAAjB;EASD;;EACD,CAAC6P,WAAW,CAAC9f,KAAD,EAAQ;IAClB,MAAM4sE,QAAQ,GAAG4P,GAAG,IAAI;MACtB,KAAKx8E,KAAL,GAAaw8E,GAAb;MACA,KAAK,CAACyM,MAAN;IACD,CAHD;;IAIA,MAAMxM,UAAU,GAAG,KAAKz8E,KAAxB;IACA,KAAKie,WAAL,CAAiB;MACftO,GAAG,EAAEi9D,QAAQ,CAACnsE,IAAT,CAAc,IAAd,EAAoBT,KAApB,CADU;MAEf4P,IAAI,EAAEg9D,QAAQ,CAACnsE,IAAT,CAAc,IAAd,EAAoBg8E,UAApB,CAFS;MAGf5sE,IAAI,EAAE,KAAKrF,UAAL,CAAgBiX,QAAhB,CAAyBhhB,IAAzB,CAA8B,KAAK+J,UAAnC,EAA+C,IAA/C,CAHS;MAIfsF,QAAQ,EAAE,IAJK;MAKflxB,IAAI,EAAEhD,0BAA0B,CAACgF,SALlB;MAMfovB,mBAAmB,EAAE,IANN;MAOfC,QAAQ,EAAE;IAPK,CAAjB;EASD;;EACD,CAAC84E,aAAa,CAAC37E,OAAD,EAAU;IACtB,MAAM87E,UAAU,GAAG/rC,EAAE,IAAI;MACvB,KAAK/vC,OAAL,GAAe+vC,EAAf;MACA,KAAK,CAAC8rC,MAAN;IACD,CAHD;;IAIA77E,OAAO,IAAI,GAAX;IACA,MAAM+7E,YAAY,GAAG,KAAK/7E,OAA1B;IACA,KAAK6Q,WAAL,CAAiB;MACftO,GAAG,EAAEu5E,UAAU,CAACzoF,IAAX,CAAgB,IAAhB,EAAsB2M,OAAtB,CADU;MAEfwC,IAAI,EAAEs5E,UAAU,CAACzoF,IAAX,CAAgB,IAAhB,EAAsB0oF,YAAtB,CAFS;MAGft5E,IAAI,EAAE,KAAKrF,UAAL,CAAgBiX,QAAhB,CAAyBhhB,IAAzB,CAA8B,KAAK+J,UAAnC,EAA+C,IAA/C,CAHS;MAIfsF,QAAQ,EAAE,IAJK;MAKflxB,IAAI,EAAEhD,0BAA0B,CAACkF,WALlB;MAMfkvB,mBAAmB,EAAE,IANN;MAOfC,QAAQ,EAAE;IAPK,CAAjB;EASD;;EACDmT,OAAO,GAAG;IACR,IAAI,CAAC,KAAKrW,MAAV,EAAkB;MAChB;IACD;;IACD,MAAMqW,OAAN;;IACA,IAAI,KAAKrlB,GAAL,KAAa,IAAjB,EAAuB;MACrB;IACD;;IACD,IAAI,CAAC,KAAKpC,MAAV,EAAkB;MAChB,KAAK,CAACogC,YAAN;MACA,KAAK,CAACqtD,cAAN;IACD;;IACD,IAAI,CAAC,KAAKngE,eAAV,EAA2B;MACzB,KAAKlc,MAAL,CAAYtB,GAAZ,CAAgB,IAAhB;MACA,KAAK,CAAC49E,aAAN;IACD;;IACD,KAAK,CAACL,YAAN;EACD;;EACDppF,MAAM,GAAG;IACP,IAAI,KAAKjE,MAAL,KAAgB,IAApB,EAA0B;MACxB;IACD;;IACD,IAAI,CAAC,KAAK6Y,OAAL,EAAL,EAAqB;MACnB,KAAKuN,MAAL;IACD;;IACD,KAAKpmB,MAAL,CAAYF,KAAZ,GAAoB,KAAKE,MAAL,CAAYD,MAAZ,GAAqB,CAAzC;IACA,KAAKC,MAAL,CAAYiE,MAAZ;IACA,KAAKjE,MAAL,GAAc,IAAd;;IACA,IAAI,KAAK,CAACqsF,0BAAV,EAAsC;MACpCvwE,YAAY,CAAC,KAAK,CAACuwE,0BAAP,CAAZ;MACA,KAAK,CAACA,0BAAN,GAAmC,IAAnC;IACD;;IACD,KAAK,CAACK,QAAN,EAAgBiB,UAAhB;IACA,KAAK,CAACjB,QAAN,GAAiB,IAAjB;IACA,MAAMzoF,MAAN;EACD;;EACD+qB,SAAS,CAAC5d,MAAD,EAAS;IAChB,IAAI,CAAC,KAAKA,MAAN,IAAgBA,MAApB,EAA4B;MAC1B,KAAKvC,UAAL,CAAgBiP,mBAAhB,CAAoC,IAApC;IACD,CAFD,MAEO,IAAI,KAAK1M,MAAL,IAAeA,MAAM,KAAK,IAA9B,EAAoC;MACzC,KAAKvC,UAAL,CAAgBgP,gBAAhB,CAAiC,IAAjC;IACD;;IACD,MAAMmR,SAAN,CAAgB5d,MAAhB;EACD;;EACD4J,eAAe,GAAG;IAChB,MAAM,CAACmN,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,MAAMvtB,KAAK,GAAG,KAAKA,KAAL,GAAaqoB,WAA3B;IACA,MAAMpoB,MAAM,GAAG,KAAKA,MAAL,GAAcqoB,YAA7B;IACA,KAAKwlE,aAAL,CAAmB9tF,KAAnB,EAA0BC,MAA1B;EACD;;EACDk1B,cAAc,GAAG;IACf,IAAI,KAAK,CAACsB,cAAN,IAAwB,KAAKv2B,MAAL,KAAgB,IAA5C,EAAkD;MAChD;IACD;;IACD,MAAMi1B,cAAN;IACA,KAAKvG,YAAL,GAAoB,KAApB;IACA,KAAK,CAACm/D,sBAAN;EACD;;EACD34D,eAAe,GAAG;IAChB,IAAI,CAAC,KAAKvJ,YAAL,EAAD,IAAwB,KAAK3rB,MAAL,KAAgB,IAA5C,EAAkD;MAChD;IACD;;IACD,MAAMk1B,eAAN;IACA,KAAKxG,YAAL,GAAoB,CAAC,KAAK7V,OAAL,EAArB;IACA,KAAKzW,GAAL,CAASyN,SAAT,CAAmB5L,MAAnB,CAA0B,SAA1B;IACA,KAAK,CAAC6pF,yBAAN;EACD;;EACD94D,SAAS,GAAG;IACV,KAAKtG,YAAL,GAAoB,CAAC,KAAK7V,OAAL,EAArB;EACD;;EACDA,OAAO,GAAG;IACR,OAAO,KAAKoiC,KAAL,CAAWznD,MAAX,KAAsB,CAAtB,IAA2B,KAAKynD,KAAL,CAAWznD,MAAX,KAAsB,CAAtB,IAA2B,KAAKynD,KAAL,CAAW,CAAX,EAAcznD,MAAd,KAAyB,CAAtF;EACD;;EACD,CAACu6F,cAAc,GAAG;IAChB,MAAM;MACJn/D,cADI;MAEJvB,gBAAgB,EAAE,CAACvtB,KAAD,EAAQC,MAAR;IAFd,IAGF,IAHJ;;IAIA,QAAQ6uB,cAAR;MACE,KAAK,EAAL;QACE,OAAO,CAAC,CAAD,EAAI7uB,MAAJ,EAAYA,MAAZ,EAAoBD,KAApB,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAACA,KAAD,EAAQC,MAAR,EAAgBD,KAAhB,EAAuBC,MAAvB,CAAP;;MACF,KAAK,GAAL;QACE,OAAO,CAACD,KAAD,EAAQ,CAAR,EAAWC,MAAX,EAAmBD,KAAnB,CAAP;;MACF;QACE,OAAO,CAAC,CAAD,EAAI,CAAJ,EAAOA,KAAP,EAAcC,MAAd,CAAP;IARJ;EAUD;;EACD,CAACiuF,SAAS,GAAG;IACX,MAAM;MACJhhF,GADI;MAEJ3I,KAFI;MAGJoN,OAHI;MAIJ20E,SAJI;MAKJ71D,WALI;MAMJ41D;IANI,IAOF,IAPJ;IAQAn5E,GAAG,CAACojC,SAAJ,GAAgBg2C,SAAS,GAAG71D,WAAZ,GAA0B41D,WAA1C;IACAn5E,GAAG,CAACgmC,OAAJ,GAAc,OAAd;IACAhmC,GAAG,CAACimC,QAAJ,GAAe,OAAf;IACAjmC,GAAG,CAACkmC,UAAJ,GAAiB,EAAjB;IACAlmC,GAAG,CAAC27B,WAAJ,GAAmB,GAAEtkC,KAAM,GAAEmN,YAAY,CAACC,OAAD,CAAU,EAAnD;EACD;;EACD,CAACw8E,YAAY,CAAC/yF,CAAD,EAAIC,CAAJ,EAAO;IAClB,KAAK6E,MAAL,CAAY+O,gBAAZ,CAA6B,aAA7B,EAA4CxsB,aAA5C,EAA2D;MACzDqsB,MAAM,EAAE,KAAKC,UAAL,CAAgBC;IADiC,CAA3D;IAGA,KAAK,CAACg/E,yBAAN;IACA,KAAK,CAACvB,SAAN,GAAkB,IAAI/1E,eAAJ,EAAlB;;IACA,MAAM5H,MAAM,GAAG,KAAKC,UAAL,CAAgBkN,cAAhB,CAA+B,KAAK,CAACwwE,SAArC,CAAf;;IACA,KAAKvsF,MAAL,CAAY+O,gBAAZ,CAA6B,cAA7B,EAA6C,KAAKm/E,kBAAL,CAAwBppF,IAAxB,CAA6B,IAA7B,CAA7C,EAAiF;MAC/E8J;IAD+E,CAAjF;IAGA,KAAK5O,MAAL,CAAY+O,gBAAZ,CAA6B,aAA7B,EAA4C,KAAKo/E,iBAAL,CAAuBrpF,IAAvB,CAA4B,IAA5B,CAA5C,EAA+E;MAC7E8J;IAD6E,CAA/E;IAGA,KAAK5O,MAAL,CAAY+O,gBAAZ,CAA6B,WAA7B,EAA0C,KAAKq/E,eAAL,CAAqBtpF,IAArB,CAA0B,IAA1B,CAA1C,EAA2E;MACzE8J;IADyE,CAA3E;IAGA,KAAKgK,SAAL,GAAiB,IAAjB;;IACA,IAAI,CAAC,KAAK,CAAC6zE,mBAAX,EAAgC;MAC9B,KAAK,CAACA,mBAAN,GAA4B,IAA5B;MACA,KAAK,CAACiB,aAAN;MACA,KAAKtH,SAAL,KAAmB8F,SAAS,CAACzC,iBAA7B;MACA,KAAKplF,KAAL,KAAe6nF,SAAS,CAAC9L,aAAV,IAA2Bn1D,gBAAgB,CAACwC,iBAA3D;MACA,KAAKhc,OAAL,KAAiBy6E,SAAS,CAAC1C,eAA3B;IACD;;IACD,KAAKyD,WAAL,CAAiBv3F,IAAjB,CAAsB,CAACwF,CAAD,EAAIC,CAAJ,CAAtB;IACA,KAAK,CAACqxF,kBAAN,GAA2B,KAA3B;IACA,KAAK,CAACwB,SAAN;;IACA,KAAK,CAAClB,oBAAN,GAA6B,MAAM;MACjC,KAAK,CAACuB,UAAN;;MACA,IAAI,KAAK,CAACvB,oBAAV,EAAgC;QAC9BhgF,MAAM,CAACo8D,qBAAP,CAA6B,KAAK,CAAC4jB,oBAAnC;MACD;IACF,CALD;;IAMAhgF,MAAM,CAACo8D,qBAAP,CAA6B,KAAK,CAAC4jB,oBAAnC;EACD;;EACD,CAACwB,IAAI,CAACpzF,CAAD,EAAIC,CAAJ,EAAO;IACV,MAAM,CAAC+V,KAAD,EAAQD,KAAR,IAAiB,KAAKg8E,WAAL,CAAiB/3E,EAAjB,CAAoB,CAAC,CAArB,CAAvB;;IACA,IAAI,KAAK+3E,WAAL,CAAiBz5F,MAAjB,GAA0B,CAA1B,IAA+B0H,CAAC,KAAKgW,KAArC,IAA8C/V,CAAC,KAAK8V,KAAxD,EAA+D;MAC7D;IACD;;IACD,MAAMg8E,WAAW,GAAG,KAAKA,WAAzB;IACA,IAAIsB,MAAM,GAAG,KAAK,CAACjC,aAAnB;IACAW,WAAW,CAACv3F,IAAZ,CAAiB,CAACwF,CAAD,EAAIC,CAAJ,CAAjB;IACA,KAAK,CAACqxF,kBAAN,GAA2B,IAA3B;;IACA,IAAIS,WAAW,CAACz5F,MAAZ,IAAsB,CAA1B,EAA6B;MAC3B+6F,MAAM,CAACvhG,MAAP,CAAc,GAAGigG,WAAW,CAAC,CAAD,CAA5B;MACAsB,MAAM,CAACthG,MAAP,CAAciO,CAAd,EAAiBC,CAAjB;MACA;IACD;;IACD,IAAI8xF,WAAW,CAACz5F,MAAZ,KAAuB,CAA3B,EAA8B;MAC5B,KAAK,CAAC84F,aAAN,GAAsBiC,MAAM,GAAG,IAAI3tD,MAAJ,EAA/B;MACA2tD,MAAM,CAACvhG,MAAP,CAAc,GAAGigG,WAAW,CAAC,CAAD,CAA5B;IACD;;IACD,KAAK,CAACuB,eAAN,CAAsBD,MAAtB,EAA8B,GAAGtB,WAAW,CAAC/3E,EAAZ,CAAe,CAAC,CAAhB,CAAjC,EAAqD,GAAG+3E,WAAW,CAAC/3E,EAAZ,CAAe,CAAC,CAAhB,CAAxD,EAA4Eha,CAA5E,EAA+EC,CAA/E;EACD;;EACD,CAACpN,OAAO,GAAG;IACT,IAAI,KAAKk/F,WAAL,CAAiBz5F,MAAjB,KAA4B,CAAhC,EAAmC;MACjC;IACD;;IACD,MAAM4wF,SAAS,GAAG,KAAK6I,WAAL,CAAiB/3E,EAAjB,CAAoB,CAAC,CAArB,CAAlB;IACA,KAAK,CAACo3E,aAAN,CAAoBr/F,MAApB,CAA2B,GAAGm3F,SAA9B;EACD;;EACD,CAACqK,WAAW,CAACvzF,CAAD,EAAIC,CAAJ,EAAO;IACjB,KAAK,CAAC2xF,oBAAN,GAA6B,IAA7B;IACA5xF,CAAC,GAAG5F,IAAI,CAACC,GAAL,CAASD,IAAI,CAAC2D,GAAL,CAASiC,CAAT,EAAY,CAAZ,CAAT,EAAyB,KAAK8E,MAAL,CAAYF,KAArC,CAAJ;IACA3E,CAAC,GAAG7F,IAAI,CAACC,GAAL,CAASD,IAAI,CAAC2D,GAAL,CAASkC,CAAT,EAAY,CAAZ,CAAT,EAAyB,KAAK6E,MAAL,CAAYD,MAArC,CAAJ;IACA,KAAK,CAACuuF,IAAN,CAAWpzF,CAAX,EAAcC,CAAd;IACA,KAAK,CAACpN,OAAN;IACA,IAAI2gG,MAAJ;;IACA,IAAI,KAAKzB,WAAL,CAAiBz5F,MAAjB,KAA4B,CAAhC,EAAmC;MACjCk7F,MAAM,GAAG,KAAK,CAACC,oBAAN,EAAT;IACD,CAFD,MAEO;MACL,MAAMC,EAAE,GAAG,CAAC1zF,CAAD,EAAIC,CAAJ,CAAX;MACAuzF,MAAM,GAAG,CAAC,CAACE,EAAD,EAAKA,EAAE,CAAC91F,KAAH,EAAL,EAAiB81F,EAAE,CAAC91F,KAAH,EAAjB,EAA6B81F,EAA7B,CAAD,CAAT;IACD;;IACD,MAAML,MAAM,GAAG,KAAK,CAACjC,aAArB;IACA,MAAMW,WAAW,GAAG,KAAKA,WAAzB;IACA,KAAKA,WAAL,GAAmB,EAAnB;IACA,KAAK,CAACX,aAAN,GAAsB,IAAI1rD,MAAJ,EAAtB;;IACA,MAAM5sB,GAAG,GAAG,MAAM;MAChB,KAAKg5E,WAAL,CAAiBt3F,IAAjB,CAAsBu3F,WAAtB;MACA,KAAKhyC,KAAL,CAAWvlD,IAAX,CAAgBg5F,MAAhB;MACA,KAAK3B,YAAL,CAAkBr3F,IAAlB,CAAuB64F,MAAvB;;MACA,KAAK1/E,UAAL,CAAgB4Y,OAAhB,CAAwB,IAAxB;IACD,CALD;;IAMA,MAAMxT,IAAI,GAAG,MAAM;MACjB,KAAK+4E,WAAL,CAAiB1yC,GAAjB;MACA,KAAKW,KAAL,CAAWX,GAAX;MACA,KAAKyyC,YAAL,CAAkBzyC,GAAlB;;MACA,IAAI,KAAKW,KAAL,CAAWznD,MAAX,KAAsB,CAA1B,EAA6B;QAC3B,KAAKyQ,MAAL;MACD,CAFD,MAEO;QACL,IAAI,CAAC,KAAKjE,MAAV,EAAkB;UAChB,KAAK,CAACogC,YAAN;UACA,KAAK,CAACqtD,cAAN;QACD;;QACD,KAAK,CAACJ,YAAN;MACD;IACF,CAbD;;IAcA,KAAK/qE,WAAL,CAAiB;MACftO,GADe;MAEfC,IAFe;MAGfE,QAAQ,EAAE;IAHK,CAAjB;EAKD;;EACD,CAACk6E,UAAU,GAAG;IACZ,IAAI,CAAC,KAAK,CAAC7B,kBAAX,EAA+B;MAC7B;IACD;;IACD,KAAK,CAACA,kBAAN,GAA2B,KAA3B;IACA,MAAMpG,SAAS,GAAG9wF,IAAI,CAAC+sC,IAAL,CAAU,KAAK+jD,SAAL,GAAiB,KAAK71D,WAAhC,CAAlB;IACA,MAAMs+D,UAAU,GAAG,KAAK5B,WAAL,CAAiBn0F,KAAjB,CAAuB,CAAC,CAAxB,CAAnB;IACA,MAAMoC,CAAC,GAAG2zF,UAAU,CAACz4F,GAAX,CAAew4F,EAAE,IAAIA,EAAE,CAAC,CAAD,CAAvB,CAAV;IACA,MAAMzzF,CAAC,GAAG0zF,UAAU,CAACz4F,GAAX,CAAew4F,EAAE,IAAIA,EAAE,CAAC,CAAD,CAAvB,CAAV;IACA,MAAME,IAAI,GAAGx5F,IAAI,CAACC,GAAL,CAAS,GAAG2F,CAAZ,IAAiBkrF,SAA9B;IACA,MAAM2I,IAAI,GAAGz5F,IAAI,CAAC2D,GAAL,CAAS,GAAGiC,CAAZ,IAAiBkrF,SAA9B;IACA,MAAM4I,IAAI,GAAG15F,IAAI,CAACC,GAAL,CAAS,GAAG4F,CAAZ,IAAiBirF,SAA9B;IACA,MAAM6I,IAAI,GAAG35F,IAAI,CAAC2D,GAAL,CAAS,GAAGkC,CAAZ,IAAiBirF,SAA9B;IACA,MAAM;MACJp5E;IADI,IAEF,IAFJ;IAGAA,GAAG,CAACngB,IAAJ;IACAmgB,GAAG,CAAC01B,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB,KAAK1iC,MAAL,CAAYF,KAAhC,EAAuC,KAAKE,MAAL,CAAYD,MAAnD;;IACA,KAAK,MAAM+uC,IAAX,IAAmB,KAAKi+C,YAAxB,EAAsC;MACpC//E,GAAG,CAACzf,MAAJ,CAAWuhD,IAAX;IACD;;IACD9hC,GAAG,CAACzf,MAAJ,CAAW,KAAK,CAAC++F,aAAjB;IACAt/E,GAAG,CAAClgB,OAAJ;EACD;;EACD,CAAC0hG,eAAe,CAACD,MAAD,EAASj0F,EAAT,EAAaI,EAAb,EAAiBH,EAAjB,EAAqBI,EAArB,EAAyBH,EAAzB,EAA6BI,EAA7B,EAAiC;IAC/C,MAAMgrF,KAAK,GAAG,CAACtrF,EAAE,GAAGC,EAAN,IAAY,CAA1B;IACA,MAAMsrF,KAAK,GAAG,CAACnrF,EAAE,GAAGC,EAAN,IAAY,CAA1B;IACA,MAAMF,EAAE,GAAG,CAACF,EAAE,GAAGC,EAAN,IAAY,CAAvB;IACA,MAAMK,EAAE,GAAG,CAACF,EAAE,GAAGC,EAAN,IAAY,CAAvB;IACA2zF,MAAM,CAACpvD,aAAP,CAAqBymD,KAAK,GAAG,KAAKrrF,EAAE,GAAGqrF,KAAV,IAAmB,CAAhD,EAAmDC,KAAK,GAAG,KAAKlrF,EAAE,GAAGkrF,KAAV,IAAmB,CAA9E,EAAiFprF,EAAE,GAAG,KAAKF,EAAE,GAAGE,EAAV,IAAgB,CAAtG,EAAyGI,EAAE,GAAG,KAAKF,EAAE,GAAGE,EAAV,IAAgB,CAA9H,EAAiIJ,EAAjI,EAAqII,EAArI;EACD;;EACD,CAAC8zF,oBAAoB,GAAG;IACtB,MAAM7/C,IAAI,GAAG,KAAKm+C,WAAlB;;IACA,IAAIn+C,IAAI,CAACt7C,MAAL,IAAe,CAAnB,EAAsB;MACpB,OAAO,CAAC,CAACs7C,IAAI,CAAC,CAAD,CAAL,EAAUA,IAAI,CAAC,CAAD,CAAd,EAAmBA,IAAI,CAAC55B,EAAL,CAAQ,CAAC,CAAT,CAAnB,EAAgC45B,IAAI,CAAC55B,EAAL,CAAQ,CAAC,CAAT,CAAhC,CAAD,CAAP;IACD;;IACD,MAAMg6E,YAAY,GAAG,EAArB;IACA,IAAI95F,CAAJ;IACA,IAAI,CAACkF,EAAD,EAAKI,EAAL,IAAWo0C,IAAI,CAAC,CAAD,CAAnB;;IACA,KAAK15C,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG05C,IAAI,CAACt7C,MAAL,GAAc,CAA9B,EAAiC4B,CAAC,EAAlC,EAAsC;MACpC,MAAM,CAACmF,EAAD,EAAKI,EAAL,IAAWm0C,IAAI,CAAC15C,CAAD,CAArB;MACA,MAAM,CAACoF,EAAD,EAAKI,EAAL,IAAWk0C,IAAI,CAAC15C,CAAC,GAAG,CAAL,CAArB;MACA,MAAMqF,EAAE,GAAG,CAACF,EAAE,GAAGC,EAAN,IAAY,CAAvB;MACA,MAAMK,EAAE,GAAG,CAACF,EAAE,GAAGC,EAAN,IAAY,CAAvB;MACA,MAAMu0F,QAAQ,GAAG,CAAC70F,EAAE,GAAG,KAAKC,EAAE,GAAGD,EAAV,IAAgB,CAAtB,EAAyBI,EAAE,GAAG,KAAKC,EAAE,GAAGD,EAAV,IAAgB,CAA9C,CAAjB;MACA,MAAM00F,QAAQ,GAAG,CAAC30F,EAAE,GAAG,KAAKF,EAAE,GAAGE,EAAV,IAAgB,CAAtB,EAAyBI,EAAE,GAAG,KAAKF,EAAE,GAAGE,EAAV,IAAgB,CAA9C,CAAjB;MACAq0F,YAAY,CAACx5F,IAAb,CAAkB,CAAC,CAAC4E,EAAD,EAAKI,EAAL,CAAD,EAAWy0F,QAAX,EAAqBC,QAArB,EAA+B,CAAC30F,EAAD,EAAKI,EAAL,CAA/B,CAAlB;MACA,CAACP,EAAD,EAAKI,EAAL,IAAW,CAACD,EAAD,EAAKI,EAAL,CAAX;IACD;;IACD,MAAM,CAACN,EAAD,EAAKI,EAAL,IAAWm0C,IAAI,CAAC15C,CAAD,CAArB;IACA,MAAM,CAACoF,EAAD,EAAKI,EAAL,IAAWk0C,IAAI,CAAC15C,CAAC,GAAG,CAAL,CAArB;IACA,MAAM+5F,QAAQ,GAAG,CAAC70F,EAAE,GAAG,KAAKC,EAAE,GAAGD,EAAV,IAAgB,CAAtB,EAAyBI,EAAE,GAAG,KAAKC,EAAE,GAAGD,EAAV,IAAgB,CAA9C,CAAjB;IACA,MAAM00F,QAAQ,GAAG,CAAC50F,EAAE,GAAG,KAAKD,EAAE,GAAGC,EAAV,IAAgB,CAAtB,EAAyBI,EAAE,GAAG,KAAKD,EAAE,GAAGC,EAAV,IAAgB,CAA9C,CAAjB;IACAs0F,YAAY,CAACx5F,IAAb,CAAkB,CAAC,CAAC4E,EAAD,EAAKI,EAAL,CAAD,EAAWy0F,QAAX,EAAqBC,QAArB,EAA+B,CAAC50F,EAAD,EAAKI,EAAL,CAA/B,CAAlB;IACA,OAAOs0F,YAAP;EACD;;EACD,CAAC5B,MAAM,GAAG;IACR,IAAI,KAAKz0E,OAAL,EAAJ,EAAoB;MAClB,KAAK,CAACw2E,eAAN;MACA;IACD;;IACD,KAAK,CAACrB,SAAN;IACA,MAAM;MACJhuF,MADI;MAEJgN;IAFI,IAGF,IAHJ;IAIAA,GAAG,CAACi2B,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B,EAAgC,CAAhC;IACAj2B,GAAG,CAAC01B,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB1iC,MAAM,CAACF,KAA3B,EAAkCE,MAAM,CAACD,MAAzC;IACA,KAAK,CAACsvF,eAAN;;IACA,KAAK,MAAMvgD,IAAX,IAAmB,KAAKi+C,YAAxB,EAAsC;MACpC//E,GAAG,CAACzf,MAAJ,CAAWuhD,IAAX;IACD;EACF;;EACD1oB,MAAM,GAAG;IACP,IAAI,KAAK,CAACmQ,cAAV,EAA0B;MACxB;IACD;;IACD,MAAMnQ,MAAN;IACA,KAAKxN,SAAL,GAAiB,KAAjB;IACA,KAAKsc,eAAL;IACA,KAAKnG,eAAL;IACA,KAAK,CAACwH,cAAN,GAAuB,IAAvB;IACA,KAAKn0B,GAAL,CAASyN,SAAT,CAAmBC,GAAnB,CAAuB,UAAvB;IACA,KAAK,CAACu9E,YAAN,CAAmB,IAAnB;IACA,KAAKrnE,MAAL;IACA,KAAK5U,MAAL,CAAYk+E,oBAAZ,CAAiC,IAAjC;IACA,KAAKp/D,SAAL;IACA,KAAK9tB,GAAL,CAASkb,KAAT,CAAe;MACbgZ,aAAa,EAAE;IADF,CAAf;EAGD;;EACDpH,OAAO,CAAC9Z,KAAD,EAAQ;IACb,IAAI,CAAC,KAAK7F,mBAAV,EAA+B;MAC7B;IACD;;IACD,MAAM2f,OAAN,CAAc9Z,KAAd;IACA,KAAK6f,cAAL;EACD;;EACD,CAAC44D,sBAAsB,GAAG;IACxB,IAAI,KAAK,CAAClB,aAAV,EAAyB;MACvB;IACD;;IACD,KAAK,CAACA,aAAN,GAAsB,IAAIn2E,eAAJ,EAAtB;;IACA,MAAM5H,MAAM,GAAG,KAAKC,UAAL,CAAgBkN,cAAhB,CAA+B,KAAK,CAAC4wE,aAArC,CAAf;;IACA,KAAK3sF,MAAL,CAAY+O,gBAAZ,CAA6B,aAA7B,EAA4C,KAAKwgF,iBAAL,CAAuBzqF,IAAvB,CAA4B,IAA5B,CAA5C,EAA+E;MAC7E8J;IAD6E,CAA/E;EAGD;;EACD,CAACk/E,yBAAyB,GAAG;IAC3B,KAAKnB,aAAL,EAAoBhxE,KAApB;IACA,KAAKgxE,aAAL,GAAqB,IAArB;EACD;;EACD4C,iBAAiB,CAACn6E,KAAD,EAAQ;IACvB,IAAIA,KAAK,CAACjF,MAAN,KAAiB,CAAjB,IAAsB,CAAC,KAAKwb,YAAL,EAAvB,IAA8C,KAAK,CAAC4K,cAAxD,EAAwE;MACtE;IACD;;IACD,KAAKxH,eAAL;IACA3Z,KAAK,CAAC9J,cAAN;;IACA,IAAI,CAAC,KAAKlJ,GAAL,CAASqX,QAAT,CAAkB5X,QAAQ,CAAC6X,aAA3B,CAAL,EAAgD;MAC9C,KAAKtX,GAAL,CAASkb,KAAT,CAAe;QACbgZ,aAAa,EAAE;MADF,CAAf;IAGD;;IACD,KAAK,CAAC23D,YAAN,CAAmB74E,KAAK,CAAC1M,OAAzB,EAAkC0M,KAAK,CAACzM,OAAxC;EACD;;EACDwlF,iBAAiB,CAAC/4E,KAAD,EAAQ;IACvBA,KAAK,CAAC9J,cAAN;IACA,KAAK,CAACgjF,IAAN,CAAWl5E,KAAK,CAAC1M,OAAjB,EAA0B0M,KAAK,CAACzM,OAAhC;EACD;;EACDylF,eAAe,CAACh5E,KAAD,EAAQ;IACrBA,KAAK,CAAC9J,cAAN;IACA,KAAK,CAACg9B,UAAN,CAAiBlzB,KAAjB;EACD;;EACD84E,kBAAkB,CAAC94E,KAAD,EAAQ;IACxB,KAAK,CAACkzB,UAAN,CAAiBlzB,KAAjB;EACD;;EACD,CAACkzB,UAAU,CAAClzB,KAAD,EAAQ;IACjB,KAAK,CAACm3E,SAAN,EAAiB5wE,KAAjB;IACA,KAAK,CAAC4wE,SAAN,GAAkB,IAAlB;IACA,KAAK,CAACsB,sBAAN;;IACA,IAAI,KAAK,CAACxB,0BAAV,EAAsC;MACpCvwE,YAAY,CAAC,KAAK,CAACuwE,0BAAP,CAAZ;IACD;;IACD,KAAK,CAACA,0BAAN,GAAmCpnE,UAAU,CAAC,MAAM;MAClD,KAAK,CAAConE,0BAAN,GAAmC,IAAnC;MACA,KAAKrsF,MAAL,CAAY2lD,mBAAZ,CAAgC,aAAhC,EAA+CpjE,aAA/C;IACD,CAH4C,EAG1C,EAH0C,CAA7C;IAIA,KAAK,CAACksG,WAAN,CAAkBr5E,KAAK,CAAC1M,OAAxB,EAAiC0M,KAAK,CAACzM,OAAvC;IACA,KAAK+W,sBAAL;IACA,KAAKoP,eAAL;EACD;;EACD,CAACsR,YAAY,GAAG;IACd,KAAKpgC,MAAL,GAAc6B,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAd;IACA,KAAKrB,MAAL,CAAYF,KAAZ,GAAoB,KAAKE,MAAL,CAAYD,MAAZ,GAAqB,CAAzC;IACA,KAAKC,MAAL,CAAY2O,SAAZ,GAAwB,iBAAxB;IACA,KAAK3O,MAAL,CAAYoB,YAAZ,CAAyB,cAAzB,EAAyC,kBAAzC;IACA,KAAKgB,GAAL,CAASS,MAAT,CAAgB,KAAK7C,MAArB;IACA,KAAKgN,GAAL,GAAW,KAAKhN,MAAL,CAAYG,UAAZ,CAAuB,IAAvB,CAAX;EACD;;EACD,CAACstF,cAAc,GAAG;IAChB,KAAK,CAACf,QAAN,GAAiB,IAAI8C,cAAJ,CAAmB/sE,OAAO,IAAI;MAC7C,MAAM5oB,IAAI,GAAG4oB,OAAO,CAAC,CAAD,CAAP,CAAWgtE,WAAxB;;MACA,IAAI51F,IAAI,CAACiG,KAAL,IAAcjG,IAAI,CAACkG,MAAvB,EAA+B;QAC7B,KAAK6tF,aAAL,CAAmB/zF,IAAI,CAACiG,KAAxB,EAA+BjG,IAAI,CAACkG,MAApC;MACD;IACF,CALgB,CAAjB;IAMA,KAAK,CAAC2sF,QAAN,CAAegD,OAAf,CAAuB,KAAKttF,GAA5B;;IACA,KAAKyM,UAAL,CAAgBC,OAAhB,CAAwBC,gBAAxB,CAAyC,OAAzC,EAAkD,MAAM;MACtD,KAAK,CAAC29E,QAAN,EAAgBiB,UAAhB;MACA,KAAK,CAACjB,QAAN,GAAiB,IAAjB;IACD,CAHD,EAGG;MACD1vE,IAAI,EAAE;IADL,CAHH;EAMD;;EACc,IAAXuY,WAAW,GAAG;IAChB,OAAO,CAAC,KAAK1c,OAAL,EAAD,IAAmB,KAAK,CAAC0d,cAAhC;EACD;;EACD9nB,MAAM,GAAG;IACP,IAAI,KAAKrM,GAAT,EAAc;MACZ,OAAO,KAAKA,GAAZ;IACD;;IACD,IAAI4/E,KAAJ,EAAWC,KAAX;;IACA,IAAI,KAAKniF,KAAT,EAAgB;MACdkiF,KAAK,GAAG,KAAK9mF,CAAb;MACA+mF,KAAK,GAAG,KAAK9mF,CAAb;IACD;;IACD,MAAMsT,MAAN;IACA,KAAKrM,GAAL,CAAShB,YAAT,CAAsB,cAAtB,EAAsC,WAAtC;IACA,MAAM,CAAClG,CAAD,EAAIC,CAAJ,EAAOsS,CAAP,EAAUC,CAAV,IAAe,KAAK,CAACqgF,cAAN,EAArB;IACA,KAAKz+D,KAAL,CAAWp0B,CAAX,EAAcC,CAAd,EAAiB,CAAjB,EAAoB,CAApB;IACA,KAAKu1B,OAAL,CAAajjB,CAAb,EAAgBC,CAAhB;IACA,KAAK,CAAC0yB,YAAN;;IACA,IAAI,KAAKtgC,KAAT,EAAgB;MACd,MAAM,CAACqoB,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;MACA,KAAKqJ,cAAL,CAAoB,KAAK52B,KAAL,GAAaqoB,WAAjC,EAA8C,KAAKpoB,MAAL,GAAcqoB,YAA5D;MACA,KAAKkH,KAAL,CAAW0yD,KAAK,GAAG75D,WAAnB,EAAgC85D,KAAK,GAAG75D,YAAxC,EAAsD,KAAKtoB,KAAL,GAAaqoB,WAAnE,EAAgF,KAAKpoB,MAAL,GAAcqoB,YAA9F;MACA,KAAK,CAACqkE,mBAAN,GAA4B,IAA5B;MACA,KAAK,CAACiB,aAAN;MACA,KAAKh9D,OAAL,CAAa,KAAK5wB,KAAL,GAAaqoB,WAA1B,EAAuC,KAAKpoB,MAAL,GAAcqoB,YAArD;MACA,KAAK,CAACklE,MAAN;MACA,KAAKlrF,GAAL,CAASyN,SAAT,CAAmBC,GAAnB,CAAuB,UAAvB;IACD,CATD,MASO;MACL,KAAK1N,GAAL,CAASyN,SAAT,CAAmBC,GAAnB,CAAuB,SAAvB;MACA,KAAKmlB,cAAL;IACD;;IACD,KAAK,CAACw4D,cAAN;IACA,OAAO,KAAKrrF,GAAZ;EACD;;EACD,CAACsrF,aAAa,GAAG;IACf,IAAI,CAAC,KAAK,CAACjB,mBAAX,EAAgC;MAC9B;IACD;;IACD,MAAM,CAACtkE,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,KAAKrtB,MAAL,CAAYF,KAAZ,GAAoBxK,IAAI,CAAC+sC,IAAL,CAAU,KAAKviC,KAAL,GAAaqoB,WAAvB,CAApB;IACA,KAAKnoB,MAAL,CAAYD,MAAZ,GAAqBzK,IAAI,CAAC+sC,IAAL,CAAU,KAAKtiC,MAAL,GAAcqoB,YAAxB,CAArB;IACA,KAAK,CAACinE,eAAN;EACD;;EACDzB,aAAa,CAAC9tF,KAAD,EAAQC,MAAR,EAAgB;IAC3B,MAAM4vF,YAAY,GAAGr6F,IAAI,CAAC0P,KAAL,CAAWlF,KAAX,CAArB;IACA,MAAM8vF,aAAa,GAAGt6F,IAAI,CAAC0P,KAAL,CAAWjF,MAAX,CAAtB;;IACA,IAAI,KAAK,CAAC6sF,SAAN,KAAoB+C,YAApB,IAAoC,KAAK,CAAC9C,UAAN,KAAqB+C,aAA7D,EAA4E;MAC1E;IACD;;IACD,KAAK,CAAChD,SAAN,GAAkB+C,YAAlB;IACA,KAAK,CAAC9C,UAAN,GAAmB+C,aAAnB;IACA,KAAK5vF,MAAL,CAAYqC,KAAZ,CAAkBC,UAAlB,GAA+B,QAA/B;IACA,MAAM,CAAC6lB,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,KAAKvtB,KAAL,GAAaA,KAAK,GAAGqoB,WAArB;IACA,KAAKpoB,MAAL,GAAcA,MAAM,GAAGqoB,YAAvB;IACA,KAAKyG,iBAAL;;IACA,IAAI,KAAK,CAAC0H,cAAV,EAA0B;MACxB,KAAK,CAACs5D,cAAN,CAAqB/vF,KAArB,EAA4BC,MAA5B;IACD;;IACD,KAAK,CAAC2tF,aAAN;IACA,KAAK,CAACJ,MAAN;IACA,KAAKttF,MAAL,CAAYqC,KAAZ,CAAkBC,UAAlB,GAA+B,SAA/B;IACA,KAAKquB,OAAL;EACD;;EACD,CAACk/D,cAAc,CAAC/vF,KAAD,EAAQC,MAAR,EAAgB;IAC7B,MAAMwjF,OAAO,GAAG,KAAK,CAACuM,UAAN,EAAhB;IACA,MAAMC,YAAY,GAAG,CAACjwF,KAAK,GAAGyjF,OAAT,IAAoB,KAAK,CAAC6I,SAA/C;IACA,MAAM4D,YAAY,GAAG,CAACjwF,MAAM,GAAGwjF,OAAV,IAAqB,KAAK,CAAC4I,UAAhD;IACA,KAAKhG,WAAL,GAAmB7wF,IAAI,CAACC,GAAL,CAASw6F,YAAT,EAAuBC,YAAvB,CAAnB;EACD;;EACD,CAACX,eAAe,GAAG;IACjB,MAAM9L,OAAO,GAAG,KAAK,CAACuM,UAAN,KAAqB,CAArC;IACA,KAAK9iF,GAAL,CAASi2B,YAAT,CAAsB,KAAKkjD,WAA3B,EAAwC,CAAxC,EAA2C,CAA3C,EAA8C,KAAKA,WAAnD,EAAgE,KAAK+G,YAAL,GAAoB,KAAK/G,WAAzB,GAAuC5C,OAAvG,EAAgH,KAAK4J,YAAL,GAAoB,KAAKhH,WAAzB,GAAuC5C,OAAvJ;EACD;;EACkB,OAAZ,CAAC0M,WAAW,CAACvB,MAAD,EAAS;IAC1B,MAAMH,MAAM,GAAG,IAAI3tD,MAAJ,EAAf;;IACA,KAAK,IAAIxrC,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGsyF,MAAM,CAACl7F,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,EAA7C,EAAiD;MAC/C,MAAM,CAACmE,KAAD,EAAQ41F,QAAR,EAAkBC,QAAlB,EAA4B51F,MAA5B,IAAsCk1F,MAAM,CAACt5F,CAAD,CAAlD;;MACA,IAAIA,CAAC,KAAK,CAAV,EAAa;QACXm5F,MAAM,CAACvhG,MAAP,CAAc,GAAGuM,KAAjB;MACD;;MACDg1F,MAAM,CAACpvD,aAAP,CAAqBgwD,QAAQ,CAAC,CAAD,CAA7B,EAAkCA,QAAQ,CAAC,CAAD,CAA1C,EAA+CC,QAAQ,CAAC,CAAD,CAAvD,EAA4DA,QAAQ,CAAC,CAAD,CAApE,EAAyE51F,MAAM,CAAC,CAAD,CAA/E,EAAoFA,MAAM,CAAC,CAAD,CAA1F;IACD;;IACD,OAAO+0F,MAAP;EACD;;EACuB,OAAjB,CAAC2B,gBAAgB,CAAC5hD,MAAD,EAASz0C,IAAT,EAAe4O,QAAf,EAAyB;IAC/C,MAAM,CAACmqE,GAAD,EAAMC,GAAN,EAAWH,GAAX,EAAgBC,GAAhB,IAAuB94E,IAA7B;;IACA,QAAQ4O,QAAR;MACE,KAAK,CAAL;QACE,KAAK,IAAIrT,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;UAClDk5C,MAAM,CAACl5C,CAAD,CAAN,IAAaw9E,GAAb;UACAtkC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgBu9E,GAAG,GAAGrkC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAA5B;QACD;;QACD;;MACF,KAAK,EAAL;QACE,KAAK,IAAIA,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;UAClD,MAAM8F,CAAC,GAAGozC,MAAM,CAACl5C,CAAD,CAAhB;UACAk5C,MAAM,CAACl5C,CAAD,CAAN,GAAYk5C,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgBw9E,GAA5B;UACAtkC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgB8F,CAAC,GAAG23E,GAApB;QACD;;QACD;;MACF,KAAK,GAAL;QACE,KAAK,IAAIz9E,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;UAClDk5C,MAAM,CAACl5C,CAAD,CAAN,GAAYs9E,GAAG,GAAGpkC,MAAM,CAACl5C,CAAD,CAAxB;UACAk5C,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,IAAiBy9E,GAAjB;QACD;;QACD;;MACF,KAAK,GAAL;QACE,KAAK,IAAIz9E,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;UAClD,MAAM8F,CAAC,GAAGozC,MAAM,CAACl5C,CAAD,CAAhB;UACAk5C,MAAM,CAACl5C,CAAD,CAAN,GAAYs9E,GAAG,GAAGpkC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAxB;UACAk5C,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgBu9E,GAAG,GAAGz3E,CAAtB;QACD;;QACD;;MACF;QACE,MAAM,IAAItI,KAAJ,CAAU,kBAAV,CAAN;IA5BJ;;IA8BA,OAAO07C,MAAP;EACD;;EACyB,OAAnB,CAAC6hD,kBAAkB,CAAC7hD,MAAD,EAASz0C,IAAT,EAAe4O,QAAf,EAAyB;IACjD,MAAM,CAACmqE,GAAD,EAAMC,GAAN,EAAWH,GAAX,EAAgBC,GAAhB,IAAuB94E,IAA7B;;IACA,QAAQ4O,QAAR;MACE,KAAK,CAAL;QACE,KAAK,IAAIrT,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;UAClDk5C,MAAM,CAACl5C,CAAD,CAAN,IAAaw9E,GAAb;UACAtkC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgBu9E,GAAG,GAAGrkC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAA5B;QACD;;QACD;;MACF,KAAK,EAAL;QACE,KAAK,IAAIA,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;UAClD,MAAM8F,CAAC,GAAGozC,MAAM,CAACl5C,CAAD,CAAhB;UACAk5C,MAAM,CAACl5C,CAAD,CAAN,GAAYk5C,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgBy9E,GAA5B;UACAvkC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgB8F,CAAC,GAAG03E,GAApB;QACD;;QACD;;MACF,KAAK,GAAL;QACE,KAAK,IAAIx9E,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;UAClDk5C,MAAM,CAACl5C,CAAD,CAAN,GAAYs9E,GAAG,GAAGpkC,MAAM,CAACl5C,CAAD,CAAxB;UACAk5C,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,IAAiBy9E,GAAjB;QACD;;QACD;;MACF,KAAK,GAAL;QACE,KAAK,IAAIz9E,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGkyC,MAAM,CAAC96C,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;UAClD,MAAM8F,CAAC,GAAGozC,MAAM,CAACl5C,CAAD,CAAhB;UACAk5C,MAAM,CAACl5C,CAAD,CAAN,GAAYu9E,GAAG,GAAGrkC,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAxB;UACAk5C,MAAM,CAACl5C,CAAC,GAAG,CAAL,CAAN,GAAgBs9E,GAAG,GAAGx3E,CAAtB;QACD;;QACD;;MACF;QACE,MAAM,IAAItI,KAAJ,CAAU,kBAAV,CAAN;IA5BJ;;IA8BA,OAAO07C,MAAP;EACD;;EACD,CAAC8hD,cAAc,CAAC7yD,CAAD,EAAIjW,EAAJ,EAAQC,EAAR,EAAY1tB,IAAZ,EAAkB;IAC/B,MAAMohD,KAAK,GAAG,EAAd;IACA,MAAMsoC,OAAO,GAAG,KAAK6C,SAAL,GAAiB,CAAjC;IACA,MAAMvxD,MAAM,GAAG0I,CAAC,GAAGjW,EAAJ,GAASi8D,OAAxB;IACA,MAAMzuD,MAAM,GAAGyI,CAAC,GAAGhW,EAAJ,GAASg8D,OAAxB;;IACA,KAAK,MAAMmL,MAAX,IAAqB,KAAKzzC,KAA1B,EAAiC;MAC/B,MAAMvkD,MAAM,GAAG,EAAf;MACA,MAAM43C,MAAM,GAAG,EAAf;;MACA,KAAK,IAAI3oC,CAAC,GAAG,CAAR,EAAWykC,EAAE,GAAGskD,MAAM,CAACl7F,MAA5B,EAAoCmS,CAAC,GAAGykC,EAAxC,EAA4CzkC,CAAC,EAA7C,EAAiD;QAC/C,MAAM,CAACpM,KAAD,EAAQ41F,QAAR,EAAkBC,QAAlB,EAA4B51F,MAA5B,IAAsCk1F,MAAM,CAAC/oF,CAAD,CAAlD;;QACA,IAAIpM,KAAK,CAAC,CAAD,CAAL,KAAaC,MAAM,CAAC,CAAD,CAAnB,IAA0BD,KAAK,CAAC,CAAD,CAAL,KAAaC,MAAM,CAAC,CAAD,CAA7C,IAAoD4wC,EAAE,KAAK,CAA/D,EAAkE;UAChE,MAAM2E,EAAE,GAAGxR,CAAC,GAAGhkC,KAAK,CAAC,CAAD,CAAT,GAAes7B,MAA1B;UACA,MAAMj8B,EAAE,GAAG2kC,CAAC,GAAGhkC,KAAK,CAAC,CAAD,CAAT,GAAeu7B,MAA1B;UACAp+B,MAAM,CAAChB,IAAP,CAAYq5C,EAAZ,EAAgBn2C,EAAhB;UACA01C,MAAM,CAAC54C,IAAP,CAAYq5C,EAAZ,EAAgBn2C,EAAhB;UACA;QACD;;QACD,MAAMy3F,GAAG,GAAG9yD,CAAC,GAAGhkC,KAAK,CAAC,CAAD,CAAT,GAAes7B,MAA3B;QACA,MAAMy7D,GAAG,GAAG/yD,CAAC,GAAGhkC,KAAK,CAAC,CAAD,CAAT,GAAeu7B,MAA3B;QACA,MAAMy7D,GAAG,GAAGhzD,CAAC,GAAG4xD,QAAQ,CAAC,CAAD,CAAZ,GAAkBt6D,MAA9B;QACA,MAAM27D,GAAG,GAAGjzD,CAAC,GAAG4xD,QAAQ,CAAC,CAAD,CAAZ,GAAkBr6D,MAA9B;QACA,MAAM27D,GAAG,GAAGlzD,CAAC,GAAG6xD,QAAQ,CAAC,CAAD,CAAZ,GAAkBv6D,MAA9B;QACA,MAAM67D,GAAG,GAAGnzD,CAAC,GAAG6xD,QAAQ,CAAC,CAAD,CAAZ,GAAkBt6D,MAA9B;QACA,MAAM67D,GAAG,GAAGpzD,CAAC,GAAG/jC,MAAM,CAAC,CAAD,CAAV,GAAgBq7B,MAA5B;QACA,MAAM+7D,GAAG,GAAGrzD,CAAC,GAAG/jC,MAAM,CAAC,CAAD,CAAV,GAAgBs7B,MAA5B;;QACA,IAAInvB,CAAC,KAAK,CAAV,EAAa;UACXjP,MAAM,CAAChB,IAAP,CAAY26F,GAAZ,EAAiBC,GAAjB;UACAhiD,MAAM,CAAC54C,IAAP,CAAY26F,GAAZ,EAAiBC,GAAjB;QACD;;QACD55F,MAAM,CAAChB,IAAP,CAAY66F,GAAZ,EAAiBC,GAAjB,EAAsBC,GAAtB,EAA2BC,GAA3B,EAAgCC,GAAhC,EAAqCC,GAArC;QACAtiD,MAAM,CAAC54C,IAAP,CAAY66F,GAAZ,EAAiBC,GAAjB;;QACA,IAAI7qF,CAAC,KAAKykC,EAAE,GAAG,CAAf,EAAkB;UAChBkE,MAAM,CAAC54C,IAAP,CAAYi7F,GAAZ,EAAiBC,GAAjB;QACD;MACF;;MACD31C,KAAK,CAACvlD,IAAN,CAAW;QACTg5F,MAAM,EAAExC,SAAS,CAAC,CAACgE,gBAAX,CAA4Bx5F,MAA5B,EAAoCmD,IAApC,EAA0C,KAAK4O,QAA/C,CADC;QAET6lC,MAAM,EAAE49C,SAAS,CAAC,CAACgE,gBAAX,CAA4B5hD,MAA5B,EAAoCz0C,IAApC,EAA0C,KAAK4O,QAA/C;MAFC,CAAX;IAID;;IACD,OAAOwyC,KAAP;EACD;;EACD,CAAC41C,OAAO,GAAG;IACT,IAAI/B,IAAI,GAAG19C,QAAX;IACA,IAAI29C,IAAI,GAAG,CAAC39C,QAAZ;IACA,IAAI49C,IAAI,GAAG59C,QAAX;IACA,IAAI69C,IAAI,GAAG,CAAC79C,QAAZ;;IACA,KAAK,MAAMtC,IAAX,IAAmB,KAAKmM,KAAxB,EAA+B;MAC7B,KAAK,MAAM,CAAC1hD,KAAD,EAAQ41F,QAAR,EAAkBC,QAAlB,EAA4B51F,MAA5B,CAAX,IAAkDs1C,IAAlD,EAAwD;QACtD,MAAMpO,IAAI,GAAG/+C,IAAI,CAAC8Z,iBAAL,CAAuB,GAAGlC,KAA1B,EAAiC,GAAG41F,QAApC,EAA8C,GAAGC,QAAjD,EAA2D,GAAG51F,MAA9D,CAAb;QACAs1F,IAAI,GAAGx5F,IAAI,CAACC,GAAL,CAASu5F,IAAT,EAAepuD,IAAI,CAAC,CAAD,CAAnB,CAAP;QACAsuD,IAAI,GAAG15F,IAAI,CAACC,GAAL,CAASy5F,IAAT,EAAetuD,IAAI,CAAC,CAAD,CAAnB,CAAP;QACAquD,IAAI,GAAGz5F,IAAI,CAAC2D,GAAL,CAAS81F,IAAT,EAAeruD,IAAI,CAAC,CAAD,CAAnB,CAAP;QACAuuD,IAAI,GAAG35F,IAAI,CAAC2D,GAAL,CAASg2F,IAAT,EAAevuD,IAAI,CAAC,CAAD,CAAnB,CAAP;MACD;IACF;;IACD,OAAO,CAACouD,IAAD,EAAOE,IAAP,EAAaD,IAAb,EAAmBE,IAAnB,CAAP;EACD;;EACD,CAACa,UAAU,GAAG;IACZ,OAAO,KAAK,CAACv5D,cAAN,GAAuBjhC,IAAI,CAAC+sC,IAAL,CAAU,KAAK+jD,SAAL,GAAiB,KAAK71D,WAAhC,CAAvB,GAAsE,CAA7E;EACD;;EACD,CAAC88D,YAAY,CAACxwE,SAAS,GAAG,KAAb,EAAoB;IAC/B,IAAI,KAAKhE,OAAL,EAAJ,EAAoB;MAClB;IACD;;IACD,IAAI,CAAC,KAAK,CAAC0d,cAAX,EAA2B;MACzB,KAAK,CAAC+2D,MAAN;MACA;IACD;;IACD,MAAM5sD,IAAI,GAAG,KAAK,CAACmwD,OAAN,EAAb;IACA,MAAMtN,OAAO,GAAG,KAAK,CAACuM,UAAN,EAAhB;IACA,KAAK,CAAC1D,SAAN,GAAkB92F,IAAI,CAAC2D,GAAL,CAASgyB,gBAAgB,CAACgH,QAA1B,EAAoCyO,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAlD,CAAlB;IACA,KAAK,CAACyrD,UAAN,GAAmB72F,IAAI,CAAC2D,GAAL,CAASgyB,gBAAgB,CAACgH,QAA1B,EAAoCyO,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAlD,CAAnB;IACA,MAAM5gC,KAAK,GAAGxK,IAAI,CAAC+sC,IAAL,CAAUkhD,OAAO,GAAG,KAAK,CAAC6I,SAAN,GAAkB,KAAKjG,WAA3C,CAAd;IACA,MAAMpmF,MAAM,GAAGzK,IAAI,CAAC+sC,IAAL,CAAUkhD,OAAO,GAAG,KAAK,CAAC4I,UAAN,GAAmB,KAAKhG,WAA5C,CAAf;IACA,MAAM,CAACh+D,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,KAAKvtB,KAAL,GAAaA,KAAK,GAAGqoB,WAArB;IACA,KAAKpoB,MAAL,GAAcA,MAAM,GAAGqoB,YAAvB;IACA,KAAKsO,cAAL,CAAoB52B,KAApB,EAA2BC,MAA3B;IACA,MAAM+wF,gBAAgB,GAAG,KAAK5D,YAA9B;IACA,MAAM6D,gBAAgB,GAAG,KAAK5D,YAA9B;IACA,KAAKD,YAAL,GAAoB,CAACxsD,IAAI,CAAC,CAAD,CAAzB;IACA,KAAKysD,YAAL,GAAoB,CAACzsD,IAAI,CAAC,CAAD,CAAzB;IACA,KAAK,CAACgtD,aAAN;IACA,KAAK,CAACJ,MAAN;IACA,KAAK,CAACV,SAAN,GAAkB9sF,KAAlB;IACA,KAAK,CAAC+sF,UAAN,GAAmB9sF,MAAnB;IACA,KAAK2wB,OAAL,CAAa5wB,KAAb,EAAoBC,MAApB;IACA,MAAMixF,eAAe,GAAGn0E,SAAS,GAAG0mE,OAAO,GAAG,KAAK4C,WAAf,GAA6B,CAAhC,GAAoC,CAArE;IACA,KAAK32D,SAAL,CAAeshE,gBAAgB,GAAG,KAAK5D,YAAxB,GAAuC8D,eAAtD,EAAuED,gBAAgB,GAAG,KAAK5D,YAAxB,GAAuC6D,eAA9G;EACD;;EACiB,OAAX7uE,WAAW,CAACja,IAAD,EAAOkJ,MAAP,EAAeR,SAAf,EAA0B;IAC1C,IAAI1I,IAAI,YAAYylE,oBAApB,EAA0C;MACxC,OAAO,IAAP;IACD;;IACD,MAAM3/D,MAAM,GAAG,MAAMmU,WAAN,CAAkBja,IAAlB,EAAwBkJ,MAAxB,EAAgCR,SAAhC,CAAf;IACA5C,MAAM,CAACo4E,SAAP,GAAmBl+E,IAAI,CAACk+E,SAAxB;IACAp4E,MAAM,CAAC3J,KAAP,GAAe1iB,IAAI,CAACiW,YAAL,CAAkB,GAAGsQ,IAAI,CAAC7D,KAA1B,CAAf;IACA2J,MAAM,CAACyD,OAAP,GAAiBvJ,IAAI,CAACuJ,OAAtB;IACA,MAAM,CAACnI,SAAD,EAAYC,UAAZ,IAA0ByE,MAAM,CAACmf,cAAvC;IACA,MAAMrtB,KAAK,GAAGkO,MAAM,CAAClO,KAAP,GAAewJ,SAA7B;IACA,MAAMvJ,MAAM,GAAGiO,MAAM,CAACjO,MAAP,GAAgBwJ,UAA/B;IACA,MAAM48E,WAAW,GAAGn4E,MAAM,CAACuiB,WAA3B;IACA,MAAMgzD,OAAO,GAAGr7E,IAAI,CAACk+E,SAAL,GAAiB,CAAjC;IACAp4E,MAAM,CAAC,CAACuoB,cAAR,GAAyB,IAAzB;IACAvoB,MAAM,CAAC,CAAC4+E,SAAR,GAAoBt3F,IAAI,CAAC0P,KAAL,CAAWlF,KAAX,CAApB;IACAkO,MAAM,CAAC,CAAC6+E,UAAR,GAAqBv3F,IAAI,CAAC0P,KAAL,CAAWjF,MAAX,CAArB;IACA,MAAM;MACJk7C,KADI;MAEJphD,IAFI;MAGJ4O;IAHI,IAIFP,IAJJ;;IAKA,KAAK,IAAI;MACPwmF;IADO,CAAT,IAEKzzC,KAFL,EAEY;MACVyzC,MAAM,GAAGxC,SAAS,CAAC,CAACiE,kBAAX,CAA8BzB,MAA9B,EAAsC70F,IAAtC,EAA4C4O,QAA5C,CAAT;MACA,MAAMqmC,IAAI,GAAG,EAAb;MACA9gC,MAAM,CAACitC,KAAP,CAAavlD,IAAb,CAAkBo5C,IAAlB;MACA,IAAIC,EAAE,GAAGo3C,WAAW,IAAIuI,MAAM,CAAC,CAAD,CAAN,GAAYnL,OAAhB,CAApB;MACA,IAAI3qF,EAAE,GAAGutF,WAAW,IAAIuI,MAAM,CAAC,CAAD,CAAN,GAAYnL,OAAhB,CAApB;;MACA,KAAK,IAAInuF,CAAC,GAAG,CAAR,EAAWgH,EAAE,GAAGsyF,MAAM,CAACl7F,MAA5B,EAAoC4B,CAAC,GAAGgH,EAAxC,EAA4ChH,CAAC,IAAI,CAAjD,EAAoD;QAClD,MAAMi7F,GAAG,GAAGlK,WAAW,IAAIuI,MAAM,CAACt5F,CAAD,CAAN,GAAYmuF,OAAhB,CAAvB;QACA,MAAM+M,GAAG,GAAGnK,WAAW,IAAIuI,MAAM,CAACt5F,CAAC,GAAG,CAAL,CAAN,GAAgBmuF,OAApB,CAAvB;QACA,MAAMgN,GAAG,GAAGpK,WAAW,IAAIuI,MAAM,CAACt5F,CAAC,GAAG,CAAL,CAAN,GAAgBmuF,OAApB,CAAvB;QACA,MAAMiN,GAAG,GAAGrK,WAAW,IAAIuI,MAAM,CAACt5F,CAAC,GAAG,CAAL,CAAN,GAAgBmuF,OAApB,CAAvB;QACA,MAAMkN,GAAG,GAAGtK,WAAW,IAAIuI,MAAM,CAACt5F,CAAC,GAAG,CAAL,CAAN,GAAgBmuF,OAApB,CAAvB;QACA,MAAMmN,GAAG,GAAGvK,WAAW,IAAIuI,MAAM,CAACt5F,CAAC,GAAG,CAAL,CAAN,GAAgBmuF,OAApB,CAAvB;QACAz0C,IAAI,CAACp5C,IAAL,CAAU,CAAC,CAACq5C,EAAD,EAAKn2C,EAAL,CAAD,EAAW,CAACy3F,GAAD,EAAMC,GAAN,CAAX,EAAuB,CAACC,GAAD,EAAMC,GAAN,CAAvB,EAAmC,CAACC,GAAD,EAAMC,GAAN,CAAnC,CAAV;QACA3hD,EAAE,GAAG0hD,GAAL;QACA73F,EAAE,GAAG83F,GAAL;MACD;;MACD,MAAMnC,MAAM,GAAG,KAAK,CAAC0B,WAAN,CAAkBnhD,IAAlB,CAAf;MACA9gC,MAAM,CAAC++E,YAAP,CAAoBr3F,IAApB,CAAyB64F,MAAzB;IACD;;IACD,MAAM7tD,IAAI,GAAG1yB,MAAM,CAAC,CAAC6iF,OAAR,EAAb;IACA7iF,MAAM,CAAC,CAACo+E,SAAR,GAAoB92F,IAAI,CAAC2D,GAAL,CAASgyB,gBAAgB,CAACgH,QAA1B,EAAoCyO,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAlD,CAApB;IACA1yB,MAAM,CAAC,CAACm+E,UAAR,GAAqB72F,IAAI,CAAC2D,GAAL,CAASgyB,gBAAgB,CAACgH,QAA1B,EAAoCyO,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAlD,CAArB;IACA1yB,MAAM,CAAC,CAAC6hF,cAAR,CAAuB/vF,KAAvB,EAA8BC,MAA9B;IACA,OAAOiO,MAAP;EACD;;EACDmH,SAAS,GAAG;IACV,IAAI,KAAK0D,OAAL,EAAJ,EAAoB;MAClB,OAAO,IAAP;IACD;;IACD,MAAMhf,IAAI,GAAG,KAAK+6B,OAAL,CAAa,CAAb,EAAgB,CAAhB,CAAb;;IACA,MAAMvwB,KAAK,GAAG4mB,gBAAgB,CAACuB,aAAjB,CAA+BvW,OAA/B,CAAuC,KAAKjJ,GAAL,CAAS27B,WAAhD,CAAd;;IACA,OAAO;MACL4jC,cAAc,EAAErsF,oBAAoB,CAACyE,GADhC;MAEL0f,KAFK;MAGL+hF,SAAS,EAAE,KAAKA,SAHX;MAIL30E,OAAO,EAAE,KAAKA,OAJT;MAKLwpC,KAAK,EAAE,KAAK,CAACm1C,cAAN,CAAqB,KAAKjK,WAAL,GAAmB,KAAK51D,WAA7C,EAA0D,KAAK28D,YAA/D,EAA6E,KAAKC,YAAlF,EAAgGtzF,IAAhG,CALF;MAMLspB,SAAS,EAAE,KAAKA,SANX;MAOLtpB,IAPK;MAQL4O,QAAQ,EAAE,KAAKA,QARV;MASL+6E,kBAAkB,EAAE,KAAKv2D;IATpB,CAAP;EAWD;;AA9yBsC;;AAizBzC,C,CAAC;;AAKD,MAAMgkE,WAAN,SAA0BhmE,gBAA1B,CAA2C;EACzC,CAAC5Y,MAAD,GAAU,IAAV;EACA,CAAC6+E,QAAD,GAAY,IAAZ;EACA,CAACC,aAAD,GAAiB,IAAjB;EACA,CAACC,SAAD,GAAa,IAAb;EACA,CAACC,UAAD,GAAc,IAAd;EACA,CAACC,cAAD,GAAkB,EAAlB;EACA,CAACtxF,MAAD,GAAU,IAAV;EACA,CAAC0sF,QAAD,GAAY,IAAZ;EACA,CAAC6E,eAAD,GAAmB,IAAnB;EACA,CAACh/E,KAAD,GAAS,KAAT;EACA,CAACi/E,uBAAD,GAA2B,KAA3B;EACY,OAALhkE,KAAK,GAAG,OAAH;EACM,OAAX+yD,WAAW,GAAGrgG,oBAAoB,CAACwE,KAAxB;;EAClB2P,WAAW,CAAC8xB,MAAD,EAAS;IAClB,MAAM,EACJ,GAAGA,MADC;MAEJ/xB,IAAI,EAAE;IAFF,CAAN;IAIA,KAAK,CAACg9F,SAAN,GAAkBjrE,MAAM,CAACirE,SAAzB;IACA,KAAK,CAACC,UAAN,GAAmBlrE,MAAM,CAACkrE,UAA1B;EACD;;EACgB,OAAV5nE,UAAU,CAACqE,IAAD,EAAOld,SAAP,EAAkB;IACjCqa,gBAAgB,CAACxB,UAAjB,CAA4BqE,IAA5B,EAAkCld,SAAlC;EACD;;EACwB,WAAd6gF,cAAc,GAAG;IAC1B,MAAM1uE,KAAK,GAAG,CAAC,MAAD,EAAS,MAAT,EAAiB,KAAjB,EAAwB,KAAxB,EAA+B,MAA/B,EAAuC,KAAvC,EAA8C,SAA9C,EAAyD,MAAzD,EAAiE,QAAjE,CAAd;IACA,OAAOrgC,MAAM,CAAC,IAAD,EAAO,gBAAP,EAAyBqgC,KAAK,CAAC3sB,GAAN,CAAUnT,IAAI,IAAK,SAAQA,IAAK,EAAhC,CAAzB,CAAb;EACD;;EAC2B,WAAjByuG,iBAAiB,GAAG;IAC7B,OAAOhvG,MAAM,CAAC,IAAD,EAAO,mBAAP,EAA4B,KAAK+uG,cAAL,CAAoB97F,IAApB,CAAyB,GAAzB,CAA5B,CAAb;EACD;;EAC8B,OAAxB0rB,wBAAwB,CAACoN,IAAD,EAAO;IACpC,OAAO,KAAKgjE,cAAL,CAAoBv6F,QAApB,CAA6Bu3B,IAA7B,CAAP;EACD;;EACW,OAAL5N,KAAK,CAACU,IAAD,EAAOnQ,MAAP,EAAe;IACzBA,MAAM,CAACugF,WAAP,CAAmBzxG,oBAAoB,CAACwE,KAAxC,EAA+C;MAC7C2sG,UAAU,EAAE9vE,IAAI,CAACqwE,SAAL;IADiC,CAA/C;EAGD;;EACDp+D,aAAa,GAAG;IACd,IAAI,KAAK3kB,UAAL,CAAgBsN,iBAApB,EAAuC;MACrC,KAAK/Z,GAAL,CAAS6pE,MAAT,GAAkB,KAAlB;IACD;;IACD,MAAMz4C,aAAN;EACD;;EACqB,IAAlBqD,kBAAkB,GAAG;IACvB,OAAO;MACL5zC,IAAI,EAAE,OADD;MAELgxC,UAAU,EAAE,CAAC,CAAC,KAAKJ,WAAL,EAAkB3lB;IAF3B,CAAP;EAID;;EAC+B,OAAzB+rB,yBAAyB,CAAC/xB,IAAD,EAAO;IACrC,MAAM2pF,eAAe,GAAG3pF,IAAI,CAAC5oB,GAAL,CAAS,YAAT,CAAxB;IACA,OAAO;MACL20C,UAAU,EAAE49D,eAAe,CAACvyG,GAAhB,CAAoB,IAApB,KAA6B,CADpC;MAELwyG,YAAY,EAAED,eAAe,CAACvyG,GAAhB,CAAoB,KAApB,KAA8B;IAFvC,CAAP;EAID;;EACD,CAACyyG,gBAAgB,CAAC7pF,IAAD,EAAO8pF,MAAM,GAAG,KAAhB,EAAuB;IACtC,IAAI,CAAC9pF,IAAL,EAAW;MACT,KAAKjE,MAAL;MACA;IACD;;IACD,KAAK,CAACoO,MAAN,GAAenK,IAAI,CAACmK,MAApB;;IACA,IAAI,CAAC2/E,MAAL,EAAa;MACX,KAAK,CAACd,QAAN,GAAiBhpF,IAAI,CAACnG,EAAtB;MACA,KAAK,CAACwQ,KAAN,GAAcrK,IAAI,CAACqK,KAAnB;IACD;;IACD,IAAIrK,IAAI,CAACsK,IAAT,EAAe;MACb,KAAK,CAAC8+E,cAAN,GAAuBppF,IAAI,CAACsK,IAAL,CAAUpe,IAAjC;IACD;;IACD,KAAK,CAACgsC,YAAN;EACD;;EACD,CAAC6xD,aAAa,GAAG;IACf,KAAK,CAACd,aAAN,GAAsB,IAAtB;;IACA,KAAKtiF,UAAL,CAAgB4V,aAAhB,CAA8B,KAA9B;;IACA,IAAI,CAAC,KAAK,CAACzkB,MAAX,EAAmB;MACjB;IACD;;IACD,IAAI,KAAK6O,UAAL,CAAgBuN,4BAAhB,IAAgD,KAAKvN,UAAL,CAAgBsN,iBAAhE,IAAqF,KAAK,CAAC9J,MAA/F,EAAuG;MACrG,KAAK4Z,YAAL,CAAkBrc,IAAlB;;MACA,KAAKf,UAAL,CAAgB+N,WAAhB,CAA4B,IAA5B,EAAkC,IAAlC;;MACA;IACD;;IACD,IAAI,CAAC,KAAK/N,UAAL,CAAgBuN,4BAAjB,IAAiD,KAAKvN,UAAL,CAAgBsN,iBAAjE,IAAsF,KAAK,CAAC9J,MAAhG,EAAwG;MACtG,KAAKwX,gBAAL,CAAsB;QACpBzF,MAAM,EAAE,yBADY;QAEpBlc,IAAI,EAAE;UACJgqF,cAAc,EAAE,KADZ;UAEJC,aAAa,EAAE;QAFX;MAFc,CAAtB;;MAOA,IAAI;QACF,KAAKC,cAAL;MACD,CAFD,CAEE,MAAM,CAAE;IACX;;IACD,KAAKhwF,GAAL,CAASkb,KAAT;EACD;;EACK80E,cAAc,CAACt0D,SAAS,GAAG,IAAb,EAAmBu0D,iBAAiB,GAAG,IAAvC,EAA6C;IAAA;;IAAA;MAC/D,IAAI,OAAI,CAACn+D,cAAL,EAAJ,EAA2B;QACzB,OAAO,IAAP;MACD;;MACD,MAAM;QACJ7b;MADI,IAEF,OAAI,CAACxJ,UAFT;;MAGA,IAAI,CAACwJ,SAAL,EAAgB;QACd,MAAM,IAAIzlB,KAAJ,CAAU,QAAV,CAAN;MACD;;MACD,IAAI,QAAQylB,SAAS,CAACi6E,YAAV,CAAuB,SAAvB,CAAR,CAAJ,EAAgD;QAC9C,MAAM,IAAI1/F,KAAJ,CAAU,gCAAV,CAAN;MACD;;MACD,MAAM;QACJsV,IADI;QAEJpI,KAFI;QAGJC;MAHI,IAIF+9B,SAAS,IAAI,OAAI,CAACy0D,UAAL,CAAgB,IAAhB,EAAsB,IAAtB,EAA4Bz0D,SAJ7C;;MAKA,MAAMj3B,QAAQ,SAASwR,SAAS,CAACm6E,KAAV,CAAgB;QACrCp+F,IAAI,EAAE,SAD+B;QAErCmT,OAAO,EAAE;UACPW,IADO;UAEPpI,KAFO;UAGPC,MAHO;UAIP0yF,QAAQ,EAAEvqF,IAAI,CAAC1U,MAAL,IAAesM,KAAK,GAAGC,MAAvB;QAJH;MAF4B,CAAhB,CAAvB;;MASA,IAAI,CAAC8G,QAAL,EAAe;QACb,MAAM,IAAIjU,KAAJ,CAAU,kCAAV,CAAN;MACD;;MACD,IAAIiU,QAAQ,CAACuM,KAAb,EAAoB;QAClB,MAAM,IAAIxgB,KAAJ,CAAU,4BAAV,CAAN;MACD;;MACD,IAAIiU,QAAQ,CAAC2jB,MAAb,EAAqB;QACnB,OAAO,IAAP;MACD;;MACD,IAAI,CAAC3jB,QAAQ,CAACixD,MAAd,EAAsB;QACpB,MAAM,IAAIllE,KAAJ,CAAU,wCAAV,CAAN;MACD;;MACD,MAAMsb,OAAO,GAAGrH,QAAQ,CAACixD,MAAzB;MACA,MAAM,OAAI,CAAC/jC,iBAAL,CAAuB7lB,OAAvB,CAAN;;MACA,IAAImkF,iBAAiB,IAAI,CAAC,OAAI,CAACn+D,cAAL,EAA1B,EAAiD;QAC/C,OAAI,CAACL,WAAL,GAAmB;UACjB6+D,GAAG,EAAExkF,OADY;UAEjBqc,UAAU,EAAE;QAFK,CAAnB;MAID;;MACD,OAAOrc,OAAP;IA/C+D;EAgDhE;;EACD,CAACykF,SAAS,GAAG;IAAA;;IACX,IAAI,KAAK,CAACzB,QAAV,EAAoB;MAClB,KAAKriF,UAAL,CAAgB4V,aAAhB,CAA8B,IAA9B;;MACA,KAAK5V,UAAL,CAAgBkZ,YAAhB,CAA6BvU,SAA7B,CAAuC,KAAK,CAAC09E,QAA7C,EAAuDjpF,IAAvD,CAA4DC,IAAI,IAAI,KAAK,CAAC6pF,gBAAN,CAAuB7pF,IAAvB,EAA6B,IAA7B,CAApE,EAAwG2+D,OAAxG,CAAgH,MAAM,KAAK,CAACorB,aAAN,EAAtH;;MACA;IACD;;IACD,IAAI,KAAK,CAACb,SAAV,EAAqB;MACnB,MAAMp+F,GAAG,GAAG,KAAK,CAACo+F,SAAlB;MACA,KAAK,CAACA,SAAN,GAAkB,IAAlB;;MACA,KAAKviF,UAAL,CAAgB4V,aAAhB,CAA8B,IAA9B;;MACA,KAAK,CAAC0sE,aAAN,GAAsB,KAAKtiF,UAAL,CAAgBkZ,YAAhB,CAA6BxU,UAA7B,CAAwCvgB,GAAxC,EAA6CiV,IAA7C,CAAkDC,IAAI,IAAI,KAAK,CAAC6pF,gBAAN,CAAuB7pF,IAAvB,CAA1D,EAAwF2+D,OAAxF,CAAgG,MAAM,KAAK,CAACorB,aAAN,EAAtG,CAAtB;MACA;IACD;;IACD,IAAI,KAAK,CAACZ,UAAV,EAAsB;MACpB,MAAM7+E,IAAI,GAAG,KAAK,CAAC6+E,UAAnB;MACA,KAAK,CAACA,UAAN,GAAmB,IAAnB;;MACA,KAAKxiF,UAAL,CAAgB4V,aAAhB,CAA8B,IAA9B;;MACA,KAAK,CAAC0sE,aAAN,GAAsB,KAAKtiF,UAAL,CAAgBkZ,YAAhB,CAA6B1U,WAA7B,CAAyCb,IAAzC,EAA+CvK,IAA/C,CAAoDC,IAAI,IAAI,KAAK,CAAC6pF,gBAAN,CAAuB7pF,IAAvB,CAA5D,EAA0F2+D,OAA1F,CAAkG,MAAM,KAAK,CAACorB,aAAN,EAAxG,CAAtB;MACA;IACD;;IACD,MAAMvmF,KAAK,GAAG7J,QAAQ,CAACR,aAAT,CAAuB,OAAvB,CAAd;IACAqK,KAAK,CAACzoB,IAAN,GAAa,MAAb;IACAyoB,KAAK,CAACknF,MAAN,GAAe3B,WAAW,CAACS,iBAA3B;IACA,MAAM9iF,MAAM,GAAG,KAAKC,UAAL,CAAgBC,OAA/B;IACA,KAAK,CAACqiF,aAAN,GAAsB,IAAI/pF,OAAJ,CAAYC,OAAO,IAAI;MAC3CqE,KAAK,CAACqD,gBAAN,CAAuB,QAAvB,iCAAiC,aAAY;QAC3C,IAAI,CAACrD,KAAK,CAACmnF,KAAP,IAAgBnnF,KAAK,CAACmnF,KAAN,CAAYr/F,MAAZ,KAAuB,CAA3C,EAA8C;UAC5C,OAAI,CAACyQ,MAAL;QACD,CAFD,MAEO;UACL,OAAI,CAAC4K,UAAL,CAAgB4V,aAAhB,CAA8B,IAA9B;;UACA,MAAMvc,IAAI,SAAS,OAAI,CAAC2G,UAAL,CAAgBkZ,YAAhB,CAA6B1U,WAA7B,CAAyC3H,KAAK,CAACmnF,KAAN,CAAY,CAAZ,CAAzC,CAAnB;;UACA,OAAI,CAAChpE,gBAAL,CAAsB;YACpBzF,MAAM,EAAE,4BADY;YAEpBlc,IAAI,EAAE;cACJgqF,cAAc,EAAE,OAAI,CAACrjF,UAAL,CAAgBsN;YAD5B;UAFc,CAAtB;;UAMA,OAAI,CAAC,CAAC41E,gBAAN,CAAuB7pF,IAAvB;QACD;;QACDb,OAAO;MACR,CAfD,GAeG;QACDuH;MADC,CAfH;MAkBAlD,KAAK,CAACqD,gBAAN,CAAuB,QAAvB,EAAiC,MAAM;QACrC,KAAK9K,MAAL;QACAoD,OAAO;MACR,CAHD,EAGG;QACDuH;MADC,CAHH;IAMD,CAzBqB,EAyBnBi4D,OAzBmB,CAyBX,MAAM,KAAK,CAACorB,aAAN,EAzBK,CAAtB;IA0BAvmF,KAAK,CAAConF,KAAN;EACD;;EACD7uF,MAAM,GAAG;IACP,IAAI,KAAK,CAACitF,QAAV,EAAoB;MAClB,KAAK,CAAC7+E,MAAN,GAAe,IAAf;;MACA,KAAKxD,UAAL,CAAgBkZ,YAAhB,CAA6BrU,QAA7B,CAAsC,KAAK,CAACw9E,QAA5C;;MACA,KAAK,CAAClxF,MAAN,EAAciE,MAAd;MACA,KAAK,CAACjE,MAAN,GAAe,IAAf;MACA,KAAK,CAAC0sF,QAAN,EAAgBiB,UAAhB;MACA,KAAK,CAACjB,QAAN,GAAiB,IAAjB;;MACA,IAAI,KAAK,CAAC6E,eAAV,EAA2B;QACzBz1E,YAAY,CAAC,KAAK,CAACy1E,eAAP,CAAZ;QACA,KAAK,CAACA,eAAN,GAAwB,IAAxB;MACD;IACF;;IACD,MAAMttF,MAAN;EACD;;EACDwjB,OAAO,GAAG;IACR,IAAI,CAAC,KAAKrW,MAAV,EAAkB;MAChB,IAAI,KAAK,CAAC8/E,QAAV,EAAoB;QAClB,KAAK,CAACyB,SAAN;MACD;;MACD;IACD;;IACD,MAAMlrE,OAAN;;IACA,IAAI,KAAKrlB,GAAL,KAAa,IAAjB,EAAuB;MACrB;IACD;;IACD,IAAI,KAAK,CAAC8uF,QAAN,IAAkB,KAAK,CAAClxF,MAAN,KAAiB,IAAvC,EAA6C;MAC3C,KAAK,CAAC2yF,SAAN;IACD;;IACD,IAAI,CAAC,KAAKrlE,eAAV,EAA2B;MACzB,KAAKlc,MAAL,CAAYtB,GAAZ,CAAgB,IAAhB;IACD;EACF;;EACDklB,SAAS,GAAG;IACV,KAAKtG,YAAL,GAAoB,IAApB;IACA,KAAKtsB,GAAL,CAASkb,KAAT;EACD;;EACDzE,OAAO,GAAG;IACR,OAAO,EAAE,KAAK,CAACs4E,aAAN,IAAuB,KAAK,CAAC9+E,MAA7B,IAAuC,KAAK,CAAC++E,SAA7C,IAA0D,KAAK,CAACC,UAAhE,IAA8E,KAAK,CAACH,QAAtF,CAAP;EACD;;EACc,IAAX37D,WAAW,GAAG;IAChB,OAAO,IAAP;EACD;;EACD9mB,MAAM,GAAG;IACP,IAAI,KAAKrM,GAAT,EAAc;MACZ,OAAO,KAAKA,GAAZ;IACD;;IACD,IAAI4/E,KAAJ,EAAWC,KAAX;;IACA,IAAI,KAAKniF,KAAT,EAAgB;MACdkiF,KAAK,GAAG,KAAK9mF,CAAb;MACA+mF,KAAK,GAAG,KAAK9mF,CAAb;IACD;;IACD,MAAMsT,MAAN;IACA,KAAKrM,GAAL,CAAS6pE,MAAT,GAAkB,IAAlB;IACA,KAAKr4C,gBAAL;;IACA,IAAI,KAAK,CAACvhB,MAAV,EAAkB;MAChB,KAAK,CAAC+tB,YAAN;IACD,CAFD,MAEO;MACL,KAAK,CAACuyD,SAAN;IACD;;IACD,IAAI,KAAK7yF,KAAT,EAAgB;MACd,MAAM,CAACqoB,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;MACA,KAAKiC,KAAL,CAAW0yD,KAAK,GAAG75D,WAAnB,EAAgC85D,KAAK,GAAG75D,YAAxC,EAAsD,KAAKtoB,KAAL,GAAaqoB,WAAnE,EAAgF,KAAKpoB,MAAL,GAAcqoB,YAA9F;IACD;;IACD,OAAO,KAAKhmB,GAAZ;EACD;;EACD,CAACg+B,YAAY,GAAG;IACd,MAAM;MACJh+B;IADI,IAEF,IAFJ;IAGA,IAAI;MACFtC,KADE;MAEFC;IAFE,IAGA,KAAK,CAACsS,MAHV;IAIA,MAAM,CAAC/I,SAAD,EAAYC,UAAZ,IAA0B,KAAK4jB,cAArC;IACA,MAAM4lE,SAAS,GAAG,IAAlB;;IACA,IAAI,KAAKjzF,KAAT,EAAgB;MACdA,KAAK,GAAG,KAAKA,KAAL,GAAawJ,SAArB;MACAvJ,MAAM,GAAG,KAAKA,MAAL,GAAcwJ,UAAvB;IACD,CAHD,MAGO,IAAIzJ,KAAK,GAAGizF,SAAS,GAAGzpF,SAApB,IAAiCvJ,MAAM,GAAGgzF,SAAS,GAAGxpF,UAA1D,EAAsE;MAC3E,MAAMypF,MAAM,GAAG19F,IAAI,CAACC,GAAL,CAASw9F,SAAS,GAAGzpF,SAAZ,GAAwBxJ,KAAjC,EAAwCizF,SAAS,GAAGxpF,UAAZ,GAAyBxJ,MAAjE,CAAf;MACAD,KAAK,IAAIkzF,MAAT;MACAjzF,MAAM,IAAIizF,MAAV;IACD;;IACD,MAAM,CAAC7qE,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,KAAKqD,OAAL,CAAa5wB,KAAK,GAAGqoB,WAAR,GAAsB7e,SAAnC,EAA8CvJ,MAAM,GAAGqoB,YAAT,GAAwB7e,UAAtE;;IACA,KAAKsF,UAAL,CAAgB4V,aAAhB,CAA8B,KAA9B;;IACA,MAAMzkB,MAAM,GAAG,KAAK,CAACA,MAAN,GAAe6B,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAA9B;IACAe,GAAG,CAACS,MAAJ,CAAW7C,MAAX;;IACA,IAAI,CAAC,KAAK6O,UAAL,CAAgBuN,4BAAjB,IAAiD,CAAC,KAAKvN,UAAL,CAAgBsN,iBAAtE,EAAyF;MACvF/Z,GAAG,CAAC6pE,MAAJ,GAAa,KAAb;IACD;;IACD,KAAK,CAACgnB,UAAN,CAAiBnzF,KAAjB,EAAwBC,MAAxB;IACA,KAAK,CAAC0tF,cAAN;;IACA,IAAI,CAAC,KAAK,CAAC+D,uBAAX,EAAoC;MAClC,KAAKpgF,MAAL,CAAY85E,iBAAZ,CAA8B,IAA9B;MACA,KAAK,CAACsG,uBAAN,GAAgC,IAAhC;IACD;;IACD,KAAK3nE,gBAAL,CAAsB;MACpBzF,MAAM,EAAE;IADY,CAAtB;;IAGA,IAAI,KAAK,CAACktE,cAAV,EAA0B;MACxBtxF,MAAM,CAACoB,YAAP,CAAoB,YAApB,EAAkC,KAAK,CAACkwF,cAAxC;IACD;EACF;;EACDiB,UAAU,CAACW,YAAD,EAAe3sD,eAAe,GAAG,KAAjC,EAAwC;IAChD,IAAI,CAAC2sD,YAAL,EAAmB;MACjBA,YAAY,GAAG,GAAf;IACD;;IACD,MAAM;MACJpzF,KAAK,EAAEqzF,WADH;MAEJpzF,MAAM,EAAEqzF;IAFJ,IAGF,KAAK,CAAC/gF,MAHV;IAIA,MAAMrS,MAAM,GAAG6B,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAf;IACA,IAAIgR,MAAM,GAAG,KAAK,CAACA,MAAnB;IACA,IAAIvS,KAAK,GAAGqzF,WAAZ;IAAA,IACEpzF,MAAM,GAAGqzF,YADX;;IAEA,IAAID,WAAW,GAAGD,YAAd,IAA8BE,YAAY,GAAGF,YAAjD,EAA+D;MAC7D,MAAMx7B,KAAK,GAAGpiE,IAAI,CAACC,GAAL,CAAS29F,YAAY,GAAGC,WAAxB,EAAqCD,YAAY,GAAGE,YAApD,CAAd;MACAtzF,KAAK,GAAGxK,IAAI,CAAC4I,KAAL,CAAWi1F,WAAW,GAAGz7B,KAAzB,CAAR;MACA33D,MAAM,GAAGzK,IAAI,CAAC4I,KAAL,CAAWk1F,YAAY,GAAG17B,KAA1B,CAAT;;MACA,IAAI,CAAC,KAAK,CAACnlD,KAAX,EAAkB;QAChBF,MAAM,GAAG,KAAK,CAACghF,WAAN,CAAkBvzF,KAAlB,EAAyBC,MAAzB,CAAT;MACD;IACF;;IACDC,MAAM,CAACF,KAAP,GAAeA,KAAf;IACAE,MAAM,CAACD,MAAP,GAAgBA,MAAhB;IACA,MAAMiN,GAAG,GAAGhN,MAAM,CAACG,UAAP,CAAkB,IAAlB,CAAZ;IACA6M,GAAG,CAAClJ,MAAJ,GAAa,KAAK+K,UAAL,CAAgBwN,SAA7B;IACA,IAAI21B,KAAK,GAAG,OAAZ;IAAA,IACEzI,KAAK,GAAG,SADV;;IAEA,IAAI,KAAK16B,UAAL,CAAgBwN,SAAhB,KAA8B,MAAlC,EAA0C;MACxCktB,KAAK,GAAG,OAAR;IACD,CAFD,MAEO,IAAIz8B,MAAM,CAACqJ,UAAP,GAAoB,8BAApB,EAAoDvK,OAAxD,EAAiE;MACtEomC,KAAK,GAAG,SAAR;MACAzI,KAAK,GAAG,SAAR;IACD;;IACD,MAAM+pD,MAAM,GAAG,EAAf;IACA,MAAMrxD,OAAO,GAAG,IAAInrC,eAAJ,CAAoBw8F,MAAM,GAAG,CAA7B,EAAgCA,MAAM,GAAG,CAAzC,CAAhB;IACA,MAAMC,UAAU,GAAGtxD,OAAO,CAAC9hC,UAAR,CAAmB,IAAnB,CAAnB;IACAozF,UAAU,CAAC1wD,SAAX,GAAuBmP,KAAvB;IACAuhD,UAAU,CAAC39C,QAAX,CAAoB,CAApB,EAAuB,CAAvB,EAA0B09C,MAAM,GAAG,CAAnC,EAAsCA,MAAM,GAAG,CAA/C;IACAC,UAAU,CAAC1wD,SAAX,GAAuB0G,KAAvB;IACAgqD,UAAU,CAAC39C,QAAX,CAAoB,CAApB,EAAuB,CAAvB,EAA0B09C,MAA1B,EAAkCA,MAAlC;IACAC,UAAU,CAAC39C,QAAX,CAAoB09C,MAApB,EAA4BA,MAA5B,EAAoCA,MAApC,EAA4CA,MAA5C;IACAtmF,GAAG,CAAC61B,SAAJ,GAAgB71B,GAAG,CAAC81B,aAAJ,CAAkBb,OAAlB,EAA2B,QAA3B,CAAhB;IACAj1B,GAAG,CAAC4oC,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB91C,KAAnB,EAA0BC,MAA1B;;IACA,IAAIwmC,eAAJ,EAAqB;MACnB,MAAMitD,SAAS,GAAG,IAAI18F,eAAJ,CAAoBgJ,KAApB,EAA2BC,MAA3B,CAAlB;MACA,MAAM0zF,YAAY,GAAGD,SAAS,CAACrzF,UAAV,CAAqB,IAArB,EAA2B;QAC9CC,kBAAkB,EAAE;MAD0B,CAA3B,CAArB;MAGAqzF,YAAY,CAACvhF,SAAb,CAAuBG,MAAvB,EAA+B,CAA/B,EAAkC,CAAlC,EAAqCA,MAAM,CAACvS,KAA5C,EAAmDuS,MAAM,CAACtS,MAA1D,EAAkE,CAAlE,EAAqE,CAArE,EAAwED,KAAxE,EAA+EC,MAA/E;MACA,MAAMmI,IAAI,GAAGurF,YAAY,CAACthF,YAAb,CAA0B,CAA1B,EAA6B,CAA7B,EAAgCrS,KAAhC,EAAuCC,MAAvC,EAA+CmI,IAA5D;MACA8E,GAAG,CAACkF,SAAJ,CAAcshF,SAAd,EAAyB,CAAzB,EAA4B,CAA5B;MACA,OAAO;QACLxzF,MADK;QAEL89B,SAAS,EAAE;UACTh+B,KADS;UAETC,MAFS;UAGTmI;QAHS;MAFN,CAAP;IAQD;;IACD8E,GAAG,CAACkF,SAAJ,CAAcG,MAAd,EAAsB,CAAtB,EAAyB,CAAzB,EAA4BA,MAAM,CAACvS,KAAnC,EAA0CuS,MAAM,CAACtS,MAAjD,EAAyD,CAAzD,EAA4D,CAA5D,EAA+DD,KAA/D,EAAsEC,MAAtE;IACA,OAAO;MACLC,MADK;MAEL89B,SAAS,EAAE;IAFN,CAAP;EAID;;EACD,CAAC8vD,aAAa,CAAC9tF,KAAD,EAAQC,MAAR,EAAgB;IAC5B,MAAM,CAACooB,WAAD,EAAcC,YAAd,IAA8B,KAAKiF,gBAAzC;IACA,KAAKvtB,KAAL,GAAaA,KAAK,GAAGqoB,WAArB;IACA,KAAKpoB,MAAL,GAAcA,MAAM,GAAGqoB,YAAvB;IACA,KAAKsI,OAAL,CAAa5wB,KAAb,EAAoBC,MAApB;;IACA,IAAI,KAAKmsB,eAAL,EAAsBc,UAA1B,EAAsC;MACpC,KAAK2B,MAAL;IACD,CAFD,MAEO;MACL,KAAKE,iBAAL;IACD;;IACD,KAAK3C,eAAL,GAAuB,IAAvB;;IACA,IAAI,KAAK,CAACqlE,eAAN,KAA0B,IAA9B,EAAoC;MAClCz1E,YAAY,CAAC,KAAK,CAACy1E,eAAP,CAAZ;IACD;;IACD,MAAM/qE,YAAY,GAAG,GAArB;IACA,KAAK,CAAC+qE,eAAN,GAAwBtsE,UAAU,CAAC,MAAM;MACvC,KAAK,CAACssE,eAAN,GAAwB,IAAxB;MACA,KAAK,CAAC0B,UAAN,CAAiBnzF,KAAjB,EAAwBC,MAAxB;IACD,CAHiC,EAG/BymB,YAH+B,CAAlC;EAID;;EACD,CAAC6sE,WAAW,CAACvzF,KAAD,EAAQC,MAAR,EAAgB;IAC1B,MAAM;MACJD,KAAK,EAAEqzF,WADH;MAEJpzF,MAAM,EAAEqzF;IAFJ,IAGF,KAAK,CAAC/gF,MAHV;IAIA,IAAIyf,QAAQ,GAAGqhE,WAAf;IACA,IAAIphE,SAAS,GAAGqhE,YAAhB;IACA,IAAI/gF,MAAM,GAAG,KAAK,CAACA,MAAnB;;IACA,OAAOyf,QAAQ,GAAG,IAAIhyB,KAAf,IAAwBiyB,SAAS,GAAG,IAAIhyB,MAA/C,EAAuD;MACrD,MAAM2zF,SAAS,GAAG5hE,QAAlB;MACA,MAAM6hE,UAAU,GAAG5hE,SAAnB;;MACA,IAAID,QAAQ,GAAG,IAAIhyB,KAAnB,EAA0B;QACxBgyB,QAAQ,GAAGA,QAAQ,IAAI,KAAZ,GAAoBx8B,IAAI,CAAC4I,KAAL,CAAW4zB,QAAQ,GAAG,CAAtB,IAA2B,CAA/C,GAAmDx8B,IAAI,CAAC+sC,IAAL,CAAUvQ,QAAQ,GAAG,CAArB,CAA9D;MACD;;MACD,IAAIC,SAAS,GAAG,IAAIhyB,MAApB,EAA4B;QAC1BgyB,SAAS,GAAGA,SAAS,IAAI,KAAb,GAAqBz8B,IAAI,CAAC4I,KAAL,CAAW6zB,SAAS,GAAG,CAAvB,IAA4B,CAAjD,GAAqDz8B,IAAI,CAAC+sC,IAAL,CAAUtQ,SAAS,GAAG,CAAtB,CAAjE;MACD;;MACD,MAAMyhE,SAAS,GAAG,IAAI18F,eAAJ,CAAoBg7B,QAApB,EAA8BC,SAA9B,CAAlB;MACA,MAAM/kB,GAAG,GAAGwmF,SAAS,CAACrzF,UAAV,CAAqB,IAArB,CAAZ;MACA6M,GAAG,CAACkF,SAAJ,CAAcG,MAAd,EAAsB,CAAtB,EAAyB,CAAzB,EAA4BqhF,SAA5B,EAAuCC,UAAvC,EAAmD,CAAnD,EAAsD,CAAtD,EAAyD7hE,QAAzD,EAAmEC,SAAnE;MACA1f,MAAM,GAAGmhF,SAAS,CAACI,qBAAV,EAAT;IACD;;IACD,OAAOvhF,MAAP;EACD;;EACD,CAAC4gF,UAAU,CAACnzF,KAAD,EAAQC,MAAR,EAAgB;IACzBD,KAAK,GAAGxK,IAAI,CAAC+sC,IAAL,CAAUviC,KAAV,CAAR;IACAC,MAAM,GAAGzK,IAAI,CAAC+sC,IAAL,CAAUtiC,MAAV,CAAT;IACA,MAAMC,MAAM,GAAG,KAAK,CAACA,MAArB;;IACA,IAAI,CAACA,MAAD,IAAWA,MAAM,CAACF,KAAP,KAAiBA,KAAjB,IAA0BE,MAAM,CAACD,MAAP,KAAkBA,MAA3D,EAAmE;MACjE;IACD;;IACDC,MAAM,CAACF,KAAP,GAAeA,KAAf;IACAE,MAAM,CAACD,MAAP,GAAgBA,MAAhB;IACA,MAAMsS,MAAM,GAAG,KAAK,CAACE,KAAN,GAAc,KAAK,CAACF,MAApB,GAA6B,KAAK,CAACghF,WAAN,CAAkBvzF,KAAlB,EAAyBC,MAAzB,CAA5C;IACA,MAAMiN,GAAG,GAAGhN,MAAM,CAACG,UAAP,CAAkB,IAAlB,CAAZ;IACA6M,GAAG,CAAClJ,MAAJ,GAAa,KAAK+K,UAAL,CAAgBwN,SAA7B;IACArP,GAAG,CAACkF,SAAJ,CAAcG,MAAd,EAAsB,CAAtB,EAAyB,CAAzB,EAA4BA,MAAM,CAACvS,KAAnC,EAA0CuS,MAAM,CAACtS,MAAjD,EAAyD,CAAzD,EAA4D,CAA5D,EAA+DD,KAA/D,EAAsEC,MAAtE;EACD;;EACDirB,kBAAkB,GAAG;IACnB,OAAO,KAAK,CAAChrB,MAAb;EACD;;EACD,CAAC6zF,eAAe,CAACC,KAAD,EAAQ;IACtB,IAAIA,KAAJ,EAAW;MACT,IAAI,KAAK,CAACvhF,KAAV,EAAiB;QACf,MAAMvf,GAAG,GAAG,KAAK6b,UAAL,CAAgBkZ,YAAhB,CAA6BtU,SAA7B,CAAuC,KAAK,CAACy9E,QAA7C,CAAZ;;QACA,IAAIl+F,GAAJ,EAAS;UACP,OAAOA,GAAP;QACD;MACF;;MACD,MAAMgN,MAAM,GAAG6B,QAAQ,CAACR,aAAT,CAAuB,QAAvB,CAAf;MACA,CAAC;QACCvB,KAAK,EAAEE,MAAM,CAACF,KADf;QAECC,MAAM,EAAEC,MAAM,CAACD;MAFhB,IAGG,KAAK,CAACsS,MAHV;MAIA,MAAMrF,GAAG,GAAGhN,MAAM,CAACG,UAAP,CAAkB,IAAlB,CAAZ;MACA6M,GAAG,CAACkF,SAAJ,CAAc,KAAK,CAACG,MAApB,EAA4B,CAA5B,EAA+B,CAA/B;MACA,OAAOrS,MAAM,CAAC+zF,SAAP,EAAP;IACD;;IACD,IAAI,KAAK,CAACxhF,KAAV,EAAiB;MACf,MAAM,CAACjJ,SAAD,EAAYC,UAAZ,IAA0B,KAAK4jB,cAArC;MACA,MAAMrtB,KAAK,GAAGxK,IAAI,CAAC0P,KAAL,CAAW,KAAKlF,KAAL,GAAawJ,SAAb,GAAyB/nB,aAAa,CAACigB,gBAAlD,CAAd;MACA,MAAMzB,MAAM,GAAGzK,IAAI,CAAC0P,KAAL,CAAW,KAAKjF,MAAL,GAAcwJ,UAAd,GAA2BhoB,aAAa,CAACigB,gBAApD,CAAf;MACA,MAAMgyF,SAAS,GAAG,IAAI18F,eAAJ,CAAoBgJ,KAApB,EAA2BC,MAA3B,CAAlB;MACA,MAAMiN,GAAG,GAAGwmF,SAAS,CAACrzF,UAAV,CAAqB,IAArB,CAAZ;MACA6M,GAAG,CAACkF,SAAJ,CAAc,KAAK,CAACG,MAApB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,KAAK,CAACA,MAAN,CAAavS,KAA/C,EAAsD,KAAK,CAACuS,MAAN,CAAatS,MAAnE,EAA2E,CAA3E,EAA8E,CAA9E,EAAiFD,KAAjF,EAAwFC,MAAxF;MACA,OAAOyzF,SAAS,CAACI,qBAAV,EAAP;IACD;;IACD,OAAOx5D,eAAe,CAAC,KAAK,CAAC/nB,MAAP,CAAtB;EACD;;EACD,CAACo7E,cAAc,GAAG;IAChB,IAAI,CAAC,KAAK5+E,UAAL,CAAgBC,OAArB,EAA8B;MAC5B;IACD;;IACD,KAAK,CAAC49E,QAAN,GAAiB,IAAI8C,cAAJ,CAAmB/sE,OAAO,IAAI;MAC7C,MAAM5oB,IAAI,GAAG4oB,OAAO,CAAC,CAAD,CAAP,CAAWgtE,WAAxB;;MACA,IAAI51F,IAAI,CAACiG,KAAL,IAAcjG,IAAI,CAACkG,MAAvB,EAA+B;QAC7B,KAAK,CAAC6tF,aAAN,CAAoB/zF,IAAI,CAACiG,KAAzB,EAAgCjG,IAAI,CAACkG,MAArC;MACD;IACF,CALgB,CAAjB;IAMA,KAAK,CAAC2sF,QAAN,CAAegD,OAAf,CAAuB,KAAKttF,GAA5B;;IACA,KAAKyM,UAAL,CAAgBC,OAAhB,CAAwBC,gBAAxB,CAAyC,OAAzC,EAAkD,MAAM;MACtD,KAAK,CAAC29E,QAAN,EAAgBiB,UAAhB;MACA,KAAK,CAACjB,QAAN,GAAiB,IAAjB;IACD,CAHD,EAGG;MACD1vE,IAAI,EAAE;IADL,CAHH;EAMD;;EACiB,OAAXmF,WAAW,CAACja,IAAD,EAAOkJ,MAAP,EAAeR,SAAf,EAA0B;IAC1C,IAAI1I,IAAI,YAAY+lE,sBAApB,EAA4C;MAC1C,OAAO,IAAP;IACD;;IACD,MAAMjgE,MAAM,GAAG,MAAMmU,WAAN,CAAkBja,IAAlB,EAAwBkJ,MAAxB,EAAgCR,SAAhC,CAAf;IACA,MAAM;MACJ/W,IADI;MAEJu3F,SAFI;MAGJF,QAHI;MAIJ3+E,KAJI;MAKJ2Y;IALI,IAMFhjB,IANJ;;IAOA,IAAIgpF,QAAQ,IAAItgF,SAAS,CAACmX,YAAV,CAAuBpU,SAAvB,CAAiCu9E,QAAjC,CAAhB,EAA4D;MAC1DljF,MAAM,CAAC,CAACkjF,QAAR,GAAmBA,QAAnB;IACD,CAFD,MAEO;MACLljF,MAAM,CAAC,CAACojF,SAAR,GAAoBA,SAApB;IACD;;IACDpjF,MAAM,CAAC,CAACuE,KAAR,GAAgBA,KAAhB;IACA,MAAM,CAAC4V,WAAD,EAAcC,YAAd,IAA8Bpa,MAAM,CAACmf,cAA3C;IACAnf,MAAM,CAAClO,KAAP,GAAe,CAACjG,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAf,IAAsBsuB,WAArC;IACAna,MAAM,CAACjO,MAAP,GAAgB,CAAClG,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAf,IAAsBuuB,YAAtC;;IACA,IAAI8C,iBAAJ,EAAuB;MACrBld,MAAM,CAAC6lB,WAAP,GAAqB3I,iBAArB;IACD;;IACD,OAAOld,MAAP;EACD;;EACDmH,SAAS,CAACmV,YAAY,GAAG,KAAhB,EAAuBpqB,OAAO,GAAG,IAAjC,EAAuC;IAC9C,IAAI,KAAK2Y,OAAL,EAAJ,EAAoB;MAClB,OAAO,IAAP;IACD;;IACD,MAAM4I,UAAU,GAAG;MACjB8qD,cAAc,EAAErsF,oBAAoB,CAACwE,KADpB;MAEjBwsG,QAAQ,EAAE,KAAK,CAACA,QAFC;MAGjB/tE,SAAS,EAAE,KAAKA,SAHC;MAIjBtpB,IAAI,EAAE,KAAK+6B,OAAL,CAAa,CAAb,EAAgB,CAAhB,CAJW;MAKjBnsB,QAAQ,EAAE,KAAKA,QALE;MAMjB8J,KAAK,EAAE,KAAK,CAACA,KANI;MAOjBixE,kBAAkB,EAAE,KAAKv2D;IAPR,CAAnB;;IASA,IAAI3C,YAAJ,EAAkB;MAChB7I,UAAU,CAAC2vE,SAAX,GAAuB,KAAK,CAACyC,eAAN,CAAsB,IAAtB,CAAvB;MACApyE,UAAU,CAACyJ,iBAAX,GAA+B,KAAK8I,gBAAL,CAAsB,IAAtB,CAA/B;MACA,OAAOvS,UAAP;IACD;;IACD,MAAM;MACJ8I,UADI;MAEJrc;IAFI,IAGF,KAAK8lB,gBAAL,CAAsB,KAAtB,CAHJ;;IAIA,IAAI,CAACzJ,UAAD,IAAerc,OAAnB,EAA4B;MAC1BuT,UAAU,CAACyJ,iBAAX,GAA+B;QAC7BjoC,IAAI,EAAE,QADuB;QAE7ByvG,GAAG,EAAExkF;MAFwB,CAA/B;IAID;;IACD,IAAIhO,OAAO,KAAK,IAAhB,EAAsB;MACpB,OAAOuhB,UAAP;IACD;;IACDvhB,OAAO,CAAC8zF,MAAR,KAAmB,IAAIt2F,GAAJ,EAAnB;IACA,MAAMu2F,IAAI,GAAG,KAAK,CAAC1hF,KAAN,GAAc,CAACkP,UAAU,CAAC5nB,IAAX,CAAgB,CAAhB,IAAqB4nB,UAAU,CAAC5nB,IAAX,CAAgB,CAAhB,CAAtB,KAA6C4nB,UAAU,CAAC5nB,IAAX,CAAgB,CAAhB,IAAqB4nB,UAAU,CAAC5nB,IAAX,CAAgB,CAAhB,CAAlE,CAAd,GAAsG,IAAnH;;IACA,IAAI,CAACqG,OAAO,CAAC8zF,MAAR,CAAet+E,GAAf,CAAmB,KAAK,CAACw7E,QAAzB,CAAL,EAAyC;MACvChxF,OAAO,CAAC8zF,MAAR,CAAenwF,GAAf,CAAmB,KAAK,CAACqtF,QAAzB,EAAmC;QACjC+C,IADiC;QAEjCxyE;MAFiC,CAAnC;MAIAA,UAAU,CAACpP,MAAX,GAAoB,KAAK,CAACwhF,eAAN,CAAsB,KAAtB,CAApB;IACD,CAND,MAMO,IAAI,KAAK,CAACthF,KAAV,EAAiB;MACtB,MAAM2hF,QAAQ,GAAGh0F,OAAO,CAAC8zF,MAAR,CAAe10G,GAAf,CAAmB,KAAK,CAAC4xG,QAAzB,CAAjB;;MACA,IAAI+C,IAAI,GAAGC,QAAQ,CAACD,IAApB,EAA0B;QACxBC,QAAQ,CAACD,IAAT,GAAgBA,IAAhB;QACAC,QAAQ,CAACzyE,UAAT,CAAoBpP,MAApB,CAA2B+yC,KAA3B;QACA8uC,QAAQ,CAACzyE,UAAT,CAAoBpP,MAApB,GAA6B,KAAK,CAACwhF,eAAN,CAAsB,KAAtB,CAA7B;MACD;IACF;;IACD,OAAOpyE,UAAP;EACD;;AAviBwC;;AA0iB3C,C,CAAC;;AAQD,MAAMzhC,qBAAN,CAA4B;EAC1B,CAAC2+F,oBAAD;EACA,CAACwV,UAAD,GAAc,KAAd;EACA,CAACC,eAAD,GAAmB,IAAnB;EACA,CAACC,OAAD,GAAW,IAAX;EACA,CAACC,oBAAD,GAAwB,IAAxB;EACA,CAAC9yE,OAAD,GAAW,IAAI9jB,GAAJ,EAAX;EACA,CAAC62F,cAAD,GAAkB,KAAlB;EACA,CAACC,YAAD,GAAgB,KAAhB;EACA,CAACC,WAAD,GAAe,KAAf;EACA,CAACj2E,SAAD,GAAa,IAAb;EACA,CAACk2E,eAAD,GAAmB,IAAnB;EACA,CAAC9jF,SAAD;EACmB,OAAZ+jF,YAAY,GAAG,KAAH;EACnB,OAAO,CAACv9E,WAAR,GAAsB,IAAI1Z,GAAJ,CAAQ,CAACqiF,cAAD,EAAiBmM,SAAjB,EAA4B+E,WAA5B,EAAyChI,eAAzC,EAA0D7yF,GAA1D,CAA8DnT,IAAI,IAAI,CAACA,IAAI,CAACs9F,WAAN,EAAmBt9F,IAAnB,CAAtE,CAAR,CAAtB;;EACAoR,WAAW,CAAC;IACVuc,SADU;IAEVuS,SAFU;IAGV/gB,GAHU;IAIVu8E,oBAJU;IAKVyV,eALU;IAMV/J,SANU;IAOV7rE,SAPU;IAQVnR,QARU;IASVygB;EATU,CAAD,EAUR;IACD,MAAM1W,WAAW,GAAG,CAAC,GAAGp3B,qBAAqB,CAAC,CAACo3B,WAAvB,CAAmCyE,MAAnC,EAAJ,CAApB;;IACA,IAAI,CAAC77B,qBAAqB,CAAC20G,YAA3B,EAAyC;MACvC30G,qBAAqB,CAAC20G,YAAtB,GAAqC,IAArC;;MACA,KAAK,MAAMzkF,UAAX,IAAyBkH,WAAzB,EAAsC;QACpClH,UAAU,CAACuZ,UAAX,CAAsBqE,IAAtB,EAA4Bld,SAA5B;MACD;IACF;;IACDA,SAAS,CAACkS,mBAAV,CAA8B1L,WAA9B;IACA,KAAK,CAACxG,SAAN,GAAkBA,SAAlB;IACA,KAAKuS,SAAL,GAAiBA,SAAjB;IACA,KAAK/gB,GAAL,GAAWA,GAAX;IACA,KAAK,CAACu8E,oBAAN,GAA6BA,oBAA7B;IACA,KAAK,CAACyV,eAAN,GAAwBA,eAAxB;IACA,KAAK/mF,QAAL,GAAgBA,QAAhB;IACA,KAAK,CAACmR,SAAN,GAAkBA,SAAlB;IACA,KAAK6rE,SAAL,GAAiBA,SAAjB;IACA,KAAK,CAACz5E,SAAN,CAAgBwS,QAAhB,CAAyB,IAAzB;EACD;;EACU,IAAPvK,OAAO,GAAG;IACZ,OAAO,KAAK,CAAC2I,OAAN,CAAc5b,IAAd,KAAuB,CAA9B;EACD;;EACc,IAAXgvF,WAAW,GAAG;IAChB,OAAO,KAAK/7E,OAAL,IAAgB,KAAK,CAACjI,SAAN,CAAgBkX,OAAhB,OAA8B5nC,oBAAoB,CAACqE,IAA1E;EACD;;EACD2/B,aAAa,CAAC5L,IAAD,EAAO;IAClB,KAAK,CAAC1H,SAAN,CAAgBsT,aAAhB,CAA8B5L,IAA9B;EACD;;EACDkL,UAAU,CAAClL,IAAI,GAAG,KAAK,CAAC1H,SAAN,CAAgBkX,OAAhB,EAAR,EAAmC;IAC3C,KAAK,CAACivC,OAAN;;IACA,QAAQz+C,IAAR;MACE,KAAKp4B,oBAAoB,CAACqE,IAA1B;QACE,KAAKswG,oBAAL;QACA,KAAKzjE,mBAAL,CAAyB,KAAzB;QACA,KAAK0jE,kCAAL,CAAwC,IAAxC;QACA,KAAKnwE,YAAL;QACA;;MACF,KAAKzkC,oBAAoB,CAACyE,GAA1B;QACE,KAAK2qG,oBAAL,CAA0B,KAA1B;QACA,KAAKuF,oBAAL;QACA,KAAKzjE,mBAAL,CAAyB,IAAzB;QACA,KAAKzM,YAAL;QACA;;MACF,KAAKzkC,oBAAoB,CAACuE,SAA1B;QACE,KAAKswG,mBAAL;QACA,KAAK3jE,mBAAL,CAAyB,KAAzB;QACA,KAAKzM,YAAL;QACA;;MACF;QACE,KAAKkwE,oBAAL;QACA,KAAKzjE,mBAAL,CAAyB,IAAzB;QACA,KAAKxM,WAAL;IArBJ;;IAuBA,KAAKkwE,kCAAL,CAAwC,KAAxC;IACA,MAAM;MACJjlF;IADI,IAEF,KAAKzN,GAFT;;IAGA,KAAK,MAAM8N,UAAX,IAAyBlwB,qBAAqB,CAAC,CAACo3B,WAAvB,CAAmCyE,MAAnC,EAAzB,EAAsE;MACpEhM,SAAS,CAAC+N,MAAV,CAAkB,GAAE1N,UAAU,CAACsd,KAAM,SAArC,EAA+ClV,IAAI,KAAKpI,UAAU,CAACqwE,WAAnE;IACD;;IACD,KAAKn+E,GAAL,CAAS6pE,MAAT,GAAkB,KAAlB;EACD;;EACDvtD,YAAY,CAACF,SAAD,EAAY;IACtB,OAAOA,SAAS,KAAK,KAAK,CAACA,SAAN,EAAiBpc,GAAtC;EACD;;EACDktF,oBAAoB,CAAC0F,YAAD,EAAe;IACjC,IAAI,KAAK,CAACpkF,SAAN,CAAgBkX,OAAhB,OAA8B5nC,oBAAoB,CAACyE,GAAvD,EAA4D;MAC1D;IACD;;IACD,IAAI,CAACqwG,YAAL,EAAmB;MACjB,KAAK,MAAMhnF,MAAX,IAAqB,KAAK,CAACwT,OAAN,CAAc3F,MAAd,EAArB,EAA6C;QAC3C,IAAI7N,MAAM,CAAC6K,OAAP,EAAJ,EAAsB;UACpB7K,MAAM,CAAC8gB,eAAP;UACA;QACD;MACF;IACF;;IACD,MAAM9gB,MAAM,GAAG,KAAKuR,qBAAL,CAA2B;MACxC7W,OAAO,EAAE,CAD+B;MAExCC,OAAO,EAAE;IAF+B,CAA3B,EAGZ,KAHY,CAAf;IAIAqF,MAAM,CAAC8gB,eAAP;EACD;;EACDjM,eAAe,CAACjK,SAAD,EAAY;IACzB,KAAK,CAAChI,SAAN,CAAgBiS,eAAhB,CAAgCjK,SAAhC;EACD;;EACD0J,WAAW,CAAC6D,MAAD,EAAS;IAClB,KAAK,CAACvV,SAAN,CAAgB0R,WAAhB,CAA4B6D,MAA5B;EACD;;EACDpG,aAAa,CAAC0K,OAAO,GAAG,KAAX,EAAkB;IAC7B,KAAKroB,GAAL,CAASyN,SAAT,CAAmB+N,MAAnB,CAA0B,SAA1B,EAAqC,CAAC6M,OAAtC;EACD;;EACD2G,mBAAmB,CAAC3G,OAAO,GAAG,KAAX,EAAkB;IACnC,KAAKroB,GAAL,CAASyN,SAAT,CAAmB+N,MAAnB,CAA0B,UAA1B,EAAsC,CAAC6M,OAAvC;EACD;;EACDqqE,kCAAkC,CAACrqE,OAAO,GAAG,KAAX,EAAkB;IAClD,KAAK,CAAC2pE,eAAN,EAAuBhyF,GAAvB,CAA2ByN,SAA3B,CAAqC+N,MAArC,CAA4C,UAA5C,EAAwD,CAAC6M,OAAzD;EACD;;EACDpH,MAAM,GAAG;IACP,KAAKjhB,GAAL,CAASgO,QAAT,GAAoB,CAApB;IACA,KAAKghB,mBAAL,CAAyB,IAAzB;IACA,MAAM6jE,oBAAoB,GAAG,IAAIlgF,GAAJ,EAA7B;;IACA,KAAK,MAAM/G,MAAX,IAAqB,KAAK,CAACwT,OAAN,CAAc3F,MAAd,EAArB,EAA6C;MAC3C7N,MAAM,CAACwoB,aAAP;MACAxoB,MAAM,CAACgC,IAAP,CAAY,IAAZ;;MACA,IAAIhC,MAAM,CAAC6V,mBAAX,EAAgC;QAC9B,KAAK,CAACjT,SAAN,CAAgB4U,+BAAhB,CAAgDxX,MAAhD;QACAinF,oBAAoB,CAACnlF,GAArB,CAAyB9B,MAAM,CAAC6V,mBAAhC;MACD;IACF;;IACD,IAAI,CAAC,KAAK,CAACuwE,eAAX,EAA4B;MAC1B;IACD;;IACD,MAAMc,SAAS,GAAG,KAAK,CAACd,eAAN,CAAsBxU,sBAAtB,EAAlB;;IACA,KAAK,MAAM/D,QAAX,IAAuBqZ,SAAvB,EAAkC;MAChCrZ,QAAQ,CAACjsE,IAAT;;MACA,IAAI,KAAK,CAACgB,SAAN,CAAgB0U,0BAAhB,CAA2Cu2D,QAAQ,CAAC3zE,IAAT,CAAcnG,EAAzD,CAAJ,EAAkE;QAChE;MACD;;MACD,IAAIkzF,oBAAoB,CAACv/E,GAArB,CAAyBmmE,QAAQ,CAAC3zE,IAAT,CAAcnG,EAAvC,CAAJ,EAAgD;QAC9C;MACD;;MACD,MAAMiM,MAAM,GAAG,KAAKmU,WAAL,CAAiB05D,QAAjB,CAAf;;MACA,IAAI,CAAC7tE,MAAL,EAAa;QACX;MACD;;MACD,KAAKyX,YAAL,CAAkBzX,MAAlB;MACAA,MAAM,CAACwoB,aAAP;IACD;EACF;;EACDlT,OAAO,GAAG;IACR,KAAK,CAACmxE,WAAN,GAAoB,IAApB;IACA,KAAKryF,GAAL,CAASgO,QAAT,GAAoB,CAAC,CAArB;IACA,KAAKghB,mBAAL,CAAyB,KAAzB;IACA,MAAM+jE,kBAAkB,GAAG,IAAIz3F,GAAJ,EAA3B;IACA,MAAM03F,gBAAgB,GAAG,IAAI13F,GAAJ,EAAzB;;IACA,KAAK,MAAMsQ,MAAX,IAAqB,KAAK,CAACwT,OAAN,CAAc3F,MAAd,EAArB,EAA6C;MAC3C7N,MAAM,CAACuoB,cAAP;;MACA,IAAI,CAACvoB,MAAM,CAAC6V,mBAAZ,EAAiC;QAC/B;MACD;;MACD,IAAI7V,MAAM,CAACmH,SAAP,OAAuB,IAA3B,EAAiC;QAC/BggF,kBAAkB,CAACtxF,GAAnB,CAAuBmK,MAAM,CAAC6V,mBAA9B,EAAmD7V,MAAnD;QACA;MACD,CAHD,MAGO;QACLonF,gBAAgB,CAACvxF,GAAjB,CAAqBmK,MAAM,CAAC6V,mBAA5B,EAAiD7V,MAAjD;MACD;;MACD,KAAK6xE,qBAAL,CAA2B7xE,MAAM,CAAC6V,mBAAlC,GAAwD7T,IAAxD;MACAhC,MAAM,CAAC/J,MAAP;IACD;;IACD,IAAI,KAAK,CAACmwF,eAAV,EAA2B;MACzB,MAAMc,SAAS,GAAG,KAAK,CAACd,eAAN,CAAsBxU,sBAAtB,EAAlB;;MACA,KAAK,MAAM/D,QAAX,IAAuBqZ,SAAvB,EAAkC;QAChC,MAAM;UACJnzF;QADI,IAEF85E,QAAQ,CAAC3zE,IAFb;;QAGA,IAAI,KAAK,CAAC0I,SAAN,CAAgB0U,0BAAhB,CAA2CvjB,EAA3C,CAAJ,EAAoD;UAClD;QACD;;QACD,IAAIiM,MAAM,GAAGonF,gBAAgB,CAAC91G,GAAjB,CAAqByiB,EAArB,CAAb;;QACA,IAAIiM,MAAJ,EAAY;UACVA,MAAM,CAACipB,sBAAP,CAA8B4kD,QAA9B;UACA7tE,MAAM,CAACgC,IAAP,CAAY,KAAZ;UACA6rE,QAAQ,CAAC7rE,IAAT;UACA;QACD;;QACDhC,MAAM,GAAGmnF,kBAAkB,CAAC71G,GAAnB,CAAuByiB,EAAvB,CAAT;;QACA,IAAIiM,MAAJ,EAAY;UACV,KAAK,CAAC4C,SAAN,CAAgBwU,4BAAhB,CAA6CpX,MAA7C;UACAA,MAAM,CAAC0a,uBAAP,CAA+BmzD,QAA/B;UACA7tE,MAAM,CAACgC,IAAP,CAAY,KAAZ;QACD;;QACD6rE,QAAQ,CAAC7rE,IAAT;MACD;IACF;;IACD,KAAK,CAAC+mD,OAAN;;IACA,IAAI,KAAKl+C,OAAT,EAAkB;MAChB,KAAKzW,GAAL,CAAS6pE,MAAT,GAAkB,IAAlB;IACD;;IACD,MAAM;MACJp8D;IADI,IAEF,KAAKzN,GAFT;;IAGA,KAAK,MAAM8N,UAAX,IAAyBlwB,qBAAqB,CAAC,CAACo3B,WAAvB,CAAmCyE,MAAnC,EAAzB,EAAsE;MACpEhM,SAAS,CAAC5L,MAAV,CAAkB,GAAEiM,UAAU,CAACsd,KAAM,SAArC;IACD;;IACD,KAAKqnE,oBAAL;IACA,KAAKC,kCAAL,CAAwC,IAAxC;IACA,KAAK,CAACL,WAAN,GAAoB,KAApB;EACD;;EACD5U,qBAAqB,CAAC99E,EAAD,EAAK;IACxB,OAAO,KAAK,CAACqyF,eAAN,EAAuBvU,qBAAvB,CAA6C99E,EAA7C,KAAoD,IAA3D;EACD;;EACD2jB,eAAe,CAAC1X,MAAD,EAAS;IACtB,MAAMqnF,aAAa,GAAG,KAAK,CAACzkF,SAAN,CAAgB+W,SAAhB,EAAtB;;IACA,IAAI0tE,aAAa,KAAKrnF,MAAtB,EAA8B;MAC5B;IACD;;IACD,KAAK,CAAC4C,SAAN,CAAgB8U,eAAhB,CAAgC1X,MAAhC;EACD;;EACD+mF,mBAAmB,GAAG;IACpB,KAAK3yF,GAAL,CAASgO,QAAT,GAAoB,CAAC,CAArB;;IACA,IAAI,KAAK,CAACoO,SAAN,EAAiBpc,GAAjB,IAAwB,CAAC,KAAK,CAACsyF,eAAnC,EAAoD;MAClD,KAAK,CAACA,eAAN,GAAwB,IAAIl+E,eAAJ,EAAxB;MACA,MAAM5H,MAAM,GAAG,KAAK,CAACgC,SAAN,CAAgBmL,cAAhB,CAA+B,KAAK,CAAC24E,eAArC,CAAf;MACA,KAAK,CAACl2E,SAAN,CAAgBpc,GAAhB,CAAoB2M,gBAApB,CAAqC,aAArC,EAAoD,KAAK,CAACumF,oBAAN,CAA2BxwF,IAA3B,CAAgC,IAAhC,CAApD,EAA2F;QACzF8J;MADyF,CAA3F;MAGA,KAAK,CAAC4P,SAAN,CAAgBpc,GAAhB,CAAoByN,SAApB,CAA8BC,GAA9B,CAAkC,cAAlC;IACD;EACF;;EACD+kF,oBAAoB,GAAG;IACrB,KAAKzyF,GAAL,CAASgO,QAAT,GAAoB,CAApB;;IACA,IAAI,KAAK,CAACoO,SAAN,EAAiBpc,GAAjB,IAAwB,KAAK,CAACsyF,eAAlC,EAAmD;MACjD,KAAK,CAACA,eAAN,CAAsB/4E,KAAtB;MACA,KAAK,CAAC+4E,eAAN,GAAwB,IAAxB;MACA,KAAK,CAACl2E,SAAN,CAAgBpc,GAAhB,CAAoByN,SAApB,CAA8B5L,MAA9B,CAAqC,cAArC;IACD;EACF;;EACD,CAACqxF,oBAAoB,CAAClgF,KAAD,EAAQ;IAC3B,KAAK,CAACxE,SAAN,CAAgB4J,WAAhB;IACA,MAAM;MACJT;IADI,IAEF3E,KAFJ;;IAGA,IAAI2E,MAAM,KAAK,KAAK,CAACyE,SAAN,CAAgBpc,GAA3B,IAAkC2X,MAAM,CAAClK,SAAP,CAAiB4J,QAAjB,CAA0B,cAA1B,KAA6C,KAAK,CAAC+E,SAAN,CAAgBpc,GAAhB,CAAoBqX,QAApB,CAA6BM,MAA7B,CAAnF,EAAyH;MACvH,MAAM;QACJ9iB;MADI,IAEFtW,gBAAgB,CAACoW,QAFrB;;MAGA,IAAIqe,KAAK,CAACjF,MAAN,KAAiB,CAAjB,IAAsBiF,KAAK,CAACE,OAAN,IAAiBre,KAA3C,EAAkD;QAChD;MACD;;MACD,KAAK,CAAC2Z,SAAN,CAAgB4O,cAAhB,CAA+B,WAA/B,EAA4C,IAA5C,EAAkD,IAAlD;MACA,KAAK,CAAChB,SAAN,CAAgBpc,GAAhB,CAAoByN,SAApB,CAA8BC,GAA9B,CAAkC,MAAlC;MACA,KAAKiQ,aAAL;MACAkpE,eAAe,CAAC4C,iBAAhB,CAAkC,IAAlC,EAAwC,KAAK,CAACj7E,SAAN,CAAgB1B,SAAhB,KAA8B,KAAtE,EAA6EkG,KAA7E;MACA,KAAK,CAACoJ,SAAN,CAAgBpc,GAAhB,CAAoB2M,gBAApB,CAAqC,WAArC,EAAkD,MAAM;QACtD,KAAK,CAACyP,SAAN,CAAgBpc,GAAhB,CAAoByN,SAApB,CAA8B5L,MAA9B,CAAqC,MAArC;QACA,KAAK8b,aAAL,CAAmB,IAAnB;MACD,CAHD,EAGG;QACD/C,IAAI,EAAE,IADL;QAEDpO,MAAM,EAAE,KAAK,CAACgC,SAAN,CAAgB9B;MAFvB,CAHH;MAOAsG,KAAK,CAAC9J,cAAN;IACD;EACF;;EACDsZ,WAAW,GAAG;IACZ,IAAI,KAAK,CAACyvE,OAAV,EAAmB;MACjB;IACD;;IACD,KAAK,CAACA,OAAN,GAAgB,IAAI79E,eAAJ,EAAhB;IACA,MAAM5H,MAAM,GAAG,KAAK,CAACgC,SAAN,CAAgBmL,cAAhB,CAA+B,KAAK,CAACs4E,OAArC,CAAf;IACA,KAAKjyF,GAAL,CAAS2M,gBAAT,CAA0B,aAA1B,EAAyC,KAAKulB,WAAL,CAAiBxvB,IAAjB,CAAsB,IAAtB,CAAzC,EAAsE;MACpE8J;IADoE,CAAtE;IAGA,KAAKxM,GAAL,CAAS2M,gBAAT,CAA0B,WAA1B,EAAuC,KAAKiR,SAAL,CAAelb,IAAf,CAAoB,IAApB,CAAvC,EAAkE;MAChE8J;IADgE,CAAlE;EAGD;;EACD+V,YAAY,GAAG;IACb,KAAK,CAAC0vE,OAAN,EAAe14E,KAAf;IACA,KAAK,CAAC04E,OAAN,GAAgB,IAAhB;EACD;;EACDkB,MAAM,CAACvnF,MAAD,EAAS;IACb,KAAK,CAACwT,OAAN,CAAc3d,GAAd,CAAkBmK,MAAM,CAACjM,EAAzB,EAA6BiM,MAA7B;IACA,MAAM;MACJ6V;IADI,IAEF7V,MAFJ;;IAGA,IAAI6V,mBAAmB,IAAI,KAAK,CAACjT,SAAN,CAAgB0U,0BAAhB,CAA2CzB,mBAA3C,CAA3B,EAA4F;MAC1F,KAAK,CAACjT,SAAN,CAAgB2U,8BAAhB,CAA+CvX,MAA/C;IACD;EACF;;EACDwnF,MAAM,CAACxnF,MAAD,EAAS;IACb,KAAK,CAACwT,OAAN,CAAcnR,MAAd,CAAqBrC,MAAM,CAACjM,EAA5B;IACA,KAAK,CAAC48E,oBAAN,EAA4B8W,wBAA5B,CAAqDznF,MAAM,CAACyoB,UAA5D;;IACA,IAAI,CAAC,KAAK,CAACg+D,WAAP,IAAsBzmF,MAAM,CAAC6V,mBAAjC,EAAsD;MACpD,KAAK,CAACjT,SAAN,CAAgBuU,2BAAhB,CAA4CnX,MAA5C;IACD;EACF;;EACD/J,MAAM,CAAC+J,MAAD,EAAS;IACb,KAAKwnF,MAAL,CAAYxnF,MAAZ;IACA,KAAK,CAAC4C,SAAN,CAAgBoU,YAAhB,CAA6BhX,MAA7B;IACAA,MAAM,CAAC5L,GAAP,CAAW6B,MAAX;IACA+J,MAAM,CAACsf,eAAP,GAAyB,KAAzB;;IACA,IAAI,CAAC,KAAK,CAACknE,YAAX,EAAyB;MACvB,KAAKlF,oBAAL,CAA0B,KAA1B;IACD;EACF;;EACD5nE,YAAY,CAAC1Z,MAAD,EAAS;IACnB,IAAIA,MAAM,CAACoD,MAAP,KAAkB,IAAtB,EAA4B;MAC1B;IACD;;IACD,IAAIpD,MAAM,CAACoD,MAAP,IAAiBpD,MAAM,CAAC6V,mBAA5B,EAAiD;MAC/C,KAAK,CAACjT,SAAN,CAAgBuU,2BAAhB,CAA4CnX,MAAM,CAAC6V,mBAAnD;MACAoH,gBAAgB,CAACyC,uBAAjB,CAAyC1f,MAAzC;MACAA,MAAM,CAAC6V,mBAAP,GAA6B,IAA7B;IACD;;IACD,KAAK0xE,MAAL,CAAYvnF,MAAZ;IACAA,MAAM,CAACoD,MAAP,EAAeokF,MAAf,CAAsBxnF,MAAtB;IACAA,MAAM,CAACghB,SAAP,CAAiB,IAAjB;;IACA,IAAIhhB,MAAM,CAAC5L,GAAP,IAAc4L,MAAM,CAACsf,eAAzB,EAA0C;MACxCtf,MAAM,CAAC5L,GAAP,CAAW6B,MAAX;MACA,KAAK7B,GAAL,CAASS,MAAT,CAAgBmL,MAAM,CAAC5L,GAAvB;IACD;EACF;;EACD0N,GAAG,CAAC9B,MAAD,EAAS;IACV,IAAIA,MAAM,CAACoD,MAAP,KAAkB,IAAlB,IAA0BpD,MAAM,CAACsf,eAArC,EAAsD;MACpD;IACD;;IACD,KAAK5F,YAAL,CAAkB1Z,MAAlB;IACA,KAAK,CAAC4C,SAAN,CAAgBmU,SAAhB,CAA0B/W,MAA1B;IACA,KAAKunF,MAAL,CAAYvnF,MAAZ;;IACA,IAAI,CAACA,MAAM,CAACsf,eAAZ,EAA6B;MAC3B,MAAMlrB,GAAG,GAAG4L,MAAM,CAACS,MAAP,EAAZ;MACA,KAAKrM,GAAL,CAASS,MAAT,CAAgBT,GAAhB;MACA4L,MAAM,CAACsf,eAAP,GAAyB,IAAzB;IACD;;IACDtf,MAAM,CAAC6gB,iBAAP;IACA7gB,MAAM,CAACgnB,SAAP;IACA,KAAK,CAACpkB,SAAN,CAAgB8O,sBAAhB,CAAuC1R,MAAvC;;IACAA,MAAM,CAAC6b,gBAAP,CAAwB7b,MAAM,CAAC4oB,oBAA/B;EACD;;EACDjC,eAAe,CAAC3mB,MAAD,EAAS;IACtB,IAAI,CAACA,MAAM,CAACsf,eAAZ,EAA6B;MAC3B;IACD;;IACD,MAAM;MACJ5T;IADI,IAEF7X,QAFJ;;IAGA,IAAImM,MAAM,CAAC5L,GAAP,CAAWqX,QAAX,CAAoBC,aAApB,KAAsC,CAAC,KAAK,CAAC46E,oBAAjD,EAAuE;MACrEtmF,MAAM,CAACuB,mBAAP,GAA6B,KAA7B;MACA,KAAK,CAAC+kF,oBAAN,GAA6BrvE,UAAU,CAAC,MAAM;QAC5C,KAAK,CAACqvE,oBAAN,GAA6B,IAA7B;;QACA,IAAI,CAACtmF,MAAM,CAAC5L,GAAP,CAAWqX,QAAX,CAAoB5X,QAAQ,CAAC6X,aAA7B,CAAL,EAAkD;UAChD1L,MAAM,CAAC5L,GAAP,CAAW2M,gBAAX,CAA4B,SAA5B,EAAuC,MAAM;YAC3Cf,MAAM,CAACuB,mBAAP,GAA6B,IAA7B;UACD,CAFD,EAEG;YACDyN,IAAI,EAAE,IADL;YAEDpO,MAAM,EAAE,KAAK,CAACgC,SAAN,CAAgB9B;UAFvB,CAFH;UAMA4K,aAAa,CAAC4D,KAAd;QACD,CARD,MAQO;UACLtP,MAAM,CAACuB,mBAAP,GAA6B,IAA7B;QACD;MACF,CAbsC,EAapC,CAboC,CAAvC;IAcD;;IACDvB,MAAM,CAACif,mBAAP,GAA6B,KAAK,CAAC0xD,oBAAN,EAA4BO,gBAA5B,CAA6C,KAAK98E,GAAlD,EAAuD4L,MAAM,CAAC5L,GAA9D,EAAmE4L,MAAM,CAACyoB,UAA1E,EAAsF,IAAtF,CAA7B;EACD;;EACDhR,YAAY,CAACzX,MAAD,EAAS;IACnB,IAAIA,MAAM,CAACmnB,gBAAP,EAAJ,EAA+B;MAC7BnnB,MAAM,CAACoD,MAAP,KAAkB,IAAlB;MACApD,MAAM,CAACyZ,OAAP;MACAzZ,MAAM,CAACgC,IAAP;IACD,CAJD,MAIO;MACL,KAAKF,GAAL,CAAS9B,MAAT;IACD;EACF;;EACDk9E,iBAAiB,CAACl9E,MAAD,EAAS;IACxB,MAAMgG,GAAG,GAAG,MAAMhG,MAAM,CAACa,UAAP,CAAkB4Y,OAAlB,CAA0BzZ,MAA1B,CAAlB;;IACA,MAAMiG,IAAI,GAAG,MAAM;MACjBjG,MAAM,CAAC/J,MAAP;IACD,CAFD;;IAGA,KAAKqe,WAAL,CAAiB;MACftO,GADe;MAEfC,IAFe;MAGfE,QAAQ,EAAE;IAHK,CAAjB;EAKD;;EACD0Z,SAAS,GAAG;IACV,OAAO,KAAK,CAACjd,SAAN,CAAgBqS,KAAhB,EAAP;EACD;;EACqB,IAAlB,CAACyyE,iBAAiB,GAAG;IACvB,OAAO11G,qBAAqB,CAAC,CAACo3B,WAAvB,CAAmC93B,GAAnC,CAAuC,KAAK,CAACsxB,SAAN,CAAgBkX,OAAhB,EAAvC,CAAP;EACD;;EACD/L,cAAc,CAACC,EAAD,EAAK;IACjB,OAAO,KAAK,CAACpL,SAAN,CAAgBmL,cAAhB,CAA+BC,EAA/B,CAAP;EACD;;EACD,CAAC25E,eAAe,CAACxvE,MAAD,EAAS;IACvB,MAAMjW,UAAU,GAAG,KAAK,CAACwlF,iBAAzB;IACA,OAAOxlF,UAAU,GAAG,IAAIA,UAAU,CAACzwB,SAAX,CAAqB4U,WAAzB,CAAqC8xB,MAArC,CAAH,GAAkD,IAAnE;EACD;;EACDnC,uBAAuB,GAAG;IACxB,OAAO,KAAK,CAAC0xE,iBAAN,EAAyB1xE,uBAAzB,EAAP;EACD;;EACD2tE,WAAW,CAACr5E,IAAD,EAAO6N,MAAP,EAAe;IACxB,KAAK,CAACvV,SAAN,CAAgBsT,aAAhB,CAA8B5L,IAA9B;IACA,KAAK,CAAC1H,SAAN,CAAgB4S,UAAhB,CAA2BlL,IAA3B;IACA,MAAM;MACJ5P,OADI;MAEJC;IAFI,IAGF,KAAK,CAACitF,cAAN,EAHJ;IAIA,MAAM7zF,EAAE,GAAG,KAAK8rB,SAAL,EAAX;IACA,MAAM7f,MAAM,GAAG,KAAK,CAAC2nF,eAAN,CAAsB;MACnCvkF,MAAM,EAAE,IAD2B;MAEnCrP,EAFmC;MAGnC7G,CAAC,EAAEwN,OAHgC;MAInCvN,CAAC,EAAEwN,OAJgC;MAKnCiI,SAAS,EAAE,KAAK,CAACA,SALkB;MAMnCoc,UAAU,EAAE,IANuB;MAOnC,GAAG7G;IAPgC,CAAtB,CAAf;;IASA,IAAInY,MAAJ,EAAY;MACV,KAAK8B,GAAL,CAAS9B,MAAT;IACD;EACF;;EACDmU,WAAW,CAACja,IAAD,EAAO;IAChB,OAAOloB,qBAAqB,CAAC,CAACo3B,WAAvB,CAAmC93B,GAAnC,CAAuC4oB,IAAI,CAACqkE,cAAL,IAAuBrkE,IAAI,CAACmsE,oBAAnE,GAA0FlyD,WAA1F,CAAsGja,IAAtG,EAA4G,IAA5G,EAAkH,KAAK,CAAC0I,SAAxH,KAAsI,IAA7I;EACD;;EACD2O,qBAAqB,CAACnK,KAAD,EAAQ4X,UAAR,EAAoB9kB,IAAI,GAAG,EAA3B,EAA+B;IAClD,MAAMnG,EAAE,GAAG,KAAK8rB,SAAL,EAAX;IACA,MAAM7f,MAAM,GAAG,KAAK,CAAC2nF,eAAN,CAAsB;MACnCvkF,MAAM,EAAE,IAD2B;MAEnCrP,EAFmC;MAGnC7G,CAAC,EAAEka,KAAK,CAAC1M,OAH0B;MAInCvN,CAAC,EAAEia,KAAK,CAACzM,OAJ0B;MAKnCiI,SAAS,EAAE,KAAK,CAACA,SALkB;MAMnCoc,UANmC;MAOnC,GAAG9kB;IAPgC,CAAtB,CAAf;;IASA,IAAI8F,MAAJ,EAAY;MACV,KAAK8B,GAAL,CAAS9B,MAAT;IACD;;IACD,OAAOA,MAAP;EACD;;EACD,CAAC4nF,cAAc,GAAG;IAChB,MAAM;MACJ16F,CADI;MAEJC,CAFI;MAGJ2E,KAHI;MAIJC;IAJI,IAKF,KAAKqC,GAAL,CAASsb,qBAAT,EALJ;IAMA,MAAM8vB,GAAG,GAAGl4C,IAAI,CAAC2D,GAAL,CAAS,CAAT,EAAYiC,CAAZ,CAAZ;IACA,MAAMwyC,GAAG,GAAGp4C,IAAI,CAAC2D,GAAL,CAAS,CAAT,EAAYkC,CAAZ,CAAZ;IACA,MAAMyyC,GAAG,GAAGt4C,IAAI,CAACC,GAAL,CAASuX,MAAM,CAAC+oF,UAAhB,EAA4B36F,CAAC,GAAG4E,KAAhC,CAAZ;IACA,MAAMguC,GAAG,GAAGx4C,IAAI,CAACC,GAAL,CAASuX,MAAM,CAACgpF,WAAhB,EAA6B36F,CAAC,GAAG4E,MAAjC,CAAZ;IACA,MAAM8I,OAAO,GAAG,CAAC2kC,GAAG,GAAGI,GAAP,IAAc,CAAd,GAAkB1yC,CAAlC;IACA,MAAM4N,OAAO,GAAG,CAAC4kC,GAAG,GAAGI,GAAP,IAAc,CAAd,GAAkB3yC,CAAlC;IACA,MAAM,CAACuN,OAAD,EAAUC,OAAV,IAAqB,KAAK0E,QAAL,CAAc5E,QAAd,GAAyB,GAAzB,KAAiC,CAAjC,GAAqC,CAACI,OAAD,EAAUC,OAAV,CAArC,GAA0D,CAACA,OAAD,EAAUD,OAAV,CAArF;IACA,OAAO;MACLH,OADK;MAELC;IAFK,CAAP;EAID;;EACDsb,YAAY,GAAG;IACb,KAAK1E,qBAAL,CAA2B,KAAK,CAACq2E,cAAN,EAA3B,EAAmD,IAAnD;EACD;;EACD9xE,WAAW,CAAC9V,MAAD,EAAS;IAClB,KAAK,CAAC4C,SAAN,CAAgBkT,WAAhB,CAA4B9V,MAA5B;EACD;;EACD+X,cAAc,CAAC/X,MAAD,EAAS;IACrB,KAAK,CAAC4C,SAAN,CAAgBmV,cAAhB,CAA+B/X,MAA/B;EACD;;EACDiY,UAAU,CAACjY,MAAD,EAAS;IACjB,OAAO,KAAK,CAAC4C,SAAN,CAAgBqV,UAAhB,CAA2BjY,MAA3B,CAAP;EACD;;EACDkX,QAAQ,CAAClX,MAAD,EAAS;IACf,KAAK,CAAC4C,SAAN,CAAgBsU,QAAhB,CAAyBlX,MAAzB;EACD;;EACDgS,SAAS,CAAC5K,KAAD,EAAQ;IACf,MAAM;MACJne;IADI,IAEFtW,gBAAgB,CAACoW,QAFrB;;IAGA,IAAIqe,KAAK,CAACjF,MAAN,KAAiB,CAAjB,IAAsBiF,KAAK,CAACE,OAAN,IAAiBre,KAA3C,EAAkD;MAChD;IACD;;IACD,IAAIme,KAAK,CAAC2E,MAAN,KAAiB,KAAK3X,GAA1B,EAA+B;MAC7B;IACD;;IACD,IAAI,CAAC,KAAK,CAACmyF,cAAX,EAA2B;MACzB;IACD;;IACD,KAAK,CAACA,cAAN,GAAuB,KAAvB;;IACA,IAAI,CAAC,KAAK,CAACJ,UAAX,EAAuB;MACrB,KAAK,CAACA,UAAN,GAAmB,IAAnB;MACA;IACD;;IACD,IAAI,KAAK,CAACvjF,SAAN,CAAgBkX,OAAhB,OAA8B5nC,oBAAoB,CAACwE,KAAvD,EAA8D;MAC5D,KAAK,CAACksB,SAAN,CAAgB4J,WAAhB;MACA;IACD;;IACD,KAAK+E,qBAAL,CAA2BnK,KAA3B,EAAkC,KAAlC;EACD;;EACDkf,WAAW,CAAClf,KAAD,EAAQ;IACjB,IAAI,KAAK,CAACxE,SAAN,CAAgBkX,OAAhB,OAA8B5nC,oBAAoB,CAACuE,SAAvD,EAAkE;MAChE,KAAKswG,mBAAL;IACD;;IACD,IAAI,KAAK,CAACR,cAAV,EAA0B;MACxB,KAAK,CAACA,cAAN,GAAuB,KAAvB;MACA;IACD;;IACD,MAAM;MACJt9F;IADI,IAEFtW,gBAAgB,CAACoW,QAFrB;;IAGA,IAAIqe,KAAK,CAACjF,MAAN,KAAiB,CAAjB,IAAsBiF,KAAK,CAACE,OAAN,IAAiBre,KAA3C,EAAkD;MAChD;IACD;;IACD,IAAIme,KAAK,CAAC2E,MAAN,KAAiB,KAAK3X,GAA1B,EAA+B;MAC7B;IACD;;IACD,KAAK,CAACmyF,cAAN,GAAuB,IAAvB;IACA,MAAMvmF,MAAM,GAAG,KAAK,CAAC4C,SAAN,CAAgB+W,SAAhB,EAAf;IACA,KAAK,CAACwsE,UAAN,GAAmB,CAACnmF,MAAD,IAAWA,MAAM,CAAC6K,OAAP,EAA9B;EACD;;EACD8W,aAAa,CAAC3hB,MAAD,EAAS9S,CAAT,EAAYC,CAAZ,EAAe;IAC1B,MAAMygB,KAAK,GAAG,KAAK,CAAChL,SAAN,CAAgB2M,UAAhB,CAA2BriB,CAA3B,EAA8BC,CAA9B,CAAd;;IACA,IAAIygB,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,IAAhC,EAAsC;MACpC,OAAO,KAAP;IACD;;IACDA,KAAK,CAAC8L,YAAN,CAAmB1Z,MAAnB;IACA,OAAO,IAAP;EACD;;EACDtO,OAAO,GAAG;IACR,IAAI,KAAK,CAACkR,SAAN,CAAgB+W,SAAhB,IAA6BvW,MAA7B,KAAwC,IAA5C,EAAkD;MAChD,KAAK,CAACR,SAAN,CAAgBmN,cAAhB;MACA,KAAK,CAACnN,SAAN,CAAgB8U,eAAhB,CAAgC,IAAhC;IACD;;IACD,IAAI,KAAK,CAAC4uE,oBAAV,EAAgC;MAC9Bx4E,YAAY,CAAC,KAAK,CAACw4E,oBAAP,CAAZ;MACA,KAAK,CAACA,oBAAN,GAA6B,IAA7B;IACD;;IACD,KAAK,MAAMtmF,MAAX,IAAqB,KAAK,CAACwT,OAAN,CAAc3F,MAAd,EAArB,EAA6C;MAC3C,KAAK,CAAC8iE,oBAAN,EAA4B8W,wBAA5B,CAAqDznF,MAAM,CAACyoB,UAA5D;MACAzoB,MAAM,CAACghB,SAAP,CAAiB,IAAjB;MACAhhB,MAAM,CAACsf,eAAP,GAAyB,KAAzB;MACAtf,MAAM,CAAC5L,GAAP,CAAW6B,MAAX;IACD;;IACD,KAAK7B,GAAL,GAAW,IAAX;IACA,KAAK,CAACof,OAAN,CAAc1b,KAAd;IACA,KAAK,CAAC8K,SAAN,CAAgB2S,WAAhB,CAA4B,IAA5B;EACD;;EACD,CAACwzC,OAAO,GAAG;IACT,KAAK,CAACy9B,YAAN,GAAqB,IAArB;;IACA,KAAK,MAAMxmF,MAAX,IAAqB,KAAK,CAACwT,OAAN,CAAc3F,MAAd,EAArB,EAA6C;MAC3C,IAAI7N,MAAM,CAAC6K,OAAP,EAAJ,EAAsB;QACpB7K,MAAM,CAAC/J,MAAP;MACD;IACF;;IACD,KAAK,CAACuwF,YAAN,GAAqB,KAArB;EACD;;EACD/lF,MAAM,CAAC;IACLpB;EADK,CAAD,EAEH;IACD,KAAKA,QAAL,GAAgBA,QAAhB;IACA5qB,kBAAkB,CAAC,KAAK2f,GAAN,EAAWiL,QAAX,CAAlB;;IACA,KAAK,MAAMW,MAAX,IAAqB,KAAK,CAAC4C,SAAN,CAAgBiU,UAAhB,CAA2B,KAAK1B,SAAhC,CAArB,EAAiE;MAC/D,KAAKrT,GAAL,CAAS9B,MAAT;MACAA,MAAM,CAACyZ,OAAP;IACD;;IACD,KAAKjE,UAAL;EACD;;EACDiU,MAAM,CAAC;IACLpqB;EADK,CAAD,EAEH;IACD,KAAK,CAACuD,SAAN,CAAgBmN,cAAhB;IACA,KAAK,CAACg5C,OAAN;IACA,MAAMg/B,WAAW,GAAG,KAAK1oF,QAAL,CAAc5E,QAAlC;IACA,MAAMA,QAAQ,GAAG4E,QAAQ,CAAC5E,QAA1B;IACA,KAAK4E,QAAL,GAAgBA,QAAhB;IACA5qB,kBAAkB,CAAC,KAAK2f,GAAN,EAAW;MAC3BqG;IAD2B,CAAX,CAAlB;;IAGA,IAAIstF,WAAW,KAAKttF,QAApB,EAA8B;MAC5B,KAAK,MAAMuF,MAAX,IAAqB,KAAK,CAACwT,OAAN,CAAc3F,MAAd,EAArB,EAA6C;QAC3C7N,MAAM,CAAConB,MAAP,CAAc3sB,QAAd;MACD;IACF;;IACD,KAAK6mF,oBAAL,CAA0B,KAA1B;EACD;;EACiB,IAAdniE,cAAc,GAAG;IACnB,MAAM;MACJ7jB,SADI;MAEJC;IAFI,IAGF,KAAK8D,QAAL,CAAchE,OAHlB;IAIA,OAAO,CAACC,SAAD,EAAYC,UAAZ,CAAP;EACD;;EACQ,IAALf,KAAK,GAAG;IACV,OAAO,KAAK,CAACoI,SAAN,CAAgB4K,cAAhB,CAA+BC,SAAtC;EACD;;AAxlByB;;AA2lB5B,C,CAAC;;AAGD,MAAMh7B,SAAN,CAAgB;EACd,CAAC2wB,MAAD,GAAU,IAAV;EACA,CAACrP,EAAD,GAAM,CAAN;EACA,CAACi0F,OAAD,GAAW,IAAIt4F,GAAJ,EAAX;EACA,CAACu4F,QAAD,GAAY,IAAIv4F,GAAJ,EAAZ;;EACArJ,WAAW,CAAC;IACV8uB;EADU,CAAD,EAER;IACD,KAAKA,SAAL,GAAiBA,SAAjB;EACD;;EACD6L,SAAS,CAAC5d,MAAD,EAAS;IAChB,IAAI,CAAC,KAAK,CAACA,MAAX,EAAmB;MACjB,KAAK,CAACA,MAAN,GAAeA,MAAf;MACA;IACD;;IACD,IAAI,KAAK,CAACA,MAAN,KAAiBA,MAArB,EAA6B;MAC3B,IAAI,KAAK,CAAC4kF,OAAN,CAAcpwF,IAAd,GAAqB,CAAzB,EAA4B;QAC1B,KAAK,MAAM2lE,IAAX,IAAmB,KAAK,CAACyqB,OAAN,CAAcn6E,MAAd,EAAnB,EAA2C;UACzC0vD,IAAI,CAACtnE,MAAL;UACAmN,MAAM,CAACvO,MAAP,CAAc0oE,IAAd;QACD;MACF;;MACD,KAAK,CAACn6D,MAAN,GAAeA,MAAf;IACD;EACF;;EACqB,WAAX8kF,WAAW,GAAG;IACvB,OAAOxzG,MAAM,CAAC,IAAD,EAAO,aAAP,EAAsB,IAAIlC,aAAJ,EAAtB,CAAb;EACD;;EACa,OAAP,CAAC21G,MAAM,CAACzmF,OAAD,EAAU;IACtBxU,CAAC,GAAG,CADkB;IAEtBC,CAAC,GAAG,CAFkB;IAGtB2E,KAAK,GAAG,CAHc;IAItBC,MAAM,GAAG;EAJa,IAKpB,EALU,EAKN;IACN,MAAM;MACJsC;IADI,IAEFqN,OAFJ;IAGArN,KAAK,CAACI,GAAN,GAAa,GAAE,MAAMtH,CAAE,GAAvB;IACAkH,KAAK,CAACK,IAAN,GAAc,GAAE,MAAMxH,CAAE,GAAxB;IACAmH,KAAK,CAACvC,KAAN,GAAe,GAAE,MAAMA,KAAM,GAA7B;IACAuC,KAAK,CAACtC,MAAN,GAAgB,GAAE,MAAMA,MAAO,GAA/B;EACD;;EACD,CAACq2F,SAAS,CAACjlF,GAAD,EAAM;IACd,MAAMjQ,GAAG,GAAGzgB,SAAS,CAACy1G,WAAV,CAAsB7/F,MAAtB,CAA6B,CAA7B,EAAgC,CAAhC,EAAmC,IAAnC,CAAZ;;IACA,KAAK,CAAC+a,MAAN,CAAavO,MAAb,CAAoB3B,GAApB;IACAA,GAAG,CAACE,YAAJ,CAAiB,aAAjB,EAAgC,IAAhC;IACA3gB,SAAS,CAAC,CAAC01G,MAAX,CAAkBj1F,GAAlB,EAAuBiQ,GAAvB;IACA,OAAOjQ,GAAP;EACD;;EACD,CAACm1F,cAAc,CAACl0F,IAAD,EAAOm0F,MAAP,EAAe;IAC5B,MAAMvjB,QAAQ,GAAGtyF,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,UAApC,CAAjB;;IACAc,IAAI,CAACU,MAAL,CAAYkwE,QAAZ;IACA,MAAMmW,UAAU,GAAI,QAAOoN,MAAO,EAAlC;IACAvjB,QAAQ,CAAC3xE,YAAT,CAAsB,IAAtB,EAA4B8nF,UAA5B;IACAnW,QAAQ,CAAC3xE,YAAT,CAAsB,eAAtB,EAAuC,mBAAvC;;IACA,MAAMm1F,WAAW,GAAG91G,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,KAApC,CAApB;;IACA0xE,QAAQ,CAAClwE,MAAT,CAAgB0zF,WAAhB;IACAA,WAAW,CAACn1F,YAAZ,CAAyB,MAAzB,EAAkC,IAAGk1F,MAAO,EAA5C;IACAC,WAAW,CAAC1mF,SAAZ,CAAsBC,GAAtB,CAA0B,MAA1B;IACA,OAAOo5E,UAAP;EACD;;EACD56E,SAAS,CAACw2E,QAAD,EAAWzgF,KAAX,EAAkBoN,OAAlB,EAA2B+kF,eAAe,GAAG,KAA7C,EAAoD;IAC3D,MAAMz0F,EAAE,GAAG,KAAK,CAACA,EAAN,EAAX;IACA,MAAMwpE,IAAI,GAAG,KAAK,CAAC6qB,SAAN,CAAgBtR,QAAQ,CAAC3zE,GAAzB,CAAb;IACAo6D,IAAI,CAAC17D,SAAL,CAAeC,GAAf,CAAmB,WAAnB;;IACA,IAAIg1E,QAAQ,CAACW,IAAb,EAAmB;MACjBla,IAAI,CAAC17D,SAAL,CAAeC,GAAf,CAAmB,MAAnB;IACD;;IACD,MAAM3N,IAAI,GAAG1hB,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,MAApC,CAAb;;IACAkqE,IAAI,CAAC1oE,MAAL,CAAYV,IAAZ;;IACA,MAAM2sC,IAAI,GAAGruD,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,MAApC,CAAb;;IACAc,IAAI,CAACU,MAAL,CAAYisC,IAAZ;IACA,MAAMwnD,MAAM,GAAI,SAAQ,KAAKnzE,SAAU,IAAGphB,EAAG,EAA7C;IACA+sC,IAAI,CAAC1tC,YAAL,CAAkB,IAAlB,EAAwBk1F,MAAxB;IACAxnD,IAAI,CAAC1tC,YAAL,CAAkB,GAAlB,EAAuB0jF,QAAQ,CAACS,SAAT,EAAvB;;IACA,IAAIiR,eAAJ,EAAqB;MACnB,KAAK,CAACP,QAAN,CAAepyF,GAAf,CAAmB9B,EAAnB,EAAuB+sC,IAAvB;IACD;;IACD,MAAMo6C,UAAU,GAAG,KAAK,CAACmN,cAAN,CAAqBl0F,IAArB,EAA2Bm0F,MAA3B,CAAnB;;IACA,MAAMG,GAAG,GAAGh2G,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,KAApC,CAAZ;;IACAkqE,IAAI,CAAC1oE,MAAL,CAAY4zF,GAAZ;IACAlrB,IAAI,CAACnqE,YAAL,CAAkB,MAAlB,EAA0BiD,KAA1B;IACAknE,IAAI,CAACnqE,YAAL,CAAkB,cAAlB,EAAkCqQ,OAAlC;IACAglF,GAAG,CAACr1F,YAAJ,CAAiB,MAAjB,EAA0B,IAAGk1F,MAAO,EAApC;IACA,KAAK,CAACN,OAAN,CAAcnyF,GAAd,CAAkB9B,EAAlB,EAAsBwpE,IAAtB;IACA,OAAO;MACLxpE,EADK;MAELmnF,UAAU,EAAG,QAAOA,UAAW;IAF1B,CAAP;EAID;;EACDqB,gBAAgB,CAACzF,QAAD,EAAW;IACzB,MAAM/iF,EAAE,GAAG,KAAK,CAACA,EAAN,EAAX;IACA,MAAMwpE,IAAI,GAAG,KAAK,CAAC6qB,SAAN,CAAgBtR,QAAQ,CAAC3zE,GAAzB,CAAb;IACAo6D,IAAI,CAAC17D,SAAL,CAAeC,GAAf,CAAmB,kBAAnB;;IACA,MAAM3N,IAAI,GAAG1hB,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,MAApC,CAAb;;IACAkqE,IAAI,CAAC1oE,MAAL,CAAYV,IAAZ;;IACA,MAAM2sC,IAAI,GAAGruD,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,MAApC,CAAb;;IACAc,IAAI,CAACU,MAAL,CAAYisC,IAAZ;IACA,MAAMwnD,MAAM,GAAI,SAAQ,KAAKnzE,SAAU,IAAGphB,EAAG,EAA7C;IACA+sC,IAAI,CAAC1tC,YAAL,CAAkB,IAAlB,EAAwBk1F,MAAxB;IACAxnD,IAAI,CAAC1tC,YAAL,CAAkB,GAAlB,EAAuB0jF,QAAQ,CAACS,SAAT,EAAvB;IACAz2C,IAAI,CAAC1tC,YAAL,CAAkB,eAAlB,EAAmC,oBAAnC;IACA,IAAIs1F,MAAJ;;IACA,IAAI5R,QAAQ,CAACW,IAAb,EAAmB;MACjBla,IAAI,CAAC17D,SAAL,CAAeC,GAAf,CAAmB,MAAnB;;MACA,MAAM4+B,IAAI,GAAGjuD,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,MAApC,CAAb;;MACAc,IAAI,CAACU,MAAL,CAAY6rC,IAAZ;MACAgoD,MAAM,GAAI,SAAQ,KAAKvzE,SAAU,IAAGphB,EAAG,EAAvC;MACA2sC,IAAI,CAACttC,YAAL,CAAkB,IAAlB,EAAwBs1F,MAAxB;MACAhoD,IAAI,CAACttC,YAAL,CAAkB,WAAlB,EAA+B,mBAA/B;;MACA,MAAMvH,IAAI,GAAGpZ,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,MAApC,CAAb;;MACAqtC,IAAI,CAAC7rC,MAAL,CAAYhJ,IAAZ;MACAA,IAAI,CAACuH,YAAL,CAAkB,OAAlB,EAA2B,GAA3B;MACAvH,IAAI,CAACuH,YAAL,CAAkB,QAAlB,EAA4B,GAA5B;MACAvH,IAAI,CAACuH,YAAL,CAAkB,MAAlB,EAA0B,OAA1B;;MACA,MAAMq1F,GAAG,GAAGh2G,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,KAApC,CAAZ;;MACAqtC,IAAI,CAAC7rC,MAAL,CAAY4zF,GAAZ;MACAA,GAAG,CAACr1F,YAAJ,CAAiB,MAAjB,EAA0B,IAAGk1F,MAAO,EAApC;MACAG,GAAG,CAACr1F,YAAJ,CAAiB,QAAjB,EAA2B,MAA3B;MACAq1F,GAAG,CAACr1F,YAAJ,CAAiB,MAAjB,EAAyB,OAAzB;MACAq1F,GAAG,CAACr1F,YAAJ,CAAiB,WAAjB,EAA8B,SAA9B;MACAq1F,GAAG,CAAC5mF,SAAJ,CAAcC,GAAd,CAAkB,MAAlB;IACD;;IACD,MAAM6mF,IAAI,GAAGl2G,SAAS,CAACy1G,WAAV,CAAsB70F,aAAtB,CAAoC,KAApC,CAAb;;IACAkqE,IAAI,CAAC1oE,MAAL,CAAY8zF,IAAZ;IACAA,IAAI,CAACv1F,YAAL,CAAkB,MAAlB,EAA2B,IAAGk1F,MAAO,EAArC;;IACA,IAAII,MAAJ,EAAY;MACVC,IAAI,CAACv1F,YAAL,CAAkB,MAAlB,EAA2B,QAAOs1F,MAAO,GAAzC;IACD;;IACD,MAAME,IAAI,GAAGD,IAAI,CAACE,SAAL,EAAb;IACAtrB,IAAI,CAAC1oE,MAAL,CAAY+zF,IAAZ;IACAD,IAAI,CAAC9mF,SAAL,CAAeC,GAAf,CAAmB,aAAnB;IACA8mF,IAAI,CAAC/mF,SAAL,CAAeC,GAAf,CAAmB,kBAAnB;IACA,KAAK,CAACkmF,OAAN,CAAcnyF,GAAd,CAAkB9B,EAAlB,EAAsBwpE,IAAtB;IACA,OAAOxpE,EAAP;EACD;;EACDuoF,YAAY,CAACvoF,EAAD,EAAKu7E,IAAL,EAAW;IACrB,MAAMxuC,IAAI,GAAG,KAAK,CAACmnD,QAAN,CAAe32G,GAAf,CAAmByiB,EAAnB,CAAb;IACA,KAAK,CAACk0F,QAAN,CAAe5lF,MAAf,CAAsBtO,EAAtB;IACA,KAAK0oF,SAAL,CAAe1oF,EAAf,EAAmBu7E,IAAI,CAACnsE,GAAxB;IACA29B,IAAI,CAAC1tC,YAAL,CAAkB,GAAlB,EAAuBk8E,IAAI,CAACiI,SAAL,EAAvB;EACD;;EACDiF,UAAU,CAACzoF,EAAD,EAAKu7E,IAAL,EAAW;IACnB,MAAM/R,IAAI,GAAG,KAAK,CAACyqB,OAAN,CAAc12G,GAAd,CAAkByiB,EAAlB,CAAb;IACA,MAAMI,IAAI,GAAGopE,IAAI,CAACt1C,UAAlB;IACA,MAAM6Y,IAAI,GAAG3sC,IAAI,CAAC8zB,UAAlB;IACA6Y,IAAI,CAAC1tC,YAAL,CAAkB,GAAlB,EAAuBk8E,IAAI,CAACiI,SAAL,EAAvB;EACD;;EACD0G,mBAAmB,CAAClqF,EAAD,EAAK;IACtB,KAAKkC,MAAL,CAAYlC,EAAZ;IACA,KAAK,CAACk0F,QAAN,CAAe5lF,MAAf,CAAsBtO,EAAtB;EACD;;EACDiqF,UAAU,CAACjqF,EAAD,EAAKu7E,IAAL,EAAW;IACnB,KAAK,CAAC2Y,QAAN,CAAe32G,GAAf,CAAmByiB,EAAnB,EAAuBX,YAAvB,CAAoC,GAApC,EAAyCk8E,IAAI,CAACiI,SAAL,EAAzC;EACD;;EACDkF,SAAS,CAAC1oF,EAAD,EAAKoP,GAAL,EAAU;IACjB1wB,SAAS,CAAC,CAAC01G,MAAX,CAAkB,KAAK,CAACH,OAAN,CAAc12G,GAAd,CAAkByiB,EAAlB,CAAlB,EAAyCoP,GAAzC;EACD;;EACDnB,IAAI,CAACjO,EAAD,EAAKuiB,OAAL,EAAc;IAChB,KAAK,CAAC0xE,OAAN,CAAc12G,GAAd,CAAkByiB,EAAlB,EAAsB8N,SAAtB,CAAgC+N,MAAhC,CAAuC,QAAvC,EAAiD,CAAC0G,OAAlD;EACD;;EACD8Q,MAAM,CAACrzB,EAAD,EAAKquB,KAAL,EAAY;IAChB,KAAK,CAAC4lE,OAAN,CAAc12G,GAAd,CAAkByiB,EAAlB,EAAsBX,YAAtB,CAAmC,oBAAnC,EAAyDgvB,KAAzD;EACD;;EACDw6D,WAAW,CAAC7oF,EAAD,EAAKsC,KAAL,EAAY;IACrB,KAAK,CAAC2xF,OAAN,CAAc12G,GAAd,CAAkByiB,EAAlB,EAAsBX,YAAtB,CAAmC,MAAnC,EAA2CiD,KAA3C;EACD;;EACDyyF,aAAa,CAAC/0F,EAAD,EAAK0P,OAAL,EAAc;IACzB,KAAK,CAACukF,OAAN,CAAc12G,GAAd,CAAkByiB,EAAlB,EAAsBX,YAAtB,CAAmC,cAAnC,EAAmDqQ,OAAnD;EACD;;EACD65E,QAAQ,CAACvpF,EAAD,EAAK4M,SAAL,EAAgB;IACtB,KAAK,CAACqnF,OAAN,CAAc12G,GAAd,CAAkByiB,EAAlB,EAAsB8N,SAAtB,CAAgCC,GAAhC,CAAoCnB,SAApC;EACD;;EACD68E,WAAW,CAACzpF,EAAD,EAAK4M,SAAL,EAAgB;IACzB,KAAK,CAACqnF,OAAN,CAAc12G,GAAd,CAAkByiB,EAAlB,EAAsB8N,SAAtB,CAAgC5L,MAAhC,CAAuC0K,SAAvC;EACD;;EACD1K,MAAM,CAAClC,EAAD,EAAK;IACT,IAAI,KAAK,CAACqP,MAAN,KAAiB,IAArB,EAA2B;MACzB;IACD;;IACD,KAAK,CAAC4kF,OAAN,CAAc12G,GAAd,CAAkByiB,EAAlB,EAAsBkC,MAAtB;IACA,KAAK,CAAC+xF,OAAN,CAAc3lF,MAAd,CAAqBtO,EAArB;EACD;;EACDrC,OAAO,GAAG;IACR,KAAK,CAAC0R,MAAN,GAAe,IAAf;;IACA,KAAK,MAAMm6D,IAAX,IAAmB,KAAK,CAACyqB,OAAN,CAAcn6E,MAAd,EAAnB,EAA2C;MACzC0vD,IAAI,CAACtnE,MAAL;IACD;;IACD,KAAK,CAAC+xF,OAAN,CAAclwF,KAAd;EACD;;AA7La;;AAgMhB,C,CAAC;;AAaD,MAAMixF,YAAY,GAAG,QAArB;AACA,MAAMC,UAAU,GAAG,WAAnB;AAEA,IAAIC,iCAAiC,GAAGr3G,mBAAmB,CAACG,cAA5D;AACA,IAAIm3G,wCAAwC,GAAGt3G,mBAAmB,CAACI,qBAAnE;AACA,IAAIm3G,6CAA6C,GAAGv3G,mBAAmB,CAACK,0BAAxE;AACA,IAAIm3G,uCAAuC,GAAGx3G,mBAAmB,CAACM,oBAAlE;AACA,IAAIm3G,4CAA4C,GAAGz3G,mBAAmB,CAACO,yBAAvE;AACA,IAAIm3G,kCAAkC,GAAG13G,mBAAmB,CAACQ,eAA7D;AACA,IAAIm3G,iCAAiC,GAAG33G,mBAAmB,CAACS,cAA5D;AACA,IAAIm3G,sCAAsC,GAAG53G,mBAAmB,CAACU,mBAAjE;AACA,IAAIm3G,8BAA8B,GAAG73G,mBAAmB,CAACW,WAAzD;AACA,IAAIm3G,gCAAgC,GAAG93G,mBAAmB,CAACY,aAA3D;AACA,IAAIm3G,4BAA4B,GAAG/3G,mBAAmB,CAACa,SAAvD;AACA,IAAIm3G,8BAA8B,GAAGh4G,mBAAmB,CAACc,WAAzD;AACA,IAAIm3G,sCAAsC,GAAGj4G,mBAAmB,CAACgB,mBAAjE;AACA,IAAIk3G,4BAA4B,GAAGl4G,mBAAmB,CAACiB,SAAvD;AACA,IAAIk3G,sCAAsC,GAAGn4G,mBAAmB,CAACmB,mBAAjE;AACA,IAAIi3G,sCAAsC,GAAGp4G,mBAAmB,CAACoB,mBAAjE;AACA,IAAIi3G,sBAAsB,GAAGr4G,mBAAmB,CAACqB,GAAjD;AACA,IAAIi3G,wCAAwC,GAAGt4G,mBAAmB,CAACsB,qBAAnE;AACA,IAAIi3G,gCAAgC,GAAGv4G,mBAAmB,CAACuB,aAA3D;AACA,IAAIi3G,4BAA4B,GAAGx4G,mBAAmB,CAACwB,SAAvD;AACA,IAAIi3G,oCAAoC,GAAGz4G,mBAAmB,CAACyB,iBAA/D;AACA,IAAIi3G,iCAAiC,GAAG14G,mBAAmB,CAAC0B,cAA5D;AACA,IAAIi3G,gCAAgC,GAAG34G,mBAAmB,CAAC2B,aAA3D;AACA,IAAIi3G,8CAA8C,GAAG54G,mBAAmB,CAAC4B,2BAAzE;AACA,IAAIi3G,4BAA4B,GAAG74G,mBAAmB,CAAC6B,SAAvD;AACA,IAAIi3G,8CAA8C,GAAG94G,mBAAmB,CAAC8B,2BAAzE;AACA,IAAIi3G,uBAAuB,GAAG/4G,mBAAmB,CAAC+B,IAAlD;AACA,IAAIi3G,iCAAiC,GAAGh5G,mBAAmB,CAACgC,cAA5D;AACA,IAAIi3G,2BAA2B,GAAGj5G,mBAAmB,CAACiC,QAAtD;AACA,IAAIi3G,wBAAwB,GAAGl5G,mBAAmB,CAACkC,KAAnD;AACA,IAAIi3G,yCAAyC,GAAGn5G,mBAAmB,CAACmC,sBAApE;AACA,IAAIi3G,4BAA4B,GAAGp5G,mBAAmB,CAACoC,SAAvD;AACA,IAAIi3G,8BAA8B,GAAGr5G,mBAAmB,CAACqC,WAAzD;AACA,IAAIi3G,qCAAqC,GAAGt5G,mBAAmB,CAACsC,kBAAhE;AACA,IAAIi3G,wCAAwC,GAAGv5G,mBAAmB,CAACuC,qBAAnE;AACA,IAAIi3G,qCAAqC,GAAGx5G,mBAAmB,CAACwC,kBAAhE;AACA,IAAIi3G,+BAA+B,GAAGz5G,mBAAmB,CAACyC,YAA1D;AACA,IAAIi3G,4BAA4B,GAAG15G,mBAAmB,CAAC0C,SAAvD;AACA,IAAIi3G,gCAAgC,GAAG35G,mBAAmB,CAAC2C,aAA3D;AACA,IAAIi3G,mCAAmC,GAAG55G,mBAAmB,CAAC4C,gBAA9D;AACA,IAAIi3G,qCAAqC,GAAG75G,mBAAmB,CAAC6C,kBAAhE;AACA,IAAIi3G,yBAAyB,GAAG95G,mBAAmB,CAAC8C,MAApD;AACA,IAAIi3G,0BAA0B,GAAG/5G,mBAAmB,CAAC+C,OAArD;AACA,SAASs0G,iCAAiC,IAAIl3G,cAA9C,EAA8Dm3G,wCAAwC,IAAIl3G,qBAA1G,EAAiIm3G,6CAA6C,IAAIl3G,0BAAlL,EAA8Mm3G,uCAAuC,IAAIl3G,oBAAzP,EAA+Qm3G,4CAA4C,IAAIl3G,yBAA/T,EAA0Vm3G,kCAAkC,IAAIl3G,eAAhY,EAAiZm3G,iCAAiC,IAAIl3G,cAAtb,EAAscm3G,sCAAsC,IAAIl3G,mBAAhf,EAAqgBm3G,8BAA8B,IAAIl3G,WAAviB,EAAojBm3G,gCAAgC,IAAIl3G,aAAxlB,EAAumBm3G,4BAA4B,IAAIl3G,SAAvoB,EAAkpBm3G,8BAA8B,IAAIl3G,WAAprB,EAAisBm3G,sCAAsC,IAAIj3G,mBAA3uB,EAAgwBk3G,4BAA4B,IAAIj3G,SAAhyB,EAA2yBk3G,sCAAsC,IAAIh3G,mBAAr1B,EAA02Bi3G,sCAAsC,IAAIh3G,mBAAp5B,EAAy6Bi3G,sBAAsB,IAAIh3G,GAAn8B,EAAw8Bi3G,wCAAwC,IAAIh3G,qBAAp/B,EAA2gCi3G,gCAAgC,IAAIh3G,aAA/iC,EAA8jCi3G,4BAA4B,IAAIh3G,SAA9lC,EAAymCi3G,oCAAoC,IAAIh3G,iBAAjpC,EAAoqCi3G,iCAAiC,IAAIh3G,cAAzsC,EAAytCi3G,gCAAgC,IAAIh3G,aAA7vC,EAA4wCi3G,8CAA8C,IAAIh3G,2BAA9zC,EAA21Ci3G,4BAA4B,IAAIh3G,SAA33C,EAAs4Ci3G,8CAA8C,IAAIh3G,2BAAx7C,EAAq9Ci3G,uBAAuB,IAAIh3G,IAAh/C,EAAs/Ci3G,iCAAiC,IAAIh3G,cAA3hD,EAA2iDi3G,2BAA2B,IAAIh3G,QAA1kD,EAAolDi3G,wBAAwB,IAAIh3G,KAAhnD,EAAunDi3G,yCAAyC,IAAIh3G,sBAApqD,EAA4rDi3G,4BAA4B,IAAIh3G,SAA5tD,EAAuuDi3G,8BAA8B,IAAIh3G,WAAzwD,EAAsxDi3G,qCAAqC,IAAIh3G,kBAA/zD,EAAm1Di3G,wCAAwC,IAAIh3G,qBAA/3D,EAAs5Di3G,qCAAqC,IAAIh3G,kBAA/7D,EAAm9Di3G,+BAA+B,IAAIh3G,YAAt/D,EAAogEi3G,4BAA4B,IAAIh3G,SAApiE,EAA+iEi3G,gCAAgC,IAAIh3G,aAAnlE,EAAkmEi3G,mCAAmC,IAAIh3G,gBAAzoE,EAA2pEi3G,qCAAqC,IAAIh3G,kBAApsE,EAAwtEi3G,yBAAyB,IAAIh3G,MAArvE,EAA6vEi3G,0BAA0B,IAAIh3G,OAA3xE","ignoreList":[]},"metadata":{},"sourceType":"module"}